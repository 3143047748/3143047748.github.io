<!DOCTYPE html>
<html lang=zh-CN>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:description" content="本网站是个人兴趣爱好，总结分享经验，记录生活点滴的平台，希望在以后的学习旅途中，走出自己的风景。">
    <meta property="og:type" content="website">
    <meta name="description" content="本网站是个人兴趣爱好，总结分享经验，记录生活点滴的平台，希望在以后的学习旅途中，走出自己的风景。">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        Nmap学习笔记 - n0rt6&#39;s bolg
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/aircloud.css">

    
<link rel="stylesheet" href="/css/gitment.css">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_28hi1hpxx24.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>

    









<meta name="generator" content="Hexo 6.3.0"></head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> Welcome To You </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>n0rt6</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li >
                <a href="/collect/">
                    <i class="iconfont icon-shoucang1"></i>
                    <span>COLLECT</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-text">基本操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nmap%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95%E4%B9%8B%E8%84%9A%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">nmap高级用法之脚本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="toc-text">参数详解</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-bg" id="search-bg"></div>
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> Welcome To You </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        Nmap学习笔记
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2023-03-23 21:14:37</span></span>
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <meta name="referrer" content="no-referrer"/>

<h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><blockquote>
<p>nmap 0.0.0.0（本机IP）</p>
</blockquote>
<p>nmap默认发送一个arp的ping包，探测目标主机0-1000的端口。<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_47125775/article/details/108433224">arp（地址解析协议）</a></p>
<blockquote>
<p>nmap ip ip<br> nmap 0.0.0.0 1.1.1.1</p>
</blockquote>
<p>快速扫描多个IP</p>
<blockquote>
<p>nmap -p (范围) IP<br> nmap -p 80,20-200 1.1.1.1</p>
</blockquote>
<p>指定端口和范围进行扫描</p>
<blockquote>
<p>nmap 192.168.227.1&#x2F;24 -exclude 192.168.227.1</p>
</blockquote>
<p>扫描除过某一个ip外的所有子网主机</p>
<blockquote>
<p>nmap -sL 192.168.227.1&#x2F;24</p>
</blockquote>
<p>显示扫描的所有主机的列表</p>
<blockquote>
<p>namp -sp 1.1.1.1-255</p>
</blockquote>
<p>扫描内网的一个IP范围(ping扫描)</p>
<blockquote>
<p>nmap -sS 1.1.1.1<br> Tcp SYN Scan (sS) 这是一个基本的扫描方式,它被称为半开放扫描，因为这种技术使得Nmap不需要通过完整的握手，就能获得远程主机的信息。Nmap发送SYN包到远程主机，但是它不会产生任何会话.因此不会<strong>在目标主机上产生任何日志记录</strong>,因为没有形成会话。这个就是SYN扫描的优势.如果Nmap命令中没有指出扫描类型,默认的就是Tcp SYN.但是它需要root&#x2F;administrator权限。</p>
</blockquote>
<p>SYN半开放扫描</p>
<blockquote>
<p>namp -sT 192.168.227.154<br> 不同于Tcp SYN扫描,Tcp connect()扫描需要完成三次握手,并且要求调用系统的connect().Tcp connect()扫描技术<strong>只适用于找出TCP和UDP端口。</strong></p>
</blockquote>
<p>TCP扫描</p>
<blockquote>
<p>nmap -sU 192.168.206.124<br> 这种扫描技术<strong>用来寻找目标主机打开的UDP端口</strong>.它不需要发送任何的SYN包，因为这种技术是针对UDP端口的。UDP扫描发送UDP数据包到目标主机，并等待响应,如果返回ICMP不可达的错误消息，说明端口是关闭的，如果得到正确的适当的回应，说明端口是开放的.</p>
</blockquote>
<p>UDP扫描</p>
<blockquote>
<p>nmap -sV 192.168.206.135<br> 版本检测是<strong>用来扫描目标主机和端口上运行的软件的版本.它不同于其它的扫描技术，它不是用来扫描目标主机上开放的端口，不过它需要从开放的端口获取信息来判断软件的版本.使用版本检测扫描之前需要先用TCPSYN扫描开放了哪些端口。这个扫描的话，速度会慢一些，67.86秒扫一个IP</strong>。</p>
</blockquote>
<p>Version版本扫描</p>
<blockquote>
<p>nmap -O 192.168.126.206</p>
</blockquote>
<p>OS操作系统类型检测</p>
<blockquote>
<p>nmap -O -PN 192.168.206.124<br> 如果远程主机有防火墙，IDS和IPS系统，你可以使用-PN命令来确保不ping远程主机，因为有时候防火墙会组织掉ping请求.-PN命令告诉Nmap不用ping远程主机。使用-PN参数可以绕过PING命令,但是不影响主机的系统的发现。<br> 这个扫描整个c段局域网的话还是比较耗时的，但是信息收集很详细，大概耗时9分钟。</p>
</blockquote>
<p>NO ping 扫描</p>
<blockquote>
<p>10.1.1.0&#x2F;24 &#x3D; 10.1.1.1-10.1.1.255 #c段扫描<br> 10.1.1.0&#x2F;16 &#x3D; 10.1.1.1-10.1.255.255 #b段扫描<br> 10.1.1.0&#x2F;8 &#x3D; 10.1.1.1-10.255.255.255 #a段扫描</p>
</blockquote>
<p><strong>网段扫描格式</strong></p>
<blockquote>
<p>nmap -iL ip-address.txt</p>
</blockquote>
<p>从文件中读取需要扫描的列表</p>
<h2 id="nmap高级用法之脚本使用"><a href="#nmap高级用法之脚本使用" class="headerlink" title="nmap高级用法之脚本使用"></a>nmap高级用法之脚本使用</h2><p>MYSQL暴力破解</p>
<blockquote>
<p>nmap –script&#x3D;mysql-brute <target></p>
</blockquote>
<blockquote>
<p>3306&#x2F;tcp open  mysql<br> | mysql-brute:<br> |   Accounts<br> |     root:root - Valid credentials</p>
</blockquote>
<p>MsSQL进行暴力破解</p>
<blockquote>
<p>nmap -p 1433 –script ms-sql-brute –script-args userdb&#x3D;customuser.txt,passdb&#x3D;custompass.txt <host></p>
</blockquote>
<blockquote>
<p>| ms-sql-brute:<br> |   [192.168.100.128\TEST]<br> |     No credentials found<br> |     Warnings:<br> |       sa: AccountLockedOut<br> |   [192.168.100.128\PROD]<br> |     Credentials found:<br> |       webshop_reader:secret &#x3D;&gt; Login Success<br> |       testuser:secret1234 &#x3D;&gt; PasswordMustChange<br> |_      lordvader:secret1234 &#x3D;&gt; Login Success</p>
</blockquote>
<p>对Oracle数据库进行暴破解</p>
<blockquote>
<p>nmap –script oracle-brute -p 1521 –script-args oracle-brute.sid&#x3D;ORCL <host></p>
</blockquote>
<blockquote>
<p>PORT     STATE  SERVICE REASON<br> 1521&#x2F;tcp open  oracle  syn-ack<br> | oracle-brute:<br> |   Accounts<br> |     system:powell &#x3D;&gt; Account locked<br> |     haxxor:haxxor &#x3D;&gt; Valid credentials<br> |   Statistics<br> |_    Perfomed 157 guesses in 8 seconds, average tps: 19</p>
</blockquote>
<p>对SSH进行暴力破解</p>
<blockquote>
<p>nmap -p 22 –script ssh-brute –script-args userdb&#x3D;users.lst,passdb&#x3D;pass.lst –script-args ssh-brute.timeout&#x3D;4s <target></p>
</blockquote>
<blockquote>
<p>22&#x2F;ssh open  ssh<br> | ssh-brute:<br> |  Accounts<br> |    username:password<br> |  Statistics<br> |_   Performed 32 guesses in 25 seconds.</p>
</blockquote>
<p>利用DNS进行子域名暴力破解</p>
<blockquote>
<p>nmap –script dns-brute <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a></p>
</blockquote>
<blockquote>
<p>λ nmap –script dns-brute <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a><br> Starting Nmap 7.50 ( <a target="_blank" rel="noopener" href="https://nmap.org/">https://nmap.org</a> ) at 2017-07-25 13:12 ?<br> Nmap scan report for <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> (180.97.33.108)<br> Host is up (0.018s latency).<br> Other addresses for <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> (not scanned): 180.97.33.10<br> Not shown: 998 filtered ports<br> PORT    STATE SERVICE<br> 80&#x2F;tcp  open  http<br> 443&#x2F;tcp open  https<br> Host script results:<br> | dns-brute:<br> |   DNS Brute-force hostnames:<br> |     admin.baidu.com - 10.26.109.19<br> |     mx.baidu.com - 61.135.163.61<br> |     svn.baidu.com - 10.65.211.174<br> |     ads.baidu.com - 10.42.4.225<br> Nmap done: 1 IP address (1 host up) scanned in 92.64 seconds</p>
</blockquote>
<h2 id="参数详解"><a href="#参数详解" class="headerlink" title="参数详解"></a>参数详解</h2><p>Nmap支持主机名,ip,网段的表示方式<br> 例如:blah.highon.coffee, namp.org&#x2F;24, 192.168.0.1;10.0.0-25.1-254</p>
<blockquote>
<p>-iL filename                    从文件中读取待检测的目标,文件中的表示方法支持机名,ip,网段<br> -iR hostnum                     随机选取,进行扫描.如果-iR指定为0,则是无休止的扫描<br> –exclude host1[, host2]        从扫描任务中需要排除的主机<br> –exculdefile exclude_file      排除文件中的IP,格式和-iL指定扫描文件的格式相同</p>
</blockquote>
<p>主机发现</p>
<blockquote>
<p>-sL                     仅仅是显示,扫描的IP数目,不会进行任何扫描<br> -sn                     ping扫描,即主机发现<br> -Pn                     不检测主机存活<br> -PS&#x2F;PA&#x2F;PU&#x2F;PY[portlist]  TCP SYN Ping&#x2F;TCP ACK Ping&#x2F;UDP Ping发现<br> -PE&#x2F;PP&#x2F;PM               使用ICMP echo, timestamp and netmask 请求包发现主机<br> -PO[prococol list]      使用IP协议包探测对方主机是否开启<br> -n&#x2F;-R                   不对IP进行域名反向解析&#x2F;为所有的IP都进行域名的反响解析</p>
</blockquote>
<p>扫描技巧</p>
<blockquote>
<p>-sS&#x2F;sT&#x2F;sA&#x2F;sW&#x2F;sM                 TCP SYN&#x2F;TCP connect()&#x2F;ACK&#x2F;TCP窗口扫描&#x2F;TCP Maimon扫描<br> -sU                             UDP扫描<br> -sN&#x2F;sF&#x2F;sX                       TCP Null，FIN，and Xmas扫描<br> –scanflags                     自定义TCP包中的flags<br> -sI zombie host[:probeport]     Idlescan<br> -sY&#x2F;sZ                          SCTP INIT&#x2F;COOKIE-ECHO 扫描<br> -sO                             使用IP protocol 扫描确定目标机支持的协议类型<br> -b “FTP relay host”             使用FTP bounce scan</p>
</blockquote>
<p>指定端口和扫描顺序</p>
<blockquote>
<p>-p                      特定的端口 -p80,443 或者 -p1-65535<br> -p U:PORT               扫描udp的某个端口, -p U:53<br> -F                      快速扫描模式,比默认的扫描端口还少<br> -r                      不随机扫描端口,默认是随机扫描的<br> –top-ports “number”    扫描开放概率最高的number个端口,出现的概率需要参考nmap-services文件,ubuntu中该文件位于&#x2F;usr&#x2F;share&#x2F;nmap.nmap默认扫前1000个<br> –port-ratio “ratio”    扫描指定频率以上的端口</p>
</blockquote>
<p>服务版本识别</p>
<blockquote>
<p>-sV                             开放版本探测,可以直接使用-A同时打开操作系统探测和版本探测<br> –version-intensity “level”     设置版本扫描强度,强度水平说明了应该使用哪些探测报文。数值越高，服务越有可能被正确识别。默认是7<br> –version-light                 打开轻量级模式,为–version-intensity 2的别名<br> –version-all                   尝试所有探测,为–version-intensity 9的别名<br> –version-trace                 显示出详细的版本侦测过程信息</p>
</blockquote>
<p>脚本扫描</p>
<blockquote>
<p>-sC                             根据端口识别的服务,调用默认脚本<br> –script&#x3D;”Lua scripts”          调用的脚本名<br> –script-args&#x3D;n1&#x3D;v1,[n2&#x3D;v2]     调用的脚本传递的参数<br> –script-args-file&#x3D;filename     使用文本传递参数<br> –script-trace                  显示所有发送和接收到的数据<br> –script-updatedb               更新脚本的数据库<br> –script-help&#x3D;”Lua script”      显示指定脚本的帮助</p>
</blockquote>
<p>OS识别</p>
<blockquote>
<p>-O              启用操作系统检测,-A来同时启用操作系统检测和版本检测<br> –osscan-limit  针对指定的目标进行操作系统检测(至少需确知该主机分别有一个open和closed的端口)<br> –osscan-guess  推测操作系统检测结果,当Nmap无法确定所检测的操作系统时，会尽可能地提供最相近的匹配，Nmap默认进行这种匹配<br> 防火墙&#x2F;IDS躲避和哄骗<br> -f; –mtu value                 指定使用分片、指定数据包的MTU.<br> -D decoy1,decoy2,ME             使用诱饵隐蔽扫描<br> -S IP-ADDRESS                   源地址欺骗<br> -e interface                    使用指定的接口<br> -g&#x2F; –source-port PROTNUM       使用指定源端口<br> –proxies url1,[url2],…       使用HTTP或者SOCKS4的代理</p>
</blockquote>
<blockquote>
<p>–data-length NUM               填充随机数据让数据包长度达到NUM<br> –ip-options OPTIONS            使用指定的IP选项来发送数据包<br> –ttl VALUE                     设置IP time-to-live域<br> –spoof-mac ADDR&#x2F;PREFIX&#x2F;VEBDOR  MAC地址伪装<br> –badsum                        使用错误的checksum来发送数据包<br> Nmap 输出<br> -oN                     将标准输出直接写入指定的文件<br> -oX                     输出xml文件<br> -oS                     将所有的输出都改为大写<br> -oG                     输出便于通过bash或者perl处理的格式,非xml<br> -oA BASENAME            可将扫描结果以标准格式、XML格式和Grep格式一次性输出<br> -v                      提高输出信息的详细度<br> -d level                设置debug级别,最高是9<br> –reason                显示端口处于带确认状态的原因<br> –open                  只输出端口状态为open的端口<br> –packet-trace          显示所有发送或者接收到的数据包<br> –iflist                显示路由信息和接口,便于调试<br> –log-errors            把日志等级为errors&#x2F;warings的日志输出<br> –append-output         追加到指定的文件<br> –resume FILENAME       恢复已停止的扫描<br> –stylesheet PATH&#x2F;URL   设置XSL样式表，转换XML输出<br> –webxml                从namp.org得到XML的样式<br> –no-sytlesheet         忽略XML声明的XSL样式表</p>
</blockquote>
<p>其他nmap选项</p>
<blockquote>
<p>-6                      开启IPv6<br> -A                      OS识别,版本探测,脚本扫描和traceroute<br> –datedir DIRNAME       说明用户Nmap数据文件位置<br> –send-eth &#x2F; –send-ip  使用原以太网帧发送&#x2F;在原IP层发送<br> –privileged            假定用户具有全部权限<br> –unprovoleged          假定用户不具有全部权限,创建原始套接字需要root权限<br> -V                      打印版本信息<br> -h                      输出帮助</p>
</blockquote>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
        <div id="lv-container"></div>
        <div class="giscus"></div>
    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>  Theme <a target="_blank" rel="noopener" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.xml"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="/js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






</html>
