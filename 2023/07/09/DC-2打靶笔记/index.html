<!DOCTYPE html>
<html lang=zh-CN>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:description" content="本网站是个人兴趣爱好，总结分享经验，记录生活点滴的平台，希望在以后的学习旅途中，走出自己的风景。">
    <meta property="og:type" content="website">
    <meta name="description" content="本网站是个人兴趣爱好，总结分享经验，记录生活点滴的平台，希望在以后的学习旅途中，走出自己的风景。">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        DC-2打靶笔记 - n0rt6&#39;s bolg
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/aircloud.css">

    
<link rel="stylesheet" href="/css/gitment.css">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_28hi1hpxx24.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>

    









<meta name="generator" content="Hexo 6.3.0"></head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> Welcome To You </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>n0rt6</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li >
                <a href="/collect/">
                    <i class="iconfont icon-shoucang1"></i>
                    <span>COLLECT</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%B6%E6%9C%BA%E5%AE%89%E8%A3%85%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AE"><span class="toc-text">靶机安装以及配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E9%9D%B6"><span class="toc-text">打靶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-text">知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E6%8E%A2%E6%B5%8B"><span class="toc-text">主机探测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0DNS%E8%AE%BE%E7%BD%AE"><span class="toc-text">本地DNS设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cewl%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">cewl工具的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ssh%E7%99%BB%E5%BD%95"><span class="toc-text">ssh登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rbash%E9%80%83%E9%80%B8-%E6%8F%90%E6%9D%83%E7%9A%84%E4%B8%80%E7%A7%8D"><span class="toc-text">rbash逃逸(提权的一种)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BASH-CMDS%E8%AE%BE%E7%BD%AEshell"><span class="toc-text">BASH_CMDS设置shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git%E6%8F%90%E6%9D%83"><span class="toc-text">git提权</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E5%AD%A6%E4%B9%A0"><span class="toc-text">命令学习</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-bg" id="search-bg"></div>
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> Welcome To You </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        DC-2打靶笔记
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2023-07-09 21:56:10</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#DC" title="DC">DC</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <meta name="referrer" content="no-referrer"/>

<h2 id="靶机安装以及配置"><a href="#靶机安装以及配置" class="headerlink" title="靶机安装以及配置"></a>靶机安装以及配置</h2><p>准备：</p>
<blockquote>
<p>kali虚拟机<br>dc-2靶机<br>windows11(可用可不用)</p>
</blockquote>
<p>靶场下载地址：<a target="_blank" rel="noopener" href="https://download.vulnhub.com/dc/DC-2.zip">https://download.vulnhub.com/dc/DC-2.zip</a><br>下载好后用VM打开，设置为NAT模式<br><img src="https://img-blog.csdnimg.cn/3a2cf2a875e2404a8b5653dde6445ccc.png" alt="1"></p>
<p>开机</p>
<h2 id="打靶"><a href="#打靶" class="headerlink" title="打靶"></a>打靶</h2><p><strong>探测主机存活</strong><br>使用工具nmap：<code>nmap 192.168.206.136/24</code><br>检测到dc-2靶机地址为192.168.206.136<br><img src="https://img-blog.csdnimg.cn/4a9b341fd14d4e7587ad30fc6bbbf3fb.png" alt="2"><br><strong>深度探测靶机信息</strong></p>
<p><code>nmap -sV -p- 192.168.206.136</code></p>
<blockquote>
<p>-sV:端口扫描并获取服务版本信息<br>-p-:全端口扫描 </p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/9129aeec46a7400e91881908ff120fa4.png" alt="3"><br>登陆网站192.168.206.136<br>登陆网站时会发生一些问题显示<code>Did not follow redirect to http://dc-2/</code>，意思就是没有重定向到<a target="_blank" rel="noopener" href="http://dc-2/%EF%BC%8C%E7%94%B1%E4%BA%8E%E6%88%91%E6%89%93%E9%9D%B6%E7%9A%84%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8%E6%9C%AC%E6%9C%BA%E8%BF%9B%E8%A1%8C%E7%9A%84%EF%BC%8C%E5%90%8C%E6%97%B6%E4%BC%9A%E4%BD%BF%E7%94%A8kali%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B7%A5%E5%85%B7%EF%BC%8C%E9%82%A3%E4%B9%88%E9%9C%80%E8%A6%81%E5%B0%86kali%E7%9A%84hosts%E6%96%87%E4%BB%B6%EF%BC%88/etc/hosts%EF%BC%89%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%8B%E6%9C%AC%E5%9C%B0DNS%E8%A7%A3%E6%9E%90%E3%80%82">http://dc-2/，由于我打靶的时候使用本机进行的，同时会使用kali上的一些工具，那么需要将kali的hosts文件（/etc/hosts）添加一下本地DNS解析。</a></p>
<p><img src="https://img-blog.csdnimg.cn/af1bd1db85754fda8912593927733dcf.png" alt="3"><br><strong>windows</strong>host文件在<code>&quot;C:\Windows\System32\drivers\etc\hosts&quot;</code>，添加完之后即可正常进行。<br>打开网站后查看网站整体框架，可以使用kali中的工具<code>whatweb</code>，或者浏览器插件<br><img src="https://img-blog.csdnimg.cn/03fd35a8fd4948e890abcd0db30f9bf3.png" alt="2"><br>可以知道网站是wordpress<br>拿到flag1<br><img src="https://img-blog.csdnimg.cn/0fc407bd818c4d52a034bf10a1cefb37.png" alt="6"></p>
<blockquote>
<p>标志 1：<br>你常用的单词表可能不起作用，所以，也许你只需要 cewl 即可。<br>密码越多越好，但有时您无法赢得所有密码。<br>以一个身份登录即可查看下一个标志。<br>如果找不到，请以其他身份登录。</p>
</blockquote>
<p>查看一下cewl是什么</p>
<blockquote>
<p>cewl 是一个用于生成自定义字典（custom wordlist）的工具，它是根据目标网站或文本中提取的单词和短语创建字典的一种方式。<br>cewl 的全称是 “Custom Word List generator”，它是一个基于Ruby编写的命令行工具。它的主要功能是分析指定的文本或通过爬取目标网站提取出的单词，并根据提取的内容生成一个定制的字典。<br>这个工具在渗透测试和安全评估中经常用于密码破解、暴力攻击和社交工程等方面。通过生成针对特定目标的字典，攻击者可以尝试使用常见的、有可能与目标相关的单词和短语进行密码破解或攻击。<br>cewl 可以根据不同的选项和参数来调整字典的生成过程，例如排除特定的单词、设置最小和最大长度限制、指定输出文件等。</p>
</blockquote>
<p>那意思已经很清楚了，就让我们登录进去，先用cewl制作密码字典<br><code>cewl url -w 文件名</code>即可生成一个字典，后面你可以使用wpscan进行用户名猜解和密码爆破，后续就不演示了，最后可知存在用户<strong>admin，jerry，tom</strong>密码就使用cewl跑出来的密码。最后可以找出jerry和tom的密码，后面登陆jerry用户后可以得到flag2<br><img src="https://img-blog.csdnimg.cn/3381eac70aea4ae0841ad1cec1a30318.png" alt="2"></p>
<blockquote>
<p>如果你无法利用 WordPress 并走捷径，还有另一种方法。<br>希望您找到另一个切入点。</p>
</blockquote>
<p>在这里想到刚才探测端口的时候存在ssh，但是端口改到了7744，使用ssh登陆一下。<br>直接写知识点吧，肝一天了。。。</p>
<h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><h3 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h3><p>这个时候使用nmap进行探测</p>
<blockquote>
<p>nmap -A -p- 192.168.206.136 全端口探测，还有端口服务以及详细配置</p>
</blockquote>
<h3 id="本地DNS设置"><a href="#本地DNS设置" class="headerlink" title="本地DNS设置"></a>本地DNS设置</h3><p><strong>hosts文件地址</strong><br>windows：”C:\Windows\System32\drivers\etc\hosts”<br>linux：&#x2F;etc&#x2F;hosts</p>
<h3 id="cewl工具的使用"><a href="#cewl工具的使用" class="headerlink" title="cewl工具的使用"></a>cewl工具的使用</h3><p>cewl 是一个用于生成自定义字典（custom wordlist）的工具，它是根据目标网站或文本中提取的单词和短语创建字典的一种方式。</p>
<p>cewl 的全称是 “Custom Word List generator”，它是一个基于Ruby编写的命令行工具。它的主要功能是分析指定的文本或通过爬取目标网站提取出的单词，并根据提取的内容生成一个定制的字典。</p>
<p>这个工具在渗透测试和安全评估中经常用于密码破解、暴力攻击和社交工程等方面。通过生成针对特定目标的字典，攻击者可以尝试使用常见的、有可能与目标相关的单词和短语进行密码破解或攻击。</p>
<p>cewl 可以根据不同的选项和参数来调整字典的生成过程，例如排除特定的单词、设置最小和最大长度限制、指定输出文件等。<br>基础命令：<code>cewl url -w 文件名</code>这样之后会生成一个有关该网站的字典，便于后面爆破密码使用。<br><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/network/190128.html">Kali Linux字典生成工具Cewl使用全指南</a></p>
<h3 id="ssh登录"><a href="#ssh登录" class="headerlink" title="ssh登录"></a>ssh登录</h3><p>这个tom用户可以登录，jerry登陆不了，密码就是爆破出来的。</p>
<h3 id="rbash逃逸-提权的一种"><a href="#rbash逃逸-提权的一种" class="headerlink" title="rbash逃逸(提权的一种)"></a>rbash逃逸(提权的一种)</h3><p>rbash：就是受限的bash（bash，一个命令行解释器，接受用户输入的指令并且执行相应的命令），一些命令不能使用<br>以下情况是不允许rbash执行的</p>
<blockquote>
<p>使用命令cd更改目录<br>设置或者取消环境变量的设置（SHELL, PATH, ENV, or BASH_ENV）<br>指定包含参数’&#x2F;‘的文件名<br>指定包含参数’ - ‘的文件名<br>使用重定向输出’&gt;’, ‘&gt;&gt;’, ‘&gt; |’, ‘&lt;&gt;’ ‘&gt;&amp;’,’&amp;&gt;’</p>
</blockquote>
<p>大致的限制如上<br>因此本靶场用到rbash逃逸，由于测试后发现vi命令可以使用，因此使用vi设置shell。<br>进入vi界面</p>
<blockquote>
<p>vi</p>
<p>然后按Esc键，输入<br>:set shell&#x3D;&#x2F;bin&#x2F;bash</p>
</blockquote>
<p>设置好shell并回车，接着输入 </p>
<blockquote>
<p>:shell</p>
<p>回车，启动shell<br>之后退出vi编辑器，查看权限。结果这个靶机没有成功，正常是已经可以了，由于这个靶机的环境变量的问题，在这里我们使用命令添加环境变量<br><code>export PATH=$PATH:/bin/</code><br>这条命令将把 &#x2F;bin&#x2F; 目录添加到当前 PATH 环境变量中。<br>环境变量 PATH 指定了操作系统在查找可执行文件时要搜索的目录列表。通过将一个目录路径添加到 PATH 中，你可以使系统在该目录中查找可执行文件。<br>具体而言，export PATH&#x3D;$PATH:&#x2F;bin&#x2F; 这条命令的含义是：<br>$PATH 表示当前已经设置的 PATH 变量的值。它将被展开为当前的 PATH 路径。<br>&#x2F;bin&#x2F; 是要添加到 PATH 中的目录路径。<br>通过执行这个命令，你将把 &#x2F;bin&#x2F; 目录添加到当前的 PATH 变量中，使得系统能够在 &#x2F;bin&#x2F; 目录中查找可执行文件。这样，在你执行命令时，系统将会在原有的 PATH 路径中搜索命令，同时也会在 &#x2F;bin&#x2F; 目录中搜索命令。<br>这种方式可以方便地执行位于 &#x2F;bin&#x2F; 目录下的命令，而无需指定完整的路径。需要注意的是，在使用 export 命令设置环境变量时，只会在当前会话中生效。如果希望在每次登录时自动设置 PATH，可以将该命令添加到启动文件（如 .bashrc 或 .bash_profile）中。</p>
</blockquote>
<p><code>export PATH=$PATH:/usr/bin/</code></p>
<blockquote>
<p>这条命令将把 &#x2F;usr&#x2F;bin&#x2F; 目录添加到当前 PATH 环境变量中。<br>环境变量 PATH 指定了操作系统在查找可执行文件时要搜索的目录列表。通过将一个目录路径添加到 PATH 中，你可以使系统在该目录中查找可执行文件。<br>具体而言，export PATH&#x3D;$PATH:&#x2F;usr&#x2F;bin&#x2F; 这条命令的含义是：<br>$PATH 表示当前已经设置的 PATH 变量的值。它将被展开为当前的 PATH 路径。<br>&#x2F;usr&#x2F;bin&#x2F; 是要添加到 PATH 中的目录路径。<br>通过执行这个命令，你将把 &#x2F;usr&#x2F;bin&#x2F; 目录添加到当前的 PATH 变量中，使得系统能够在 &#x2F;usr&#x2F;bin&#x2F; 目录中查找可执行文件。这样，在你执行命令时，系统将会在原有的 PATH 路径中搜索命令，同时也会在 &#x2F;usr&#x2F;bin&#x2F; 目录中搜索命令。<br>这种方式可以方便地执行位于 &#x2F;usr&#x2F;bin&#x2F; 目录下的命令，而无需指定完整的路径。需要注意的是，在使用 export 命令设置环境变量时，只会在当前会话中生效。如果希望在每次登录时自动设置 PATH，可以将该命令添加到启动文件（如 .bashrc 或 .bash_profile）中。</p>
</blockquote>
<h3 id="BASH-CMDS设置shell"><a href="#BASH-CMDS设置shell" class="headerlink" title="BASH_CMDS设置shell"></a>BASH_CMDS设置shell</h3><p>BASH_CMDS 是一个包含 Bash 命令的关联数组（associative array）环境变量。它在 Bash 中用于存储和管理命令的定义和别名。当你在 Bash 中定义一个函数、别名或关键字时，它会被添加到 BASH_CMDS 环境变量中。BASH_CMDS 是一个关联数组，它以命令名作为索引，对应的值则是命令的定义。</p>
<p><code>BASH_CMDS[x]=/bin/bash</code>这个命令是在BASH_CMDS数组中将索引x关联到&#x2F;bin&#x2F;bash的命令，意思就是执行<strong>a</strong>命令时也就是执行了**&#x2F;bin&#x2F;bash**命令。<br>与上面两条命令配合之后就可以实现rbash逃逸。(可以执行被限制的命令了)<br><img src="https://img-blog.csdnimg.cn/f1b84162e4bd44f3af7d24217ca12ca0.png" alt="2"></p>
<h3 id="git提权"><a href="#git提权" class="headerlink" title="git提权"></a>git提权</h3><p>前面实现<strong>rbash逃逸</strong>后打开flag文件提示jerry用户，我们切换到jerry用户（密码就是之前爆破出来的密码），打开jerry用户下的flag得到提示需要git提权。<br>git提权的前提是在使用命令<code>sudo -l</code>之后没有密码验证。<br><img src="https://img-blog.csdnimg.cn/151e0426bdce4e17b9045110b9e3dc0d.png" alt="1"><br><strong>第一种</strong></p>
<blockquote>
<p>sudo git help config</p>
</blockquote>
<p>回车然后输入</p>
<blockquote>
<p>!&#x2F;bin&#x2F;bash  (这里bash也可以换成sh)</p>
</blockquote>
<p><strong>第二种</strong></p>
<blockquote>
<p>sudo git -p help</p>
</blockquote>
<p>回车输入</p>
<blockquote>
<p>!&#x2F;bin&#x2F;bash  (这里bash也可以换成sh)</p>
</blockquote>
<p>已经成为root权限</p>
<h2 id="命令学习"><a href="#命令学习" class="headerlink" title="命令学习"></a>命令学习</h2><p>环境变量查看（查看可执行命令）</p>
<blockquote>
<p>echo $PATH<br>比如说得到**&#x2F;home&#x2F;jerry&#x2F;bin**，后面使用<code>echo /home/jerry/bin/*</code>查看可执行的命令</p>
</blockquote>
<p>添加环境变量</p>
<blockquote>
<p>export PATH&#x3D;$PATH:路径<br>常用路径变量&#x2F;usr&#x2F;bin和&#x2F;bin&#x2F;</p>
</blockquote>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
        <div id="lv-container"></div>
        <div class="giscus"></div>
    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>  Theme <a target="_blank" rel="noopener" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.xml"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="/js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






</html>
